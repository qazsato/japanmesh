const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CBJuTfH-.js","./error-404.C3V-3Mc4.css","./D5Y6l-CT.js","./error-500.dGVH929u.css"])))=>i.map(i=>d[i]);
var rS=Object.defineProperty;var Zv=t=>{throw TypeError(t)};var iS=(t,n,l)=>n in t?rS(t,n,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[n]=l;var pa=(t,n,l)=>iS(t,typeof n!="symbol"?n+"":n,l),nS=(t,n,l)=>n.has(t)||Zv("Cannot "+l);var mh=(t,n,l)=>(nS(t,n,"read from private field"),l?l.call(t):n.get(t)),qv=(t,n,l)=>n.has(t)?Zv("Cannot add the same private member more than once"):n instanceof WeakSet?n.add(t):n.set(t,l);(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const p of document.querySelectorAll('link[rel="modulepreload"]'))h(p);new MutationObserver(p=>{for(const y of p)if(y.type==="childList")for(const m of y.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&h(m)}).observe(document,{childList:!0,subtree:!0});function l(p){const y={};return p.integrity&&(y.integrity=p.integrity),p.referrerPolicy&&(y.referrerPolicy=p.referrerPolicy),p.crossOrigin==="use-credentials"?y.credentials="include":p.crossOrigin==="anonymous"?y.credentials="omit":y.credentials="same-origin",y}function h(p){if(p.ep)return;p.ep=!0;const y=l(p);fetch(p.href,y)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function f_(t){const n=Object.create(null);for(const l of t.split(","))n[l]=1;return l=>l in n}const $r={},Bc=[],Wo=()=>{},oS=()=>!1,Xh=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),p_=t=>t.startsWith("onUpdate:"),Wi=Object.assign,m_=(t,n)=>{const l=t.indexOf(n);l>-1&&t.splice(l,1)},sS=Object.prototype.hasOwnProperty,Cr=(t,n)=>sS.call(t,n),Zt=Array.isArray,jc=t=>mp(t)==="[object Map]",Bb=t=>mp(t)==="[object Set]",Gt=t=>typeof t=="function",ui=t=>typeof t=="string",zs=t=>typeof t=="symbol",Hr=t=>t!==null&&typeof t=="object",jb=t=>(Hr(t)||Gt(t))&&Gt(t.then)&&Gt(t.catch),Nb=Object.prototype.toString,mp=t=>Nb.call(t),aS=t=>mp(t).slice(8,-1),Vb=t=>mp(t)==="[object Object]",g_=t=>ui(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,Nc=f_(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),gp=t=>{const n=Object.create(null);return l=>n[l]||(n[l]=t(l))},lS=/-(\w)/g,ao=gp(t=>t.replace(lS,(n,l)=>l?l.toUpperCase():"")),cS=/\B([A-Z])/g,kl=gp(t=>t.replace(cS,"-$1").toLowerCase()),_p=gp(t=>t.charAt(0).toUpperCase()+t.slice(1)),Km=gp(t=>t?`on${_p(t)}`:""),Ea=(t,n)=>!Object.is(t,n),Xm=(t,...n)=>{for(let l=0;l<t.length;l++)t[l](...n)},$b=(t,n,l,h=!1)=>{Object.defineProperty(t,n,{configurable:!0,enumerable:!1,writable:h,value:l})},uS=t=>{const n=parseFloat(t);return isNaN(n)?t:n},Ub=t=>{const n=ui(t)?Number(t):NaN;return isNaN(n)?t:n};let Hv;const yp=()=>Hv||(Hv=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Yh(t){if(Zt(t)){const n={};for(let l=0;l<t.length;l++){const h=t[l],p=ui(h)?pS(h):Yh(h);if(p)for(const y in p)n[y]=p[y]}return n}else if(ui(t)||Hr(t))return t}const hS=/;(?![^(]*\))/g,dS=/:([^]+)/,fS=/\/\*[^]*?\*\//g;function pS(t){const n={};return t.replace(fS,"").split(hS).forEach(l=>{if(l){const h=l.split(dS);h.length>1&&(n[h[0].trim()]=h[1].trim())}}),n}function Qt(t){let n="";if(ui(t))n=t;else if(Zt(t))for(let l=0;l<t.length;l++){const h=Qt(t[l]);h&&(n+=h+" ")}else if(Hr(t))for(const l in t)t[l]&&(n+=l+" ");return n.trim()}function Wf(t){if(!t)return null;let{class:n,style:l}=t;return n&&!ui(n)&&(t.class=Qt(n)),l&&(t.style=Yh(l)),t}const mS="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",gS=f_(mS);function Gb(t){return!!t||t===""}const Zb=t=>!!(t&&t.__v_isRef===!0),en=t=>ui(t)?t:t==null?"":Zt(t)||Hr(t)&&(t.toString===Nb||!Gt(t.toString))?Zb(t)?en(t.value):JSON.stringify(t,qb,2):String(t),qb=(t,n)=>Zb(n)?qb(t,n.value):jc(n)?{[`Map(${n.size})`]:[...n.entries()].reduce((l,[h,p],y)=>(l[Ym(h,y)+" =>"]=p,l),{})}:Bb(n)?{[`Set(${n.size})`]:[...n.values()].map(l=>Ym(l))}:zs(n)?Ym(n):Hr(n)&&!Zt(n)&&!Vb(n)?String(n):n,Ym=(t,n="")=>{var l;return zs(t)?`Symbol(${(l=t.description)!=null?l:n})`:t};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let xn;class Hb{constructor(n=!1){this.detached=n,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=xn,!n&&xn&&(this.index=(xn.scopes||(xn.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let n,l;if(this.scopes)for(n=0,l=this.scopes.length;n<l;n++)this.scopes[n].pause();for(n=0,l=this.effects.length;n<l;n++)this.effects[n].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let n,l;if(this.scopes)for(n=0,l=this.scopes.length;n<l;n++)this.scopes[n].resume();for(n=0,l=this.effects.length;n<l;n++)this.effects[n].resume()}}run(n){if(this._active){const l=xn;try{return xn=this,n()}finally{xn=l}}}on(){xn=this}off(){xn=this.parent}stop(n){if(this._active){this._active=!1;let l,h;for(l=0,h=this.effects.length;l<h;l++)this.effects[l].stop();for(this.effects.length=0,l=0,h=this.cleanups.length;l<h;l++)this.cleanups[l]();if(this.cleanups.length=0,this.scopes){for(l=0,h=this.scopes.length;l<h;l++)this.scopes[l].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!n){const p=this.parent.scopes.pop();p&&p!==this&&(this.parent.scopes[this.index]=p,p.index=this.index)}this.parent=void 0}}}function _S(t){return new Hb(t)}function Wb(){return xn}function yS(t,n=!1){xn&&xn.cleanups.push(t)}let qr;const Jm=new WeakSet;class Kb{constructor(n){this.fn=n,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,xn&&xn.active&&xn.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Jm.has(this)&&(Jm.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Yb(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Wv(this),Jb(this);const n=qr,l=So;qr=this,So=!0;try{return this.fn()}finally{Qb(this),qr=n,So=l,this.flags&=-3}}stop(){if(this.flags&1){for(let n=this.deps;n;n=n.nextDep)v_(n);this.deps=this.depsTail=void 0,Wv(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Jm.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Tg(this)&&this.run()}get dirty(){return Tg(this)}}let Xb=0,Ah,kh;function Yb(t,n=!1){if(t.flags|=8,n){t.next=kh,kh=t;return}t.next=Ah,Ah=t}function __(){Xb++}function y_(){if(--Xb>0)return;if(kh){let n=kh;for(kh=void 0;n;){const l=n.next;n.next=void 0,n.flags&=-9,n=l}}let t;for(;Ah;){let n=Ah;for(Ah=void 0;n;){const l=n.next;if(n.next=void 0,n.flags&=-9,n.flags&1)try{n.trigger()}catch(h){t||(t=h)}n=l}}if(t)throw t}function Jb(t){for(let n=t.deps;n;n=n.nextDep)n.version=-1,n.prevActiveLink=n.dep.activeLink,n.dep.activeLink=n}function Qb(t){let n,l=t.depsTail,h=l;for(;h;){const p=h.prevDep;h.version===-1?(h===l&&(l=p),v_(h),vS(h)):n=h,h.dep.activeLink=h.prevActiveLink,h.prevActiveLink=void 0,h=p}t.deps=n,t.depsTail=l}function Tg(t){for(let n=t.deps;n;n=n.nextDep)if(n.dep.version!==n.version||n.dep.computed&&(ex(n.dep.computed)||n.dep.version!==n.version))return!0;return!!t._dirty}function ex(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===jh))return;t.globalVersion=jh;const n=t.dep;if(t.flags|=2,n.version>0&&!t.isSSR&&t.deps&&!Tg(t)){t.flags&=-3;return}const l=qr,h=So;qr=t,So=!0;try{Jb(t);const p=t.fn(t._value);(n.version===0||Ea(p,t._value))&&(t._value=p,n.version++)}catch(p){throw n.version++,p}finally{qr=l,So=h,Qb(t),t.flags&=-3}}function v_(t,n=!1){const{dep:l,prevSub:h,nextSub:p}=t;if(h&&(h.nextSub=p,t.prevSub=void 0),p&&(p.prevSub=h,t.nextSub=void 0),l.subs===t&&(l.subs=h,!h&&l.computed)){l.computed.flags&=-5;for(let y=l.computed.deps;y;y=y.nextDep)v_(y,!0)}!n&&!--l.sc&&l.map&&l.map.delete(l.key)}function vS(t){const{prevDep:n,nextDep:l}=t;n&&(n.nextDep=l,t.prevDep=void 0),l&&(l.prevDep=n,t.nextDep=void 0)}let So=!0;const tx=[];function Ia(){tx.push(So),So=!1}function Ma(){const t=tx.pop();So=t===void 0?!0:t}function Wv(t){const{cleanup:n}=t;if(t.cleanup=void 0,n){const l=qr;qr=void 0;try{n()}finally{qr=l}}}let jh=0;class bS{constructor(n,l){this.sub=n,this.dep=l,this.version=l.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class b_{constructor(n){this.computed=n,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(n){if(!qr||!So||qr===this.computed)return;let l=this.activeLink;if(l===void 0||l.sub!==qr)l=this.activeLink=new bS(qr,this),qr.deps?(l.prevDep=qr.depsTail,qr.depsTail.nextDep=l,qr.depsTail=l):qr.deps=qr.depsTail=l,rx(l);else if(l.version===-1&&(l.version=this.version,l.nextDep)){const h=l.nextDep;h.prevDep=l.prevDep,l.prevDep&&(l.prevDep.nextDep=h),l.prevDep=qr.depsTail,l.nextDep=void 0,qr.depsTail.nextDep=l,qr.depsTail=l,qr.deps===l&&(qr.deps=h)}return l}trigger(n){this.version++,jh++,this.notify(n)}notify(n){__();try{for(let l=this.subs;l;l=l.prevSub)l.sub.notify()&&l.sub.dep.notify()}finally{y_()}}}function rx(t){if(t.dep.sc++,t.sub.flags&4){const n=t.dep.computed;if(n&&!t.dep.subs){n.flags|=20;for(let h=n.deps;h;h=h.nextDep)rx(h)}const l=t.dep.subs;l!==t&&(t.prevSub=l,l&&(l.nextSub=t)),t.dep.subs=t}}const Kf=new WeakMap,_l=Symbol(""),Sg=Symbol(""),Nh=Symbol("");function dn(t,n,l){if(So&&qr){let h=Kf.get(t);h||Kf.set(t,h=new Map);let p=h.get(l);p||(h.set(l,p=new b_),p.map=h,p.key=l),p.track()}}function Ps(t,n,l,h,p,y){const m=Kf.get(t);if(!m){jh++;return}const a=I=>{I&&I.trigger()};if(__(),n==="clear")m.forEach(a);else{const I=Zt(t),z=I&&g_(l);if(I&&l==="length"){const P=Number(h);m.forEach((k,N)=>{(N==="length"||N===Nh||!zs(N)&&N>=P)&&a(k)})}else switch((l!==void 0||m.has(void 0))&&a(m.get(l)),z&&a(m.get(Nh)),n){case"add":I?z&&a(m.get("length")):(a(m.get(_l)),jc(t)&&a(m.get(Sg)));break;case"delete":I||(a(m.get(_l)),jc(t)&&a(m.get(Sg)));break;case"set":jc(t)&&a(m.get(_l));break}}y_()}function xS(t,n){const l=Kf.get(t);return l&&l.get(n)}function Pc(t){const n=Vt(t);return n===t?n:(dn(n,"iterate",Nh),oo(t)?n:n.map(fn))}function vp(t){return dn(t=Vt(t),"iterate",Nh),t}const wS={__proto__:null,[Symbol.iterator](){return Qm(this,Symbol.iterator,fn)},concat(...t){return Pc(this).concat(...t.map(n=>Zt(n)?Pc(n):n))},entries(){return Qm(this,"entries",t=>(t[1]=fn(t[1]),t))},every(t,n){return ws(this,"every",t,n,void 0,arguments)},filter(t,n){return ws(this,"filter",t,n,l=>l.map(fn),arguments)},find(t,n){return ws(this,"find",t,n,fn,arguments)},findIndex(t,n){return ws(this,"findIndex",t,n,void 0,arguments)},findLast(t,n){return ws(this,"findLast",t,n,fn,arguments)},findLastIndex(t,n){return ws(this,"findLastIndex",t,n,void 0,arguments)},forEach(t,n){return ws(this,"forEach",t,n,void 0,arguments)},includes(...t){return eg(this,"includes",t)},indexOf(...t){return eg(this,"indexOf",t)},join(t){return Pc(this).join(t)},lastIndexOf(...t){return eg(this,"lastIndexOf",t)},map(t,n){return ws(this,"map",t,n,void 0,arguments)},pop(){return gh(this,"pop")},push(...t){return gh(this,"push",t)},reduce(t,...n){return Kv(this,"reduce",t,n)},reduceRight(t,...n){return Kv(this,"reduceRight",t,n)},shift(){return gh(this,"shift")},some(t,n){return ws(this,"some",t,n,void 0,arguments)},splice(...t){return gh(this,"splice",t)},toReversed(){return Pc(this).toReversed()},toSorted(t){return Pc(this).toSorted(t)},toSpliced(...t){return Pc(this).toSpliced(...t)},unshift(...t){return gh(this,"unshift",t)},values(){return Qm(this,"values",fn)}};function Qm(t,n,l){const h=vp(t),p=h[n]();return h!==t&&!oo(t)&&(p._next=p.next,p.next=()=>{const y=p._next();return y.value&&(y.value=l(y.value)),y}),p}const TS=Array.prototype;function ws(t,n,l,h,p,y){const m=vp(t),a=m!==t&&!oo(t),I=m[n];if(I!==TS[n]){const k=I.apply(t,y);return a?fn(k):k}let z=l;m!==t&&(a?z=function(k,N){return l.call(this,fn(k),N,t)}:l.length>2&&(z=function(k,N){return l.call(this,k,N,t)}));const P=I.call(m,z,h);return a&&p?p(P):P}function Kv(t,n,l,h){const p=vp(t);let y=l;return p!==t&&(oo(t)?l.length>3&&(y=function(m,a,I){return l.call(this,m,a,I,t)}):y=function(m,a,I){return l.call(this,m,fn(a),I,t)}),p[n](y,...h)}function eg(t,n,l){const h=Vt(t);dn(h,"iterate",Nh);const p=h[n](...l);return(p===-1||p===!1)&&T_(l[0])?(l[0]=Vt(l[0]),h[n](...l)):p}function gh(t,n,l=[]){Ia(),__();const h=Vt(t)[n].apply(t,l);return y_(),Ma(),h}const SS=f_("__proto__,__v_isRef,__isVue"),ix=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(zs));function ES(t){zs(t)||(t=String(t));const n=Vt(this);return dn(n,"has",t),n.hasOwnProperty(t)}class nx{constructor(n=!1,l=!1){this._isReadonly=n,this._isShallow=l}get(n,l,h){if(l==="__v_skip")return n.__v_skip;const p=this._isReadonly,y=this._isShallow;if(l==="__v_isReactive")return!p;if(l==="__v_isReadonly")return p;if(l==="__v_isShallow")return y;if(l==="__v_raw")return h===(p?y?DS:lx:y?ax:sx).get(n)||Object.getPrototypeOf(n)===Object.getPrototypeOf(h)?n:void 0;const m=Zt(n);if(!p){let I;if(m&&(I=wS[l]))return I;if(l==="hasOwnProperty")return ES}const a=Reflect.get(n,l,li(n)?n:h);return(zs(l)?ix.has(l):SS(l))||(p||dn(n,"get",l),y)?a:li(a)?m&&g_(l)?a:a.value:Hr(a)?p?cx(a):Co(a):a}}class ox extends nx{constructor(n=!1){super(!1,n)}set(n,l,h,p){let y=n[l];if(!this._isShallow){const I=Ca(y);if(!oo(h)&&!Ca(h)&&(y=Vt(y),h=Vt(h)),!Zt(n)&&li(y)&&!li(h))return I?!1:(y.value=h,!0)}const m=Zt(n)&&g_(l)?Number(l)<n.length:Cr(n,l),a=Reflect.set(n,l,h,li(n)?n:p);return n===Vt(p)&&(m?Ea(h,y)&&Ps(n,"set",l,h):Ps(n,"add",l,h)),a}deleteProperty(n,l){const h=Cr(n,l);n[l];const p=Reflect.deleteProperty(n,l);return p&&h&&Ps(n,"delete",l,void 0),p}has(n,l){const h=Reflect.has(n,l);return(!zs(l)||!ix.has(l))&&dn(n,"has",l),h}ownKeys(n){return dn(n,"iterate",Zt(n)?"length":_l),Reflect.ownKeys(n)}}class CS extends nx{constructor(n=!1){super(!0,n)}set(n,l){return!0}deleteProperty(n,l){return!0}}const IS=new ox,MS=new CS,PS=new ox(!0);const Eg=t=>t,Cf=t=>Reflect.getPrototypeOf(t);function AS(t,n,l){return function(...h){const p=this.__v_raw,y=Vt(p),m=jc(y),a=t==="entries"||t===Symbol.iterator&&m,I=t==="keys"&&m,z=p[t](...h),P=l?Eg:n?Cg:fn;return!n&&dn(y,"iterate",I?Sg:_l),{next(){const{value:k,done:N}=z.next();return N?{value:k,done:N}:{value:a?[P(k[0]),P(k[1])]:P(k),done:N}},[Symbol.iterator](){return this}}}}function If(t){return function(...n){return t==="delete"?!1:t==="clear"?void 0:this}}function kS(t,n){const l={get(p){const y=this.__v_raw,m=Vt(y),a=Vt(p);t||(Ea(p,a)&&dn(m,"get",p),dn(m,"get",a));const{has:I}=Cf(m),z=n?Eg:t?Cg:fn;if(I.call(m,p))return z(y.get(p));if(I.call(m,a))return z(y.get(a));y!==m&&y.get(p)},get size(){const p=this.__v_raw;return!t&&dn(Vt(p),"iterate",_l),Reflect.get(p,"size",p)},has(p){const y=this.__v_raw,m=Vt(y),a=Vt(p);return t||(Ea(p,a)&&dn(m,"has",p),dn(m,"has",a)),p===a?y.has(p):y.has(p)||y.has(a)},forEach(p,y){const m=this,a=m.__v_raw,I=Vt(a),z=n?Eg:t?Cg:fn;return!t&&dn(I,"iterate",_l),a.forEach((P,k)=>p.call(y,z(P),z(k),m))}};return Wi(l,t?{add:If("add"),set:If("set"),delete:If("delete"),clear:If("clear")}:{add(p){!n&&!oo(p)&&!Ca(p)&&(p=Vt(p));const y=Vt(this);return Cf(y).has.call(y,p)||(y.add(p),Ps(y,"add",p,p)),this},set(p,y){!n&&!oo(y)&&!Ca(y)&&(y=Vt(y));const m=Vt(this),{has:a,get:I}=Cf(m);let z=a.call(m,p);z||(p=Vt(p),z=a.call(m,p));const P=I.call(m,p);return m.set(p,y),z?Ea(y,P)&&Ps(m,"set",p,y):Ps(m,"add",p,y),this},delete(p){const y=Vt(this),{has:m,get:a}=Cf(y);let I=m.call(y,p);I||(p=Vt(p),I=m.call(y,p)),a&&a.call(y,p);const z=y.delete(p);return I&&Ps(y,"delete",p,void 0),z},clear(){const p=Vt(this),y=p.size!==0,m=p.clear();return y&&Ps(p,"clear",void 0,void 0),m}}),["keys","values","entries",Symbol.iterator].forEach(p=>{l[p]=AS(p,t,n)}),l}function x_(t,n){const l=kS(t,n);return(h,p,y)=>p==="__v_isReactive"?!t:p==="__v_isReadonly"?t:p==="__v_raw"?h:Reflect.get(Cr(l,p)&&p in h?l:h,p,y)}const LS={get:x_(!1,!1)},zS={get:x_(!1,!0)},RS={get:x_(!0,!1)};const sx=new WeakMap,ax=new WeakMap,lx=new WeakMap,DS=new WeakMap;function OS(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function FS(t){return t.__v_skip||!Object.isExtensible(t)?0:OS(aS(t))}function Co(t){return Ca(t)?t:w_(t,!1,IS,LS,sx)}function Dc(t){return w_(t,!1,PS,zS,ax)}function cx(t){return w_(t,!0,MS,RS,lx)}function w_(t,n,l,h,p){if(!Hr(t)||t.__v_raw&&!(n&&t.__v_isReactive))return t;const y=p.get(t);if(y)return y;const m=FS(t);if(m===0)return t;const a=new Proxy(t,m===2?h:l);return p.set(t,a),a}function yl(t){return Ca(t)?yl(t.__v_raw):!!(t&&t.__v_isReactive)}function Ca(t){return!!(t&&t.__v_isReadonly)}function oo(t){return!!(t&&t.__v_isShallow)}function T_(t){return t?!!t.__v_raw:!1}function Vt(t){const n=t&&t.__v_raw;return n?Vt(n):t}function BS(t){return!Cr(t,"__v_skip")&&Object.isExtensible(t)&&$b(t,"__v_skip",!0),t}const fn=t=>Hr(t)?Co(t):t,Cg=t=>Hr(t)?cx(t):t;function li(t){return t?t.__v_isRef===!0:!1}function $t(t){return ux(t,!1)}function El(t){return ux(t,!0)}function ux(t,n){return li(t)?t:new jS(t,n)}class jS{constructor(n,l){this.dep=new b_,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=l?n:Vt(n),this._value=l?n:fn(n),this.__v_isShallow=l}get value(){return this.dep.track(),this._value}set value(n){const l=this._rawValue,h=this.__v_isShallow||oo(n)||Ca(n);n=h?n:Vt(n),Ea(n,l)&&(this._rawValue=n,this._value=h?n:fn(n),this.dep.trigger())}}function Xv(t){t.dep&&t.dep.trigger()}function gr(t){return li(t)?t.value:t}function vl(t){return Gt(t)?t():gr(t)}const NS={get:(t,n,l)=>n==="__v_raw"?t:gr(Reflect.get(t,n,l)),set:(t,n,l,h)=>{const p=t[n];return li(p)&&!li(l)?(p.value=l,!0):Reflect.set(t,n,l,h)}};function hx(t){return yl(t)?t:new Proxy(t,NS)}class VS{constructor(n,l,h){this._object=n,this._key=l,this._defaultValue=h,this.__v_isRef=!0,this._value=void 0}get value(){const n=this._object[this._key];return this._value=n===void 0?this._defaultValue:n}set value(n){this._object[this._key]=n}get dep(){return xS(Vt(this._object),this._key)}}class $S{constructor(n){this._getter=n,this.__v_isRef=!0,this.__v_isReadonly=!0,this._value=void 0}get value(){return this._value=this._getter()}}function Ko(t,n,l){return li(t)?t:Gt(t)?new $S(t):Hr(t)&&arguments.length>1?US(t,n,l):$t(t)}function US(t,n,l){const h=t[n];return li(h)?h:new VS(t,n,l)}class GS{constructor(n,l,h){this.fn=n,this.setter=l,this._value=void 0,this.dep=new b_(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=jh-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!l,this.isSSR=h}notify(){if(this.flags|=16,!(this.flags&8)&&qr!==this)return Yb(this,!0),!0}get value(){const n=this.dep.track();return ex(this),n&&(n.version=this.dep.version),this._value}set value(n){this.setter&&this.setter(n)}}function ZS(t,n,l=!1){let h,p;return Gt(t)?h=t:(h=t.get,p=t.set),new GS(h,p,l)}const Mf={},Xf=new WeakMap;let ml;function qS(t,n=!1,l=ml){if(l){let h=Xf.get(l);h||Xf.set(l,h=[]),h.push(t)}}function HS(t,n,l=$r){const{immediate:h,deep:p,once:y,scheduler:m,augmentJob:a,call:I}=l,z=re=>p?re:oo(re)||p===!1||p===0?As(re,1):As(re);let P,k,N,F,H=!1,X=!1;if(li(t)?(k=()=>t.value,H=oo(t)):yl(t)?(k=()=>z(t),H=!0):Zt(t)?(X=!0,H=t.some(re=>yl(re)||oo(re)),k=()=>t.map(re=>{if(li(re))return re.value;if(yl(re))return z(re);if(Gt(re))return I?I(re,2):re()})):Gt(t)?n?k=I?()=>I(t,2):t:k=()=>{if(N){Ia();try{N()}finally{Ma()}}const re=ml;ml=P;try{return I?I(t,3,[F]):t(F)}finally{ml=re}}:k=Wo,n&&p){const re=k,J=p===!0?1/0:p;k=()=>As(re(),J)}const ae=Wb(),Se=()=>{P.stop(),ae&&ae.active&&m_(ae.effects,P)};if(y&&n){const re=n;n=(...J)=>{re(...J),Se()}}let be=X?new Array(t.length).fill(Mf):Mf;const Q=re=>{if(!(!(P.flags&1)||!P.dirty&&!re))if(n){const J=P.run();if(p||H||(X?J.some((le,Me)=>Ea(le,be[Me])):Ea(J,be))){N&&N();const le=ml;ml=P;try{const Me=[J,be===Mf?void 0:X&&be[0]===Mf?[]:be,F];I?I(n,3,Me):n(...Me),be=J}finally{ml=le}}}else P.run()};return a&&a(Q),P=new Kb(k),P.scheduler=m?()=>m(Q,!1):Q,F=re=>qS(re,!1,P),N=P.onStop=()=>{const re=Xf.get(P);if(re){if(I)I(re,4);else for(const J of re)J();Xf.delete(P)}},n?h?Q(!0):be=P.run():m?m(Q.bind(null,!0),!0):P.run(),Se.pause=P.pause.bind(P),Se.resume=P.resume.bind(P),Se.stop=Se,Se}function As(t,n=1/0,l){if(n<=0||!Hr(t)||t.__v_skip||(l=l||new Set,l.has(t)))return t;if(l.add(t),n--,li(t))As(t.value,n,l);else if(Zt(t))for(let h=0;h<t.length;h++)As(t[h],n,l);else if(Bb(t)||jc(t))t.forEach(h=>{As(h,n,l)});else if(Vb(t)){for(const h in t)As(t[h],n,l);for(const h of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,h)&&As(t[h],n,l)}return t}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Jh(t,n,l,h){try{return h?t(...h):t()}catch(p){Jc(p,n,l)}}function Io(t,n,l,h){if(Gt(t)){const p=Jh(t,n,l,h);return p&&jb(p)&&p.catch(y=>{Jc(y,n,l)}),p}if(Zt(t)){const p=[];for(let y=0;y<t.length;y++)p.push(Io(t[y],n,l,h));return p}}function Jc(t,n,l,h=!0){const p=n?n.vnode:null,{errorHandler:y,throwUnhandledErrorInProduction:m}=n&&n.appContext.config||$r;if(n){let a=n.parent;const I=n.proxy,z=`https://vuejs.org/error-reference/#runtime-${l}`;for(;a;){const P=a.ec;if(P){for(let k=0;k<P.length;k++)if(P[k](t,I,z)===!1)return}a=a.parent}if(y){Ia(),Jh(y,null,10,[t,I,z]),Ma();return}}WS(t,l,p,h,m)}function WS(t,n,l,h=!0,p=!1){if(p)throw t;console.error(t)}const Tn=[];let Zo=-1;const Vc=[];let ba=null,zc=0;const dx=Promise.resolve();let Yf=null;function tn(t){const n=Yf||dx;return t?n.then(this?t.bind(this):t):n}function KS(t){let n=Zo+1,l=Tn.length;for(;n<l;){const h=n+l>>>1,p=Tn[h],y=Vh(p);y<t||y===t&&p.flags&2?n=h+1:l=h}return n}function S_(t){if(!(t.flags&1)){const n=Vh(t),l=Tn[Tn.length-1];!l||!(t.flags&2)&&n>=Vh(l)?Tn.push(t):Tn.splice(KS(n),0,t),t.flags|=1,fx()}}function fx(){Yf||(Yf=dx.then(px))}function Ig(t){Zt(t)?Vc.push(...t):ba&&t.id===-1?ba.splice(zc+1,0,t):t.flags&1||(Vc.push(t),t.flags|=1),fx()}function Yv(t,n,l=Zo+1){for(;l<Tn.length;l++){const h=Tn[l];if(h&&h.flags&2){if(t&&h.id!==t.uid)continue;Tn.splice(l,1),l--,h.flags&4&&(h.flags&=-2),h(),h.flags&4||(h.flags&=-2)}}}function Jf(t){if(Vc.length){const n=[...new Set(Vc)].sort((l,h)=>Vh(l)-Vh(h));if(Vc.length=0,ba){ba.push(...n);return}for(ba=n,zc=0;zc<ba.length;zc++){const l=ba[zc];l.flags&4&&(l.flags&=-2),l.flags&8||l(),l.flags&=-2}ba=null,zc=0}}const Vh=t=>t.id==null?t.flags&2?-1:1/0:t.id;function px(t){try{for(Zo=0;Zo<Tn.length;Zo++){const n=Tn[Zo];n&&!(n.flags&8)&&(n.flags&4&&(n.flags&=-2),Jh(n,n.i,n.i?15:14),n.flags&4||(n.flags&=-2))}}finally{for(;Zo<Tn.length;Zo++){const n=Tn[Zo];n&&(n.flags&=-2)}Zo=-1,Tn.length=0,Jf(),Yf=null,(Tn.length||Vc.length)&&px()}}let Ni=null,mx=null;function Qf(t){const n=Ni;return Ni=t,mx=t&&t.type.__scopeId||null,n}function Zi(t,n=Ni,l){if(!n||t._n)return t;const h=(...p)=>{h._d&&u0(-1);const y=Qf(n);let m;try{m=t(...p)}finally{Qf(y),h._d&&u0(1)}return m};return h._n=!0,h._c=!0,h._d=!0,h}function XS(t,n){if(Ni===null)return t;const l=Ep(Ni),h=t.dirs||(t.dirs=[]);for(let p=0;p<n.length;p++){let[y,m,a,I=$r]=n[p];y&&(Gt(y)&&(y={mounted:y,updated:y}),y.deep&&As(m),h.push({dir:y,instance:l,value:m,oldValue:void 0,arg:a,modifiers:I}))}return t}function qo(t,n,l,h){const p=t.dirs,y=n&&n.dirs;for(let m=0;m<p.length;m++){const a=p[m];y&&(a.oldValue=y[m].value);let I=a.dir[h];I&&(Ia(),Io(I,l,8,[t.el,a,t,n]),Ma())}}const YS=Symbol("_vte"),gx=t=>t.__isTeleport,xa=Symbol("_leaveCb"),Pf=Symbol("_enterCb");function JS(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Sn(()=>{t.isMounted=!0}),xp(()=>{t.isUnmounting=!0}),t}const to=[Function,Array],_x={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:to,onEnter:to,onAfterEnter:to,onEnterCancelled:to,onBeforeLeave:to,onLeave:to,onAfterLeave:to,onLeaveCancelled:to,onBeforeAppear:to,onAppear:to,onAfterAppear:to,onAppearCancelled:to},yx=t=>{const n=t.subTree;return n.component?yx(n.component):n},QS={name:"BaseTransition",props:_x,setup(t,{slots:n}){const l=eu(),h=JS();return()=>{const p=n.default&&xx(n.default(),!0);if(!p||!p.length)return;const y=vx(p),m=Vt(t),{mode:a}=m;if(h.isLeaving)return tg(y);const I=Jv(y);if(!I)return tg(y);let z=Mg(I,m,h,l,k=>z=k);I.type!==Hi&&$h(I,z);let P=l.subTree&&Jv(l.subTree);if(P&&P.type!==Hi&&!Ho(I,P)&&yx(l).type!==Hi){let k=Mg(P,m,h,l);if($h(P,k),a==="out-in"&&I.type!==Hi)return h.isLeaving=!0,k.afterLeave=()=>{h.isLeaving=!1,l.job.flags&8||l.update(),delete k.afterLeave,P=void 0},tg(y);a==="in-out"&&I.type!==Hi?k.delayLeave=(N,F,H)=>{const X=bx(h,P);X[String(P.key)]=P,N[xa]=()=>{F(),N[xa]=void 0,delete z.delayedLeave,P=void 0},z.delayedLeave=()=>{H(),delete z.delayedLeave,P=void 0}}:P=void 0}else P&&(P=void 0);return y}}};function vx(t){let n=t[0];if(t.length>1){for(const l of t)if(l.type!==Hi){n=l;break}}return n}const eE=QS;function bx(t,n){const{leavingVNodes:l}=t;let h=l.get(n.type);return h||(h=Object.create(null),l.set(n.type,h)),h}function Mg(t,n,l,h,p){const{appear:y,mode:m,persisted:a=!1,onBeforeEnter:I,onEnter:z,onAfterEnter:P,onEnterCancelled:k,onBeforeLeave:N,onLeave:F,onAfterLeave:H,onLeaveCancelled:X,onBeforeAppear:ae,onAppear:Se,onAfterAppear:be,onAppearCancelled:Q}=n,re=String(t.key),J=bx(l,t),le=(Be,Ee)=>{Be&&Io(Be,h,9,Ee)},Me=(Be,Ee)=>{const Re=Ee[1];le(Be,Ee),Zt(Be)?Be.every(Ae=>Ae.length<=1)&&Re():Be.length<=1&&Re()},Ie={mode:m,persisted:a,beforeEnter(Be){let Ee=I;if(!l.isMounted)if(y)Ee=ae||I;else return;Be[xa]&&Be[xa](!0);const Re=J[re];Re&&Ho(t,Re)&&Re.el[xa]&&Re.el[xa](),le(Ee,[Be])},enter(Be){let Ee=z,Re=P,Ae=k;if(!l.isMounted)if(y)Ee=Se||z,Re=be||P,Ae=Q||k;else return;let He=!1;const it=Be[Pf]=vt=>{He||(He=!0,vt?le(Ae,[Be]):le(Re,[Be]),Ie.delayedLeave&&Ie.delayedLeave(),Be[Pf]=void 0)};Ee?Me(Ee,[Be,it]):it()},leave(Be,Ee){const Re=String(t.key);if(Be[Pf]&&Be[Pf](!0),l.isUnmounting)return Ee();le(N,[Be]);let Ae=!1;const He=Be[xa]=it=>{Ae||(Ae=!0,Ee(),it?le(X,[Be]):le(H,[Be]),Be[xa]=void 0,J[Re]===t&&delete J[Re])};J[Re]=t,F?Me(F,[Be,He]):He()},clone(Be){const Ee=Mg(Be,n,l,h,p);return p&&p(Ee),Ee}};return Ie}function tg(t){if(Qh(t))return t=Yo(t),t.children=null,t}function Jv(t){if(!Qh(t))return gx(t.type)&&t.children?vx(t.children):t;const{shapeFlag:n,children:l}=t;if(l){if(n&16)return l[0];if(n&32&&Gt(l.default))return l.default()}}function $h(t,n){t.shapeFlag&6&&t.component?(t.transition=n,$h(t.component.subTree,n)):t.shapeFlag&128?(t.ssContent.transition=n.clone(t.ssContent),t.ssFallback.transition=n.clone(t.ssFallback)):t.transition=n}function xx(t,n=!1,l){let h=[],p=0;for(let y=0;y<t.length;y++){let m=t[y];const a=l==null?m.key:String(l)+String(m.key!=null?m.key:y);m.type===ki?(m.patchFlag&128&&p++,h=h.concat(xx(m.children,n,a))):(n||m.type!==Hi)&&h.push(a!=null?Yo(m,{key:a}):m)}if(p>1)for(let y=0;y<h.length;y++)h[y].patchFlag=-2;return h}/*! #__NO_SIDE_EFFECTS__ */function Ur(t,n){return Gt(t)?Wi({name:t.name},n,{setup:t}):t}function wx(){const t=eu();return t?(t.appContext.config.idPrefix||"v")+"-"+t.ids[0]+t.ids[1]++:""}function E_(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}function Uh(t,n,l,h,p=!1){if(Zt(t)){t.forEach((H,X)=>Uh(H,n&&(Zt(n)?n[X]:n),l,h,p));return}if(bl(h)&&!p){h.shapeFlag&512&&h.type.__asyncResolved&&h.component.subTree.component&&Uh(t,n,l,h.component.subTree);return}const y=h.shapeFlag&4?Ep(h.component):h.el,m=p?null:y,{i:a,r:I}=t,z=n&&n.r,P=a.refs===$r?a.refs={}:a.refs,k=a.setupState,N=Vt(k),F=k===$r?()=>!1:H=>Cr(N,H);if(z!=null&&z!==I&&(ui(z)?(P[z]=null,F(z)&&(k[z]=null)):li(z)&&(z.value=null)),Gt(I))Jh(I,a,12,[m,P]);else{const H=ui(I),X=li(I);if(H||X){const ae=()=>{if(t.f){const Se=H?F(I)?k[I]:P[I]:I.value;p?Zt(Se)&&m_(Se,y):Zt(Se)?Se.includes(y)||Se.push(y):H?(P[I]=[y],F(I)&&(k[I]=P[I])):(I.value=[y],t.k&&(P[t.k]=I.value))}else H?(P[I]=m,F(I)&&(k[I]=m)):X&&(I.value=m,t.k&&(P[t.k]=m))};m?(ae.id=-1,jn(ae,l)):ae()}}}let Qv=!1;const Ac=()=>{Qv||(console.error("Hydration completed but contains mismatches."),Qv=!0)},tE=t=>t.namespaceURI.includes("svg")&&t.tagName!=="foreignObject",rE=t=>t.namespaceURI.includes("MathML"),Af=t=>{if(t.nodeType===1){if(tE(t))return"svg";if(rE(t))return"mathml"}},Oc=t=>t.nodeType===8;function iE(t){const{mt:n,p:l,o:{patchProp:h,createText:p,nextSibling:y,parentNode:m,remove:a,insert:I,createComment:z}}=t,P=(Q,re)=>{if(!re.hasChildNodes()){l(null,Q,re),Jf(),re._vnode=Q;return}k(re.firstChild,Q,null,null,null),Jf(),re._vnode=Q},k=(Q,re,J,le,Me,Ie=!1)=>{Ie=Ie||!!re.dynamicChildren;const Be=Oc(Q)&&Q.data==="[",Ee=()=>X(Q,re,J,le,Me,Be),{type:Re,ref:Ae,shapeFlag:He,patchFlag:it}=re;let vt=Q.nodeType;re.el=Q,it===-2&&(Ie=!1,re.dynamicChildren=null);let Xe=null;switch(Re){case wl:vt!==3?re.children===""?(I(re.el=p(""),m(Q),Q),Xe=Q):Xe=Ee():(Q.data!==re.children&&(Ac(),Q.data=re.children),Xe=y(Q));break;case Hi:be(Q)?(Xe=y(Q),Se(re.el=Q.content.firstChild,Q,J)):vt!==8||Be?Xe=Ee():Xe=y(Q);break;case Bf:if(Be&&(Q=y(Q),vt=Q.nodeType),vt===1||vt===3){Xe=Q;const xt=!re.children.length;for(let yt=0;yt<re.staticCount;yt++)xt&&(re.children+=Xe.nodeType===1?Xe.outerHTML:Xe.data),yt===re.staticCount-1&&(re.anchor=Xe),Xe=y(Xe);return Be?y(Xe):Xe}else Ee();break;case ki:Be?Xe=H(Q,re,J,le,Me,Ie):Xe=Ee();break;default:if(He&1)(vt!==1||re.type.toLowerCase()!==Q.tagName.toLowerCase())&&!be(Q)?Xe=Ee():Xe=N(Q,re,J,le,Me,Ie);else if(He&6){re.slotScopeIds=Me;const xt=m(Q);if(Be?Xe=ae(Q):Oc(Q)&&Q.data==="teleport start"?Xe=ae(Q,Q.data,"teleport end"):Xe=y(Q),n(re,xt,null,J,le,Af(xt),Ie),bl(re)&&!re.type.__asyncResolved){let yt;Be?(yt=cr(ki),yt.anchor=Xe?Xe.previousSibling:xt.lastChild):yt=Q.nodeType===3?Tl(""):cr("div"),yt.el=Q,re.component.subTree=yt}}else He&64?vt!==8?Xe=Ee():Xe=re.type.hydrate(Q,re,J,le,Me,Ie,t,F):He&128&&(Xe=re.type.hydrate(Q,re,J,le,Af(m(Q)),Me,Ie,t,k))}return Ae!=null&&Uh(Ae,null,le,re),Xe},N=(Q,re,J,le,Me,Ie)=>{Ie=Ie||!!re.dynamicChildren;const{type:Be,props:Ee,patchFlag:Re,shapeFlag:Ae,dirs:He,transition:it}=re,vt=Be==="input"||Be==="option";if(vt||Re!==-1){He&&qo(re,null,J,"created");let Xe=!1;if(be(Q)){Xe=Gx(null,it)&&J&&J.vnode.props&&J.vnode.props.appear;const yt=Q.content.firstChild;Xe&&it.beforeEnter(yt),Se(yt,Q,J),re.el=Q=yt}if(Ae&16&&!(Ee&&(Ee.innerHTML||Ee.textContent))){let yt=F(Q.firstChild,re,Q,J,le,Me,Ie);for(;yt;){kf(Q,1)||Ac();const Rt=yt;yt=yt.nextSibling,a(Rt)}}else if(Ae&8){let yt=re.children;yt[0]===`
`&&(Q.tagName==="PRE"||Q.tagName==="TEXTAREA")&&(yt=yt.slice(1)),Q.textContent!==yt&&(kf(Q,0)||Ac(),Q.textContent=re.children)}if(Ee){if(vt||!Ie||Re&48){const yt=Q.tagName.includes("-");for(const Rt in Ee)(vt&&(Rt.endsWith("value")||Rt==="indeterminate")||Xh(Rt)&&!Nc(Rt)||Rt[0]==="."||yt)&&h(Q,Rt,null,Ee[Rt],void 0,J)}else if(Ee.onClick)h(Q,"onClick",null,Ee.onClick,void 0,J);else if(Re&4&&yl(Ee.style))for(const yt in Ee.style)Ee.style[yt]}let xt;(xt=Ee&&Ee.onVnodeBeforeMount)&&no(xt,J,re),He&&qo(re,null,J,"beforeMount"),((xt=Ee&&Ee.onVnodeMounted)||He||Xe)&&Yx(()=>{xt&&no(xt,J,re),Xe&&it.enter(Q),He&&qo(re,null,J,"mounted")},le)}return Q.nextSibling},F=(Q,re,J,le,Me,Ie,Be)=>{Be=Be||!!re.dynamicChildren;const Ee=re.children,Re=Ee.length;for(let Ae=0;Ae<Re;Ae++){const He=Be?Ee[Ae]:Ee[Ae]=Vn(Ee[Ae]),it=He.type===wl;Q?(it&&!Be&&Ae+1<Re&&Vn(Ee[Ae+1]).type===wl&&(I(p(Q.data.slice(He.children.length)),J,y(Q)),Q.data=He.children),Q=k(Q,He,le,Me,Ie,Be)):it&&!He.children?I(He.el=p(""),J):(kf(J,1)||Ac(),l(null,He,J,null,le,Me,Af(J),Ie))}return Q},H=(Q,re,J,le,Me,Ie)=>{const{slotScopeIds:Be}=re;Be&&(Me=Me?Me.concat(Be):Be);const Ee=m(Q),Re=F(y(Q),re,Ee,J,le,Me,Ie);return Re&&Oc(Re)&&Re.data==="]"?y(re.anchor=Re):(Ac(),I(re.anchor=z("]"),Ee,Re),Re)},X=(Q,re,J,le,Me,Ie)=>{if(kf(Q.parentElement,1)||Ac(),re.el=null,Ie){const Re=ae(Q);for(;;){const Ae=y(Q);if(Ae&&Ae!==Re)a(Ae);else break}}const Be=y(Q),Ee=m(Q);return a(Q),l(null,re,Ee,Be,J,le,Af(Ee),Me),J&&(J.vnode.el=re.el,Sp(J,re.el)),Be},ae=(Q,re="[",J="]")=>{let le=0;for(;Q;)if(Q=y(Q),Q&&Oc(Q)&&(Q.data===re&&le++,Q.data===J)){if(le===0)return y(Q);le--}return Q},Se=(Q,re,J)=>{const le=re.parentNode;le&&le.replaceChild(Q,re);let Me=J;for(;Me;)Me.vnode.el===re&&(Me.vnode.el=Me.subTree.el=Q),Me=Me.parent},be=Q=>Q.nodeType===1&&Q.tagName==="TEMPLATE";return[P,k]}const e0="data-allow-mismatch",nE={0:"text",1:"children",2:"class",3:"style",4:"attribute"};function kf(t,n){if(n===0||n===1)for(;t&&!t.hasAttribute(e0);)t=t.parentElement;const l=t&&t.getAttribute(e0);if(l==null)return!1;if(l==="")return!0;{const h=l.split(",");return n===0&&h.includes("children")?!0:l.split(",").includes(nE[n])}}yp().requestIdleCallback;yp().cancelIdleCallback;function oE(t,n){if(Oc(t)&&t.data==="["){let l=1,h=t.nextSibling;for(;h;){if(h.nodeType===1){if(n(h)===!1)break}else if(Oc(h))if(h.data==="]"){if(--l===0)break}else h.data==="["&&l++;h=h.nextSibling}}else n(t)}const bl=t=>!!t.type.__asyncLoader;/*! #__NO_SIDE_EFFECTS__ */function Pg(t){Gt(t)&&(t={loader:t});const{loader:n,loadingComponent:l,errorComponent:h,delay:p=200,hydrate:y,timeout:m,suspensible:a=!0,onError:I}=t;let z=null,P,k=0;const N=()=>(k++,z=null,F()),F=()=>{let H;return z||(H=z=n().catch(X=>{if(X=X instanceof Error?X:new Error(String(X)),I)return new Promise((ae,Se)=>{I(X,()=>ae(N()),()=>Se(X),k+1)});throw X}).then(X=>H!==z&&z?z:(X&&(X.__esModule||X[Symbol.toStringTag]==="Module")&&(X=X.default),P=X,X)))};return Ur({name:"AsyncComponentWrapper",__asyncLoader:F,__asyncHydrate(H,X,ae){const Se=y?()=>{const be=y(ae,Q=>oE(H,Q));be&&(X.bum||(X.bum=[])).push(be)}:ae;P?Se():F().then(()=>!X.isUnmounted&&Se())},get __asyncResolved(){return P},setup(){const H=ji;if(E_(H),P)return()=>rg(P,H);const X=Q=>{z=null,Jc(Q,H,13,!h)};if(a&&H.suspense||qc)return F().then(Q=>()=>rg(Q,H)).catch(Q=>(X(Q),()=>h?cr(h,{error:Q}):null));const ae=$t(!1),Se=$t(),be=$t(!!p);return p&&setTimeout(()=>{be.value=!1},p),m!=null&&setTimeout(()=>{if(!ae.value&&!Se.value){const Q=new Error(`Async component timed out after ${m}ms.`);X(Q),Se.value=Q}},m),F().then(()=>{ae.value=!0,H.parent&&Qh(H.parent.vnode)&&H.parent.update()}).catch(Q=>{X(Q),Se.value=Q}),()=>{if(ae.value&&P)return rg(P,H);if(Se.value&&h)return cr(h,{error:Se.value});if(l&&!be.value)return cr(l)}}})}function rg(t,n){const{ref:l,props:h,children:p,ce:y}=n.vnode,m=cr(t,h,p);return m.ref=l,m.ce=y,delete n.vnode.ce,m}const Qh=t=>t.type.__isKeepAlive;function Tx(t,n){Ex(t,"a",n)}function Sx(t,n){Ex(t,"da",n)}function Ex(t,n,l=ji){const h=t.__wdc||(t.__wdc=()=>{let p=l;for(;p;){if(p.isDeactivated)return;p=p.parent}return t()});if(bp(n,h,l),l){let p=l.parent;for(;p&&p.parent;)Qh(p.parent.vnode)&&sE(h,n,l,p),p=p.parent}}function sE(t,n,l,h){const p=bp(n,t,h,!0);Qc(()=>{m_(h[n],p)},l)}function bp(t,n,l=ji,h=!1){if(l){const p=l[t]||(l[t]=[]),y=n.__weh||(n.__weh=(...m)=>{Ia();const a=ed(l),I=Io(n,l,t,m);return a(),Ma(),I});return h?p.unshift(y):p.push(y),y}}const Rs=t=>(n,l=ji)=>{(!qc||t==="sp")&&bp(t,(...h)=>n(...h),l)},aE=Rs("bm"),Sn=Rs("m"),lE=Rs("bu"),cE=Rs("u"),xp=Rs("bum"),Qc=Rs("um"),uE=Rs("sp"),hE=Rs("rtg"),dE=Rs("rtc");function Cx(t,n=ji){bp("ec",t,n)}const Ix="components";function Ag(t,n){return Px(Ix,t,!0,n)||t}const Mx=Symbol.for("v-ndc");function Sa(t){return ui(t)?Px(Ix,t,!1)||t:t||Mx}function Px(t,n,l=!0,h=!1){const p=Ni||ji;if(p){const y=p.type;{const a=rC(y,!1);if(a&&(a===n||a===ao(n)||a===_p(ao(n))))return y}const m=t0(p[t]||y[t],n)||t0(p.appContext[t],n);return!m&&h?y:m}}function t0(t,n){return t&&(t[n]||t[ao(n)]||t[_p(ao(n))])}function fE(t,n,l,h){let p;const y=l,m=Zt(t);if(m||ui(t)){const a=m&&yl(t);let I=!1;a&&(I=!oo(t),t=vp(t)),p=new Array(t.length);for(let z=0,P=t.length;z<P;z++)p[z]=n(I?fn(t[z]):t[z],z,void 0,y)}else if(typeof t=="number"){p=new Array(t);for(let a=0;a<t;a++)p[a]=n(a+1,a,void 0,y)}else if(Hr(t))if(t[Symbol.iterator])p=Array.from(t,(a,I)=>n(a,I,void 0,y));else{const a=Object.keys(t);p=new Array(a.length);for(let I=0,z=a.length;I<z;I++){const P=a[I];p[I]=n(t[P],P,I,y)}}else p=[];return p}function Ai(t,n,l={},h,p){if(Ni.ce||Ni.parent&&bl(Ni.parent)&&Ni.parent.ce)return n!=="default"&&(l.name=n),Bt(),kr(ki,null,[cr("slot",l,h&&h())],64);let y=t[n];y&&y._c&&(y._d=!1),Bt();const m=y&&Ax(y(l)),a=l.key||m&&m.key,I=kr(ki,{key:(a&&!zs(a)?a:`_${n}`)+(!m&&h?"_fb":"")},m||(h?h():[]),m&&t._===1?64:-2);return I.scopeId&&(I.slotScopeIds=[I.scopeId+"-s"]),y&&y._c&&(y._d=!0),I}function Ax(t){return t.some(n=>Zc(n)?!(n.type===Hi||n.type===ki&&!Ax(n.children)):!0)?t:null}const kg=t=>t?t1(t)?Ep(t):kg(t.parent):null,Lh=Wi(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>kg(t.parent),$root:t=>kg(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>Lx(t),$forceUpdate:t=>t.f||(t.f=()=>{S_(t.update)}),$nextTick:t=>t.n||(t.n=tn.bind(t.proxy)),$watch:t=>DE.bind(t)}),ig=(t,n)=>t!==$r&&!t.__isScriptSetup&&Cr(t,n),pE={get({_:t},n){if(n==="__v_skip")return!0;const{ctx:l,setupState:h,data:p,props:y,accessCache:m,type:a,appContext:I}=t;let z;if(n[0]!=="$"){const F=m[n];if(F!==void 0)switch(F){case 1:return h[n];case 2:return p[n];case 4:return l[n];case 3:return y[n]}else{if(ig(h,n))return m[n]=1,h[n];if(p!==$r&&Cr(p,n))return m[n]=2,p[n];if((z=t.propsOptions[0])&&Cr(z,n))return m[n]=3,y[n];if(l!==$r&&Cr(l,n))return m[n]=4,l[n];Lg&&(m[n]=0)}}const P=Lh[n];let k,N;if(P)return n==="$attrs"&&dn(t.attrs,"get",""),P(t);if((k=a.__cssModules)&&(k=k[n]))return k;if(l!==$r&&Cr(l,n))return m[n]=4,l[n];if(N=I.config.globalProperties,Cr(N,n))return N[n]},set({_:t},n,l){const{data:h,setupState:p,ctx:y}=t;return ig(p,n)?(p[n]=l,!0):h!==$r&&Cr(h,n)?(h[n]=l,!0):Cr(t.props,n)||n[0]==="$"&&n.slice(1)in t?!1:(y[n]=l,!0)},has({_:{data:t,setupState:n,accessCache:l,ctx:h,appContext:p,propsOptions:y}},m){let a;return!!l[m]||t!==$r&&Cr(t,m)||ig(n,m)||(a=y[0])&&Cr(a,m)||Cr(h,m)||Cr(Lh,m)||Cr(p.config.globalProperties,m)},defineProperty(t,n,l){return l.get!=null?t._.accessCache[n]=0:Cr(l,"value")&&this.set(t,n,l.value,null),Reflect.defineProperty(t,n,l)}};function mE(){return gE().attrs}function gE(){const t=eu();return t.setupContext||(t.setupContext=i1(t))}function r0(t){return Zt(t)?t.reduce((n,l)=>(n[l]=null,n),{}):t}let Lg=!0;function _E(t){const n=Lx(t),l=t.proxy,h=t.ctx;Lg=!1,n.beforeCreate&&i0(n.beforeCreate,t,"bc");const{data:p,computed:y,methods:m,watch:a,provide:I,inject:z,created:P,beforeMount:k,mounted:N,beforeUpdate:F,updated:H,activated:X,deactivated:ae,beforeDestroy:Se,beforeUnmount:be,destroyed:Q,unmounted:re,render:J,renderTracked:le,renderTriggered:Me,errorCaptured:Ie,serverPrefetch:Be,expose:Ee,inheritAttrs:Re,components:Ae,directives:He,filters:it}=n;if(z&&yE(z,h,null),m)for(const xt in m){const yt=m[xt];Gt(yt)&&(h[xt]=yt.bind(l))}if(p){const xt=p.call(l,l);Hr(xt)&&(t.data=Co(xt))}if(Lg=!0,y)for(const xt in y){const yt=y[xt],Rt=Gt(yt)?yt.bind(l,l):Gt(yt.get)?yt.get.bind(l,l):Wo,Mr=!Gt(yt)&&Gt(yt.set)?yt.set.bind(l):Wo,_r=Ye({get:Rt,set:Mr});Object.defineProperty(h,xt,{enumerable:!0,configurable:!0,get:()=>_r.value,set:pr=>_r.value=pr})}if(a)for(const xt in a)kx(a[xt],h,l,xt);if(I){const xt=Gt(I)?I.call(l):I;Reflect.ownKeys(xt).forEach(yt=>{Pa(yt,xt[yt])})}P&&i0(P,t,"c");function Xe(xt,yt){Zt(yt)?yt.forEach(Rt=>xt(Rt.bind(l))):yt&&xt(yt.bind(l))}if(Xe(aE,k),Xe(Sn,N),Xe(lE,F),Xe(cE,H),Xe(Tx,X),Xe(Sx,ae),Xe(Cx,Ie),Xe(dE,le),Xe(hE,Me),Xe(xp,be),Xe(Qc,re),Xe(uE,Be),Zt(Ee))if(Ee.length){const xt=t.exposed||(t.exposed={});Ee.forEach(yt=>{Object.defineProperty(xt,yt,{get:()=>l[yt],set:Rt=>l[yt]=Rt})})}else t.exposed||(t.exposed={});J&&t.render===Wo&&(t.render=J),Re!=null&&(t.inheritAttrs=Re),Ae&&(t.components=Ae),He&&(t.directives=He),Be&&E_(t)}function yE(t,n,l=Wo){Zt(t)&&(t=zg(t));for(const h in t){const p=t[h];let y;Hr(p)?"default"in p?y=nn(p.from||h,p.default,!0):y=nn(p.from||h):y=nn(p),li(y)?Object.defineProperty(n,h,{enumerable:!0,configurable:!0,get:()=>y.value,set:m=>y.value=m}):n[h]=y}}function i0(t,n,l){Io(Zt(t)?t.map(h=>h.bind(n.proxy)):t.bind(n.proxy),n,l)}function kx(t,n,l,h){let p=h.includes(".")?Hx(l,h):()=>l[h];if(ui(t)){const y=n[t];Gt(y)&&Li(p,y)}else if(Gt(t))Li(p,t.bind(l));else if(Hr(t))if(Zt(t))t.forEach(y=>kx(y,n,l,h));else{const y=Gt(t.handler)?t.handler.bind(l):n[t.handler];Gt(y)&&Li(p,y,t)}}function Lx(t){const n=t.type,{mixins:l,extends:h}=n,{mixins:p,optionsCache:y,config:{optionMergeStrategies:m}}=t.appContext,a=y.get(n);let I;return a?I=a:!p.length&&!l&&!h?I=n:(I={},p.length&&p.forEach(z=>ep(I,z,m,!0)),ep(I,n,m)),Hr(n)&&y.set(n,I),I}function ep(t,n,l,h=!1){const{mixins:p,extends:y}=n;y&&ep(t,y,l,!0),p&&p.forEach(m=>ep(t,m,l,!0));for(const m in n)if(!(h&&m==="expose")){const a=vE[m]||l&&l[m];t[m]=a?a(t[m],n[m]):n[m]}return t}const vE={data:n0,props:o0,emits:o0,methods:Mh,computed:Mh,beforeCreate:bn,created:bn,beforeMount:bn,mounted:bn,beforeUpdate:bn,updated:bn,beforeDestroy:bn,beforeUnmount:bn,destroyed:bn,unmounted:bn,activated:bn,deactivated:bn,errorCaptured:bn,serverPrefetch:bn,components:Mh,directives:Mh,watch:xE,provide:n0,inject:bE};function n0(t,n){return n?t?function(){return Wi(Gt(t)?t.call(this,this):t,Gt(n)?n.call(this,this):n)}:n:t}function bE(t,n){return Mh(zg(t),zg(n))}function zg(t){if(Zt(t)){const n={};for(let l=0;l<t.length;l++)n[t[l]]=t[l];return n}return t}function bn(t,n){return t?[...new Set([].concat(t,n))]:n}function Mh(t,n){return t?Wi(Object.create(null),t,n):n}function o0(t,n){return t?Zt(t)&&Zt(n)?[...new Set([...t,...n])]:Wi(Object.create(null),r0(t),r0(n??{})):n}function xE(t,n){if(!t)return n;if(!n)return t;const l=Wi(Object.create(null),t);for(const h in n)l[h]=bn(t[h],n[h]);return l}function zx(){return{app:null,config:{isNativeTag:oS,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let wE=0;function TE(t,n){return function(h,p=null){Gt(h)||(h=Wi({},h)),p!=null&&!Hr(p)&&(p=null);const y=zx(),m=new WeakSet,a=[];let I=!1;const z=y.app={_uid:wE++,_component:h,_props:p,_container:null,_context:y,_instance:null,version:nC,get config(){return y.config},set config(P){},use(P,...k){return m.has(P)||(P&&Gt(P.install)?(m.add(P),P.install(z,...k)):Gt(P)&&(m.add(P),P(z,...k))),z},mixin(P){return y.mixins.includes(P)||y.mixins.push(P),z},component(P,k){return k?(y.components[P]=k,z):y.components[P]},directive(P,k){return k?(y.directives[P]=k,z):y.directives[P]},mount(P,k,N){if(!I){const F=z._ceVNode||cr(h,p);return F.appContext=y,N===!0?N="svg":N===!1&&(N=void 0),k&&n?n(F,P):t(F,P,N),I=!0,z._container=P,P.__vue_app__=z,Ep(F.component)}},onUnmount(P){a.push(P)},unmount(){I&&(Io(a,z._instance,16),t(null,z._container),delete z._container.__vue_app__)},provide(P,k){return y.provides[P]=k,z},runWithContext(P){const k=xl;xl=z;try{return P()}finally{xl=k}}};return z}}let xl=null;function Pa(t,n){if(ji){let l=ji.provides;const h=ji.parent&&ji.parent.provides;h===l&&(l=ji.provides=Object.create(h)),l[t]=n}}function nn(t,n,l=!1){const h=ji||Ni;if(h||xl){const p=xl?xl._context.provides:h?h.parent==null?h.vnode.appContext&&h.vnode.appContext.provides:h.parent.provides:void 0;if(p&&t in p)return p[t];if(arguments.length>1)return l&&Gt(n)?n.call(h&&h.proxy):n}}function wp(){return!!(ji||Ni||xl)}const Rx={},Dx=()=>Object.create(Rx),Ox=t=>Object.getPrototypeOf(t)===Rx;function SE(t,n,l,h=!1){const p={},y=Dx();t.propsDefaults=Object.create(null),Fx(t,n,p,y);for(const m in t.propsOptions[0])m in p||(p[m]=void 0);l?t.props=h?p:Dc(p):t.type.props?t.props=p:t.props=y,t.attrs=y}function EE(t,n,l,h){const{props:p,attrs:y,vnode:{patchFlag:m}}=t,a=Vt(p),[I]=t.propsOptions;let z=!1;if((h||m>0)&&!(m&16)){if(m&8){const P=t.vnode.dynamicProps;for(let k=0;k<P.length;k++){let N=P[k];if(Tp(t.emitsOptions,N))continue;const F=n[N];if(I)if(Cr(y,N))F!==y[N]&&(y[N]=F,z=!0);else{const H=ao(N);p[H]=Rg(I,a,H,F,t,!1)}else F!==y[N]&&(y[N]=F,z=!0)}}}else{Fx(t,n,p,y)&&(z=!0);let P;for(const k in a)(!n||!Cr(n,k)&&((P=kl(k))===k||!Cr(n,P)))&&(I?l&&(l[k]!==void 0||l[P]!==void 0)&&(p[k]=Rg(I,a,k,void 0,t,!0)):delete p[k]);if(y!==a)for(const k in y)(!n||!Cr(n,k))&&(delete y[k],z=!0)}z&&Ps(t.attrs,"set","")}function Fx(t,n,l,h){const[p,y]=t.propsOptions;let m=!1,a;if(n)for(let I in n){if(Nc(I))continue;const z=n[I];let P;p&&Cr(p,P=ao(I))?!y||!y.includes(P)?l[P]=z:(a||(a={}))[P]=z:Tp(t.emitsOptions,I)||(!(I in h)||z!==h[I])&&(h[I]=z,m=!0)}if(y){const I=Vt(l),z=a||$r;for(let P=0;P<y.length;P++){const k=y[P];l[k]=Rg(p,I,k,z[k],t,!Cr(z,k))}}return m}function Rg(t,n,l,h,p,y){const m=t[l];if(m!=null){const a=Cr(m,"default");if(a&&h===void 0){const I=m.default;if(m.type!==Function&&!m.skipFactory&&Gt(I)){const{propsDefaults:z}=p;if(l in z)h=z[l];else{const P=ed(p);h=z[l]=I.call(null,n),P()}}else h=I;p.ce&&p.ce._setProp(l,h)}m[0]&&(y&&!a?h=!1:m[1]&&(h===""||h===kl(l))&&(h=!0))}return h}const CE=new WeakMap;function Bx(t,n,l=!1){const h=l?CE:n.propsCache,p=h.get(t);if(p)return p;const y=t.props,m={},a=[];let I=!1;if(!Gt(t)){const P=k=>{I=!0;const[N,F]=Bx(k,n,!0);Wi(m,N),F&&a.push(...F)};!l&&n.mixins.length&&n.mixins.forEach(P),t.extends&&P(t.extends),t.mixins&&t.mixins.forEach(P)}if(!y&&!I)return Hr(t)&&h.set(t,Bc),Bc;if(Zt(y))for(let P=0;P<y.length;P++){const k=ao(y[P]);s0(k)&&(m[k]=$r)}else if(y)for(const P in y){const k=ao(P);if(s0(k)){const N=y[P],F=m[k]=Zt(N)||Gt(N)?{type:N}:Wi({},N),H=F.type;let X=!1,ae=!0;if(Zt(H))for(let Se=0;Se<H.length;++Se){const be=H[Se],Q=Gt(be)&&be.name;if(Q==="Boolean"){X=!0;break}else Q==="String"&&(ae=!1)}else X=Gt(H)&&H.name==="Boolean";F[0]=X,F[1]=ae,(X||Cr(F,"default"))&&a.push(k)}}const z=[m,a];return Hr(t)&&h.set(t,z),z}function s0(t){return t[0]!=="$"&&!Nc(t)}const jx=t=>t[0]==="_"||t==="$stable",C_=t=>Zt(t)?t.map(Vn):[Vn(t)],IE=(t,n,l)=>{if(n._n)return n;const h=Zi((...p)=>C_(n(...p)),l);return h._c=!1,h},Nx=(t,n,l)=>{const h=t._ctx;for(const p in t){if(jx(p))continue;const y=t[p];if(Gt(y))n[p]=IE(p,y,h);else if(y!=null){const m=C_(y);n[p]=()=>m}}},Vx=(t,n)=>{const l=C_(n);t.slots.default=()=>l},$x=(t,n,l)=>{for(const h in n)(l||h!=="_")&&(t[h]=n[h])},ME=(t,n,l)=>{const h=t.slots=Dx();if(t.vnode.shapeFlag&32){const p=n._;p?($x(h,n,l),l&&$b(h,"_",p,!0)):Nx(n,h)}else n&&Vx(t,n)},PE=(t,n,l)=>{const{vnode:h,slots:p}=t;let y=!0,m=$r;if(h.shapeFlag&32){const a=n._;a?l&&a===1?y=!1:$x(p,n,l):(y=!n.$stable,Nx(n,p)),m=n}else n&&(Vx(t,n),m={default:1});if(y)for(const a in p)!jx(a)&&m[a]==null&&delete p[a]},jn=Yx;function AE(t){return Ux(t)}function kE(t){return Ux(t,iE)}function Ux(t,n){const l=yp();l.__VUE__=!0;const{insert:h,remove:p,patchProp:y,createElement:m,createText:a,createComment:I,setText:z,setElementText:P,parentNode:k,nextSibling:N,setScopeId:F=Wo,insertStaticContent:H}=t,X=(pe,we,We,at=null,nt=null,st=null,_t=void 0,ut=null,ht=!!we.dynamicChildren)=>{if(pe===we)return;pe&&!Ho(pe,we)&&(at=Jt(pe),pr(pe,nt,st,!0),pe=null),we.patchFlag===-2&&(ht=!1,we.dynamicChildren=null);const{type:lt,ref:Lt,shapeFlag:bt}=we;switch(lt){case wl:ae(pe,we,We,at);break;case Hi:Se(pe,we,We,at);break;case Bf:pe==null&&be(we,We,at,_t);break;case ki:Ae(pe,we,We,at,nt,st,_t,ut,ht);break;default:bt&1?J(pe,we,We,at,nt,st,_t,ut,ht):bt&6?He(pe,we,We,at,nt,st,_t,ut,ht):(bt&64||bt&128)&&lt.process(pe,we,We,at,nt,st,_t,ut,ht,Ti)}Lt!=null&&nt&&Uh(Lt,pe&&pe.ref,st,we||pe,!we)},ae=(pe,we,We,at)=>{if(pe==null)h(we.el=a(we.children),We,at);else{const nt=we.el=pe.el;we.children!==pe.children&&z(nt,we.children)}},Se=(pe,we,We,at)=>{pe==null?h(we.el=I(we.children||""),We,at):we.el=pe.el},be=(pe,we,We,at)=>{[pe.el,pe.anchor]=H(pe.children,we,We,at,pe.el,pe.anchor)},Q=({el:pe,anchor:we},We,at)=>{let nt;for(;pe&&pe!==we;)nt=N(pe),h(pe,We,at),pe=nt;h(we,We,at)},re=({el:pe,anchor:we})=>{let We;for(;pe&&pe!==we;)We=N(pe),p(pe),pe=We;p(we)},J=(pe,we,We,at,nt,st,_t,ut,ht)=>{we.type==="svg"?_t="svg":we.type==="math"&&(_t="mathml"),pe==null?le(we,We,at,nt,st,_t,ut,ht):Be(pe,we,nt,st,_t,ut,ht)},le=(pe,we,We,at,nt,st,_t,ut)=>{let ht,lt;const{props:Lt,shapeFlag:bt,transition:It,dirs:Ot}=pe;if(ht=pe.el=m(pe.type,st,Lt&&Lt.is,Lt),bt&8?P(ht,pe.children):bt&16&&Ie(pe.children,ht,null,at,nt,ng(pe,st),_t,ut),Ot&&qo(pe,null,at,"created"),Me(ht,pe,pe.scopeId,_t,at),Lt){for(const ir in Lt)ir!=="value"&&!Nc(ir)&&y(ht,ir,null,Lt[ir],st,at);"value"in Lt&&y(ht,"value",null,Lt.value,st),(lt=Lt.onVnodeBeforeMount)&&no(lt,at,pe)}Ot&&qo(pe,null,at,"beforeMount");const qt=Gx(nt,It);qt&&It.beforeEnter(ht),h(ht,we,We),((lt=Lt&&Lt.onVnodeMounted)||qt||Ot)&&jn(()=>{lt&&no(lt,at,pe),qt&&It.enter(ht),Ot&&qo(pe,null,at,"mounted")},nt)},Me=(pe,we,We,at,nt)=>{if(We&&F(pe,We),at)for(let st=0;st<at.length;st++)F(pe,at[st]);if(nt){let st=nt.subTree;if(we===st||Kx(st.type)&&(st.ssContent===we||st.ssFallback===we)){const _t=nt.vnode;Me(pe,_t,_t.scopeId,_t.slotScopeIds,nt.parent)}}},Ie=(pe,we,We,at,nt,st,_t,ut,ht=0)=>{for(let lt=ht;lt<pe.length;lt++){const Lt=pe[lt]=ut?wa(pe[lt]):Vn(pe[lt]);X(null,Lt,we,We,at,nt,st,_t,ut)}},Be=(pe,we,We,at,nt,st,_t)=>{const ut=we.el=pe.el;let{patchFlag:ht,dynamicChildren:lt,dirs:Lt}=we;ht|=pe.patchFlag&16;const bt=pe.props||$r,It=we.props||$r;let Ot;if(We&&ul(We,!1),(Ot=It.onVnodeBeforeUpdate)&&no(Ot,We,we,pe),Lt&&qo(we,pe,We,"beforeUpdate"),We&&ul(We,!0),(bt.innerHTML&&It.innerHTML==null||bt.textContent&&It.textContent==null)&&P(ut,""),lt?Ee(pe.dynamicChildren,lt,ut,We,at,ng(we,nt),st):_t||yt(pe,we,ut,null,We,at,ng(we,nt),st,!1),ht>0){if(ht&16)Re(ut,bt,It,We,nt);else if(ht&2&&bt.class!==It.class&&y(ut,"class",null,It.class,nt),ht&4&&y(ut,"style",bt.style,It.style,nt),ht&8){const qt=we.dynamicProps;for(let ir=0;ir<qt.length;ir++){const er=qt[ir],Wr=bt[er],Kr=It[er];(Kr!==Wr||er==="value")&&y(ut,er,Wr,Kr,nt,We)}}ht&1&&pe.children!==we.children&&P(ut,we.children)}else!_t&&lt==null&&Re(ut,bt,It,We,nt);((Ot=It.onVnodeUpdated)||Lt)&&jn(()=>{Ot&&no(Ot,We,we,pe),Lt&&qo(we,pe,We,"updated")},at)},Ee=(pe,we,We,at,nt,st,_t)=>{for(let ut=0;ut<we.length;ut++){const ht=pe[ut],lt=we[ut],Lt=ht.el&&(ht.type===ki||!Ho(ht,lt)||ht.shapeFlag&70)?k(ht.el):We;X(ht,lt,Lt,null,at,nt,st,_t,!0)}},Re=(pe,we,We,at,nt)=>{if(we!==We){if(we!==$r)for(const st in we)!Nc(st)&&!(st in We)&&y(pe,st,we[st],null,nt,at);for(const st in We){if(Nc(st))continue;const _t=We[st],ut=we[st];_t!==ut&&st!=="value"&&y(pe,st,ut,_t,nt,at)}"value"in We&&y(pe,"value",we.value,We.value,nt)}},Ae=(pe,we,We,at,nt,st,_t,ut,ht)=>{const lt=we.el=pe?pe.el:a(""),Lt=we.anchor=pe?pe.anchor:a("");let{patchFlag:bt,dynamicChildren:It,slotScopeIds:Ot}=we;Ot&&(ut=ut?ut.concat(Ot):Ot),pe==null?(h(lt,We,at),h(Lt,We,at),Ie(we.children||[],We,Lt,nt,st,_t,ut,ht)):bt>0&&bt&64&&It&&pe.dynamicChildren?(Ee(pe.dynamicChildren,It,We,nt,st,_t,ut),(we.key!=null||nt&&we===nt.subTree)&&Zx(pe,we,!0)):yt(pe,we,We,Lt,nt,st,_t,ut,ht)},He=(pe,we,We,at,nt,st,_t,ut,ht)=>{we.slotScopeIds=ut,pe==null?we.shapeFlag&512?nt.ctx.activate(we,We,at,_t,ht):it(we,We,at,nt,st,_t,ht):vt(pe,we,ht)},it=(pe,we,We,at,nt,st,_t)=>{const ut=pe.component=JE(pe,at,nt);if(Qh(pe)&&(ut.ctx.renderer=Ti),QE(ut,!1,_t),ut.asyncDep){if(nt&&nt.registerDep(ut,Xe,_t),!pe.el){const ht=ut.subTree=cr(Hi);Se(null,ht,we,We)}}else Xe(ut,pe,we,We,nt,st,_t)},vt=(pe,we,We)=>{const at=we.component=pe.component;if(VE(pe,we,We))if(at.asyncDep&&!at.asyncResolved){xt(at,we,We);return}else at.next=we,at.update();else we.el=pe.el,at.vnode=we},Xe=(pe,we,We,at,nt,st,_t)=>{const ut=()=>{if(pe.isMounted){let{next:bt,bu:It,u:Ot,parent:qt,vnode:ir}=pe;{const Si=qx(pe);if(Si){bt&&(bt.el=ir.el,xt(pe,bt,_t)),Si.asyncDep.then(()=>{pe.isUnmounted||ut()});return}}let er=bt,Wr;ul(pe,!1),bt?(bt.el=ir.el,xt(pe,bt,_t)):bt=ir,It&&Xm(It),(Wr=bt.props&&bt.props.onVnodeBeforeUpdate)&&no(Wr,qt,bt,ir),ul(pe,!0);const Kr=og(pe),zi=pe.subTree;pe.subTree=Kr,X(zi,Kr,k(zi.el),Jt(zi),pe,nt,st),bt.el=Kr.el,er===null&&Sp(pe,Kr.el),Ot&&jn(Ot,nt),(Wr=bt.props&&bt.props.onVnodeUpdated)&&jn(()=>no(Wr,qt,bt,ir),nt)}else{let bt;const{el:It,props:Ot}=we,{bm:qt,m:ir,parent:er,root:Wr,type:Kr}=pe,zi=bl(we);if(ul(pe,!1),qt&&Xm(qt),!zi&&(bt=Ot&&Ot.onVnodeBeforeMount)&&no(bt,er,we),ul(pe,!0),It&&Sr){const Si=()=>{pe.subTree=og(pe),Sr(It,pe.subTree,pe,nt,null)};zi&&Kr.__asyncHydrate?Kr.__asyncHydrate(It,pe,Si):Si()}else{Wr.ce&&Wr.ce._injectChildStyle(Kr);const Si=pe.subTree=og(pe);X(null,Si,We,at,pe,nt,st),we.el=Si.el}if(ir&&jn(ir,nt),!zi&&(bt=Ot&&Ot.onVnodeMounted)){const Si=we;jn(()=>no(bt,er,Si),nt)}(we.shapeFlag&256||er&&bl(er.vnode)&&er.vnode.shapeFlag&256)&&pe.a&&jn(pe.a,nt),pe.isMounted=!0,we=We=at=null}};pe.scope.on();const ht=pe.effect=new Kb(ut);pe.scope.off();const lt=pe.update=ht.run.bind(ht),Lt=pe.job=ht.runIfDirty.bind(ht);Lt.i=pe,Lt.id=pe.uid,ht.scheduler=()=>S_(Lt),ul(pe,!0),lt()},xt=(pe,we,We)=>{we.component=pe;const at=pe.vnode.props;pe.vnode=we,pe.next=null,EE(pe,we.props,at,We),PE(pe,we.children,We),Ia(),Yv(pe),Ma()},yt=(pe,we,We,at,nt,st,_t,ut,ht=!1)=>{const lt=pe&&pe.children,Lt=pe?pe.shapeFlag:0,bt=we.children,{patchFlag:It,shapeFlag:Ot}=we;if(It>0){if(It&128){Mr(lt,bt,We,at,nt,st,_t,ut,ht);return}else if(It&256){Rt(lt,bt,We,at,nt,st,_t,ut,ht);return}}Ot&8?(Lt&16&&Yt(lt,nt,st),bt!==lt&&P(We,bt)):Lt&16?Ot&16?Mr(lt,bt,We,at,nt,st,_t,ut,ht):Yt(lt,nt,st,!0):(Lt&8&&P(We,""),Ot&16&&Ie(bt,We,at,nt,st,_t,ut,ht))},Rt=(pe,we,We,at,nt,st,_t,ut,ht)=>{pe=pe||Bc,we=we||Bc;const lt=pe.length,Lt=we.length,bt=Math.min(lt,Lt);let It;for(It=0;It<bt;It++){const Ot=we[It]=ht?wa(we[It]):Vn(we[It]);X(pe[It],Ot,We,null,nt,st,_t,ut,ht)}lt>Lt?Yt(pe,nt,st,!0,!1,bt):Ie(we,We,at,nt,st,_t,ut,ht,bt)},Mr=(pe,we,We,at,nt,st,_t,ut,ht)=>{let lt=0;const Lt=we.length;let bt=pe.length-1,It=Lt-1;for(;lt<=bt&&lt<=It;){const Ot=pe[lt],qt=we[lt]=ht?wa(we[lt]):Vn(we[lt]);if(Ho(Ot,qt))X(Ot,qt,We,null,nt,st,_t,ut,ht);else break;lt++}for(;lt<=bt&&lt<=It;){const Ot=pe[bt],qt=we[It]=ht?wa(we[It]):Vn(we[It]);if(Ho(Ot,qt))X(Ot,qt,We,null,nt,st,_t,ut,ht);else break;bt--,It--}if(lt>bt){if(lt<=It){const Ot=It+1,qt=Ot<Lt?we[Ot].el:at;for(;lt<=It;)X(null,we[lt]=ht?wa(we[lt]):Vn(we[lt]),We,qt,nt,st,_t,ut,ht),lt++}}else if(lt>It)for(;lt<=bt;)pr(pe[lt],nt,st,!0),lt++;else{const Ot=lt,qt=lt,ir=new Map;for(lt=qt;lt<=It;lt++){const q=we[lt]=ht?wa(we[lt]):Vn(we[lt]);q.key!=null&&ir.set(q.key,lt)}let er,Wr=0;const Kr=It-qt+1;let zi=!1,Si=0;const Ki=new Array(Kr);for(lt=0;lt<Kr;lt++)Ki[lt]=0;for(lt=Ot;lt<=bt;lt++){const q=pe[lt];if(Wr>=Kr){pr(q,nt,st,!0);continue}let Y;if(q.key!=null)Y=ir.get(q.key);else for(er=qt;er<=It;er++)if(Ki[er-qt]===0&&Ho(q,we[er])){Y=er;break}Y===void 0?pr(q,nt,st,!0):(Ki[Y-qt]=lt+1,Y>=Si?Si=Y:zi=!0,X(q,we[Y],We,null,nt,st,_t,ut,ht),Wr++)}const Pe=zi?LE(Ki):Bc;for(er=Pe.length-1,lt=Kr-1;lt>=0;lt--){const q=qt+lt,Y=we[q],U=q+1<Lt?we[q+1].el:at;Ki[lt]===0?X(null,Y,We,U,nt,st,_t,ut,ht):zi&&(er<0||lt!==Pe[er]?_r(Y,We,U,2):er--)}}},_r=(pe,we,We,at,nt=null)=>{const{el:st,type:_t,transition:ut,children:ht,shapeFlag:lt}=pe;if(lt&6){_r(pe.component.subTree,we,We,at);return}if(lt&128){pe.suspense.move(we,We,at);return}if(lt&64){_t.move(pe,we,We,Ti);return}if(_t===ki){h(st,we,We);for(let bt=0;bt<ht.length;bt++)_r(ht[bt],we,We,at);h(pe.anchor,we,We);return}if(_t===Bf){Q(pe,we,We);return}if(at!==2&&lt&1&&ut)if(at===0)ut.beforeEnter(st),h(st,we,We),jn(()=>ut.enter(st),nt);else{const{leave:bt,delayLeave:It,afterLeave:Ot}=ut,qt=()=>h(st,we,We),ir=()=>{bt(st,()=>{qt(),Ot&&Ot()})};It?It(st,qt,ir):ir()}else h(st,we,We)},pr=(pe,we,We,at=!1,nt=!1)=>{const{type:st,props:_t,ref:ut,children:ht,dynamicChildren:lt,shapeFlag:Lt,patchFlag:bt,dirs:It,cacheIndex:Ot}=pe;if(bt===-2&&(nt=!1),ut!=null&&Uh(ut,null,We,pe,!0),Ot!=null&&(we.renderCache[Ot]=void 0),Lt&256){we.ctx.deactivate(pe);return}const qt=Lt&1&&It,ir=!bl(pe);let er;if(ir&&(er=_t&&_t.onVnodeBeforeUnmount)&&no(er,we,pe),Lt&6)Pt(pe.component,We,at);else{if(Lt&128){pe.suspense.unmount(We,at);return}qt&&qo(pe,null,we,"beforeUnmount"),Lt&64?pe.type.remove(pe,we,We,Ti,at):lt&&!lt.hasOnce&&(st!==ki||bt>0&&bt&64)?Yt(lt,we,We,!1,!0):(st===ki&&bt&384||!nt&&Lt&16)&&Yt(ht,we,We),at&&Tr(pe)}(ir&&(er=_t&&_t.onVnodeUnmounted)||qt)&&jn(()=>{er&&no(er,we,pe),qt&&qo(pe,null,we,"unmounted")},We)},Tr=pe=>{const{type:we,el:We,anchor:at,transition:nt}=pe;if(we===ki){Lr(We,at);return}if(we===Bf){re(pe);return}const st=()=>{p(We),nt&&!nt.persisted&&nt.afterLeave&&nt.afterLeave()};if(pe.shapeFlag&1&&nt&&!nt.persisted){const{leave:_t,delayLeave:ut}=nt,ht=()=>_t(We,st);ut?ut(pe.el,st,ht):ht()}else st()},Lr=(pe,we)=>{let We;for(;pe!==we;)We=N(pe),p(pe),pe=We;p(we)},Pt=(pe,we,We)=>{const{bum:at,scope:nt,job:st,subTree:_t,um:ut,m:ht,a:lt}=pe;a0(ht),a0(lt),at&&Xm(at),nt.stop(),st&&(st.flags|=8,pr(_t,pe,we,We)),ut&&jn(ut,we),jn(()=>{pe.isUnmounted=!0},we),we&&we.pendingBranch&&!we.isUnmounted&&pe.asyncDep&&!pe.asyncResolved&&pe.suspenseId===we.pendingId&&(we.deps--,we.deps===0&&we.resolve())},Yt=(pe,we,We,at=!1,nt=!1,st=0)=>{for(let _t=st;_t<pe.length;_t++)pr(pe[_t],we,We,at,nt)},Jt=pe=>{if(pe.shapeFlag&6)return Jt(pe.component.subTree);if(pe.shapeFlag&128)return pe.suspense.next();const we=N(pe.anchor||pe.el),We=we&&we[YS];return We?N(We):we};let hr=!1;const vr=(pe,we,We)=>{pe==null?we._vnode&&pr(we._vnode,null,null,!0):X(we._vnode||null,pe,we,null,null,null,We),we._vnode=pe,hr||(hr=!0,Yv(),Jf(),hr=!1)},Ti={p:X,um:pr,m:_r,r:Tr,mt:it,mc:Ie,pc:yt,pbc:Ee,n:Jt,o:t};let Pr,Sr;return n&&([Pr,Sr]=n(Ti)),{render:vr,hydrate:Pr,createApp:TE(vr,Pr)}}function ng({type:t,props:n},l){return l==="svg"&&t==="foreignObject"||l==="mathml"&&t==="annotation-xml"&&n&&n.encoding&&n.encoding.includes("html")?void 0:l}function ul({effect:t,job:n},l){l?(t.flags|=32,n.flags|=4):(t.flags&=-33,n.flags&=-5)}function Gx(t,n){return(!t||t&&!t.pendingBranch)&&n&&!n.persisted}function Zx(t,n,l=!1){const h=t.children,p=n.children;if(Zt(h)&&Zt(p))for(let y=0;y<h.length;y++){const m=h[y];let a=p[y];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=p[y]=wa(p[y]),a.el=m.el),!l&&a.patchFlag!==-2&&Zx(m,a)),a.type===wl&&(a.el=m.el)}}function LE(t){const n=t.slice(),l=[0];let h,p,y,m,a;const I=t.length;for(h=0;h<I;h++){const z=t[h];if(z!==0){if(p=l[l.length-1],t[p]<z){n[h]=p,l.push(h);continue}for(y=0,m=l.length-1;y<m;)a=y+m>>1,t[l[a]]<z?y=a+1:m=a;z<t[l[y]]&&(y>0&&(n[h]=l[y-1]),l[y]=h)}}for(y=l.length,m=l[y-1];y-- >0;)l[y]=m,m=n[m];return l}function qx(t){const n=t.subTree.component;if(n)return n.asyncDep&&!n.asyncResolved?n:qx(n)}function a0(t){if(t)for(let n=0;n<t.length;n++)t[n].flags|=8}const zE=Symbol.for("v-scx"),RE=()=>nn(zE);function lo(t,n){return I_(t,null,n)}function Li(t,n,l){return I_(t,n,l)}function I_(t,n,l=$r){const{immediate:h,deep:p,flush:y,once:m}=l,a=Wi({},l),I=n&&h||!n&&y!=="post";let z;if(qc){if(y==="sync"){const F=RE();z=F.__watcherHandles||(F.__watcherHandles=[])}else if(!I){const F=()=>{};return F.stop=Wo,F.resume=Wo,F.pause=Wo,F}}const P=ji;a.call=(F,H,X)=>Io(F,P,H,X);let k=!1;y==="post"?a.scheduler=F=>{jn(F,P&&P.suspense)}:y!=="sync"&&(k=!0,a.scheduler=(F,H)=>{H?F():S_(F)}),a.augmentJob=F=>{n&&(F.flags|=4),k&&(F.flags|=2,P&&(F.id=P.uid,F.i=P))};const N=HS(t,n,a);return qc&&(z?z.push(N):I&&N()),N}function DE(t,n,l){const h=this.proxy,p=ui(t)?t.includes(".")?Hx(h,t):()=>h[t]:t.bind(h,h);let y;Gt(n)?y=n:(y=n.handler,l=n);const m=ed(this),a=I_(p,y.bind(h),l);return m(),a}function Hx(t,n){const l=n.split(".");return()=>{let h=t;for(let p=0;p<l.length&&h;p++)h=h[l[p]];return h}}const OE=(t,n)=>n==="modelValue"||n==="model-value"?t.modelModifiers:t[`${n}Modifiers`]||t[`${ao(n)}Modifiers`]||t[`${kl(n)}Modifiers`];function FE(t,n,...l){if(t.isUnmounted)return;const h=t.vnode.props||$r;let p=l;const y=n.startsWith("update:"),m=y&&OE(h,n.slice(7));m&&(m.trim&&(p=l.map(P=>ui(P)?P.trim():P)),m.number&&(p=l.map(uS)));let a,I=h[a=Km(n)]||h[a=Km(ao(n))];!I&&y&&(I=h[a=Km(kl(n))]),I&&Io(I,t,6,p);const z=h[a+"Once"];if(z){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,Io(z,t,6,p)}}function Wx(t,n,l=!1){const h=n.emitsCache,p=h.get(t);if(p!==void 0)return p;const y=t.emits;let m={},a=!1;if(!Gt(t)){const I=z=>{const P=Wx(z,n,!0);P&&(a=!0,Wi(m,P))};!l&&n.mixins.length&&n.mixins.forEach(I),t.extends&&I(t.extends),t.mixins&&t.mixins.forEach(I)}return!y&&!a?(Hr(t)&&h.set(t,null),null):(Zt(y)?y.forEach(I=>m[I]=null):Wi(m,y),Hr(t)&&h.set(t,m),m)}function Tp(t,n){return!t||!Xh(n)?!1:(n=n.slice(2).replace(/Once$/,""),Cr(t,n[0].toLowerCase()+n.slice(1))||Cr(t,kl(n))||Cr(t,n))}function og(t){const{type:n,vnode:l,proxy:h,withProxy:p,propsOptions:[y],slots:m,attrs:a,emit:I,render:z,renderCache:P,props:k,data:N,setupState:F,ctx:H,inheritAttrs:X}=t,ae=Qf(t);let Se,be;try{if(l.shapeFlag&4){const re=p||h,J=re;Se=Vn(z.call(J,re,P,k,F,N,H)),be=a}else{const re=n;Se=Vn(re.length>1?re(k,{attrs:a,slots:m,emit:I}):re(k,null)),be=n.props?a:jE(a)}}catch(re){zh.length=0,Jc(re,t,1),Se=cr(Hi)}let Q=Se;if(be&&X!==!1){const re=Object.keys(be),{shapeFlag:J}=Q;re.length&&J&7&&(y&&re.some(p_)&&(be=NE(be,y)),Q=Yo(Q,be,!1,!0))}return l.dirs&&(Q=Yo(Q,null,!1,!0),Q.dirs=Q.dirs?Q.dirs.concat(l.dirs):l.dirs),l.transition&&$h(Q,l.transition),Se=Q,Qf(ae),Se}function BE(t,n=!0){let l;for(let h=0;h<t.length;h++){const p=t[h];if(Zc(p)){if(p.type!==Hi||p.children==="v-if"){if(l)return;l=p}}else return}return l}const jE=t=>{let n;for(const l in t)(l==="class"||l==="style"||Xh(l))&&((n||(n={}))[l]=t[l]);return n},NE=(t,n)=>{const l={};for(const h in t)(!p_(h)||!(h.slice(9)in n))&&(l[h]=t[h]);return l};function VE(t,n,l){const{props:h,children:p,component:y}=t,{props:m,children:a,patchFlag:I}=n,z=y.emitsOptions;if(n.dirs||n.transition)return!0;if(l&&I>=0){if(I&1024)return!0;if(I&16)return h?l0(h,m,z):!!m;if(I&8){const P=n.dynamicProps;for(let k=0;k<P.length;k++){const N=P[k];if(m[N]!==h[N]&&!Tp(z,N))return!0}}}else return(p||a)&&(!a||!a.$stable)?!0:h===m?!1:h?m?l0(h,m,z):!0:!!m;return!1}function l0(t,n,l){const h=Object.keys(n);if(h.length!==Object.keys(t).length)return!0;for(let p=0;p<h.length;p++){const y=h[p];if(n[y]!==t[y]&&!Tp(l,y))return!0}return!1}function Sp({vnode:t,parent:n},l){for(;n;){const h=n.subTree;if(h.suspense&&h.suspense.activeBranch===t&&(h.el=t.el),h===t)(t=n.vnode).el=l,n=n.parent;else break}}const Kx=t=>t.__isSuspense;let Dg=0;const $E={name:"Suspense",__isSuspense:!0,process(t,n,l,h,p,y,m,a,I,z){if(t==null)GE(n,l,h,p,y,m,a,I,z);else{if(y&&y.deps>0&&!t.suspense.isInFallback){n.suspense=t.suspense,n.suspense.vnode=n,n.el=t.el;return}ZE(t,n,l,h,p,m,a,I,z)}},hydrate:qE,normalize:HE},UE=$E;function Gh(t,n){const l=t.props&&t.props[n];Gt(l)&&l()}function GE(t,n,l,h,p,y,m,a,I){const{p:z,o:{createElement:P}}=I,k=P("div"),N=t.suspense=Xx(t,p,h,n,k,l,y,m,a,I);z(null,N.pendingBranch=t.ssContent,k,null,h,N,y,m),N.deps>0?(Gh(t,"onPending"),Gh(t,"onFallback"),z(null,t.ssFallback,n,l,h,null,y,m),$c(N,t.ssFallback)):N.resolve(!1,!0)}function ZE(t,n,l,h,p,y,m,a,{p:I,um:z,o:{createElement:P}}){const k=n.suspense=t.suspense;k.vnode=n,n.el=t.el;const N=n.ssContent,F=n.ssFallback,{activeBranch:H,pendingBranch:X,isInFallback:ae,isHydrating:Se}=k;if(X)k.pendingBranch=N,Ho(N,X)?(I(X,N,k.hiddenContainer,null,p,k,y,m,a),k.deps<=0?k.resolve():ae&&(Se||(I(H,F,l,h,p,null,y,m,a),$c(k,F)))):(k.pendingId=Dg++,Se?(k.isHydrating=!1,k.activeBranch=X):z(X,p,k),k.deps=0,k.effects.length=0,k.hiddenContainer=P("div"),ae?(I(null,N,k.hiddenContainer,null,p,k,y,m,a),k.deps<=0?k.resolve():(I(H,F,l,h,p,null,y,m,a),$c(k,F))):H&&Ho(N,H)?(I(H,N,l,h,p,k,y,m,a),k.resolve(!0)):(I(null,N,k.hiddenContainer,null,p,k,y,m,a),k.deps<=0&&k.resolve()));else if(H&&Ho(N,H))I(H,N,l,h,p,k,y,m,a),$c(k,N);else if(Gh(n,"onPending"),k.pendingBranch=N,N.shapeFlag&512?k.pendingId=N.component.suspenseId:k.pendingId=Dg++,I(null,N,k.hiddenContainer,null,p,k,y,m,a),k.deps<=0)k.resolve();else{const{timeout:be,pendingId:Q}=k;be>0?setTimeout(()=>{k.pendingId===Q&&k.fallback(F)},be):be===0&&k.fallback(F)}}function Xx(t,n,l,h,p,y,m,a,I,z,P=!1){const{p:k,m:N,um:F,n:H,o:{parentNode:X,remove:ae}}=z;let Se;const be=WE(t);be&&n&&n.pendingBranch&&(Se=n.pendingId,n.deps++);const Q=t.props?Ub(t.props.timeout):void 0,re=y,J={vnode:t,parent:n,parentComponent:l,namespace:m,container:h,hiddenContainer:p,deps:0,pendingId:Dg++,timeout:typeof Q=="number"?Q:-1,activeBranch:null,pendingBranch:null,isInFallback:!P,isHydrating:P,isUnmounted:!1,effects:[],resolve(le=!1,Me=!1){const{vnode:Ie,activeBranch:Be,pendingBranch:Ee,pendingId:Re,effects:Ae,parentComponent:He,container:it}=J;let vt=!1;J.isHydrating?J.isHydrating=!1:le||(vt=Be&&Ee.transition&&Ee.transition.mode==="out-in",vt&&(Be.transition.afterLeave=()=>{Re===J.pendingId&&(N(Ee,it,y===re?H(Be):y,0),Ig(Ae))}),Be&&(X(Be.el)===it&&(y=H(Be)),F(Be,He,J,!0)),vt||N(Ee,it,y,0)),$c(J,Ee),J.pendingBranch=null,J.isInFallback=!1;let Xe=J.parent,xt=!1;for(;Xe;){if(Xe.pendingBranch){Xe.effects.push(...Ae),xt=!0;break}Xe=Xe.parent}!xt&&!vt&&Ig(Ae),J.effects=[],be&&n&&n.pendingBranch&&Se===n.pendingId&&(n.deps--,n.deps===0&&!Me&&n.resolve()),Gh(Ie,"onResolve")},fallback(le){if(!J.pendingBranch)return;const{vnode:Me,activeBranch:Ie,parentComponent:Be,container:Ee,namespace:Re}=J;Gh(Me,"onFallback");const Ae=H(Ie),He=()=>{J.isInFallback&&(k(null,le,Ee,Ae,Be,null,Re,a,I),$c(J,le))},it=le.transition&&le.transition.mode==="out-in";it&&(Ie.transition.afterLeave=He),J.isInFallback=!0,F(Ie,Be,null,!0),it||He()},move(le,Me,Ie){J.activeBranch&&N(J.activeBranch,le,Me,Ie),J.container=le},next(){return J.activeBranch&&H(J.activeBranch)},registerDep(le,Me,Ie){const Be=!!J.pendingBranch;Be&&J.deps++;const Ee=le.vnode.el;le.asyncDep.catch(Re=>{Jc(Re,le,0)}).then(Re=>{if(le.isUnmounted||J.isUnmounted||J.pendingId!==le.suspenseId)return;le.asyncResolved=!0;const{vnode:Ae}=le;Fg(le,Re),Ee&&(Ae.el=Ee);const He=!Ee&&le.subTree.el;Me(le,Ae,X(Ee||le.subTree.el),Ee?null:H(le.subTree),J,m,Ie),He&&ae(He),Sp(le,Ae.el),Be&&--J.deps===0&&J.resolve()})},unmount(le,Me){J.isUnmounted=!0,J.activeBranch&&F(J.activeBranch,l,le,Me),J.pendingBranch&&F(J.pendingBranch,l,le,Me)}};return J}function qE(t,n,l,h,p,y,m,a,I){const z=n.suspense=Xx(n,h,l,t.parentNode,document.createElement("div"),null,p,y,m,a,!0),P=I(t,z.pendingBranch=n.ssContent,l,z,y,m);return z.deps===0&&z.resolve(!1,!0),P}function HE(t){const{shapeFlag:n,children:l}=t,h=n&32;t.ssContent=c0(h?l.default:l),t.ssFallback=h?c0(l.fallback):cr(Hi)}function c0(t){let n;if(Gt(t)){const l=Gc&&t._c;l&&(t._d=!1,Bt()),t=t(),l&&(t._d=!0,n=Pn,Jx())}return Zt(t)&&(t=BE(t)),t=Vn(t),n&&!t.dynamicChildren&&(t.dynamicChildren=n.filter(l=>l!==t)),t}function Yx(t,n){n&&n.pendingBranch?Zt(t)?n.effects.push(...t):n.effects.push(t):Ig(t)}function $c(t,n){t.activeBranch=n;const{vnode:l,parentComponent:h}=t;let p=n.el;for(;!p&&n.component;)n=n.component.subTree,p=n.el;l.el=p,h&&h.subTree===l&&(h.vnode.el=p,Sp(h,p))}function WE(t){const n=t.props&&t.props.suspensible;return n!=null&&n!==!1}const ki=Symbol.for("v-fgt"),wl=Symbol.for("v-txt"),Hi=Symbol.for("v-cmt"),Bf=Symbol.for("v-stc"),zh=[];let Pn=null;function Bt(t=!1){zh.push(Pn=t?null:[])}function Jx(){zh.pop(),Pn=zh[zh.length-1]||null}let Gc=1;function u0(t,n=!1){Gc+=t,t<0&&Pn&&n&&(Pn.hasOnce=!0)}function Qx(t){return t.dynamicChildren=Gc>0?Pn||Bc:null,Jx(),Gc>0&&Pn&&Pn.push(t),t}function Vr(t,n,l,h,p,y){return Qx(xi(t,n,l,h,p,y,!0))}function kr(t,n,l,h,p){return Qx(cr(t,n,l,h,p,!0))}function Zc(t){return t?t.__v_isVNode===!0:!1}function Ho(t,n){return t.type===n.type&&t.key===n.key}const e1=({key:t})=>t??null,jf=({ref:t,ref_key:n,ref_for:l})=>(typeof t=="number"&&(t=""+t),t!=null?ui(t)||li(t)||Gt(t)?{i:Ni,r:t,k:n,f:!!l}:t:null);function xi(t,n=null,l=null,h=0,p=null,y=t===ki?0:1,m=!1,a=!1){const I={__v_isVNode:!0,__v_skip:!0,type:t,props:n,key:n&&e1(n),ref:n&&jf(n),scopeId:mx,slotScopeIds:null,children:l,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:y,patchFlag:h,dynamicProps:p,dynamicChildren:null,appContext:null,ctx:Ni};return a?(M_(I,l),y&128&&t.normalize(I)):l&&(I.shapeFlag|=ui(l)?8:16),Gc>0&&!m&&Pn&&(I.patchFlag>0||y&6)&&I.patchFlag!==32&&Pn.push(I),I}const cr=KE;function KE(t,n=null,l=null,h=0,p=null,y=!1){if((!t||t===Mx)&&(t=Hi),Zc(t)){const a=Yo(t,n,!0);return l&&M_(a,l),Gc>0&&!y&&Pn&&(a.shapeFlag&6?Pn[Pn.indexOf(t)]=a:Pn.push(a)),a.patchFlag=-2,a}if(iC(t)&&(t=t.__vccOpts),n){n=Zh(n);let{class:a,style:I}=n;a&&!ui(a)&&(n.class=Qt(a)),Hr(I)&&(T_(I)&&!Zt(I)&&(I=Wi({},I)),n.style=Yh(I))}const m=ui(t)?1:Kx(t)?128:gx(t)?64:Hr(t)?4:Gt(t)?2:0;return xi(t,n,l,h,p,m,y,!0)}function Zh(t){return t?T_(t)||Ox(t)?Wi({},t):t:null}function Yo(t,n,l=!1,h=!1){const{props:p,ref:y,patchFlag:m,children:a,transition:I}=t,z=n?Eo(p||{},n):p,P={__v_isVNode:!0,__v_skip:!0,type:t.type,props:z,key:z&&e1(z),ref:n&&n.ref?l&&y?Zt(y)?y.concat(jf(n)):[y,jf(n)]:jf(n):y,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:a,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:n&&t.type!==ki?m===-1?16:m|16:m,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:I,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Yo(t.ssContent),ssFallback:t.ssFallback&&Yo(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return I&&h&&$h(P,I.clone(P)),P}function Tl(t=" ",n=0){return cr(wl,null,t,n)}function pi(t="",n=!1){return n?(Bt(),kr(Hi,null,t)):cr(Hi,null,t)}function Vn(t){return t==null||typeof t=="boolean"?cr(Hi):Zt(t)?cr(ki,null,t.slice()):Zc(t)?wa(t):cr(wl,null,String(t))}function wa(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:Yo(t)}function M_(t,n){let l=0;const{shapeFlag:h}=t;if(n==null)n=null;else if(Zt(n))l=16;else if(typeof n=="object")if(h&65){const p=n.default;p&&(p._c&&(p._d=!1),M_(t,p()),p._c&&(p._d=!0));return}else{l=32;const p=n._;!p&&!Ox(n)?n._ctx=Ni:p===3&&Ni&&(Ni.slots._===1?n._=1:(n._=2,t.patchFlag|=1024))}else Gt(n)?(n={default:n,_ctx:Ni},l=32):(n=String(n),h&64?(l=16,n=[Tl(n)]):l=8);t.children=n,t.shapeFlag|=l}function Eo(...t){const n={};for(let l=0;l<t.length;l++){const h=t[l];for(const p in h)if(p==="class")n.class!==h.class&&(n.class=Qt([n.class,h.class]));else if(p==="style")n.style=Yh([n.style,h.style]);else if(Xh(p)){const y=n[p],m=h[p];m&&y!==m&&!(Zt(y)&&y.includes(m))&&(n[p]=y?[].concat(y,m):m)}else p!==""&&(n[p]=h[p])}return n}function no(t,n,l,h=null){Io(t,n,7,[l,h])}const XE=zx();let YE=0;function JE(t,n,l){const h=t.type,p=(n?n.appContext:t.appContext)||XE,y={uid:YE++,vnode:t,type:h,parent:n,appContext:p,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Hb(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:n?n.provides:Object.create(p.provides),ids:n?n.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Bx(h,p),emitsOptions:Wx(h,p),emit:null,emitted:null,propsDefaults:$r,inheritAttrs:h.inheritAttrs,ctx:$r,data:$r,props:$r,attrs:$r,slots:$r,refs:$r,setupState:$r,setupContext:null,suspense:l,suspenseId:l?l.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return y.ctx={_:y},y.root=n?n.root:y,y.emit=FE.bind(null,y),t.ce&&t.ce(y),y}let ji=null;const eu=()=>ji||Ni;let tp,Og;{const t=yp(),n=(l,h)=>{let p;return(p=t[l])||(p=t[l]=[]),p.push(h),y=>{p.length>1?p.forEach(m=>m(y)):p[0](y)}};tp=n("__VUE_INSTANCE_SETTERS__",l=>ji=l),Og=n("__VUE_SSR_SETTERS__",l=>qc=l)}const ed=t=>{const n=ji;return tp(t),t.scope.on(),()=>{t.scope.off(),tp(n)}},h0=()=>{ji&&ji.scope.off(),tp(null)};function t1(t){return t.vnode.shapeFlag&4}let qc=!1;function QE(t,n=!1,l=!1){n&&Og(n);const{props:h,children:p}=t.vnode,y=t1(t);SE(t,h,y,n),ME(t,p,l);const m=y?eC(t,n):void 0;return n&&Og(!1),m}function eC(t,n){const l=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,pE);const{setup:h}=l;if(h){Ia();const p=t.setupContext=h.length>1?i1(t):null,y=ed(t),m=Jh(h,t,0,[t.props,p]),a=jb(m);if(Ma(),y(),(a||t.sp)&&!bl(t)&&E_(t),a){if(m.then(h0,h0),n)return m.then(I=>{Fg(t,I)}).catch(I=>{Jc(I,t,0)});t.asyncDep=m}else Fg(t,m)}else r1(t)}function Fg(t,n,l){Gt(n)?t.type.__ssrInlineRender?t.ssrRender=n:t.render=n:Hr(n)&&(t.setupState=hx(n)),r1(t)}function r1(t,n,l){const h=t.type;t.render||(t.render=h.render||Wo);{const p=ed(t);Ia();try{_E(t)}finally{Ma(),p()}}}const tC={get(t,n){return dn(t,"get",""),t[n]}};function i1(t){const n=l=>{t.exposed=l||{}};return{attrs:new Proxy(t.attrs,tC),slots:t.slots,emit:t.emit,expose:n}}function Ep(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(hx(BS(t.exposed)),{get(n,l){if(l in n)return n[l];if(l in Lh)return Lh[l](t)},has(n,l){return l in n||l in Lh}})):t.proxy}function rC(t,n=!0){return Gt(t)?t.displayName||t.name:t.name||n&&t.__name}function iC(t){return Gt(t)&&"__vccOpts"in t}const Ye=(t,n)=>ZS(t,n,qc);function pn(t,n,l){const h=arguments.length;return h===2?Hr(n)&&!Zt(n)?Zc(n)?cr(t,null,[n]):cr(t,n):cr(t,null,n):(h>3?l=Array.prototype.slice.call(arguments,2):h===3&&Zc(l)&&(l=[l]),cr(t,n,l))}const nC="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Bg;const d0=typeof window<"u"&&window.trustedTypes;if(d0)try{Bg=d0.createPolicy("vue",{createHTML:t=>t})}catch{}const n1=Bg?t=>Bg.createHTML(t):t=>t,oC="http://www.w3.org/2000/svg",sC="http://www.w3.org/1998/Math/MathML",Ms=typeof document<"u"?document:null,f0=Ms&&Ms.createElement("template"),aC={insert:(t,n,l)=>{n.insertBefore(t,l||null)},remove:t=>{const n=t.parentNode;n&&n.removeChild(t)},createElement:(t,n,l,h)=>{const p=n==="svg"?Ms.createElementNS(oC,t):n==="mathml"?Ms.createElementNS(sC,t):l?Ms.createElement(t,{is:l}):Ms.createElement(t);return t==="select"&&h&&h.multiple!=null&&p.setAttribute("multiple",h.multiple),p},createText:t=>Ms.createTextNode(t),createComment:t=>Ms.createComment(t),setText:(t,n)=>{t.nodeValue=n},setElementText:(t,n)=>{t.textContent=n},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Ms.querySelector(t),setScopeId(t,n){t.setAttribute(n,"")},insertStaticContent(t,n,l,h,p,y){const m=l?l.previousSibling:n.lastChild;if(p&&(p===y||p.nextSibling))for(;n.insertBefore(p.cloneNode(!0),l),!(p===y||!(p=p.nextSibling)););else{f0.innerHTML=n1(h==="svg"?`<svg>${t}</svg>`:h==="mathml"?`<math>${t}</math>`:t);const a=f0.content;if(h==="svg"||h==="mathml"){const I=a.firstChild;for(;I.firstChild;)a.appendChild(I.firstChild);a.removeChild(I)}n.insertBefore(a,l)}return[m?m.nextSibling:n.firstChild,l?l.previousSibling:n.lastChild]}},ma="transition",_h="animation",qh=Symbol("_vtc"),o1={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},lC=Wi({},_x,o1),cC=t=>(t.displayName="Transition",t.props=lC,t),uC=cC((t,{slots:n})=>pn(eE,hC(t),n)),hl=(t,n=[])=>{Zt(t)?t.forEach(l=>l(...n)):t&&t(...n)},p0=t=>t?Zt(t)?t.some(n=>n.length>1):t.length>1:!1;function hC(t){const n={};for(const Ae in t)Ae in o1||(n[Ae]=t[Ae]);if(t.css===!1)return n;const{name:l="v",type:h,duration:p,enterFromClass:y=`${l}-enter-from`,enterActiveClass:m=`${l}-enter-active`,enterToClass:a=`${l}-enter-to`,appearFromClass:I=y,appearActiveClass:z=m,appearToClass:P=a,leaveFromClass:k=`${l}-leave-from`,leaveActiveClass:N=`${l}-leave-active`,leaveToClass:F=`${l}-leave-to`}=t,H=dC(p),X=H&&H[0],ae=H&&H[1],{onBeforeEnter:Se,onEnter:be,onEnterCancelled:Q,onLeave:re,onLeaveCancelled:J,onBeforeAppear:le=Se,onAppear:Me=be,onAppearCancelled:Ie=Q}=n,Be=(Ae,He,it,vt)=>{Ae._enterCancelled=vt,dl(Ae,He?P:a),dl(Ae,He?z:m),it&&it()},Ee=(Ae,He)=>{Ae._isLeaving=!1,dl(Ae,k),dl(Ae,F),dl(Ae,N),He&&He()},Re=Ae=>(He,it)=>{const vt=Ae?Me:be,Xe=()=>Be(He,Ae,it);hl(vt,[He,Xe]),m0(()=>{dl(He,Ae?I:y),Ts(He,Ae?P:a),p0(vt)||g0(He,h,X,Xe)})};return Wi(n,{onBeforeEnter(Ae){hl(Se,[Ae]),Ts(Ae,y),Ts(Ae,m)},onBeforeAppear(Ae){hl(le,[Ae]),Ts(Ae,I),Ts(Ae,z)},onEnter:Re(!1),onAppear:Re(!0),onLeave(Ae,He){Ae._isLeaving=!0;const it=()=>Ee(Ae,He);Ts(Ae,k),Ae._enterCancelled?(Ts(Ae,N),v0()):(v0(),Ts(Ae,N)),m0(()=>{Ae._isLeaving&&(dl(Ae,k),Ts(Ae,F),p0(re)||g0(Ae,h,ae,it))}),hl(re,[Ae,it])},onEnterCancelled(Ae){Be(Ae,!1,void 0,!0),hl(Q,[Ae])},onAppearCancelled(Ae){Be(Ae,!0,void 0,!0),hl(Ie,[Ae])},onLeaveCancelled(Ae){Ee(Ae),hl(J,[Ae])}})}function dC(t){if(t==null)return null;if(Hr(t))return[sg(t.enter),sg(t.leave)];{const n=sg(t);return[n,n]}}function sg(t){return Ub(t)}function Ts(t,n){n.split(/\s+/).forEach(l=>l&&t.classList.add(l)),(t[qh]||(t[qh]=new Set)).add(n)}function dl(t,n){n.split(/\s+/).forEach(h=>h&&t.classList.remove(h));const l=t[qh];l&&(l.delete(n),l.size||(t[qh]=void 0))}function m0(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let fC=0;function g0(t,n,l,h){const p=t._endId=++fC,y=()=>{p===t._endId&&h()};if(l!=null)return setTimeout(y,l);const{type:m,timeout:a,propCount:I}=pC(t,n);if(!m)return h();const z=m+"end";let P=0;const k=()=>{t.removeEventListener(z,N),y()},N=F=>{F.target===t&&++P>=I&&k()};setTimeout(()=>{P<I&&k()},a+1),t.addEventListener(z,N)}function pC(t,n){const l=window.getComputedStyle(t),h=H=>(l[H]||"").split(", "),p=h(`${ma}Delay`),y=h(`${ma}Duration`),m=_0(p,y),a=h(`${_h}Delay`),I=h(`${_h}Duration`),z=_0(a,I);let P=null,k=0,N=0;n===ma?m>0&&(P=ma,k=m,N=y.length):n===_h?z>0&&(P=_h,k=z,N=I.length):(k=Math.max(m,z),P=k>0?m>z?ma:_h:null,N=P?P===ma?y.length:I.length:0);const F=P===ma&&/\b(transform|all)(,|$)/.test(h(`${ma}Property`).toString());return{type:P,timeout:k,propCount:N,hasTransform:F}}function _0(t,n){for(;t.length<n.length;)t=t.concat(t);return Math.max(...n.map((l,h)=>y0(l)+y0(t[h])))}function y0(t){return t==="auto"?0:Number(t.slice(0,-1).replace(",","."))*1e3}function v0(){return document.body.offsetHeight}function mC(t,n,l){const h=t[qh];h&&(n=(n?[n,...h]:[...h]).join(" ")),n==null?t.removeAttribute("class"):l?t.setAttribute("class",n):t.className=n}const rp=Symbol("_vod"),s1=Symbol("_vsh"),gC={beforeMount(t,{value:n},{transition:l}){t[rp]=t.style.display==="none"?"":t.style.display,l&&n?l.beforeEnter(t):yh(t,n)},mounted(t,{value:n},{transition:l}){l&&n&&l.enter(t)},updated(t,{value:n,oldValue:l},{transition:h}){!n!=!l&&(h?n?(h.beforeEnter(t),yh(t,!0),h.enter(t)):h.leave(t,()=>{yh(t,!1)}):yh(t,n))},beforeUnmount(t,{value:n}){yh(t,n)}};function yh(t,n){t.style.display=n?t[rp]:"none",t[s1]=!n}const _C=Symbol(""),yC=/(^|;)\s*display\s*:/;function vC(t,n,l){const h=t.style,p=ui(l);let y=!1;if(l&&!p){if(n)if(ui(n))for(const m of n.split(";")){const a=m.slice(0,m.indexOf(":")).trim();l[a]==null&&Nf(h,a,"")}else for(const m in n)l[m]==null&&Nf(h,m,"");for(const m in l)m==="display"&&(y=!0),Nf(h,m,l[m])}else if(p){if(n!==l){const m=h[_C];m&&(l+=";"+m),h.cssText=l,y=yC.test(l)}}else n&&t.removeAttribute("style");rp in t&&(t[rp]=y?h.display:"",t[s1]&&(h.display="none"))}const b0=/\s*!important$/;function Nf(t,n,l){if(Zt(l))l.forEach(h=>Nf(t,n,h));else if(l==null&&(l=""),n.startsWith("--"))t.setProperty(n,l);else{const h=bC(t,n);b0.test(l)?t.setProperty(kl(h),l.replace(b0,""),"important"):t[h]=l}}const x0=["Webkit","Moz","ms"],ag={};function bC(t,n){const l=ag[n];if(l)return l;let h=ao(n);if(h!=="filter"&&h in t)return ag[n]=h;h=_p(h);for(let p=0;p<x0.length;p++){const y=x0[p]+h;if(y in t)return ag[n]=y}return n}const w0="http://www.w3.org/1999/xlink";function T0(t,n,l,h,p,y=gS(n)){h&&n.startsWith("xlink:")?l==null?t.removeAttributeNS(w0,n.slice(6,n.length)):t.setAttributeNS(w0,n,l):l==null||y&&!Gb(l)?t.removeAttribute(n):t.setAttribute(n,y?"":zs(l)?String(l):l)}function S0(t,n,l,h,p){if(n==="innerHTML"||n==="textContent"){l!=null&&(t[n]=n==="innerHTML"?n1(l):l);return}const y=t.tagName;if(n==="value"&&y!=="PROGRESS"&&!y.includes("-")){const a=y==="OPTION"?t.getAttribute("value")||"":t.value,I=l==null?t.type==="checkbox"?"on":"":String(l);(a!==I||!("_value"in t))&&(t.value=I),l==null&&t.removeAttribute(n),t._value=l;return}let m=!1;if(l===""||l==null){const a=typeof t[n];a==="boolean"?l=Gb(l):l==null&&a==="string"?(l="",m=!0):a==="number"&&(l=0,m=!0)}try{t[n]=l}catch{}m&&t.removeAttribute(p||n)}function xC(t,n,l,h){t.addEventListener(n,l,h)}function wC(t,n,l,h){t.removeEventListener(n,l,h)}const E0=Symbol("_vei");function TC(t,n,l,h,p=null){const y=t[E0]||(t[E0]={}),m=y[n];if(h&&m)m.value=h;else{const[a,I]=SC(n);if(h){const z=y[n]=IC(h,p);xC(t,a,z,I)}else m&&(wC(t,a,m,I),y[n]=void 0)}}const C0=/(?:Once|Passive|Capture)$/;function SC(t){let n;if(C0.test(t)){n={};let h;for(;h=t.match(C0);)t=t.slice(0,t.length-h[0].length),n[h[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):kl(t.slice(2)),n]}let lg=0;const EC=Promise.resolve(),CC=()=>lg||(EC.then(()=>lg=0),lg=Date.now());function IC(t,n){const l=h=>{if(!h._vts)h._vts=Date.now();else if(h._vts<=l.attached)return;Io(MC(h,l.value),n,5,[h])};return l.value=t,l.attached=CC(),l}function MC(t,n){if(Zt(n)){const l=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{l.call(t),t._stopped=!0},n.map(h=>p=>!p._stopped&&h&&h(p))}else return n}const I0=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,PC=(t,n,l,h,p,y)=>{const m=p==="svg";n==="class"?mC(t,h,m):n==="style"?vC(t,l,h):Xh(n)?p_(n)||TC(t,n,l,h,y):(n[0]==="."?(n=n.slice(1),!0):n[0]==="^"?(n=n.slice(1),!1):AC(t,n,h,m))?(S0(t,n,h),!t.tagName.includes("-")&&(n==="value"||n==="checked"||n==="selected")&&T0(t,n,h,m,y,n!=="value")):t._isVueCE&&(/[A-Z]/.test(n)||!ui(h))?S0(t,ao(n),h,y,n):(n==="true-value"?t._trueValue=h:n==="false-value"&&(t._falseValue=h),T0(t,n,h,m))};function AC(t,n,l,h){if(h)return!!(n==="innerHTML"||n==="textContent"||n in t&&I0(n)&&Gt(l));if(n==="spellcheck"||n==="draggable"||n==="translate"||n==="form"||n==="list"&&t.tagName==="INPUT"||n==="type"&&t.tagName==="TEXTAREA")return!1;if(n==="width"||n==="height"){const p=t.tagName;if(p==="IMG"||p==="VIDEO"||p==="CANVAS"||p==="SOURCE")return!1}return I0(n)&&ui(l)?!1:n in t}const a1=Wi({patchProp:PC},aC);let Rh,M0=!1;function kC(){return Rh||(Rh=AE(a1))}function LC(){return Rh=M0?Rh:kE(a1),M0=!0,Rh}const zC=(...t)=>{const n=kC().createApp(...t),{mount:l}=n;return n.mount=h=>{const p=c1(h);if(!p)return;const y=n._component;!Gt(y)&&!y.render&&!y.template&&(y.template=p.innerHTML),p.nodeType===1&&(p.textContent="");const m=l(p,!1,l1(p));return p instanceof Element&&(p.removeAttribute("v-cloak"),p.setAttribute("data-v-app","")),m},n},RC=(...t)=>{const n=LC().createApp(...t),{mount:l}=n;return n.mount=h=>{const p=c1(h);if(p)return l(p,!0,l1(p))},n};function l1(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function c1(t){return ui(t)?document.querySelector(t):t}const DC=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,OC=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,FC=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function BC(t,n){if(t==="__proto__"||t==="constructor"&&n&&typeof n=="object"&&"prototype"in n){jC(t);return}return n}function jC(t){console.warn(`[destr] Dropping "${t}" key to prevent prototype pollution.`)}function ip(t,n={}){if(typeof t!="string")return t;const l=t.trim();if(t[0]==='"'&&t.endsWith('"')&&!t.includes("\\"))return l.slice(1,-1);if(l.length<=9){const h=l.toLowerCase();if(h==="true")return!0;if(h==="false")return!1;if(h==="undefined")return;if(h==="null")return null;if(h==="nan")return Number.NaN;if(h==="infinity")return Number.POSITIVE_INFINITY;if(h==="-infinity")return Number.NEGATIVE_INFINITY}if(!FC.test(t)){if(n.strict)throw new SyntaxError("[destr] Invalid JSON");return t}try{if(DC.test(t)||OC.test(t)){if(n.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(t,BC)}return JSON.parse(t)}catch(h){if(n.strict)throw h;return t}}const NC=/#/g,VC=/&/g,$C=/\//g,UC=/=/g,P_=/\+/g,GC=/%5e/gi,ZC=/%60/gi,qC=/%7c/gi,HC=/%20/gi;function WC(t){return encodeURI(""+t).replace(qC,"|")}function jg(t){return WC(typeof t=="string"?t:JSON.stringify(t)).replace(P_,"%2B").replace(HC,"+").replace(NC,"%23").replace(VC,"%26").replace(ZC,"`").replace(GC,"^").replace($C,"%2F")}function cg(t){return jg(t).replace(UC,"%3D")}function np(t=""){try{return decodeURIComponent(""+t)}catch{return""+t}}function KC(t){return np(t.replace(P_," "))}function XC(t){return np(t.replace(P_," "))}function Cp(t=""){const n={};t[0]==="?"&&(t=t.slice(1));for(const l of t.split("&")){const h=l.match(/([^=]+)=?(.*)/)||[];if(h.length<2)continue;const p=KC(h[1]);if(p==="__proto__"||p==="constructor")continue;const y=XC(h[2]||"");n[p]===void 0?n[p]=y:Array.isArray(n[p])?n[p].push(y):n[p]=[n[p],y]}return n}function YC(t,n){return(typeof n=="number"||typeof n=="boolean")&&(n=String(n)),n?Array.isArray(n)?n.map(l=>`${cg(t)}=${jg(l)}`).join("&"):`${cg(t)}=${jg(n)}`:cg(t)}function u1(t){return Object.keys(t).filter(n=>t[n]!==void 0).map(n=>YC(n,t[n])).filter(Boolean).join("&")}const JC=/^[\s\w\0+.-]{2,}:([/\\]{1,2})/,QC=/^[\s\w\0+.-]{2,}:([/\\]{2})?/,eI=/^([/\\]\s*){2,}[^/\\]/,tI=/^[\s\0]*(blob|data|javascript|vbscript):$/i,rI=/\/$|\/\?|\/#/,iI=/^\.?\//;function Aa(t,n={}){return typeof n=="boolean"&&(n={acceptRelative:n}),n.strict?JC.test(t):QC.test(t)||(n.acceptRelative?eI.test(t):!1)}function nI(t){return!!t&&tI.test(t)}function Ng(t="",n){return n?rI.test(t):t.endsWith("/")}function Ip(t="",n){if(!n)return(Ng(t)?t.slice(0,-1):t)||"/";if(!Ng(t,!0))return t||"/";let l=t,h="";const p=t.indexOf("#");p>=0&&(l=t.slice(0,p),h=t.slice(p));const[y,...m]=l.split("?");return((y.endsWith("/")?y.slice(0,-1):y)||"/")+(m.length>0?`?${m.join("?")}`:"")+h}function op(t="",n){if(!n)return t.endsWith("/")?t:t+"/";if(Ng(t,!0))return t||"/";let l=t,h="";const p=t.indexOf("#");if(p>=0&&(l=t.slice(0,p),h=t.slice(p),!l))return h;const[y,...m]=l.split("?");return y+"/"+(m.length>0?`?${m.join("?")}`:"")+h}function oI(t=""){return t.startsWith("/")}function P0(t=""){return oI(t)?t:"/"+t}function sI(t,n){if(d1(n)||Aa(t))return t;const l=Ip(n);return t.startsWith(l)?t:td(l,t)}function aI(t,n){if(d1(n))return t;const l=Ip(n);if(!t.startsWith(l))return t;const h=t.slice(l.length);return h[0]==="/"?h:"/"+h}function h1(t,n){const l=m1(t),h={...Cp(l.search),...n};return l.search=u1(h),g1(l)}function d1(t){return!t||t==="/"}function lI(t){return t&&t!=="/"}function td(t,...n){let l=t||"";for(const h of n.filter(p=>lI(p)))if(l){const p=h.replace(iI,"");l=op(l)+p}else l=h;return l}function f1(...t){var m,a,I,z;const n=/\/(?!\/)/,l=t.filter(Boolean),h=[];let p=0;for(const P of l)if(!(!P||P==="/")){for(const[k,N]of P.split(n).entries())if(!(!N||N===".")){if(N===".."){if(h.length===1&&Aa(h[0]))continue;h.pop(),p--;continue}if(k===1&&((m=h[h.length-1])!=null&&m.endsWith(":/"))){h[h.length-1]+="/"+N;continue}h.push(N),p++}}let y=h.join("/");return p>=0?(a=l[0])!=null&&a.startsWith("/")&&!y.startsWith("/")?y="/"+y:(I=l[0])!=null&&I.startsWith("./")&&!y.startsWith("./")&&(y="./"+y):y="../".repeat(-1*p)+y,(z=l[l.length-1])!=null&&z.endsWith("/")&&!y.endsWith("/")&&(y+="/"),y}function cI(t,n,l={}){return l.trailingSlash||(t=op(t),n=op(n)),l.leadingSlash||(t=P0(t),n=P0(n)),l.encoding||(t=np(t),n=np(n)),t===n}const p1=Symbol.for("ufo:protocolRelative");function m1(t="",n){const l=t.match(/^[\s\0]*(blob:|data:|javascript:|vbscript:)(.*)/i);if(l){const[,k,N=""]=l;return{protocol:k.toLowerCase(),pathname:N,href:k+N,auth:"",host:"",search:"",hash:""}}if(!Aa(t,{acceptRelative:!0}))return A0(t);const[,h="",p,y=""]=t.replace(/\\/g,"/").match(/^[\s\0]*([\w+.-]{2,}:)?\/\/([^/@]+@)?(.*)/)||[];let[,m="",a=""]=y.match(/([^#/?]*)(.*)?/)||[];h==="file:"&&(a=a.replace(/\/(?=[A-Za-z]:)/,""));const{pathname:I,search:z,hash:P}=A0(a);return{protocol:h.toLowerCase(),auth:p?p.slice(0,Math.max(0,p.length-1)):"",host:m,pathname:I,search:z,hash:P,[p1]:!h}}function A0(t=""){const[n="",l="",h=""]=(t.match(/([^#?]*)(\?[^#]*)?(#.*)?/)||[]).splice(1);return{pathname:n,search:l,hash:h}}function g1(t){const n=t.pathname||"",l=t.search?(t.search.startsWith("?")?"":"?")+t.search:"",h=t.hash||"",p=t.auth?t.auth+"@":"",y=t.host||"";return(t.protocol||t[p1]?(t.protocol||"")+"//":"")+p+y+n+l+h}class uI extends Error{constructor(n,l){super(n,l),this.name="FetchError",l!=null&&l.cause&&!this.cause&&(this.cause=l.cause)}}function hI(t){var I,z,P,k,N;const n=((I=t.error)==null?void 0:I.message)||((z=t.error)==null?void 0:z.toString())||"",l=((P=t.request)==null?void 0:P.method)||((k=t.options)==null?void 0:k.method)||"GET",h=((N=t.request)==null?void 0:N.url)||String(t.request)||"/",p=`[${l}] ${JSON.stringify(h)}`,y=t.response?`${t.response.status} ${t.response.statusText}`:"<no response>",m=`${p}: ${y}${n?` ${n}`:""}`,a=new uI(m,t.error?{cause:t.error}:void 0);for(const F of["request","options","response"])Object.defineProperty(a,F,{get(){return t[F]}});for(const[F,H]of[["data","_data"],["status","status"],["statusCode","status"],["statusText","statusText"],["statusMessage","statusText"]])Object.defineProperty(a,F,{get(){return t.response&&t.response[H]}});return a}const dI=new Set(Object.freeze(["PATCH","POST","PUT","DELETE"]));function k0(t="GET"){return dI.has(t.toUpperCase())}function fI(t){if(t===void 0)return!1;const n=typeof t;return n==="string"||n==="number"||n==="boolean"||n===null?!0:n!=="object"?!1:Array.isArray(t)?!0:t.buffer?!1:t.constructor&&t.constructor.name==="Object"||typeof t.toJSON=="function"}const pI=new Set(["image/svg","application/xml","application/xhtml","application/html"]),mI=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function gI(t=""){if(!t)return"json";const n=t.split(";").shift()||"";return mI.test(n)?"json":pI.has(n)||n.startsWith("text/")?"text":"blob"}function _I(t,n,l,h){const p=yI((n==null?void 0:n.headers)??(t==null?void 0:t.headers),l==null?void 0:l.headers,h);let y;return(l!=null&&l.query||l!=null&&l.params||n!=null&&n.params||n!=null&&n.query)&&(y={...l==null?void 0:l.params,...l==null?void 0:l.query,...n==null?void 0:n.params,...n==null?void 0:n.query}),{...l,...n,query:y,params:y,headers:p}}function yI(t,n,l){if(!n)return new l(t);const h=new l(n);if(t)for(const[p,y]of Symbol.iterator in t||Array.isArray(t)?t:new l(t))h.set(p,y);return h}async function Lf(t,n){if(n)if(Array.isArray(n))for(const l of n)await l(t);else await n(t)}const vI=new Set([408,409,425,429,500,502,503,504]),bI=new Set([101,204,205,304]);function _1(t={}){const{fetch:n=globalThis.fetch,Headers:l=globalThis.Headers,AbortController:h=globalThis.AbortController}=t;async function p(a){const I=a.error&&a.error.name==="AbortError"&&!a.options.timeout||!1;if(a.options.retry!==!1&&!I){let P;typeof a.options.retry=="number"?P=a.options.retry:P=k0(a.options.method)?0:1;const k=a.response&&a.response.status||500;if(P>0&&(Array.isArray(a.options.retryStatusCodes)?a.options.retryStatusCodes.includes(k):vI.has(k))){const N=typeof a.options.retryDelay=="function"?a.options.retryDelay(a):a.options.retryDelay||0;return N>0&&await new Promise(F=>setTimeout(F,N)),y(a.request,{...a.options,retry:P-1})}}const z=hI(a);throw Error.captureStackTrace&&Error.captureStackTrace(z,y),z}const y=async function(I,z={}){const P={request:I,options:_I(I,z,t.defaults,l),response:void 0,error:void 0};P.options.method&&(P.options.method=P.options.method.toUpperCase()),P.options.onRequest&&await Lf(P,P.options.onRequest),typeof P.request=="string"&&(P.options.baseURL&&(P.request=sI(P.request,P.options.baseURL)),P.options.query&&(P.request=h1(P.request,P.options.query),delete P.options.query),"query"in P.options&&delete P.options.query,"params"in P.options&&delete P.options.params),P.options.body&&k0(P.options.method)&&(fI(P.options.body)?(P.options.body=typeof P.options.body=="string"?P.options.body:JSON.stringify(P.options.body),P.options.headers=new l(P.options.headers||{}),P.options.headers.has("content-type")||P.options.headers.set("content-type","application/json"),P.options.headers.has("accept")||P.options.headers.set("accept","application/json")):("pipeTo"in P.options.body&&typeof P.options.body.pipeTo=="function"||typeof P.options.body.pipe=="function")&&("duplex"in P.options||(P.options.duplex="half")));let k;if(!P.options.signal&&P.options.timeout){const F=new h;k=setTimeout(()=>{const H=new Error("[TimeoutError]: The operation was aborted due to timeout");H.name="TimeoutError",H.code=23,F.abort(H)},P.options.timeout),P.options.signal=F.signal}try{P.response=await n(P.request,P.options)}catch(F){return P.error=F,P.options.onRequestError&&await Lf(P,P.options.onRequestError),await p(P)}finally{k&&clearTimeout(k)}if((P.response.body||P.response._bodyInit)&&!bI.has(P.response.status)&&P.options.method!=="HEAD"){const F=(P.options.parseResponse?"json":P.options.responseType)||gI(P.response.headers.get("content-type")||"");switch(F){case"json":{const H=await P.response.text(),X=P.options.parseResponse||ip;P.response._data=X(H);break}case"stream":{P.response._data=P.response.body||P.response._bodyInit;break}default:P.response._data=await P.response[F]()}}return P.options.onResponse&&await Lf(P,P.options.onResponse),!P.options.ignoreResponseError&&P.response.status>=400&&P.response.status<600?(P.options.onResponseError&&await Lf(P,P.options.onResponseError),await p(P)):P.response},m=async function(I,z){return(await y(I,z))._data};return m.raw=y,m.native=(...a)=>n(...a),m.create=(a={},I={})=>_1({...t,...I,defaults:{...t.defaults,...I.defaults,...a}}),m}const sp=function(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}(),xI=sp.fetch?(...t)=>sp.fetch(...t):()=>Promise.reject(new Error("[ofetch] global.fetch is not supported!")),wI=sp.Headers,TI=sp.AbortController,SI=_1({fetch:xI,Headers:wI,AbortController:TI}),EI=SI,CI=()=>{var t;return((t=window==null?void 0:window.__NUXT__)==null?void 0:t.config)||{}},ap=CI().app,II=()=>ap.baseURL,MI=()=>ap.buildAssetsDir,A_=(...t)=>f1(y1(),MI(),...t),y1=(...t)=>{const n=ap.cdnURL||ap.baseURL;return t.length?f1(n,...t):n};globalThis.__buildAssetsURL=A_,globalThis.__publicAssetsURL=y1;globalThis.$fetch||(globalThis.$fetch=EI.create({baseURL:II()}));function Vg(t,n={},l){for(const h in t){const p=t[h],y=l?`${l}:${h}`:h;typeof p=="object"&&p!==null?Vg(p,n,y):typeof p=="function"&&(n[y]=p)}return n}const PI={run:t=>t()},AI=()=>PI,v1=typeof console.createTask<"u"?console.createTask:AI;function kI(t,n){const l=n.shift(),h=v1(l);return t.reduce((p,y)=>p.then(()=>h.run(()=>y(...n))),Promise.resolve())}function LI(t,n){const l=n.shift(),h=v1(l);return Promise.all(t.map(p=>h.run(()=>p(...n))))}function ug(t,n){for(const l of[...t])l(n)}class zI{constructor(){this._hooks={},this._before=void 0,this._after=void 0,this._deprecatedMessages=void 0,this._deprecatedHooks={},this.hook=this.hook.bind(this),this.callHook=this.callHook.bind(this),this.callHookWith=this.callHookWith.bind(this)}hook(n,l,h={}){if(!n||typeof l!="function")return()=>{};const p=n;let y;for(;this._deprecatedHooks[n];)y=this._deprecatedHooks[n],n=y.to;if(y&&!h.allowDeprecated){let m=y.message;m||(m=`${p} hook has been deprecated`+(y.to?`, please use ${y.to}`:"")),this._deprecatedMessages||(this._deprecatedMessages=new Set),this._deprecatedMessages.has(m)||(console.warn(m),this._deprecatedMessages.add(m))}if(!l.name)try{Object.defineProperty(l,"name",{get:()=>"_"+n.replace(/\W+/g,"_")+"_hook_cb",configurable:!0})}catch{}return this._hooks[n]=this._hooks[n]||[],this._hooks[n].push(l),()=>{l&&(this.removeHook(n,l),l=void 0)}}hookOnce(n,l){let h,p=(...y)=>(typeof h=="function"&&h(),h=void 0,p=void 0,l(...y));return h=this.hook(n,p),h}removeHook(n,l){if(this._hooks[n]){const h=this._hooks[n].indexOf(l);h!==-1&&this._hooks[n].splice(h,1),this._hooks[n].length===0&&delete this._hooks[n]}}deprecateHook(n,l){this._deprecatedHooks[n]=typeof l=="string"?{to:l}:l;const h=this._hooks[n]||[];delete this._hooks[n];for(const p of h)this.hook(n,p)}deprecateHooks(n){Object.assign(this._deprecatedHooks,n);for(const l in n)this.deprecateHook(l,n[l])}addHooks(n){const l=Vg(n),h=Object.keys(l).map(p=>this.hook(p,l[p]));return()=>{for(const p of h.splice(0,h.length))p()}}removeHooks(n){const l=Vg(n);for(const h in l)this.removeHook(h,l[h])}removeAllHooks(){for(const n in this._hooks)delete this._hooks[n]}callHook(n,...l){return l.unshift(n),this.callHookWith(kI,n,...l)}callHookParallel(n,...l){return l.unshift(n),this.callHookWith(LI,n,...l)}callHookWith(n,l,...h){const p=this._before||this._after?{name:l,args:h,context:{}}:void 0;this._before&&ug(this._before,p);const y=n(l in this._hooks?[...this._hooks[l]]:[],h);return y instanceof Promise?y.finally(()=>{this._after&&p&&ug(this._after,p)}):(this._after&&p&&ug(this._after,p),y)}beforeEach(n){return this._before=this._before||[],this._before.push(n),()=>{if(this._before!==void 0){const l=this._before.indexOf(n);l!==-1&&this._before.splice(l,1)}}}afterEach(n){return this._after=this._after||[],this._after.push(n),()=>{if(this._after!==void 0){const l=this._after.indexOf(n);l!==-1&&this._after.splice(l,1)}}}}function b1(){return new zI}function RI(t={}){let n,l=!1;const h=m=>{if(n&&n!==m)throw new Error("Context conflict")};let p;if(t.asyncContext){const m=t.AsyncLocalStorage||globalThis.AsyncLocalStorage;m?p=new m:console.warn("[unctx] `AsyncLocalStorage` is not provided.")}const y=()=>{if(p){const m=p.getStore();if(m!==void 0)return m}return n};return{use:()=>{const m=y();if(m===void 0)throw new Error("Context is not available");return m},tryUse:()=>y(),set:(m,a)=>{a||h(m),n=m,l=!0},unset:()=>{n=void 0,l=!1},call:(m,a)=>{h(m),n=m;try{return p?p.run(m,a):a()}finally{l||(n=void 0)}},async callAsync(m,a){n=m;const I=()=>{n=m},z=()=>n===m?I:void 0;$g.add(z);try{const P=p?p.run(m,a):a();return l||(n=void 0),await P}finally{$g.delete(z)}}}}function DI(t={}){const n={};return{get(l,h={}){return n[l]||(n[l]=RI({...t,...h})),n[l]}}}const lp=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof global<"u"?global:typeof window<"u"?window:{},L0="__unctx__",OI=lp[L0]||(lp[L0]=DI()),FI=(t,n={})=>OI.get(t,n),z0="__unctx_async_handlers__",$g=lp[z0]||(lp[z0]=new Set);function x1(t){const n=[];for(const p of $g){const y=p();y&&n.push(y)}const l=()=>{for(const p of n)p()};let h=t();return h&&typeof h=="object"&&"catch"in h&&(h=h.catch(p=>{throw l(),p})),[h,l]}const BI={componentName:"NuxtLink",prefetch:!0,prefetchOn:{visibility:!0}},jI=null,NI="#__nuxt",w1="nuxt-app",R0=36e5,VI="vite:preloadError";function T1(t=w1){return FI(t,{asyncContext:!1})}const $I="__nuxt_plugin";function UI(t){var p;let n=0;const l={_id:t.id||w1||"nuxt-app",_scope:_S(),provide:void 0,globalName:"nuxt",versions:{get nuxt(){return"3.16.1"},get vue(){return l.vueApp.version}},payload:Dc({...((p=t.ssrContext)==null?void 0:p.payload)||{},data:Dc({}),state:Co({}),once:new Set,_errors:Dc({})}),static:{data:{}},runWithContext(y){return l._scope.active&&!Wb()?l._scope.run(()=>D0(l,y)):D0(l,y)},isHydrating:!0,deferHydration(){if(!l.isHydrating)return()=>{};n++;let y=!1;return()=>{if(!y&&(y=!0,n--,n===0))return l.isHydrating=!1,l.callHook("app:suspense:resolve")}},_asyncDataPromises:{},_asyncData:Dc({}),_payloadRevivers:{},...t};{const y=window.__NUXT__;if(y)for(const m in y)switch(m){case"data":case"state":case"_errors":Object.assign(l.payload[m],y[m]);break;default:l.payload[m]=y[m]}}l.hooks=b1(),l.hook=l.hooks.hook,l.callHook=l.hooks.callHook,l.provide=(y,m)=>{const a="$"+y;zf(l,a,m),zf(l.vueApp.config.globalProperties,a,m)},zf(l.vueApp,"$nuxt",l),zf(l.vueApp.config.globalProperties,"$nuxt",l);{window.addEventListener(VI,m=>{l.callHook("app:chunkError",{error:m.payload}),(l.isHydrating||m.payload.message.includes("Unable to preload CSS"))&&m.preventDefault()}),window.useNuxtApp||(window.useNuxtApp=ii);const y=l.hook("app:error",(...m)=>{console.error("[nuxt] error caught during app initialization",...m)});l.hook("app:mounted",y)}const h=l.payload.config;return l.provide("config",h),l}function GI(t,n){n.hooks&&t.hooks.addHooks(n.hooks)}async function ZI(t,n){if(typeof n=="function"){const{provide:l}=await t.runWithContext(()=>n(t))||{};if(l&&typeof l=="object")for(const h in l)t.provide(h,l[h])}}async function qI(t,n){const l=[],h=[],p=[],y=[];let m=0;async function a(I){var P;const z=((P=I.dependsOn)==null?void 0:P.filter(k=>n.some(N=>N._name===k)&&!l.includes(k)))??[];if(z.length>0)h.push([new Set(z),I]);else{const k=ZI(t,I).then(async()=>{I._name&&(l.push(I._name),await Promise.all(h.map(async([N,F])=>{N.has(I._name)&&(N.delete(I._name),N.size===0&&(m++,await a(F)))})))});I.parallel?p.push(k.catch(N=>y.push(N))):await k}}for(const I of n)GI(t,I);for(const I of n)await a(I);if(await Promise.all(p),m)for(let I=0;I<m;I++)await Promise.all(p);if(y.length)throw y[0]}function qn(t){if(typeof t=="function")return t;const n=t._name||t.name;return delete t.name,Object.assign(t.setup||(()=>{}),t,{[$I]:!0,_name:n})}function D0(t,n,l){const h=()=>n();return T1(t._id).set(t),t.vueApp.runWithContext(h)}function S1(t){var l;let n;return wp()&&(n=(l=eu())==null?void 0:l.appContext.app.$nuxt),n||(n=T1(t).tryUse()),n||null}function ii(t){const n=S1(t);if(!n)throw new Error("[nuxt] instance unavailable");return n}function Cl(t){return ii().$config}function zf(t,n,l){Object.defineProperty(t,n,{get:()=>l})}function HI(t,n){return{ctx:{table:t},matchAll:l=>C1(l,t)}}function E1(t){const n={};for(const l in t)n[l]=l==="dynamic"?new Map(Object.entries(t[l]).map(([h,p])=>[h,E1(p)])):new Map(Object.entries(t[l]));return n}function WI(t){return HI(E1(t))}function C1(t,n,l){t.endsWith("/")&&(t=t.slice(0,-1)||"/");const h=[];for(const[y,m]of O0(n.wildcard))(t===y||t.startsWith(y+"/"))&&h.push(m);for(const[y,m]of O0(n.dynamic))if(t.startsWith(y+"/")){const a="/"+t.slice(y.length).split("/").splice(2).join("/");h.push(...C1(a,m))}const p=n.static.get(t);return p&&h.push(p),h.filter(Boolean)}function O0(t){return[...t.entries()].sort((n,l)=>n[0].length-l[0].length)}function hg(t){if(t===null||typeof t!="object")return!1;const n=Object.getPrototypeOf(t);return n!==null&&n!==Object.prototype&&Object.getPrototypeOf(n)!==null||Symbol.iterator in t?!1:Symbol.toStringTag in t?Object.prototype.toString.call(t)==="[object Module]":!0}function Ug(t,n,l=".",h){if(!hg(n))return Ug(t,{},l,h);const p=Object.assign({},n);for(const y in t){if(y==="__proto__"||y==="constructor")continue;const m=t[y];m!=null&&(h&&h(p,y,m,l)||(Array.isArray(m)&&Array.isArray(p[y])?p[y]=[...m,...p[y]]:hg(m)&&hg(p[y])?p[y]=Ug(m,p[y],(l?`${l}.`:"")+y.toString(),h):p[y]=m))}return p}function k_(t){return(...n)=>n.reduce((l,h)=>Ug(l,h,"",t),{})}const rd=k_(),KI=k_((t,n,l)=>{if(t[n]!==void 0&&typeof l=="function")return t[n]=l(t[n]),!0});function XI(t,n){try{return n in t}catch{return!1}}class Gg extends Error{constructor(l,h={}){super(l,h);pa(this,"statusCode",500);pa(this,"fatal",!1);pa(this,"unhandled",!1);pa(this,"statusMessage");pa(this,"data");pa(this,"cause");h.cause&&!this.cause&&(this.cause=h.cause)}toJSON(){const l={message:this.message,statusCode:Zg(this.statusCode,500)};return this.statusMessage&&(l.statusMessage=I1(this.statusMessage)),this.data!==void 0&&(l.data=this.data),l}}pa(Gg,"__h3_error__",!0);function YI(t){if(typeof t=="string")return new Gg(t);if(JI(t))return t;const n=new Gg(t.message??t.statusMessage??"",{cause:t.cause||t});if(XI(t,"stack"))try{Object.defineProperty(n,"stack",{get(){return t.stack}})}catch{try{n.stack=t.stack}catch{}}if(t.data&&(n.data=t.data),t.statusCode?n.statusCode=Zg(t.statusCode,n.statusCode):t.status&&(n.statusCode=Zg(t.status,n.statusCode)),t.statusMessage?n.statusMessage=t.statusMessage:t.statusText&&(n.statusMessage=t.statusText),n.statusMessage){const l=n.statusMessage;I1(n.statusMessage)!==l&&console.warn("[h3] Please prefer using `message` for longer error messages instead of `statusMessage`. In the future, `statusMessage` will be sanitized by default.")}return t.fatal!==void 0&&(n.fatal=t.fatal),t.unhandled!==void 0&&(n.unhandled=t.unhandled),n}function JI(t){var n;return((n=t==null?void 0:t.constructor)==null?void 0:n.__h3_error__)===!0}const QI=/[^\u0009\u0020-\u007E]/g;function I1(t=""){return t.replace(QI,"")}function Zg(t,n=200){return!t||(typeof t=="string"&&(t=Number.parseInt(t,10)),t<100||t>999)?n:t}const M1=Symbol("route"),co=()=>{var t;return(t=ii())==null?void 0:t.$router},L_=()=>wp()?nn(M1,ii()._route):ii()._route;const eM=()=>{try{if(ii()._processingMiddleware)return!0}catch{return!1}return!1},P1=(t,n)=>{t||(t="/");const l=typeof t=="string"?t:"path"in t?qg(t):co().resolve(t).href;if(n!=null&&n.open){const{target:I="_blank",windowFeatures:z={}}=n.open,P=Object.entries(z).filter(([k,N])=>N!==void 0).map(([k,N])=>`${k.toLowerCase()}=${N}`).join(", ");return open(l,I,P),Promise.resolve()}const h=Aa(l,{acceptRelative:!0}),p=(n==null?void 0:n.external)||h;if(p){if(!(n!=null&&n.external))throw new Error("Navigating to an external URL is not allowed by default. Use `navigateTo(url, { external: true })`.");const{protocol:I}=new URL(l,window.location.href);if(I&&nI(I))throw new Error(`Cannot navigate to a URL with '${I}' protocol.`)}const y=eM();if(!p&&y){if(n!=null&&n.replace){if(typeof t=="string"){const{pathname:I,search:z,hash:P}=m1(t);return{path:I,...z&&{query:Cp(z)},...P&&{hash:P},replace:!0}}return{...t,replace:!0}}return t}const m=co(),a=ii();return p?(a._scope.stop(),n!=null&&n.replace?location.replace(l):location.href=l,y?a.isHydrating?new Promise(()=>{}):!1:Promise.resolve()):n!=null&&n.replace?m.replace(t):m.push(t)};function qg(t){return h1(t.path||"",t.query||{})+(t.hash||"")}const A1="__nuxt_error",z_=()=>Ko(ii().payload,"error"),tM=t=>{const n=R_(t);try{const l=ii(),h=z_();l.hooks.callHook("app:error",n),h.value||(h.value=n)}catch{throw n}return n},rM=async(t={})=>{const n=ii(),l=z_();n.callHook("app:error:cleared",t),t.redirect&&await co().replace(t.redirect),l.value=jI},iM=t=>!!t&&typeof t=="object"&&A1 in t,R_=t=>{const n=YI(t);return Object.defineProperty(n,A1,{value:!0,configurable:!1,writable:!1}),n};function F0(t){const n=oM(t),l=new ArrayBuffer(n.length),h=new DataView(l);for(let p=0;p<l.byteLength;p++)h.setUint8(p,n.charCodeAt(p));return l}const nM="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function oM(t){t.length%4===0&&(t=t.replace(/==?$/,""));let n="",l=0,h=0;for(let p=0;p<t.length;p++)l<<=6,l|=nM.indexOf(t[p]),h+=6,h===24&&(n+=String.fromCharCode((l&16711680)>>16),n+=String.fromCharCode((l&65280)>>8),n+=String.fromCharCode(l&255),l=h=0);return h===12?(l>>=4,n+=String.fromCharCode(l)):h===18&&(l>>=2,n+=String.fromCharCode((l&65280)>>8),n+=String.fromCharCode(l&255)),n}const sM=-1,aM=-2,lM=-3,cM=-4,uM=-5,hM=-6;function dM(t,n){return fM(JSON.parse(t),n)}function fM(t,n){if(typeof t=="number")return p(t,!0);if(!Array.isArray(t)||t.length===0)throw new Error("Invalid input");const l=t,h=Array(l.length);function p(y,m=!1){if(y===sM)return;if(y===lM)return NaN;if(y===cM)return 1/0;if(y===uM)return-1/0;if(y===hM)return-0;if(m)throw new Error("Invalid input");if(y in h)return h[y];const a=l[y];if(!a||typeof a!="object")h[y]=a;else if(Array.isArray(a))if(typeof a[0]=="string"){const I=a[0],z=n==null?void 0:n[I];if(z)return h[y]=z(p(a[1]));switch(I){case"Date":h[y]=new Date(a[1]);break;case"Set":const P=new Set;h[y]=P;for(let F=1;F<a.length;F+=1)P.add(p(a[F]));break;case"Map":const k=new Map;h[y]=k;for(let F=1;F<a.length;F+=2)k.set(p(a[F]),p(a[F+1]));break;case"RegExp":h[y]=new RegExp(a[1],a[2]);break;case"Object":h[y]=Object(a[1]);break;case"BigInt":h[y]=BigInt(a[1]);break;case"null":const N=Object.create(null);h[y]=N;for(let F=1;F<a.length;F+=2)N[a[F]]=p(a[F+1]);break;case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":{const F=globalThis[I],H=a[1],X=F0(H),ae=new F(X);h[y]=ae;break}case"ArrayBuffer":{const F=a[1],H=F0(F);h[y]=H;break}default:throw new Error(`Unknown type ${I}`)}}else{const I=new Array(a.length);h[y]=I;for(let z=0;z<a.length;z+=1){const P=a[z];P!==aM&&(I[z]=p(P))}}else{const I={};h[y]=I;for(const z in a){const P=a[z];I[z]=p(P)}}return h[y]}return p(0)}const pM=new Set(["link","style","script","noscript"]),mM=new Set(["title","titleTemplate","script","style","noscript"]),B0=new Set(["base","meta","link","style","script","noscript"]),gM=new Set(["title","base","htmlAttrs","bodyAttrs","meta","link","style","script","noscript"]),_M=new Set(["base","title","titleTemplate","bodyAttrs","htmlAttrs","templateParams"]),yM=new Set(["key","tagPosition","tagPriority","tagDuplicateStrategy","innerHTML","textContent","processTemplateParams"]),vM=new Set(["templateParams","htmlAttrs","bodyAttrs"]),bM=new Set(["theme-color","google-site-verification","og","article","book","profile","twitter","author"]);const xM=["name","property","http-equiv"];function k1(t){const n=t.split(":")[1];return bM.has(n)}function Hg(t){const{props:n,tag:l}=t;if(_M.has(l))return l;if(l==="link"&&n.rel==="canonical")return"canonical";if(n.charset)return"charset";if(t.tag==="meta"){for(const h of xM)if(n[h]!==void 0)return`${l}:${n[h]}`}if(t.key)return`${l}:key:${t.key}`;if(n.id)return`${l}:id:${n.id}`;if(mM.has(l)){const h=t.textContent||t.innerHTML;if(h)return`${l}:content:${h}`}}function j0(t){const n=t._h||t._d;if(n)return n;const l=t.textContent||t.innerHTML;return l||`${t.tag}:${Object.entries(t.props).map(([h,p])=>`${h}:${String(p)}`).join(",")}`}function cp(t,n,l){typeof t==="function"&&(!l||l!=="titleTemplate"&&!(l[0]==="o"&&l[1]==="n"))&&(t=t());let p;if(n&&(p=n(l,t)),Array.isArray(p))return p.map(y=>cp(y,n));if((p==null?void 0:p.constructor)===Object){const y={};for(const m of Object.keys(p))y[m]=cp(p[m],n,m);return y}return p}function wM(t,n){const l=t==="style"?new Map:new Set;function h(p){const y=p.trim();if(y)if(t==="style"){const[m,...a]=y.split(":").map(I=>I.trim());m&&a.length&&l.set(m,a.join(":"))}else y.split(" ").filter(Boolean).forEach(m=>l.add(m))}return typeof n=="string"?t==="style"?n.split(";").forEach(h):h(n):Array.isArray(n)?n.forEach(p=>h(p)):n&&typeof n=="object"&&Object.entries(n).forEach(([p,y])=>{y&&y!=="false"&&(t==="style"?l.set(p.trim(),y):h(p))}),l}function L1(t,n){return t.props=t.props||{},n&&Object.entries(n).forEach(([l,h])=>{if(h===null){t.props[l]=null;return}if(l==="class"||l==="style"){t.props[l]=wM(l,h);return}if(yM.has(l)){if(["textContent","innerHTML"].includes(l)&&typeof h=="object"){let m=n.type;if(n.type||(m="application/json"),!(m!=null&&m.endsWith("json"))&&m!=="speculationrules")return;n.type=m,t.props.type=m,t[l]=JSON.stringify(h)}else t[l]=h;return}const p=String(h),y=l.startsWith("data-");p==="true"||p===""?t.props[l]=y?p:!0:!h&&y&&p==="false"?t.props[l]="false":h!==void 0&&(t.props[l]=h)}),t}function TM(t,n){const l=typeof n=="object"&&typeof n!="function"?n:{[t==="script"||t==="noscript"||t==="style"?"innerHTML":"textContent"]:n},h=L1({tag:t,props:{}},l);return h.key&&pM.has(h.tag)&&(h.props["data-hid"]=h._h=h.key),h.tag==="script"&&typeof h.innerHTML=="object"&&(h.innerHTML=JSON.stringify(h.innerHTML),h.props.type=h.props.type||"application/json"),Array.isArray(h.props.content)?h.props.content.map(p=>({...h,props:{...h.props,content:p}})):h}function SM(t,n){if(!t)return[];typeof t=="function"&&(t=t());const l=(p,y)=>{for(let m=0;m<n.length;m++)y=n[m](p,y);return y};t=l(void 0,t);const h=[];return t=cp(t,l),Object.entries(t||{}).forEach(([p,y])=>{if(y!==void 0)for(const m of Array.isArray(y)?y:[y])h.push(TM(p,m))}),h.flat()}const Wg=(t,n)=>t._w===n._w?t._p-n._p:t._w-n._w,N0={base:-10,title:10},EM={critical:-8,high:-1,low:2},V0={meta:{"content-security-policy":-30,charset:-20,viewport:-15},link:{preconnect:20,stylesheet:60,preload:70,modulepreload:70,prefetch:90,"dns-prefetch":90,prerender:90},script:{async:30,defer:80,sync:50},style:{imported:40,sync:60}},CM=/@import/,vh=t=>t===""||t===!0;function IM(t,n){var y;if(typeof n.tagPriority=="number")return n.tagPriority;let l=100;const h=EM[n.tagPriority]||0,p=t.resolvedOptions.disableCapoSorting?{link:{},script:{},style:{}}:V0;if(n.tag in N0)l=N0[n.tag];else if(n.tag==="meta"){const m=n.props["http-equiv"]==="content-security-policy"?"content-security-policy":n.props.charset?"charset":n.props.name==="viewport"?"viewport":null;m&&(l=V0.meta[m])}else n.tag==="link"&&n.props.rel?l=p.link[n.props.rel]:n.tag==="script"?vh(n.props.async)?l=p.script.async:n.props.src&&!vh(n.props.defer)&&!vh(n.props.async)&&n.props.type!=="module"&&!((y=n.props.type)!=null&&y.endsWith("json"))?l=p.script.sync:vh(n.props.defer)&&n.props.src&&!vh(n.props.async)&&(l=p.script.defer):n.tag==="style"&&(l=n.innerHTML&&CM.test(n.innerHTML)?p.style.imported:p.style.sync);return(l||100)+h}function $0(t,n){const l=typeof n=="function"?n(t):n,h=l.key||String(t.plugins.size+1);t.plugins.get(h)||(t.plugins.set(h,l),t.hooks.addHooks(l.hooks||{}))}function MM(t={}){var a;const n=b1();n.addHooks(t.hooks||{});const l=!t.document,h=new Map,p=new Map,y=[],m={_entryCount:1,plugins:p,dirty:!1,resolvedOptions:t,hooks:n,ssr:l,entries:h,headEntries(){return[...h.values()]},use:I=>$0(m,I),push(I,z){const P={...z||{}};delete P.head;const k=P._index??m._entryCount++,N={_i:k,input:I,options:P},F={_poll(H=!1){m.dirty=!0,!H&&y.push(k),n.callHook("entries:updated",m)},dispose(){h.delete(k)&&F._poll(!0)},patch(H){(!P.mode||P.mode==="server"&&l||P.mode==="client"&&!l)&&(N.input=H,h.set(k,N),F._poll())}};return F.patch(I),F},async resolveTags(){var F;const I={tagMap:new Map,tags:[],entries:[...m.entries.values()]};for(await n.callHook("entries:resolve",I);y.length;){const H=y.shift(),X=h.get(H);if(X){const ae={tags:SM(X.input,t.propResolvers||[]).map(Se=>Object.assign(Se,X.options)),entry:X};await n.callHook("entries:normalize",ae),X._tags=ae.tags.map((Se,be)=>(Se._w=IM(m,Se),Se._p=(X._i<<10)+be,Se._d=Hg(Se),Se))}}let z=!1;I.entries.flatMap(H=>(H._tags||[]).map(X=>({...X,props:{...X.props}}))).sort(Wg).reduce((H,X)=>{const ae=String(X._d||X._p);if(!H.has(ae))return H.set(ae,X);const Se=H.get(ae);if(((X==null?void 0:X.tagDuplicateStrategy)||(vM.has(X.tag)?"merge":null)||(X.key&&X.key===Se.key?"merge":null))==="merge"){const Q={...Se.props};Object.entries(X.props).forEach(([re,J])=>Q[re]=re==="style"?new Map([...Se.props.style||new Map,...J]):re==="class"?new Set([...Se.props.class||new Set,...J]):J),H.set(ae,{...X,props:Q})}else X._p>>10===Se._p>>10&&k1(X._d)?(H.set(ae,Object.assign([...Array.isArray(Se)?Se:[Se],X],X)),z=!0):(X._w===Se._w?X._p>Se._p:(X==null?void 0:X._w)<(Se==null?void 0:Se._w))&&H.set(ae,X);return H},I.tagMap);const P=I.tagMap.get("title"),k=I.tagMap.get("titleTemplate");if(m._title=P==null?void 0:P.textContent,k){const H=k==null?void 0:k.textContent;if(m._titleTemplate=typeof H=="string"?H:void 0,H){let X=typeof H=="function"?H(P==null?void 0:P.textContent):H;typeof X=="string"&&!m.plugins.has("template-params")&&(X=X.replace("%s",(P==null?void 0:P.textContent)||"")),P?X===null?I.tagMap.delete("title"):I.tagMap.set("title",{...P,textContent:X}):(k.tag="title",k.textContent=X)}}I.tags=Array.from(I.tagMap.values()),z&&(I.tags=I.tags.flat().sort(Wg)),await n.callHook("tags:beforeResolve",I),await n.callHook("tags:resolve",I),await n.callHook("tags:afterResolve",I);const N=[];for(const H of I.tags){const{innerHTML:X,tag:ae,props:Se}=H;if(gM.has(ae)&&!(Object.keys(Se).length===0&&!H.innerHTML&&!H.textContent)&&!(ae==="meta"&&!Se.content&&!Se["http-equiv"]&&!Se.charset)){if(ae==="script"&&X){if((F=Se.type)!=null&&F.endsWith("json")){const be=typeof X=="string"?X:JSON.stringify(X);H.innerHTML=be.replace(/</g,"\\u003C")}else typeof X=="string"&&(H.innerHTML=X.replace(new RegExp(`</${ae}`,"g"),`<\\/${ae}`));H._d=Hg(H)}N.push(H)}}return N}};return((t==null?void 0:t.plugins)||[]).forEach(I=>$0(m,I)),m.hooks.callHook("init",m),(a=t.init)==null||a.forEach(I=>I&&m.push(I)),m}const Ta="%separator",PM=new RegExp(`${Ta}(?:\\s*${Ta})*`,"g");function AM(t,n,l=!1){var p;let h;if(n==="s"||n==="pageTitle")h=t.pageTitle;else if(n.includes(".")){const y=n.indexOf(".");h=(p=t[n.substring(0,y)])==null?void 0:p[n.substring(y+1)]}else h=t[n];if(h!==void 0)return l?(h||"").replace(/\\/g,"\\\\").replace(/</g,"\\u003C").replace(/"/g,'\\"'):h||""}function Rf(t,n,l,h=!1){if(typeof t!="string"||!t.includes("%"))return t;let p=t;try{p=decodeURI(t)}catch{}const y=p.match(/%\w+(?:\.\w+)?/g);if(!y)return t;const m=t.includes(Ta);return t=t.replace(/%\w+(?:\.\w+)?/g,a=>{if(a===Ta||!y.includes(a))return a;const I=AM(n,a.slice(1),h);return I!==void 0?I:a}).trim(),m&&(t.endsWith(Ta)&&(t=t.slice(0,-Ta.length)),t.startsWith(Ta)&&(t=t.slice(Ta.length)),t=t.replace(PM,l||"").trim()),t}const U0=t=>t.includes(":key")?t:t.split(":").join(":key:"),kM={key:"aliasSorting",hooks:{"tags:resolve":t=>{let n=!1;for(const l of t.tags){const h=l.tagPriority;if(!h)continue;const p=String(h);if(p.startsWith("before:")){const y=U0(p.slice(7)),m=t.tagMap.get(y);m&&(typeof m.tagPriority=="number"&&(l.tagPriority=m.tagPriority),l._p=m._p-1,n=!0)}else if(p.startsWith("after:")){const y=U0(p.slice(6)),m=t.tagMap.get(y);m&&(typeof m.tagPriority=="number"&&(l.tagPriority=m.tagPriority),l._p=m._p+1,n=!0)}}n&&(t.tags=t.tags.sort(Wg))}}},LM={key:"deprecations",hooks:{"entries:normalize":({tags:t})=>{for(const n of t)n.props.children&&(n.innerHTML=n.props.children,delete n.props.children),n.props.hid&&(n.key=n.props.hid,delete n.props.hid),n.props.vmid&&(n.key=n.props.vmid,delete n.props.vmid),n.props.body&&(n.tagPosition="bodyClose",delete n.props.body)}}};async function Kg(t){if(typeof t==="function")return t;if(t instanceof Promise)return await t;if(Array.isArray(t))return await Promise.all(t.map(l=>Kg(l)));if((t==null?void 0:t.constructor)===Object){const l={};for(const h of Object.keys(t))l[h]=await Kg(t[h]);return l}return t}const zM={key:"promises",hooks:{"entries:resolve":async t=>{const n=[];for(const l in t.entries)t.entries[l]._promisesProcessed||n.push(Kg(t.entries[l].input).then(h=>{t.entries[l].input=h,t.entries[l]._promisesProcessed=!0}));await Promise.all(n)}}},RM={meta:"content",link:"href",htmlAttrs:"lang"},DM=["innerHTML","textContent"],OM=t=>({key:"template-params",hooks:{"entries:normalize":n=>{var h,p,y;const l=((p=(h=n.tags.filter(m=>m.tag==="templateParams"&&m.mode==="server"))==null?void 0:h[0])==null?void 0:p.props)||{};Object.keys(l).length&&(t._ssrPayload={templateParams:{...((y=t._ssrPayload)==null?void 0:y.templateParams)||{},...l}})},"tags:resolve":({tagMap:n,tags:l})=>{var y;const h=((y=n.get("templateParams"))==null?void 0:y.props)||{},p=h.separator||"|";delete h.separator,h.pageTitle=Rf(h.pageTitle||t._title||"",h,p);for(const m of l){if(m.processTemplateParams===!1)continue;const a=RM[m.tag];if(a&&typeof m.props[a]=="string")m.props[a]=Rf(m.props[a],h,p);else if(m.processTemplateParams||m.tag==="titleTemplate"||m.tag==="title")for(const I of DM)typeof m[I]=="string"&&(m[I]=Rf(m[I],h,p,m.tag==="script"&&m.props.type.endsWith("json")))}t._templateParams=h,t._separator=p},"tags:afterResolve":({tagMap:n})=>{const l=n.get("title");l!=null&&l.textContent&&l.processTemplateParams!==!1&&(l.textContent=Rf(l.textContent,t._templateParams,t._separator))}}}),FM=(t,n)=>li(n)?vl(n):n,D_="usehead";function BM(t){return{install(l){l.config.globalProperties.$unhead=t,l.config.globalProperties.$head=t,l.provide(D_,t)}}.install}function jM(){if(wp()){const t=nn(D_);if(!t)throw new Error("useHead() was called without provide context, ensure you call it through the setup() function.");return t}throw new Error("useHead() was called without provide context, ensure you call it through the setup() function.")}function NM(t,n={}){const l=n.head||jM();return l.ssr?l.push(t||{},n):VM(l,t,n)}function VM(t,n,l={}){const h=$t(!1);let p;return lo(()=>{const m=h.value?{}:cp(n,FM);p?p.patch(m):p=t.push(m,l)}),eu()&&(xp(()=>{p.dispose()}),Sx(()=>{h.value=!0}),Tx(()=>{h.value=!1})),p}function $M(t){var l;const n=t||S1();return((l=n==null?void 0:n.ssrContext)==null?void 0:l.head)||(n==null?void 0:n.runWithContext(()=>{if(wp())return nn(D_)}))}function UM(t,n={}){const l=$M(n.nuxt);if(l)return NM(t,{head:l,...n})}const GM="modulepreload",ZM=function(t,n){return new URL(t,n).href},G0={},Xg=function(n,l,h){let p=Promise.resolve();if(l&&l.length>0){const m=document.getElementsByTagName("link"),a=document.querySelector("meta[property=csp-nonce]"),I=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));p=Promise.allSettled(l.map(z=>{if(z=ZM(z,h),z in G0)return;G0[z]=!0;const P=z.endsWith(".css"),k=P?'[rel="stylesheet"]':"";if(!!h)for(let H=m.length-1;H>=0;H--){const X=m[H];if(X.href===z&&(!P||X.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${z}"]${k}`))return;const F=document.createElement("link");if(F.rel=P?"stylesheet":GM,P||(F.as="script"),F.crossOrigin="",F.href=z,I&&F.setAttribute("nonce",I),document.head.appendChild(F),P)return new Promise((H,X)=>{F.addEventListener("load",H),F.addEventListener("error",()=>X(new Error(`Unable to preload CSS for ${z}`)))})}))}function y(m){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=m,window.dispatchEvent(a),!a.defaultPrevented)throw m}return p.then(m=>{for(const a of m||[])a.status==="rejected"&&y(a.reason);return n().catch(y)})};let Vf,$f;function qM(){return Vf=$fetch(A_(`builds/meta/${Cl().app.buildId}.json`),{responseType:"json"}),Vf.then(t=>{$f=WI(t.matcher)}).catch(t=>{console.error("[nuxt] Error fetching app manifest.",t)}),Vf}function Mp(){return Vf||qM()}async function O_(t){const n=typeof t=="string"?t:t.path;if(await Mp(),!$f)return console.error("[nuxt] Error creating app manifest matcher.",$f),{};try{return rd({},...$f.matchAll(n).reverse())}catch(l){return console.error("[nuxt] Error matching route rules.",l),{}}}async function Z0(t,n={}){if(!await R1(t))return null;const h=await WM(t,n);return await z1(h)||null}const HM="_payload.json";async function WM(t,n={}){const l=new URL(t,"http://localhost");if(l.host!=="localhost"||Aa(l.pathname,{acceptRelative:!0}))throw new Error("Payload URL must not include hostname: "+t);const h=Cl(),p=n.hash||(n.fresh?Date.now():h.app.buildId),y=h.app.cdnURL,m=y&&await R1(t)?y:h.app.baseURL;return td(m,l.pathname,HM+(p?`?${p}`:""))}async function z1(t){const n=fetch(t,{cache:"force-cache"}).then(l=>l.text().then(D1));try{return await n}catch(l){console.warn("[nuxt] Cannot load payload ",t,l)}return null}async function R1(t=L_().path){const n=ii();return t=Ip(t),(await Mp()).prerendered.includes(t)?!0:n.runWithContext(async()=>{const h=await O_({path:t});return!!h.prerender&&!h.redirect})}let fl=null;async function KM(){var h;if(fl)return fl;const t=document.getElementById("__NUXT_DATA__");if(!t)return{};const n=await D1(t.textContent||""),l=t.dataset.src?await z1(t.dataset.src):void 0;return fl={...n,...l,...window.__NUXT__},(h=fl.config)!=null&&h.public&&(fl.config.public=Co(fl.config.public)),fl}async function D1(t){return await dM(t,ii()._payloadRevivers)}function XM(t,n){ii()._payloadRevivers[t]=n}const YM=[["NuxtError",t=>R_(t)],["EmptyShallowRef",t=>El(t==="_"?void 0:t==="0n"?BigInt(0):ip(t))],["EmptyRef",t=>$t(t==="_"?void 0:t==="0n"?BigInt(0):ip(t))],["ShallowRef",t=>El(t)],["ShallowReactive",t=>Dc(t)],["Ref",t=>$t(t)],["Reactive",t=>Co(t)]],JM=qn({name:"nuxt:revive-payload:client",order:-30,async setup(t){let n,l;for(const[h,p]of YM)XM(h,p);Object.assign(t.payload,([n,l]=x1(()=>t.runWithContext(KM)),n=await n,l(),n)),window.__NUXT__=t.payload}});async function F_(t,n={}){const l=n.document||t.resolvedOptions.document;if(!l||!t.dirty)return;const h={shouldRender:!0,tags:[]};if(await t.hooks.callHook("dom:beforeRender",h),!!h.shouldRender)return t._domUpdatePromise||(t._domUpdatePromise=new Promise(async p=>{var F;const y=new Map,m=new Promise(H=>{t.resolveTags().then(X=>{H(X.map(ae=>{const Se=y.get(ae._d)||0,be={tag:ae,id:(Se?`${ae._d}:${Se}`:ae._d)||j0(ae),shouldRender:!0};return ae._d&&k1(ae._d)&&y.set(ae._d,Se+1),be}))})});let a=t._dom;if(!a){a={title:l.title,elMap:new Map().set("htmlAttrs",l.documentElement).set("bodyAttrs",l.body)};for(const H of["body","head"]){const X=(F=l[H])==null?void 0:F.children;for(const ae of X){const Se=ae.tagName.toLowerCase();if(!B0.has(Se))continue;const be=L1({tag:Se,props:{}},{innerHTML:ae.innerHTML,...ae.getAttributeNames().reduce((Q,re)=>(Q[re]=ae.getAttribute(re),Q),{})||{}});if(be.key=ae.getAttribute("data-hid")||void 0,be._d=Hg(be)||j0(be),a.elMap.has(be._d)){let Q=1,re=be._d;for(;a.elMap.has(re);)re=`${be._d}:${Q++}`;a.elMap.set(re,ae)}else a.elMap.set(be._d,ae)}}}a.pendingSideEffects={...a.sideEffects},a.sideEffects={};function I(H,X,ae){const Se=`${H}:${X}`;a.sideEffects[Se]=ae,delete a.pendingSideEffects[Se]}function z({id:H,$el:X,tag:ae}){const Se=ae.tag.endsWith("Attrs");a.elMap.set(H,X),Se||(ae.textContent&&ae.textContent!==X.textContent&&(X.textContent=ae.textContent),ae.innerHTML&&ae.innerHTML!==X.innerHTML&&(X.innerHTML=ae.innerHTML),I(H,"el",()=>{X==null||X.remove(),a.elMap.delete(H)}));for(const be in ae.props){if(!Object.prototype.hasOwnProperty.call(ae.props,be))continue;const Q=ae.props[be];if(be.startsWith("on")&&typeof Q=="function"){const J=X==null?void 0:X.dataset;if(J&&J[`${be}fired`]){const le=be.slice(0,-5);Q.call(X,new Event(le.substring(2)))}X.getAttribute(`data-${be}`)!==""&&((ae.tag==="bodyAttrs"?l.defaultView:X).addEventListener(be.substring(2),Q.bind(X)),X.setAttribute(`data-${be}`,""));continue}const re=`attr:${be}`;if(be==="class"){if(!Q)continue;for(const J of Q)Se&&I(H,`${re}:${J}`,()=>X.classList.remove(J)),!X.classList.contains(J)&&X.classList.add(J)}else if(be==="style"){if(!Q)continue;for(const[J,le]of Q)I(H,`${re}:${J}`,()=>{X.style.removeProperty(J)}),X.style.setProperty(J,le)}else Q!==!1&&Q!==null&&(X.getAttribute(be)!==Q&&X.setAttribute(be,Q===!0?"":String(Q)),Se&&I(H,re,()=>X.removeAttribute(be)))}}const P=[],k={bodyClose:void 0,bodyOpen:void 0,head:void 0},N=await m;for(const H of N){const{tag:X,shouldRender:ae,id:Se}=H;if(ae){if(X.tag==="title"){l.title=X.textContent,I("title","",()=>l.title=a.title);continue}H.$el=H.$el||a.elMap.get(Se),H.$el?z(H):B0.has(X.tag)&&P.push(H)}}for(const H of P){const X=H.tag.tagPosition||"head";H.$el=l.createElement(H.tag.tag),z(H),k[X]=k[X]||l.createDocumentFragment(),k[X].appendChild(H.$el)}for(const H of N)await t.hooks.callHook("dom:renderTag",H,l,I);k.head&&l.head.appendChild(k.head),k.bodyOpen&&l.body.insertBefore(k.bodyOpen,l.body.firstChild),k.bodyClose&&l.body.appendChild(k.bodyClose);for(const H in a.pendingSideEffects)a.pendingSideEffects[H]();t._dom=a,await t.hooks.callHook("dom:rendered",{renders:N}),p()}).finally(()=>{t._domUpdatePromise=void 0,t.dirty=!1})),t._domUpdatePromise}function QM(t={}){var h,p,y;const n=((h=t.domOptions)==null?void 0:h.render)||F_;t.document=t.document||(typeof window<"u"?document:void 0);const l=((y=(p=t.document)==null?void 0:p.head.querySelector('script[id="unhead:payload"]'))==null?void 0:y.innerHTML)||!1;return MM({...t,plugins:[...t.plugins||[],{key:"client",hooks:{"entries:updated":n}}],init:[l?JSON.parse(l):!1,...t.init||[]]})}function eP(t,n){let l=0;return()=>{const h=++l;n(()=>{l===h&&t()})}}function tP(t={}){const n=QM({domOptions:{render:eP(()=>F_(n),tn)},...t});return n.install=BM(n),n}const rP={disableDefaults:!0,disableCapoSorting:!1,plugins:[LM,zM,OM,kM]},iP=qn({name:"nuxt:head",enforce:"pre",setup(t){const n=tP(rP);t.vueApp.use(n);{let l=!0;const h=async()=>{l=!1,await F_(n)};n.hooks.hook("dom:beforeRender",p=>{p.shouldRender=!l}),t.hooks.hook("page:start",()=>{l=!0}),t.hooks.hook("page:finish",()=>{t.isHydrating||h()}),t.hooks.hook("app:error",h),t.hooks.hook("app:suspense:resolve",h)}}}),nP=async t=>{let n,l;const h=([n,l]=x1(()=>O_({path:t.path})),n=await n,l(),n);if(h.redirect)return Aa(h.redirect,{acceptRelative:!0})?(window.location.href=h.redirect,!1):h.redirect},oP=[nP];function dg(t){typeof t=="object"&&(t=g1({pathname:t.path||"",search:u1(t.query||{}),hash:t.hash||""}));const n=new URL(t.toString(),window.location.href);return{path:n.pathname,fullPath:t,query:Cp(n.search),hash:n.hash,params:{},name:void 0,matched:[],redirectedFrom:void 0,meta:{},href:t}}const sP=qn({name:"nuxt:router",enforce:"pre",setup(t){const n=aI(window.location.pathname,Cl().app.baseURL)+window.location.search+window.location.hash,l=[],h={"navigate:before":[],"resolve:before":[],"navigate:after":[],error:[]},p=(k,N)=>(h[k].push(N),()=>h[k].splice(h[k].indexOf(N),1)),y=Cl().app.baseURL,m=Co(dg(n));async function a(k,N){try{const F=dg(k);for(const H of h["navigate:before"]){const X=await H(F,m);if(X===!1||X instanceof Error)return;if(typeof X=="string"&&X.length)return a(X,!0)}for(const H of h["resolve:before"])await H(F,m);Object.assign(m,F),window.history[N?"replaceState":"pushState"]({},"",td(y,F.fullPath)),t.isHydrating||await t.runWithContext(rM);for(const H of h["navigate:after"])await H(F,m)}catch(F){for(const H of h.error)await H(F)}}const z={currentRoute:Ye(()=>m),isReady:()=>Promise.resolve(),options:{},install:()=>Promise.resolve(),push:k=>a(k,!1),replace:k=>a(k,!0),back:()=>window.history.go(-1),go:k=>window.history.go(k),forward:()=>window.history.go(1),beforeResolve:k=>p("resolve:before",k),beforeEach:k=>p("navigate:before",k),afterEach:k=>p("navigate:after",k),onError:k=>p("error",k),resolve:dg,addRoute:(k,N)=>{l.push(N)},getRoutes:()=>l,hasRoute:k=>l.some(N=>N.name===k),removeRoute:k=>{const N=l.findIndex(F=>F.name===k);N!==-1&&l.splice(N,1)}};t.vueApp.component("RouterLink",Ur({functional:!0,props:{to:{type:String,required:!0},custom:Boolean,replace:Boolean,activeClass:String,exactActiveClass:String,ariaCurrentValue:String},setup:(k,{slots:N})=>{const F=()=>a(k.to,k.replace);return()=>{var X;const H=z.resolve(k.to);return k.custom?(X=N.default)==null?void 0:X.call(N,{href:k.to,navigate:F,route:H}):pn("a",{href:k.to,onClick:ae=>(ae.preventDefault(),F())},N)}}})),window.addEventListener("popstate",k=>{const N=k.target.location;z.replace(N.href.replace(N.origin,""))}),t._route=m,t._middleware||(t._middleware={global:[],named:{}});const P=t.payload.state._layout;return t.hooks.hookOnce("app:created",async()=>{z.beforeEach(async(k,N)=>{k.meta=Co(k.meta||{}),t.isHydrating&&P&&!Ca(k.meta.layout)&&(k.meta.layout=P),t._processingMiddleware=!0;{const F=new Set([...oP,...t._middleware.global]);{const H=await t.runWithContext(()=>O_({path:k.path}));if(H.appMiddleware)for(const X in H.appMiddleware){const ae=t._middleware.named[X];if(!ae)return;H.appMiddleware[X]?F.add(ae):F.delete(ae)}}for(const H of F){const X=await t.runWithContext(()=>H(k,N));if(X!==!0&&(X||X===!1))return X}}}),z.afterEach(()=>{delete t._processingMiddleware}),await z.replace(n),cI(m.fullPath,n)||await t.runWithContext(()=>P1(m.fullPath))}),{provide:{route:m,router:z}}}}),Yg=globalThis.requestIdleCallback||(t=>{const n=Date.now(),l={didTimeout:!1,timeRemaining:()=>Math.max(0,50-(Date.now()-n))};return setTimeout(()=>{t(l)},1)}),aP=globalThis.cancelIdleCallback||(t=>{clearTimeout(t)}),Pp=t=>{const n=ii();n.isHydrating?n.hooks.hookOnce("app:suspense:resolve",()=>{Yg(()=>t())}):Yg(()=>t())},lP=qn({name:"nuxt:payload",setup(t){const n=new Set;co().beforeResolve(async(l,h)=>{if(l.path===h.path)return;const p=await Z0(l.path);if(p){for(const y of n)delete t.static.data[y];for(const y in p.data)y in t.static.data||n.add(y),t.static.data[y]=p.data[y]}}),Pp(()=>{var l;t.hooks.hook("link:prefetch",async h=>{const{hostname:p}=new URL(h,window.location.href);p===window.location.hostname&&await Z0(h).catch(()=>{console.warn("[nuxt] Error preloading payload for",h)})}),((l=navigator.connection)==null?void 0:l.effectiveType)!=="slow-2g"&&setTimeout(Mp,1e3)})}}),cP=qn(()=>{const t=co();Pp(()=>{t.beforeResolve(async()=>{await new Promise(n=>{setTimeout(n,100),requestAnimationFrame(()=>{setTimeout(n,0)})})})})}),uP=qn(t=>{let n;async function l(){const h=await Mp();n&&clearTimeout(n),n=setTimeout(l,R0);try{const p=await $fetch(A_("builds/latest.json")+`?${Date.now()}`);p.id!==h.id&&t.hooks.callHook("app:manifest:update",p)}catch{}}Pp(()=>{n=setTimeout(l,R0)})});function hP(t={}){const n=t.path||window.location.pathname;let l={};try{l=ip(sessionStorage.getItem("nuxt:reload")||"{}")}catch{}if(t.force||(l==null?void 0:l.path)!==n||(l==null?void 0:l.expires)<Date.now()){try{sessionStorage.setItem("nuxt:reload",JSON.stringify({path:n,expires:Date.now()+(t.ttl??1e4)}))}catch{}if(t.persistState)try{sessionStorage.setItem("nuxt:reload:state",JSON.stringify({state:ii().payload.state}))}catch{}window.location.pathname!==n?window.location.href=n:window.location.reload()}}const dP=qn({name:"nuxt:chunk-reload",setup(t){const n=co(),l=Cl(),h=new Set;n.beforeEach(()=>{h.clear()}),t.hook("app:chunkError",({error:y})=>{h.add(y)});function p(y){const a="href"in y&&y.href[0]==="#"?l.app.baseURL+y.href:td(l.app.baseURL,y.fullPath);hP({path:a,persistState:!0})}t.hook("app:manifest:update",()=>{n.beforeResolve(p)}),n.onError((y,m)=>{h.has(y)&&p(m)})}}),fP=Pg(()=>Xg(()=>Promise.resolve().then(()=>vL),void 0,import.meta.url).then(t=>t.default||t.default||t)),pP=[["Icon",fP]],mP=qn({name:"nuxt:global-components",setup(t){for(const[n,l]of pP)t.vueApp.component(n,l),t.vueApp.component("Lazy"+n,l)}});typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Jg=()=>{};function gP(t,n){function l(...h){return new Promise((p,y)=>{Promise.resolve(t(()=>n.apply(this,h),{fn:n,thisArg:this,args:h})).then(p).catch(y)})}return l}function _P(t,n={}){let l,h,p=Jg;const y=I=>{clearTimeout(I),p(),p=Jg};let m;return I=>{const z=vl(t),P=vl(n.maxWait);return l&&y(l),z<=0||P!==void 0&&P<=0?(h&&(y(h),h=null),Promise.resolve(I())):new Promise((k,N)=>{p=n.rejectOnCancel?N:k,m=I,P&&!h&&(h=setTimeout(()=>{l&&y(l),h=null,k(m())},P)),l=setTimeout(()=>{h&&y(h),h=null,k(I())},z)})}}function O1(t,n=200,l={}){return gP(_P(n,l),t)}function yP(t,n,l){let h;li(l)?h={evaluating:l}:h=l||{};const{lazy:p=!1,evaluating:y=void 0,shallow:m=!0,onError:a=Jg}=h,I=El(!p),z=m?El(n):$t(n);let P=0;return lo(async k=>{if(!I.value)return;P++;const N=P;let F=!1;y&&Promise.resolve().then(()=>{y.value=!0});try{const H=await t(X=>{k(()=>{y&&(y.value=!1),F||X()})});N===P&&(z.value=H)}catch(H){a(H)}finally{y&&N===P&&(y.value=!1),F=!0}}),p?Ye(()=>(I.value=!0,z.value)):z}function q0(t){var n;const l=vl(t);return(n=l==null?void 0:l.$el)!=null?n:l}const vP=Symbol("nuxt-ui.slideover"),bP=qn(t=>{const n=El({component:"div",props:{}});t.vueApp.provide(vP,n)}),xP=Symbol("nuxt-ui.modal"),wP=qn(t=>{const n=El({component:"div",props:{}});t.vueApp.provide(xP,n)}),B_="-",TP=t=>{const n=EP(t),{conflictingClassGroups:l,conflictingClassGroupModifiers:h}=t;return{getClassGroupId:m=>{const a=m.split(B_);return a[0]===""&&a.length!==1&&a.shift(),F1(a,n)||SP(m)},getConflictingClassGroupIds:(m,a)=>{const I=l[m]||[];return a&&h[m]?[...I,...h[m]]:I}}},F1=(t,n)=>{var m;if(t.length===0)return n.classGroupId;const l=t[0],h=n.nextPart.get(l),p=h?F1(t.slice(1),h):void 0;if(p)return p;if(n.validators.length===0)return;const y=t.join(B_);return(m=n.validators.find(({validator:a})=>a(y)))==null?void 0:m.classGroupId},H0=/^\[(.+)\]$/,SP=t=>{if(H0.test(t)){const n=H0.exec(t)[1],l=n==null?void 0:n.substring(0,n.indexOf(":"));if(l)return"arbitrary.."+l}},EP=t=>{const{theme:n,prefix:l}=t,h={nextPart:new Map,validators:[]};return IP(Object.entries(t.classGroups),l).forEach(([y,m])=>{Qg(m,h,y,n)}),h},Qg=(t,n,l,h)=>{t.forEach(p=>{if(typeof p=="string"){const y=p===""?n:W0(n,p);y.classGroupId=l;return}if(typeof p=="function"){if(CP(p)){Qg(p(h),n,l,h);return}n.validators.push({validator:p,classGroupId:l});return}Object.entries(p).forEach(([y,m])=>{Qg(m,W0(n,y),l,h)})})},W0=(t,n)=>{let l=t;return n.split(B_).forEach(h=>{l.nextPart.has(h)||l.nextPart.set(h,{nextPart:new Map,validators:[]}),l=l.nextPart.get(h)}),l},CP=t=>t.isThemeGetter,IP=(t,n)=>n?t.map(([l,h])=>{const p=h.map(y=>typeof y=="string"?n+y:typeof y=="object"?Object.fromEntries(Object.entries(y).map(([m,a])=>[n+m,a])):y);return[l,p]}):t,MP=t=>{if(t<1)return{get:()=>{},set:()=>{}};let n=0,l=new Map,h=new Map;const p=(y,m)=>{l.set(y,m),n++,n>t&&(n=0,h=l,l=new Map)};return{get(y){let m=l.get(y);if(m!==void 0)return m;if((m=h.get(y))!==void 0)return p(y,m),m},set(y,m){l.has(y)?l.set(y,m):p(y,m)}}},B1="!",PP=t=>{const{separator:n,experimentalParseClassName:l}=t,h=n.length===1,p=n[0],y=n.length,m=a=>{const I=[];let z=0,P=0,k;for(let ae=0;ae<a.length;ae++){let Se=a[ae];if(z===0){if(Se===p&&(h||a.slice(ae,ae+y)===n)){I.push(a.slice(P,ae)),P=ae+y;continue}if(Se==="/"){k=ae;continue}}Se==="["?z++:Se==="]"&&z--}const N=I.length===0?a:a.substring(P),F=N.startsWith(B1),H=F?N.substring(1):N,X=k&&k>P?k-P:void 0;return{modifiers:I,hasImportantModifier:F,baseClassName:H,maybePostfixModifierPosition:X}};return l?a=>l({className:a,parseClassName:m}):m},AP=t=>{if(t.length<=1)return t;const n=[];let l=[];return t.forEach(h=>{h[0]==="["?(n.push(...l.sort(),h),l=[]):l.push(h)}),n.push(...l.sort()),n},kP=t=>({cache:MP(t.cacheSize),parseClassName:PP(t),...TP(t)}),LP=/\s+/,zP=(t,n)=>{const{parseClassName:l,getClassGroupId:h,getConflictingClassGroupIds:p}=n,y=[],m=t.trim().split(LP);let a="";for(let I=m.length-1;I>=0;I-=1){const z=m[I],{modifiers:P,hasImportantModifier:k,baseClassName:N,maybePostfixModifierPosition:F}=l(z);let H=!!F,X=h(H?N.substring(0,F):N);if(!X){if(!H){a=z+(a.length>0?" "+a:a);continue}if(X=h(N),!X){a=z+(a.length>0?" "+a:a);continue}H=!1}const ae=AP(P).join(":"),Se=k?ae+B1:ae,be=Se+X;if(y.includes(be))continue;y.push(be);const Q=p(X,H);for(let re=0;re<Q.length;++re){const J=Q[re];y.push(Se+J)}a=z+(a.length>0?" "+a:a)}return a};function wi(){let t=0,n,l,h="";for(;t<arguments.length;)(n=arguments[t++])&&(l=j1(n))&&(h&&(h+=" "),h+=l);return h}const j1=t=>{if(typeof t=="string")return t;let n,l="";for(let h=0;h<t.length;h++)t[h]&&(n=j1(t[h]))&&(l&&(l+=" "),l+=n);return l};function K0(t,...n){let l,h,p,y=m;function m(I){const z=n.reduce((P,k)=>k(P),t());return l=kP(z),h=l.cache.get,p=l.cache.set,y=a,a(I)}function a(I){const z=h(I);if(z)return z;const P=zP(I,l);return p(I,P),P}return function(){return y(wi.apply(null,arguments))}}const ti=t=>{const n=l=>l[t]||[];return n.isThemeGetter=!0,n},N1=/^\[(?:([a-z-]+):)?(.+)\]$/i,RP=/^\d+\/\d+$/,DP=new Set(["px","full","screen"]),OP=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,FP=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,BP=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,jP=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,NP=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Ss=t=>Uc(t)||DP.has(t)||RP.test(t),ga=t=>tu(t,"length",WP),Uc=t=>!!t&&!Number.isNaN(Number(t)),fg=t=>tu(t,"number",Uc),bh=t=>!!t&&Number.isInteger(Number(t)),VP=t=>t.endsWith("%")&&Uc(t.slice(0,-1)),or=t=>N1.test(t),_a=t=>OP.test(t),$P=new Set(["length","size","percentage"]),UP=t=>tu(t,$P,V1),GP=t=>tu(t,"position",V1),ZP=new Set(["image","url"]),qP=t=>tu(t,ZP,XP),HP=t=>tu(t,"",KP),xh=()=>!0,tu=(t,n,l)=>{const h=N1.exec(t);return h?h[1]?typeof n=="string"?h[1]===n:n.has(h[1]):l(h[2]):!1},WP=t=>FP.test(t)&&!BP.test(t),V1=()=>!1,KP=t=>jP.test(t),XP=t=>NP.test(t),X0=()=>{const t=ti("colors"),n=ti("spacing"),l=ti("blur"),h=ti("brightness"),p=ti("borderColor"),y=ti("borderRadius"),m=ti("borderSpacing"),a=ti("borderWidth"),I=ti("contrast"),z=ti("grayscale"),P=ti("hueRotate"),k=ti("invert"),N=ti("gap"),F=ti("gradientColorStops"),H=ti("gradientColorStopPositions"),X=ti("inset"),ae=ti("margin"),Se=ti("opacity"),be=ti("padding"),Q=ti("saturate"),re=ti("scale"),J=ti("sepia"),le=ti("skew"),Me=ti("space"),Ie=ti("translate"),Be=()=>["auto","contain","none"],Ee=()=>["auto","hidden","clip","visible","scroll"],Re=()=>["auto",or,n],Ae=()=>[or,n],He=()=>["",Ss,ga],it=()=>["auto",Uc,or],vt=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],Xe=()=>["solid","dashed","dotted","double","none"],xt=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],yt=()=>["start","end","center","between","around","evenly","stretch"],Rt=()=>["","0",or],Mr=()=>["auto","avoid","all","avoid-page","page","left","right","column"],_r=()=>[Uc,or];return{cacheSize:500,separator:":",theme:{colors:[xh],spacing:[Ss,ga],blur:["none","",_a,or],brightness:_r(),borderColor:[t],borderRadius:["none","","full",_a,or],borderSpacing:Ae(),borderWidth:He(),contrast:_r(),grayscale:Rt(),hueRotate:_r(),invert:Rt(),gap:Ae(),gradientColorStops:[t],gradientColorStopPositions:[VP,ga],inset:Re(),margin:Re(),opacity:_r(),padding:Ae(),saturate:_r(),scale:_r(),sepia:Rt(),skew:_r(),space:Ae(),translate:Ae()},classGroups:{aspect:[{aspect:["auto","square","video",or]}],container:["container"],columns:[{columns:[_a]}],"break-after":[{"break-after":Mr()}],"break-before":[{"break-before":Mr()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...vt(),or]}],overflow:[{overflow:Ee()}],"overflow-x":[{"overflow-x":Ee()}],"overflow-y":[{"overflow-y":Ee()}],overscroll:[{overscroll:Be()}],"overscroll-x":[{"overscroll-x":Be()}],"overscroll-y":[{"overscroll-y":Be()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[X]}],"inset-x":[{"inset-x":[X]}],"inset-y":[{"inset-y":[X]}],start:[{start:[X]}],end:[{end:[X]}],top:[{top:[X]}],right:[{right:[X]}],bottom:[{bottom:[X]}],left:[{left:[X]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",bh,or]}],basis:[{basis:Re()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",or]}],grow:[{grow:Rt()}],shrink:[{shrink:Rt()}],order:[{order:["first","last","none",bh,or]}],"grid-cols":[{"grid-cols":[xh]}],"col-start-end":[{col:["auto",{span:["full",bh,or]},or]}],"col-start":[{"col-start":it()}],"col-end":[{"col-end":it()}],"grid-rows":[{"grid-rows":[xh]}],"row-start-end":[{row:["auto",{span:[bh,or]},or]}],"row-start":[{"row-start":it()}],"row-end":[{"row-end":it()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",or]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",or]}],gap:[{gap:[N]}],"gap-x":[{"gap-x":[N]}],"gap-y":[{"gap-y":[N]}],"justify-content":[{justify:["normal",...yt()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...yt(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...yt(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[be]}],px:[{px:[be]}],py:[{py:[be]}],ps:[{ps:[be]}],pe:[{pe:[be]}],pt:[{pt:[be]}],pr:[{pr:[be]}],pb:[{pb:[be]}],pl:[{pl:[be]}],m:[{m:[ae]}],mx:[{mx:[ae]}],my:[{my:[ae]}],ms:[{ms:[ae]}],me:[{me:[ae]}],mt:[{mt:[ae]}],mr:[{mr:[ae]}],mb:[{mb:[ae]}],ml:[{ml:[ae]}],"space-x":[{"space-x":[Me]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[Me]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",or,n]}],"min-w":[{"min-w":[or,n,"min","max","fit"]}],"max-w":[{"max-w":[or,n,"none","full","min","max","fit","prose",{screen:[_a]},_a]}],h:[{h:[or,n,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[or,n,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[or,n,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[or,n,"auto","min","max","fit"]}],"font-size":[{text:["base",_a,ga]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",fg]}],"font-family":[{font:[xh]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",or]}],"line-clamp":[{"line-clamp":["none",Uc,fg]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Ss,or]}],"list-image":[{"list-image":["none",or]}],"list-style-type":[{list:["none","disc","decimal",or]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[Se]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[Se]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Xe(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Ss,ga]}],"underline-offset":[{"underline-offset":["auto",Ss,or]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:Ae()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",or]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",or]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[Se]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...vt(),GP]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",UP]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},qP]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[H]}],"gradient-via-pos":[{via:[H]}],"gradient-to-pos":[{to:[H]}],"gradient-from":[{from:[F]}],"gradient-via":[{via:[F]}],"gradient-to":[{to:[F]}],rounded:[{rounded:[y]}],"rounded-s":[{"rounded-s":[y]}],"rounded-e":[{"rounded-e":[y]}],"rounded-t":[{"rounded-t":[y]}],"rounded-r":[{"rounded-r":[y]}],"rounded-b":[{"rounded-b":[y]}],"rounded-l":[{"rounded-l":[y]}],"rounded-ss":[{"rounded-ss":[y]}],"rounded-se":[{"rounded-se":[y]}],"rounded-ee":[{"rounded-ee":[y]}],"rounded-es":[{"rounded-es":[y]}],"rounded-tl":[{"rounded-tl":[y]}],"rounded-tr":[{"rounded-tr":[y]}],"rounded-br":[{"rounded-br":[y]}],"rounded-bl":[{"rounded-bl":[y]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[Se]}],"border-style":[{border:[...Xe(),"hidden"]}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[Se]}],"divide-style":[{divide:Xe()}],"border-color":[{border:[p]}],"border-color-x":[{"border-x":[p]}],"border-color-y":[{"border-y":[p]}],"border-color-s":[{"border-s":[p]}],"border-color-e":[{"border-e":[p]}],"border-color-t":[{"border-t":[p]}],"border-color-r":[{"border-r":[p]}],"border-color-b":[{"border-b":[p]}],"border-color-l":[{"border-l":[p]}],"divide-color":[{divide:[p]}],"outline-style":[{outline:["",...Xe()]}],"outline-offset":[{"outline-offset":[Ss,or]}],"outline-w":[{outline:[Ss,ga]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:He()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[Se]}],"ring-offset-w":[{"ring-offset":[Ss,ga]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",_a,HP]}],"shadow-color":[{shadow:[xh]}],opacity:[{opacity:[Se]}],"mix-blend":[{"mix-blend":[...xt(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":xt()}],filter:[{filter:["","none"]}],blur:[{blur:[l]}],brightness:[{brightness:[h]}],contrast:[{contrast:[I]}],"drop-shadow":[{"drop-shadow":["","none",_a,or]}],grayscale:[{grayscale:[z]}],"hue-rotate":[{"hue-rotate":[P]}],invert:[{invert:[k]}],saturate:[{saturate:[Q]}],sepia:[{sepia:[J]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[l]}],"backdrop-brightness":[{"backdrop-brightness":[h]}],"backdrop-contrast":[{"backdrop-contrast":[I]}],"backdrop-grayscale":[{"backdrop-grayscale":[z]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[P]}],"backdrop-invert":[{"backdrop-invert":[k]}],"backdrop-opacity":[{"backdrop-opacity":[Se]}],"backdrop-saturate":[{"backdrop-saturate":[Q]}],"backdrop-sepia":[{"backdrop-sepia":[J]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[m]}],"border-spacing-x":[{"border-spacing-x":[m]}],"border-spacing-y":[{"border-spacing-y":[m]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",or]}],duration:[{duration:_r()}],ease:[{ease:["linear","in","out","in-out",or]}],delay:[{delay:_r()}],animate:[{animate:["none","spin","ping","pulse","bounce",or]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[re]}],"scale-x":[{"scale-x":[re]}],"scale-y":[{"scale-y":[re]}],rotate:[{rotate:[bh,or]}],"translate-x":[{"translate-x":[Ie]}],"translate-y":[{"translate-y":[Ie]}],"skew-x":[{"skew-x":[le]}],"skew-y":[{"skew-y":[le]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",or]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",or]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":Ae()}],"scroll-mx":[{"scroll-mx":Ae()}],"scroll-my":[{"scroll-my":Ae()}],"scroll-ms":[{"scroll-ms":Ae()}],"scroll-me":[{"scroll-me":Ae()}],"scroll-mt":[{"scroll-mt":Ae()}],"scroll-mr":[{"scroll-mr":Ae()}],"scroll-mb":[{"scroll-mb":Ae()}],"scroll-ml":[{"scroll-ml":Ae()}],"scroll-p":[{"scroll-p":Ae()}],"scroll-px":[{"scroll-px":Ae()}],"scroll-py":[{"scroll-py":Ae()}],"scroll-ps":[{"scroll-ps":Ae()}],"scroll-pe":[{"scroll-pe":Ae()}],"scroll-pt":[{"scroll-pt":Ae()}],"scroll-pr":[{"scroll-pr":Ae()}],"scroll-pb":[{"scroll-pb":Ae()}],"scroll-pl":[{"scroll-pl":Ae()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",or]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[Ss,ga,fg]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},YP=(t,{cacheSize:n,prefix:l,separator:h,experimentalParseClassName:p,extend:y={},override:m={}})=>{Ph(t,"cacheSize",n),Ph(t,"prefix",l),Ph(t,"separator",h),Ph(t,"experimentalParseClassName",p);for(const a in m)JP(t[a],m[a]);for(const a in y)QP(t[a],y[a]);return t},Ph=(t,n,l)=>{l!==void 0&&(t[n]=l)},JP=(t,n)=>{if(n)for(const l in n)Ph(t,l,n[l])},QP=(t,n)=>{if(n)for(const l in n){const h=n[l];h!==void 0&&(t[l]=(t[l]||[]).concat(h))}},eA=(t,...n)=>typeof t=="function"?K0(X0,t,...n):K0(()=>YP(X0(),t),...n);function Ll(){const t=ii();return t._appConfig||(t._appConfig=Co(ci)),t._appConfig}const tA={ui:{primary:"red",gray:"neutral",icons:{dynamic:!0}}},rA={nuxt:{},icon:{provider:"iconify",class:"",aliases:{},iconifyApiEndpoint:"https://api.iconify.design",localApiEndpoint:"/api/_nuxt_icon",fallbackToApi:!0,cssSelectorPrefix:"i-",cssWherePseudo:!0,mode:"css",attrs:{"aria-hidden":!0},collections:["academicons","akar-icons","ant-design","arcticons","basil","bi","bitcoin-icons","bpmn","brandico","bx","bxl","bxs","bytesize","carbon","catppuccin","cbi","charm","ci","cib","cif","cil","circle-flags","circum","clarity","codicon","covid","cryptocurrency","cryptocurrency-color","dashicons","devicon","devicon-plain","ei","el","emojione","emojione-monotone","emojione-v1","entypo","entypo-social","eos-icons","ep","et","eva","f7","fa","fa-brands","fa-regular","fa-solid","fa6-brands","fa6-regular","fa6-solid","fad","fe","feather","file-icons","flag","flagpack","flat-color-icons","flat-ui","flowbite","fluent","fluent-emoji","fluent-emoji-flat","fluent-emoji-high-contrast","fluent-mdl2","fontelico","fontisto","formkit","foundation","fxemoji","gala","game-icons","geo","gg","gis","gravity-ui","gridicons","grommet-icons","guidance","healthicons","heroicons","heroicons-outline","heroicons-solid","hugeicons","humbleicons","ic","icomoon-free","icon-park","icon-park-outline","icon-park-solid","icon-park-twotone","iconamoon","iconoir","icons8","il","ion","iwwa","jam","la","lets-icons","line-md","logos","ls","lucide","lucide-lab","mage","majesticons","maki","map","marketeq","material-symbols","material-symbols-light","mdi","mdi-light","medical-icon","memory","meteocons","mi","mingcute","mono-icons","mynaui","nimbus","nonicons","noto","noto-v1","octicon","oi","ooui","openmoji","oui","pajamas","pepicons","pepicons-pencil","pepicons-pop","pepicons-print","ph","pixelarticons","prime","ps","quill","radix-icons","raphael","ri","rivet-icons","si-glyph","simple-icons","simple-line-icons","skill-icons","solar","streamline","streamline-emojis","subway","svg-spinners","system-uicons","tabler","tdesign","teenyicons","token","token-branded","topcoat","twemoji","typcn","uil","uim","uis","uit","uiw","unjs","vaadin","vs","vscode-icons","websymbol","weui","whh","wi","wpf","zmdi","zondicons"],fetchTimeout:1500},ui:{primary:"green",gray:"cool",colors:["red","orange","amber","yellow","lime","green","emerald","teal","cyan","sky","blue","indigo","violet","purple","fuchsia","pink","rose","primary"],strategy:"merge"}},ci=KI(tA,rA);function iA(t,n){const l={...t};for(const h of n)delete l[h];return l}function Hh(t,n,l){typeof n=="string"&&(n=n.split(".").map(p=>{const y=Number(p);return Number.isNaN(y)?p:y}));let h=t;for(const p of n){if(h==null)return l;h=h[p]}return h!==void 0?h:l}const j_={to:{type:[String,Object],default:void 0,required:!1},href:{type:[String,Object],default:void 0,required:!1},target:{type:String,default:void 0,required:!1},rel:{type:String,default:void 0,required:!1},noRel:{type:Boolean,default:void 0,required:!1},prefetch:{type:Boolean,default:void 0,required:!1},noPrefetch:{type:Boolean,default:void 0,required:!1},activeClass:{type:String,default:void 0,required:!1},exactActiveClass:{type:String,default:void 0,required:!1},prefetchedClass:{type:String,default:void 0,required:!1},replace:{type:Boolean,default:void 0,required:!1},ariaCurrentValue:{type:String,default:void 0,required:!1},external:{type:Boolean,default:void 0,required:!1}},nA=t=>Object.keys(j_).reduce((l,h)=>(t[h]!==void 0&&(l[h]=t[h]),l),{});var Fb;const Il=eA(rd({extend:{classGroups:{icons:[t=>t.startsWith("i-")]}}},(Fb=ci.ui)==null?void 0:Fb.tailwindMerge)),oA=k_((t,n,l,h)=>{if(h==="default"||h.startsWith("default.")||h==="popper"||h.startsWith("popper.")||h.endsWith("avatar")&&n==="size"||h.endsWith("chip")&&n==="size"||h.endsWith("badge")&&n==="size"||n==="color"||n==="variant")return!1;if(typeof t[n]=="string"&&typeof l=="string"&&t[n]&&l)return t[n]=Il(t[n],l),!0});function zl(t,...n){return t==="override"?rd({},...n):oA({},...n)}const $1=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i;function Y0(t){return $1.test(t)?sA(t):t}function sA(t){const n=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;t=t.replace(n,function(h,p,y,m){return p+p+y+y+m+m});const l=$1.exec(t);return l?`${Number.parseInt(l[1],16)} ${Number.parseInt(l[2],16)} ${Number.parseInt(l[3],16)}`:null}function aA(t){const n=Number.parseFloat(t);return Number.isNaN(n)?t:n}const lA="inherit",cA="currentColor",uA="transparent",hA="#000",dA="#fff",fA={50:"#f8fafc",100:"#f1f5f9",200:"#e2e8f0",300:"#cbd5e1",400:"#94a3b8",500:"#64748b",600:"#475569",700:"#334155",800:"#1e293b",900:"#0f172a",950:"#020617"},pA={50:"rgb(var(--color-gray-50) / <alpha-value>)",100:"rgb(var(--color-gray-100) / <alpha-value>)",200:"rgb(var(--color-gray-200) / <alpha-value>)",300:"rgb(var(--color-gray-300) / <alpha-value>)",400:"rgb(var(--color-gray-400) / <alpha-value>)",500:"rgb(var(--color-gray-500) / <alpha-value>)",600:"rgb(var(--color-gray-600) / <alpha-value>)",700:"rgb(var(--color-gray-700) / <alpha-value>)",800:"rgb(var(--color-gray-800) / <alpha-value>)",900:"rgb(var(--color-gray-900) / <alpha-value>)",950:"rgb(var(--color-gray-950) / <alpha-value>)"},mA={50:"#fafafa",100:"#f4f4f5",200:"#e4e4e7",300:"#d4d4d8",400:"#a1a1aa",500:"#71717a",600:"#52525b",700:"#3f3f46",800:"#27272a",900:"#18181b",950:"#09090b"},gA={50:"#fafafa",100:"#f5f5f5",200:"#e5e5e5",300:"#d4d4d4",400:"#a3a3a3",500:"#737373",600:"#525252",700:"#404040",800:"#262626",900:"#171717",950:"#0a0a0a"},_A={50:"#fafaf9",100:"#f5f5f4",200:"#e7e5e4",300:"#d6d3d1",400:"#a8a29e",500:"#78716c",600:"#57534e",700:"#44403c",800:"#292524",900:"#1c1917",950:"#0c0a09"},yA={50:"#fef2f2",100:"#fee2e2",200:"#fecaca",300:"#fca5a5",400:"#f87171",500:"#ef4444",600:"#dc2626",700:"#b91c1c",800:"#991b1b",900:"#7f1d1d",950:"#450a0a"},vA={50:"#fff7ed",100:"#ffedd5",200:"#fed7aa",300:"#fdba74",400:"#fb923c",500:"#f97316",600:"#ea580c",700:"#c2410c",800:"#9a3412",900:"#7c2d12",950:"#431407"},bA={50:"#fffbeb",100:"#fef3c7",200:"#fde68a",300:"#fcd34d",400:"#fbbf24",500:"#f59e0b",600:"#d97706",700:"#b45309",800:"#92400e",900:"#78350f",950:"#451a03"},xA={50:"#fefce8",100:"#fef9c3",200:"#fef08a",300:"#fde047",400:"#facc15",500:"#eab308",600:"#ca8a04",700:"#a16207",800:"#854d0e",900:"#713f12",950:"#422006"},wA={50:"#f7fee7",100:"#ecfccb",200:"#d9f99d",300:"#bef264",400:"#a3e635",500:"#84cc16",600:"#65a30d",700:"#4d7c0f",800:"#3f6212",900:"#365314",950:"#1a2e05"},TA={50:"#f0fdf4",100:"#dcfce7",200:"#bbf7d0",300:"#86efac",400:"#4ade80",500:"#22c55e",600:"#16a34a",700:"#15803d",800:"#166534",900:"#14532d",950:"#052e16"},SA={50:"#ecfdf5",100:"#d1fae5",200:"#a7f3d0",300:"#6ee7b7",400:"#34d399",500:"#10b981",600:"#059669",700:"#047857",800:"#065f46",900:"#064e3b",950:"#022c22"},EA={50:"#f0fdfa",100:"#ccfbf1",200:"#99f6e4",300:"#5eead4",400:"#2dd4bf",500:"#14b8a6",600:"#0d9488",700:"#0f766e",800:"#115e59",900:"#134e4a",950:"#042f2e"},CA={50:"#ecfeff",100:"#cffafe",200:"#a5f3fc",300:"#67e8f9",400:"#22d3ee",500:"#06b6d4",600:"#0891b2",700:"#0e7490",800:"#155e75",900:"#164e63",950:"#083344"},IA={50:"#f0f9ff",100:"#e0f2fe",200:"#bae6fd",300:"#7dd3fc",400:"#38bdf8",500:"#0ea5e9",600:"#0284c7",700:"#0369a1",800:"#075985",900:"#0c4a6e",950:"#082f49"},MA={50:"#eff6ff",100:"#dbeafe",200:"#bfdbfe",300:"#93c5fd",400:"#60a5fa",500:"#3b82f6",600:"#2563eb",700:"#1d4ed8",800:"#1e40af",900:"#1e3a8a",950:"#172554"},PA={50:"#eef2ff",100:"#e0e7ff",200:"#c7d2fe",300:"#a5b4fc",400:"#818cf8",500:"#6366f1",600:"#4f46e5",700:"#4338ca",800:"#3730a3",900:"#312e81",950:"#1e1b4b"},AA={50:"#f5f3ff",100:"#ede9fe",200:"#ddd6fe",300:"#c4b5fd",400:"#a78bfa",500:"#8b5cf6",600:"#7c3aed",700:"#6d28d9",800:"#5b21b6",900:"#4c1d95",950:"#2e1065"},kA={50:"#faf5ff",100:"#f3e8ff",200:"#e9d5ff",300:"#d8b4fe",400:"#c084fc",500:"#a855f7",600:"#9333ea",700:"#7e22ce",800:"#6b21a8",900:"#581c87",950:"#3b0764"},LA={50:"#fdf4ff",100:"#fae8ff",200:"#f5d0fe",300:"#f0abfc",400:"#e879f9",500:"#d946ef",600:"#c026d3",700:"#a21caf",800:"#86198f",900:"#701a75",950:"#4a044e"},zA={50:"#fdf2f8",100:"#fce7f3",200:"#fbcfe8",300:"#f9a8d4",400:"#f472b6",500:"#ec4899",600:"#db2777",700:"#be185d",800:"#9d174d",900:"#831843",950:"#500724"},RA={50:"#fff1f2",100:"#ffe4e6",200:"#fecdd3",300:"#fda4af",400:"#fb7185",500:"#f43f5e",600:"#e11d48",700:"#be123c",800:"#9f1239",900:"#881337",950:"#4c0519"},DA={50:"rgb(var(--color-primary-50) / <alpha-value>)",100:"rgb(var(--color-primary-100) / <alpha-value>)",200:"rgb(var(--color-primary-200) / <alpha-value>)",300:"rgb(var(--color-primary-300) / <alpha-value>)",400:"rgb(var(--color-primary-400) / <alpha-value>)",500:"rgb(var(--color-primary-500) / <alpha-value>)",600:"rgb(var(--color-primary-600) / <alpha-value>)",700:"rgb(var(--color-primary-700) / <alpha-value>)",800:"rgb(var(--color-primary-800) / <alpha-value>)",900:"rgb(var(--color-primary-900) / <alpha-value>)",950:"rgb(var(--color-primary-950) / <alpha-value>)",DEFAULT:"rgb(var(--color-primary-DEFAULT) / <alpha-value>)"},OA={50:"#f9fafb",100:"#f3f4f6",200:"#e5e7eb",300:"#d1d5db",400:"#9ca3af",500:"#6b7280",600:"#4b5563",700:"#374151",800:"#1f2937",900:"#111827",950:"#030712"},Df={inherit:lA,current:cA,transparent:uA,black:hA,white:dA,slate:fA,gray:pA,zinc:mA,neutral:gA,stone:_A,red:yA,orange:vA,amber:bA,yellow:xA,lime:wA,green:TA,emerald:SA,teal:EA,cyan:CA,sky:IA,blue:MA,indigo:PA,violet:AA,purple:kA,fuchsia:LA,pink:zA,rose:RA,primary:DA,cool:OA},FA=qn(()=>{const t=Ll(),n=ii(),l=Ye(()=>{const p=Hh(Df,t.ui.primary),y=Hh(Df,t.ui.gray);return p||console.warn(`[@nuxt/ui] Primary color '${t.ui.primary}' not found in Tailwind config`),y||console.warn(`[@nuxt/ui] Gray color '${t.ui.gray}' not found in Tailwind config`),`:root {
${Object.entries(p||Df.green).map(([m,a])=>`--color-primary-${m}: ${Y0(a)};`).join(`
`)}
--color-primary-DEFAULT: var(--color-primary-500);

${Object.entries(y||Df.cool).map(([m,a])=>`--color-gray-${m}: ${Y0(a)};`).join(`
`)}
}

.dark {
  --color-primary-DEFAULT: var(--color-primary-400);
}
`}),h={style:[{innerHTML:()=>l.value,tagPriority:-2,id:"nuxt-ui-colors"}]};if(n.isHydrating&&!n.payload.serverRendered){const p=document.createElement("style");p.innerHTML=l.value,p.setAttribute("data-nuxt-ui-colors",""),document.head.appendChild(p),h.script=[{innerHTML:"document.head.removeChild(document.querySelector('[data-nuxt-ui-colors]'))"}]}UM(h)}),BA="__NUXT_COLOR_MODE__",pg="nuxt-color-mode",jA="localStorage",NA="$s";function U1(...t){const n=typeof t[t.length-1]=="string"?t.pop():void 0;typeof t[0]!="string"&&t.unshift(n);const[l,h]=t;if(!l||typeof l!="string")throw new TypeError("[nuxt] [useState] key must be a string: "+l);if(h!==void 0&&typeof h!="function")throw new Error("[nuxt] [useState] init must be a function: "+h);const p=NA+l,y=ii(),m=Ko(y.payload.state,p);if(m.value===void 0&&h){const a=h();if(li(a))return y.payload.state[p]=a,a;m.value=a}return m}const Es=window[BA]||{},VA=qn(t=>{const n=U1("color-mode",()=>Co({preference:Es.preference,value:Es.value,unknown:!1,forced:!1})).value;co().afterEach(y=>{const m=y.meta.colorMode;m&&m!=="system"?(n.value=m,n.forced=!0):(m==="system"&&console.warn("You cannot force the colorMode to system at the page level."),n.forced=!1,n.value=n.preference==="system"?Es.getColorScheme():n.preference)});let l;function h(){l||!window.matchMedia||(l=window.matchMedia("(prefers-color-scheme: dark)"),l.addEventListener("change",()=>{!n.forced&&n.preference==="system"&&(n.value=Es.getColorScheme())}))}function p(y,m){var a,I;switch(y){case"cookie":window.document.cookie=pg+"="+m;break;case"sessionStorage":(a=window.sessionStorage)==null||a.setItem(pg,m);break;case"localStorage":default:(I=window.localStorage)==null||I.setItem(pg,m)}}Li(()=>n.preference,y=>{n.forced||(y==="system"?(n.value=Es.getColorScheme(),h()):n.value=y,p(jA,y))},{immediate:!0}),Li(()=>n.value,(y,m)=>{Es.removeColorScheme(m),Es.addColorScheme(y)}),n.preference==="system"&&h(),t.hook("app:mounted",()=>{n.unknown&&(n.preference=Es.preference,n.value=Es.value,n.unknown=!1)}),t.provide("colorMode",n)}),G1=/^[a-z0-9]+(-[a-z0-9]+)*$/,id=(t,n,l,h="")=>{const p=t.split(":");if(t.slice(0,1)==="@"){if(p.length<2||p.length>3)return null;h=p.shift().slice(1)}if(p.length>3||!p.length)return null;if(p.length>1){const a=p.pop(),I=p.pop(),z={provider:p.length>0?p[0]:h,prefix:I,name:a};return n&&!Uf(z)?null:z}const y=p[0],m=y.split("-");if(m.length>1){const a={provider:h,prefix:m.shift(),name:m.join("-")};return n&&!Uf(a)?null:a}if(l&&h===""){const a={provider:h,prefix:"",name:y};return n&&!Uf(a,l)?null:a}return null},Uf=(t,n)=>t?!!((n&&t.prefix===""||t.prefix)&&t.name):!1,Z1=Object.freeze({left:0,top:0,width:16,height:16}),up=Object.freeze({rotate:0,vFlip:!1,hFlip:!1}),ru=Object.freeze({...Z1,...up}),e_=Object.freeze({...ru,body:"",hidden:!1});function $A(t,n){const l={};!t.hFlip!=!n.hFlip&&(l.hFlip=!0),!t.vFlip!=!n.vFlip&&(l.vFlip=!0);const h=((t.rotate||0)+(n.rotate||0))%4;return h&&(l.rotate=h),l}function J0(t,n){const l=$A(t,n);for(const h in e_)h in up?h in t&&!(h in l)&&(l[h]=up[h]):h in n?l[h]=n[h]:h in t&&(l[h]=t[h]);return l}function UA(t,n){const l=t.icons,h=t.aliases||Object.create(null),p=Object.create(null);function y(m){if(l[m])return p[m]=[];if(!(m in p)){p[m]=null;const a=h[m]&&h[m].parent,I=a&&y(a);I&&(p[m]=[a].concat(I))}return p[m]}return Object.keys(l).concat(Object.keys(h)).forEach(y),p}function GA(t,n,l){const h=t.icons,p=t.aliases||Object.create(null);let y={};function m(a){y=J0(h[a]||p[a],y)}return m(n),l.forEach(m),J0(t,y)}function q1(t,n){const l=[];if(typeof t!="object"||typeof t.icons!="object")return l;t.not_found instanceof Array&&t.not_found.forEach(p=>{n(p,null),l.push(p)});const h=UA(t);for(const p in h){const y=h[p];y&&(n(p,GA(t,p,y)),l.push(p))}return l}const ZA={provider:"",aliases:{},not_found:{},...Z1};function mg(t,n){for(const l in n)if(l in t&&typeof t[l]!=typeof n[l])return!1;return!0}function H1(t){if(typeof t!="object"||t===null)return null;const n=t;if(typeof n.prefix!="string"||!t.icons||typeof t.icons!="object"||!mg(t,ZA))return null;const l=n.icons;for(const p in l){const y=l[p];if(!p||typeof y.body!="string"||!mg(y,e_))return null}const h=n.aliases||Object.create(null);for(const p in h){const y=h[p],m=y.parent;if(!p||typeof m!="string"||!l[m]&&!h[m]||!mg(y,e_))return null}return n}const Q0=Object.create(null);function qA(t,n){return{provider:t,prefix:n,icons:Object.create(null),missing:new Set}}function Ml(t,n){const l=Q0[t]||(Q0[t]=Object.create(null));return l[n]||(l[n]=qA(t,n))}function W1(t,n){return H1(n)?q1(n,(l,h)=>{h?t.icons[l]=h:t.missing.add(l)}):[]}function HA(t,n,l){try{if(typeof l.body=="string")return t.icons[n]={...l},!0}catch{}return!1}let Wh=!1;function K1(t){return typeof t=="boolean"&&(Wh=t),Wh}function N_(t){const n=typeof t=="string"?id(t,!0,Wh):t;if(n){const l=Ml(n.provider,n.prefix),h=n.name;return l.icons[h]||(l.missing.has(h)?null:void 0)}}function V_(t,n){const l=id(t,!0,Wh);if(!l)return!1;const h=Ml(l.provider,l.prefix);return n?HA(h,l.name,n):(h.missing.add(l.name),!0)}function WA(t,n){if(typeof t!="object")return!1;if(typeof n!="string"&&(n=t.provider||""),Wh&&!n&&!t.prefix){let p=!1;return H1(t)&&(t.prefix="",q1(t,(y,m)=>{V_(y,m)&&(p=!0)})),p}const l=t.prefix;if(!Uf({prefix:l,name:"a"}))return!1;const h=Ml(n,l);return!!W1(h,t)}function t_(t){const n=N_(t);return n&&{...ru,...n}}const X1=Object.freeze({width:null,height:null}),Y1=Object.freeze({...X1,...up}),KA=/(-?[0-9.]*[0-9]+[0-9.]*)/g,XA=/^-?[0-9.]*[0-9]+[0-9.]*$/g;function eb(t,n,l){if(n===1)return t;if(l=l||100,typeof t=="number")return Math.ceil(t*n*l)/l;if(typeof t!="string")return t;const h=t.split(KA);if(h===null||!h.length)return t;const p=[];let y=h.shift(),m=XA.test(y);for(;;){if(m){const a=parseFloat(y);isNaN(a)?p.push(y):p.push(Math.ceil(a*n*l)/l)}else p.push(y);if(y=h.shift(),y===void 0)return p.join("");m=!m}}function YA(t,n="defs"){let l="";const h=t.indexOf("<"+n);for(;h>=0;){const p=t.indexOf(">",h),y=t.indexOf("</"+n);if(p===-1||y===-1)break;const m=t.indexOf(">",y);if(m===-1)break;l+=t.slice(p+1,y).trim(),t=t.slice(0,h).trim()+t.slice(m+1)}return{defs:l,content:t}}function JA(t,n){return t?"<defs>"+t+"</defs>"+n:n}function QA(t,n,l){const h=YA(t);return JA(h.defs,n+h.content+l)}const ek=t=>t==="unset"||t==="undefined"||t==="none";function tk(t,n){const l={...ru,...t},h={...Y1,...n},p={left:l.left,top:l.top,width:l.width,height:l.height};let y=l.body;[l,h].forEach(X=>{const ae=[],Se=X.hFlip,be=X.vFlip;let Q=X.rotate;Se?be?Q+=2:(ae.push("translate("+(p.width+p.left).toString()+" "+(0-p.top).toString()+")"),ae.push("scale(-1 1)"),p.top=p.left=0):be&&(ae.push("translate("+(0-p.left).toString()+" "+(p.height+p.top).toString()+")"),ae.push("scale(1 -1)"),p.top=p.left=0);let re;switch(Q<0&&(Q-=Math.floor(Q/4)*4),Q=Q%4,Q){case 1:re=p.height/2+p.top,ae.unshift("rotate(90 "+re.toString()+" "+re.toString()+")");break;case 2:ae.unshift("rotate(180 "+(p.width/2+p.left).toString()+" "+(p.height/2+p.top).toString()+")");break;case 3:re=p.width/2+p.left,ae.unshift("rotate(-90 "+re.toString()+" "+re.toString()+")");break}Q%2===1&&(p.left!==p.top&&(re=p.left,p.left=p.top,p.top=re),p.width!==p.height&&(re=p.width,p.width=p.height,p.height=re)),ae.length&&(y=QA(y,'<g transform="'+ae.join(" ")+'">',"</g>"))});const m=h.width,a=h.height,I=p.width,z=p.height;let P,k;m===null?(k=a===null?"1em":a==="auto"?z:a,P=eb(k,I/z)):(P=m==="auto"?I:m,k=a===null?eb(P,z/I):a==="auto"?z:a);const N={},F=(X,ae)=>{ek(ae)||(N[X]=ae.toString())};F("width",P),F("height",k);const H=[p.left,p.top,I,z];return N.viewBox=H.join(" "),{attributes:N,viewBox:H,body:y}}const rk=/\sid="(\S+)"/g,ik="IconifyId"+Date.now().toString(16)+(Math.random()*16777216|0).toString(16);let nk=0;function ok(t,n=ik){const l=[];let h;for(;h=rk.exec(t);)l.push(h[1]);if(!l.length)return t;const p="suffix"+(Math.random()*16777216|Date.now()).toString(16);return l.forEach(y=>{const m=typeof n=="function"?n(y):n+(nk++).toString(),a=y.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");t=t.replace(new RegExp('([#;"])('+a+')([")]|\\.[a-z])',"g"),"$1"+m+p+"$3")}),t=t.replace(new RegExp(p,"g"),""),t}const r_=Object.create(null);function J1(t,n){r_[t]=n}function i_(t){return r_[t]||r_[""]}function $_(t){let n;if(typeof t.resources=="string")n=[t.resources];else if(n=t.resources,!(n instanceof Array)||!n.length)return null;return{resources:n,path:t.path||"/",maxURL:t.maxURL||500,rotate:t.rotate||750,timeout:t.timeout||5e3,random:t.random===!0,index:t.index||0,dataAfterTimeout:t.dataAfterTimeout!==!1}}const Ap=Object.create(null),wh=["https://api.simplesvg.com","https://api.unisvg.com"],Gf=[];for(;wh.length>0;)wh.length===1||Math.random()>.5?Gf.push(wh.shift()):Gf.push(wh.pop());Ap[""]=$_({resources:["https://api.iconify.design"].concat(Gf)});function Q1(t,n){const l=$_(n);return l===null?!1:(Ap[t]=l,!0)}function kp(t){return Ap[t]}function sk(){return Object.keys(Ap)}const ak=()=>{let t;try{if(t=fetch,typeof t=="function")return t}catch{}};let hp=ak();function lk(t){hp=t}function ck(){return hp}function uk(t,n){const l=kp(t);if(!l)return 0;let h;if(!l.maxURL)h=0;else{let p=0;l.resources.forEach(m=>{p=Math.max(p,m.length)});const y=n+".json?icons=";h=l.maxURL-p-l.path.length-y.length}return h}function hk(t){return t===404}const dk=(t,n,l)=>{const h=[],p=uk(t,n),y="icons";let m={type:y,provider:t,prefix:n,icons:[]},a=0;return l.forEach((I,z)=>{a+=I.length+1,a>=p&&z>0&&(h.push(m),m={type:y,provider:t,prefix:n,icons:[]},a=I.length),m.icons.push(I)}),h.push(m),h};function fk(t){if(typeof t=="string"){const n=kp(t);if(n)return n.path}return"/"}const pk=(t,n,l)=>{if(!hp){l("abort",424);return}let h=fk(n.provider);switch(n.type){case"icons":{const y=n.prefix,a=n.icons.join(","),I=new URLSearchParams({icons:a});h+=y+".json?"+I.toString();break}case"custom":{const y=n.uri;h+=y.slice(0,1)==="/"?y.slice(1):y;break}default:l("abort",400);return}let p=503;hp(t+h).then(y=>{const m=y.status;if(m!==200){setTimeout(()=>{l(hk(m)?"abort":"next",m)});return}return p=501,y.json()}).then(y=>{if(typeof y!="object"||y===null){setTimeout(()=>{y===404?l("abort",y):l("next",p)});return}setTimeout(()=>{l("success",y)})}).catch(()=>{l("next",p)})},mk={prepare:dk,send:pk};function gk(t){const n={loaded:[],missing:[],pending:[]},l=Object.create(null);t.sort((p,y)=>p.provider!==y.provider?p.provider.localeCompare(y.provider):p.prefix!==y.prefix?p.prefix.localeCompare(y.prefix):p.name.localeCompare(y.name));let h={provider:"",prefix:"",name:""};return t.forEach(p=>{if(h.name===p.name&&h.prefix===p.prefix&&h.provider===p.provider)return;h=p;const y=p.provider,m=p.prefix,a=p.name,I=l[y]||(l[y]=Object.create(null)),z=I[m]||(I[m]=Ml(y,m));let P;a in z.icons?P=n.loaded:m===""||z.missing.has(a)?P=n.missing:P=n.pending;const k={provider:y,prefix:m,name:a};P.push(k)}),n}function ew(t,n){t.forEach(l=>{const h=l.loaderCallbacks;h&&(l.loaderCallbacks=h.filter(p=>p.id!==n))})}function _k(t){t.pendingCallbacksFlag||(t.pendingCallbacksFlag=!0,setTimeout(()=>{t.pendingCallbacksFlag=!1;const n=t.loaderCallbacks?t.loaderCallbacks.slice(0):[];if(!n.length)return;let l=!1;const h=t.provider,p=t.prefix;n.forEach(y=>{const m=y.icons,a=m.pending.length;m.pending=m.pending.filter(I=>{if(I.prefix!==p)return!0;const z=I.name;if(t.icons[z])m.loaded.push({provider:h,prefix:p,name:z});else if(t.missing.has(z))m.missing.push({provider:h,prefix:p,name:z});else return l=!0,!0;return!1}),m.pending.length!==a&&(l||ew([t],y.id),y.callback(m.loaded.slice(0),m.missing.slice(0),m.pending.slice(0),y.abort))})}))}let yk=0;function vk(t,n,l){const h=yk++,p=ew.bind(null,l,h);if(!n.pending.length)return p;const y={id:h,icons:n,callback:t,abort:p};return l.forEach(m=>{(m.loaderCallbacks||(m.loaderCallbacks=[])).push(y)}),p}function bk(t,n=!0,l=!1){const h=[];return t.forEach(p=>{const y=typeof p=="string"?id(p,n,l):p;y&&h.push(y)}),h}var xk={resources:[],index:0,timeout:2e3,rotate:750,random:!1,dataAfterTimeout:!1};function wk(t,n,l,h){const p=t.resources.length,y=t.random?Math.floor(Math.random()*p):t.index;let m;if(t.random){let le=t.resources.slice(0);for(m=[];le.length>1;){const Me=Math.floor(Math.random()*le.length);m.push(le[Me]),le=le.slice(0,Me).concat(le.slice(Me+1))}m=m.concat(le)}else m=t.resources.slice(y).concat(t.resources.slice(0,y));const a=Date.now();let I="pending",z=0,P,k=null,N=[],F=[];typeof h=="function"&&F.push(h);function H(){k&&(clearTimeout(k),k=null)}function X(){I==="pending"&&(I="aborted"),H(),N.forEach(le=>{le.status==="pending"&&(le.status="aborted")}),N=[]}function ae(le,Me){Me&&(F=[]),typeof le=="function"&&F.push(le)}function Se(){return{startTime:a,payload:n,status:I,queriesSent:z,queriesPending:N.length,subscribe:ae,abort:X}}function be(){I="failed",F.forEach(le=>{le(void 0,P)})}function Q(){N.forEach(le=>{le.status==="pending"&&(le.status="aborted")}),N=[]}function re(le,Me,Ie){const Be=Me!=="success";switch(N=N.filter(Ee=>Ee!==le),I){case"pending":break;case"failed":if(Be||!t.dataAfterTimeout)return;break;default:return}if(Me==="abort"){P=Ie,be();return}if(Be){P=Ie,N.length||(m.length?J():be());return}if(H(),Q(),!t.random){const Ee=t.resources.indexOf(le.resource);Ee!==-1&&Ee!==t.index&&(t.index=Ee)}I="completed",F.forEach(Ee=>{Ee(Ie)})}function J(){if(I!=="pending")return;H();const le=m.shift();if(le===void 0){if(N.length){k=setTimeout(()=>{H(),I==="pending"&&(Q(),be())},t.timeout);return}be();return}const Me={status:"pending",resource:le,callback:(Ie,Be)=>{re(Me,Ie,Be)}};N.push(Me),z++,k=setTimeout(J,t.rotate),l(le,n,Me.callback)}return setTimeout(J),Se}function tw(t){const n={...xk,...t};let l=[];function h(){l=l.filter(a=>a().status==="pending")}function p(a,I,z){const P=wk(n,a,I,(k,N)=>{h(),z&&z(k,N)});return l.push(P),P}function y(a){return l.find(I=>a(I))||null}return{query:p,find:y,setIndex:a=>{n.index=a},getIndex:()=>n.index,cleanup:h}}function tb(){}const gg=Object.create(null);function Tk(t){if(!gg[t]){const n=kp(t);if(!n)return;const l=tw(n),h={config:n,redundancy:l};gg[t]=h}return gg[t]}function rw(t,n,l){let h,p;if(typeof t=="string"){const y=i_(t);if(!y)return l(void 0,424),tb;p=y.send;const m=Tk(t);m&&(h=m.redundancy)}else{const y=$_(t);if(y){h=tw(y);const m=t.resources?t.resources[0]:"",a=i_(m);a&&(p=a.send)}}return!h||!p?(l(void 0,424),tb):h.query(n,p,l)().abort}function rb(){}function Sk(t){t.iconsLoaderFlag||(t.iconsLoaderFlag=!0,setTimeout(()=>{t.iconsLoaderFlag=!1,_k(t)}))}function Ek(t){const n=[],l=[];return t.forEach(h=>{(h.match(G1)?n:l).push(h)}),{valid:n,invalid:l}}function Th(t,n,l){function h(){const p=t.pendingIcons;n.forEach(y=>{p&&p.delete(y),t.icons[y]||t.missing.add(y)})}if(l&&typeof l=="object")try{if(!W1(t,l).length){h();return}}catch(p){console.error(p)}h(),Sk(t)}function ib(t,n){t instanceof Promise?t.then(l=>{n(l)}).catch(()=>{n(null)}):n(t)}function Ck(t,n){t.iconsToLoad?t.iconsToLoad=t.iconsToLoad.concat(n).sort():t.iconsToLoad=n,t.iconsQueueFlag||(t.iconsQueueFlag=!0,setTimeout(()=>{t.iconsQueueFlag=!1;const{provider:l,prefix:h}=t,p=t.iconsToLoad;if(delete t.iconsToLoad,!p||!p.length)return;const y=t.loadIcon;if(t.loadIcons&&(p.length>1||!y)){ib(t.loadIcons(p,h,l),P=>{Th(t,p,P)});return}if(y){p.forEach(P=>{const k=y(P,h,l);ib(k,N=>{const F=N?{prefix:h,icons:{[P]:N}}:null;Th(t,[P],F)})});return}const{valid:m,invalid:a}=Ek(p);if(a.length&&Th(t,a,null),!m.length)return;const I=h.match(G1)?i_(l):null;if(!I){Th(t,m,null);return}I.prepare(l,h,m).forEach(P=>{rw(l,P,k=>{Th(t,P.icons,k)})})}))}const iw=(t,n)=>{const l=bk(t,!0,K1()),h=gk(l);if(!h.pending.length){let I=!0;return n&&setTimeout(()=>{I&&n(h.loaded,h.missing,h.pending,rb)}),()=>{I=!1}}const p=Object.create(null),y=[];let m,a;return h.pending.forEach(I=>{const{provider:z,prefix:P}=I;if(P===a&&z===m)return;m=z,a=P,y.push(Ml(z,P));const k=p[z]||(p[z]=Object.create(null));k[P]||(k[P]=[])}),h.pending.forEach(I=>{const{provider:z,prefix:P,name:k}=I,N=Ml(z,P),F=N.pendingIcons||(N.pendingIcons=new Set);F.has(k)||(F.add(k),p[z][P].push(k))}),y.forEach(I=>{const z=p[I.provider][I.prefix];z.length&&Ck(I,z)}),n?vk(n,h,y):rb},Ik=t=>new Promise((n,l)=>{const h=typeof t=="string"?id(t,!0):t;if(!h){l(t);return}iw([h||t],p=>{if(p.length&&h){const y=N_(h);if(y){n({...ru,...y});return}}l(t)})});function Mk(t,n,l){Ml("",n).loadIcons=t}function Pk(t,n){const l={...t};for(const h in n){const p=n[h],y=typeof p;h in X1?(p===null||p&&(y==="string"||y==="number"))&&(l[h]=p):y===typeof l[h]&&(l[h]=h==="rotate"?p%4:p)}return l}const Ak=/[\s,]+/;function kk(t,n){n.split(Ak).forEach(l=>{switch(l.trim()){case"horizontal":t.hFlip=!0;break;case"vertical":t.vFlip=!0;break}})}function Lk(t,n=0){const l=t.replace(/^-?[0-9.]*/,"");function h(p){for(;p<0;)p+=4;return p%4}if(l===""){const p=parseInt(t);return isNaN(p)?0:h(p)}else if(l!==t){let p=0;switch(l){case"%":p=25;break;case"deg":p=90}if(p){let y=parseFloat(t.slice(0,t.length-l.length));return isNaN(y)?0:(y=y/p,y%1===0?h(y):0)}}return n}function zk(t,n){let l=t.indexOf("xlink:")===-1?"":' xmlns:xlink="http://www.w3.org/1999/xlink"';for(const h in n)l+=" "+h+'="'+n[h]+'"';return'<svg xmlns="http://www.w3.org/2000/svg"'+l+">"+t+"</svg>"}function Rk(t){return t.replace(/"/g,"'").replace(/%/g,"%25").replace(/#/g,"%23").replace(/</g,"%3C").replace(/>/g,"%3E").replace(/\s+/g," ")}function Dk(t){return"data:image/svg+xml,"+Rk(t)}function Ok(t){return'url("'+Dk(t)+'")'}const nb={...Y1,inline:!1},Fk={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":!0,role:"img"},Bk={display:"inline-block"},n_={backgroundColor:"currentColor"},nw={backgroundColor:"transparent"},ob={Image:"var(--svg)",Repeat:"no-repeat",Size:"100% 100%"},sb={webkitMask:n_,mask:n_,background:nw};for(const t in sb){const n=sb[t];for(const l in ob)n[t+l]=ob[l]}const Zf={};["horizontal","vertical"].forEach(t=>{const n=t.slice(0,1)+"Flip";Zf[t+"-flip"]=n,Zf[t.slice(0,1)+"-flip"]=n,Zf[t+"Flip"]=n});function ab(t){return t+(t.match(/^[-0-9.]+$/)?"px":"")}const lb=(t,n)=>{const l=Pk(nb,n),h={...Fk},p=n.mode||"svg",y={},m=n.style,a=typeof m=="object"&&!(m instanceof Array)?m:{};for(let X in n){const ae=n[X];if(ae!==void 0)switch(X){case"icon":case"style":case"onLoad":case"mode":case"ssr":break;case"inline":case"hFlip":case"vFlip":l[X]=ae===!0||ae==="true"||ae===1;break;case"flip":typeof ae=="string"&&kk(l,ae);break;case"color":y.color=ae;break;case"rotate":typeof ae=="string"?l[X]=Lk(ae):typeof ae=="number"&&(l[X]=ae);break;case"ariaHidden":case"aria-hidden":ae!==!0&&ae!=="true"&&delete h["aria-hidden"];break;default:{const Se=Zf[X];Se?(ae===!0||ae==="true"||ae===1)&&(l[Se]=!0):nb[X]===void 0&&(h[X]=ae)}}}const I=tk(t,l),z=I.attributes;if(l.inline&&(y.verticalAlign="-0.125em"),p==="svg"){h.style={...y,...a},Object.assign(h,z);let X=0,ae=n.id;return typeof ae=="string"&&(ae=ae.replace(/-/g,"_")),h.innerHTML=ok(I.body,ae?()=>ae+"ID"+X++:"iconifyVue"),pn("svg",h)}const{body:P,width:k,height:N}=t,F=p==="mask"||(p==="bg"?!1:P.indexOf("currentColor")!==-1),H=zk(P,{...z,width:k+"",height:N+""});return h.style={...y,"--svg":Ok(H),width:ab(z.width),height:ab(z.height),...Bk,...F?n_:nw,...a},pn("span",h)};K1(!0);J1("",mk);if(typeof document<"u"&&typeof window<"u"){const t=window;if(t.IconifyPreload!==void 0){const n=t.IconifyPreload,l="Invalid IconifyPreload syntax.";typeof n=="object"&&n!==null&&(n instanceof Array?n:[n]).forEach(h=>{try{(typeof h!="object"||h===null||h instanceof Array||typeof h.icons!="object"||typeof h.prefix!="string"||!WA(h))&&console.error(l)}catch{console.error(l)}})}if(t.IconifyProviders!==void 0){const n=t.IconifyProviders;if(typeof n=="object"&&n!==null)for(let l in n){const h="IconifyProviders["+l+"] is invalid.";try{const p=n[l];if(typeof p!="object"||!p||p.resources===void 0)continue;Q1(l,p)||console.error(h)}catch{console.error(h)}}}}const jk={...ru,body:""},Nk=Ur({inheritAttrs:!1,data(){return{_name:"",_loadingIcon:null,iconMounted:!1,counter:0}},mounted(){this.iconMounted=!0},unmounted(){this.abortLoading()},methods:{abortLoading(){this._loadingIcon&&(this._loadingIcon.abort(),this._loadingIcon=null)},getIcon(t,n,l){if(typeof t=="object"&&t!==null&&typeof t.body=="string")return this._name="",this.abortLoading(),{data:t};let h;if(typeof t!="string"||(h=id(t,!1,!0))===null)return this.abortLoading(),null;let p=N_(h);if(!p)return(!this._loadingIcon||this._loadingIcon.name!==t)&&(this.abortLoading(),this._name="",p!==null&&(this._loadingIcon={name:t,abort:iw([h],()=>{this.counter++})})),null;if(this.abortLoading(),this._name!==t&&(this._name=t,n&&n(t)),l){p=Object.assign({},p);const m=l(p.body,h.name,h.prefix,h.provider);typeof m=="string"&&(p.body=m)}const y=["iconify"];return h.prefix!==""&&y.push("iconify--"+h.prefix),h.provider!==""&&y.push("iconify--"+h.provider),{data:p,classes:y}}},render(){this.counter;const t=this.$attrs,n=this.iconMounted||t.ssr?this.getIcon(t.icon,t.onLoad,t.customise):null;if(!n)return lb(jk,t);let l=t;return n.classes&&(l={...t,class:(typeof t.class=="string"?t.class+" ":"")+n.classes.join(" ")}),lb({...ru,...n.data},l)}}),Vk={getAPIConfig:kp,setAPIModule:J1,sendAPIQuery:rw,setFetch:lk,getFetch:ck,listAPIProviders:sk},$k=qn({name:"@nuxt/icon",setup(){var p,y;const t=Cl(),n=Ll().icon;Vk.setFetch($fetch.native);const l=[];if(n.provider==="server"){const m=((y=(p=t.app)==null?void 0:p.baseURL)==null?void 0:y.replace(/\/$/,""))??"";l.push(m+(n.localApiEndpoint||"/api/_nuxt_icon")),(n.fallbackToApi===!0||n.fallbackToApi==="client-only")&&l.push(n.iconifyApiEndpoint)}else l.push(n.iconifyApiEndpoint);async function h(m,a){try{const I=await $fetch(l[0]+"/"+a+".json",{query:{icons:m.join(",")}});if(!I||I.prefix!==a||!I.icons)throw new Error("Invalid data"+JSON.stringify(I));return I}catch(I){return console.error("Failed to load custom icons",I),null}}Q1("",{resources:l});for(const m of n.customCollections||[])m&&Mk(h,m)}}),Uk=[JM,iP,sP,lP,cP,uP,dP,mP,bP,wP,FA,VA,$k];async function ow(t,n=co()){const{path:l,matched:h}=n.resolve(t);if(!h.length||(n._routePreloaded||(n._routePreloaded=new Set),n._routePreloaded.has(l)))return;const p=n._preloadPromises||(n._preloadPromises=[]);if(p.length>4)return Promise.all(p).then(()=>ow(t,n));n._routePreloaded.add(l);const y=h.map(m=>{var a;return(a=m.components)==null?void 0:a.default}).filter(m=>typeof m=="function");for(const m of y){const a=Promise.resolve(m()).catch(()=>{}).finally(()=>p.splice(p.indexOf(a)));p.push(a)}await Promise.all(p)}const Gk=(...t)=>t.find(n=>n!==void 0);function Zk(t){const n=t.componentName||"NuxtLink";function l(y){return typeof y=="string"&&y.startsWith("#")}function h(y,m){if(!y||t.trailingSlash!=="append"&&t.trailingSlash!=="remove")return y;if(typeof y=="string")return cb(y,t.trailingSlash);const a="path"in y&&y.path!==void 0?y.path:m(y).path;return{...y,name:void 0,path:cb(a,t.trailingSlash)}}function p(y){const m=co(),a=Cl(),I=Ye(()=>!!y.target&&y.target!=="_self"),z=Ye(()=>{const ae=y.to||y.href||"";return typeof ae=="string"&&Aa(ae,{acceptRelative:!0})}),P=Ag("RouterLink"),k=P&&typeof P!="string"?P.useLink:void 0,N=Ye(()=>{if(y.external)return!0;const ae=y.to||y.href||"";return typeof ae=="object"?!1:ae===""||z.value}),F=Ye(()=>{const ae=y.to||y.href||"";return N.value?ae:h(ae,m.resolve)}),H=N.value||k==null?void 0:k({...y,to:F}),X=Ye(()=>{var ae;if(!F.value||z.value||l(F.value))return F.value;if(N.value){const Se=typeof F.value=="object"&&"path"in F.value?qg(F.value):F.value,be=typeof Se=="object"?m.resolve(Se).href:Se;return h(be,m.resolve)}return typeof F.value=="object"?((ae=m.resolve(F.value))==null?void 0:ae.href)??null:h(td(a.app.baseURL,F.value),m.resolve)});return{to:F,hasTarget:I,isAbsoluteUrl:z,isExternal:N,href:X,isActive:(H==null?void 0:H.isActive)??Ye(()=>F.value===m.currentRoute.value.path),isExactActive:(H==null?void 0:H.isExactActive)??Ye(()=>F.value===m.currentRoute.value.path),route:(H==null?void 0:H.route)??Ye(()=>m.resolve(F.value)),async navigate(ae){await P1(X.value,{replace:y.replace,external:N.value||I.value})}}}return Ur({name:n,props:{to:{type:[String,Object],default:void 0,required:!1},href:{type:[String,Object],default:void 0,required:!1},target:{type:String,default:void 0,required:!1},rel:{type:String,default:void 0,required:!1},noRel:{type:Boolean,default:void 0,required:!1},prefetch:{type:Boolean,default:void 0,required:!1},prefetchOn:{type:[String,Object],default:void 0,required:!1},noPrefetch:{type:Boolean,default:void 0,required:!1},activeClass:{type:String,default:void 0,required:!1},exactActiveClass:{type:String,default:void 0,required:!1},prefetchedClass:{type:String,default:void 0,required:!1},replace:{type:Boolean,default:void 0,required:!1},ariaCurrentValue:{type:String,default:void 0,required:!1},external:{type:Boolean,default:void 0,required:!1},custom:{type:Boolean,default:void 0,required:!1}},useLink:p,setup(y,{slots:m}){const a=co(),{to:I,href:z,navigate:P,isExternal:k,hasTarget:N,isAbsoluteUrl:F}=p(y),H=$t(!1),X=$t(null),ae=Q=>{var re;X.value=y.custom?(re=Q==null?void 0:Q.$el)==null?void 0:re.nextElementSibling:Q==null?void 0:Q.$el};function Se(Q){var re,J;return!H.value&&(typeof y.prefetchOn=="string"?y.prefetchOn===Q:((re=y.prefetchOn)==null?void 0:re[Q])??((J=t.prefetchOn)==null?void 0:J[Q]))&&(y.prefetch??t.prefetch)!==!1&&y.noPrefetch!==!0&&y.target!=="_blank"&&!Wk()}async function be(Q=ii()){if(H.value)return;H.value=!0;const re=typeof I.value=="string"?I.value:k.value?qg(I.value):a.resolve(I.value).fullPath,J=k.value?new URL(re,window.location.href).href:re;await Promise.all([Q.hooks.callHook("link:prefetch",J).catch(()=>{}),!k.value&&!N.value&&ow(I.value,a).catch(()=>{})])}if(Se("visibility")){const Q=ii();let re,J=null;Sn(()=>{const le=qk();Pp(()=>{re=Yg(()=>{var Me;(Me=X==null?void 0:X.value)!=null&&Me.tagName&&(J=le.observe(X.value,async()=>{J==null||J(),J=null,await be(Q)}))})})}),xp(()=>{re&&aP(re),J==null||J(),J=null})}return()=>{var J;if(!k.value&&!N.value&&!l(I.value)){const le={ref:ae,to:I.value,activeClass:y.activeClass||t.activeClass,exactActiveClass:y.exactActiveClass||t.exactActiveClass,replace:y.replace,ariaCurrentValue:y.ariaCurrentValue,custom:y.custom};return y.custom||(Se("interaction")&&(le.onPointerenter=be.bind(null,void 0),le.onFocus=be.bind(null,void 0)),H.value&&(le.class=y.prefetchedClass||t.prefetchedClass),le.rel=y.rel||void 0),pn(Ag("RouterLink"),le,m.default)}const Q=y.target||null,re=Gk(y.noRel?"":y.rel,t.externalRelAttribute,F.value||N.value?"noopener noreferrer":"")||null;return y.custom?m.default?m.default({href:z.value,navigate:P,prefetch:be,get route(){if(!z.value)return;const le=new URL(z.value,window.location.href);return{path:le.pathname,fullPath:le.pathname,get query(){return Cp(le.search)},hash:le.hash,params:{},name:void 0,matched:[],redirectedFrom:void 0,meta:{},href:z.value}},rel:re,target:Q,isExternal:k.value||N.value,isActive:!1,isExactActive:!1}):null:pn("a",{ref:X,href:z.value||null,rel:re,target:Q},(J=m.default)==null?void 0:J.call(m))}}})}const sw=Zk(BI);function cb(t,n){const l=n==="append"?op:Ip;return Aa(t)&&!t.startsWith("http")?t:l(t,!0)}function qk(){const t=ii();if(t._observer)return t._observer;let n=null;const l=new Map,h=(y,m)=>(n||(n=new IntersectionObserver(a=>{for(const I of a){const z=l.get(I.target);(I.isIntersecting||I.intersectionRatio>0)&&z&&z()}})),l.set(y,m),n.observe(y),()=>{l.delete(y),n==null||n.unobserve(y),l.size===0&&(n==null||n.disconnect(),n=null)});return t._observer={observe:h}}const Hk=/2g/;function Wk(){const t=navigator.connection;return!!(t&&(t.saveData||Hk.test(t.effectiveType)))}const Kk=Object.freeze({left:0,top:0,width:16,height:16}),aw=Object.freeze({rotate:0,vFlip:!1,hFlip:!1}),U_=Object.freeze({...Kk,...aw});Object.freeze({...U_,body:"",hidden:!1});function Xk(t,n){let l=t.indexOf("xlink:")===-1?"":' xmlns:xlink="http://www.w3.org/1999/xlink"';for(const h in n)l+=" "+h+'="'+n[h]+'"';return'<svg xmlns="http://www.w3.org/2000/svg"'+l+">"+t+"</svg>"}const Yk=/(-?[0-9.]*[0-9]+[0-9.]*)/g,Jk=/^-?[0-9.]*[0-9]+[0-9.]*$/g;function o_(t,n,l){if(n===1)return t;if(l=l||100,typeof t=="number")return Math.ceil(t*n*l)/l;if(typeof t!="string")return t;const h=t.split(Yk);if(h===null||!h.length)return t;const p=[];let y=h.shift(),m=Jk.test(y);for(;;){if(m){const a=parseFloat(y);isNaN(a)?p.push(y):p.push(Math.ceil(a*n*l)/l)}else p.push(y);if(y=h.shift(),y===void 0)return p.join("");m=!m}}function Qk(t){return t.replace(/"/g,"'").replace(/%/g,"%25").replace(/#/g,"%23").replace(/</g,"%3C").replace(/>/g,"%3E").replace(/\s+/g," ")}function eL(t){return"data:image/svg+xml,"+Qk(t)}function tL(t){return'url("'+eL(t)+'")'}function rL(t){const[n,l,h,p]=t;if(h!==p){const y=Math.max(h,p);return[n-(y-h)/2,l-(y-p)/2,y,y]}return t}const iL=Object.freeze({width:null,height:null}),nL=Object.freeze({...iL,...aw});function oL(t,n="defs"){let l="";const h=t.indexOf("<"+n);for(;h>=0;){const p=t.indexOf(">",h),y=t.indexOf("</"+n);if(p===-1||y===-1)break;const m=t.indexOf(">",y);if(m===-1)break;l+=t.slice(p+1,y).trim(),t=t.slice(0,h).trim()+t.slice(m+1)}return{defs:l,content:t}}function sL(t,n){return t?"<defs>"+t+"</defs>"+n:n}function aL(t,n,l){const h=oL(t);return sL(h.defs,n+h.content+l)}const lL=t=>t==="unset"||t==="undefined"||t==="none";function cL(t,n){const l={...U_,...t},h={...nL,...n},p={left:l.left,top:l.top,width:l.width,height:l.height};let y=l.body;[l,h].forEach(X=>{const ae=[],Se=X.hFlip,be=X.vFlip;let Q=X.rotate;Se?be?Q+=2:(ae.push("translate("+(p.width+p.left).toString()+" "+(0-p.top).toString()+")"),ae.push("scale(-1 1)"),p.top=p.left=0):be&&(ae.push("translate("+(0-p.left).toString()+" "+(p.height+p.top).toString()+")"),ae.push("scale(1 -1)"),p.top=p.left=0);let re;switch(Q<0&&(Q-=Math.floor(Q/4)*4),Q=Q%4,Q){case 1:re=p.height/2+p.top,ae.unshift("rotate(90 "+re.toString()+" "+re.toString()+")");break;case 2:ae.unshift("rotate(180 "+(p.width/2+p.left).toString()+" "+(p.height/2+p.top).toString()+")");break;case 3:re=p.width/2+p.left,ae.unshift("rotate(-90 "+re.toString()+" "+re.toString()+")");break}Q%2===1&&(p.left!==p.top&&(re=p.left,p.left=p.top,p.top=re),p.width!==p.height&&(re=p.width,p.width=p.height,p.height=re)),ae.length&&(y=aL(y,'<g transform="'+ae.join(" ")+'">',"</g>"))});const m=h.width,a=h.height,I=p.width,z=p.height;let P,k;m===null?(k=a===null?"1em":a==="auto"?z:a,P=o_(k,I/z)):(P=m==="auto"?I:m,k=a===null?o_(P,z/I):a==="auto"?z:a);const N={},F=(X,ae)=>{lL(ae)||(N[X]=ae.toString())};F("width",P),F("height",k);const H=[p.left,p.top,I,z];return N.viewBox=H.join(" "),{attributes:N,viewBox:H,body:y}}function uL(t){const n={display:"inline-block",width:"1em",height:"1em"},l=t.varName;switch(t.pseudoSelector&&(n.content="''"),t.mode){case"background":l&&(n["background-image"]="var(--"+l+")"),n["background-repeat"]="no-repeat",n["background-size"]="100% 100%";break;case"mask":n["background-color"]="currentColor",l&&(n["mask-image"]=n["-webkit-mask-image"]="var(--"+l+")"),n["mask-repeat"]=n["-webkit-mask-repeat"]="no-repeat",n["mask-size"]=n["-webkit-mask-size"]="100% 100%";break}return n}function hL(t,n){const l={},h=n.varName,p=cL(t);let y=p.viewBox;y[2]!==y[3]&&(n.forceSquare?y=rL(y):l.width=o_("1em",y[2]/y[3]));const m=Xk(p.body.replace(/currentColor/g,n.color||"black"),{viewBox:`${y[0]} ${y[1]} ${y[2]} ${y[3]}`,width:`${y[2]}`,height:`${y[3]}`}),a=tL(m);if(h)l["--"+h]=a;else switch(n.mode){case"background":l["background-image"]=a;break;case"mask":l["mask-image"]=l["-webkit-mask-image"]=a;break}return l}const _g={selectorStart:{compressed:"{",compact:" {",expanded:" {"},selectorEnd:{compressed:"}",compact:`; }
`,expanded:`;
}
`},rule:{compressed:"{key}:",compact:" {key}: ",expanded:`
  {key}: `}};function dL(t,n="expanded"){const l=[];for(let h=0;h<t.length;h++){const{selector:p,rules:y}=t[h];let a=(p instanceof Array?p.join(n==="compressed"?",":", "):p)+_g.selectorStart[n],I=!0;for(const z in y)I||(a+=";"),a+=_g.rule[n].replace("{key}",z)+y[z],I=!1;a+=_g.selectorEnd[n],l.push(a)}return l.join(n==="compressed"?"":`
`)}function fL(t,n={}){const l=n.customise?n.customise(t.body):t.body,h=n.mode||(n.color||!l.includes("currentColor")?"background":"mask");let p=n.varName;p===void 0&&h==="mask"&&(p="svg");const y={...n,mode:h,varName:p};h==="background"&&delete y.varName;const m={...n.rules,...uL(y),...hL({...U_,...t,body:l},y)},a=n.iconSelector||".icon";return dL([{selector:a,rules:m}],y.format)}async function pL(t,n){if(!t)return null;const l=t_(t);return l||(await Ik(t).catch(()=>(console.warn(`[Icon] failed to load icon \`${t}\``),null)),t_(t))}function lw(t){const n=Ll().icon,l=(n.collections||[]).sort((h,p)=>p.length-h.length);return Ye(()=>{var m;const h=t(),p=h.startsWith(n.cssSelectorPrefix)?h.slice(n.cssSelectorPrefix.length):h,y=((m=n.aliases)==null?void 0:m[p])||p;if(!y.includes(":")){const a=l.find(I=>y.startsWith(I+"-"));return a?a+":"+y.slice(a.length+1):y}return y})}let Sh;function mL(t){return t.replace(/([^\w-])/g,"\\$1")}function gL(){if(Sh)return Sh;Sh=new Set;const t=l=>{if(l=l.replace(/^:where\((.*)\)$/,"$1").trim(),l.startsWith("."))return l},n=l=>{if(l!=null&&l.length)for(const h of l){h!=null&&h.cssRules&&n(h.cssRules);const p=h==null?void 0:h.selectorText;if(typeof p=="string"){const y=t(p);y&&Sh.add(y)}}};if(typeof document<"u")for(const l of document.styleSheets)try{const h=l.cssRules||l.rules;n(h)}catch{}return Sh}const _L=Ur({name:"NuxtIconCss",props:{name:{type:String,required:!0},customize:{type:Function,required:!1}},setup(t){const n=ii(),l=Ll().icon,h=Ye(()=>t.name?l.cssSelectorPrefix+t.name:"");function p(a){var P,k;if(!a)return;const I=t_(a);if(I)return I;const z=(k=(P=n.payload)==null?void 0:P.data)==null?void 0:k[a];if(z)return V_(a,z),z}const y=Ye(()=>"."+mL(h.value));function m(a,I=!0){let z=y.value;l.cssWherePseudo&&(z=`:where(${z})`);const P=fL(a,{iconSelector:z,format:"compressed",customise:t.customize??l.customize});return l.cssLayer&&I?`@layer ${l.cssLayer} { ${P} }`:P}{const a=gL();async function I(z){if(a.has(y.value)||typeof document>"u")return;const P=document.createElement("style");P.textContent=m(z);const k=document.head.querySelector('style, link[rel="stylesheet"]');k?document.head.insertBefore(P,k):document.head.appendChild(P),a.add(y.value)}Li(()=>t.name,()=>{if(a.has(y.value))return;const z=p(t.name);z?I(z):pL(t.name).then(P=>{P&&I(P)}).catch(()=>null)},{immediate:!0})}return()=>pn("span",{class:["iconify",h.value]})}}),yL=Ur({name:"NuxtIconSvg",props:{name:{type:String,required:!0},customize:{type:Function,required:!1}},setup(t,{slots:n}){const l=ii(),h=Ll().icon,p=lw(()=>t.name),y="i-"+p.value;if(p.value){const m=l.payload.data[y];m&&V_(p.value,m)}return()=>pn(Nk,{icon:p.value,ssr:!0,customise:t.customize??h.customize},n)}}),cw=Ur({name:"NuxtIcon",props:{name:{type:String,required:!0},mode:{type:String,required:!1,default:null},size:{type:[Number,String],required:!1,default:null},customize:{type:Function,required:!1}},setup(t,{slots:n}){const l=ii(),h=Ll().icon,p=lw(()=>t.name),y=Ye(()=>{var I;return((I=l.vueApp)==null?void 0:I.component(p.value))||((t.mode||h.mode)==="svg"?yL:_L)}),m=Ye(()=>{const I=t.size||h.size;return I?{fontSize:Number.isNaN(+I)?I:I+"px"}:null}),a=t.customize||h.customize;return()=>pn(y.value,{...h.attrs,name:p.value,class:h.class,style:m.value,customize:a},n)}}),vL=Object.freeze(Object.defineProperty({__proto__:null,default:cw},Symbol.toStringTag,{value:"Module"})),Qo=(t,n)=>{const l=t.__vccOpts||t;for(const[h,p]of n)l[h]=p;return l},bL=Ur({props:{name:{type:String,required:!0},mode:{type:String,required:!1,default:null},size:{type:[Number,String],required:!1,default:null},customize:{type:Function,required:!1,default:null}}});function xL(t,n,l,h,p,y){const m=cw;return Bt(),kr(m,Wf(Zh(t.$props)),null,16)}const es=Qo(bL,[["render",xL]]),Hc=(t,n,l,h,p=!1)=>{const y=mE(),m=Ll(),a=Ye(()=>{var N;const z=vl(n),P=vl(l),k=vl(h);return zl((z==null?void 0:z.strategy)||((N=m.ui)==null?void 0:N.strategy),k?{wrapper:k}:{},z||{},p?Hh(m.ui,t,{}):{},P||{})}),I=Ye(()=>iA(y,["class"]));return{ui:a,attrs:I}};function Lp({ui:t,props:n}){const l=eu();if(Pa("ButtonGroupContextConsumer",!0),nn("ButtonGroupContextConsumer",!1))return{size:Ye(()=>n.size),rounded:Ye(()=>t.value.rounded)};let p=l.parent,y;for(;p&&!y;){if(p.type.name==="ButtonGroup"){y=nn(`group-${p.uid}`);break}p=p.parent}const m=Ye(()=>y==null?void 0:y.value.children.indexOf(l));return Sn(()=>{y==null||y.value.register(l)}),Qc(()=>{y==null||y.value.unregister(l)}),{size:Ye(()=>y!=null&&y.value?(y==null?void 0:y.value.size)??t.value.default.size:n.size),rounded:Ye(()=>!y||m.value===-1?t.value.rounded:y.value.children.length===1?y.value.ui.rounded:m.value===0?y.value.rounded.start:m.value===y.value.children.length-1?y.value.rounded.end:"rounded-none")}}const wL={wrapper:"relative inline-flex items-center justify-center flex-shrink-0",background:"bg-gray-100 dark:bg-gray-800",rounded:"rounded-full",text:"font-medium leading-none text-gray-900 dark:text-white truncate",placeholder:"font-medium leading-none text-gray-500 dark:text-gray-400 truncate",size:{"3xs":"h-4 w-4 text-[8px]","2xs":"h-5 w-5 text-[10px]",xs:"h-6 w-6 text-xs",sm:"h-8 w-8 text-sm",md:"h-10 w-10 text-base",lg:"h-12 w-12 text-lg",xl:"h-14 w-14 text-xl","2xl":"h-16 w-16 text-2xl","3xl":"h-20 w-20 text-3xl"},chip:{base:"absolute rounded-full ring-1 ring-white dark:ring-gray-900 flex items-center justify-center text-white dark:text-gray-900 font-medium",background:"bg-{color}-500 dark:bg-{color}-400",position:{"top-right":"top-0 right-0","bottom-right":"bottom-0 right-0","top-left":"top-0 left-0","bottom-left":"bottom-0 left-0"},size:{"3xs":"h-[4px] min-w-[4px] text-[4px] p-px","2xs":"h-[5px] min-w-[5px] text-[5px] p-px",xs:"h-1.5 min-w-[0.375rem] text-[6px] p-px",sm:"h-2 min-w-[0.5rem] text-[7px] p-0.5",md:"h-2.5 min-w-[0.625rem] text-[8px] p-0.5",lg:"h-3 min-w-[0.75rem] text-[10px] p-0.5",xl:"h-3.5 min-w-[0.875rem] text-[11px] p-1","2xl":"h-4 min-w-[1rem] text-[12px] p-1","3xl":"h-5 min-w-[1.25rem] text-[14px] p-1"}},icon:{base:"text-gray-500 dark:text-gray-400 flex-shrink-0",size:{"3xs":"h-2 w-2","2xs":"h-2.5 w-2.5",xs:"h-3 w-3",sm:"h-4 w-4",md:"h-5 w-5",lg:"h-6 w-6",xl:"h-7 w-7","2xl":"h-8 w-8","3xl":"h-10 w-10"}},default:{size:"sm",icon:null,chipColor:null,chipPosition:"top-right"}},TL={base:"inline-flex items-center",rounded:"rounded-md",font:"font-medium",size:{xs:"text-xs px-1.5 py-0.5",sm:"text-xs px-2 py-1",md:"text-sm px-2 py-1",lg:"text-sm px-2.5 py-1.5"},gap:{xs:"gap-0.5",sm:"gap-1",md:"gap-1",lg:"gap-1.5"},color:{white:{solid:"ring-1 ring-inset ring-gray-300 dark:ring-gray-700 text-gray-900 dark:text-white bg-white dark:bg-gray-900"},gray:{solid:"ring-1 ring-inset ring-gray-300 dark:ring-gray-700 text-gray-700 dark:text-gray-200 bg-gray-50 dark:bg-gray-800"},black:{solid:"text-white dark:text-gray-900 bg-gray-900 dark:bg-white"}},variant:{solid:"bg-{color}-500 dark:bg-{color}-400 text-white dark:text-gray-900",outline:"text-{color}-500 dark:text-{color}-400 ring-1 ring-inset ring-{color}-500 dark:ring-{color}-400",soft:"bg-{color}-50 dark:bg-{color}-400 dark:bg-opacity-10 text-{color}-500 dark:text-{color}-400",subtle:"bg-{color}-50 dark:bg-{color}-400 dark:bg-opacity-10 text-{color}-500 dark:text-{color}-400 ring-1 ring-inset ring-{color}-500 dark:ring-{color}-400 ring-opacity-25 dark:ring-opacity-25"},icon:{base:"flex-shrink-0",size:{xs:"h-4 w-4",sm:"h-4 w-4",md:"h-5 w-5",lg:"h-5 w-5"}},default:{size:"sm",variant:"solid",color:"primary"}},SL={base:"focus:outline-none focus-visible:outline-0 disabled:cursor-not-allowed disabled:opacity-75 aria-disabled:cursor-not-allowed aria-disabled:opacity-75 flex-shrink-0",font:"font-medium",rounded:"rounded-md",truncate:"text-left break-all line-clamp-1",block:"w-full flex justify-center items-center",inline:"inline-flex items-center",size:{"2xs":"text-xs",xs:"text-xs",sm:"text-sm",md:"text-sm",lg:"text-sm",xl:"text-base"},gap:{"2xs":"gap-x-1",xs:"gap-x-1.5",sm:"gap-x-1.5",md:"gap-x-2",lg:"gap-x-2.5",xl:"gap-x-2.5"},padding:{"2xs":"px-2 py-1",xs:"px-2.5 py-1.5",sm:"px-2.5 py-1.5",md:"px-3 py-2",lg:"px-3.5 py-2.5",xl:"px-3.5 py-2.5"},square:{"2xs":"p-1",xs:"p-1.5",sm:"p-1.5",md:"p-2",lg:"p-2.5",xl:"p-2.5"},color:{white:{solid:"shadow-sm ring-1 ring-inset ring-gray-300 dark:ring-gray-700 text-gray-900 dark:text-white bg-white hover:bg-gray-50 disabled:bg-white aria-disabled:bg-white dark:bg-gray-900 dark:hover:bg-gray-800/50 dark:disabled:bg-gray-900 dark:aria-disabled:bg-gray-900 focus-visible:ring-2 focus-visible:ring-primary-500 dark:focus-visible:ring-primary-400",ghost:"text-gray-900 dark:text-white hover:bg-white dark:hover:bg-gray-900 focus-visible:ring-inset focus-visible:ring-2 focus-visible:ring-primary-500 dark:focus-visible:ring-primary-400"},gray:{solid:"shadow-sm ring-1 ring-inset ring-gray-300 dark:ring-gray-700 text-gray-700 dark:text-gray-200 bg-gray-50 hover:bg-gray-100 disabled:bg-gray-50 aria-disabled:bg-gray-50 dark:bg-gray-800 dark:hover:bg-gray-700/50 dark:disabled:bg-gray-800 dark:aria-disabled:bg-gray-800 focus-visible:ring-2 focus-visible:ring-primary-500 dark:focus-visible:ring-primary-400",ghost:"text-gray-700 dark:text-gray-200 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-800 focus-visible:ring-inset focus-visible:ring-2 focus-visible:ring-primary-500 dark:focus-visible:ring-primary-400",link:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 underline-offset-4 hover:underline focus-visible:ring-inset focus-visible:ring-2 focus-visible:ring-primary-500 dark:focus-visible:ring-primary-400"},black:{solid:"shadow-sm text-white dark:text-gray-900 bg-gray-900 hover:bg-gray-800 disabled:bg-gray-900 aria-disabled:bg-gray-900 dark:bg-white dark:hover:bg-gray-100 dark:disabled:bg-white dark:aria-disabled:bg-white focus-visible:ring-inset focus-visible:ring-2 focus-visible:ring-primary-500 dark:focus-visible:ring-primary-400",link:"text-gray-900 dark:text-white underline-offset-4 hover:underline focus-visible:ring-inset focus-visible:ring-2 focus-visible:ring-primary-500 dark:focus-visible:ring-primary-400"}},variant:{solid:"shadow-sm text-white dark:text-gray-900 bg-{color}-500 hover:bg-{color}-600 disabled:bg-{color}-500 aria-disabled:bg-{color}-500 dark:bg-{color}-400 dark:hover:bg-{color}-500 dark:disabled:bg-{color}-400 dark:aria-disabled:bg-{color}-400 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-{color}-500 dark:focus-visible:outline-{color}-400",outline:"ring-1 ring-inset ring-current text-{color}-500 dark:text-{color}-400 hover:bg-{color}-50 disabled:bg-transparent aria-disabled:bg-transparent dark:hover:bg-{color}-950 dark:disabled:bg-transparent dark:aria-disabled:bg-transparent focus-visible:ring-2 focus-visible:ring-{color}-500 dark:focus-visible:ring-{color}-400",soft:"text-{color}-500 dark:text-{color}-400 bg-{color}-50 hover:bg-{color}-100 disabled:bg-{color}-50 aria-disabled:bg-{color}-50 dark:bg-{color}-950 dark:hover:bg-{color}-900 dark:disabled:bg-{color}-950 dark:aria-disabled:bg-{color}-950 focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-{color}-500 dark:focus-visible:ring-{color}-400",ghost:"text-{color}-500 dark:text-{color}-400 hover:bg-{color}-50 disabled:bg-transparent aria-disabled:bg-transparent dark:hover:bg-{color}-950 dark:disabled:bg-transparent dark:aria-disabled:bg-transparent focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-{color}-500 dark:focus-visible:ring-{color}-400",link:"text-{color}-500 hover:text-{color}-600 disabled:text-{color}-500 aria-disabled:text-{color}-500 dark:text-{color}-400 dark:hover:text-{color}-500 dark:disabled:text-{color}-400 dark:aria-disabled:text-{color}-400 underline-offset-4 hover:underline focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-{color}-500 dark:focus-visible:ring-{color}-400"},icon:{base:"flex-shrink-0",loading:"animate-spin",size:{"2xs":"h-4 w-4",xs:"h-4 w-4",sm:"h-5 w-5",md:"h-5 w-5",lg:"h-5 w-5",xl:"h-6 w-6"}},default:{size:"sm",variant:"solid",color:"primary",loadingIcon:"i-heroicons-arrow-path-20-solid"}},uw={base:"invisible before:visible before:block before:rotate-45 before:z-[-1] before:w-2 before:h-2",ring:"before:ring-1 before:ring-gray-200 dark:before:ring-gray-800",rounded:"before:rounded-sm",background:"before:bg-gray-200 dark:before:bg-gray-800",shadow:"before:shadow",placement:"group-data-[popper-placement*='right']:-left-1 group-data-[popper-placement*='left']:-right-1 group-data-[popper-placement*='top']:-bottom-1 group-data-[popper-placement*='bottom']:-top-1"},G_={wrapper:"relative",base:"relative block w-full disabled:cursor-not-allowed disabled:opacity-75 focus:outline-none border-0",form:"form-input",rounded:"rounded-md",placeholder:"placeholder-gray-400 dark:placeholder-gray-500",file:{base:"file:mr-1.5 file:font-medium file:text-gray-500 dark:file:text-gray-400 file:bg-transparent file:border-0 file:p-0 file:outline-none"},size:{"2xs":"text-xs",xs:"text-xs",sm:"text-sm",md:"text-sm",lg:"text-sm",xl:"text-base"},gap:{"2xs":"gap-x-1",xs:"gap-x-1.5",sm:"gap-x-1.5",md:"gap-x-2",lg:"gap-x-2.5",xl:"gap-x-2.5"},padding:{"2xs":"px-2 py-1",xs:"px-2.5 py-1.5",sm:"px-2.5 py-1.5",md:"px-3 py-2",lg:"px-3.5 py-2.5",xl:"px-3.5 py-2.5"},leading:{padding:{"2xs":"ps-7",xs:"ps-8",sm:"ps-9",md:"ps-10",lg:"ps-11",xl:"ps-12"}},trailing:{padding:{"2xs":"pe-7",xs:"pe-8",sm:"pe-9",md:"pe-10",lg:"pe-11",xl:"pe-12"}},color:{white:{outline:"shadow-sm bg-white dark:bg-gray-900 text-gray-900 dark:text-white ring-1 ring-inset ring-gray-300 dark:ring-gray-700 focus:ring-2 focus:ring-primary-500 dark:focus:ring-primary-400"},gray:{outline:"shadow-sm bg-gray-50 dark:bg-gray-800 text-gray-900 dark:text-white ring-1 ring-inset ring-gray-300 dark:ring-gray-700 focus:ring-2 focus:ring-primary-500 dark:focus:ring-primary-400"}},variant:{outline:"shadow-sm bg-transparent text-gray-900 dark:text-white ring-1 ring-inset ring-{color}-500 dark:ring-{color}-400 focus:ring-2 focus:ring-{color}-500 dark:focus:ring-{color}-400",none:"bg-transparent focus:ring-0 focus:shadow-none"},icon:{base:"flex-shrink-0 text-gray-400 dark:text-gray-500",color:"text-{color}-500 dark:text-{color}-400",loading:"animate-spin",size:{"2xs":"h-4 w-4",xs:"h-4 w-4",sm:"h-5 w-5",md:"h-5 w-5",lg:"h-5 w-5",xl:"h-6 w-6"},leading:{wrapper:"absolute inset-y-0 start-0 flex items-center",pointer:"pointer-events-none",padding:{"2xs":"px-2",xs:"px-2.5",sm:"px-2.5",md:"px-3",lg:"px-3.5",xl:"px-3.5"}},trailing:{wrapper:"absolute inset-y-0 end-0 flex items-center",pointer:"pointer-events-none",padding:{"2xs":"px-2",xs:"px-2.5",sm:"px-2.5",md:"px-3",lg:"px-3.5",xl:"px-3.5"}}},default:{size:"sm",color:"white",variant:"outline",loadingIcon:"i-heroicons-arrow-path-20-solid"}},ub={container:"z-20 group",trigger:"flex items-center w-full",width:"w-full",height:"max-h-60",base:"relative focus:outline-none overflow-y-auto scroll-py-1",background:"bg-white dark:bg-gray-800",shadow:"shadow-lg",rounded:"rounded-md",padding:"p-1",ring:"ring-1 ring-gray-200 dark:ring-gray-700",empty:"text-sm text-gray-400 dark:text-gray-500 px-2 py-1.5",option:{base:"cursor-default select-none relative flex items-center justify-between gap-1",rounded:"rounded-md",padding:"px-1.5 py-1.5",size:"text-sm",color:"text-gray-900 dark:text-white",container:"flex items-center gap-1.5 min-w-0",active:"bg-gray-100 dark:bg-gray-900",inactive:"",selected:"pe-7",disabled:"cursor-not-allowed opacity-50",empty:"text-sm text-gray-400 dark:text-gray-500 px-2 py-1.5",icon:{base:"flex-shrink-0 h-5 w-5",active:"text-gray-900 dark:text-white",inactive:"text-gray-400 dark:text-gray-500"},selectedIcon:{wrapper:"absolute inset-y-0 end-0 flex items-center",padding:"pe-2",base:"h-5 w-5 text-gray-900 dark:text-white flex-shrink-0"},avatar:{base:"flex-shrink-0",size:"2xs"},chip:{base:"flex-shrink-0 w-2 h-2 mx-1 rounded-full"}},transition:{leaveActiveClass:"transition ease-in duration-100",leaveFromClass:"opacity-100",leaveToClass:"opacity-0"},popper:{placement:"bottom-end"},default:{selectedIcon:"i-heroicons-check-20-solid",trailingIcon:"i-heroicons-chevron-down-20-solid",empty:{label:"No options."},optionEmpty:{label:'No results for "{query}".'}},arrow:{...uw,ring:"before:ring-1 before:ring-gray-200 dark:before:ring-gray-700",background:"before:bg-white dark:before:bg-gray-700"}};({...G_});const EL={...G_,form:"form-select",placeholder:"text-gray-400 dark:text-gray-500",default:{size:"sm",color:"white",variant:"outline",loadingIcon:"i-heroicons-arrow-path-20-solid",trailingIcon:"i-heroicons-chevron-down-20-solid"}},CL={...ub,select:"inline-flex items-center text-left cursor-default",input:"block w-[calc(100%+0.5rem)] focus:ring-transparent text-sm px-3 py-1.5 text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-800 border-0 border-b border-gray-200 dark:border-gray-700 sticky -top-1 -mt-1 mb-1 -mx-1 z-10 placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none",required:"absolute inset-0 w-px opacity-0 cursor-default",label:"block truncate",option:{...ub.option,create:"block truncate"},transition:{leaveActiveClass:"transition ease-in duration-100",leaveFromClass:"opacity-100",leaveToClass:"opacity-0"},popper:{placement:"bottom-end"},default:{selectedIcon:"i-heroicons-check-20-solid",clearSearchOnClose:!1,showCreateOptionWhen:"empty",searchablePlaceholder:{label:"Search..."},empty:{label:"No options."},optionEmpty:{label:'No results for "{query}".'}},arrow:{...uw,ring:"before:ring-1 before:ring-gray-200 dark:before:ring-gray-700",background:"before:bg-white dark:before:bg-gray-700"}},ya=zl(ci.ui.strategy,ci.ui.badge,TL),IL=Ur({components:{UIcon:es},inheritAttrs:!1,props:{size:{type:String,default:()=>ya.default.size,validator(t){return Object.keys(ya.size).includes(t)}},color:{type:String,default:()=>ya.default.color,validator(t){return[...ci.ui.colors,...Object.keys(ya.color)].includes(t)}},variant:{type:String,default:()=>ya.default.variant,validator(t){return[...Object.keys(ya.variant),...Object.values(ya.color).flatMap(n=>Object.keys(n))].includes(t)}},label:{type:[String,Number],default:null},icon:{type:String,default:null},leadingIcon:{type:String,default:null},trailingIcon:{type:String,default:null},trailing:{type:Boolean,default:!1},leading:{type:Boolean,default:!1},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},setup(t){const{ui:n,attrs:l}=Hc("badge",Ko(t,"ui"),ya),{size:h,rounded:p}=Lp({ui:n,props:t}),y=Ye(()=>t.icon&&t.leading||t.icon&&!t.trailing||!t.trailing||t.leadingIcon),m=Ye(()=>t.icon&&t.trailing||t.trailing||t.trailingIcon),a=Ye(()=>{var F,H;const N=((H=(F=n.value.color)==null?void 0:F[t.color])==null?void 0:H[t.variant])||n.value.variant[t.variant];return Il(wi(n.value.base,n.value.font,p.value,n.value.size[h.value],n.value.gap[h.value],N==null?void 0:N.replaceAll("{color}",t.color)),t.class)}),I=Ye(()=>t.leadingIcon||t.icon),z=Ye(()=>t.trailingIcon||t.icon),P=Ye(()=>wi(n.value.icon.base,n.value.icon.size[h.value])),k=Ye(()=>wi(n.value.icon.base,n.value.icon.size[h.value]));return{attrs:l,isLeading:y,isTrailing:m,badgeClass:a,leadingIconName:I,trailingIconName:z,leadingIconClass:P,trailingIconClass:k}}}),ML={key:0};function PL(t,n,l,h,p,y){const m=es;return Bt(),Vr("span",Eo({class:t.badgeClass},t.attrs),[Ai(t.$slots,"leading",{},()=>[t.isLeading&&t.leadingIconName?(Bt(),kr(m,{key:0,name:t.leadingIconName,class:Qt(t.leadingIconClass),"aria-hidden":"true"},null,8,["name","class"])):pi("",!0)]),Ai(t.$slots,"default",{},()=>[t.label?(Bt(),Vr("span",ML,en(t.label),1)):pi("",!0)]),Ai(t.$slots,"trailing",{},()=>[t.isTrailing&&t.trailingIconName?(Bt(),kr(m,{key:0,name:t.trailingIconName,class:Qt(t.trailingIconClass),"aria-hidden":"true"},null,8,["name","class"])):pi("",!0)])],16)}const hw=Qo(IL,[["render",PL]]);function s_(t){return typeof t=="string"?`'${t}'`:new AL().serialize(t)}const AL=function(){var n;class t{constructor(){qv(this,n,new Map)}compare(h,p){const y=typeof h,m=typeof p;return y==="string"&&m==="string"?h.localeCompare(p):y==="number"&&m==="number"?h-p:String.prototype.localeCompare.call(this.serialize(h,!0),this.serialize(p,!0))}serialize(h,p){if(h===null)return"null";switch(typeof h){case"string":return p?h:`'${h}'`;case"bigint":return`${h}n`;case"object":return this.$object(h);case"function":return this.$function(h)}return String(h)}serializeObject(h){const p=Object.prototype.toString.call(h);if(p!=="[object Object]")return this.serializeBuiltInType(p.length<10?`unknown:${p}`:p.slice(8,-1),h);const y=h.constructor,m=y===Object||y===void 0?"":y.name;if(m!==""&&globalThis[m]===y)return this.serializeBuiltInType(m,h);if(typeof h.toJSON=="function"){const a=h.toJSON();return m+(a!==null&&typeof a=="object"?this.$object(a):`(${this.serialize(a)})`)}return this.serializeObjectEntries(m,Object.entries(h))}serializeBuiltInType(h,p){const y=this["$"+h];if(y)return y.call(this,p);if(typeof(p==null?void 0:p.entries)=="function")return this.serializeObjectEntries(h,p.entries());throw new Error(`Cannot serialize ${h}`)}serializeObjectEntries(h,p){const y=Array.from(p).sort((a,I)=>this.compare(a[0],I[0]));let m=`${h}{`;for(let a=0;a<y.length;a++){const[I,z]=y[a];m+=`${this.serialize(I,!0)}:${this.serialize(z)}`,a<y.length-1&&(m+=",")}return m+"}"}$object(h){let p=mh(this,n).get(h);return p===void 0&&(mh(this,n).set(h,`#${mh(this,n).size}`),p=this.serializeObject(h),mh(this,n).set(h,p)),p}$function(h){const p=Function.prototype.toString.call(h);return p.slice(-15)==="[native code] }"?`${h.name||""}()[native]`:`${h.name}(${h.length})${p.replace(/\s*\n\s*/g,"")}`}$Array(h){let p="[";for(let y=0;y<h.length;y++)p+=this.serialize(h[y]),y<h.length-1&&(p+=",");return p+"]"}$Date(h){try{return`Date(${h.toISOString()})`}catch{return"Date(null)"}}$ArrayBuffer(h){return`ArrayBuffer[${new Uint8Array(h).join(",")}]`}$Set(h){return`Set${this.$Array(Array.from(h).sort((p,y)=>this.compare(p,y)))}`}$Map(h){return this.serializeObjectEntries("Map",h.entries())}}n=new WeakMap;for(const l of["Error","RegExp","URL"])t.prototype["$"+l]=function(h){return`${l}(${h})`};for(const l of["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"])t.prototype["$"+l]=function(h){return`${l}[${h.join(",")}]`};for(const l of["BigInt64Array","BigUint64Array"])t.prototype["$"+l]=function(h){return`${l}[${h.join("n,")}${h.length>0?"n":""}]`};return t}();function dp(t,n){return t===n||s_(t)===s_(n)}function kL(t,n){const l=a_(t),h=a_(n);return dw(l,h)}function dw(t,n){var p,y;const l=[],h=new Set([...Object.keys(t.props||{}),...Object.keys(n.props||{})]);if(t.props&&n.props)for(const m of h){const a=t.props[m],I=n.props[m];a&&I?l.push(...dw((p=t.props)==null?void 0:p[m],(y=n.props)==null?void 0:y[m])):(a||I)&&l.push(new hb((I||a).key,a?"removed":"added",I,a))}return h.size===0&&t.hash!==n.hash&&l.push(new hb((n||t).key,"changed",n,t)),l}function a_(t,n=""){if(t&&typeof t!="object")return new db(n,t,s_(t));const l={},h=[];for(const p in t)l[p]=a_(t[p],n?`${n}.${p}`:p),h.push(l[p].hash);return new db(n,t,`{${h.join(":")}}`,l)}class hb{constructor(n,l,h,p){this.key=n,this.type=l,this.newValue=h,this.oldValue=p}toString(){return this.toJSON()}toJSON(){var n;switch(this.type){case"added":return`Added   \`${this.key}\``;case"removed":return`Removed \`${this.key}\``;case"changed":return`Changed \`${this.key}\` from \`${((n=this.oldValue)==null?void 0:n.toString())||"-"}\` to \`${this.newValue.toString()}\``}}}class db{constructor(n,l,h,p){this.key=n,this.value=l,this.hash=h,this.props=p}toString(){return this.props?`{${Object.keys(this.props).join(",")}}`:JSON.stringify(this.value)}toJSON(){const n=this.key||".";return this.props?`${n}({${Object.keys(this.props).join(",")}})`:`${n}(${this.value})`}}const LL=Ur({inheritAttrs:!1,props:{...j_,as:{type:String,default:"button"},type:{type:String,default:"button"},disabled:{type:Boolean,default:null},active:{type:Boolean,default:void 0},exact:{type:Boolean,default:!1},exactQuery:{type:[Boolean,String],default:!1},exactHash:{type:Boolean,default:!1},inactiveClass:{type:String,default:void 0}},setup(t){function n(h,p){const y=kL(h,p).reduce((I,z)=>(z.type==="added"&&I.add(z.key),I),new Set),m=Object.fromEntries(Object.entries(h).filter(([I])=>!y.has(I))),a=Object.fromEntries(Object.entries(p).filter(([I])=>!y.has(I)));return dp(m,a)}function l(h,p,{isActive:y,isExactActive:m}){if(t.exactQuery==="partial"){if(!n(h.query,p.query))return t.inactiveClass}else if(t.exactQuery===!0&&!dp(h.query,p.query))return t.inactiveClass;return t.exactHash&&h.hash!==p.hash?t.inactiveClass:t.exact&&m||!t.exact&&y?t.activeClass:t.inactiveClass}return{resolveLinkClass:l}}}),zL=["href","aria-disabled","role","rel","target","tabindex","onClick"];function RL(t,n,l,h,p,y){const m=sw;return t.to?(Bt(),kr(m,Eo({key:1},t.$props,{custom:""}),{default:Zi(({route:a,href:I,target:z,rel:P,navigate:k,isActive:N,isExactActive:F,isExternal:H})=>[xi("a",Eo(t.$attrs,{href:t.disabled?void 0:I,"aria-disabled":t.disabled?"true":void 0,role:t.disabled?"link":void 0,rel:P,target:z,class:t.active!==void 0?t.active?t.activeClass:t.inactiveClass:t.resolveLinkClass(a,t.$route,{isActive:N,isExactActive:F}),tabindex:t.disabled?-1:void 0,onClick:X=>!H&&!t.disabled&&k(X)}),[Ai(t.$slots,"default",Wf(Zh({isActive:t.active!==void 0?t.active:t.exact?F:N})))],16,zL)]),_:3},16)):(Bt(),kr(Sa(t.as),Eo({key:0,type:t.type,disabled:t.disabled},t.$attrs,{class:t.active?t.activeClass:t.inactiveClass}),{default:Zi(()=>[Ai(t.$slots,"default",Wf(Zh({isActive:t.active})))]),_:3},16,["type","disabled","class"]))}const fw=Qo(LL,[["render",RL]]),Cs=zl(ci.ui.strategy,ci.ui.button,SL),DL=Ur({components:{UIcon:es,ULink:fw},inheritAttrs:!1,props:{...j_,type:{type:String,default:"button"},block:{type:Boolean,default:!1},label:{type:String,default:null},loading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},padded:{type:Boolean,default:!0},size:{type:String,default:()=>Cs.default.size,validator(t){return Object.keys(Cs.size).includes(t)}},color:{type:String,default:()=>Cs.default.color,validator(t){return[...ci.ui.colors,...Object.keys(Cs.color)].includes(t)}},variant:{type:String,default:()=>Cs.default.variant,validator(t){return[...Object.keys(Cs.variant),...Object.values(Cs.color).flatMap(n=>Object.keys(n))].includes(t)}},icon:{type:String,default:null},loadingIcon:{type:String,default:()=>Cs.default.loadingIcon},leadingIcon:{type:String,default:null},trailingIcon:{type:String,default:null},trailing:{type:Boolean,default:!1},leading:{type:Boolean,default:!1},square:{type:Boolean,default:!1},truncate:{type:Boolean,default:!1},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},setup(t,{slots:n}){const{ui:l,attrs:h}=Hc("button",Ko(t,"ui"),Cs),{size:p,rounded:y}=Lp({ui:l,props:t}),m=Ye(()=>t.icon&&t.leading||t.icon&&!t.trailing||t.loading&&!t.trailing||t.leadingIcon),a=Ye(()=>t.icon&&t.trailing||t.loading&&t.trailing||t.trailingIcon),I=Ye(()=>t.square||!n.default&&!t.label),z=Ye(()=>{var ae,Se;const X=((Se=(ae=l.value.color)==null?void 0:ae[t.color])==null?void 0:Se[t.variant])||l.value.variant[t.variant];return Il(wi(l.value.base,l.value.font,y.value,l.value.size[p.value],l.value.gap[p.value],t.padded&&l.value[I.value?"square":"padding"][p.value],X==null?void 0:X.replaceAll("{color}",t.color),t.block?l.value.block:l.value.inline),t.class)}),P=Ye(()=>t.loading?t.loadingIcon:t.leadingIcon||t.icon),k=Ye(()=>t.loading&&!m.value?t.loadingIcon:t.trailingIcon||t.icon),N=Ye(()=>wi(l.value.icon.base,l.value.icon.size[p.value],t.loading&&l.value.icon.loading)),F=Ye(()=>wi(l.value.icon.base,l.value.icon.size[p.value],t.loading&&!m.value&&l.value.icon.loading)),H=Ye(()=>nA(t));return{ui:l,attrs:h,isLeading:m,isTrailing:a,isSquare:I,buttonClass:z,leadingIconName:P,trailingIconName:k,leadingIconClass:N,trailingIconClass:F,linkProps:H}}});function OL(t,n,l,h,p,y){const m=es,a=fw;return Bt(),kr(a,Eo({type:t.type,disabled:t.disabled||t.loading,class:t.buttonClass},{...t.linkProps,...t.attrs}),{default:Zi(()=>[Ai(t.$slots,"leading",{disabled:t.disabled,loading:t.loading},()=>[t.isLeading&&t.leadingIconName?(Bt(),kr(m,{key:0,name:t.leadingIconName,class:Qt(t.leadingIconClass),"aria-hidden":"true"},null,8,["name","class"])):pi("",!0)]),Ai(t.$slots,"default",{},()=>[t.label?(Bt(),Vr("span",{key:0,class:Qt([t.truncate?t.ui.truncate:""])},en(t.label),3)):pi("",!0)]),Ai(t.$slots,"trailing",{disabled:t.disabled,loading:t.loading},()=>[t.isTrailing&&t.trailingIconName?(Bt(),kr(m,{key:0,name:t.trailingIconName,class:Qt(t.trailingIconClass),"aria-hidden":"true"},null,8,["name","class"])):pi("",!0)])]),_:3},16,["type","disabled","class"])}const pw=Qo(DL,[["render",OL]]),mw=()=>U1("color-mode").value,FL={class:"px-4 flex items-center border-b border-gray-200 dark:border-gray-800"},BL={class:"app-logo flex items-center"},jL=Ur({__name:"AppHeader",setup(t){const n=mw(),l=$t(""),h=Ye(()=>n.preference==="light"?"i-heroicons-sun":"i-heroicons-moon-16-solid");function p(){n.preference=n.preference==="light"?"dark":"light"}return Sn(()=>{fetch("https://api.github.com/repos/qazsato/japanmesh/releases/latest").then(m=>m.json()).then(m=>{l.value=m.tag_name})}),(y,m)=>{const a=sw,I=hw,z=pw;return Bt(),Vr("header",FL,[xi("div",BL,[cr(a,{to:"/"},{default:Zi(()=>m[0]||(m[0]=[xi("h1",null,"japanmesh",-1)])),_:1}),gr(l)?(Bt(),kr(I,{key:0,label:gr(l),variant:"outline",color:"primary",size:"xs",class:"mx-2"},null,8,["label"])):pi("",!0)]),m[1]||(m[1]=xi("div",{class:"grow"},null,-1)),cr(z,{icon:gr(h),size:"sm",color:"gray",square:"",variant:"ghost",onClick:p,class:"mx-1"},null,8,["icon"]),cr(z,{icon:"i-simple-icons-npm",size:"sm",color:"gray",square:"",variant:"ghost",to:"https://www.npmjs.com/package/japanmesh",target:"_blank",class:"mx-1"}),cr(z,{icon:"i-simple-icons-github",size:"sm",color:"gray",square:"",variant:"ghost",to:"https://github.com/qazsato/geo-docs",target:"_blank",class:"mx-1"})])}}}),NL=Qo(jL,[["__scopeId","data-v-82e603f3"]]),gw=(t,n,l=!0)=>{const h=nn("form-events",void 0),p=nn("form-group",void 0),y=nn("form-inputs",void 0);p&&(!l||t!=null&&t.legend?p.inputId.value=void 0:t!=null&&t.id&&(p.inputId.value=t==null?void 0:t.id),y&&(y.value[p.name.value]=p.inputId.value));const m=$t(!1);function a(k,N){h&&h.emit({type:k,path:N})}function I(){a("blur",p==null?void 0:p.name.value),m.value=!0}function z(){a("change",p==null?void 0:p.name.value)}const P=O1(()=>{(m.value||p!=null&&p.eagerValidation.value)&&a("input",p==null?void 0:p.name.value)},300);return{inputId:Ye(()=>(t==null?void 0:t.id)??(p==null?void 0:p.inputId.value)),name:Ye(()=>(t==null?void 0:t.name)??(p==null?void 0:p.name.value)),size:Ye(()=>{var N;const k=n.size[p==null?void 0:p.size.value]?p==null?void 0:p.size.value:null;return(t==null?void 0:t.size)??k??((N=n.default)==null?void 0:N.size)}),color:Ye(()=>{var k;return(k=p==null?void 0:p.error)!=null&&k.value?"red":t==null?void 0:t.color}),emitFormBlur:I,emitFormInput:P,emitFormChange:z}},Is=zl(ci.ui.strategy,ci.ui.input,G_),VL=Ur({components:{UIcon:es},inheritAttrs:!1,props:{modelValue:{type:[String,Number],default:""},type:{type:String,default:"text"},id:{type:String,default:null},name:{type:String,default:null},placeholder:{type:String,default:null},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},autofocus:{type:Boolean,default:!1},autofocusDelay:{type:Number,default:100},icon:{type:String,default:null},loadingIcon:{type:String,default:()=>Is.default.loadingIcon},leadingIcon:{type:String,default:null},trailingIcon:{type:String,default:null},trailing:{type:Boolean,default:!1},leading:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},padded:{type:Boolean,default:!0},size:{type:String,default:null,validator(t){return Object.keys(Is.size).includes(t)}},color:{type:String,default:()=>Is.default.color,validator(t){return[...ci.ui.colors,...Object.keys(Is.color)].includes(t)}},variant:{type:String,default:()=>Is.default.variant,validator(t){return[...Object.keys(Is.variant),...Object.values(Is.color).flatMap(n=>Object.keys(n))].includes(t)}},inputClass:{type:String,default:null},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})},modelModifiers:{type:Object,default:()=>({})}},emits:["update:modelValue","blur","change"],setup(t,{emit:n,slots:l}){const{ui:h,attrs:p}=Hc("input",Ko(t,"ui"),Is,Ko(t,"class")),{size:y,rounded:m}=Lp({ui:h,props:t}),{emitFormBlur:a,emitFormInput:I,size:z,color:P,inputId:k,name:N}=gw(t,Is),F=Ye(()=>y.value??z.value),H=$t(rd({},t.modelModifiers,{trim:!1,lazy:!1,number:!1,nullify:!1})),X=$t(null),ae=()=>{var it;t.autofocus&&((it=X.value)==null||it.focus())},Se=it=>{H.value.trim&&(it=it.trim()),(H.value.number||t.type==="number")&&(it=aA(it)),H.value.nullify&&(it||(it=null)),n("update:modelValue",it),I()},be=it=>{H.value.lazy||Se(it.target.value)},Q=it=>{if(t.type==="file"){const vt=it.target.files;n("change",vt)}else{const vt=it.target.value;n("change",vt),H.value.lazy&&Se(vt),H.value.trim&&(it.target.value=vt.trim())}},re=it=>{a(),n("blur",it)};Sn(()=>{setTimeout(()=>{ae()},t.autofocusDelay)});const J=Ye(()=>{var vt,Xe;const it=((Xe=(vt=h.value.color)==null?void 0:vt[P.value])==null?void 0:Xe[t.variant])||h.value.variant[t.variant];return Il(wi(h.value.base,h.value.form,m.value,h.value.placeholder,t.type==="file"&&h.value.file.base,h.value.size[F.value],t.padded?h.value.padding[F.value]:"p-0",it==null?void 0:it.replaceAll("{color}",P.value),(le.value||l.leading)&&h.value.leading.padding[F.value],(Me.value||l.trailing)&&h.value.trailing.padding[F.value]),t.inputClass)}),le=Ye(()=>t.icon&&t.leading||t.icon&&!t.trailing||t.loading&&!t.trailing||t.leadingIcon),Me=Ye(()=>t.icon&&t.trailing||t.loading&&t.trailing||t.trailingIcon),Ie=Ye(()=>t.loading?t.loadingIcon:t.leadingIcon||t.icon),Be=Ye(()=>t.loading&&!le.value?t.loadingIcon:t.trailingIcon||t.icon),Ee=Ye(()=>wi(h.value.icon.leading.wrapper,h.value.icon.leading.pointer,h.value.icon.leading.padding[F.value])),Re=Ye(()=>wi(h.value.icon.base,P.value&&ci.ui.colors.includes(P.value)&&h.value.icon.color.replaceAll("{color}",P.value),h.value.icon.size[F.value],t.loading&&h.value.icon.loading)),Ae=Ye(()=>wi(h.value.icon.trailing.wrapper,h.value.icon.trailing.pointer,h.value.icon.trailing.padding[F.value])),He=Ye(()=>wi(h.value.icon.base,P.value&&ci.ui.colors.includes(P.value)&&h.value.icon.color.replaceAll("{color}",P.value),h.value.icon.size[F.value],t.loading&&!le.value&&h.value.icon.loading));return{ui:h,attrs:p,name:N,inputId:k,input:X,isLeading:le,isTrailing:Me,inputClass:J,leadingIconName:Ie,leadingIconClass:Re,leadingWrapperIconClass:Ee,trailingIconName:Be,trailingIconClass:He,trailingWrapperIconClass:Ae,onInput:be,onChange:Q,onBlur:re}}}),$L=["id","name","type","required","placeholder","disabled"];function UL(t,n,l,h,p,y){const m=es;return Bt(),Vr("div",{class:Qt(t.type==="hidden"?"hidden":t.ui.wrapper)},[xi("input",Eo({id:t.inputId,ref:"input",name:t.name,type:t.type,required:t.required,placeholder:t.placeholder,disabled:t.disabled,class:t.inputClass},t.type==="file"?t.attrs:{...t.attrs,value:t.modelValue},{onInput:n[0]||(n[0]=(...a)=>t.onInput&&t.onInput(...a)),onBlur:n[1]||(n[1]=(...a)=>t.onBlur&&t.onBlur(...a)),onChange:n[2]||(n[2]=(...a)=>t.onChange&&t.onChange(...a))}),null,16,$L),Ai(t.$slots,"default"),t.isLeading&&t.leadingIconName||t.$slots.leading?(Bt(),Vr("span",{key:0,class:Qt(t.leadingWrapperIconClass)},[Ai(t.$slots,"leading",{disabled:t.disabled,loading:t.loading},()=>[cr(m,{name:t.leadingIconName,class:Qt(t.leadingIconClass)},null,8,["name","class"])])],2)):pi("",!0),t.isTrailing&&t.trailingIconName||t.$slots.trailing?(Bt(),Vr("span",{key:1,class:Qt(t.trailingWrapperIconClass)},[Ai(t.$slots,"trailing",{disabled:t.disabled,loading:t.loading},()=>[cr(m,{name:t.trailingIconName,class:Qt(t.trailingIconClass)},null,8,["name","class"])])],2)):pi("",!0)],2)}const GL=Qo(VL,[["render",UL]]),pl=zl(ci.ui.strategy,ci.ui.avatar,wL),ZL=Ur({components:{UIcon:es},inheritAttrs:!1,props:{as:{type:[String,Object],default:"img"},src:{type:[String,Boolean],default:null},alt:{type:String,default:null},text:{type:String,default:null},icon:{type:String,default:()=>pl.default.icon},size:{type:String,default:()=>pl.default.size,validator(t){return Object.keys(pl.size).includes(t)}},chipColor:{type:String,default:()=>pl.default.chipColor,validator(t){return["gray",...ci.ui.colors].includes(t)}},chipPosition:{type:String,default:()=>pl.default.chipPosition,validator(t){return Object.keys(pl.chip.position).includes(t)}},chipText:{type:[String,Number],default:null},imgClass:{type:String,default:""},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},setup(t){const{ui:n,attrs:l}=Hc("avatar",Ko(t,"ui"),pl),h=Ye(()=>typeof t.src=="boolean"?null:t.src),p=Ye(()=>(t.alt||"").split(" ").map(k=>k.charAt(0)).join("").substring(0,2)),y=Ye(()=>Il(wi(n.value.wrapper,(z.value||!h.value)&&n.value.background,n.value.rounded,n.value.size[t.size]),t.class)),m=Ye(()=>Il(wi(n.value.rounded,n.value.size[t.size]),t.imgClass)),a=Ye(()=>wi(n.value.icon.base,n.value.icon.size[t.size])),I=Ye(()=>wi(n.value.chip.base,n.value.chip.size[t.size],n.value.chip.position[t.chipPosition],n.value.chip.background.replaceAll("{color}",t.chipColor))),z=$t(!1);Li(()=>t.src,()=>{z.value&&(z.value=!1)});function P(){z.value=!0}return{ui:n,attrs:l,wrapperClass:y,imgClass:m,iconClass:a,chipClass:I,url:h,placeholder:p,error:z,onError:P}}});function qL(t,n,l,h,p,y){const m=es;return Bt(),Vr("span",{class:Qt(t.wrapperClass)},[t.url&&!t.error?(Bt(),kr(Sa(t.as),Eo({key:0,class:t.imgClass,alt:t.alt,src:t.url},t.attrs,{onError:t.onError}),null,16,["class","alt","src","onError"])):t.text?(Bt(),Vr("span",{key:1,class:Qt(t.ui.text)},en(t.text),3)):t.icon?(Bt(),kr(m,{key:2,name:t.icon,class:Qt(t.iconClass)},null,8,["name","class"])):t.placeholder?(Bt(),Vr("span",{key:3,class:Qt(t.ui.placeholder)},en(t.placeholder),3)):pi("",!0),t.chipColor?(Bt(),Vr("span",{key:4,class:Qt(t.chipClass)},en(t.chipText),3)):pi("",!0),Ai(t.$slots,"default")],2)}const _w=Qo(ZL,[["render",qL]]);function kc(t,n,l){let h=l.initialDeps??[],p;function y(){var m,a,I,z;let P;l.key&&((m=l.debug)!=null&&m.call(l))&&(P=Date.now());const k=t();if(!(k.length!==h.length||k.some((H,X)=>h[X]!==H)))return p;h=k;let F;if(l.key&&((a=l.debug)!=null&&a.call(l))&&(F=Date.now()),p=n(...k),l.key&&((I=l.debug)!=null&&I.call(l))){const H=Math.round((Date.now()-P)*100)/100,X=Math.round((Date.now()-F)*100)/100,ae=X/16,Se=(be,Q)=>{for(be=String(be);be.length<Q;)be=" "+be;return be};console.info(`%c ${Se(X,5)} /${Se(H,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*ae,120))}deg 100% 31%);`,l==null?void 0:l.key)}return(z=l==null?void 0:l.onChange)==null||z.call(l,p),p}return y.updateDeps=m=>{h=m},y}function yg(t,n){if(t===void 0)throw new Error("Unexpected undefined");return t}const HL=(t,n)=>Math.abs(t-n)<1,WL=(t,n,l)=>{let h;return function(...p){t.clearTimeout(h),h=t.setTimeout(()=>n.apply(this,p),l)}},KL=t=>t,XL=t=>{const n=Math.max(t.startIndex-t.overscan,0),l=Math.min(t.endIndex+t.overscan,t.count-1),h=[];for(let p=n;p<=l;p++)h.push(p);return h},YL=(t,n)=>{const l=t.scrollElement;if(!l)return;const h=t.targetWindow;if(!h)return;const p=m=>{const{width:a,height:I}=m;n({width:Math.round(a),height:Math.round(I)})};if(p(l.getBoundingClientRect()),!h.ResizeObserver)return()=>{};const y=new h.ResizeObserver(m=>{const a=()=>{const I=m[0];if(I!=null&&I.borderBoxSize){const z=I.borderBoxSize[0];if(z){p({width:z.inlineSize,height:z.blockSize});return}}p(l.getBoundingClientRect())};t.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(a):a()});return y.observe(l,{box:"border-box"}),()=>{y.unobserve(l)}},fb={passive:!0},pb=typeof window>"u"?!0:"onscrollend"in window,JL=(t,n)=>{const l=t.scrollElement;if(!l)return;const h=t.targetWindow;if(!h)return;let p=0;const y=t.options.useScrollendEvent&&pb?()=>{}:WL(h,()=>{n(p,!1)},t.options.isScrollingResetDelay),m=P=>()=>{const{horizontal:k,isRtl:N}=t.options;p=k?l.scrollLeft*(N&&-1||1):l.scrollTop,y(),n(p,P)},a=m(!0),I=m(!1);I(),l.addEventListener("scroll",a,fb);const z=t.options.useScrollendEvent&&pb;return z&&l.addEventListener("scrollend",I,fb),()=>{l.removeEventListener("scroll",a),z&&l.removeEventListener("scrollend",I)}},QL=(t,n,l)=>{if(n!=null&&n.borderBoxSize){const h=n.borderBoxSize[0];if(h)return Math.round(h[l.options.horizontal?"inlineSize":"blockSize"])}return Math.round(t.getBoundingClientRect()[l.options.horizontal?"width":"height"])},ez=(t,{adjustments:n=0,behavior:l},h)=>{var p,y;const m=t+n;(y=(p=h.scrollElement)==null?void 0:p.scrollTo)==null||y.call(p,{[h.options.horizontal?"left":"top"]:m,behavior:l})};class tz{constructor(n){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let l=null;const h=()=>l||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:l=new this.targetWindow.ResizeObserver(p=>{p.forEach(y=>{const m=()=>{this._measureElement(y.target,y)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(m):m()})}));return{disconnect:()=>{var p;(p=h())==null||p.disconnect(),l=null},observe:p=>{var y;return(y=h())==null?void 0:y.observe(p,{box:"border-box"})},unobserve:p=>{var y;return(y=h())==null?void 0:y.unobserve(p)}}})(),this.range=null,this.setOptions=l=>{Object.entries(l).forEach(([h,p])=>{typeof p>"u"&&delete l[h]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:KL,rangeExtractor:XL,onChange:()=>{},measureElement:QL,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...l}},this.notify=l=>{var h,p;(p=(h=this.options).onChange)==null||p.call(h,this,l)},this.maybeNotify=kc(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),l=>{this.notify(l)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(l=>l()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var l;const h=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==h){if(this.cleanup(),!h){this.maybeNotify();return}this.scrollElement=h,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((l=this.scrollElement)==null?void 0:l.window)??null,this.elementsCache.forEach(p=>{this.observer.observe(p)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,p=>{this.scrollRect=p,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(p,y)=>{this.scrollAdjustments=0,this.scrollDirection=y?this.getScrollOffset()<p?"forward":"backward":null,this.scrollOffset=p,this.isScrolling=y,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(l,h)=>{const p=new Map,y=new Map;for(let m=h-1;m>=0;m--){const a=l[m];if(p.has(a.lane))continue;const I=y.get(a.lane);if(I==null||a.end>I.end?y.set(a.lane,a):a.end<I.end&&p.set(a.lane,!0),p.size===this.options.lanes)break}return y.size===this.options.lanes?Array.from(y.values()).sort((m,a)=>m.end===a.end?m.index-a.index:m.end-a.end)[0]:void 0},this.getMeasurementOptions=kc(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(l,h,p,y,m)=>(this.pendingMeasuredCacheIndexes=[],{count:l,paddingStart:h,scrollMargin:p,getItemKey:y,enabled:m}),{key:!1}),this.getMeasurements=kc(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:l,paddingStart:h,scrollMargin:p,getItemKey:y,enabled:m},a)=>{if(!m)return this.measurementsCache=[],this.itemSizeCache.clear(),[];this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(P=>{this.itemSizeCache.set(P.key,P.size)}));const I=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const z=this.measurementsCache.slice(0,I);for(let P=I;P<l;P++){const k=y(P),N=this.options.lanes===1?z[P-1]:this.getFurthestMeasurement(z,P),F=N?N.end+this.options.gap:h+p,H=a.get(k),X=typeof H=="number"?H:this.options.estimateSize(P),ae=F+X,Se=N?N.lane:P%this.options.lanes;z[P]={index:P,start:F,size:X,end:ae,key:k,lane:Se}}return this.measurementsCache=z,z},{key:!1,debug:()=>this.options.debug}),this.calculateRange=kc(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(l,h,p,y)=>this.range=l.length>0&&h>0?rz({measurements:l,outerSize:h,scrollOffset:p,lanes:y}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=kc(()=>{let l=null,h=null;const p=this.calculateRange();return p&&(l=p.startIndex,h=p.endIndex),this.maybeNotify.updateDeps([this.isScrolling,l,h]),[this.options.rangeExtractor,this.options.overscan,this.options.count,l,h]},(l,h,p,y,m)=>y===null||m===null?[]:l({startIndex:y,endIndex:m,overscan:h,count:p}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=l=>{const h=this.options.indexAttribute,p=l.getAttribute(h);return p?parseInt(p,10):(console.warn(`Missing attribute name '${h}={index}' on measured element.`),-1)},this._measureElement=(l,h)=>{const p=this.indexFromElement(l),y=this.measurementsCache[p];if(!y)return;const m=y.key,a=this.elementsCache.get(m);a!==l&&(a&&this.observer.unobserve(a),this.observer.observe(l),this.elementsCache.set(m,l)),l.isConnected&&this.resizeItem(p,this.options.measureElement(l,h,this))},this.resizeItem=(l,h)=>{const p=this.measurementsCache[l];if(!p)return;const y=this.itemSizeCache.get(p.key)??p.size,m=h-y;m!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(p,m,this):p.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=m,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(p.index),this.itemSizeCache=new Map(this.itemSizeCache.set(p.key,h)),this.notify(!1))},this.measureElement=l=>{if(!l){this.elementsCache.forEach((h,p)=>{h.isConnected||(this.observer.unobserve(h),this.elementsCache.delete(p))});return}this._measureElement(l,void 0)},this.getVirtualItems=kc(()=>[this.getVirtualIndexes(),this.getMeasurements()],(l,h)=>{const p=[];for(let y=0,m=l.length;y<m;y++){const a=l[y],I=h[a];p.push(I)}return p},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=l=>{const h=this.getMeasurements();if(h.length!==0)return yg(h[yw(0,h.length-1,p=>yg(h[p]).start,l)])},this.getOffsetForAlignment=(l,h,p=0)=>{const y=this.getSize(),m=this.getScrollOffset();h==="auto"&&(h=l>=m+y?"end":"start"),h==="center"?l+=(p-y)/2:h==="end"&&(l-=y);const a=this.options.horizontal?"scrollWidth":"scrollHeight",z=(this.scrollElement?"document"in this.scrollElement?this.scrollElement.document.documentElement[a]:this.scrollElement[a]:0)-y;return Math.max(Math.min(z,l),0)},this.getOffsetForIndex=(l,h="auto")=>{l=Math.max(0,Math.min(l,this.options.count-1));const p=this.measurementsCache[l];if(!p)return;const y=this.getSize(),m=this.getScrollOffset();if(h==="auto")if(p.end>=m+y-this.options.scrollPaddingEnd)h="end";else if(p.start<=m+this.options.scrollPaddingStart)h="start";else return[m,h];const a=h==="end"?p.end+this.options.scrollPaddingEnd:p.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(a,h,p.size),h]},this.isDynamicMode=()=>this.elementsCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&this.targetWindow&&(this.targetWindow.clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(l,{align:h="start",behavior:p}={})=>{this.cancelScrollToIndex(),p==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(l,h),{adjustments:void 0,behavior:p})},this.scrollToIndex=(l,{align:h="auto",behavior:p}={})=>{l=Math.max(0,Math.min(l,this.options.count-1)),this.cancelScrollToIndex(),p==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const y=this.getOffsetForIndex(l,h);if(!y)return;const[m,a]=y;this._scrollToOffset(m,{adjustments:void 0,behavior:p}),p!=="smooth"&&this.isDynamicMode()&&this.targetWindow&&(this.scrollToIndexTimeoutId=this.targetWindow.setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.elementsCache.has(this.options.getItemKey(l))){const[z]=yg(this.getOffsetForIndex(l,a));HL(z,this.getScrollOffset())||this.scrollToIndex(l,{align:a,behavior:p})}else this.scrollToIndex(l,{align:a,behavior:p})}))},this.scrollBy=(l,{behavior:h}={})=>{this.cancelScrollToIndex(),h==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+l,{adjustments:void 0,behavior:h})},this.getTotalSize=()=>{var l;const h=this.getMeasurements();let p;if(h.length===0)p=this.options.paddingStart;else if(this.options.lanes===1)p=((l=h[h.length-1])==null?void 0:l.end)??0;else{const y=Array(this.options.lanes).fill(null);let m=h.length-1;for(;m>0&&y.some(a=>a===null);){const a=h[m];y[a.lane]===null&&(y[a.lane]=a.end),m--}p=Math.max(...y.filter(a=>a!==null))}return Math.max(p-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(l,{adjustments:h,behavior:p})=>{this.options.scrollToFn(l,{behavior:p,adjustments:h},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(n)}}const yw=(t,n,l,h)=>{for(;t<=n;){const p=(t+n)/2|0,y=l(p);if(y<h)t=p+1;else if(y>h)n=p-1;else return p}return t>0?t-1:0};function rz({measurements:t,outerSize:n,scrollOffset:l,lanes:h}){const p=t.length-1,y=I=>t[I].start;if(t.length<=h)return{startIndex:0,endIndex:p};let m=yw(0,p,y,l),a=m;if(h===1)for(;a<p&&t[a].end<l+n;)a++;else if(h>1){const I=Array(h).fill(0);for(;a<p&&I.some(P=>P<l+n);){const P=t[a];I[P.lane]=P.end,a++}const z=Array(h).fill(l+n);for(;m>0&&z.some(P=>P>=l);){const P=t[m];z[P.lane]=P.start,m--}m=Math.max(0,m-m%h),a=Math.min(p,a+(h-1-a%h))}return{startIndex:m,endIndex:a}}function iz(t){const n=new tz(gr(t)),l=El(n),h=n._didMount();return Li(()=>gr(t).getScrollElement(),p=>{p&&n._willUpdate()},{immediate:!0}),Li(()=>gr(t),p=>{n.setOptions({...p,onChange:(y,m)=>{var a;Xv(l),(a=p.onChange)==null||a.call(p,y,m)}}),n._willUpdate(),Xv(l)},{immediate:!0}),yS(h),l}function nz(t){return iz(Ye(()=>({observeElementRect:YL,observeElementOffset:JL,scrollToFn:ez,...gr(t)})))}function vw(t,n,l){let h=$t(l==null?void 0:l.value),p=Ye(()=>t.value!==void 0);return[Ye(()=>p.value?t.value:h.value),function(y){return p.value||(h.value=y),n==null?void 0:n(y)}]}function oz(t){typeof queueMicrotask=="function"?queueMicrotask(t):Promise.resolve().then(t).catch(n=>setTimeout(()=>{throw n}))}function fp(){let t=[],n={addEventListener(l,h,p,y){return l.addEventListener(h,p,y),n.add(()=>l.removeEventListener(h,p,y))},requestAnimationFrame(...l){let h=requestAnimationFrame(...l);n.add(()=>cancelAnimationFrame(h))},nextFrame(...l){n.requestAnimationFrame(()=>{n.requestAnimationFrame(...l)})},setTimeout(...l){let h=setTimeout(...l);n.add(()=>clearTimeout(h))},microTask(...l){let h={current:!0};return oz(()=>{h.current&&l[0]()}),n.add(()=>{h.current=!1})},style(l,h,p){let y=l.style.getPropertyValue(h);return Object.assign(l.style,{[h]:p}),this.add(()=>{Object.assign(l.style,{[h]:y})})},group(l){let h=fp();return l(h),this.add(()=>h.dispose())},add(l){return t.push(l),()=>{let h=t.indexOf(l);if(h>=0)for(let p of t.splice(h,1))p()}},dispose(){for(let l of t.splice(0))l()}};return n}function sz(){let t=fp();return Qc(()=>t.dispose()),t}function az(){let t=sz();return n=>{t.dispose(),t.nextFrame(n)}}var mb;let bw=Symbol("headlessui.useid"),lz=0;const Rl=(mb=wx)!=null?mb:function(){return nn(bw,()=>`${++lz}`)()};function cz(t){Pa(bw,t)}function Xt(t){var n;if(t==null||t.value==null)return null;let l=(n=t.value.$el)!=null?n:t.value;return l instanceof Node?l:null}function rn(t,n,...l){if(t in n){let p=n[t];return typeof p=="function"?p(...l):p}let h=new Error(`Tried to handle "${t}" but there is no handler defined. Only defined handlers are: ${Object.keys(n).map(p=>`"${p}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(h,rn),h}var uz=Object.defineProperty,hz=(t,n,l)=>n in t?uz(t,n,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[n]=l,gb=(t,n,l)=>(hz(t,typeof n!="symbol"?n+"":n,l),l);let dz=class{constructor(){gb(this,"current",this.detect()),gb(this,"currentId",0)}set(n){this.current!==n&&(this.currentId=0,this.current=n)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window>"u"||typeof document>"u"?"server":"client"}},Z_=new dz;function q_(t){if(Z_.isServer)return null;if(t instanceof Node)return t.ownerDocument;if(t!=null&&t.hasOwnProperty("value")){let n=Xt(t);if(n)return n.ownerDocument}return document}let _b=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(t=>`${t}:not([tabindex='-1'])`).join(",");var fz=(t=>(t[t.First=1]="First",t[t.Previous=2]="Previous",t[t.Next=4]="Next",t[t.Last=8]="Last",t[t.WrapAround=16]="WrapAround",t[t.NoScroll=32]="NoScroll",t))(fz||{}),pz=(t=>(t[t.Error=0]="Error",t[t.Overflow=1]="Overflow",t[t.Success=2]="Success",t[t.Underflow=3]="Underflow",t))(pz||{}),mz=(t=>(t[t.Previous=-1]="Previous",t[t.Next=1]="Next",t))(mz||{}),H_=(t=>(t[t.Strict=0]="Strict",t[t.Loose=1]="Loose",t))(H_||{});function xw(t,n=0){var l;return t===((l=q_(t))==null?void 0:l.body)?!1:rn(n,{0(){return t.matches(_b)},1(){let h=t;for(;h!==null;){if(h.matches(_b))return!0;h=h.parentElement}return!1}})}var gz=(t=>(t[t.Keyboard=0]="Keyboard",t[t.Mouse=1]="Mouse",t))(gz||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",t=>{t.metaKey||t.altKey||t.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",t=>{t.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:t.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));function ww(t,n=l=>l){return t.slice().sort((l,h)=>{let p=n(l),y=n(h);if(p===null||y===null)return 0;let m=p.compareDocumentPosition(y);return m&Node.DOCUMENT_POSITION_FOLLOWING?-1:m&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function _z(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function yz(){return/Android/gi.test(window.navigator.userAgent)}function Tw(){return _z()||yz()}function Of(t,n,l){Z_.isServer||lo(h=>{document.addEventListener(t,n,l),h(()=>document.removeEventListener(t,n,l))})}function vz(t,n,l){Z_.isServer||lo(h=>{window.addEventListener(t,n,l),h(()=>window.removeEventListener(t,n,l))})}function Sw(t,n,l=Ye(()=>!0)){function h(y,m){if(!l.value||y.defaultPrevented)return;let a=m(y);if(a===null||!a.getRootNode().contains(a))return;let I=function z(P){return typeof P=="function"?z(P()):Array.isArray(P)||P instanceof Set?P:[P]}(t);for(let z of I){if(z===null)continue;let P=z instanceof HTMLElement?z:Xt(z);if(P!=null&&P.contains(a)||y.composed&&y.composedPath().includes(P))return}return!xw(a,H_.Loose)&&a.tabIndex!==-1&&y.preventDefault(),n(y,a)}let p=$t(null);Of("pointerdown",y=>{var m,a;l.value&&(p.value=((a=(m=y.composedPath)==null?void 0:m.call(y))==null?void 0:a[0])||y.target)},!0),Of("mousedown",y=>{var m,a;l.value&&(p.value=((a=(m=y.composedPath)==null?void 0:m.call(y))==null?void 0:a[0])||y.target)},!0),Of("click",y=>{Tw()||p.value&&(h(y,()=>p.value),p.value=null)},!0),Of("touchend",y=>h(y,()=>y.target instanceof HTMLElement?y.target:null),!0),vz("blur",y=>h(y,()=>window.document.activeElement instanceof HTMLIFrameElement?window.document.activeElement:null),!0)}function yb(t,n){if(t)return t;let l=n??"button";if(typeof l=="string"&&l.toLowerCase()==="button")return"button"}function Ew(t,n){let l=$t(yb(t.value.type,t.value.as));return Sn(()=>{l.value=yb(t.value.type,t.value.as)}),lo(()=>{var h;l.value||Xt(n)&&Xt(n)instanceof HTMLButtonElement&&!((h=Xt(n))!=null&&h.hasAttribute("type"))&&(l.value="button")}),l}function vb(t){return[t.screenX,t.screenY]}function Cw(){let t=$t([-1,-1]);return{wasMoved(n){let l=vb(n);return t.value[0]===l[0]&&t.value[1]===l[1]?!1:(t.value=l,!0)},update(n){t.value=vb(n)}}}function bz({container:t,accept:n,walk:l,enabled:h}){lo(()=>{let p=t.value;if(!p||h!==void 0&&!h.value)return;let y=q_(t);if(!y)return;let m=Object.assign(I=>n(I),{acceptNode:n}),a=y.createTreeWalker(p,NodeFilter.SHOW_ELEMENT,m,!1);for(;a.nextNode();)l(a.currentNode)})}var Pl=(t=>(t[t.None=0]="None",t[t.RenderStrategy=1]="RenderStrategy",t[t.Static=2]="Static",t))(Pl||{}),xz=(t=>(t[t.Unmount=0]="Unmount",t[t.Hidden=1]="Hidden",t))(xz||{});function ts({visible:t=!0,features:n=0,ourProps:l,theirProps:h,...p}){var y;let m=Mw(h,l),a=Object.assign(p,{props:m});if(t||n&2&&m.static)return vg(a);if(n&1){let I=(y=m.unmount)==null||y?0:1;return rn(I,{0(){return null},1(){return vg({...p,props:{...m,hidden:!0,style:{display:"none"}}})}})}return vg(a)}function vg({props:t,attrs:n,slots:l,slot:h,name:p}){var y,m;let{as:a,...I}=nd(t,["unmount","static"]),z=(y=l.default)==null?void 0:y.call(l,h),P={};if(h){let k=!1,N=[];for(let[F,H]of Object.entries(h))typeof H=="boolean"&&(k=!0),H===!0&&N.push(F);k&&(P["data-headlessui-state"]=N.join(" "))}if(a==="template"){if(z=Iw(z??[]),Object.keys(I).length>0||Object.keys(n).length>0){let[k,...N]=z??[];if(!wz(k)||N.length>0)throw new Error(['Passing props on "template"!',"",`The current component <${p} /> is rendering a "template".`,"However we need to passthrough the following props:",Object.keys(I).concat(Object.keys(n)).map(X=>X.trim()).filter((X,ae,Se)=>Se.indexOf(X)===ae).sort((X,ae)=>X.localeCompare(ae)).map(X=>`  - ${X}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "template".',"Render a single element as the child so that we can forward the props onto that element."].map(X=>`  - ${X}`).join(`
`)].join(`
`));let F=Mw((m=k.props)!=null?m:{},I,P),H=Yo(k,F,!0);for(let X in F)X.startsWith("on")&&(H.props||(H.props={}),H.props[X]=F[X]);return H}return Array.isArray(z)&&z.length===1?z[0]:z}return pn(a,Object.assign({},I,P),{default:()=>z})}function Iw(t){return t.flatMap(n=>n.type===ki?Iw(n.children):[n])}function Mw(...t){if(t.length===0)return{};if(t.length===1)return t[0];let n={},l={};for(let h of t)for(let p in h)p.startsWith("on")&&typeof h[p]=="function"?(l[p]!=null||(l[p]=[]),l[p].push(h[p])):n[p]=h[p];if(n.disabled||n["aria-disabled"])return Object.assign(n,Object.fromEntries(Object.keys(l).map(h=>[h,void 0])));for(let h in l)Object.assign(n,{[h](p,...y){let m=l[h];for(let a of m){if(p instanceof Event&&p.defaultPrevented)return;a(p,...y)}}});return n}function Pw(t){let n=Object.assign({},t);for(let l in n)n[l]===void 0&&delete n[l];return n}function nd(t,n=[]){let l=Object.assign({},t);for(let h of n)h in l&&delete l[h];return l}function wz(t){return t==null?!1:typeof t.type=="string"||typeof t.type=="object"||typeof t.type=="function"}var W_=(t=>(t[t.None=1]="None",t[t.Focusable=2]="Focusable",t[t.Hidden=4]="Hidden",t))(W_||{});let Aw=Ur({name:"Hidden",props:{as:{type:[Object,String],default:"div"},features:{type:Number,default:1}},setup(t,{slots:n,attrs:l}){return()=>{var h;let{features:p,...y}=t,m={"aria-hidden":(p&2)===2?!0:(h=y["aria-hidden"])!=null?h:void 0,hidden:(p&4)===4?!0:void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...(p&4)===4&&(p&2)!==2&&{display:"none"}}};return ts({ourProps:m,theirProps:y,slot:{},attrs:l,slots:n,name:"Hidden"})}}}),kw=Symbol("Context");var ks=(t=>(t[t.Open=1]="Open",t[t.Closed=2]="Closed",t[t.Closing=4]="Closing",t[t.Opening=8]="Opening",t))(ks||{});function Lw(){return nn(kw,null)}function zw(t){Pa(kw,t)}var Ir=(t=>(t.Space=" ",t.Enter="Enter",t.Escape="Escape",t.Backspace="Backspace",t.Delete="Delete",t.ArrowLeft="ArrowLeft",t.ArrowUp="ArrowUp",t.ArrowRight="ArrowRight",t.ArrowDown="ArrowDown",t.Home="Home",t.End="End",t.PageUp="PageUp",t.PageDown="PageDown",t.Tab="Tab",t))(Ir||{}),Rw=(t=>(t[t.Left=0]="Left",t[t.Right=2]="Right",t))(Rw||{});function Tz(t){function n(){document.readyState!=="loading"&&(t(),document.removeEventListener("DOMContentLoaded",n))}typeof window<"u"&&typeof document<"u"&&(document.addEventListener("DOMContentLoaded",n),n())}let gl=[];Tz(()=>{function t(n){n.target instanceof HTMLElement&&n.target!==document.body&&gl[0]!==n.target&&(gl.unshift(n.target),gl=gl.filter(l=>l!=null&&l.isConnected),gl.splice(10))}window.addEventListener("click",t,{capture:!0}),window.addEventListener("mousedown",t,{capture:!0}),window.addEventListener("focus",t,{capture:!0}),document.body.addEventListener("click",t,{capture:!0}),document.body.addEventListener("mousedown",t,{capture:!0}),document.body.addEventListener("focus",t,{capture:!0})});function Sz(t){throw new Error("Unexpected object: "+t)}var wr=(t=>(t[t.First=0]="First",t[t.Previous=1]="Previous",t[t.Next=2]="Next",t[t.Last=3]="Last",t[t.Specific=4]="Specific",t[t.Nothing=5]="Nothing",t))(wr||{});function l_(t,n){let l=n.resolveItems();if(l.length<=0)return null;let h=n.resolveActiveIndex(),p=h??-1;switch(t.focus){case 0:{for(let y=0;y<l.length;++y)if(!n.resolveDisabled(l[y],y,l))return y;return h}case 1:{p===-1&&(p=l.length);for(let y=p-1;y>=0;--y)if(!n.resolveDisabled(l[y],y,l))return y;return h}case 2:{for(let y=p+1;y<l.length;++y)if(!n.resolveDisabled(l[y],y,l))return y;return h}case 3:{for(let y=l.length-1;y>=0;--y)if(!n.resolveDisabled(l[y],y,l))return y;return h}case 4:{for(let y=0;y<l.length;++y)if(n.resolveId(l[y],y,l)===t.id)return y;return h}case 5:return null;default:Sz(t)}}function K_(t={},n=null,l=[]){for(let[h,p]of Object.entries(t))Ow(l,Dw(n,h),p);return l}function Dw(t,n){return t?t+"["+n+"]":n}function Ow(t,n,l){if(Array.isArray(l))for(let[h,p]of l.entries())Ow(t,Dw(n,h.toString()),p);else l instanceof Date?t.push([n,l.toISOString()]):typeof l=="boolean"?t.push([n,l?"1":"0"]):typeof l=="string"?t.push([n,l]):typeof l=="number"?t.push([n,`${l}`]):l==null?t.push([n,""]):K_(l,n,t)}var Ez={};function Cz(t,n){return t===n}var Iz=(t=>(t[t.Open=0]="Open",t[t.Closed=1]="Closed",t))(Iz||{}),Mz=(t=>(t[t.Single=0]="Single",t[t.Multi=1]="Multi",t))(Mz||{}),Pz=(t=>(t[t.Pointer=0]="Pointer",t[t.Focus=1]="Focus",t[t.Other=2]="Other",t))(Pz||{});let Fw=Symbol("ComboboxContext");function iu(t){let n=nn(Fw,null);if(n===null){let l=new Error(`<${t} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(l,iu),l}return n}let Bw=Symbol("VirtualContext"),Az=Ur({name:"VirtualProvider",setup(t,{slots:n}){let l=iu("VirtualProvider"),h=Ye(()=>{let a=Xt(l.optionsRef);if(!a)return{start:0,end:0};let I=window.getComputedStyle(a);return{start:parseFloat(I.paddingBlockStart||I.paddingTop),end:parseFloat(I.paddingBlockEnd||I.paddingBottom)}}),p=nz(Ye(()=>({scrollPaddingStart:h.value.start,scrollPaddingEnd:h.value.end,count:l.virtual.value.options.length,estimateSize(){return 40},getScrollElement(){return Xt(l.optionsRef)},overscan:12}))),y=Ye(()=>{var a;return(a=l.virtual.value)==null?void 0:a.options}),m=$t(0);return Li([y],()=>{m.value+=1}),Pa(Bw,l.virtual.value?p:null),()=>[pn("div",{style:{position:"relative",width:"100%",height:`${p.value.getTotalSize()}px`},ref:a=>{if(a){if(typeof process<"u"&&Ez.JEST_WORKER_ID!==void 0||l.activationTrigger.value===0)return;l.activeOptionIndex.value!==null&&l.virtual.value.options.length>l.activeOptionIndex.value&&p.value.scrollToIndex(l.activeOptionIndex.value)}}},p.value.getVirtualItems().map(a=>Yo(n.default({option:l.virtual.value.options[a.index],open:l.comboboxState.value===0})[0],{key:`${m.value}-${a.index}`,"data-index":a.index,"aria-setsize":l.virtual.value.options.length,"aria-posinset":a.index+1,style:{position:"absolute",top:0,left:0,transform:`translateY(${a.start}px)`,overflowAnchor:"none"}})))]}}),kz=Ur({name:"Combobox",emits:{"update:modelValue":t=>!0},props:{as:{type:[Object,String],default:"template"},disabled:{type:[Boolean],default:!1},by:{type:[String,Function],nullable:!0,default:null},modelValue:{type:[Object,String,Number,Boolean],default:void 0},defaultValue:{type:[Object,String,Number,Boolean],default:void 0},form:{type:String,optional:!0},name:{type:String,optional:!0},nullable:{type:Boolean,default:!1},multiple:{type:[Boolean],default:!1},immediate:{type:[Boolean],default:!1},virtual:{type:Object,default:null}},inheritAttrs:!1,setup(t,{slots:n,attrs:l,emit:h}){let p=$t(1),y=$t(null),m=$t(null),a=$t(null),I=$t(null),z=$t({static:!1,hold:!1}),P=$t([]),k=$t(null),N=$t(2),F=$t(!1);function H(Ee=Re=>Re){let Re=k.value!==null?P.value[k.value]:null,Ae=Ee(P.value.slice()),He=Ae.length>0&&Ae[0].dataRef.order.value!==null?Ae.sort((vt,Xe)=>vt.dataRef.order.value-Xe.dataRef.order.value):ww(Ae,vt=>Xt(vt.dataRef.domRef)),it=Re?He.indexOf(Re):null;return it===-1&&(it=null),{options:He,activeOptionIndex:it}}let X=Ye(()=>t.multiple?1:0),ae=Ye(()=>t.nullable),[Se,be]=vw(Ye(()=>t.modelValue),Ee=>h("update:modelValue",Ee),Ye(()=>t.defaultValue)),Q=Ye(()=>Se.value===void 0?rn(X.value,{1:[],0:void 0}):Se.value),re=null,J=null;function le(Ee){return rn(X.value,{0(){return be==null?void 0:be(Ee)},1:()=>{let Re=Vt(Ie.value.value).slice(),Ae=Vt(Ee),He=Re.findIndex(it=>Ie.compare(Ae,Vt(it)));return He===-1?Re.push(Ae):Re.splice(He,1),be==null?void 0:be(Re)}})}let Me=Ye(()=>{});Li([Me],([Ee],[Re])=>{if(Ie.virtual.value&&Ee&&Re&&k.value!==null){let Ae=Ee.indexOf(Re[k.value]);Ae!==-1?k.value=Ae:k.value=null}});let Ie={comboboxState:p,value:Q,mode:X,compare(Ee,Re){if(typeof t.by=="string"){let Ae=t.by;return(Ee==null?void 0:Ee[Ae])===(Re==null?void 0:Re[Ae])}return t.by===null?Cz(Ee,Re):t.by(Ee,Re)},calculateIndex(Ee){return Ie.virtual.value?t.by===null?Ie.virtual.value.options.indexOf(Ee):Ie.virtual.value.options.findIndex(Re=>Ie.compare(Re,Ee)):P.value.findIndex(Re=>Ie.compare(Re.dataRef.value,Ee))},defaultValue:Ye(()=>t.defaultValue),nullable:ae,immediate:Ye(()=>!1),virtual:Ye(()=>null),inputRef:m,labelRef:y,buttonRef:a,optionsRef:I,disabled:Ye(()=>t.disabled),options:P,change(Ee){be(Ee)},activeOptionIndex:Ye(()=>{if(F.value&&k.value===null&&(Ie.virtual.value?Ie.virtual.value.options.length>0:P.value.length>0)){if(Ie.virtual.value){let Re=Ie.virtual.value.options.findIndex(Ae=>{var He;return!((He=Ie.virtual.value)!=null&&He.disabled(Ae))});if(Re!==-1)return Re}let Ee=P.value.findIndex(Re=>!Re.dataRef.disabled);if(Ee!==-1)return Ee}return k.value}),activationTrigger:N,optionsPropsRef:z,closeCombobox(){F.value=!1,!t.disabled&&p.value!==1&&(p.value=1,k.value=null)},openCombobox(){if(F.value=!0,!t.disabled&&p.value!==0){if(Ie.value.value){let Ee=Ie.calculateIndex(Ie.value.value);Ee!==-1&&(k.value=Ee)}p.value=0}},setActivationTrigger(Ee){N.value=Ee},goToOption(Ee,Re,Ae){F.value=!1,re!==null&&cancelAnimationFrame(re),re=requestAnimationFrame(()=>{if(t.disabled||I.value&&!z.value.static&&p.value===1)return;if(Ie.virtual.value){k.value=Ee===wr.Specific?Re:l_({focus:Ee},{resolveItems:()=>Ie.virtual.value.options,resolveActiveIndex:()=>{var vt,Xe;return(Xe=(vt=Ie.activeOptionIndex.value)!=null?vt:Ie.virtual.value.options.findIndex(xt=>{var yt;return!((yt=Ie.virtual.value)!=null&&yt.disabled(xt))}))!=null?Xe:null},resolveDisabled:vt=>Ie.virtual.value.disabled(vt),resolveId(){throw new Error("Function not implemented.")}}),N.value=Ae??2;return}let He=H();if(He.activeOptionIndex===null){let vt=He.options.findIndex(Xe=>!Xe.dataRef.disabled);vt!==-1&&(He.activeOptionIndex=vt)}let it=Ee===wr.Specific?Re:l_({focus:Ee},{resolveItems:()=>He.options,resolveActiveIndex:()=>He.activeOptionIndex,resolveId:vt=>vt.id,resolveDisabled:vt=>vt.dataRef.disabled});k.value=it,N.value=Ae??2,P.value=He.options})},selectOption(Ee){let Re=P.value.find(He=>He.id===Ee);if(!Re)return;let{dataRef:Ae}=Re;le(Ae.value)},selectActiveOption(){if(Ie.activeOptionIndex.value!==null){if(Ie.virtual.value)le(Ie.virtual.value.options[Ie.activeOptionIndex.value]);else{let{dataRef:Ee}=P.value[Ie.activeOptionIndex.value];le(Ee.value)}Ie.goToOption(wr.Specific,Ie.activeOptionIndex.value)}},registerOption(Ee,Re){let Ae=Co({id:Ee,dataRef:Re});if(Ie.virtual.value){P.value.push(Ae);return}J&&cancelAnimationFrame(J);let He=H(it=>(it.push(Ae),it));k.value===null&&Ie.isSelected(Re.value.value)&&(He.activeOptionIndex=He.options.indexOf(Ae)),P.value=He.options,k.value=He.activeOptionIndex,N.value=2,He.options.some(it=>!Xt(it.dataRef.domRef))&&(J=requestAnimationFrame(()=>{let it=H();P.value=it.options,k.value=it.activeOptionIndex}))},unregisterOption(Ee,Re){if(re!==null&&cancelAnimationFrame(re),Re&&(F.value=!0),Ie.virtual.value){P.value=P.value.filter(He=>He.id!==Ee);return}let Ae=H(He=>{let it=He.findIndex(vt=>vt.id===Ee);return it!==-1&&He.splice(it,1),He});P.value=Ae.options,k.value=Ae.activeOptionIndex,N.value=2},isSelected(Ee){return rn(X.value,{0:()=>Ie.compare(Vt(Ie.value.value),Vt(Ee)),1:()=>Vt(Ie.value.value).some(Re=>Ie.compare(Vt(Re),Vt(Ee)))})},isActive(Ee){return k.value===Ie.calculateIndex(Ee)}};Sw([m,a,I],()=>Ie.closeCombobox(),Ye(()=>p.value===0)),Pa(Fw,Ie),zw(Ye(()=>rn(p.value,{0:ks.Open,1:ks.Closed})));let Be=Ye(()=>{var Ee;return(Ee=Xt(m))==null?void 0:Ee.closest("form")});return Sn(()=>{Li([Be],()=>{if(!Be.value||t.defaultValue===void 0)return;function Ee(){Ie.change(t.defaultValue)}return Be.value.addEventListener("reset",Ee),()=>{var Re;(Re=Be.value)==null||Re.removeEventListener("reset",Ee)}},{immediate:!0})}),()=>{var Ee,Re,Ae;let{name:He,disabled:it,form:vt,...Xe}=t,xt={open:p.value===0,disabled:it,activeIndex:Ie.activeOptionIndex.value,activeOption:Ie.activeOptionIndex.value===null?null:Ie.virtual.value?Ie.virtual.value.options[(Ee=Ie.activeOptionIndex.value)!=null?Ee:0]:(Ae=(Re=Ie.options.value[Ie.activeOptionIndex.value])==null?void 0:Re.dataRef.value)!=null?Ae:null,value:Q.value};return pn(ki,[...He!=null&&Q.value!=null?K_({[He]:Q.value}).map(([yt,Rt])=>pn(Aw,Pw({features:W_.Hidden,key:yt,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:vt,disabled:it,name:yt,value:Rt}))):[],ts({theirProps:{...l,...nd(Xe,["by","defaultValue","immediate","modelValue","multiple","nullable","onUpdate:modelValue","virtual"])},ourProps:{},slot:xt,slots:n,attrs:l,name:"Combobox"})])}}}),Lz=Ur({name:"ComboboxButton",props:{as:{type:[Object,String],default:"button"},id:{type:String,default:null}},setup(t,{attrs:n,slots:l,expose:h}){var p;let y=(p=t.id)!=null?p:`headlessui-combobox-button-${Rl()}`,m=iu("ComboboxButton");h({el:m.buttonRef,$el:m.buttonRef});function a(P){m.disabled.value||(m.comboboxState.value===0?m.closeCombobox():(P.preventDefault(),m.openCombobox()),tn(()=>{var k;return(k=Xt(m.inputRef))==null?void 0:k.focus({preventScroll:!0})}))}function I(P){switch(P.key){case Ir.ArrowDown:P.preventDefault(),P.stopPropagation(),m.comboboxState.value===1&&m.openCombobox(),tn(()=>{var k;return(k=m.inputRef.value)==null?void 0:k.focus({preventScroll:!0})});return;case Ir.ArrowUp:P.preventDefault(),P.stopPropagation(),m.comboboxState.value===1&&(m.openCombobox(),tn(()=>{m.value.value||m.goToOption(wr.Last)})),tn(()=>{var k;return(k=m.inputRef.value)==null?void 0:k.focus({preventScroll:!0})});return;case Ir.Escape:if(m.comboboxState.value!==0)return;P.preventDefault(),m.optionsRef.value&&!m.optionsPropsRef.value.static&&P.stopPropagation(),m.closeCombobox(),tn(()=>{var k;return(k=m.inputRef.value)==null?void 0:k.focus({preventScroll:!0})});return}}let z=Ew(Ye(()=>({as:t.as,type:n.type})),m.buttonRef);return()=>{var P,k;let N={open:m.comboboxState.value===0,disabled:m.disabled.value,value:m.value.value},{...F}=t,H={ref:m.buttonRef,id:y,type:z.value,tabindex:"-1","aria-haspopup":"listbox","aria-controls":(P=Xt(m.optionsRef))==null?void 0:P.id,"aria-expanded":m.comboboxState.value===0,"aria-labelledby":m.labelRef.value?[(k=Xt(m.labelRef))==null?void 0:k.id,y].join(" "):void 0,disabled:m.disabled.value===!0?!0:void 0,onKeydown:I,onClick:a};return ts({ourProps:H,theirProps:F,slot:N,attrs:n,slots:l,name:"ComboboxButton"})}}}),zz=Ur({name:"ComboboxInput",props:{as:{type:[Object,String],default:"input"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},displayValue:{type:Function},defaultValue:{type:String,default:void 0},id:{type:String,default:null}},emits:{change:t=>!0},setup(t,{emit:n,attrs:l,slots:h,expose:p}){var y;let m=(y=t.id)!=null?y:`headlessui-combobox-input-${Rl()}`,a=iu("ComboboxInput"),I=Ye(()=>q_(Xt(a.inputRef))),z={value:!1};p({el:a.inputRef,$el:a.inputRef});function P(){a.change(null);let J=Xt(a.optionsRef);J&&(J.scrollTop=0),a.goToOption(wr.Nothing)}let k=Ye(()=>{var J;let le=a.value.value;return Xt(a.inputRef)?typeof t.displayValue<"u"&&le!==void 0?(J=t.displayValue(le))!=null?J:"":typeof le=="string"?le:"":""});Sn(()=>{Li([k,a.comboboxState,I],([J,le],[Me,Ie])=>{if(z.value)return;let Be=Xt(a.inputRef);Be&&((Ie===0&&le===1||J!==Me)&&(Be.value=J),requestAnimationFrame(()=>{var Ee;if(z.value||!Be||((Ee=I.value)==null?void 0:Ee.activeElement)!==Be)return;let{selectionStart:Re,selectionEnd:Ae}=Be;Math.abs((Ae??0)-(Re??0))===0&&Re===0&&Be.setSelectionRange(Be.value.length,Be.value.length)}))},{immediate:!0}),Li([a.comboboxState],([J],[le])=>{if(J===0&&le===1){if(z.value)return;let Me=Xt(a.inputRef);if(!Me)return;let Ie=Me.value,{selectionStart:Be,selectionEnd:Ee,selectionDirection:Re}=Me;Me.value="",Me.value=Ie,Re!==null?Me.setSelectionRange(Be,Ee,Re):Me.setSelectionRange(Be,Ee)}})});let N=$t(!1);function F(){N.value=!0}function H(){fp().nextFrame(()=>{N.value=!1})}let X=az();function ae(J){switch(z.value=!0,X(()=>{z.value=!1}),J.key){case Ir.Enter:if(z.value=!1,a.comboboxState.value!==0||N.value)return;if(J.preventDefault(),J.stopPropagation(),a.activeOptionIndex.value===null){a.closeCombobox();return}a.selectActiveOption(),a.mode.value===0&&a.closeCombobox();break;case Ir.ArrowDown:return z.value=!1,J.preventDefault(),J.stopPropagation(),rn(a.comboboxState.value,{0:()=>a.goToOption(wr.Next),1:()=>a.openCombobox()});case Ir.ArrowUp:return z.value=!1,J.preventDefault(),J.stopPropagation(),rn(a.comboboxState.value,{0:()=>a.goToOption(wr.Previous),1:()=>{a.openCombobox(),tn(()=>{a.value.value||a.goToOption(wr.Last)})}});case Ir.Home:if(J.shiftKey)break;return z.value=!1,J.preventDefault(),J.stopPropagation(),a.goToOption(wr.First);case Ir.PageUp:return z.value=!1,J.preventDefault(),J.stopPropagation(),a.goToOption(wr.First);case Ir.End:if(J.shiftKey)break;return z.value=!1,J.preventDefault(),J.stopPropagation(),a.goToOption(wr.Last);case Ir.PageDown:return z.value=!1,J.preventDefault(),J.stopPropagation(),a.goToOption(wr.Last);case Ir.Escape:if(z.value=!1,a.comboboxState.value!==0)return;J.preventDefault(),a.optionsRef.value&&!a.optionsPropsRef.value.static&&J.stopPropagation(),a.nullable.value&&a.mode.value===0&&a.value.value===null&&P(),a.closeCombobox();break;case Ir.Tab:if(z.value=!1,a.comboboxState.value!==0)return;a.mode.value===0&&a.activationTrigger.value!==1&&a.selectActiveOption(),a.closeCombobox();break}}function Se(J){n("change",J),a.nullable.value&&a.mode.value===0&&J.target.value===""&&P(),a.openCombobox()}function be(J){var le,Me,Ie;let Be=(le=J.relatedTarget)!=null?le:gl.find(Ee=>Ee!==J.currentTarget);if(z.value=!1,!((Me=Xt(a.optionsRef))!=null&&Me.contains(Be))&&!((Ie=Xt(a.buttonRef))!=null&&Ie.contains(Be))&&a.comboboxState.value===0)return J.preventDefault(),a.mode.value===0&&(a.nullable.value&&a.value.value===null?P():a.activationTrigger.value!==1&&a.selectActiveOption()),a.closeCombobox()}function Q(J){var le,Me,Ie;let Be=(le=J.relatedTarget)!=null?le:gl.find(Ee=>Ee!==J.currentTarget);(Me=Xt(a.buttonRef))!=null&&Me.contains(Be)||(Ie=Xt(a.optionsRef))!=null&&Ie.contains(Be)||a.disabled.value||a.immediate.value&&a.comboboxState.value!==0&&(a.openCombobox(),fp().nextFrame(()=>{a.setActivationTrigger(1)}))}let re=Ye(()=>{var J,le,Me,Ie;return(Ie=(Me=(le=t.defaultValue)!=null?le:a.defaultValue.value!==void 0?(J=t.displayValue)==null?void 0:J.call(t,a.defaultValue.value):null)!=null?Me:a.defaultValue.value)!=null?Ie:""});return()=>{var J,le,Me,Ie,Be,Ee,Re;let Ae={open:a.comboboxState.value===0},{displayValue:He,onChange:it,...vt}=t,Xe={"aria-controls":(J=a.optionsRef.value)==null?void 0:J.id,"aria-expanded":a.comboboxState.value===0,"aria-activedescendant":a.activeOptionIndex.value===null?void 0:a.virtual.value?(le=a.options.value.find(xt=>!a.virtual.value.disabled(xt.dataRef.value)&&a.compare(xt.dataRef.value,a.virtual.value.options[a.activeOptionIndex.value])))==null?void 0:le.id:(Me=a.options.value[a.activeOptionIndex.value])==null?void 0:Me.id,"aria-labelledby":(Ee=(Ie=Xt(a.labelRef))==null?void 0:Ie.id)!=null?Ee:(Be=Xt(a.buttonRef))==null?void 0:Be.id,"aria-autocomplete":"list",id:m,onCompositionstart:F,onCompositionend:H,onKeydown:ae,onInput:Se,onFocus:Q,onBlur:be,role:"combobox",type:(Re=l.type)!=null?Re:"text",tabIndex:0,ref:a.inputRef,defaultValue:re.value,disabled:a.disabled.value===!0?!0:void 0};return ts({ourProps:Xe,theirProps:vt,slot:Ae,attrs:l,slots:h,features:Pl.RenderStrategy|Pl.Static,name:"ComboboxInput"})}}}),Rz=Ur({name:"ComboboxOptions",props:{as:{type:[Object,String],default:"ul"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},hold:{type:[Boolean],default:!1}},setup(t,{attrs:n,slots:l,expose:h}){let p=iu("ComboboxOptions"),y=`headlessui-combobox-options-${Rl()}`;h({el:p.optionsRef,$el:p.optionsRef}),lo(()=>{p.optionsPropsRef.value.static=t.static}),lo(()=>{p.optionsPropsRef.value.hold=t.hold});let m=Lw(),a=Ye(()=>m!==null?(m.value&ks.Open)===ks.Open:p.comboboxState.value===0);bz({container:Ye(()=>Xt(p.optionsRef)),enabled:Ye(()=>p.comboboxState.value===0),accept(z){return z.getAttribute("role")==="option"?NodeFilter.FILTER_REJECT:z.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(z){z.setAttribute("role","none")}});function I(z){z.preventDefault()}return()=>{var z,P,k;let N={open:p.comboboxState.value===0},F={"aria-labelledby":(k=(z=Xt(p.labelRef))==null?void 0:z.id)!=null?k:(P=Xt(p.buttonRef))==null?void 0:P.id,id:y,ref:p.optionsRef,role:"listbox","aria-multiselectable":p.mode.value===1?!0:void 0,onMousedown:I},H=nd(t,["hold"]);return ts({ourProps:F,theirProps:H,slot:N,attrs:n,slots:p.virtual.value&&p.comboboxState.value===0?{...l,default:()=>[pn(Az,{},l.default)]}:l,features:Pl.RenderStrategy|Pl.Static,visible:a.value,name:"ComboboxOptions"})}}}),Dz=Ur({name:"ComboboxOption",props:{as:{type:[Object,String],default:"li"},value:{type:[Object,String,Number,Boolean]},disabled:{type:Boolean,default:!1},order:{type:[Number],default:null}},setup(t,{slots:n,attrs:l,expose:h}){let p=iu("ComboboxOption"),y=`headlessui-combobox-option-${Rl()}`,m=$t(null),a=Ye(()=>t.disabled);h({el:m,$el:m});let I=Ye(()=>{var be;return p.virtual.value?p.activeOptionIndex.value===p.calculateIndex(t.value):p.activeOptionIndex.value===null?!1:((be=p.options.value[p.activeOptionIndex.value])==null?void 0:be.id)===y}),z=Ye(()=>p.isSelected(t.value)),P=nn(Bw,null),k=Ye(()=>({disabled:t.disabled,value:t.value,domRef:m,order:Ye(()=>t.order)}));Sn(()=>p.registerOption(y,k)),Qc(()=>p.unregisterOption(y,I.value)),lo(()=>{let be=Xt(m);be&&(P==null||P.value.measureElement(be))}),lo(()=>{p.comboboxState.value===0&&I.value&&(p.virtual.value||p.activationTrigger.value!==0&&tn(()=>{var be,Q;return(Q=(be=Xt(m))==null?void 0:be.scrollIntoView)==null?void 0:Q.call(be,{block:"nearest"})}))});function N(be){be.preventDefault(),be.button===Rw.Left&&(a.value||(p.selectOption(y),Tw()||requestAnimationFrame(()=>{var Q;return(Q=Xt(p.inputRef))==null?void 0:Q.focus({preventScroll:!0})}),p.mode.value===0&&p.closeCombobox()))}function F(){var be;if(t.disabled||(be=p.virtual.value)!=null&&be.disabled(t.value))return p.goToOption(wr.Nothing);let Q=p.calculateIndex(t.value);p.goToOption(wr.Specific,Q)}let H=Cw();function X(be){H.update(be)}function ae(be){var Q;if(!H.wasMoved(be)||t.disabled||(Q=p.virtual.value)!=null&&Q.disabled(t.value)||I.value)return;let re=p.calculateIndex(t.value);p.goToOption(wr.Specific,re,0)}function Se(be){var Q;H.wasMoved(be)&&(t.disabled||(Q=p.virtual.value)!=null&&Q.disabled(t.value)||I.value&&(p.optionsPropsRef.value.hold||p.goToOption(wr.Nothing)))}return()=>{let{disabled:be}=t,Q={active:I.value,selected:z.value,disabled:be},re={id:y,ref:m,role:"option",tabIndex:be===!0?void 0:-1,"aria-disabled":be===!0?!0:void 0,"aria-selected":z.value,disabled:void 0,onMousedown:N,onFocus:F,onPointerenter:X,onMouseenter:X,onPointermove:ae,onMousemove:ae,onPointerleave:Se,onMouseleave:Se},J=nd(t,["order","value"]);return ts({ourProps:re,theirProps:J,slot:Q,attrs:l,slots:n,name:"ComboboxOption"})}}}),bb=/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g;function xb(t){var n,l;let h=(n=t.innerText)!=null?n:"",p=t.cloneNode(!0);if(!(p instanceof HTMLElement))return h;let y=!1;for(let a of p.querySelectorAll('[hidden],[aria-hidden],[role="img"]'))a.remove(),y=!0;let m=y?(l=p.innerText)!=null?l:"":h;return bb.test(m)&&(m=m.replace(bb,"")),m}function Oz(t){let n=t.getAttribute("aria-label");if(typeof n=="string")return n.trim();let l=t.getAttribute("aria-labelledby");if(l){let h=l.split(" ").map(p=>{let y=document.getElementById(p);if(y){let m=y.getAttribute("aria-label");return typeof m=="string"?m.trim():xb(y).trim()}return null}).filter(Boolean);if(h.length>0)return h.join(", ")}return xb(t).trim()}function Fz(t){let n=$t(""),l=$t("");return()=>{let h=Xt(t);if(!h)return"";let p=h.innerText;if(n.value===p)return l.value;let y=Oz(h).trim().toLowerCase();return n.value=p,l.value=y,y}}function Bz(t,n){return t===n}var jz=(t=>(t[t.Open=0]="Open",t[t.Closed=1]="Closed",t))(jz||{}),Nz=(t=>(t[t.Single=0]="Single",t[t.Multi=1]="Multi",t))(Nz||{}),Vz=(t=>(t[t.Pointer=0]="Pointer",t[t.Other=1]="Other",t))(Vz||{});function $z(t){requestAnimationFrame(()=>requestAnimationFrame(t))}let jw=Symbol("ListboxContext");function zp(t){let n=nn(jw,null);if(n===null){let l=new Error(`<${t} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(l,zp),l}return n}let Uz=Ur({name:"Listbox",emits:{"update:modelValue":t=>!0},props:{as:{type:[Object,String],default:"template"},disabled:{type:[Boolean],default:!1},by:{type:[String,Function],default:()=>Bz},horizontal:{type:[Boolean],default:!1},modelValue:{type:[Object,String,Number,Boolean],default:void 0},defaultValue:{type:[Object,String,Number,Boolean],default:void 0},form:{type:String,optional:!0},name:{type:String,optional:!0},multiple:{type:[Boolean],default:!1}},inheritAttrs:!1,setup(t,{slots:n,attrs:l,emit:h}){let p=$t(1),y=$t(null),m=$t(null),a=$t(null),I=$t([]),z=$t(""),P=$t(null),k=$t(1);function N(Q=re=>re){let re=P.value!==null?I.value[P.value]:null,J=ww(Q(I.value.slice()),Me=>Xt(Me.dataRef.domRef)),le=re?J.indexOf(re):null;return le===-1&&(le=null),{options:J,activeOptionIndex:le}}let F=Ye(()=>t.multiple?1:0),[H,X]=vw(Ye(()=>t.modelValue),Q=>h("update:modelValue",Q),Ye(()=>t.defaultValue)),ae=Ye(()=>H.value===void 0?rn(F.value,{1:[],0:void 0}):H.value),Se={listboxState:p,value:ae,mode:F,compare(Q,re){if(typeof t.by=="string"){let J=t.by;return(Q==null?void 0:Q[J])===(re==null?void 0:re[J])}return t.by(Q,re)},orientation:Ye(()=>t.horizontal?"horizontal":"vertical"),labelRef:y,buttonRef:m,optionsRef:a,disabled:Ye(()=>t.disabled),options:I,searchQuery:z,activeOptionIndex:P,activationTrigger:k,closeListbox(){t.disabled||p.value!==1&&(p.value=1,P.value=null)},openListbox(){t.disabled||p.value!==0&&(p.value=0)},goToOption(Q,re,J){if(t.disabled||p.value===1)return;let le=N(),Me=l_(Q===wr.Specific?{focus:wr.Specific,id:re}:{focus:Q},{resolveItems:()=>le.options,resolveActiveIndex:()=>le.activeOptionIndex,resolveId:Ie=>Ie.id,resolveDisabled:Ie=>Ie.dataRef.disabled});z.value="",P.value=Me,k.value=J??1,I.value=le.options},search(Q){if(t.disabled||p.value===1)return;let re=z.value!==""?0:1;z.value+=Q.toLowerCase();let J=(P.value!==null?I.value.slice(P.value+re).concat(I.value.slice(0,P.value+re)):I.value).find(Me=>Me.dataRef.textValue.startsWith(z.value)&&!Me.dataRef.disabled),le=J?I.value.indexOf(J):-1;le===-1||le===P.value||(P.value=le,k.value=1)},clearSearch(){t.disabled||p.value!==1&&z.value!==""&&(z.value="")},registerOption(Q,re){let J=N(le=>[...le,{id:Q,dataRef:re}]);I.value=J.options,P.value=J.activeOptionIndex},unregisterOption(Q){let re=N(J=>{let le=J.findIndex(Me=>Me.id===Q);return le!==-1&&J.splice(le,1),J});I.value=re.options,P.value=re.activeOptionIndex,k.value=1},theirOnChange(Q){t.disabled||X(Q)},select(Q){t.disabled||X(rn(F.value,{0:()=>Q,1:()=>{let re=Vt(Se.value.value).slice(),J=Vt(Q),le=re.findIndex(Me=>Se.compare(J,Vt(Me)));return le===-1?re.push(J):re.splice(le,1),re}}))}};Sw([m,a],(Q,re)=>{var J;Se.closeListbox(),xw(re,H_.Loose)||(Q.preventDefault(),(J=Xt(m))==null||J.focus())},Ye(()=>p.value===0)),Pa(jw,Se),zw(Ye(()=>rn(p.value,{0:ks.Open,1:ks.Closed})));let be=Ye(()=>{var Q;return(Q=Xt(m))==null?void 0:Q.closest("form")});return Sn(()=>{Li([be],()=>{if(!be.value||t.defaultValue===void 0)return;function Q(){Se.theirOnChange(t.defaultValue)}return be.value.addEventListener("reset",Q),()=>{var re;(re=be.value)==null||re.removeEventListener("reset",Q)}},{immediate:!0})}),()=>{let{name:Q,modelValue:re,disabled:J,form:le,...Me}=t,Ie={open:p.value===0,disabled:J,value:ae.value};return pn(ki,[...Q!=null&&ae.value!=null?K_({[Q]:ae.value}).map(([Be,Ee])=>pn(Aw,Pw({features:W_.Hidden,key:Be,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:le,disabled:J,name:Be,value:Ee}))):[],ts({ourProps:{},theirProps:{...l,...nd(Me,["defaultValue","onUpdate:modelValue","horizontal","multiple","by"])},slot:Ie,slots:n,attrs:l,name:"Listbox"})])}}}),Gz=Ur({name:"ListboxButton",props:{as:{type:[Object,String],default:"button"},id:{type:String,default:null}},setup(t,{attrs:n,slots:l,expose:h}){var p;let y=(p=t.id)!=null?p:`headlessui-listbox-button-${Rl()}`,m=zp("ListboxButton");h({el:m.buttonRef,$el:m.buttonRef});function a(k){switch(k.key){case Ir.Space:case Ir.Enter:case Ir.ArrowDown:k.preventDefault(),m.openListbox(),tn(()=>{var N;(N=Xt(m.optionsRef))==null||N.focus({preventScroll:!0}),m.value.value||m.goToOption(wr.First)});break;case Ir.ArrowUp:k.preventDefault(),m.openListbox(),tn(()=>{var N;(N=Xt(m.optionsRef))==null||N.focus({preventScroll:!0}),m.value.value||m.goToOption(wr.Last)});break}}function I(k){switch(k.key){case Ir.Space:k.preventDefault();break}}function z(k){m.disabled.value||(m.listboxState.value===0?(m.closeListbox(),tn(()=>{var N;return(N=Xt(m.buttonRef))==null?void 0:N.focus({preventScroll:!0})})):(k.preventDefault(),m.openListbox(),$z(()=>{var N;return(N=Xt(m.optionsRef))==null?void 0:N.focus({preventScroll:!0})})))}let P=Ew(Ye(()=>({as:t.as,type:n.type})),m.buttonRef);return()=>{var k,N;let F={open:m.listboxState.value===0,disabled:m.disabled.value,value:m.value.value},{...H}=t,X={ref:m.buttonRef,id:y,type:P.value,"aria-haspopup":"listbox","aria-controls":(k=Xt(m.optionsRef))==null?void 0:k.id,"aria-expanded":m.listboxState.value===0,"aria-labelledby":m.labelRef.value?[(N=Xt(m.labelRef))==null?void 0:N.id,y].join(" "):void 0,disabled:m.disabled.value===!0?!0:void 0,onKeydown:a,onKeyup:I,onClick:z};return ts({ourProps:X,theirProps:H,slot:F,attrs:n,slots:l,name:"ListboxButton"})}}}),Zz=Ur({name:"ListboxOptions",props:{as:{type:[Object,String],default:"ul"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:null}},setup(t,{attrs:n,slots:l,expose:h}){var p;let y=(p=t.id)!=null?p:`headlessui-listbox-options-${Rl()}`,m=zp("ListboxOptions"),a=$t(null);h({el:m.optionsRef,$el:m.optionsRef});function I(k){switch(a.value&&clearTimeout(a.value),k.key){case Ir.Space:if(m.searchQuery.value!=="")return k.preventDefault(),k.stopPropagation(),m.search(k.key);case Ir.Enter:if(k.preventDefault(),k.stopPropagation(),m.activeOptionIndex.value!==null){let N=m.options.value[m.activeOptionIndex.value];m.select(N.dataRef.value)}m.mode.value===0&&(m.closeListbox(),tn(()=>{var N;return(N=Xt(m.buttonRef))==null?void 0:N.focus({preventScroll:!0})}));break;case rn(m.orientation.value,{vertical:Ir.ArrowDown,horizontal:Ir.ArrowRight}):return k.preventDefault(),k.stopPropagation(),m.goToOption(wr.Next);case rn(m.orientation.value,{vertical:Ir.ArrowUp,horizontal:Ir.ArrowLeft}):return k.preventDefault(),k.stopPropagation(),m.goToOption(wr.Previous);case Ir.Home:case Ir.PageUp:return k.preventDefault(),k.stopPropagation(),m.goToOption(wr.First);case Ir.End:case Ir.PageDown:return k.preventDefault(),k.stopPropagation(),m.goToOption(wr.Last);case Ir.Escape:k.preventDefault(),k.stopPropagation(),m.closeListbox(),tn(()=>{var N;return(N=Xt(m.buttonRef))==null?void 0:N.focus({preventScroll:!0})});break;case Ir.Tab:k.preventDefault(),k.stopPropagation();break;default:k.key.length===1&&(m.search(k.key),a.value=setTimeout(()=>m.clearSearch(),350));break}}let z=Lw(),P=Ye(()=>z!==null?(z.value&ks.Open)===ks.Open:m.listboxState.value===0);return()=>{var k,N;let F={open:m.listboxState.value===0},{...H}=t,X={"aria-activedescendant":m.activeOptionIndex.value===null||(k=m.options.value[m.activeOptionIndex.value])==null?void 0:k.id,"aria-multiselectable":m.mode.value===1?!0:void 0,"aria-labelledby":(N=Xt(m.buttonRef))==null?void 0:N.id,"aria-orientation":m.orientation.value,id:y,onKeydown:I,role:"listbox",tabIndex:0,ref:m.optionsRef};return ts({ourProps:X,theirProps:H,slot:F,attrs:n,slots:l,features:Pl.RenderStrategy|Pl.Static,visible:P.value,name:"ListboxOptions"})}}}),qz=Ur({name:"ListboxOption",props:{as:{type:[Object,String],default:"li"},value:{type:[Object,String,Number,Boolean]},disabled:{type:Boolean,default:!1},id:{type:String,default:null}},setup(t,{slots:n,attrs:l,expose:h}){var p;let y=(p=t.id)!=null?p:`headlessui-listbox-option-${Rl()}`,m=zp("ListboxOption"),a=$t(null);h({el:a,$el:a});let I=Ye(()=>m.activeOptionIndex.value!==null?m.options.value[m.activeOptionIndex.value].id===y:!1),z=Ye(()=>rn(m.mode.value,{0:()=>m.compare(Vt(m.value.value),Vt(t.value)),1:()=>Vt(m.value.value).some(Q=>m.compare(Vt(Q),Vt(t.value)))})),P=Ye(()=>rn(m.mode.value,{1:()=>{var Q;let re=Vt(m.value.value);return((Q=m.options.value.find(J=>re.some(le=>m.compare(Vt(le),Vt(J.dataRef.value)))))==null?void 0:Q.id)===y},0:()=>z.value})),k=Fz(a),N=Ye(()=>({disabled:t.disabled,value:t.value,get textValue(){return k()},domRef:a}));Sn(()=>m.registerOption(y,N)),Qc(()=>m.unregisterOption(y)),Sn(()=>{Li([m.listboxState,z],()=>{m.listboxState.value===0&&z.value&&rn(m.mode.value,{1:()=>{P.value&&m.goToOption(wr.Specific,y)},0:()=>{m.goToOption(wr.Specific,y)}})},{immediate:!0})}),lo(()=>{m.listboxState.value===0&&I.value&&m.activationTrigger.value!==0&&tn(()=>{var Q,re;return(re=(Q=Xt(a))==null?void 0:Q.scrollIntoView)==null?void 0:re.call(Q,{block:"nearest"})})});function F(Q){if(t.disabled)return Q.preventDefault();m.select(t.value),m.mode.value===0&&(m.closeListbox(),tn(()=>{var re;return(re=Xt(m.buttonRef))==null?void 0:re.focus({preventScroll:!0})}))}function H(){if(t.disabled)return m.goToOption(wr.Nothing);m.goToOption(wr.Specific,y)}let X=Cw();function ae(Q){X.update(Q)}function Se(Q){X.wasMoved(Q)&&(t.disabled||I.value||m.goToOption(wr.Specific,y,0))}function be(Q){X.wasMoved(Q)&&(t.disabled||I.value&&m.goToOption(wr.Nothing))}return()=>{let{disabled:Q}=t,re={active:I.value,selected:z.value,disabled:Q},{value:J,disabled:le,...Me}=t,Ie={id:y,ref:a,role:"option",tabIndex:Q===!0?void 0:-1,"aria-disabled":Q===!0?!0:void 0,"aria-selected":z.value,disabled:void 0,onClick:F,onFocus:H,onPointerenter:ae,onMouseenter:ae,onPointermove:Se,onMousemove:Se,onPointerleave:be,onMouseleave:be};return ts({ourProps:Ie,theirProps:Me,slot:re,attrs:l,slots:n,name:"ListboxOption"})}}});function Zn(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var n=t.ownerDocument;return n&&n.defaultView||window}return t}function Al(t){var n=Zn(t).Element;return t instanceof n||t instanceof Element}function so(t){var n=Zn(t).HTMLElement;return t instanceof n||t instanceof HTMLElement}function X_(t){if(typeof ShadowRoot>"u")return!1;var n=Zn(t).ShadowRoot;return t instanceof n||t instanceof ShadowRoot}var Sl=Math.max,pp=Math.min,Wc=Math.round;function c_(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(n){return n.brand+"/"+n.version}).join(" "):navigator.userAgent}function Nw(){return!/^((?!chrome|android).)*safari/i.test(c_())}function Kc(t,n,l){n===void 0&&(n=!1),l===void 0&&(l=!1);var h=t.getBoundingClientRect(),p=1,y=1;n&&so(t)&&(p=t.offsetWidth>0&&Wc(h.width)/t.offsetWidth||1,y=t.offsetHeight>0&&Wc(h.height)/t.offsetHeight||1);var m=Al(t)?Zn(t):window,a=m.visualViewport,I=!Nw()&&l,z=(h.left+(I&&a?a.offsetLeft:0))/p,P=(h.top+(I&&a?a.offsetTop:0))/y,k=h.width/p,N=h.height/y;return{width:k,height:N,top:P,right:z+k,bottom:P+N,left:z,x:z,y:P}}function Y_(t){var n=Zn(t),l=n.pageXOffset,h=n.pageYOffset;return{scrollLeft:l,scrollTop:h}}function Hz(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function Wz(t){return t===Zn(t)||!so(t)?Y_(t):Hz(t)}function Jo(t){return t?(t.nodeName||"").toLowerCase():null}function ka(t){return((Al(t)?t.ownerDocument:t.document)||window.document).documentElement}function J_(t){return Kc(ka(t)).left+Y_(t).scrollLeft}function Ls(t){return Zn(t).getComputedStyle(t)}function Q_(t){var n=Ls(t),l=n.overflow,h=n.overflowX,p=n.overflowY;return/auto|scroll|overlay|hidden/.test(l+p+h)}function Kz(t){var n=t.getBoundingClientRect(),l=Wc(n.width)/t.offsetWidth||1,h=Wc(n.height)/t.offsetHeight||1;return l!==1||h!==1}function Xz(t,n,l){l===void 0&&(l=!1);var h=so(n),p=so(n)&&Kz(n),y=ka(n),m=Kc(t,p,l),a={scrollLeft:0,scrollTop:0},I={x:0,y:0};return(h||!h&&!l)&&((Jo(n)!=="body"||Q_(y))&&(a=Wz(n)),so(n)?(I=Kc(n,!0),I.x+=n.clientLeft,I.y+=n.clientTop):y&&(I.x=J_(y))),{x:m.left+a.scrollLeft-I.x,y:m.top+a.scrollTop-I.y,width:m.width,height:m.height}}function ey(t){var n=Kc(t),l=t.offsetWidth,h=t.offsetHeight;return Math.abs(n.width-l)<=1&&(l=n.width),Math.abs(n.height-h)<=1&&(h=n.height),{x:t.offsetLeft,y:t.offsetTop,width:l,height:h}}function Rp(t){return Jo(t)==="html"?t:t.assignedSlot||t.parentNode||(X_(t)?t.host:null)||ka(t)}function Vw(t){return["html","body","#document"].indexOf(Jo(t))>=0?t.ownerDocument.body:so(t)&&Q_(t)?t:Vw(Rp(t))}function Dh(t,n){var l;n===void 0&&(n=[]);var h=Vw(t),p=h===((l=t.ownerDocument)==null?void 0:l.body),y=Zn(h),m=p?[y].concat(y.visualViewport||[],Q_(h)?h:[]):h,a=n.concat(m);return p?a:a.concat(Dh(Rp(m)))}function Yz(t){return["table","td","th"].indexOf(Jo(t))>=0}function wb(t){return!so(t)||Ls(t).position==="fixed"?null:t.offsetParent}function Jz(t){var n=/firefox/i.test(c_()),l=/Trident/i.test(c_());if(l&&so(t)){var h=Ls(t);if(h.position==="fixed")return null}var p=Rp(t);for(X_(p)&&(p=p.host);so(p)&&["html","body"].indexOf(Jo(p))<0;){var y=Ls(p);if(y.transform!=="none"||y.perspective!=="none"||y.contain==="paint"||["transform","perspective"].indexOf(y.willChange)!==-1||n&&y.willChange==="filter"||n&&y.filter&&y.filter!=="none")return p;p=p.parentNode}return null}function od(t){for(var n=Zn(t),l=wb(t);l&&Yz(l)&&Ls(l).position==="static";)l=wb(l);return l&&(Jo(l)==="html"||Jo(l)==="body"&&Ls(l).position==="static")?n:l||Jz(t)||n}var Un="top",Mo="bottom",Po="right",Gn="left",ty="auto",sd=[Un,Mo,Po,Gn],Xc="start",Kh="end",Qz="clippingParents",$w="viewport",Eh="popper",eR="reference",Tb=sd.reduce(function(t,n){return t.concat([n+"-"+Xc,n+"-"+Kh])},[]),Uw=[].concat(sd,[ty]).reduce(function(t,n){return t.concat([n,n+"-"+Xc,n+"-"+Kh])},[]),tR="beforeRead",rR="read",iR="afterRead",nR="beforeMain",oR="main",sR="afterMain",aR="beforeWrite",lR="write",cR="afterWrite",uR=[tR,rR,iR,nR,oR,sR,aR,lR,cR];function hR(t){var n=new Map,l=new Set,h=[];t.forEach(function(y){n.set(y.name,y)});function p(y){l.add(y.name);var m=[].concat(y.requires||[],y.requiresIfExists||[]);m.forEach(function(a){if(!l.has(a)){var I=n.get(a);I&&p(I)}}),h.push(y)}return t.forEach(function(y){l.has(y.name)||p(y)}),h}function dR(t){var n=hR(t);return uR.reduce(function(l,h){return l.concat(n.filter(function(p){return p.phase===h}))},[])}function fR(t){var n;return function(){return n||(n=new Promise(function(l){Promise.resolve().then(function(){n=void 0,l(t())})})),n}}function pR(t){var n=t.reduce(function(l,h){var p=l[h.name];return l[h.name]=p?Object.assign({},p,h,{options:Object.assign({},p.options,h.options),data:Object.assign({},p.data,h.data)}):h,l},{});return Object.keys(n).map(function(l){return n[l]})}function mR(t,n){var l=Zn(t),h=ka(t),p=l.visualViewport,y=h.clientWidth,m=h.clientHeight,a=0,I=0;if(p){y=p.width,m=p.height;var z=Nw();(z||!z&&n==="fixed")&&(a=p.offsetLeft,I=p.offsetTop)}return{width:y,height:m,x:a+J_(t),y:I}}function gR(t){var n,l=ka(t),h=Y_(t),p=(n=t.ownerDocument)==null?void 0:n.body,y=Sl(l.scrollWidth,l.clientWidth,p?p.scrollWidth:0,p?p.clientWidth:0),m=Sl(l.scrollHeight,l.clientHeight,p?p.scrollHeight:0,p?p.clientHeight:0),a=-h.scrollLeft+J_(t),I=-h.scrollTop;return Ls(p||l).direction==="rtl"&&(a+=Sl(l.clientWidth,p?p.clientWidth:0)-y),{width:y,height:m,x:a,y:I}}function Gw(t,n){var l=n.getRootNode&&n.getRootNode();if(t.contains(n))return!0;if(l&&X_(l)){var h=n;do{if(h&&t.isSameNode(h))return!0;h=h.parentNode||h.host}while(h)}return!1}function u_(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function _R(t,n){var l=Kc(t,!1,n==="fixed");return l.top=l.top+t.clientTop,l.left=l.left+t.clientLeft,l.bottom=l.top+t.clientHeight,l.right=l.left+t.clientWidth,l.width=t.clientWidth,l.height=t.clientHeight,l.x=l.left,l.y=l.top,l}function Sb(t,n,l){return n===$w?u_(mR(t,l)):Al(n)?_R(n,l):u_(gR(ka(t)))}function yR(t){var n=Dh(Rp(t)),l=["absolute","fixed"].indexOf(Ls(t).position)>=0,h=l&&so(t)?od(t):t;return Al(h)?n.filter(function(p){return Al(p)&&Gw(p,h)&&Jo(p)!=="body"}):[]}function vR(t,n,l,h){var p=n==="clippingParents"?yR(t):[].concat(n),y=[].concat(p,[l]),m=y[0],a=y.reduce(function(I,z){var P=Sb(t,z,h);return I.top=Sl(P.top,I.top),I.right=pp(P.right,I.right),I.bottom=pp(P.bottom,I.bottom),I.left=Sl(P.left,I.left),I},Sb(t,m,h));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function Xo(t){return t.split("-")[0]}function Yc(t){return t.split("-")[1]}function ry(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function Zw(t){var n=t.reference,l=t.element,h=t.placement,p=h?Xo(h):null,y=h?Yc(h):null,m=n.x+n.width/2-l.width/2,a=n.y+n.height/2-l.height/2,I;switch(p){case Un:I={x:m,y:n.y-l.height};break;case Mo:I={x:m,y:n.y+n.height};break;case Po:I={x:n.x+n.width,y:a};break;case Gn:I={x:n.x-l.width,y:a};break;default:I={x:n.x,y:n.y}}var z=p?ry(p):null;if(z!=null){var P=z==="y"?"height":"width";switch(y){case Xc:I[z]=I[z]-(n[P]/2-l[P]/2);break;case Kh:I[z]=I[z]+(n[P]/2-l[P]/2);break}}return I}function qw(){return{top:0,right:0,bottom:0,left:0}}function Hw(t){return Object.assign({},qw(),t)}function Ww(t,n){return n.reduce(function(l,h){return l[h]=t,l},{})}function iy(t,n){n===void 0&&(n={});var l=n,h=l.placement,p=h===void 0?t.placement:h,y=l.strategy,m=y===void 0?t.strategy:y,a=l.boundary,I=a===void 0?Qz:a,z=l.rootBoundary,P=z===void 0?$w:z,k=l.elementContext,N=k===void 0?Eh:k,F=l.altBoundary,H=F===void 0?!1:F,X=l.padding,ae=X===void 0?0:X,Se=Hw(typeof ae!="number"?ae:Ww(ae,sd)),be=N===Eh?eR:Eh,Q=t.rects.popper,re=t.elements[H?be:N],J=vR(Al(re)?re:re.contextElement||ka(t.elements.popper),I,P,m),le=Kc(t.elements.reference),Me=Zw({reference:le,element:Q,placement:p}),Ie=u_(Object.assign({},Q,Me)),Be=N===Eh?Ie:le,Ee={top:J.top-Be.top+Se.top,bottom:Be.bottom-J.bottom+Se.bottom,left:J.left-Be.left+Se.left,right:Be.right-J.right+Se.right},Re=t.modifiersData.offset;if(N===Eh&&Re){var Ae=Re[p];Object.keys(Ee).forEach(function(He){var it=[Po,Mo].indexOf(He)>=0?1:-1,vt=[Un,Mo].indexOf(He)>=0?"y":"x";Ee[He]+=Ae[vt]*it})}return Ee}var Eb={placement:"bottom",modifiers:[],strategy:"absolute"};function Cb(){for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return!n.some(function(h){return!(h&&typeof h.getBoundingClientRect=="function")})}function bR(t){t===void 0&&(t={});var n=t,l=n.defaultModifiers,h=l===void 0?[]:l,p=n.defaultOptions,y=p===void 0?Eb:p;return function(a,I,z){z===void 0&&(z=y);var P={placement:"bottom",orderedModifiers:[],options:Object.assign({},Eb,y),modifiersData:{},elements:{reference:a,popper:I},attributes:{},styles:{}},k=[],N=!1,F={state:P,setOptions:function(Se){var be=typeof Se=="function"?Se(P.options):Se;X(),P.options=Object.assign({},y,P.options,be),P.scrollParents={reference:Al(a)?Dh(a):a.contextElement?Dh(a.contextElement):[],popper:Dh(I)};var Q=dR(pR([].concat(h,P.options.modifiers)));return P.orderedModifiers=Q.filter(function(re){return re.enabled}),H(),F.update()},forceUpdate:function(){if(!N){var Se=P.elements,be=Se.reference,Q=Se.popper;if(Cb(be,Q)){P.rects={reference:Xz(be,od(Q),P.options.strategy==="fixed"),popper:ey(Q)},P.reset=!1,P.placement=P.options.placement,P.orderedModifiers.forEach(function(Ee){return P.modifiersData[Ee.name]=Object.assign({},Ee.data)});for(var re=0;re<P.orderedModifiers.length;re++){if(P.reset===!0){P.reset=!1,re=-1;continue}var J=P.orderedModifiers[re],le=J.fn,Me=J.options,Ie=Me===void 0?{}:Me,Be=J.name;typeof le=="function"&&(P=le({state:P,options:Ie,name:Be,instance:F})||P)}}}},update:fR(function(){return new Promise(function(ae){F.forceUpdate(),ae(P)})}),destroy:function(){X(),N=!0}};if(!Cb(a,I))return F;F.setOptions(z).then(function(ae){!N&&z.onFirstUpdate&&z.onFirstUpdate(ae)});function H(){P.orderedModifiers.forEach(function(ae){var Se=ae.name,be=ae.options,Q=be===void 0?{}:be,re=ae.effect;if(typeof re=="function"){var J=re({state:P,name:Se,instance:F,options:Q}),le=function(){};k.push(J||le)}})}function X(){k.forEach(function(ae){return ae()}),k=[]}return F}}var Ff={passive:!0};function xR(t){var n=t.state,l=t.instance,h=t.options,p=h.scroll,y=p===void 0?!0:p,m=h.resize,a=m===void 0?!0:m,I=Zn(n.elements.popper),z=[].concat(n.scrollParents.reference,n.scrollParents.popper);return y&&z.forEach(function(P){P.addEventListener("scroll",l.update,Ff)}),a&&I.addEventListener("resize",l.update,Ff),function(){y&&z.forEach(function(P){P.removeEventListener("scroll",l.update,Ff)}),a&&I.removeEventListener("resize",l.update,Ff)}}const Kw={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:xR,data:{}};function wR(t){var n=t.state,l=t.name;n.modifiersData[l]=Zw({reference:n.rects.reference,element:n.rects.popper,placement:n.placement})}const TR={name:"popperOffsets",enabled:!0,phase:"read",fn:wR,data:{}};var SR={top:"auto",right:"auto",bottom:"auto",left:"auto"};function ER(t,n){var l=t.x,h=t.y,p=n.devicePixelRatio||1;return{x:Wc(l*p)/p||0,y:Wc(h*p)/p||0}}function Ib(t){var n,l=t.popper,h=t.popperRect,p=t.placement,y=t.variation,m=t.offsets,a=t.position,I=t.gpuAcceleration,z=t.adaptive,P=t.roundOffsets,k=t.isFixed,N=m.x,F=N===void 0?0:N,H=m.y,X=H===void 0?0:H,ae=typeof P=="function"?P({x:F,y:X}):{x:F,y:X};F=ae.x,X=ae.y;var Se=m.hasOwnProperty("x"),be=m.hasOwnProperty("y"),Q=Gn,re=Un,J=window;if(z){var le=od(l),Me="clientHeight",Ie="clientWidth";if(le===Zn(l)&&(le=ka(l),Ls(le).position!=="static"&&a==="absolute"&&(Me="scrollHeight",Ie="scrollWidth")),le=le,p===Un||(p===Gn||p===Po)&&y===Kh){re=Mo;var Be=k&&le===J&&J.visualViewport?J.visualViewport.height:le[Me];X-=Be-h.height,X*=I?1:-1}if(p===Gn||(p===Un||p===Mo)&&y===Kh){Q=Po;var Ee=k&&le===J&&J.visualViewport?J.visualViewport.width:le[Ie];F-=Ee-h.width,F*=I?1:-1}}var Re=Object.assign({position:a},z&&SR),Ae=P===!0?ER({x:F,y:X},Zn(l)):{x:F,y:X};if(F=Ae.x,X=Ae.y,I){var He;return Object.assign({},Re,(He={},He[re]=be?"0":"",He[Q]=Se?"0":"",He.transform=(J.devicePixelRatio||1)<=1?"translate("+F+"px, "+X+"px)":"translate3d("+F+"px, "+X+"px, 0)",He))}return Object.assign({},Re,(n={},n[re]=be?X+"px":"",n[Q]=Se?F+"px":"",n.transform="",n))}function CR(t){var n=t.state,l=t.options,h=l.gpuAcceleration,p=h===void 0?!0:h,y=l.adaptive,m=y===void 0?!0:y,a=l.roundOffsets,I=a===void 0?!0:a,z={placement:Xo(n.placement),variation:Yc(n.placement),popper:n.elements.popper,popperRect:n.rects.popper,gpuAcceleration:p,isFixed:n.options.strategy==="fixed"};n.modifiersData.popperOffsets!=null&&(n.styles.popper=Object.assign({},n.styles.popper,Ib(Object.assign({},z,{offsets:n.modifiersData.popperOffsets,position:n.options.strategy,adaptive:m,roundOffsets:I})))),n.modifiersData.arrow!=null&&(n.styles.arrow=Object.assign({},n.styles.arrow,Ib(Object.assign({},z,{offsets:n.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:I})))),n.attributes.popper=Object.assign({},n.attributes.popper,{"data-popper-placement":n.placement})}const Xw={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:CR,data:{}};function IR(t){var n=t.state;Object.keys(n.elements).forEach(function(l){var h=n.styles[l]||{},p=n.attributes[l]||{},y=n.elements[l];!so(y)||!Jo(y)||(Object.assign(y.style,h),Object.keys(p).forEach(function(m){var a=p[m];a===!1?y.removeAttribute(m):y.setAttribute(m,a===!0?"":a)}))})}function MR(t){var n=t.state,l={popper:{position:n.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(n.elements.popper.style,l.popper),n.styles=l,n.elements.arrow&&Object.assign(n.elements.arrow.style,l.arrow),function(){Object.keys(n.elements).forEach(function(h){var p=n.elements[h],y=n.attributes[h]||{},m=Object.keys(n.styles.hasOwnProperty(h)?n.styles[h]:l[h]),a=m.reduce(function(I,z){return I[z]="",I},{});!so(p)||!Jo(p)||(Object.assign(p.style,a),Object.keys(y).forEach(function(I){p.removeAttribute(I)}))})}}const PR={name:"applyStyles",enabled:!0,phase:"write",fn:IR,effect:MR,requires:["computeStyles"]};var AR=[Kw,TR,Xw,PR],kR={left:"right",right:"left",bottom:"top",top:"bottom"};function qf(t){return t.replace(/left|right|bottom|top/g,function(n){return kR[n]})}var LR={start:"end",end:"start"};function Mb(t){return t.replace(/start|end/g,function(n){return LR[n]})}function zR(t,n){n===void 0&&(n={});var l=n,h=l.placement,p=l.boundary,y=l.rootBoundary,m=l.padding,a=l.flipVariations,I=l.allowedAutoPlacements,z=I===void 0?Uw:I,P=Yc(h),k=P?a?Tb:Tb.filter(function(H){return Yc(H)===P}):sd,N=k.filter(function(H){return z.indexOf(H)>=0});N.length===0&&(N=k);var F=N.reduce(function(H,X){return H[X]=iy(t,{placement:X,boundary:p,rootBoundary:y,padding:m})[Xo(X)],H},{});return Object.keys(F).sort(function(H,X){return F[H]-F[X]})}function RR(t){if(Xo(t)===ty)return[];var n=qf(t);return[Mb(t),n,Mb(n)]}function DR(t){var n=t.state,l=t.options,h=t.name;if(!n.modifiersData[h]._skip){for(var p=l.mainAxis,y=p===void 0?!0:p,m=l.altAxis,a=m===void 0?!0:m,I=l.fallbackPlacements,z=l.padding,P=l.boundary,k=l.rootBoundary,N=l.altBoundary,F=l.flipVariations,H=F===void 0?!0:F,X=l.allowedAutoPlacements,ae=n.options.placement,Se=Xo(ae),be=Se===ae,Q=I||(be||!H?[qf(ae)]:RR(ae)),re=[ae].concat(Q).reduce(function(Lr,Pt){return Lr.concat(Xo(Pt)===ty?zR(n,{placement:Pt,boundary:P,rootBoundary:k,padding:z,flipVariations:H,allowedAutoPlacements:X}):Pt)},[]),J=n.rects.reference,le=n.rects.popper,Me=new Map,Ie=!0,Be=re[0],Ee=0;Ee<re.length;Ee++){var Re=re[Ee],Ae=Xo(Re),He=Yc(Re)===Xc,it=[Un,Mo].indexOf(Ae)>=0,vt=it?"width":"height",Xe=iy(n,{placement:Re,boundary:P,rootBoundary:k,altBoundary:N,padding:z}),xt=it?He?Po:Gn:He?Mo:Un;J[vt]>le[vt]&&(xt=qf(xt));var yt=qf(xt),Rt=[];if(y&&Rt.push(Xe[Ae]<=0),a&&Rt.push(Xe[xt]<=0,Xe[yt]<=0),Rt.every(function(Lr){return Lr})){Be=Re,Ie=!1;break}Me.set(Re,Rt)}if(Ie)for(var Mr=H?3:1,_r=function(Pt){var Yt=re.find(function(Jt){var hr=Me.get(Jt);if(hr)return hr.slice(0,Pt).every(function(vr){return vr})});if(Yt)return Be=Yt,"break"},pr=Mr;pr>0;pr--){var Tr=_r(pr);if(Tr==="break")break}n.placement!==Be&&(n.modifiersData[h]._skip=!0,n.placement=Be,n.reset=!0)}}const OR={name:"flip",enabled:!0,phase:"main",fn:DR,requiresIfExists:["offset"],data:{_skip:!1}};function FR(t,n,l){var h=Xo(t),p=[Gn,Un].indexOf(h)>=0?-1:1,y=typeof l=="function"?l(Object.assign({},n,{placement:t})):l,m=y[0],a=y[1];return m=m||0,a=(a||0)*p,[Gn,Po].indexOf(h)>=0?{x:a,y:m}:{x:m,y:a}}function BR(t){var n=t.state,l=t.options,h=t.name,p=l.offset,y=p===void 0?[0,0]:p,m=Uw.reduce(function(P,k){return P[k]=FR(k,n.rects,y),P},{}),a=m[n.placement],I=a.x,z=a.y;n.modifiersData.popperOffsets!=null&&(n.modifiersData.popperOffsets.x+=I,n.modifiersData.popperOffsets.y+=z),n.modifiersData[h]=m}const jR={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:BR};function NR(t){return t==="x"?"y":"x"}function Oh(t,n,l){return Sl(t,pp(n,l))}function VR(t,n,l){var h=Oh(t,n,l);return h>l?l:h}function $R(t){var n=t.state,l=t.options,h=t.name,p=l.mainAxis,y=p===void 0?!0:p,m=l.altAxis,a=m===void 0?!1:m,I=l.boundary,z=l.rootBoundary,P=l.altBoundary,k=l.padding,N=l.tether,F=N===void 0?!0:N,H=l.tetherOffset,X=H===void 0?0:H,ae=iy(n,{boundary:I,rootBoundary:z,padding:k,altBoundary:P}),Se=Xo(n.placement),be=Yc(n.placement),Q=!be,re=ry(Se),J=NR(re),le=n.modifiersData.popperOffsets,Me=n.rects.reference,Ie=n.rects.popper,Be=typeof X=="function"?X(Object.assign({},n.rects,{placement:n.placement})):X,Ee=typeof Be=="number"?{mainAxis:Be,altAxis:Be}:Object.assign({mainAxis:0,altAxis:0},Be),Re=n.modifiersData.offset?n.modifiersData.offset[n.placement]:null,Ae={x:0,y:0};if(le){if(y){var He,it=re==="y"?Un:Gn,vt=re==="y"?Mo:Po,Xe=re==="y"?"height":"width",xt=le[re],yt=xt+ae[it],Rt=xt-ae[vt],Mr=F?-Ie[Xe]/2:0,_r=be===Xc?Me[Xe]:Ie[Xe],pr=be===Xc?-Ie[Xe]:-Me[Xe],Tr=n.elements.arrow,Lr=F&&Tr?ey(Tr):{width:0,height:0},Pt=n.modifiersData["arrow#persistent"]?n.modifiersData["arrow#persistent"].padding:qw(),Yt=Pt[it],Jt=Pt[vt],hr=Oh(0,Me[Xe],Lr[Xe]),vr=Q?Me[Xe]/2-Mr-hr-Yt-Ee.mainAxis:_r-hr-Yt-Ee.mainAxis,Ti=Q?-Me[Xe]/2+Mr+hr+Jt+Ee.mainAxis:pr+hr+Jt+Ee.mainAxis,Pr=n.elements.arrow&&od(n.elements.arrow),Sr=Pr?re==="y"?Pr.clientTop||0:Pr.clientLeft||0:0,pe=(He=Re==null?void 0:Re[re])!=null?He:0,we=xt+vr-pe-Sr,We=xt+Ti-pe,at=Oh(F?pp(yt,we):yt,xt,F?Sl(Rt,We):Rt);le[re]=at,Ae[re]=at-xt}if(a){var nt,st=re==="x"?Un:Gn,_t=re==="x"?Mo:Po,ut=le[J],ht=J==="y"?"height":"width",lt=ut+ae[st],Lt=ut-ae[_t],bt=[Un,Gn].indexOf(Se)!==-1,It=(nt=Re==null?void 0:Re[J])!=null?nt:0,Ot=bt?lt:ut-Me[ht]-Ie[ht]-It+Ee.altAxis,qt=bt?ut+Me[ht]+Ie[ht]-It-Ee.altAxis:Lt,ir=F&&bt?VR(Ot,ut,qt):Oh(F?Ot:lt,ut,F?qt:Lt);le[J]=ir,Ae[J]=ir-ut}n.modifiersData[h]=Ae}}const UR={name:"preventOverflow",enabled:!0,phase:"main",fn:$R,requiresIfExists:["offset"]};var GR=function(n,l){return n=typeof n=="function"?n(Object.assign({},l.rects,{placement:l.placement})):n,Hw(typeof n!="number"?n:Ww(n,sd))};function ZR(t){var n,l=t.state,h=t.name,p=t.options,y=l.elements.arrow,m=l.modifiersData.popperOffsets,a=Xo(l.placement),I=ry(a),z=[Gn,Po].indexOf(a)>=0,P=z?"height":"width";if(!(!y||!m)){var k=GR(p.padding,l),N=ey(y),F=I==="y"?Un:Gn,H=I==="y"?Mo:Po,X=l.rects.reference[P]+l.rects.reference[I]-m[I]-l.rects.popper[P],ae=m[I]-l.rects.reference[I],Se=od(y),be=Se?I==="y"?Se.clientHeight||0:Se.clientWidth||0:0,Q=X/2-ae/2,re=k[F],J=be-N[P]-k[H],le=be/2-N[P]/2+Q,Me=Oh(re,le,J),Ie=I;l.modifiersData[h]=(n={},n[Ie]=Me,n.centerOffset=Me-le,n)}}function qR(t){var n=t.state,l=t.options,h=l.element,p=h===void 0?"[data-popper-arrow]":h;p!=null&&(typeof p=="string"&&(p=n.elements.popper.querySelector(p),!p)||Gw(n.elements.popper,p)&&(n.elements.arrow=p))}const HR={name:"arrow",enabled:!0,phase:"main",fn:ZR,effect:qR,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]},WR=bR({defaultModifiers:[...AR,jR,OR,UR,Xw,Kw,HR]});function KR({locked:t=!1,overflowPadding:n=8,offsetDistance:l=8,offsetSkid:h=0,gpuAcceleration:p=!0,adaptive:y=!0,scroll:m=!0,resize:a=!0,arrow:I=!1,placement:z,strategy:P},k){const N=$t(null),F=$t(null),H=$t(null);return Sn(()=>{lo(X=>{if(!F.value||!N.value)return;const ae=q0(F),Se=q0(N);if(!(ae instanceof HTMLElement)||!Se)return;const be={modifiers:[{name:"flip",enabled:!t},{name:"preventOverflow",options:{padding:n}},{name:"offset",options:{offset:[h,l]}},{name:"computeStyles",options:{adaptive:y,gpuAcceleration:p}},{name:"eventListeners",options:{scroll:m,resize:a}},{name:"arrow",enabled:I}]};z&&(be.placement=z),P&&(be.strategy=P),H.value=WR(Se,ae,be),X(H.value.destroy)})}),[N,F,H]}const Go=zl(ci.ui.strategy,ci.ui.select,EL),Ch=zl(ci.ui.strategy,ci.ui.selectMenu,CL),XR=Ur({components:{HCombobox:kz,HComboboxButton:Lz,HComboboxOptions:Rz,HComboboxOption:Dz,HComboboxInput:zz,HListbox:Uz,HListboxButton:Gz,HListboxOptions:Zz,HListboxOption:qz,UIcon:es,UAvatar:_w},inheritAttrs:!1,props:{modelValue:{type:[String,Number,Object,Array,Boolean],default:""},query:{type:String,default:null},by:{type:String,default:void 0},options:{type:Array,default:()=>[]},id:{type:String,default:null},name:{type:String,default:null},required:{type:Boolean,default:!1},icon:{type:String,default:null},loadingIcon:{type:String,default:()=>Go.default.loadingIcon},leadingIcon:{type:String,default:null},trailingIcon:{type:String,default:()=>Go.default.trailingIcon},trailing:{type:Boolean,default:!1},leading:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},selectedIcon:{type:String,default:()=>Ch.default.selectedIcon},disabled:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},searchable:{type:[Boolean,Function],default:!1},searchablePlaceholder:{type:String,default:()=>Ch.default.searchablePlaceholder.label},searchableLazy:{type:Boolean,default:!1},clearSearchOnClose:{type:Boolean,default:()=>Ch.default.clearSearchOnClose},debounce:{type:Number,default:200},creatable:{type:Boolean,default:!1},showCreateOptionWhen:{type:[String,Function],default:()=>Ch.default.showCreateOptionWhen},placeholder:{type:String,default:null},padded:{type:Boolean,default:!0},size:{type:String,default:null,validator(t){return Object.keys(Go.size).includes(t)}},color:{type:String,default:()=>Go.default.color,validator(t){return[...ci.ui.colors,...Object.keys(Go.color)].includes(t)}},variant:{type:String,default:()=>Go.default.variant,validator(t){return[...Object.keys(Go.variant),...Object.values(Go.color).flatMap(n=>Object.keys(n))].includes(t)}},optionAttribute:{type:String,default:"label"},valueAttribute:{type:String,default:null},searchAttributes:{type:Array,default:null},inputTargetForm:{type:String,default:null},popper:{type:Object,default:()=>({})},selectClass:{type:String,default:null},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})},uiMenu:{type:Object,default:()=>({})}},emits:["update:modelValue","update:query","open","close","change"],setup(t,{emit:n,slots:l}){const{ui:h,attrs:p}=Hc("select",Ko(t,"ui"),Go,Ko(t,"class")),{ui:y}=Hc("selectMenu",Ko(t,"uiMenu"),Ch),m=Ye(()=>rd({},t.popper,y.value.popper)),[a,I]=KR(m.value),z=Ye(()=>{if(!t.by)return;if(typeof t.by=="function")return t.by;const Pt=t.by;return Pt.indexOf(".")>0?(Jt,hr)=>Rt(Jt,Pt)===Rt(hr,Pt):Pt}),{size:P,rounded:k}=Lp({ui:h,props:t}),{emitFormBlur:N,emitFormChange:F,inputId:H,color:X,size:ae,name:Se}=gw(t,Go),be=Ye(()=>P.value??ae.value),Q=$t(""),re=Ye({get(){return t.query??Q.value},set(Pt){Q.value=Pt,n("update:query",Pt)}}),J=Ye(()=>{function Pt(Jt,hr){return z.value&&typeof z.value!="function"&&typeof Jt=="object"&&typeof hr=="object"?dp(Jt[z.value],hr[z.value]):dp(Jt,hr)}function Yt(Jt){return t.valueAttribute?Rt(Jt,t.valueAttribute):Jt}if(t.multiple){const Jt=t.modelValue;return!Array.isArray(Jt)||!Jt.length?[]:xt.value.filter(hr=>{const vr=Yt(hr);return Jt.some(Ti=>Pt(Ti,vr))})}return xt.value.find(Jt=>{const hr=Yt(Jt);return Pt(hr,Vt(t.modelValue))})??t.modelValue}),le=Ye(()=>t.modelValue?Array.isArray(t.modelValue)&&t.modelValue.length?`${t.modelValue.length} selected`:["string","number"].includes(typeof t.modelValue)?t.valueAttribute?Rt(J.value,t.optionAttribute):t.modelValue:Rt(t.modelValue,t.optionAttribute):null),Me=Ye(()=>{var Yt,Jt;const Pt=((Jt=(Yt=h.value.color)==null?void 0:Yt[X.value])==null?void 0:Jt[t.variant])||h.value.variant[t.variant];return Il(wi(h.value.base,y.value.select,k.value,h.value.size[be.value],h.value.gap[be.value],t.padded?h.value.padding[be.value]:"p-0",Pt==null?void 0:Pt.replaceAll("{color}",X.value),(Ie.value||l.leading)&&h.value.leading.padding[be.value],(Be.value||l.trailing)&&h.value.trailing.padding[be.value]),t.placeholder&&(!t.modelValue||Array.isArray(t.modelValue)&&!t.modelValue.length)&&h.value.placeholder,t.selectClass)}),Ie=Ye(()=>t.icon&&t.leading||t.icon&&!t.trailing||t.loading&&!t.trailing||t.leadingIcon),Be=Ye(()=>t.icon&&t.trailing||t.loading&&t.trailing||t.trailingIcon),Ee=Ye(()=>t.loading?t.loadingIcon:t.leadingIcon||t.icon),Re=Ye(()=>t.loading&&!Ie.value?t.loadingIcon:t.trailingIcon||t.icon),Ae=Ye(()=>wi(h.value.icon.leading.wrapper,h.value.icon.leading.pointer,h.value.icon.leading.padding[be.value])),He=Ye(()=>wi(h.value.icon.base,X.value&&ci.ui.colors.includes(X.value)&&h.value.icon.color.replaceAll("{color}",X.value),h.value.icon.size[be.value],t.loading&&h.value.icon.loading)),it=Ye(()=>wi(h.value.icon.trailing.wrapper,h.value.icon.trailing.pointer,h.value.icon.trailing.padding[be.value])),vt=Ye(()=>wi(h.value.icon.base,X.value&&ci.ui.colors.includes(X.value)&&h.value.icon.color.replaceAll("{color}",X.value),h.value.icon.size[be.value],t.loading&&!Ie.value&&h.value.icon.loading)),Xe=t.searchable&&typeof t.searchable=="function"?O1(t.searchable,t.debounce):void 0,xt=yP(async()=>Xe?await Xe(re.value):t.options||[],[],{lazy:t.searchableLazy});function yt(Pt){return Pt.replace(/[.*+?^${}()|[\]\\]/g,Yt=>`\\${Yt}`)}function Rt(Pt,Yt){return Hh(Pt,Yt)}const Mr=Ye(()=>{if(!re.value||Xe)return xt.value;const Pt=yt(re.value);return xt.value.filter(Yt=>{var Jt;return((Jt=t.searchAttributes)!=null&&Jt.length?t.searchAttributes:[t.optionAttribute]).some(hr=>{if(["string","number"].includes(typeof Yt))return String(Yt).search(new RegExp(Pt,"i"))!==-1;const vr=Hh(Yt,hr);return vr!=null&&String(vr).search(new RegExp(Pt,"i"))!==-1})})}),_r=Ye(()=>re.value===""||t.showCreateOptionWhen==="empty"&&Mr.value.length||t.showCreateOptionWhen==="always"&&Mr.value.find(Yt=>["string","number"].includes(typeof Yt)?Yt===re.value:Rt(Yt,t.optionAttribute)===re.value)||typeof t.showCreateOptionWhen=="function"&&!t.showCreateOptionWhen(re.value,Mr.value)?null:["string","number"].includes(typeof t.modelValue)?re.value:{[t.optionAttribute]:re.value});function pr(){t.clearSearchOnClose&&(re.value="")}Li(I,Pt=>{Pt?n("open"):(pr(),n("close"),N())});function Tr(Pt){Vt(t.modelValue)!==Pt&&(n("update:modelValue",Pt),n("change",Pt),F())}function Lr(Pt){re.value=Pt.target.value}return cz(()=>wx()),{ui:h,uiMenu:y,attrs:p,name:Se,inputId:H,popper:m,trigger:a,container:I,selected:J,label:le,accessor:Rt,isLeading:Ie,isTrailing:Be,selectClass:Me,leadingIconName:Ee,leadingIconClass:He,leadingWrapperIconClass:Ae,trailingIconName:Re,trailingIconClass:vt,trailingWrapperIconClass:it,filteredOptions:Mr,createOption:_r,query:re,onUpdate:Tr,onQueryChange:Lr,by:z}}}),YR=["value","required","form"],JR=["id","disabled"],QR={class:"truncate"};function eD(t,n,l,h,p,y){const m=es,a=Ag("HComboboxInput"),I=_w;return Bt(),kr(Sa(t.searchable?"HCombobox":"HListbox"),{by:t.by,name:t.name,"model-value":t.multiple?Array.isArray(t.modelValue)?t.modelValue:[]:t.modelValue,multiple:t.multiple,disabled:t.disabled,as:"div",class:Qt(t.ui.wrapper),"onUpdate:modelValue":t.onUpdate},{default:Zi(({open:z})=>[t.required?(Bt(),Vr("input",{key:0,value:t.modelValue,required:t.required,class:Qt(t.uiMenu.required),form:t.inputTargetForm,tabindex:"-1","aria-hidden":"true"},null,10,YR)):pi("",!0),(Bt(),kr(Sa(t.searchable?"HComboboxButton":"HListboxButton"),{ref:"trigger",as:"div",role:"button",class:Qt(t.uiMenu.trigger)},{default:Zi(()=>[Ai(t.$slots,"default",{open:z,disabled:t.disabled,loading:t.loading},()=>[xi("button",Eo({id:t.inputId,class:t.selectClass,disabled:t.disabled,type:"button"},t.attrs),[t.isLeading&&t.leadingIconName||t.$slots.leading?(Bt(),Vr("span",{key:0,class:Qt(t.leadingWrapperIconClass)},[Ai(t.$slots,"leading",{selected:t.selected,disabled:t.disabled,loading:t.loading},()=>[cr(m,{name:t.leadingIconName,class:Qt(t.leadingIconClass)},null,8,["name","class"])])],2)):pi("",!0),Ai(t.$slots,"label",{selected:t.selected},()=>[t.label?(Bt(),Vr("span",{key:0,class:Qt(t.uiMenu.label)},en(t.label),3)):(Bt(),Vr("span",{key:1,class:Qt(t.uiMenu.label)},en(t.placeholder||""),3))]),t.isTrailing&&t.trailingIconName||t.$slots.trailing?(Bt(),Vr("span",{key:1,class:Qt(t.trailingWrapperIconClass)},[Ai(t.$slots,"trailing",{selected:t.selected,disabled:t.disabled,loading:t.loading},()=>[cr(m,{name:t.trailingIconName,class:Qt(t.trailingIconClass),"aria-hidden":"true"},null,8,["name","class"])])],2)):pi("",!0)],16,JR)])]),_:2},1032,["class"])),z?(Bt(),Vr("div",{key:1,ref:"container",class:Qt([t.uiMenu.container,t.uiMenu.width])},[cr(uC,Eo({appear:""},t.uiMenu.transition),{default:Zi(()=>[xi("div",null,[t.popper.arrow?(Bt(),Vr("div",{key:0,"data-popper-arrow":"",class:Qt(Object.values(t.uiMenu.arrow))},null,2)):pi("",!0),(Bt(),kr(Sa(t.searchable?"HComboboxOptions":"HListboxOptions"),{static:"",class:Qt([t.uiMenu.base,t.uiMenu.ring,t.uiMenu.rounded,t.uiMenu.shadow,t.uiMenu.background,t.uiMenu.padding,t.uiMenu.height])},{default:Zi(()=>{var P,k;return[t.searchable?(Bt(),kr(a,{key:0,"display-value":()=>t.query,name:"q",placeholder:t.searchablePlaceholder,autofocus:"",autocomplete:"off",class:Qt(t.uiMenu.input),onChange:t.onQueryChange},null,8,["display-value","placeholder","class","onChange"])):pi("",!0),(Bt(!0),Vr(ki,null,fE(t.filteredOptions,(N,F)=>(Bt(),kr(Sa(t.searchable?"HComboboxOption":"HListboxOption"),{key:F,as:"template",value:t.valueAttribute?t.accessor(N,t.valueAttribute):N,disabled:N.disabled},{default:Zi(({active:H,selected:X,disabled:ae})=>[xi("li",{class:Qt([t.uiMenu.option.base,t.uiMenu.option.rounded,t.uiMenu.option.padding,t.uiMenu.option.size,t.uiMenu.option.color,H?t.uiMenu.option.active:t.uiMenu.option.inactive,X&&t.uiMenu.option.selected,ae&&t.uiMenu.option.disabled])},[xi("div",{class:Qt(t.uiMenu.option.container)},[Ai(t.$slots,"option",{option:N,active:H,selected:X},()=>[N.icon?(Bt(),kr(m,{key:0,name:N.icon,class:Qt([t.uiMenu.option.icon.base,H?t.uiMenu.option.icon.active:t.uiMenu.option.icon.inactive,N.iconClass]),"aria-hidden":"true"},null,8,["name","class"])):N.avatar?(Bt(),kr(I,Eo({key:1,ref_for:!0},{size:t.uiMenu.option.avatar.size,...N.avatar},{class:t.uiMenu.option.avatar.base,"aria-hidden":"true"}),null,16,["class"])):N.chip?(Bt(),Vr("span",{key:2,class:Qt(t.uiMenu.option.chip.base),style:Yh({background:`#${N.chip}`})},null,6)):pi("",!0),xi("span",QR,en(["string","number"].includes(typeof N)?N:t.accessor(N,t.optionAttribute)),1)])],2),X?(Bt(),Vr("span",{key:0,class:Qt([t.uiMenu.option.selectedIcon.wrapper,t.uiMenu.option.selectedIcon.padding])},[cr(m,{name:t.selectedIcon,class:Qt(t.uiMenu.option.selectedIcon.base),"aria-hidden":"true"},null,8,["name","class"])],2)):pi("",!0)],2)]),_:2},1032,["value","disabled"]))),128)),t.creatable&&t.createOption?(Bt(),kr(Sa(t.searchable?"HComboboxOption":"HListboxOption"),{key:1,value:t.createOption,as:"template"},{default:Zi(({active:N,selected:F})=>[xi("li",{class:Qt([t.uiMenu.option.base,t.uiMenu.option.rounded,t.uiMenu.option.padding,t.uiMenu.option.size,t.uiMenu.option.color,N?t.uiMenu.option.active:t.uiMenu.option.inactive])},[xi("div",{class:Qt(t.uiMenu.option.container)},[Ai(t.$slots,"option-create",{option:t.createOption,active:N,selected:F},()=>[xi("span",{class:Qt(t.uiMenu.option.create)},'Create "'+en(typeof t.createOption=="string"?t.createOption:t.accessor(t.createOption,t.optionAttribute))+'"',3)])],2)],2)]),_:3},8,["value"])):t.searchable&&t.query&&!((P=t.filteredOptions)!=null&&P.length)?(Bt(),Vr("p",{key:2,class:Qt(t.uiMenu.option.empty)},[Ai(t.$slots,"option-empty",{query:t.query},()=>[Tl(en(t.uiMenu.default.optionEmpty.label.replace("{query}",t.query)),1)])],2)):(k=t.filteredOptions)!=null&&k.length?pi("",!0):(Bt(),Vr("p",{key:3,class:Qt(t.uiMenu.empty)},[Ai(t.$slots,"empty",{query:t.query},()=>[Tl(en(t.uiMenu.default.empty.label),1)])],2))]}),_:3},8,["class"]))])]),_:3},16)],2)):pi("",!0)]),_:3},8,["by","name","model-value","multiple","disabled","class","onUpdate:modelValue"])}const tD=Qo(XR,[["render",eD]]);function rD(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Hf={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.3.0/LICENSE.txt
 */var iD=Hf.exports,Pb;function nD(){return Pb||(Pb=1,function(t,n){(function(l,h){t.exports=h()})(iD,function(){var l={},h={};function p(m,a,I){if(h[m]=I,m==="index"){var z="var sharedModule = {}; ("+h.shared+")(sharedModule); ("+h.worker+")(sharedModule);",P={};return h.shared(P),h.index(l,P),typeof window<"u"&&l.setWorkerUrl(window.URL.createObjectURL(new Blob([z],{type:"text/javascript"}))),l}}p("shared",["exports"],function(m){function a(o,r,s,c){return new(s||(s=Promise))(function(f,v){function b(C){try{S(c.next(C))}catch(A){v(A)}}function w(C){try{S(c.throw(C))}catch(A){v(A)}}function S(C){var A;C.done?f(C.value):(A=C.value,A instanceof s?A:new s(function(R){R(A)})).then(b,w)}S((c=c.apply(o,r||[])).next())})}function I(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var z,P;function k(){if(P)return z;function o(r,s){this.x=r,this.y=s}return P=1,z=o,o.prototype={clone:function(){return new o(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,s){return this.clone()._rotateAround(r,s)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var s=r.x-this.x,c=r.y-this.y;return s*s+c*c},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,s){return Math.atan2(this.x*s-this.y*r,this.x*r+this.y*s)},_matMult:function(r){var s=r[2]*this.x+r[3]*this.y;return this.x=r[0]*this.x+r[1]*this.y,this.y=s,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var s=Math.cos(r),c=Math.sin(r),f=c*this.x+s*this.y;return this.x=s*this.x-c*this.y,this.y=f,this},_rotateAround:function(r,s){var c=Math.cos(r),f=Math.sin(r),v=s.y+f*(this.x-s.x)+c*(this.y-s.y);return this.x=s.x+c*(this.x-s.x)-f*(this.y-s.y),this.y=v,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},o.convert=function(r){return r instanceof o?r:Array.isArray(r)?new o(r[0],r[1]):r},z}typeof SuppressedError=="function"&&SuppressedError;var N,F,H=I(k()),X=function(){if(F)return N;function o(r,s,c,f){this.cx=3*r,this.bx=3*(c-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(f-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=s,this.p2x=c,this.p2y=f}return F=1,N=o,o.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,s){if(s===void 0&&(s=1e-6),r<0)return 0;if(r>1)return 1;for(var c=r,f=0;f<8;f++){var v=this.sampleCurveX(c)-r;if(Math.abs(v)<s)return c;var b=this.sampleCurveDerivativeX(c);if(Math.abs(b)<1e-6)break;c-=v/b}var w=0,S=1;for(c=r,f=0;f<20&&(v=this.sampleCurveX(c),!(Math.abs(v-r)<s));f++)r>v?w=c:S=c,c=.5*(S-w)+w;return c},solve:function(r,s){return this.sampleCurveY(this.solveCurveX(r,s))}},N}(),ae=I(X);let Se,be;function Q(){return Se==null&&(Se=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Se}function re(){if(be==null&&(be=!1,Q())){const r=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(r){for(let c=0;c<5*5;c++){const f=4*c;r.fillStyle=`rgb(${f},${f+1},${f+2})`,r.fillRect(c%5,Math.floor(c/5),1,1)}const s=r.getImageData(0,0,5,5).data;for(let c=0;c<5*5*4;c++)if(c%4!=3&&s[c]!==c){be=!0;break}}}return be||!1}var J,le=1e-6,Me=typeof Float32Array<"u"?Float32Array:Array;function Ie(){var o=new Me(9);return Me!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[5]=0,o[6]=0,o[7]=0),o[0]=1,o[4]=1,o[8]=1,o}function Be(o){return o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o}function Ee(){var o=new Me(3);return Me!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0),o}function Re(o,r,s){var c=new Me(3);return c[0]=o,c[1]=r,c[2]=s,c}function Ae(o,r,s){var c=r[0],f=r[1],v=r[2],b=r[3];return o[0]=s[0]*c+s[4]*f+s[8]*v+s[12]*b,o[1]=s[1]*c+s[5]*f+s[9]*v+s[13]*b,o[2]=s[2]*c+s[6]*f+s[10]*v+s[14]*b,o[3]=s[3]*c+s[7]*f+s[11]*v+s[15]*b,o}function He(){var o=new Me(4);return Me!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0),o[3]=1,o}function it(){var o=new Me(2);return Me!=Float32Array&&(o[0]=0,o[1]=0),o}function vt(o,r){var s=new Me(2);return s[0]=o,s[1]=r,s}Math.hypot||(Math.hypot=function(){for(var o=0,r=arguments.length;r--;)o+=arguments[r]*arguments[r];return Math.sqrt(o)}),Ee(),J=new Me(4),Me!=Float32Array&&(J[0]=0,J[1]=0,J[2]=0,J[3]=0),Ee(),Re(1,0,0),Re(0,1,0),He(),He(),Ie(),it();const Xe=8192;function xt(o,r,s){return r*(Xe/(o.tileSize*Math.pow(2,s-o.tileID.overscaledZ)))}function yt(o,r){return(o%r+r)%r}function Rt(o,r,s){return o*(1-s)+r*s}function Mr(o){if(o<=0)return 0;if(o>=1)return 1;const r=o*o,s=r*o;return 4*(o<.5?s:3*(o-r)+s-.75)}function _r(o,r,s,c){const f=new ae(o,r,s,c);return v=>f.solve(v)}const pr=_r(.25,.1,.25,1);function Tr(o,r,s){return Math.min(s,Math.max(r,o))}function Lr(o,r,s){const c=s-r,f=((o-r)%c+c)%c+r;return f===r?s:f}function Pt(o,...r){for(const s of r)for(const c in s)o[c]=s[c];return o}let Yt=1;function Jt(o,r,s){const c={};for(const f in o)c[f]=r.call(this,o[f],f,o);return c}function hr(o,r,s){const c={};for(const f in o)r.call(this,o[f],f,o)&&(c[f]=o[f]);return c}function vr(o){return Array.isArray(o)?o.map(vr):typeof o=="object"&&o?Jt(o,vr):o}const Ti={};function Pr(o){Ti[o]||(typeof console<"u"&&console.warn(o),Ti[o]=!0)}function Sr(o,r,s){return(s.y-o.y)*(r.x-o.x)>(r.y-o.y)*(s.x-o.x)}function pe(o){return typeof WorkerGlobalScope<"u"&&o!==void 0&&o instanceof WorkerGlobalScope}let we=null;function We(o){return typeof ImageBitmap<"u"&&o instanceof ImageBitmap}const at="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function nt(o,r,s,c,f){return a(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const v=new VideoFrame(o,{timestamp:0});try{const b=v==null?void 0:v.format;if(!b||!b.startsWith("BGR")&&!b.startsWith("RGB"))throw new Error(`Unrecognized format ${b}`);const w=b.startsWith("BGR"),S=new Uint8ClampedArray(c*f*4);if(yield v.copyTo(S,function(C,A,R,j,$){const G=4*Math.max(1,0),W=(Math.max(0,R)-R)*j*4+G,te=4*j,se=Math.max(0,A),ye=Math.max(0,R);return{rect:{x:se,y:ye,width:Math.min(C.width,A+j)-se,height:Math.min(C.height,R+$)-ye},layout:[{offset:W,stride:te}]}}(o,r,s,c,f)),w)for(let C=0;C<S.length;C+=4){const A=S[C];S[C]=S[C+2],S[C+2]=A}return S}finally{v.close()}})}let st,_t;function ut(o,r,s,c){return o.addEventListener(r,s,c),{unsubscribe:()=>{o.removeEventListener(r,s,c)}}}function ht(o){return o/Math.PI*180}const lt={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},Lt={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},bt="AbortError";function It(){return new Error(bt)}const Ot={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function qt(o){return Ot.REGISTERED_PROTOCOLS[o.substring(0,o.indexOf("://"))]}const ir="global-dispatcher";class er extends Error{constructor(r,s,c,f){super(`AJAXError: ${s} (${r}): ${c}`),this.status=r,this.statusText=s,this.url=c,this.body=f}}const Wr=()=>pe(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Kr=function(o,r){if(/:\/\//.test(o.url)&&!/^https?:|^file:/.test(o.url)){const c=qt(o.url);if(c)return c(o,r);if(pe(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:o,targetMapId:ir},r)}if(!(/^file:/.test(s=o.url)||/^file:/.test(Wr())&&!/^\w+:/.test(s))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(c,f){return a(this,void 0,void 0,function*(){const v=new Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,cache:c.cache,referrer:Wr(),signal:f.signal});let b,w;c.type!=="json"||v.headers.has("Accept")||v.headers.set("Accept","application/json");try{b=yield fetch(v)}catch(C){throw new er(0,C.message,c.url,new Blob)}if(!b.ok){const C=yield b.blob();throw new er(b.status,b.statusText,c.url,C)}w=c.type==="arrayBuffer"||c.type==="image"?b.arrayBuffer():c.type==="json"?b.json():b.text();const S=yield w;if(f.signal.aborted)throw It();return{data:S,cacheControl:b.headers.get("Cache-Control"),expires:b.headers.get("Expires")}})}(o,r);if(pe(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:o,mustQueue:!0,targetMapId:ir},r)}var s;return function(c,f){return new Promise((v,b)=>{var w;const S=new XMLHttpRequest;S.open(c.method||"GET",c.url,!0),c.type!=="arrayBuffer"&&c.type!=="image"||(S.responseType="arraybuffer");for(const C in c.headers)S.setRequestHeader(C,c.headers[C]);c.type==="json"&&(S.responseType="text",!((w=c.headers)===null||w===void 0)&&w.Accept||S.setRequestHeader("Accept","application/json")),S.withCredentials=c.credentials==="include",S.onerror=()=>{b(new Error(S.statusText))},S.onload=()=>{if(!f.signal.aborted)if((S.status>=200&&S.status<300||S.status===0)&&S.response!==null){let C=S.response;if(c.type==="json")try{C=JSON.parse(S.response)}catch(A){return void b(A)}v({data:C,cacheControl:S.getResponseHeader("Cache-Control"),expires:S.getResponseHeader("Expires")})}else{const C=new Blob([S.response],{type:S.getResponseHeader("Content-Type")});b(new er(S.status,S.statusText,c.url,C))}},f.signal.addEventListener("abort",()=>{S.abort(),b(It())}),S.send(c.body)})}(o,r)};function zi(o){if(!o||o.indexOf("://")<=0||o.indexOf("data:image/")===0||o.indexOf("blob:")===0)return!0;const r=new URL(o),s=window.location;return r.protocol===s.protocol&&r.host===s.host}function Si(o,r,s){s[o]&&s[o].indexOf(r)!==-1||(s[o]=s[o]||[],s[o].push(r))}function Ki(o,r,s){if(s&&s[o]){const c=s[o].indexOf(r);c!==-1&&s[o].splice(c,1)}}class Pe{constructor(r,s={}){Pt(this,s),this.type=r}}class q extends Pe{constructor(r,s={}){super("error",Pt({error:r},s))}}class Y{on(r,s){return this._listeners=this._listeners||{},Si(r,s,this._listeners),{unsubscribe:()=>{this.off(r,s)}}}off(r,s){return Ki(r,s,this._listeners),Ki(r,s,this._oneTimeListeners),this}once(r,s){return s?(this._oneTimeListeners=this._oneTimeListeners||{},Si(r,s,this._oneTimeListeners),this):new Promise(c=>this.once(r,c))}fire(r,s){typeof r=="string"&&(r=new Pe(r,s||{}));const c=r.type;if(this.listens(c)){r.target=this;const f=this._listeners&&this._listeners[c]?this._listeners[c].slice():[];for(const w of f)w.call(this,r);const v=this._oneTimeListeners&&this._oneTimeListeners[c]?this._oneTimeListeners[c].slice():[];for(const w of v)Ki(c,w,this._oneTimeListeners),w.call(this,r);const b=this._eventedParent;b&&(Pt(r,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),b.fire(r))}else r instanceof q&&console.error(r.error);return this}listens(r){return this._listeners&&this._listeners[r]&&this._listeners[r].length>0||this._oneTimeListeners&&this._oneTimeListeners[r]&&this._oneTimeListeners[r].length>0||this._eventedParent&&this._eventedParent.listens(r)}setEventedParent(r,s){return this._eventedParent=r,this._eventedParentData=s,this}}var U={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const he=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function xe(o,r){const s={};for(const c in o)c!=="ref"&&(s[c]=o[c]);return he.forEach(c=>{c in r&&(s[c]=r[c])}),s}function ve(o,r){if(Array.isArray(o)){if(!Array.isArray(r)||o.length!==r.length)return!1;for(let s=0;s<o.length;s++)if(!ve(o[s],r[s]))return!1;return!0}if(typeof o=="object"&&o!==null&&r!==null){if(typeof r!="object"||Object.keys(o).length!==Object.keys(r).length)return!1;for(const s in o)if(!ve(o[s],r[s]))return!1;return!0}return o===r}function ze(o,r){o.push(r)}function Ce(o,r,s){ze(s,{command:"addSource",args:[o,r[o]]})}function Ge(o,r,s){ze(r,{command:"removeSource",args:[o]}),s[o]=!0}function Ne(o,r,s,c){Ge(o,s,c),Ce(o,r,s)}function ke(o,r,s){let c;for(c in o[s])if(Object.prototype.hasOwnProperty.call(o[s],c)&&c!=="data"&&!ve(o[s][c],r[s][c]))return!1;for(c in r[s])if(Object.prototype.hasOwnProperty.call(r[s],c)&&c!=="data"&&!ve(o[s][c],r[s][c]))return!1;return!0}function Qe(o,r,s,c,f,v){o=o||{},r=r||{};for(const b in o)Object.prototype.hasOwnProperty.call(o,b)&&(ve(o[b],r[b])||s.push({command:v,args:[c,b,r[b],f]}));for(const b in r)Object.prototype.hasOwnProperty.call(r,b)&&!Object.prototype.hasOwnProperty.call(o,b)&&(ve(o[b],r[b])||s.push({command:v,args:[c,b,r[b],f]}))}function mt(o){return o.id}function gt(o,r){return o[r.id]=r,o}class Ve{constructor(r,s,c,f){this.message=(r?`${r}: `:"")+c,f&&(this.identifier=f),s!=null&&s.__line__&&(this.line=s.__line__)}}function Nt(o,...r){for(const s of r)for(const c in s)o[c]=s[c];return o}class kt extends Error{constructor(r,s){super(s),this.message=s,this.key=r}}class jt{constructor(r,s=[]){this.parent=r,this.bindings={};for(const[c,f]of s)this.bindings[c]=f}concat(r){return new jt(this,r)}get(r){if(this.bindings[r])return this.bindings[r];if(this.parent)return this.parent.get(r);throw new Error(`${r} not found in scope.`)}has(r){return!!this.bindings[r]||!!this.parent&&this.parent.has(r)}}const ar={kind:"null"},rt={kind:"number"},St={kind:"string"},pt={kind:"boolean"},Ut={kind:"color"},Xr={kind:"projectionDefinition"},uo={kind:"object"},Ft={kind:"value"},mi={kind:"collator"},zr={kind:"formatted"},Dl={kind:"padding"},Ds={kind:"resolvedImage"},Ao={kind:"variableAnchorOffsetCollection"};function on(o,r){return{kind:"array",itemType:o,N:r}}function Gr(o){if(o.kind==="array"){const r=Gr(o.itemType);return typeof o.N=="number"?`array<${r}, ${o.N}>`:o.itemType.kind==="value"?"array":`array<${r}>`}return o.kind}const Op=[ar,rt,St,pt,Ut,Xr,zr,uo,on(Ft),Dl,Ds,Ao];function Os(o,r){if(r.kind==="error")return null;if(o.kind==="array"){if(r.kind==="array"&&(r.N===0&&r.itemType.kind==="value"||!Os(o.itemType,r.itemType))&&(typeof o.N!="number"||o.N===r.N))return null}else{if(o.kind===r.kind)return null;if(o.kind==="value"){for(const s of Op)if(!Os(s,r))return null}}return`Expected ${Gr(o)} but found ${Gr(r)} instead.`}function nu(o,r){return r.some(s=>s.kind===o.kind)}function ko(o,r){return r.some(s=>s==="null"?o===null:s==="array"?Array.isArray(o):s==="object"?o&&!Array.isArray(o)&&typeof o=="object":s===typeof o)}function Fs(o,r){return o.kind==="array"&&r.kind==="array"?o.itemType.kind===r.itemType.kind&&typeof o.N=="number":o.kind===r.kind}const ld=.96422,cd=.82521,ud=4/29,Bs=6/29,hd=3*Bs*Bs,Fp=Bs*Bs*Bs,dd=Math.PI/180,La=180/Math.PI;function fd(o){return(o%=360)<0&&(o+=360),o}function pd([o,r,s,c]){let f,v;const b=ou((.2225045*(o=rs(o))+.7168786*(r=rs(r))+.0606169*(s=rs(s)))/1);o===r&&r===s?f=v=b:(f=ou((.4360747*o+.3850649*r+.1430804*s)/ld),v=ou((.0139322*o+.0971045*r+.7141733*s)/cd));const w=116*b-16;return[w<0?0:w,500*(f-b),200*(b-v),c]}function rs(o){return o<=.04045?o/12.92:Math.pow((o+.055)/1.055,2.4)}function ou(o){return o>Fp?Math.pow(o,1/3):o/hd+ud}function md([o,r,s,c]){let f=(o+16)/116,v=isNaN(r)?f:f+r/500,b=isNaN(s)?f:f-s/200;return f=1*Ol(f),v=ld*Ol(v),b=cd*Ol(b),[su(3.1338561*v-1.6168667*f-.4906146*b),su(-.9787684*v+1.9161415*f+.033454*b),su(.0719453*v-.2289914*f+1.4052427*b),c]}function su(o){return(o=o<=.00304?12.92*o:1.055*Math.pow(o,1/2.4)-.055)<0?0:o>1?1:o}function Ol(o){return o>Bs?o*o*o:hd*(o-ud)}function za(o){return parseInt(o.padEnd(2,o),16)/255}function An(o,r){return tr(r?o/100:o,0,1)}function tr(o,r,s){return Math.min(Math.max(r,o),s)}function is(o){return!o.some(Number.isNaN)}const Lo={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function ho(o,r,s){return o+s*(r-o)}function js(o,r,s){return o.map((c,f)=>ho(c,r[f],s))}class lr{constructor(r,s,c,f=1,v=!0){this.r=r,this.g=s,this.b=c,this.a=f,v||(this.r*=f,this.g*=f,this.b*=f,f||this.overwriteGetter("rgb",[r,s,c,f]))}static parse(r){if(r instanceof lr)return r;if(typeof r!="string")return;const s=function(c){if((c=c.toLowerCase().trim())==="transparent")return[0,0,0,0];const f=Lo[c];if(f){const[b,w,S]=f;return[b/255,w/255,S/255,1]}if(c.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(c)){const b=c.length<6?1:2;let w=1;return[za(c.slice(w,w+=b)),za(c.slice(w,w+=b)),za(c.slice(w,w+=b)),za(c.slice(w,w+b)||"ff")]}if(c.startsWith("rgb")){const b=c.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(b){const[w,S,C,A,R,j,$,G,W,te,se,ye]=b,ue=[A||" ",$||" ",te].join("");if(ue==="  "||ue==="  /"||ue===",,"||ue===",,,"){const V=[C,j,W].join(""),ee=V==="%%%"?100:V===""?255:0;if(ee){const de=[tr(+S/ee,0,1),tr(+R/ee,0,1),tr(+G/ee,0,1),se?An(+se,ye):1];if(is(de))return de}}return}}const v=c.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(v){const[b,w,S,C,A,R,j,$,G]=v,W=[S||" ",A||" ",j].join("");if(W==="  "||W==="  /"||W===",,"||W===",,,"){const te=[+w,tr(+C,0,100),tr(+R,0,100),$?An(+$,G):1];if(is(te))return function([se,ye,ue,V]){function ee(de){const Fe=(de+se/30)%12,et=ye*Math.min(ue,1-ue);return ue-et*Math.max(-1,Math.min(Fe-3,9-Fe,1))}return se=fd(se),ye/=100,ue/=100,[ee(0),ee(8),ee(4),V]}(te)}}}(r);return s?new lr(...s,!1):void 0}get rgb(){const{r,g:s,b:c,a:f}=this,v=f||1/0;return this.overwriteGetter("rgb",[r/v,s/v,c/v,f])}get hcl(){return this.overwriteGetter("hcl",function(r){const[s,c,f,v]=pd(r),b=Math.sqrt(c*c+f*f);return[Math.round(1e4*b)?fd(Math.atan2(f,c)*La):NaN,b,s,v]}(this.rgb))}get lab(){return this.overwriteGetter("lab",pd(this.rgb))}overwriteGetter(r,s){return Object.defineProperty(this,r,{value:s}),s}toString(){const[r,s,c,f]=this.rgb;return`rgba(${[r,s,c].map(v=>Math.round(255*v)).join(",")},${f})`}static interpolate(r,s,c,f="rgb"){switch(f){case"rgb":{const[v,b,w,S]=js(r.rgb,s.rgb,c);return new lr(v,b,w,S,!1)}case"hcl":{const[v,b,w,S]=r.hcl,[C,A,R,j]=s.hcl;let $,G;if(isNaN(v)||isNaN(C))isNaN(v)?isNaN(C)?$=NaN:($=C,w!==1&&w!==0||(G=A)):($=v,R!==1&&R!==0||(G=b));else{let ue=C-v;C>v&&ue>180?ue-=360:C<v&&v-C>180&&(ue+=360),$=v+c*ue}const[W,te,se,ye]=function([ue,V,ee,de]){return ue=isNaN(ue)?0:ue*dd,md([ee,Math.cos(ue)*V,Math.sin(ue)*V,de])}([$,G??ho(b,A,c),ho(w,R,c),ho(S,j,c)]);return new lr(W,te,se,ye,!1)}case"lab":{const[v,b,w,S]=md(js(r.lab,s.lab,c));return new lr(v,b,w,S,!1)}}}}lr.black=new lr(0,0,0,1),lr.white=new lr(1,1,1,1),lr.transparent=new lr(0,0,0,0),lr.red=new lr(1,0,0,1);class En{constructor(r,s,c){this.sensitivity=r?s?"variant":"case":s?"accent":"base",this.locale=c,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(r,s){return this.collator.compare(r,s)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Ra=["bottom","center","top"];class Ns{constructor(r,s,c,f,v,b){this.text=r,this.image=s,this.scale=c,this.fontStack=f,this.textColor=v,this.verticalAlign=b}}class Xi{constructor(r){this.sections=r}static fromString(r){return new Xi([new Ns(r,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(r=>r.text.length!==0||r.image&&r.image.name.length!==0)}static factory(r){return r instanceof Xi?r:Xi.fromString(r)}toString(){return this.sections.length===0?"":this.sections.map(r=>r.text).join("")}}class Ri{constructor(r){this.values=r.slice()}static parse(r){if(r instanceof Ri)return r;if(typeof r=="number")return new Ri([r,r,r,r]);if(Array.isArray(r)&&!(r.length<1||r.length>4)){for(const s of r)if(typeof s!="number")return;switch(r.length){case 1:r=[r[0],r[0],r[0],r[0]];break;case 2:r=[r[0],r[1],r[0],r[1]];break;case 3:r=[r[0],r[1],r[2],r[1]]}return new Ri(r)}}toString(){return JSON.stringify(this.values)}static interpolate(r,s,c){return new Ri(js(r.values,s.values,c))}}class jr{constructor(r){this.name="ExpressionEvaluationError",this.message=r}toJSON(){return this.message}}const Fl=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Yi{constructor(r){this.values=r.slice()}static parse(r){if(r instanceof Yi)return r;if(Array.isArray(r)&&!(r.length<1)&&r.length%2==0){for(let s=0;s<r.length;s+=2){const c=r[s],f=r[s+1];if(typeof c!="string"||!Fl.has(c)||!Array.isArray(f)||f.length!==2||typeof f[0]!="number"||typeof f[1]!="number")return}return new Yi(r)}}toString(){return JSON.stringify(this.values)}static interpolate(r,s,c){const f=r.values,v=s.values;if(f.length!==v.length)throw new jr(`Cannot interpolate values of different length. from: ${r.toString()}, to: ${s.toString()}`);const b=[];for(let w=0;w<f.length;w+=2){if(f[w]!==v[w])throw new jr(`Cannot interpolate values containing mismatched anchors. from[${w}]: ${f[w]}, to[${w}]: ${v[w]}`);b.push(f[w]);const[S,C]=f[w+1],[A,R]=v[w+1];b.push([ho(S,A,c),ho(C,R,c)])}return new Yi(b)}}class sn{constructor(r){this.name=r.name,this.available=r.available}toString(){return this.name}static fromString(r){return r?new sn({name:r,available:!1}):null}}class gi{constructor(r,s,c){this.from=r,this.to=s,this.transition=c}static interpolate(r,s,c){return new gi(r,s,c)}static parse(r){return r instanceof gi?r:Array.isArray(r)&&r.length===3&&typeof r[0]=="string"&&typeof r[1]=="string"&&typeof r[2]=="number"?new gi(r[0],r[1],r[2]):typeof r=="object"&&typeof r.from=="string"&&typeof r.to=="string"&&typeof r.transition=="number"?new gi(r.from,r.to,r.transition):typeof r=="string"?new gi(r,r,1):void 0}}function gd(o,r,s,c){return typeof o=="number"&&o>=0&&o<=255&&typeof r=="number"&&r>=0&&r<=255&&typeof s=="number"&&s>=0&&s<=255?c===void 0||typeof c=="number"&&c>=0&&c<=1?null:`Invalid rgba value [${[o,r,s,c].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof c=="number"?[o,r,s,c]:[o,r,s]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function zo(o){if(o===null||typeof o=="string"||typeof o=="boolean"||typeof o=="number"||o instanceof gi||o instanceof lr||o instanceof En||o instanceof Xi||o instanceof Ri||o instanceof Yi||o instanceof sn)return!0;if(Array.isArray(o)){for(const r of o)if(!zo(r))return!1;return!0}if(typeof o=="object"){for(const r in o)if(!zo(o[r]))return!1;return!0}return!1}function Nr(o){if(o===null)return ar;if(typeof o=="string")return St;if(typeof o=="boolean")return pt;if(typeof o=="number")return rt;if(o instanceof lr)return Ut;if(o instanceof gi)return Xr;if(o instanceof En)return mi;if(o instanceof Xi)return zr;if(o instanceof Ri)return Dl;if(o instanceof Yi)return Ao;if(o instanceof sn)return Ds;if(Array.isArray(o)){const r=o.length;let s;for(const c of o){const f=Nr(c);if(s){if(s===f)continue;s=Ft;break}s=f}return on(s||Ft,r)}return uo}function Vs(o){const r=typeof o;return o===null?"":r==="string"||r==="number"||r==="boolean"?String(o):o instanceof lr||o instanceof gi||o instanceof Xi||o instanceof Ri||o instanceof Yi||o instanceof sn?o.toString():JSON.stringify(o)}class Ro{constructor(r,s){this.type=r,this.value=s}static parse(r,s){if(r.length!==2)return s.error(`'literal' expression requires exactly one argument, but found ${r.length-1} instead.`);if(!zo(r[1]))return s.error("invalid value");const c=r[1];let f=Nr(c);const v=s.expectedType;return f.kind!=="array"||f.N!==0||!v||v.kind!=="array"||typeof v.N=="number"&&v.N!==0||(f=v),new Ro(f,c)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Da={string:St,number:rt,boolean:pt,object:uo};class an{constructor(r,s){this.type=r,this.args=s}static parse(r,s){if(r.length<2)return s.error("Expected at least one argument.");let c,f=1;const v=r[0];if(v==="array"){let w,S;if(r.length>2){const C=r[1];if(typeof C!="string"||!(C in Da)||C==="object")return s.error('The item type argument of "array" must be one of string, number, boolean',1);w=Da[C],f++}else w=Ft;if(r.length>3){if(r[2]!==null&&(typeof r[2]!="number"||r[2]<0||r[2]!==Math.floor(r[2])))return s.error('The length argument to "array" must be a positive integer literal',2);S=r[2],f++}c=on(w,S)}else{if(!Da[v])throw new Error(`Types doesn't contain name = ${v}`);c=Da[v]}const b=[];for(;f<r.length;f++){const w=s.parse(r[f],f,Ft);if(!w)return null;b.push(w)}return new an(c,b)}evaluate(r){for(let s=0;s<this.args.length;s++){const c=this.args[s].evaluate(r);if(!Os(this.type,Nr(c)))return c;if(s===this.args.length-1)throw new jr(`Expected value to be of type ${Gr(this.type)}, but found ${Gr(Nr(c))} instead.`)}throw new Error}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}}const Rr={"to-boolean":pt,"to-color":Ut,"to-number":rt,"to-string":St};class Hn{constructor(r,s){this.type=r,this.args=s}static parse(r,s){if(r.length<2)return s.error("Expected at least one argument.");const c=r[0];if(!Rr[c])throw new Error(`Can't parse ${c} as it is not part of the known types`);if((c==="to-boolean"||c==="to-string")&&r.length!==2)return s.error("Expected one argument.");const f=Rr[c],v=[];for(let b=1;b<r.length;b++){const w=s.parse(r[b],b,Ft);if(!w)return null;v.push(w)}return new Hn(f,v)}evaluate(r){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(r);case"color":{let s,c;for(const f of this.args){if(s=f.evaluate(r),c=null,s instanceof lr)return s;if(typeof s=="string"){const v=r.parseColor(s);if(v)return v}else if(Array.isArray(s)&&(c=s.length<3||s.length>4?`Invalid rgba value ${JSON.stringify(s)}: expected an array containing either three or four numeric values.`:gd(s[0],s[1],s[2],s[3]),!c))return new lr(s[0]/255,s[1]/255,s[2]/255,s[3])}throw new jr(c||`Could not parse color from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"padding":{let s;for(const c of this.args){s=c.evaluate(r);const f=Ri.parse(s);if(f)return f}throw new jr(`Could not parse padding from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"variableAnchorOffsetCollection":{let s;for(const c of this.args){s=c.evaluate(r);const f=Yi.parse(s);if(f)return f}throw new jr(`Could not parse variableAnchorOffsetCollection from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"number":{let s=null;for(const c of this.args){if(s=c.evaluate(r),s===null)return 0;const f=Number(s);if(!isNaN(f))return f}throw new jr(`Could not convert ${JSON.stringify(s)} to number.`)}case"formatted":return Xi.fromString(Vs(this.args[0].evaluate(r)));case"resolvedImage":return sn.fromString(Vs(this.args[0].evaluate(r)));case"projectionDefinition":return this.args[0].evaluate(r);default:return Vs(this.args[0].evaluate(r))}}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}}const dr=["Unknown","Point","LineString","Polygon"];class Wt{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?dr[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(r){let s=this._parseColorCache[r];return s||(s=this._parseColorCache[r]=lr.parse(r)),s}}class $s{constructor(r,s,c=[],f,v=new jt,b=[]){this.registry=r,this.path=c,this.key=c.map(w=>`[${w}]`).join(""),this.scope=v,this.errors=b,this.expectedType=f,this._isConstant=s}parse(r,s,c,f,v={}){return s?this.concat(s,c,f)._parse(r,v):this._parse(r,v)}_parse(r,s){function c(f,v,b){return b==="assert"?new an(v,[f]):b==="coerce"?new Hn(v,[f]):f}if(r!==null&&typeof r!="string"&&typeof r!="boolean"&&typeof r!="number"||(r=["literal",r]),Array.isArray(r)){if(r.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const f=r[0];if(typeof f!="string")return this.error(`Expression name must be a string, but found ${typeof f} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const v=this.registry[f];if(v){let b=v.parse(r,this);if(!b)return null;if(this.expectedType){const w=this.expectedType,S=b.type;if(w.kind!=="string"&&w.kind!=="number"&&w.kind!=="boolean"&&w.kind!=="object"&&w.kind!=="array"||S.kind!=="value")if(w.kind!=="projectionDefinition"||S.kind!=="string"&&S.kind!=="array")if(w.kind!=="color"&&w.kind!=="formatted"&&w.kind!=="resolvedImage"||S.kind!=="value"&&S.kind!=="string")if(w.kind!=="padding"||S.kind!=="value"&&S.kind!=="number"&&S.kind!=="array")if(w.kind!=="variableAnchorOffsetCollection"||S.kind!=="value"&&S.kind!=="array"){if(this.checkSubtype(w,S))return null}else b=c(b,w,s.typeAnnotation||"coerce");else b=c(b,w,s.typeAnnotation||"coerce");else b=c(b,w,s.typeAnnotation||"coerce");else b=c(b,w,s.typeAnnotation||"coerce");else b=c(b,w,s.typeAnnotation||"assert")}if(!(b instanceof Ro)&&b.type.kind!=="resolvedImage"&&this._isConstant(b)){const w=new Wt;try{b=new Ro(b.type,b.evaluate(w))}catch(S){return this.error(S.message),null}}return b}return this.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(r===void 0?"'undefined' value invalid. Use null instead.":typeof r=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof r} instead.`)}concat(r,s,c){const f=typeof r=="number"?this.path.concat(r):this.path,v=c?this.scope.concat(c):this.scope;return new $s(this.registry,this._isConstant,f,s||null,v,this.errors)}error(r,...s){const c=`${this.key}${s.map(f=>`[${f}]`).join("")}`;this.errors.push(new kt(c,r))}checkSubtype(r,s){const c=Os(r,s);return c&&this.error(c),c}}class sr{constructor(r,s){this.type=s.type,this.bindings=[].concat(r),this.result=s}evaluate(r){return this.result.evaluate(r)}eachChild(r){for(const s of this.bindings)r(s[1]);r(this.result)}static parse(r,s){if(r.length<4)return s.error(`Expected at least 3 arguments, but found ${r.length-1} instead.`);const c=[];for(let v=1;v<r.length-1;v+=2){const b=r[v];if(typeof b!="string")return s.error(`Expected string, but found ${typeof b} instead.`,v);if(/[^a-zA-Z0-9_]/.test(b))return s.error("Variable names must contain only alphanumeric characters or '_'.",v);const w=s.parse(r[v+1],v+1);if(!w)return null;c.push([b,w])}const f=s.parse(r[r.length-1],r.length-1,s.expectedType,c);return f?new sr(c,f):null}outputDefined(){return this.result.outputDefined()}}class Us{constructor(r,s){this.type=s.type,this.name=r,this.boundExpression=s}static parse(r,s){if(r.length!==2||typeof r[1]!="string")return s.error("'var' expression requires exactly one string literal argument.");const c=r[1];return s.scope.has(c)?new Us(c,s.scope.get(c)):s.error(`Unknown variable "${c}". Make sure "${c}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(r){return this.boundExpression.evaluate(r)}eachChild(){}outputDefined(){return!1}}class kn{constructor(r,s,c){this.type=r,this.index=s,this.input=c}static parse(r,s){if(r.length!==3)return s.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const c=s.parse(r[1],1,rt),f=s.parse(r[2],2,on(s.expectedType||Ft));return c&&f?new kn(f.type.itemType,c,f):null}evaluate(r){const s=this.index.evaluate(r),c=this.input.evaluate(r);if(s<0)throw new jr(`Array index out of bounds: ${s} < 0.`);if(s>=c.length)throw new jr(`Array index out of bounds: ${s} > ${c.length-1}.`);if(s!==Math.floor(s))throw new jr(`Array index must be an integer, but found ${s} instead.`);return c[s]}eachChild(r){r(this.index),r(this.input)}outputDefined(){return!1}}class Oa{constructor(r,s){this.type=pt,this.needle=r,this.haystack=s}static parse(r,s){if(r.length!==3)return s.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const c=s.parse(r[1],1,Ft),f=s.parse(r[2],2,Ft);return c&&f?nu(c.type,[pt,St,rt,ar,Ft])?new Oa(c,f):s.error(`Expected first argument to be of type boolean, string, number or null, but found ${Gr(c.type)} instead`):null}evaluate(r){const s=this.needle.evaluate(r),c=this.haystack.evaluate(r);if(!c)return!1;if(!ko(s,["boolean","string","number","null"]))throw new jr(`Expected first argument to be of type boolean, string, number or null, but found ${Gr(Nr(s))} instead.`);if(!ko(c,["string","array"]))throw new jr(`Expected second argument to be of type array or string, but found ${Gr(Nr(c))} instead.`);return c.indexOf(s)>=0}eachChild(r){r(this.needle),r(this.haystack)}outputDefined(){return!0}}class Fa{constructor(r,s,c){this.type=rt,this.needle=r,this.haystack=s,this.fromIndex=c}static parse(r,s){if(r.length<=2||r.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const c=s.parse(r[1],1,Ft),f=s.parse(r[2],2,Ft);if(!c||!f)return null;if(!nu(c.type,[pt,St,rt,ar,Ft]))return s.error(`Expected first argument to be of type boolean, string, number or null, but found ${Gr(c.type)} instead`);if(r.length===4){const v=s.parse(r[3],3,rt);return v?new Fa(c,f,v):null}return new Fa(c,f)}evaluate(r){const s=this.needle.evaluate(r),c=this.haystack.evaluate(r);if(!ko(s,["boolean","string","number","null"]))throw new jr(`Expected first argument to be of type boolean, string, number or null, but found ${Gr(Nr(s))} instead.`);let f;if(this.fromIndex&&(f=this.fromIndex.evaluate(r)),ko(c,["string"])){const v=c.indexOf(s,f);return v===-1?-1:[...c.slice(0,v)].length}if(ko(c,["array"]))return c.indexOf(s,f);throw new jr(`Expected second argument to be of type array or string, but found ${Gr(Nr(c))} instead.`)}eachChild(r){r(this.needle),r(this.haystack),this.fromIndex&&r(this.fromIndex)}outputDefined(){return!1}}class Bl{constructor(r,s,c,f,v,b){this.inputType=r,this.type=s,this.input=c,this.cases=f,this.outputs=v,this.otherwise=b}static parse(r,s){if(r.length<5)return s.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if(r.length%2!=1)return s.error("Expected an even number of arguments.");let c,f;s.expectedType&&s.expectedType.kind!=="value"&&(f=s.expectedType);const v={},b=[];for(let C=2;C<r.length-1;C+=2){let A=r[C];const R=r[C+1];Array.isArray(A)||(A=[A]);const j=s.concat(C);if(A.length===0)return j.error("Expected at least one branch label.");for(const G of A){if(typeof G!="number"&&typeof G!="string")return j.error("Branch labels must be numbers or strings.");if(typeof G=="number"&&Math.abs(G)>Number.MAX_SAFE_INTEGER)return j.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof G=="number"&&Math.floor(G)!==G)return j.error("Numeric branch labels must be integer values.");if(c){if(j.checkSubtype(c,Nr(G)))return null}else c=Nr(G);if(v[String(G)]!==void 0)return j.error("Branch labels must be unique.");v[String(G)]=b.length}const $=s.parse(R,C,f);if(!$)return null;f=f||$.type,b.push($)}const w=s.parse(r[1],1,Ft);if(!w)return null;const S=s.parse(r[r.length-1],r.length-1,f);return S?w.type.kind!=="value"&&s.concat(1).checkSubtype(c,w.type)?null:new Bl(c,f,w,v,b,S):null}evaluate(r){const s=this.input.evaluate(r);return(Nr(s)===this.inputType&&this.outputs[this.cases[s]]||this.otherwise).evaluate(r)}eachChild(r){r(this.input),this.outputs.forEach(r),r(this.otherwise)}outputDefined(){return this.outputs.every(r=>r.outputDefined())&&this.otherwise.outputDefined()}}class Ba{constructor(r,s,c){this.type=r,this.branches=s,this.otherwise=c}static parse(r,s){if(r.length<4)return s.error(`Expected at least 3 arguments, but found only ${r.length-1}.`);if(r.length%2!=0)return s.error("Expected an odd number of arguments.");let c;s.expectedType&&s.expectedType.kind!=="value"&&(c=s.expectedType);const f=[];for(let b=1;b<r.length-1;b+=2){const w=s.parse(r[b],b,pt);if(!w)return null;const S=s.parse(r[b+1],b+1,c);if(!S)return null;f.push([w,S]),c=c||S.type}const v=s.parse(r[r.length-1],r.length-1,c);if(!v)return null;if(!c)throw new Error("Can't infer output type");return new Ba(c,f,v)}evaluate(r){for(const[s,c]of this.branches)if(s.evaluate(r))return c.evaluate(r);return this.otherwise.evaluate(r)}eachChild(r){for(const[s,c]of this.branches)r(s),r(c);r(this.otherwise)}outputDefined(){return this.branches.every(([r,s])=>s.outputDefined())&&this.otherwise.outputDefined()}}class ja{constructor(r,s,c,f){this.type=r,this.input=s,this.beginIndex=c,this.endIndex=f}static parse(r,s){if(r.length<=2||r.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const c=s.parse(r[1],1,Ft),f=s.parse(r[2],2,rt);if(!c||!f)return null;if(!nu(c.type,[on(Ft),St,Ft]))return s.error(`Expected first argument to be of type array or string, but found ${Gr(c.type)} instead`);if(r.length===4){const v=s.parse(r[3],3,rt);return v?new ja(c.type,c,f,v):null}return new ja(c.type,c,f)}evaluate(r){const s=this.input.evaluate(r),c=this.beginIndex.evaluate(r);let f;if(this.endIndex&&(f=this.endIndex.evaluate(r)),ko(s,["string"]))return[...s].slice(c,f).join("");if(ko(s,["array"]))return s.slice(c,f);throw new jr(`Expected first argument to be of type array or string, but found ${Gr(Nr(s))} instead.`)}eachChild(r){r(this.input),r(this.beginIndex),this.endIndex&&r(this.endIndex)}outputDefined(){return!1}}function jl(o,r){const s=o.length-1;let c,f,v=0,b=s,w=0;for(;v<=b;)if(w=Math.floor((v+b)/2),c=o[w],f=o[w+1],c<=r){if(w===s||r<f)return w;v=w+1}else{if(!(c>r))throw new jr("Input is not a number.");b=w-1}return 0}class Gs{constructor(r,s,c){this.type=r,this.input=s,this.labels=[],this.outputs=[];for(const[f,v]of c)this.labels.push(f),this.outputs.push(v)}static parse(r,s){if(r.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return s.error("Expected an even number of arguments.");const c=s.parse(r[1],1,rt);if(!c)return null;const f=[];let v=null;s.expectedType&&s.expectedType.kind!=="value"&&(v=s.expectedType);for(let b=1;b<r.length;b+=2){const w=b===1?-1/0:r[b],S=r[b+1],C=b,A=b+1;if(typeof w!="number")return s.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',C);if(f.length&&f[f.length-1][0]>=w)return s.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',C);const R=s.parse(S,A,v);if(!R)return null;v=v||R.type,f.push([w,R])}return new Gs(v,c,f)}evaluate(r){const s=this.labels,c=this.outputs;if(s.length===1)return c[0].evaluate(r);const f=this.input.evaluate(r);if(f<=s[0])return c[0].evaluate(r);const v=s.length;return f>=s[v-1]?c[v-1].evaluate(r):c[jl(s,f)].evaluate(r)}eachChild(r){r(this.input);for(const s of this.outputs)r(s)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}}function _d(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var ns,Di,Nl=function(){if(Di)return ns;function o(r,s,c,f){this.cx=3*r,this.bx=3*(c-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(f-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=s,this.p2x=c,this.p2y=f}return Di=1,ns=o,o.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,s){if(s===void 0&&(s=1e-6),r<0)return 0;if(r>1)return 1;for(var c=r,f=0;f<8;f++){var v=this.sampleCurveX(c)-r;if(Math.abs(v)<s)return c;var b=this.sampleCurveDerivativeX(c);if(Math.abs(b)<1e-6)break;c-=v/b}var w=0,S=1;for(c=r,f=0;f<20&&(v=this.sampleCurveX(c),!(Math.abs(v-r)<s));f++)r>v?w=c:S=c,c=.5*(S-w)+w;return c},solve:function(r,s){return this.sampleCurveY(this.solveCurveX(r,s))}},ns}(),yd=_d(Nl);class Vi{constructor(r,s,c,f,v){this.type=r,this.operator=s,this.interpolation=c,this.input=f,this.labels=[],this.outputs=[];for(const[b,w]of v)this.labels.push(b),this.outputs.push(w)}static interpolationFactor(r,s,c,f){let v=0;if(r.name==="exponential")v=hi(s,r.base,c,f);else if(r.name==="linear")v=hi(s,1,c,f);else if(r.name==="cubic-bezier"){const b=r.controlPoints;v=new yd(b[0],b[1],b[2],b[3]).solve(hi(s,1,c,f))}return v}static parse(r,s){let[c,f,v,...b]=r;if(!Array.isArray(f)||f.length===0)return s.error("Expected an interpolation type expression.",1);if(f[0]==="linear")f={name:"linear"};else if(f[0]==="exponential"){const C=f[1];if(typeof C!="number")return s.error("Exponential interpolation requires a numeric base.",1,1);f={name:"exponential",base:C}}else{if(f[0]!=="cubic-bezier")return s.error(`Unknown interpolation type ${String(f[0])}`,1,0);{const C=f.slice(1);if(C.length!==4||C.some(A=>typeof A!="number"||A<0||A>1))return s.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);f={name:"cubic-bezier",controlPoints:C}}}if(r.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return s.error("Expected an even number of arguments.");if(v=s.parse(v,2,rt),!v)return null;const w=[];let S=null;c==="interpolate-hcl"||c==="interpolate-lab"?S=Ut:s.expectedType&&s.expectedType.kind!=="value"&&(S=s.expectedType);for(let C=0;C<b.length;C+=2){const A=b[C],R=b[C+1],j=C+3,$=C+4;if(typeof A!="number")return s.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',j);if(w.length&&w[w.length-1][0]>=A)return s.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',j);const G=s.parse(R,$,S);if(!G)return null;S=S||G.type,w.push([A,G])}return Fs(S,rt)||Fs(S,Xr)||Fs(S,Ut)||Fs(S,Dl)||Fs(S,Ao)||Fs(S,on(rt))?new Vi(S,c,f,v,w):s.error(`Type ${Gr(S)} is not interpolatable.`)}evaluate(r){const s=this.labels,c=this.outputs;if(s.length===1)return c[0].evaluate(r);const f=this.input.evaluate(r);if(f<=s[0])return c[0].evaluate(r);const v=s.length;if(f>=s[v-1])return c[v-1].evaluate(r);const b=jl(s,f),w=Vi.interpolationFactor(this.interpolation,f,s[b],s[b+1]),S=c[b].evaluate(r),C=c[b+1].evaluate(r);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return ho(S,C,w);case"color":return lr.interpolate(S,C,w);case"padding":return Ri.interpolate(S,C,w);case"variableAnchorOffsetCollection":return Yi.interpolate(S,C,w);case"array":return js(S,C,w);case"projectionDefinition":return gi.interpolate(S,C,w)}case"interpolate-hcl":return lr.interpolate(S,C,w,"hcl");case"interpolate-lab":return lr.interpolate(S,C,w,"lab")}}eachChild(r){r(this.input);for(const s of this.outputs)r(s)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}}function hi(o,r,s,c){const f=c-s,v=o-s;return f===0?0:r===1?v/f:(Math.pow(r,v)-1)/(Math.pow(r,f)-1)}const Ln={color:lr.interpolate,number:ho,padding:Ri.interpolate,variableAnchorOffsetCollection:Yi.interpolate,array:js};class Zs{constructor(r,s){this.type=r,this.args=s}static parse(r,s){if(r.length<2)return s.error("Expected at least one argument.");let c=null;const f=s.expectedType;f&&f.kind!=="value"&&(c=f);const v=[];for(const w of r.slice(1)){const S=s.parse(w,1+v.length,c,void 0,{typeAnnotation:"omit"});if(!S)return null;c=c||S.type,v.push(S)}if(!c)throw new Error("No output type");const b=f&&v.some(w=>Os(f,w.type));return new Zs(b?Ft:c,v)}evaluate(r){let s,c=null,f=0;for(const v of this.args)if(f++,c=v.evaluate(r),c&&c instanceof sn&&!c.available&&(s||(s=c.name),c=null,f===this.args.length&&(c=s)),c!==null)break;return c}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}}function au(o,r){return o==="=="||o==="!="?r.kind==="boolean"||r.kind==="string"||r.kind==="number"||r.kind==="null"||r.kind==="value":r.kind==="string"||r.kind==="number"||r.kind==="value"}function vd(o,r,s,c){return c.compare(r,s)===0}function fo(o,r,s){const c=o!=="=="&&o!=="!=";return class Yw{constructor(v,b,w){this.type=pt,this.lhs=v,this.rhs=b,this.collator=w,this.hasUntypedArgument=v.type.kind==="value"||b.type.kind==="value"}static parse(v,b){if(v.length!==3&&v.length!==4)return b.error("Expected two or three arguments.");const w=v[0];let S=b.parse(v[1],1,Ft);if(!S)return null;if(!au(w,S.type))return b.concat(1).error(`"${w}" comparisons are not supported for type '${Gr(S.type)}'.`);let C=b.parse(v[2],2,Ft);if(!C)return null;if(!au(w,C.type))return b.concat(2).error(`"${w}" comparisons are not supported for type '${Gr(C.type)}'.`);if(S.type.kind!==C.type.kind&&S.type.kind!=="value"&&C.type.kind!=="value")return b.error(`Cannot compare types '${Gr(S.type)}' and '${Gr(C.type)}'.`);c&&(S.type.kind==="value"&&C.type.kind!=="value"?S=new an(C.type,[S]):S.type.kind!=="value"&&C.type.kind==="value"&&(C=new an(S.type,[C])));let A=null;if(v.length===4){if(S.type.kind!=="string"&&C.type.kind!=="string"&&S.type.kind!=="value"&&C.type.kind!=="value")return b.error("Cannot use collator to compare non-string types.");if(A=b.parse(v[3],3,mi),!A)return null}return new Yw(S,C,A)}evaluate(v){const b=this.lhs.evaluate(v),w=this.rhs.evaluate(v);if(c&&this.hasUntypedArgument){const S=Nr(b),C=Nr(w);if(S.kind!==C.kind||S.kind!=="string"&&S.kind!=="number")throw new jr(`Expected arguments for "${o}" to be (string, string) or (number, number), but found (${S.kind}, ${C.kind}) instead.`)}if(this.collator&&!c&&this.hasUntypedArgument){const S=Nr(b),C=Nr(w);if(S.kind!=="string"||C.kind!=="string")return r(v,b,w)}return this.collator?s(v,b,w,this.collator.evaluate(v)):r(v,b,w)}eachChild(v){v(this.lhs),v(this.rhs),this.collator&&v(this.collator)}outputDefined(){return!0}}}const lu=fo("==",function(o,r,s){return r===s},vd),Bp=fo("!=",function(o,r,s){return r!==s},function(o,r,s,c){return!vd(0,r,s,c)}),Vl=fo("<",function(o,r,s){return r<s},function(o,r,s,c){return c.compare(r,s)<0}),$l=fo(">",function(o,r,s){return r>s},function(o,r,s,c){return c.compare(r,s)>0}),zn=fo("<=",function(o,r,s){return r<=s},function(o,r,s,c){return c.compare(r,s)<=0}),bd=fo(">=",function(o,r,s){return r>=s},function(o,r,s,c){return c.compare(r,s)>=0});class os{constructor(r,s,c){this.type=mi,this.locale=c,this.caseSensitive=r,this.diacriticSensitive=s}static parse(r,s){if(r.length!==2)return s.error("Expected one argument.");const c=r[1];if(typeof c!="object"||Array.isArray(c))return s.error("Collator options argument must be an object.");const f=s.parse(c["case-sensitive"]!==void 0&&c["case-sensitive"],1,pt);if(!f)return null;const v=s.parse(c["diacritic-sensitive"]!==void 0&&c["diacritic-sensitive"],1,pt);if(!v)return null;let b=null;return c.locale&&(b=s.parse(c.locale,1,St),!b)?null:new os(f,v,b)}evaluate(r){return new En(this.caseSensitive.evaluate(r),this.diacriticSensitive.evaluate(r),this.locale?this.locale.evaluate(r):null)}eachChild(r){r(this.caseSensitive),r(this.diacriticSensitive),this.locale&&r(this.locale)}outputDefined(){return!1}}class cu{constructor(r,s,c,f,v){this.type=St,this.number=r,this.locale=s,this.currency=c,this.minFractionDigits=f,this.maxFractionDigits=v}static parse(r,s){if(r.length!==3)return s.error("Expected two arguments.");const c=s.parse(r[1],1,rt);if(!c)return null;const f=r[2];if(typeof f!="object"||Array.isArray(f))return s.error("NumberFormat options argument must be an object.");let v=null;if(f.locale&&(v=s.parse(f.locale,1,St),!v))return null;let b=null;if(f.currency&&(b=s.parse(f.currency,1,St),!b))return null;let w=null;if(f["min-fraction-digits"]&&(w=s.parse(f["min-fraction-digits"],1,rt),!w))return null;let S=null;return f["max-fraction-digits"]&&(S=s.parse(f["max-fraction-digits"],1,rt),!S)?null:new cu(c,v,b,w,S)}evaluate(r){return new Intl.NumberFormat(this.locale?this.locale.evaluate(r):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(r):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(r):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(r):void 0}).format(this.number.evaluate(r))}eachChild(r){r(this.number),this.locale&&r(this.locale),this.currency&&r(this.currency),this.minFractionDigits&&r(this.minFractionDigits),this.maxFractionDigits&&r(this.maxFractionDigits)}outputDefined(){return!1}}class qs{constructor(r){this.type=zr,this.sections=r}static parse(r,s){if(r.length<2)return s.error("Expected at least one argument.");const c=r[1];if(!Array.isArray(c)&&typeof c=="object")return s.error("First argument must be an image or text section.");const f=[];let v=!1;for(let b=1;b<=r.length-1;++b){const w=r[b];if(v&&typeof w=="object"&&!Array.isArray(w)){v=!1;let S=null;if(w["font-scale"]&&(S=s.parse(w["font-scale"],1,rt),!S))return null;let C=null;if(w["text-font"]&&(C=s.parse(w["text-font"],1,on(St)),!C))return null;let A=null;if(w["text-color"]&&(A=s.parse(w["text-color"],1,Ut),!A))return null;let R=null;if(w["vertical-align"]){if(typeof w["vertical-align"]=="string"&&!Ra.includes(w["vertical-align"]))return s.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${w["vertical-align"]}' instead.`);if(R=s.parse(w["vertical-align"],1,St),!R)return null}const j=f[f.length-1];j.scale=S,j.font=C,j.textColor=A,j.verticalAlign=R}else{const S=s.parse(r[b],1,Ft);if(!S)return null;const C=S.type.kind;if(C!=="string"&&C!=="value"&&C!=="null"&&C!=="resolvedImage")return s.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");v=!0,f.push({content:S,scale:null,font:null,textColor:null,verticalAlign:null})}}return new qs(f)}evaluate(r){return new Xi(this.sections.map(s=>{const c=s.content.evaluate(r);return Nr(c)===Ds?new Ns("",c,null,null,null,s.verticalAlign?s.verticalAlign.evaluate(r):null):new Ns(Vs(c),null,s.scale?s.scale.evaluate(r):null,s.font?s.font.evaluate(r).join(","):null,s.textColor?s.textColor.evaluate(r):null,s.verticalAlign?s.verticalAlign.evaluate(r):null)}))}eachChild(r){for(const s of this.sections)r(s.content),s.scale&&r(s.scale),s.font&&r(s.font),s.textColor&&r(s.textColor),s.verticalAlign&&r(s.verticalAlign)}outputDefined(){return!1}}class uu{constructor(r){this.type=Ds,this.input=r}static parse(r,s){if(r.length!==2)return s.error("Expected two arguments.");const c=s.parse(r[1],1,St);return c?new uu(c):s.error("No image name provided.")}evaluate(r){const s=this.input.evaluate(r),c=sn.fromString(s);return c&&r.availableImages&&(c.available=r.availableImages.indexOf(s)>-1),c}eachChild(r){r(this.input)}outputDefined(){return!1}}class hu{constructor(r){this.type=rt,this.input=r}static parse(r,s){if(r.length!==2)return s.error(`Expected 1 argument, but found ${r.length-1} instead.`);const c=s.parse(r[1],1);return c?c.type.kind!=="array"&&c.type.kind!=="string"&&c.type.kind!=="value"?s.error(`Expected argument of type string or array, but found ${Gr(c.type)} instead.`):new hu(c):null}evaluate(r){const s=this.input.evaluate(r);if(typeof s=="string")return[...s].length;if(Array.isArray(s))return s.length;throw new jr(`Expected value to be of type string or array, but found ${Gr(Nr(s))} instead.`)}eachChild(r){r(this.input)}outputDefined(){return!1}}const Wn=8192;function jp(o,r){const s=(180+o[0])/360,c=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o[1]*Math.PI/360)))/360,f=Math.pow(2,r.z);return[Math.round(s*f*Wn),Math.round(c*f*Wn)]}function Hs(o,r){const s=Math.pow(2,r.z);return[(f=(o[0]/Wn+r.x)/s,360*f-180),(c=(o[1]/Wn+r.y)/s,360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90)];var c,f}function Na(o,r){o[0]=Math.min(o[0],r[0]),o[1]=Math.min(o[1],r[1]),o[2]=Math.max(o[2],r[0]),o[3]=Math.max(o[3],r[1])}function Ws(o,r){return!(o[0]<=r[0]||o[2]>=r[2]||o[1]<=r[1]||o[3]>=r[3])}function xd(o,r,s){const c=o[0]-r[0],f=o[1]-r[1],v=o[0]-s[0],b=o[1]-s[1];return c*b-v*f==0&&c*v<=0&&f*b<=0}function Ul(o,r,s,c){return(f=[c[0]-s[0],c[1]-s[1]])[0]*(v=[r[0]-o[0],r[1]-o[1]])[1]-f[1]*v[0]!=0&&!(!Sd(o,r,s,c)||!Sd(s,c,o,r));var f,v}function wd(o,r,s){for(const c of s)for(let f=0;f<c.length-1;++f)if(Ul(o,r,c[f],c[f+1]))return!0;return!1}function Ks(o,r,s=!1){let c=!1;for(const w of r)for(let S=0;S<w.length-1;S++){if(xd(o,w[S],w[S+1]))return s;(v=w[S])[1]>(f=o)[1]!=(b=w[S+1])[1]>f[1]&&f[0]<(b[0]-v[0])*(f[1]-v[1])/(b[1]-v[1])+v[0]&&(c=!c)}var f,v,b;return c}function Np(o,r){for(const s of r)if(Ks(o,s))return!0;return!1}function Td(o,r){for(const s of o)if(!Ks(s,r))return!1;for(let s=0;s<o.length-1;++s)if(wd(o[s],o[s+1],r))return!1;return!0}function Vp(o,r){for(const s of r)if(Td(o,s))return!0;return!1}function Sd(o,r,s,c){const f=c[0]-s[0],v=c[1]-s[1],b=(o[0]-s[0])*v-f*(o[1]-s[1]),w=(r[0]-s[0])*v-f*(r[1]-s[1]);return b>0&&w<0||b<0&&w>0}function Gl(o,r,s){const c=[];for(let f=0;f<o.length;f++){const v=[];for(let b=0;b<o[f].length;b++){const w=jp(o[f][b],s);Na(r,w),v.push(w)}c.push(v)}return c}function du(o,r,s){const c=[];for(let f=0;f<o.length;f++){const v=Gl(o[f],r,s);c.push(v)}return c}function fu(o,r,s,c){if(o[0]<s[0]||o[0]>s[2]){const f=.5*c;let v=o[0]-s[0]>f?-c:s[0]-o[0]>f?c:0;v===0&&(v=o[0]-s[2]>f?-c:s[2]-o[0]>f?c:0),o[0]+=v}Na(r,o)}function Ed(o,r,s,c){const f=Math.pow(2,c.z)*Wn,v=[c.x*Wn,c.y*Wn],b=[];for(const w of o)for(const S of w){const C=[S.x+v[0],S.y+v[1]];fu(C,r,s,f),b.push(C)}return b}function Cd(o,r,s,c){const f=Math.pow(2,c.z)*Wn,v=[c.x*Wn,c.y*Wn],b=[];for(const S of o){const C=[];for(const A of S){const R=[A.x+v[0],A.y+v[1]];Na(r,R),C.push(R)}b.push(C)}if(r[2]-r[0]<=f/2){(w=r)[0]=w[1]=1/0,w[2]=w[3]=-1/0;for(const S of b)for(const C of S)fu(C,r,s,f)}var w;return b}class ss{constructor(r,s){this.type=pt,this.geojson=r,this.geometries=s}static parse(r,s){if(r.length!==2)return s.error(`'within' expression requires exactly one argument, but found ${r.length-1} instead.`);if(zo(r[1])){const c=r[1];if(c.type==="FeatureCollection"){const f=[];for(const v of c.features){const{type:b,coordinates:w}=v.geometry;b==="Polygon"&&f.push(w),b==="MultiPolygon"&&f.push(...w)}if(f.length)return new ss(c,{type:"MultiPolygon",coordinates:f})}else if(c.type==="Feature"){const f=c.geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new ss(c,c.geometry)}else if(c.type==="Polygon"||c.type==="MultiPolygon")return new ss(c,c)}return s.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(r.geometry()!=null&&r.canonicalID()!=null){if(r.geometryType()==="Point")return function(s,c){const f=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],b=s.canonicalID();if(c.type==="Polygon"){const w=Gl(c.coordinates,v,b),S=Ed(s.geometry(),f,v,b);if(!Ws(f,v))return!1;for(const C of S)if(!Ks(C,w))return!1}if(c.type==="MultiPolygon"){const w=du(c.coordinates,v,b),S=Ed(s.geometry(),f,v,b);if(!Ws(f,v))return!1;for(const C of S)if(!Np(C,w))return!1}return!0}(r,this.geometries);if(r.geometryType()==="LineString")return function(s,c){const f=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],b=s.canonicalID();if(c.type==="Polygon"){const w=Gl(c.coordinates,v,b),S=Cd(s.geometry(),f,v,b);if(!Ws(f,v))return!1;for(const C of S)if(!Td(C,w))return!1}if(c.type==="MultiPolygon"){const w=du(c.coordinates,v,b),S=Cd(s.geometry(),f,v,b);if(!Ws(f,v))return!1;for(const C of S)if(!Vp(C,w))return!1}return!0}(r,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Zl=class{constructor(o=[],r=(s,c)=>s<c?-1:s>c?1:0){if(this.data=o,this.length=this.data.length,this.compare=r,this.length>0)for(let s=(this.length>>1)-1;s>=0;s--)this._down(s)}push(o){this.data.push(o),this._up(this.length++)}pop(){if(this.length===0)return;const o=this.data[0],r=this.data.pop();return--this.length>0&&(this.data[0]=r,this._down(0)),o}peek(){return this.data[0]}_up(o){const{data:r,compare:s}=this,c=r[o];for(;o>0;){const f=o-1>>1,v=r[f];if(s(c,v)>=0)break;r[o]=v,o=f}r[o]=c}_down(o){const{data:r,compare:s}=this,c=this.length>>1,f=r[o];for(;o<c;){let v=1+(o<<1);const b=v+1;if(b<this.length&&s(r[b],r[v])<0&&(v=b),s(r[v],f)>=0)break;r[o]=r[v],o=v}r[o]=f}};function Id(o,r,s=0,c=o.length-1,f=$p){for(;c>s;){if(c-s>600){const S=c-s+1,C=r-s+1,A=Math.log(S),R=.5*Math.exp(2*A/3),j=.5*Math.sqrt(A*R*(S-R)/S)*(C-S/2<0?-1:1);Id(o,r,Math.max(s,Math.floor(r-C*R/S+j)),Math.min(c,Math.floor(r+(S-C)*R/S+j)),f)}const v=o[r];let b=s,w=c;for(Va(o,s,r),f(o[c],v)>0&&Va(o,s,c);b<w;){for(Va(o,b,w),b++,w--;f(o[b],v)<0;)b++;for(;f(o[w],v)>0;)w--}f(o[s],v)===0?Va(o,s,w):(w++,Va(o,w,c)),w<=r&&(s=w+1),r<=w&&(c=w-1)}}function Va(o,r,s){const c=o[r];o[r]=o[s],o[s]=c}function $p(o,r){return o<r?-1:o>r?1:0}function $a(o,r){if(o.length<=1)return[o];const s=[];let c,f;for(const v of o){const b=Up(v);b!==0&&(v.area=Math.abs(b),f===void 0&&(f=b<0),f===b<0?(c&&s.push(c),c=[v]):c.push(v))}if(c&&s.push(c),r>1)for(let v=0;v<s.length;v++)s[v].length<=r||(Id(s[v],r,1,s[v].length-1,Md),s[v]=s[v].slice(0,r));return s}function Md(o,r){return r.area-o.area}function Up(o){let r=0;for(let s,c,f=0,v=o.length,b=v-1;f<v;b=f++)s=o[f],c=o[b],r+=(c.x-s.x)*(s.y+c.y);return r}const Pd=1/298.257223563,pu=Pd*(2-Pd),mu=Math.PI/180;class gu{constructor(r){const s=6378.137*mu*1e3,c=Math.cos(r*mu),f=1/(1-pu*(1-c*c)),v=Math.sqrt(f);this.kx=s*v*c,this.ky=s*v*f*(1-pu)}distance(r,s){const c=this.wrap(r[0]-s[0])*this.kx,f=(r[1]-s[1])*this.ky;return Math.sqrt(c*c+f*f)}pointOnLine(r,s){let c,f,v,b,w=1/0;for(let S=0;S<r.length-1;S++){let C=r[S][0],A=r[S][1],R=this.wrap(r[S+1][0]-C)*this.kx,j=(r[S+1][1]-A)*this.ky,$=0;R===0&&j===0||($=(this.wrap(s[0]-C)*this.kx*R+(s[1]-A)*this.ky*j)/(R*R+j*j),$>1?(C=r[S+1][0],A=r[S+1][1]):$>0&&(C+=R/this.kx*$,A+=j/this.ky*$)),R=this.wrap(s[0]-C)*this.kx,j=(s[1]-A)*this.ky;const G=R*R+j*j;G<w&&(w=G,c=C,f=A,v=S,b=$)}return{point:[c,f],index:v,t:Math.max(0,Math.min(1,b))}}wrap(r){for(;r<-180;)r+=360;for(;r>180;)r-=360;return r}}function Ad(o,r){return r[0]-o[0]}function ql(o){return o[1]-o[0]+1}function Kn(o,r){return o[1]>=o[0]&&o[1]<r}function _u(o,r){if(o[0]>o[1])return[null,null];const s=ql(o);if(r){if(s===2)return[o,null];const f=Math.floor(s/2);return[[o[0],o[0]+f],[o[0]+f,o[1]]]}if(s===1)return[o,null];const c=Math.floor(s/2)-1;return[[o[0],o[0]+c],[o[0]+c+1,o[1]]]}function yu(o,r){if(!Kn(r,o.length))return[1/0,1/0,-1/0,-1/0];const s=[1/0,1/0,-1/0,-1/0];for(let c=r[0];c<=r[1];++c)Na(s,o[c]);return s}function vu(o){const r=[1/0,1/0,-1/0,-1/0];for(const s of o)for(const c of s)Na(r,c);return r}function kd(o){return o[0]!==-1/0&&o[1]!==-1/0&&o[2]!==1/0&&o[3]!==1/0}function fr(o,r,s){if(!kd(o)||!kd(r))return NaN;let c=0,f=0;return o[2]<r[0]&&(c=r[0]-o[2]),o[0]>r[2]&&(c=o[0]-r[2]),o[1]>r[3]&&(f=o[1]-r[3]),o[3]<r[1]&&(f=r[1]-o[3]),s.distance([0,0],[c,f])}function as(o,r,s){const c=s.pointOnLine(r,o);return s.distance(o,c.point)}function bu(o,r,s,c,f){const v=Math.min(as(o,[s,c],f),as(r,[s,c],f)),b=Math.min(as(s,[o,r],f),as(c,[o,r],f));return Math.min(v,b)}function Gp(o,r,s,c,f){if(!Kn(r,o.length)||!Kn(c,s.length))return 1/0;let v=1/0;for(let b=r[0];b<r[1];++b){const w=o[b],S=o[b+1];for(let C=c[0];C<c[1];++C){const A=s[C],R=s[C+1];if(Ul(w,S,A,R))return 0;v=Math.min(v,bu(w,S,A,R,f))}}return v}function Zp(o,r,s,c,f){if(!Kn(r,o.length)||!Kn(c,s.length))return NaN;let v=1/0;for(let b=r[0];b<=r[1];++b)for(let w=c[0];w<=c[1];++w)if(v=Math.min(v,f.distance(o[b],s[w])),v===0)return v;return v}function qp(o,r,s){if(Ks(o,r,!0))return 0;let c=1/0;for(const f of r){const v=f[0],b=f[f.length-1];if(v!==b&&(c=Math.min(c,as(o,[b,v],s)),c===0))return c;const w=s.pointOnLine(f,o);if(c=Math.min(c,s.distance(o,w.point)),c===0)return c}return c}function Hp(o,r,s,c){if(!Kn(r,o.length))return NaN;for(let v=r[0];v<=r[1];++v)if(Ks(o[v],s,!0))return 0;let f=1/0;for(let v=r[0];v<r[1];++v){const b=o[v],w=o[v+1];for(const S of s)for(let C=0,A=S.length,R=A-1;C<A;R=C++){const j=S[R],$=S[C];if(Ul(b,w,j,$))return 0;f=Math.min(f,bu(b,w,j,$,c))}}return f}function Ld(o,r){for(const s of o)for(const c of s)if(Ks(c,r,!0))return!0;return!1}function Wp(o,r,s,c=1/0){const f=vu(o),v=vu(r);if(c!==1/0&&fr(f,v,s)>=c)return c;if(Ws(f,v)){if(Ld(o,r))return 0}else if(Ld(r,o))return 0;let b=1/0;for(const w of o)for(let S=0,C=w.length,A=C-1;S<C;A=S++){const R=w[A],j=w[S];for(const $ of r)for(let G=0,W=$.length,te=W-1;G<W;te=G++){const se=$[te],ye=$[G];if(Ul(R,j,se,ye))return 0;b=Math.min(b,bu(R,j,se,ye,s))}}return b}function zd(o,r,s,c,f,v){if(!v)return;const b=fr(yu(c,v),f,s);b<r&&o.push([b,v,[0,0]])}function Hl(o,r,s,c,f,v,b){if(!v||!b)return;const w=fr(yu(c,v),yu(f,b),s);w<r&&o.push([w,v,b])}function Wl(o,r,s,c,f=1/0){let v=Math.min(c.distance(o[0],s[0][0]),f);if(v===0)return v;const b=new Zl([[0,[0,o.length-1],[0,0]]],Ad),w=vu(s);for(;b.length>0;){const S=b.pop();if(S[0]>=v)continue;const C=S[1],A=r?50:100;if(ql(C)<=A){if(!Kn(C,o.length))return NaN;if(r){const R=Hp(o,C,s,c);if(isNaN(R)||R===0)return R;v=Math.min(v,R)}else for(let R=C[0];R<=C[1];++R){const j=qp(o[R],s,c);if(v=Math.min(v,j),v===0)return 0}}else{const R=_u(C,r);zd(b,v,c,o,w,R[0]),zd(b,v,c,o,w,R[1])}}return v}function Kl(o,r,s,c,f,v=1/0){let b=Math.min(v,f.distance(o[0],s[0]));if(b===0)return b;const w=new Zl([[0,[0,o.length-1],[0,s.length-1]]],Ad);for(;w.length>0;){const S=w.pop();if(S[0]>=b)continue;const C=S[1],A=S[2],R=r?50:100,j=c?50:100;if(ql(C)<=R&&ql(A)<=j){if(!Kn(C,o.length)&&Kn(A,s.length))return NaN;let $;if(r&&c)$=Gp(o,C,s,A,f),b=Math.min(b,$);else if(r&&!c){const G=o.slice(C[0],C[1]+1);for(let W=A[0];W<=A[1];++W)if($=as(s[W],G,f),b=Math.min(b,$),b===0)return b}else if(!r&&c){const G=s.slice(A[0],A[1]+1);for(let W=C[0];W<=C[1];++W)if($=as(o[W],G,f),b=Math.min(b,$),b===0)return b}else $=Zp(o,C,s,A,f),b=Math.min(b,$)}else{const $=_u(C,r),G=_u(A,c);Hl(w,b,f,o,s,$[0],G[0]),Hl(w,b,f,o,s,$[0],G[1]),Hl(w,b,f,o,s,$[1],G[0]),Hl(w,b,f,o,s,$[1],G[1])}}return b}function xu(o){return o.type==="MultiPolygon"?o.coordinates.map(r=>({type:"Polygon",coordinates:r})):o.type==="MultiLineString"?o.coordinates.map(r=>({type:"LineString",coordinates:r})):o.type==="MultiPoint"?o.coordinates.map(r=>({type:"Point",coordinates:r})):[o]}class ls{constructor(r,s){this.type=rt,this.geojson=r,this.geometries=s}static parse(r,s){if(r.length!==2)return s.error(`'distance' expression requires exactly one argument, but found ${r.length-1} instead.`);if(zo(r[1])){const c=r[1];if(c.type==="FeatureCollection")return new ls(c,c.features.map(f=>xu(f.geometry)).flat());if(c.type==="Feature")return new ls(c,xu(c.geometry));if("type"in c&&"coordinates"in c)return new ls(c,xu(c))}return s.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(r.geometry()!=null&&r.canonicalID()!=null){if(r.geometryType()==="Point")return function(s,c){const f=s.geometry(),v=f.flat().map(S=>Hs([S.x,S.y],s.canonical));if(f.length===0)return NaN;const b=new gu(v[0][1]);let w=1/0;for(const S of c){switch(S.type){case"Point":w=Math.min(w,Kl(v,!1,[S.coordinates],!1,b,w));break;case"LineString":w=Math.min(w,Kl(v,!1,S.coordinates,!0,b,w));break;case"Polygon":w=Math.min(w,Wl(v,!1,S.coordinates,b,w))}if(w===0)return w}return w}(r,this.geometries);if(r.geometryType()==="LineString")return function(s,c){const f=s.geometry(),v=f.flat().map(S=>Hs([S.x,S.y],s.canonical));if(f.length===0)return NaN;const b=new gu(v[0][1]);let w=1/0;for(const S of c){switch(S.type){case"Point":w=Math.min(w,Kl(v,!0,[S.coordinates],!1,b,w));break;case"LineString":w=Math.min(w,Kl(v,!0,S.coordinates,!0,b,w));break;case"Polygon":w=Math.min(w,Wl(v,!0,S.coordinates,b,w))}if(w===0)return w}return w}(r,this.geometries);if(r.geometryType()==="Polygon")return function(s,c){const f=s.geometry();if(f.length===0||f[0].length===0)return NaN;const v=$a(f,0).map(S=>S.map(C=>C.map(A=>Hs([A.x,A.y],s.canonical)))),b=new gu(v[0][0][0][1]);let w=1/0;for(const S of c)for(const C of v){switch(S.type){case"Point":w=Math.min(w,Wl([S.coordinates],!1,C,b,w));break;case"LineString":w=Math.min(w,Wl(S.coordinates,!0,C,b,w));break;case"Polygon":w=Math.min(w,Wp(C,S.coordinates,b,w))}if(w===0)return w}return w}(r,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const Xs={"==":lu,"!=":Bp,">":$l,"<":Vl,">=":bd,"<=":zn,array:an,at:kn,boolean:an,case:Ba,coalesce:Zs,collator:os,format:qs,image:uu,in:Oa,"index-of":Fa,interpolate:Vi,"interpolate-hcl":Vi,"interpolate-lab":Vi,length:hu,let:sr,literal:Ro,match:Bl,number:an,"number-format":cu,object:an,slice:ja,step:Gs,string:an,"to-boolean":Hn,"to-color":Hn,"to-number":Hn,"to-string":Hn,var:Us,within:ss,distance:ls};class Cn{constructor(r,s,c,f){this.name=r,this.type=s,this._evaluate=c,this.args=f}evaluate(r){return this._evaluate(r,this.args)}eachChild(r){this.args.forEach(r)}outputDefined(){return!1}static parse(r,s){const c=r[0],f=Cn.definitions[c];if(!f)return s.error(`Unknown expression "${c}". If you wanted a literal array, use ["literal", [...]].`,0);const v=Array.isArray(f)?f[0]:f.type,b=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,w=b.filter(([C])=>!Array.isArray(C)||C.length===r.length-1);let S=null;for(const[C,A]of w){S=new $s(s.registry,Xl,s.path,null,s.scope);const R=[];let j=!1;for(let $=1;$<r.length;$++){const G=r[$],W=Array.isArray(C)?C[$-1]:C.type,te=S.parse(G,1+R.length,W);if(!te){j=!0;break}R.push(te)}if(!j)if(Array.isArray(C)&&C.length!==R.length)S.error(`Expected ${C.length} arguments, but found ${R.length} instead.`);else{for(let $=0;$<R.length;$++){const G=Array.isArray(C)?C[$]:C.type,W=R[$];S.concat($+1).checkSubtype(G,W.type)}if(S.errors.length===0)return new Cn(c,v,A,R)}}if(w.length===1)s.errors.push(...S.errors);else{const C=(w.length?w:b).map(([R])=>{return j=R,Array.isArray(j)?`(${j.map(Gr).join(", ")})`:`(${Gr(j.type)}...)`;var j}).join(" | "),A=[];for(let R=1;R<r.length;R++){const j=s.parse(r[R],1+A.length);if(!j)return null;A.push(Gr(j.type))}s.error(`Expected arguments of type ${C}, but found (${A.join(", ")}) instead.`)}return null}static register(r,s){Cn.definitions=s;for(const c in s)r[c]=Cn}}function Rd(o,[r,s,c,f]){r=r.evaluate(o),s=s.evaluate(o),c=c.evaluate(o);const v=f?f.evaluate(o):1,b=gd(r,s,c,v);if(b)throw new jr(b);return new lr(r/255,s/255,c/255,v,!1)}function Dd(o,r){return o in r}function wu(o,r){const s=r[o];return s===void 0?null:s}function cs(o){return{type:o}}function Xl(o){if(o instanceof Us)return Xl(o.boundExpression);if(o instanceof Cn&&o.name==="error"||o instanceof os||o instanceof ss||o instanceof ls)return!1;const r=o instanceof Hn||o instanceof an;let s=!0;return o.eachChild(c=>{s=r?s&&Xl(c):s&&c instanceof Ro}),!!s&&Yl(o)&&Jl(o,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Yl(o){if(o instanceof Cn&&(o.name==="get"&&o.args.length===1||o.name==="feature-state"||o.name==="has"&&o.args.length===1||o.name==="properties"||o.name==="geometry-type"||o.name==="id"||/^filter-/.test(o.name))||o instanceof ss||o instanceof ls)return!1;let r=!0;return o.eachChild(s=>{r&&!Yl(s)&&(r=!1)}),r}function Ua(o){if(o instanceof Cn&&o.name==="feature-state")return!1;let r=!0;return o.eachChild(s=>{r&&!Ua(s)&&(r=!1)}),r}function Jl(o,r){if(o instanceof Cn&&r.indexOf(o.name)>=0)return!1;let s=!0;return o.eachChild(c=>{s&&!Jl(c,r)&&(s=!1)}),s}function Od(o){return{result:"success",value:o}}function Ys(o){return{result:"error",value:o}}function Js(o){return o["property-type"]==="data-driven"||o["property-type"]==="cross-faded-data-driven"}function Fd(o){return!!o.expression&&o.expression.parameters.indexOf("zoom")>-1}function Tu(o){return!!o.expression&&o.expression.interpolated}function ur(o){return o instanceof Number?"number":o instanceof String?"string":o instanceof Boolean?"boolean":Array.isArray(o)?"array":o===null?"null":typeof o}function Ql(o){return typeof o=="object"&&o!==null&&!Array.isArray(o)}function Su(o){return o}function Bd(o,r){const s=r.type==="color",c=o.stops&&typeof o.stops[0][0]=="object",f=c||!(c||o.property!==void 0),v=o.type||(Tu(r)?"exponential":"interval");if(s||r.type==="padding"){const A=s?lr.parse:Ri.parse;(o=Nt({},o)).stops&&(o.stops=o.stops.map(R=>[R[0],A(R[1])])),o.default=A(o.default?o.default:r.default)}if(o.colorSpace&&(b=o.colorSpace)!=="rgb"&&b!=="hcl"&&b!=="lab")throw new Error(`Unknown color space: "${o.colorSpace}"`);var b;let w,S,C;if(v==="exponential")w=Nd;else if(v==="interval")w=jd;else if(v==="categorical"){w=Kp,S=Object.create(null);for(const A of o.stops)S[A[0]]=A[1];C=typeof o.stops[0][0]}else{if(v!=="identity")throw new Error(`Unknown function type "${v}"`);w=Xp}if(c){const A={},R=[];for(let G=0;G<o.stops.length;G++){const W=o.stops[G],te=W[0].zoom;A[te]===void 0&&(A[te]={zoom:te,type:o.type,property:o.property,default:o.default,stops:[]},R.push(te)),A[te].stops.push([W[0].value,W[1]])}const j=[];for(const G of R)j.push([A[G].zoom,Bd(A[G],r)]);const $={name:"linear"};return{kind:"composite",interpolationType:$,interpolationFactor:Vi.interpolationFactor.bind(void 0,$),zoomStops:j.map(G=>G[0]),evaluate:({zoom:G},W)=>Nd({stops:j,base:o.base},r,G).evaluate(G,W)}}if(f){const A=v==="exponential"?{name:"exponential",base:o.base!==void 0?o.base:1}:null;return{kind:"camera",interpolationType:A,interpolationFactor:Vi.interpolationFactor.bind(void 0,A),zoomStops:o.stops.map(R=>R[0]),evaluate:({zoom:R})=>w(o,r,R,S,C)}}return{kind:"source",evaluate(A,R){const j=R&&R.properties?R.properties[o.property]:void 0;return j===void 0?Ga(o.default,r.default):w(o,r,j,S,C)}}}function Ga(o,r,s){return o!==void 0?o:r!==void 0?r:s!==void 0?s:void 0}function Kp(o,r,s,c,f){return Ga(typeof s===f?c[s]:void 0,o.default,r.default)}function jd(o,r,s){if(ur(s)!=="number")return Ga(o.default,r.default);const c=o.stops.length;if(c===1||s<=o.stops[0][0])return o.stops[0][1];if(s>=o.stops[c-1][0])return o.stops[c-1][1];const f=jl(o.stops.map(v=>v[0]),s);return o.stops[f][1]}function Nd(o,r,s){const c=o.base!==void 0?o.base:1;if(ur(s)!=="number")return Ga(o.default,r.default);const f=o.stops.length;if(f===1||s<=o.stops[0][0])return o.stops[0][1];if(s>=o.stops[f-1][0])return o.stops[f-1][1];const v=jl(o.stops.map(A=>A[0]),s),b=function(A,R,j,$){const G=$-j,W=A-j;return G===0?0:R===1?W/G:(Math.pow(R,W)-1)/(Math.pow(R,G)-1)}(s,c,o.stops[v][0],o.stops[v+1][0]),w=o.stops[v][1],S=o.stops[v+1][1],C=Ln[r.type]||Su;return typeof w.evaluate=="function"?{evaluate(...A){const R=w.evaluate.apply(void 0,A),j=S.evaluate.apply(void 0,A);if(R!==void 0&&j!==void 0)return C(R,j,b,o.colorSpace)}}:C(w,S,b,o.colorSpace)}function Xp(o,r,s){switch(r.type){case"color":s=lr.parse(s);break;case"formatted":s=Xi.fromString(s.toString());break;case"resolvedImage":s=sn.fromString(s.toString());break;case"padding":s=Ri.parse(s);break;default:ur(s)===r.type||r.type==="enum"&&r.values[s]||(s=void 0)}return Ga(s,o.default,r.default)}Cn.register(Xs,{error:[{kind:"error"},[St],(o,[r])=>{throw new jr(r.evaluate(o))}],typeof:[St,[Ft],(o,[r])=>Gr(Nr(r.evaluate(o)))],"to-rgba":[on(rt,4),[Ut],(o,[r])=>{const[s,c,f,v]=r.evaluate(o).rgb;return[255*s,255*c,255*f,v]}],rgb:[Ut,[rt,rt,rt],Rd],rgba:[Ut,[rt,rt,rt,rt],Rd],has:{type:pt,overloads:[[[St],(o,[r])=>Dd(r.evaluate(o),o.properties())],[[St,uo],(o,[r,s])=>Dd(r.evaluate(o),s.evaluate(o))]]},get:{type:Ft,overloads:[[[St],(o,[r])=>wu(r.evaluate(o),o.properties())],[[St,uo],(o,[r,s])=>wu(r.evaluate(o),s.evaluate(o))]]},"feature-state":[Ft,[St],(o,[r])=>wu(r.evaluate(o),o.featureState||{})],properties:[uo,[],o=>o.properties()],"geometry-type":[St,[],o=>o.geometryType()],id:[Ft,[],o=>o.id()],zoom:[rt,[],o=>o.globals.zoom],"heatmap-density":[rt,[],o=>o.globals.heatmapDensity||0],"line-progress":[rt,[],o=>o.globals.lineProgress||0],accumulated:[Ft,[],o=>o.globals.accumulated===void 0?null:o.globals.accumulated],"+":[rt,cs(rt),(o,r)=>{let s=0;for(const c of r)s+=c.evaluate(o);return s}],"*":[rt,cs(rt),(o,r)=>{let s=1;for(const c of r)s*=c.evaluate(o);return s}],"-":{type:rt,overloads:[[[rt,rt],(o,[r,s])=>r.evaluate(o)-s.evaluate(o)],[[rt],(o,[r])=>-r.evaluate(o)]]},"/":[rt,[rt,rt],(o,[r,s])=>r.evaluate(o)/s.evaluate(o)],"%":[rt,[rt,rt],(o,[r,s])=>r.evaluate(o)%s.evaluate(o)],ln2:[rt,[],()=>Math.LN2],pi:[rt,[],()=>Math.PI],e:[rt,[],()=>Math.E],"^":[rt,[rt,rt],(o,[r,s])=>Math.pow(r.evaluate(o),s.evaluate(o))],sqrt:[rt,[rt],(o,[r])=>Math.sqrt(r.evaluate(o))],log10:[rt,[rt],(o,[r])=>Math.log(r.evaluate(o))/Math.LN10],ln:[rt,[rt],(o,[r])=>Math.log(r.evaluate(o))],log2:[rt,[rt],(o,[r])=>Math.log(r.evaluate(o))/Math.LN2],sin:[rt,[rt],(o,[r])=>Math.sin(r.evaluate(o))],cos:[rt,[rt],(o,[r])=>Math.cos(r.evaluate(o))],tan:[rt,[rt],(o,[r])=>Math.tan(r.evaluate(o))],asin:[rt,[rt],(o,[r])=>Math.asin(r.evaluate(o))],acos:[rt,[rt],(o,[r])=>Math.acos(r.evaluate(o))],atan:[rt,[rt],(o,[r])=>Math.atan(r.evaluate(o))],min:[rt,cs(rt),(o,r)=>Math.min(...r.map(s=>s.evaluate(o)))],max:[rt,cs(rt),(o,r)=>Math.max(...r.map(s=>s.evaluate(o)))],abs:[rt,[rt],(o,[r])=>Math.abs(r.evaluate(o))],round:[rt,[rt],(o,[r])=>{const s=r.evaluate(o);return s<0?-Math.round(-s):Math.round(s)}],floor:[rt,[rt],(o,[r])=>Math.floor(r.evaluate(o))],ceil:[rt,[rt],(o,[r])=>Math.ceil(r.evaluate(o))],"filter-==":[pt,[St,Ft],(o,[r,s])=>o.properties()[r.value]===s.value],"filter-id-==":[pt,[Ft],(o,[r])=>o.id()===r.value],"filter-type-==":[pt,[St],(o,[r])=>o.geometryType()===r.value],"filter-<":[pt,[St,Ft],(o,[r,s])=>{const c=o.properties()[r.value],f=s.value;return typeof c==typeof f&&c<f}],"filter-id-<":[pt,[Ft],(o,[r])=>{const s=o.id(),c=r.value;return typeof s==typeof c&&s<c}],"filter->":[pt,[St,Ft],(o,[r,s])=>{const c=o.properties()[r.value],f=s.value;return typeof c==typeof f&&c>f}],"filter-id->":[pt,[Ft],(o,[r])=>{const s=o.id(),c=r.value;return typeof s==typeof c&&s>c}],"filter-<=":[pt,[St,Ft],(o,[r,s])=>{const c=o.properties()[r.value],f=s.value;return typeof c==typeof f&&c<=f}],"filter-id-<=":[pt,[Ft],(o,[r])=>{const s=o.id(),c=r.value;return typeof s==typeof c&&s<=c}],"filter->=":[pt,[St,Ft],(o,[r,s])=>{const c=o.properties()[r.value],f=s.value;return typeof c==typeof f&&c>=f}],"filter-id->=":[pt,[Ft],(o,[r])=>{const s=o.id(),c=r.value;return typeof s==typeof c&&s>=c}],"filter-has":[pt,[Ft],(o,[r])=>r.value in o.properties()],"filter-has-id":[pt,[],o=>o.id()!==null&&o.id()!==void 0],"filter-type-in":[pt,[on(St)],(o,[r])=>r.value.indexOf(o.geometryType())>=0],"filter-id-in":[pt,[on(Ft)],(o,[r])=>r.value.indexOf(o.id())>=0],"filter-in-small":[pt,[St,on(Ft)],(o,[r,s])=>s.value.indexOf(o.properties()[r.value])>=0],"filter-in-large":[pt,[St,on(Ft)],(o,[r,s])=>function(c,f,v,b){for(;v<=b;){const w=v+b>>1;if(f[w]===c)return!0;f[w]>c?b=w-1:v=w+1}return!1}(o.properties()[r.value],s.value,0,s.value.length-1)],all:{type:pt,overloads:[[[pt,pt],(o,[r,s])=>r.evaluate(o)&&s.evaluate(o)],[cs(pt),(o,r)=>{for(const s of r)if(!s.evaluate(o))return!1;return!0}]]},any:{type:pt,overloads:[[[pt,pt],(o,[r,s])=>r.evaluate(o)||s.evaluate(o)],[cs(pt),(o,r)=>{for(const s of r)if(s.evaluate(o))return!0;return!1}]]},"!":[pt,[pt],(o,[r])=>!r.evaluate(o)],"is-supported-script":[pt,[St],(o,[r])=>{const s=o.globals&&o.globals.isSupportedScript;return!s||s(r.evaluate(o))}],upcase:[St,[St],(o,[r])=>r.evaluate(o).toUpperCase()],downcase:[St,[St],(o,[r])=>r.evaluate(o).toLowerCase()],concat:[St,cs(Ft),(o,r)=>r.map(s=>Vs(s.evaluate(o))).join("")],"resolved-locale":[St,[mi],(o,[r])=>r.evaluate(o).resolvedLocale()]});class Qs{constructor(r,s){var c;this.expression=r,this._warningHistory={},this._evaluator=new Wt,this._defaultValue=s?(c=s).type==="color"&&Ql(c.default)?new lr(0,0,0,0):c.type==="color"?lr.parse(c.default)||null:c.type==="padding"?Ri.parse(c.default)||null:c.type==="variableAnchorOffsetCollection"?Yi.parse(c.default)||null:c.type==="projectionDefinition"?gi.parse(c.default)||null:c.default===void 0?null:c.default:null,this._enumValues=s&&s.type==="enum"?s.values:null}evaluateWithoutErrorHandling(r,s,c,f,v,b){return this._evaluator.globals=r,this._evaluator.feature=s,this._evaluator.featureState=c,this._evaluator.canonical=f,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=b,this.expression.evaluate(this._evaluator)}evaluate(r,s,c,f,v,b){this._evaluator.globals=r,this._evaluator.feature=s||null,this._evaluator.featureState=c||null,this._evaluator.canonical=f,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=b||null;try{const w=this.expression.evaluate(this._evaluator);if(w==null||typeof w=="number"&&w!=w)return this._defaultValue;if(this._enumValues&&!(w in this._enumValues))throw new jr(`Expected value to be one of ${Object.keys(this._enumValues).map(S=>JSON.stringify(S)).join(", ")}, but found ${JSON.stringify(w)} instead.`);return w}catch(w){return this._warningHistory[w.message]||(this._warningHistory[w.message]=!0,typeof console<"u"&&console.warn(w.message)),this._defaultValue}}}function Za(o){return Array.isArray(o)&&o.length>0&&typeof o[0]=="string"&&o[0]in Xs}function ec(o,r){const s=new $s(Xs,Xl,[],r?function(f){const v={color:Ut,string:St,number:rt,enum:St,boolean:pt,formatted:zr,padding:Dl,projectionDefinition:Xr,resolvedImage:Ds,variableAnchorOffsetCollection:Ao};return f.type==="array"?on(v[f.value]||Ft,f.length):v[f.type]}(r):void 0),c=s.parse(o,void 0,void 0,void 0,r&&r.type==="string"?{typeAnnotation:"coerce"}:void 0);return c?Od(new Qs(c,r)):Ys(s.errors)}class Eu{constructor(r,s){this.kind=r,this._styleExpression=s,this.isStateDependent=r!=="constant"&&!Ua(s.expression)}evaluateWithoutErrorHandling(r,s,c,f,v,b){return this._styleExpression.evaluateWithoutErrorHandling(r,s,c,f,v,b)}evaluate(r,s,c,f,v,b){return this._styleExpression.evaluate(r,s,c,f,v,b)}}class Cu{constructor(r,s,c,f){this.kind=r,this.zoomStops=c,this._styleExpression=s,this.isStateDependent=r!=="camera"&&!Ua(s.expression),this.interpolationType=f}evaluateWithoutErrorHandling(r,s,c,f,v,b){return this._styleExpression.evaluateWithoutErrorHandling(r,s,c,f,v,b)}evaluate(r,s,c,f,v,b){return this._styleExpression.evaluate(r,s,c,f,v,b)}interpolationFactor(r,s,c){return this.interpolationType?Vi.interpolationFactor(this.interpolationType,r,s,c):0}}function Vd(o,r){const s=ec(o,r);if(s.result==="error")return s;const c=s.value.expression,f=Yl(c);if(!f&&!Js(r))return Ys([new kt("","data expressions not supported")]);const v=Jl(c,["zoom"]);if(!v&&!Fd(r))return Ys([new kt("","zoom expressions not supported")]);const b=qa(c);return b||v?b instanceof kt?Ys([b]):b instanceof Vi&&!Tu(r)?Ys([new kt("",'"interpolate" expressions cannot be used with this property')]):Od(b?new Cu(f?"camera":"composite",s.value,b.labels,b instanceof Vi?b.interpolation:void 0):new Eu(f?"constant":"source",s.value)):Ys([new kt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class tc{constructor(r,s){this._parameters=r,this._specification=s,Nt(this,Bd(this._parameters,this._specification))}static deserialize(r){return new tc(r._parameters,r._specification)}static serialize(r){return{_parameters:r._parameters,_specification:r._specification}}}function qa(o){let r=null;if(o instanceof sr)r=qa(o.result);else if(o instanceof Zs){for(const s of o.args)if(r=qa(s),r)break}else(o instanceof Gs||o instanceof Vi)&&o.input instanceof Cn&&o.input.name==="zoom"&&(r=o);return r instanceof kt||o.eachChild(s=>{const c=qa(s);c instanceof kt?r=c:!r&&c?r=new kt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):r&&c&&r!==c&&(r=new kt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),r}function rc(o){if(o===!0||o===!1)return!0;if(!Array.isArray(o)||o.length===0)return!1;switch(o[0]){case"has":return o.length>=2&&o[1]!=="$id"&&o[1]!=="$type";case"in":return o.length>=3&&(typeof o[1]!="string"||Array.isArray(o[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return o.length!==3||Array.isArray(o[1])||Array.isArray(o[2]);case"any":case"all":for(const r of o.slice(1))if(!rc(r)&&typeof r!="boolean")return!1;return!0;default:return!0}}const Yp={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Iu(o){if(o==null)return{filter:()=>!0,needGeometry:!1};rc(o)||(o=Ha(o));const r=ec(o,Yp);if(r.result==="error")throw new Error(r.value.map(s=>`${s.key}: ${s.message}`).join(", "));return{filter:(s,c,f)=>r.value.evaluate(s,c,{},f),needGeometry:Mu(o)}}function $d(o,r){return o<r?-1:o>r?1:0}function Mu(o){if(!Array.isArray(o))return!1;if(o[0]==="within"||o[0]==="distance")return!0;for(let r=1;r<o.length;r++)if(Mu(o[r]))return!0;return!1}function Ha(o){if(!o)return!0;const r=o[0];return o.length<=1?r!=="any":r==="=="?ic(o[1],o[2],"=="):r==="!="?ea(ic(o[1],o[2],"==")):r==="<"||r===">"||r==="<="||r===">="?ic(o[1],o[2],r):r==="any"?(s=o.slice(1),["any"].concat(s.map(Ha))):r==="all"?["all"].concat(o.slice(1).map(Ha)):r==="none"?["all"].concat(o.slice(1).map(Ha).map(ea)):r==="in"?nc(o[1],o.slice(2)):r==="!in"?ea(nc(o[1],o.slice(2))):r==="has"?oc(o[1]):r!=="!has"||ea(oc(o[1]));var s}function ic(o,r,s){switch(o){case"$type":return[`filter-type-${s}`,r];case"$id":return[`filter-id-${s}`,r];default:return[`filter-${s}`,o,r]}}function nc(o,r){if(r.length===0)return!1;switch(o){case"$type":return["filter-type-in",["literal",r]];case"$id":return["filter-id-in",["literal",r]];default:return r.length>200&&!r.some(s=>typeof s!=typeof r[0])?["filter-in-large",o,["literal",r.sort($d)]]:["filter-in-small",o,["literal",r]]}}function oc(o){switch(o){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",o]}}function ea(o){return["!",o]}function ta(o){const r=typeof o;if(r==="number"||r==="boolean"||r==="string"||o==null)return JSON.stringify(o);if(Array.isArray(o)){let f="[";for(const v of o)f+=`${ta(v)},`;return`${f}]`}const s=Object.keys(o).sort();let c="{";for(let f=0;f<s.length;f++)c+=`${JSON.stringify(s[f])}:${ta(o[s[f]])},`;return`${c}}`}function Jp(o){let r="";for(const s of he)r+=`/${ta(o[s])}`;return r}function Ud(o){const r=o.value;return r?[new Ve(o.key,r,"constants have been deprecated as of v8")]:[]}function ni(o){return o instanceof Number||o instanceof String||o instanceof Boolean?o.valueOf():o}function us(o){if(Array.isArray(o))return o.map(us);if(o instanceof Object&&!(o instanceof Number||o instanceof String||o instanceof Boolean)){const r={};for(const s in o)r[s]=us(o[s]);return r}return ni(o)}function In(o){const r=o.key,s=o.value,c=o.valueSpec||{},f=o.objectElementValidators||{},v=o.style,b=o.styleSpec,w=o.validateSpec;let S=[];const C=ur(s);if(C!=="object")return[new Ve(r,s,`object expected, ${C} found`)];for(const A in s){const R=A.split(".")[0],j=c[R]||c["*"];let $;if(f[R])$=f[R];else if(c[R])$=w;else if(f["*"])$=f["*"];else{if(!c["*"]){S.push(new Ve(r,s[A],`unknown property "${A}"`));continue}$=w}S=S.concat($({key:(r&&`${r}.`)+A,value:s[A],valueSpec:j,style:v,styleSpec:b,object:s,objectKey:A,validateSpec:w},s))}for(const A in c)f[A]||c[A].required&&c[A].default===void 0&&s[A]===void 0&&S.push(new Ve(r,s,`missing required property "${A}"`));return S}function Pu(o){const r=o.value,s=o.valueSpec,c=o.style,f=o.styleSpec,v=o.key,b=o.arrayElementValidator||o.validateSpec;if(ur(r)!=="array")return[new Ve(v,r,`array expected, ${ur(r)} found`)];if(s.length&&r.length!==s.length)return[new Ve(v,r,`array length ${s.length} expected, length ${r.length} found`)];if(s["min-length"]&&r.length<s["min-length"])return[new Ve(v,r,`array length at least ${s["min-length"]} expected, length ${r.length} found`)];let w={type:s.value,values:s.values};f.$version<7&&(w.function=s.function),ur(s.value)==="object"&&(w=s.value);let S=[];for(let C=0;C<r.length;C++)S=S.concat(b({array:r,arrayIndex:C,value:r[C],valueSpec:w,validateSpec:o.validateSpec,style:c,styleSpec:f,key:`${v}[${C}]`}));return S}function sc(o){const r=o.key,s=o.value,c=o.valueSpec;let f=ur(s);return f==="number"&&s!=s&&(f="NaN"),f!=="number"?[new Ve(r,s,`number expected, ${f} found`)]:"minimum"in c&&s<c.minimum?[new Ve(r,s,`${s} is less than the minimum value ${c.minimum}`)]:"maximum"in c&&s>c.maximum?[new Ve(r,s,`${s} is greater than the maximum value ${c.maximum}`)]:[]}function Au(o){const r=o.valueSpec,s=ni(o.value.type);let c,f,v,b={};const w=s!=="categorical"&&o.value.property===void 0,S=!w,C=ur(o.value.stops)==="array"&&ur(o.value.stops[0])==="array"&&ur(o.value.stops[0][0])==="object",A=In({key:o.key,value:o.value,valueSpec:o.styleSpec.function,validateSpec:o.validateSpec,style:o.style,styleSpec:o.styleSpec,objectElementValidators:{stops:function($){if(s==="identity")return[new Ve($.key,$.value,'identity function may not have a "stops" property')];let G=[];const W=$.value;return G=G.concat(Pu({key:$.key,value:W,valueSpec:$.valueSpec,validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec,arrayElementValidator:R})),ur(W)==="array"&&W.length===0&&G.push(new Ve($.key,W,"array must have at least one stop")),G},default:function($){return $.validateSpec({key:$.key,value:$.value,valueSpec:r,validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec})}}});return s==="identity"&&w&&A.push(new Ve(o.key,o.value,'missing required property "property"')),s==="identity"||o.value.stops||A.push(new Ve(o.key,o.value,'missing required property "stops"')),s==="exponential"&&o.valueSpec.expression&&!Tu(o.valueSpec)&&A.push(new Ve(o.key,o.value,"exponential functions not supported")),o.styleSpec.$version>=8&&(S&&!Js(o.valueSpec)?A.push(new Ve(o.key,o.value,"property functions not supported")):w&&!Fd(o.valueSpec)&&A.push(new Ve(o.key,o.value,"zoom functions not supported"))),s!=="categorical"&&!C||o.value.property!==void 0||A.push(new Ve(o.key,o.value,'"property" property is required')),A;function R($){let G=[];const W=$.value,te=$.key;if(ur(W)!=="array")return[new Ve(te,W,`array expected, ${ur(W)} found`)];if(W.length!==2)return[new Ve(te,W,`array length 2 expected, length ${W.length} found`)];if(C){if(ur(W[0])!=="object")return[new Ve(te,W,`object expected, ${ur(W[0])} found`)];if(W[0].zoom===void 0)return[new Ve(te,W,"object stop key must have zoom")];if(W[0].value===void 0)return[new Ve(te,W,"object stop key must have value")];if(v&&v>ni(W[0].zoom))return[new Ve(te,W[0].zoom,"stop zoom values must appear in ascending order")];ni(W[0].zoom)!==v&&(v=ni(W[0].zoom),f=void 0,b={}),G=G.concat(In({key:`${te}[0]`,value:W[0],valueSpec:{zoom:{}},validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec,objectElementValidators:{zoom:sc,value:j}}))}else G=G.concat(j({key:`${te}[0]`,value:W[0],validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec},W));return Za(us(W[1]))?G.concat([new Ve(`${te}[1]`,W[1],"expressions are not allowed in function stops.")]):G.concat($.validateSpec({key:`${te}[1]`,value:W[1],valueSpec:r,validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec}))}function j($,G){const W=ur($.value),te=ni($.value),se=$.value!==null?$.value:G;if(c){if(W!==c)return[new Ve($.key,se,`${W} stop domain type must match previous stop domain type ${c}`)]}else c=W;if(W!=="number"&&W!=="string"&&W!=="boolean")return[new Ve($.key,se,"stop domain value must be a number, string, or boolean")];if(W!=="number"&&s!=="categorical"){let ye=`number expected, ${W} found`;return Js(r)&&s===void 0&&(ye+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ve($.key,se,ye)]}return s!=="categorical"||W!=="number"||isFinite(te)&&Math.floor(te)===te?s!=="categorical"&&W==="number"&&f!==void 0&&te<f?[new Ve($.key,se,"stop domain values must appear in ascending order")]:(f=te,s==="categorical"&&te in b?[new Ve($.key,se,"stop domain values must be unique")]:(b[te]=!0,[])):[new Ve($.key,se,`integer expected, found ${te}`)]}}function po(o){const r=(o.expressionContext==="property"?Vd:ec)(us(o.value),o.valueSpec);if(r.result==="error")return r.value.map(c=>new Ve(`${o.key}${c.key}`,o.value,c.message));const s=r.value.expression||r.value._styleExpression.expression;if(o.expressionContext==="property"&&o.propertyKey==="text-font"&&!s.outputDefined())return[new Ve(o.key,o.value,`Invalid data expression for "${o.propertyKey}". Output values must be contained as literals within the expression.`)];if(o.expressionContext==="property"&&o.propertyType==="layout"&&!Ua(s))return[new Ve(o.key,o.value,'"feature-state" data expressions are not supported with layout properties.')];if(o.expressionContext==="filter"&&!Ua(s))return[new Ve(o.key,o.value,'"feature-state" data expressions are not supported with filters.')];if(o.expressionContext&&o.expressionContext.indexOf("cluster")===0){if(!Jl(s,["zoom","feature-state"]))return[new Ve(o.key,o.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(o.expressionContext==="cluster-initial"&&!Yl(s))return[new Ve(o.key,o.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Wa(o){const r=o.key,s=o.value,c=o.valueSpec,f=[];return Array.isArray(c.values)?c.values.indexOf(ni(s))===-1&&f.push(new Ve(r,s,`expected one of [${c.values.join(", ")}], ${JSON.stringify(s)} found`)):Object.keys(c.values).indexOf(ni(s))===-1&&f.push(new Ve(r,s,`expected one of [${Object.keys(c.values).join(", ")}], ${JSON.stringify(s)} found`)),f}function ac(o){return rc(us(o.value))?po(Nt({},o,{expressionContext:"filter",valueSpec:{value:"boolean"}})):ku(o)}function ku(o){const r=o.value,s=o.key;if(ur(r)!=="array")return[new Ve(s,r,`array expected, ${ur(r)} found`)];const c=o.styleSpec;let f,v=[];if(r.length<1)return[new Ve(s,r,"filter array must have at least 1 element")];switch(v=v.concat(Wa({key:`${s}[0]`,value:r[0],valueSpec:c.filter_operator,style:o.style,styleSpec:o.styleSpec})),ni(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&ni(r[1])==="$type"&&v.push(new Ve(s,r,`"$type" cannot be use with operator "${r[0]}"`));case"==":case"!=":r.length!==3&&v.push(new Ve(s,r,`filter array for operator "${r[0]}" must have 3 elements`));case"in":case"!in":r.length>=2&&(f=ur(r[1]),f!=="string"&&v.push(new Ve(`${s}[1]`,r[1],`string expected, ${f} found`)));for(let b=2;b<r.length;b++)f=ur(r[b]),ni(r[1])==="$type"?v=v.concat(Wa({key:`${s}[${b}]`,value:r[b],valueSpec:c.geometry_type,style:o.style,styleSpec:o.styleSpec})):f!=="string"&&f!=="number"&&f!=="boolean"&&v.push(new Ve(`${s}[${b}]`,r[b],`string, number, or boolean expected, ${f} found`));break;case"any":case"all":case"none":for(let b=1;b<r.length;b++)v=v.concat(ku({key:`${s}[${b}]`,value:r[b],style:o.style,styleSpec:o.styleSpec}));break;case"has":case"!has":f=ur(r[1]),r.length!==2?v.push(new Ve(s,r,`filter array for "${r[0]}" operator must have 2 elements`)):f!=="string"&&v.push(new Ve(`${s}[1]`,r[1],`string expected, ${f} found`))}return v}function Gd(o,r){const s=o.key,c=o.validateSpec,f=o.style,v=o.styleSpec,b=o.value,w=o.objectKey,S=v[`${r}_${o.layerType}`];if(!S)return[];const C=w.match(/^(.*)-transition$/);if(r==="paint"&&C&&S[C[1]]&&S[C[1]].transition)return c({key:s,value:b,valueSpec:v.transition,style:f,styleSpec:v});const A=o.valueSpec||S[w];if(!A)return[new Ve(s,b,`unknown property "${w}"`)];let R;if(ur(b)==="string"&&Js(A)&&!A.tokens&&(R=/^{([^}]+)}$/.exec(b)))return[new Ve(s,b,`"${w}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(R[1])} }\`.`)];const j=[];return o.layerType==="symbol"&&(w==="text-field"&&f&&!f.glyphs&&j.push(new Ve(s,b,'use of "text-field" requires a style "glyphs" property')),w==="text-font"&&Ql(us(b))&&ni(b.type)==="identity"&&j.push(new Ve(s,b,'"text-font" does not support identity functions'))),j.concat(c({key:o.key,value:b,valueSpec:A,style:f,styleSpec:v,expressionContext:"property",propertyType:r,propertyKey:w}))}function Lu(o){return Gd(o,"paint")}function zu(o){return Gd(o,"layout")}function ra(o){let r=[];const s=o.value,c=o.key,f=o.style,v=o.styleSpec;s.type||s.ref||r.push(new Ve(c,s,'either "type" or "ref" is required'));let b=ni(s.type);const w=ni(s.ref);if(s.id){const S=ni(s.id);for(let C=0;C<o.arrayIndex;C++){const A=f.layers[C];ni(A.id)===S&&r.push(new Ve(c,s.id,`duplicate layer id "${s.id}", previously used at line ${A.id.__line__}`))}}if("ref"in s){let S;["type","source","source-layer","filter","layout"].forEach(C=>{C in s&&r.push(new Ve(c,s[C],`"${C}" is prohibited for ref layers`))}),f.layers.forEach(C=>{ni(C.id)===w&&(S=C)}),S?S.ref?r.push(new Ve(c,s.ref,"ref cannot reference another ref layer")):b=ni(S.type):r.push(new Ve(c,s.ref,`ref layer "${w}" not found`))}else if(b!=="background")if(s.source){const S=f.sources&&f.sources[s.source],C=S&&ni(S.type);S?C==="vector"&&b==="raster"?r.push(new Ve(c,s.source,`layer "${s.id}" requires a raster source`)):C!=="raster-dem"&&b==="hillshade"?r.push(new Ve(c,s.source,`layer "${s.id}" requires a raster-dem source`)):C==="raster"&&b!=="raster"?r.push(new Ve(c,s.source,`layer "${s.id}" requires a vector source`)):C!=="vector"||s["source-layer"]?C==="raster-dem"&&b!=="hillshade"?r.push(new Ve(c,s.source,"raster-dem source can only be used with layer type 'hillshade'.")):b!=="line"||!s.paint||!s.paint["line-gradient"]||C==="geojson"&&S.lineMetrics||r.push(new Ve(c,s,`layer "${s.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):r.push(new Ve(c,s,`layer "${s.id}" must specify a "source-layer"`)):r.push(new Ve(c,s.source,`source "${s.source}" not found`))}else r.push(new Ve(c,s,'missing required property "source"'));return r=r.concat(In({key:c,value:s,valueSpec:v.layer,style:o.style,styleSpec:o.styleSpec,validateSpec:o.validateSpec,objectElementValidators:{"*":()=>[],type:()=>o.validateSpec({key:`${c}.type`,value:s.type,valueSpec:v.layer.type,style:o.style,styleSpec:o.styleSpec,validateSpec:o.validateSpec,object:s,objectKey:"type"}),filter:ac,layout:S=>In({layer:s,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":C=>zu(Nt({layerType:b},C))}}),paint:S=>In({layer:s,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":C=>Lu(Nt({layerType:b},C))}})}})),r}function hs(o){const r=o.value,s=o.key,c=ur(r);return c!=="string"?[new Ve(s,r,`string expected, ${c} found`)]:[]}const Zd={promoteId:function({key:o,value:r}){if(ur(r)==="string")return hs({key:o,value:r});{const s=[];for(const c in r)s.push(...hs({key:`${o}.${c}`,value:r[c]}));return s}}};function qd(o){const r=o.value,s=o.key,c=o.styleSpec,f=o.style,v=o.validateSpec;if(!r.type)return[new Ve(s,r,'"type" is required')];const b=ni(r.type);let w;switch(b){case"vector":case"raster":return w=In({key:s,value:r,valueSpec:c[`source_${b.replace("-","_")}`],style:o.style,styleSpec:c,objectElementValidators:Zd,validateSpec:v}),w;case"raster-dem":return w=function(S){var C;const A=(C=S.sourceName)!==null&&C!==void 0?C:"",R=S.value,j=S.styleSpec,$=j.source_raster_dem,G=S.style;let W=[];const te=ur(R);if(R===void 0)return W;if(te!=="object")return W.push(new Ve("source_raster_dem",R,`object expected, ${te} found`)),W;const se=ni(R.encoding)==="custom",ye=["redFactor","greenFactor","blueFactor","baseShift"],ue=S.value.encoding?`"${S.value.encoding}"`:"Default";for(const V in R)!se&&ye.includes(V)?W.push(new Ve(V,R[V],`In "${A}": "${V}" is only valid when "encoding" is set to "custom". ${ue} encoding found`)):$[V]?W=W.concat(S.validateSpec({key:V,value:R[V],valueSpec:$[V],validateSpec:S.validateSpec,style:G,styleSpec:j})):W.push(new Ve(V,R[V],`unknown property "${V}"`));return W}({sourceName:s,value:r,style:o.style,styleSpec:c,validateSpec:v}),w;case"geojson":if(w=In({key:s,value:r,valueSpec:c.source_geojson,style:f,styleSpec:c,validateSpec:v,objectElementValidators:Zd}),r.cluster)for(const S in r.clusterProperties){const[C,A]=r.clusterProperties[S],R=typeof C=="string"?[C,["accumulated"],["get",S]]:C;w.push(...po({key:`${s}.${S}.map`,value:A,expressionContext:"cluster-map"})),w.push(...po({key:`${s}.${S}.reduce`,value:R,expressionContext:"cluster-reduce"}))}return w;case"video":return In({key:s,value:r,valueSpec:c.source_video,style:f,validateSpec:v,styleSpec:c});case"image":return In({key:s,value:r,valueSpec:c.source_image,style:f,validateSpec:v,styleSpec:c});case"canvas":return[new Ve(s,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Wa({key:`${s}.type`,value:r.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Hd(o){const r=o.value,s=o.styleSpec,c=s.light,f=o.style;let v=[];const b=ur(r);if(r===void 0)return v;if(b!=="object")return v=v.concat([new Ve("light",r,`object expected, ${b} found`)]),v;for(const w in r){const S=w.match(/^(.*)-transition$/);v=v.concat(S&&c[S[1]]&&c[S[1]].transition?o.validateSpec({key:w,value:r[w],valueSpec:s.transition,validateSpec:o.validateSpec,style:f,styleSpec:s}):c[w]?o.validateSpec({key:w,value:r[w],valueSpec:c[w],validateSpec:o.validateSpec,style:f,styleSpec:s}):[new Ve(w,r[w],`unknown property "${w}"`)])}return v}function Wd(o){const r=o.value,s=o.styleSpec,c=s.sky,f=o.style,v=ur(r);if(r===void 0)return[];if(v!=="object")return[new Ve("sky",r,`object expected, ${v} found`)];let b=[];for(const w in r)b=b.concat(c[w]?o.validateSpec({key:w,value:r[w],valueSpec:c[w],style:f,styleSpec:s}):[new Ve(w,r[w],`unknown property "${w}"`)]);return b}function Kd(o){const r=o.value,s=o.styleSpec,c=s.terrain,f=o.style;let v=[];const b=ur(r);if(r===void 0)return v;if(b!=="object")return v=v.concat([new Ve("terrain",r,`object expected, ${b} found`)]),v;for(const w in r)v=v.concat(c[w]?o.validateSpec({key:w,value:r[w],valueSpec:c[w],validateSpec:o.validateSpec,style:f,styleSpec:s}):[new Ve(w,r[w],`unknown property "${w}"`)]);return v}function ia(o){let r=[];const s=o.value,c=o.key;if(Array.isArray(s)){const f=[],v=[];for(const b in s)s[b].id&&f.includes(s[b].id)&&r.push(new Ve(c,s,`all the sprites' ids must be unique, but ${s[b].id} is duplicated`)),f.push(s[b].id),s[b].url&&v.includes(s[b].url)&&r.push(new Ve(c,s,`all the sprites' URLs must be unique, but ${s[b].url} is duplicated`)),v.push(s[b].url),r=r.concat(In({key:`${c}[${b}]`,value:s[b],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:o.validateSpec}));return r}return hs({key:c,value:s})}const na={"*":()=>[],array:Pu,boolean:function(o){const r=o.value,s=o.key,c=ur(r);return c!=="boolean"?[new Ve(s,r,`boolean expected, ${c} found`)]:[]},number:sc,color:function(o){const r=o.key,s=o.value,c=ur(s);return c!=="string"?[new Ve(r,s,`color expected, ${c} found`)]:lr.parse(String(s))?[]:[new Ve(r,s,`color expected, "${s}" found`)]},constants:Ud,enum:Wa,filter:ac,function:Au,layer:ra,object:In,source:qd,light:Hd,sky:Wd,terrain:Kd,projection:function(o){const r=o.value,s=o.styleSpec,c=s.projection,f=o.style,v=ur(r);if(r===void 0)return[];if(v!=="object")return[new Ve("projection",r,`object expected, ${v} found`)];let b=[];for(const w in r)b=b.concat(c[w]?o.validateSpec({key:w,value:r[w],valueSpec:c[w],style:f,styleSpec:s}):[new Ve(w,r[w],`unknown property "${w}"`)]);return b},projectionDefinition:function(o){const r=o.key;let s=o.value;s=s instanceof String?s.valueOf():s;const c=ur(s);return c!=="array"||function(f){return Array.isArray(f)&&f.length===3&&typeof f[0]=="string"&&typeof f[1]=="string"&&typeof f[2]=="number"}(s)||function(f){return!!["interpolate","step","literal"].includes(f[0])}(s)?["array","string"].includes(c)?[]:[new Ve(r,s,`projection expected, invalid type "${c}" found`)]:[new Ve(r,s,`projection expected, invalid array ${JSON.stringify(s)} found`)]},string:hs,formatted:function(o){return hs(o).length===0?[]:po(o)},resolvedImage:function(o){return hs(o).length===0?[]:po(o)},padding:function(o){const r=o.key,s=o.value;if(ur(s)==="array"){if(s.length<1||s.length>4)return[new Ve(r,s,`padding requires 1 to 4 values; ${s.length} values found`)];const c={type:"number"};let f=[];for(let v=0;v<s.length;v++)f=f.concat(o.validateSpec({key:`${r}[${v}]`,value:s[v],validateSpec:o.validateSpec,valueSpec:c}));return f}return sc({key:r,value:s,valueSpec:{}})},variableAnchorOffsetCollection:function(o){const r=o.key,s=o.value,c=ur(s),f=o.styleSpec;if(c!=="array"||s.length<1||s.length%2!=0)return[new Ve(r,s,"variableAnchorOffsetCollection requires a non-empty array of even length")];let v=[];for(let b=0;b<s.length;b+=2)v=v.concat(Wa({key:`${r}[${b}]`,value:s[b],valueSpec:f.layout_symbol["text-anchor"]})),v=v.concat(Pu({key:`${r}[${b+1}]`,value:s[b+1],valueSpec:{length:2,value:"number"},validateSpec:o.validateSpec,style:o.style,styleSpec:f}));return v},sprite:ia};function $i(o){const r=o.value,s=o.valueSpec,c=o.styleSpec;return o.validateSpec=$i,s.expression&&Ql(ni(r))?Au(o):s.expression&&Za(us(r))?po(o):s.type&&na[s.type]?na[s.type](o):In(Nt({},o,{valueSpec:s.type?c[s.type]:s}))}function oa(o){const r=o.value,s=o.key,c=hs(o);return c.length||(r.indexOf("{fontstack}")===-1&&c.push(new Ve(s,r,'"glyphs" url must include a "{fontstack}" token')),r.indexOf("{range}")===-1&&c.push(new Ve(s,r,'"glyphs" url must include a "{range}" token'))),c}function Mn(o,r=U){let s=[];return s=s.concat($i({key:"",value:o,valueSpec:r.$root,styleSpec:r,style:o,validateSpec:$i,objectElementValidators:{glyphs:oa,"*":()=>[]}})),o.constants&&(s=s.concat(Ud({key:"constants",value:o.constants}))),Xd(s)}function Xn(o){return function(r){return o({...r,validateSpec:$i})}}function Xd(o){return[].concat(o).sort((r,s)=>r.line-s.line)}function ln(o){return function(...r){return Xd(o.apply(this,r))}}Mn.source=ln(Xn(qd)),Mn.sprite=ln(Xn(ia)),Mn.glyphs=ln(Xn(oa)),Mn.light=ln(Xn(Hd)),Mn.sky=ln(Xn(Wd)),Mn.terrain=ln(Xn(Kd)),Mn.layer=ln(Xn(ra)),Mn.filter=ln(Xn(ac)),Mn.paintProperty=ln(Xn(Lu)),Mn.layoutProperty=ln(Xn(zu));const ds=Mn,Ru=ds.light,Qp=ds.sky,Du=ds.paintProperty,em=ds.layoutProperty;function sa(o,r){let s=!1;if(r&&r.length)for(const c of r)o.fire(new q(new Error(c.message))),s=!0;return s}class Ka{constructor(r,s,c){const f=this.cells=[];if(r instanceof ArrayBuffer){this.arrayBuffer=r;const b=new Int32Array(this.arrayBuffer);r=b[0],this.d=(s=b[1])+2*(c=b[2]);for(let S=0;S<this.d*this.d;S++){const C=b[3+S],A=b[3+S+1];f.push(C===A?null:b.subarray(C,A))}const w=b[3+f.length+1];this.keys=b.subarray(b[3+f.length],w),this.bboxes=b.subarray(w),this.insert=this._insertReadonly}else{this.d=s+2*c;for(let b=0;b<this.d*this.d;b++)f.push([]);this.keys=[],this.bboxes=[]}this.n=s,this.extent=r,this.padding=c,this.scale=s/r,this.uid=0;const v=c/s*r;this.min=-v,this.max=r+v}insert(r,s,c,f,v){this._forEachCell(s,c,f,v,this._insertCell,this.uid++,void 0,void 0),this.keys.push(r),this.bboxes.push(s),this.bboxes.push(c),this.bboxes.push(f),this.bboxes.push(v)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(r,s,c,f,v,b){this.cells[v].push(b)}query(r,s,c,f,v){const b=this.min,w=this.max;if(r<=b&&s<=b&&w<=c&&w<=f&&!v)return Array.prototype.slice.call(this.keys);{const S=[];return this._forEachCell(r,s,c,f,this._queryCell,S,{},v),S}}_queryCell(r,s,c,f,v,b,w,S){const C=this.cells[v];if(C!==null){const A=this.keys,R=this.bboxes;for(let j=0;j<C.length;j++){const $=C[j];if(w[$]===void 0){const G=4*$;(S?S(R[G+0],R[G+1],R[G+2],R[G+3]):r<=R[G+2]&&s<=R[G+3]&&c>=R[G+0]&&f>=R[G+1])?(w[$]=!0,b.push(A[$])):w[$]=!1}}}}_forEachCell(r,s,c,f,v,b,w,S){const C=this._convertToCellCoord(r),A=this._convertToCellCoord(s),R=this._convertToCellCoord(c),j=this._convertToCellCoord(f);for(let $=C;$<=R;$++)for(let G=A;G<=j;G++){const W=this.d*G+$;if((!S||S(this._convertFromCellCoord($),this._convertFromCellCoord(G),this._convertFromCellCoord($+1),this._convertFromCellCoord(G+1)))&&v.call(this,r,s,c,f,W,b,w,S))return}}_convertFromCellCoord(r){return(r-this.padding)/this.scale}_convertToCellCoord(r){return Math.max(0,Math.min(this.d-1,Math.floor(r*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const r=this.cells,s=3+this.cells.length+1+1;let c=0;for(let b=0;b<this.cells.length;b++)c+=this.cells[b].length;const f=new Int32Array(s+c+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;let v=s;for(let b=0;b<r.length;b++){const w=r[b];f[3+b]=v,f.set(w,v),v+=w.length}return f[3+r.length]=v,f.set(this.keys,v),v+=this.keys.length,f[3+r.length+1]=v,f.set(this.bboxes,v),v+=this.bboxes.length,f.buffer}static serialize(r,s){const c=r.toArrayBuffer();return s&&s.push(c),{buffer:c}}static deserialize(r){return new Ka(r.buffer)}}const mn={};function wt(o,r,s={}){if(mn[o])throw new Error(`${o} is already registered.`);Object.defineProperty(r,"_classRegistryKey",{value:o,writeable:!1}),mn[o]={klass:r,omit:s.omit||[],shallow:s.shallow||[]}}wt("Object",Object),wt("TransferableGridIndex",Ka),wt("Color",lr),wt("Error",Error),wt("AJAXError",er),wt("ResolvedImage",sn),wt("StylePropertyFunction",tc),wt("StyleExpression",Qs,{omit:["_evaluator"]}),wt("ZoomDependentExpression",Cu),wt("ZoomConstantExpression",Eu),wt("CompoundExpression",Cn,{omit:["_evaluate"]});for(const o in Xs)Xs[o]._classRegistryKey||wt(`Expression_${o}`,Xs[o]);function Yd(o){return o&&typeof ArrayBuffer<"u"&&(o instanceof ArrayBuffer||o.constructor&&o.constructor.name==="ArrayBuffer")}function aa(o){return o.$name||o.constructor._classRegistryKey}function Jd(o){return!function(r){if(r===null||typeof r!="object")return!1;const s=aa(r);return!(!s||s==="Object")}(o)&&(o==null||typeof o=="boolean"||typeof o=="number"||typeof o=="string"||o instanceof Boolean||o instanceof Number||o instanceof String||o instanceof Date||o instanceof RegExp||o instanceof Blob||o instanceof Error||Yd(o)||We(o)||ArrayBuffer.isView(o)||o instanceof ImageData)}function fs(o,r){if(Jd(o))return(Yd(o)||We(o))&&r&&r.push(o),ArrayBuffer.isView(o)&&r&&r.push(o.buffer),o instanceof ImageData&&r&&r.push(o.data.buffer),o;if(Array.isArray(o)){const v=[];for(const b of o)v.push(fs(b,r));return v}if(typeof o!="object")throw new Error("can't serialize object of type "+typeof o);const s=aa(o);if(!s)throw new Error(`can't serialize object of unregistered class ${o.constructor.name}`);if(!mn[s])throw new Error(`${s} is not registered.`);const{klass:c}=mn[s],f=c.serialize?c.serialize(o,r):{};if(c.serialize){if(r&&f===r[r.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const v in o){if(!o.hasOwnProperty(v)||mn[s].omit.indexOf(v)>=0)continue;const b=o[v];f[v]=mn[s].shallow.indexOf(v)>=0?b:fs(b,r)}o instanceof Error&&(f.message=o.message)}if(f.$name)throw new Error("$name property is reserved for worker serialization logic.");return s!=="Object"&&(f.$name=s),f}function Do(o){if(Jd(o))return o;if(Array.isArray(o))return o.map(Do);if(typeof o!="object")throw new Error("can't deserialize object of type "+typeof o);const r=aa(o)||"Object";if(!mn[r])throw new Error(`can't deserialize unregistered class ${r}`);const{klass:s}=mn[r];if(!s)throw new Error(`can't deserialize unregistered class ${r}`);if(s.deserialize)return s.deserialize(o);const c=Object.create(s.prototype);for(const f of Object.keys(o)){if(f==="$name")continue;const v=o[f];c[f]=mn[r].shallow.indexOf(f)>=0?v:Do(v)}return c}class Ou{constructor(){this.first=!0}update(r,s){const c=Math.floor(r);return this.first?(this.first=!1,this.lastIntegerZoom=c,this.lastIntegerZoomTime=0,this.lastZoom=r,this.lastFloorZoom=c,!0):(this.lastFloorZoom>c?(this.lastIntegerZoom=c+1,this.lastIntegerZoomTime=s):this.lastFloorZoom<c&&(this.lastIntegerZoom=c,this.lastIntegerZoomTime=s),r!==this.lastZoom&&(this.lastZoom=r,this.lastFloorZoom=c,!0))}}const rr={"Latin-1 Supplement":o=>o>=128&&o<=255,"Hangul Jamo":o=>o>=4352&&o<=4607,Khmer:o=>o>=6016&&o<=6143,"General Punctuation":o=>o>=8192&&o<=8303,"Letterlike Symbols":o=>o>=8448&&o<=8527,"Number Forms":o=>o>=8528&&o<=8591,"Miscellaneous Technical":o=>o>=8960&&o<=9215,"Control Pictures":o=>o>=9216&&o<=9279,"Optical Character Recognition":o=>o>=9280&&o<=9311,"Enclosed Alphanumerics":o=>o>=9312&&o<=9471,"Geometric Shapes":o=>o>=9632&&o<=9727,"Miscellaneous Symbols":o=>o>=9728&&o<=9983,"Miscellaneous Symbols and Arrows":o=>o>=11008&&o<=11263,"Ideographic Description Characters":o=>o>=12272&&o<=12287,"CJK Symbols and Punctuation":o=>o>=12288&&o<=12351,Hiragana:o=>o>=12352&&o<=12447,Katakana:o=>o>=12448&&o<=12543,Kanbun:o=>o>=12688&&o<=12703,"CJK Strokes":o=>o>=12736&&o<=12783,"Enclosed CJK Letters and Months":o=>o>=12800&&o<=13055,"CJK Compatibility":o=>o>=13056&&o<=13311,"Yijing Hexagram Symbols":o=>o>=19904&&o<=19967,"CJK Unified Ideographs":o=>o>=19968&&o<=40959,"Hangul Syllables":o=>o>=44032&&o<=55215,"Private Use Area":o=>o>=57344&&o<=63743,"Vertical Forms":o=>o>=65040&&o<=65055,"CJK Compatibility Forms":o=>o>=65072&&o<=65103,"Small Form Variants":o=>o>=65104&&o<=65135,"Halfwidth and Fullwidth Forms":o=>o>=65280&&o<=65519};function lc(o){for(const r of o)if(Bu(r.charCodeAt(0)))return!0;return!1}function Qd(o){for(const r of o)if(!tm(r.charCodeAt(0)))return!1;return!0}function Xa(o){const r=o.map(s=>{try{return new RegExp(`\\p{sc=${s}}`,"u").source}catch{return null}}).filter(s=>s);return new RegExp(r.join("|"),"u")}const ef=Xa(["Arab","Dupl","Mong","Ougr","Syrc"]);function tm(o){return!ef.test(String.fromCodePoint(o))}const Fu=Xa(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Bu(o){return!(o!==746&&o!==747&&(o<4352||!(rr["CJK Compatibility Forms"](o)&&!(o>=65097&&o<=65103)||rr["CJK Compatibility"](o)||rr["CJK Strokes"](o)||!(!rr["CJK Symbols and Punctuation"](o)||o>=12296&&o<=12305||o>=12308&&o<=12319||o===12336)||rr["Enclosed CJK Letters and Months"](o)||rr["Ideographic Description Characters"](o)||rr.Kanbun(o)||rr.Katakana(o)&&o!==12540||!(!rr["Halfwidth and Fullwidth Forms"](o)||o===65288||o===65289||o===65293||o>=65306&&o<=65310||o===65339||o===65341||o===65343||o>=65371&&o<=65503||o===65507||o>=65512&&o<=65519)||!(!rr["Small Form Variants"](o)||o>=65112&&o<=65118||o>=65123&&o<=65126)||rr["Vertical Forms"](o)||rr["Yijing Hexagram Symbols"](o)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(o))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(o))||Fu.test(String.fromCodePoint(o)))))}function ju(o){return!(Bu(o)||function(r){return!!(rr["Latin-1 Supplement"](r)&&(r===167||r===169||r===174||r===177||r===188||r===189||r===190||r===215||r===247)||rr["General Punctuation"](r)&&(r===8214||r===8224||r===8225||r===8240||r===8241||r===8251||r===8252||r===8258||r===8263||r===8264||r===8265||r===8273)||rr["Letterlike Symbols"](r)||rr["Number Forms"](r)||rr["Miscellaneous Technical"](r)&&(r>=8960&&r<=8967||r>=8972&&r<=8991||r>=8996&&r<=9e3||r===9003||r>=9085&&r<=9114||r>=9150&&r<=9165||r===9167||r>=9169&&r<=9179||r>=9186&&r<=9215)||rr["Control Pictures"](r)&&r!==9251||rr["Optical Character Recognition"](r)||rr["Enclosed Alphanumerics"](r)||rr["Geometric Shapes"](r)||rr["Miscellaneous Symbols"](r)&&!(r>=9754&&r<=9759)||rr["Miscellaneous Symbols and Arrows"](r)&&(r>=11026&&r<=11055||r>=11088&&r<=11097||r>=11192&&r<=11243)||rr["CJK Symbols and Punctuation"](r)||rr.Katakana(r)||rr["Private Use Area"](r)||rr["CJK Compatibility Forms"](r)||rr["Small Form Variants"](r)||rr["Halfwidth and Fullwidth Forms"](r)||r===8734||r===8756||r===8757||r>=9984&&r<=10087||r>=10102&&r<=10131||r===65532||r===65533)}(o))}const tf=Xa(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Nu(o){return tf.test(String.fromCodePoint(o))}function rm(o,r){return!(!r&&Nu(o)||o>=2304&&o<=3583||o>=3840&&o<=4255||rr.Khmer(o))}function im(o){for(const r of o)if(Nu(r.charCodeAt(0)))return!0;return!1}const mo=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(o){this.pluginStatus=o.pluginStatus,this.pluginURL=o.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(o){if(mo.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=o.applyArabicShaping,this.processBidirectionalText=o.processBidirectionalText,this.processStyledBidirectionalText=o.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(o,r){return a(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(o.pluginStatus!=="loading")return this.setState(o),o;const s=o.pluginURL,c=new Promise(v=>{this.loadScriptResolve=v});r(s);const f=new Promise(v=>setTimeout(()=>v(),this.TIMEOUT));if(yield Promise.race([c,f]),this.isParsed()){const v={pluginStatus:"loaded",pluginURL:s};return this.setState(v),v}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${s}`)})}};class Dr{constructor(r,s){this.zoom=r,s?(this.now=s.now,this.fadeDuration=s.fadeDuration,this.zoomHistory=s.zoomHistory,this.transition=s.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Ou,this.transition={})}isSupportedScript(r){return function(s,c){for(const f of s)if(!rm(f.charCodeAt(0),c))return!1;return!0}(r,mo.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const r=this.zoom,s=r-Math.floor(r),c=this.crossFadingFactor();return r>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:s+(1-s)*c}:{fromScale:.5,toScale:1,t:1-(1-c)*s}}}class Ya{constructor(r,s){this.property=r,this.value=s,this.expression=function(c,f){if(Ql(c))return new tc(c,f);if(Za(c)){const v=Vd(c,f);if(v.result==="error")throw new Error(v.value.map(b=>`${b.key}: ${b.message}`).join(", "));return v.value}{let v=c;return f.type==="color"&&typeof c=="string"?v=lr.parse(c):f.type!=="padding"||typeof c!="number"&&!Array.isArray(c)?f.type==="variableAnchorOffsetCollection"&&Array.isArray(c)?v=Yi.parse(c):f.type==="projectionDefinition"&&typeof c=="string"&&(v=gi.parse(c)):v=Ri.parse(c),{kind:"constant",evaluate:()=>v}}}(s===void 0?r.specification.default:s,r.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(r,s,c){return this.property.possiblyEvaluate(this,r,s,c)}}class cc{constructor(r){this.property=r,this.value=new Ya(r,void 0)}transitioned(r,s){return new rf(this.property,this.value,s,Pt({},r.transition,this.transition),r.now)}untransitioned(){return new rf(this.property,this.value,null,{},0)}}class Ja{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitionablePropertyValues)}getValue(r){return vr(this._values[r].value.value)}setValue(r,s){Object.prototype.hasOwnProperty.call(this._values,r)||(this._values[r]=new cc(this._values[r].property)),this._values[r].value=new Ya(this._values[r].property,s===null?void 0:vr(s))}getTransition(r){return vr(this._values[r].transition)}setTransition(r,s){Object.prototype.hasOwnProperty.call(this._values,r)||(this._values[r]=new cc(this._values[r].property)),this._values[r].transition=vr(s)||void 0}serialize(){const r={};for(const s of Object.keys(this._values)){const c=this.getValue(s);c!==void 0&&(r[s]=c);const f=this.getTransition(s);f!==void 0&&(r[`${s}-transition`]=f)}return r}transitioned(r,s){const c=new uc(this._properties);for(const f of Object.keys(this._values))c._values[f]=this._values[f].transitioned(r,s._values[f]);return c}untransitioned(){const r=new uc(this._properties);for(const s of Object.keys(this._values))r._values[s]=this._values[s].untransitioned();return r}}class rf{constructor(r,s,c,f,v){this.property=r,this.value=s,this.begin=v+f.delay||0,this.end=this.begin+f.duration||0,r.specification.transition&&(f.delay||f.duration)&&(this.prior=c)}possiblyEvaluate(r,s,c){const f=r.now||0,v=this.value.possiblyEvaluate(r,s,c),b=this.prior;if(b){if(f>this.end)return this.prior=null,v;if(this.value.isDataDriven())return this.prior=null,v;if(f<this.begin)return b.possiblyEvaluate(r,s,c);{const w=(f-this.begin)/(this.end-this.begin);return this.property.interpolate(b.possiblyEvaluate(r,s,c),v,Mr(w))}}return v}}class uc{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitioningPropertyValues)}possiblyEvaluate(r,s,c){const f=new Qa(this._properties);for(const v of Object.keys(this._values))f._values[v]=this._values[v].possiblyEvaluate(r,s,c);return f}hasTransition(){for(const r of Object.keys(this._values))if(this._values[r].prior)return!0;return!1}}class nm{constructor(r){this._properties=r,this._values=Object.create(r.defaultPropertyValues)}hasValue(r){return this._values[r].value!==void 0}getValue(r){return vr(this._values[r].value)}setValue(r,s){this._values[r]=new Ya(this._values[r].property,s===null?void 0:vr(s))}serialize(){const r={};for(const s of Object.keys(this._values)){const c=this.getValue(s);c!==void 0&&(r[s]=c)}return r}possiblyEvaluate(r,s,c){const f=new Qa(this._properties);for(const v of Object.keys(this._values))f._values[v]=this._values[v].possiblyEvaluate(r,s,c);return f}}class Yn{constructor(r,s,c){this.property=r,this.value=s,this.parameters=c}isConstant(){return this.value.kind==="constant"}constantOr(r){return this.value.kind==="constant"?this.value.value:r}evaluate(r,s,c,f){return this.property.evaluate(this.value,this.parameters,r,s,c,f)}}class Qa{constructor(r){this._properties=r,this._values=Object.create(r.defaultPossiblyEvaluatedValues)}get(r){return this._values[r]}}class Mt{constructor(r){this.specification=r}possiblyEvaluate(r,s){if(r.isDataDriven())throw new Error("Value should not be data driven");return r.expression.evaluate(s)}interpolate(r,s,c){const f=Ln[this.specification.type];return f?f(r,s,c):r}}class Dt{constructor(r,s){this.specification=r,this.overrides=s}possiblyEvaluate(r,s,c,f){return new Yn(this,r.expression.kind==="constant"||r.expression.kind==="camera"?{kind:"constant",value:r.expression.evaluate(s,null,{},c,f)}:r.expression,s)}interpolate(r,s,c){if(r.value.kind!=="constant"||s.value.kind!=="constant")return r;if(r.value.value===void 0||s.value.value===void 0)return new Yn(this,{kind:"constant",value:void 0},r.parameters);const f=Ln[this.specification.type];if(f){const v=f(r.value.value,s.value.value,c);return new Yn(this,{kind:"constant",value:v},r.parameters)}return r}evaluate(r,s,c,f,v,b){return r.kind==="constant"?r.value:r.evaluate(s,c,f,v,b)}}class hc extends Dt{possiblyEvaluate(r,s,c,f){if(r.value===void 0)return new Yn(this,{kind:"constant",value:void 0},s);if(r.expression.kind==="constant"){const v=r.expression.evaluate(s,null,{},c,f),b=r.property.specification.type==="resolvedImage"&&typeof v!="string"?v.name:v,w=this._calculate(b,b,b,s);return new Yn(this,{kind:"constant",value:w},s)}if(r.expression.kind==="camera"){const v=this._calculate(r.expression.evaluate({zoom:s.zoom-1}),r.expression.evaluate({zoom:s.zoom}),r.expression.evaluate({zoom:s.zoom+1}),s);return new Yn(this,{kind:"constant",value:v},s)}return new Yn(this,r.expression,s)}evaluate(r,s,c,f,v,b){if(r.kind==="source"){const w=r.evaluate(s,c,f,v,b);return this._calculate(w,w,w,s)}return r.kind==="composite"?this._calculate(r.evaluate({zoom:Math.floor(s.zoom)-1},c,f),r.evaluate({zoom:Math.floor(s.zoom)},c,f),r.evaluate({zoom:Math.floor(s.zoom)+1},c,f),s):r.value}_calculate(r,s,c,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:r,to:s}:{from:c,to:s}}interpolate(r){return r}}class Vu{constructor(r){this.specification=r}possiblyEvaluate(r,s,c,f){if(r.value!==void 0){if(r.expression.kind==="constant"){const v=r.expression.evaluate(s,null,{},c,f);return this._calculate(v,v,v,s)}return this._calculate(r.expression.evaluate(new Dr(Math.floor(s.zoom-1),s)),r.expression.evaluate(new Dr(Math.floor(s.zoom),s)),r.expression.evaluate(new Dr(Math.floor(s.zoom+1),s)),s)}}_calculate(r,s,c,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:r,to:s}:{from:c,to:s}}interpolate(r){return r}}class $u{constructor(r){this.specification=r}possiblyEvaluate(r,s,c,f){return!!r.expression.evaluate(s,null,{},c,f)}interpolate(){return!1}}class cn{constructor(r){this.properties=r,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const s in r){const c=r[s];c.specification.overridable&&this.overridableProperties.push(s);const f=this.defaultPropertyValues[s]=new Ya(c,void 0),v=this.defaultTransitionablePropertyValues[s]=new cc(c);this.defaultTransitioningPropertyValues[s]=v.untransitioned(),this.defaultPossiblyEvaluatedValues[s]=f.possiblyEvaluate({})}}}wt("DataDrivenProperty",Dt),wt("DataConstantProperty",Mt),wt("CrossFadedDataDrivenProperty",hc),wt("CrossFadedProperty",Vu),wt("ColorRampProperty",$u);const nf="-transition";class Ji extends Y{constructor(r,s){if(super(),this.id=r.id,this.type=r.type,this._featureFilter={filter:()=>!0,needGeometry:!1},r.type!=="custom"&&(this.metadata=r.metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,r.type!=="background"&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),s.layout&&(this._unevaluatedLayout=new nm(s.layout)),s.paint)){this._transitionablePaint=new Ja(s.paint);for(const c in r.paint)this.setPaintProperty(c,r.paint[c],{validate:!1});for(const c in r.layout)this.setLayoutProperty(c,r.layout[c],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Qa(s.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(r){return r==="visibility"?this.visibility:this._unevaluatedLayout.getValue(r)}setLayoutProperty(r,s,c={}){s!=null&&this._validate(em,`layers.${this.id}.layout.${r}`,r,s,c)||(r!=="visibility"?this._unevaluatedLayout.setValue(r,s):this.visibility=s)}getPaintProperty(r){return r.endsWith(nf)?this._transitionablePaint.getTransition(r.slice(0,-11)):this._transitionablePaint.getValue(r)}setPaintProperty(r,s,c={}){if(s!=null&&this._validate(Du,`layers.${this.id}.paint.${r}`,r,s,c))return!1;if(r.endsWith(nf))return this._transitionablePaint.setTransition(r.slice(0,-11),s||void 0),!1;{const f=this._transitionablePaint._values[r],v=f.property.specification["property-type"]==="cross-faded-data-driven",b=f.value.isDataDriven(),w=f.value;this._transitionablePaint.setValue(r,s),this._handleSpecialPaintPropertyUpdate(r);const S=this._transitionablePaint._values[r].value;return S.isDataDriven()||b||v||this._handleOverridablePaintPropertyUpdate(r,w,S)}}_handleSpecialPaintPropertyUpdate(r){}_handleOverridablePaintPropertyUpdate(r,s,c){return!1}isHidden(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||this.visibility==="none"}updateTransitions(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(r,s){r.getCrossfadeParameters&&(this._crossfadeParameters=r.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,s)}serialize(){const r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),hr(r,(s,c)=>!(s===void 0||c==="layout"&&!Object.keys(s).length||c==="paint"&&!Object.keys(s).length))}_validate(r,s,c,f,v={}){return(!v||v.validate!==!1)&&sa(this,r.call(ds,{key:s,layerType:this.type,objectKey:c,value:f,styleSpec:U,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const r in this.paint._values){const s=this.paint.get(r);if(s instanceof Yn&&Js(s.property.specification)&&(s.value.kind==="source"||s.value.kind==="composite")&&s.value.isStateDependent)return!0}return!1}}const om={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class el{constructor(r,s){this._structArray=r,this._pos1=s*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Yr{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(r,s){return r._trim(),s&&(r.isTransferred=!0,s.push(r.arrayBuffer)),{length:r.length,arrayBuffer:r.arrayBuffer}}static deserialize(r){const s=Object.create(this.prototype);return s.arrayBuffer=r.arrayBuffer,s.length=r.length,s.capacity=r.arrayBuffer.byteLength/s.bytesPerElement,s._refreshViews(),s}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(r){this.reserve(r),this.length=r}reserve(r){if(r>this.capacity){this.capacity=Math.max(r,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const s=this.uint8;this._refreshViews(),s&&this.uint8.set(s)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function oi(o,r=1){let s=0,c=0;return{members:o.map(f=>{const v=om[f.type].BYTES_PER_ELEMENT,b=s=of(s,Math.max(r,v)),w=f.components||1;return c=Math.max(c,v),s+=v*w,{name:f.name,type:f.type,components:w,offset:b}}),size:of(s,Math.max(c,r)),alignment:r}}function of(o,r){return Math.ceil(o/r)*r}class tl extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s){const c=this.length;return this.resize(c+1),this.emplace(c,r,s)}emplace(r,s,c){const f=2*r;return this.int16[f+0]=s,this.int16[f+1]=c,r}}tl.prototype.bytesPerElement=4,wt("StructArrayLayout2i4",tl);class Jn extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,c){const f=this.length;return this.resize(f+1),this.emplace(f,r,s,c)}emplace(r,s,c,f){const v=3*r;return this.int16[v+0]=s,this.int16[v+1]=c,this.int16[v+2]=f,r}}Jn.prototype.bytesPerElement=6,wt("StructArrayLayout3i6",Jn);class dc extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,c,f){const v=this.length;return this.resize(v+1),this.emplace(v,r,s,c,f)}emplace(r,s,c,f,v){const b=4*r;return this.int16[b+0]=s,this.int16[b+1]=c,this.int16[b+2]=f,this.int16[b+3]=v,r}}dc.prototype.bytesPerElement=8,wt("StructArrayLayout4i8",dc);class rl extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,c,f,v,b){const w=this.length;return this.resize(w+1),this.emplace(w,r,s,c,f,v,b)}emplace(r,s,c,f,v,b,w){const S=6*r;return this.int16[S+0]=s,this.int16[S+1]=c,this.int16[S+2]=f,this.int16[S+3]=v,this.int16[S+4]=b,this.int16[S+5]=w,r}}rl.prototype.bytesPerElement=12,wt("StructArrayLayout2i4i12",rl);class fc extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,c,f,v,b){const w=this.length;return this.resize(w+1),this.emplace(w,r,s,c,f,v,b)}emplace(r,s,c,f,v,b,w){const S=4*r,C=8*r;return this.int16[S+0]=s,this.int16[S+1]=c,this.uint8[C+4]=f,this.uint8[C+5]=v,this.uint8[C+6]=b,this.uint8[C+7]=w,r}}fc.prototype.bytesPerElement=8,wt("StructArrayLayout2i4ub8",fc);class ps extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s){const c=this.length;return this.resize(c+1),this.emplace(c,r,s)}emplace(r,s,c){const f=2*r;return this.float32[f+0]=s,this.float32[f+1]=c,r}}ps.prototype.bytesPerElement=8,wt("StructArrayLayout2f8",ps);class Uu extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,c,f,v,b,w,S,C,A){const R=this.length;return this.resize(R+1),this.emplace(R,r,s,c,f,v,b,w,S,C,A)}emplace(r,s,c,f,v,b,w,S,C,A,R){const j=10*r;return this.uint16[j+0]=s,this.uint16[j+1]=c,this.uint16[j+2]=f,this.uint16[j+3]=v,this.uint16[j+4]=b,this.uint16[j+5]=w,this.uint16[j+6]=S,this.uint16[j+7]=C,this.uint16[j+8]=A,this.uint16[j+9]=R,r}}Uu.prototype.bytesPerElement=20,wt("StructArrayLayout10ui20",Uu);class la extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,c,f,v,b,w,S,C,A,R,j){const $=this.length;return this.resize($+1),this.emplace($,r,s,c,f,v,b,w,S,C,A,R,j)}emplace(r,s,c,f,v,b,w,S,C,A,R,j,$){const G=12*r;return this.int16[G+0]=s,this.int16[G+1]=c,this.int16[G+2]=f,this.int16[G+3]=v,this.uint16[G+4]=b,this.uint16[G+5]=w,this.uint16[G+6]=S,this.uint16[G+7]=C,this.int16[G+8]=A,this.int16[G+9]=R,this.int16[G+10]=j,this.int16[G+11]=$,r}}la.prototype.bytesPerElement=24,wt("StructArrayLayout4i4ui4i24",la);class ms extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,c){const f=this.length;return this.resize(f+1),this.emplace(f,r,s,c)}emplace(r,s,c,f){const v=3*r;return this.float32[v+0]=s,this.float32[v+1]=c,this.float32[v+2]=f,r}}ms.prototype.bytesPerElement=12,wt("StructArrayLayout3f12",ms);class Gu extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r){const s=this.length;return this.resize(s+1),this.emplace(s,r)}emplace(r,s){return this.uint32[1*r+0]=s,r}}Gu.prototype.bytesPerElement=4,wt("StructArrayLayout1ul4",Gu);class pc extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,c,f,v,b,w,S,C){const A=this.length;return this.resize(A+1),this.emplace(A,r,s,c,f,v,b,w,S,C)}emplace(r,s,c,f,v,b,w,S,C,A){const R=10*r,j=5*r;return this.int16[R+0]=s,this.int16[R+1]=c,this.int16[R+2]=f,this.int16[R+3]=v,this.int16[R+4]=b,this.int16[R+5]=w,this.uint32[j+3]=S,this.uint16[R+8]=C,this.uint16[R+9]=A,r}}pc.prototype.bytesPerElement=20,wt("StructArrayLayout6i1ul2ui20",pc);class gs extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,c,f,v,b){const w=this.length;return this.resize(w+1),this.emplace(w,r,s,c,f,v,b)}emplace(r,s,c,f,v,b,w){const S=6*r;return this.int16[S+0]=s,this.int16[S+1]=c,this.int16[S+2]=f,this.int16[S+3]=v,this.int16[S+4]=b,this.int16[S+5]=w,r}}gs.prototype.bytesPerElement=12,wt("StructArrayLayout2i2i2i12",gs);class Zu extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,c,f,v){const b=this.length;return this.resize(b+1),this.emplace(b,r,s,c,f,v)}emplace(r,s,c,f,v,b){const w=4*r,S=8*r;return this.float32[w+0]=s,this.float32[w+1]=c,this.float32[w+2]=f,this.int16[S+6]=v,this.int16[S+7]=b,r}}Zu.prototype.bytesPerElement=16,wt("StructArrayLayout2f1f2i16",Zu);class qu extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,c,f,v,b){const w=this.length;return this.resize(w+1),this.emplace(w,r,s,c,f,v,b)}emplace(r,s,c,f,v,b,w){const S=16*r,C=4*r,A=8*r;return this.uint8[S+0]=s,this.uint8[S+1]=c,this.float32[C+1]=f,this.float32[C+2]=v,this.int16[A+6]=b,this.int16[A+7]=w,r}}qu.prototype.bytesPerElement=16,wt("StructArrayLayout2ub2f2i16",qu);class il extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,c){const f=this.length;return this.resize(f+1),this.emplace(f,r,s,c)}emplace(r,s,c,f){const v=3*r;return this.uint16[v+0]=s,this.uint16[v+1]=c,this.uint16[v+2]=f,r}}il.prototype.bytesPerElement=6,wt("StructArrayLayout3ui6",il);class Hu extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,c,f,v,b,w,S,C,A,R,j,$,G,W,te,se){const ye=this.length;return this.resize(ye+1),this.emplace(ye,r,s,c,f,v,b,w,S,C,A,R,j,$,G,W,te,se)}emplace(r,s,c,f,v,b,w,S,C,A,R,j,$,G,W,te,se,ye){const ue=24*r,V=12*r,ee=48*r;return this.int16[ue+0]=s,this.int16[ue+1]=c,this.uint16[ue+2]=f,this.uint16[ue+3]=v,this.uint32[V+2]=b,this.uint32[V+3]=w,this.uint32[V+4]=S,this.uint16[ue+10]=C,this.uint16[ue+11]=A,this.uint16[ue+12]=R,this.float32[V+7]=j,this.float32[V+8]=$,this.uint8[ee+36]=G,this.uint8[ee+37]=W,this.uint8[ee+38]=te,this.uint32[V+10]=se,this.int16[ue+22]=ye,r}}Hu.prototype.bytesPerElement=48,wt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Hu);class g extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,c,f,v,b,w,S,C,A,R,j,$,G,W,te,se,ye,ue,V,ee,de,Fe,et,je,$e,ot,tt){const ct=this.length;return this.resize(ct+1),this.emplace(ct,r,s,c,f,v,b,w,S,C,A,R,j,$,G,W,te,se,ye,ue,V,ee,de,Fe,et,je,$e,ot,tt)}emplace(r,s,c,f,v,b,w,S,C,A,R,j,$,G,W,te,se,ye,ue,V,ee,de,Fe,et,je,$e,ot,tt,ct){const qe=32*r,Tt=16*r;return this.int16[qe+0]=s,this.int16[qe+1]=c,this.int16[qe+2]=f,this.int16[qe+3]=v,this.int16[qe+4]=b,this.int16[qe+5]=w,this.int16[qe+6]=S,this.int16[qe+7]=C,this.uint16[qe+8]=A,this.uint16[qe+9]=R,this.uint16[qe+10]=j,this.uint16[qe+11]=$,this.uint16[qe+12]=G,this.uint16[qe+13]=W,this.uint16[qe+14]=te,this.uint16[qe+15]=se,this.uint16[qe+16]=ye,this.uint16[qe+17]=ue,this.uint16[qe+18]=V,this.uint16[qe+19]=ee,this.uint16[qe+20]=de,this.uint16[qe+21]=Fe,this.uint16[qe+22]=et,this.uint32[Tt+12]=je,this.float32[Tt+13]=$e,this.float32[Tt+14]=ot,this.uint16[qe+30]=tt,this.uint16[qe+31]=ct,r}}g.prototype.bytesPerElement=64,wt("StructArrayLayout8i15ui1ul2f2ui64",g);class e extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r){const s=this.length;return this.resize(s+1),this.emplace(s,r)}emplace(r,s){return this.float32[1*r+0]=s,r}}e.prototype.bytesPerElement=4,wt("StructArrayLayout1f4",e);class i extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,c){const f=this.length;return this.resize(f+1),this.emplace(f,r,s,c)}emplace(r,s,c,f){const v=3*r;return this.uint16[6*r+0]=s,this.float32[v+1]=c,this.float32[v+2]=f,r}}i.prototype.bytesPerElement=12,wt("StructArrayLayout1ui2f12",i);class u extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,c){const f=this.length;return this.resize(f+1),this.emplace(f,r,s,c)}emplace(r,s,c,f){const v=4*r;return this.uint32[2*r+0]=s,this.uint16[v+2]=c,this.uint16[v+3]=f,r}}u.prototype.bytesPerElement=8,wt("StructArrayLayout1ul2ui8",u);class d extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s){const c=this.length;return this.resize(c+1),this.emplace(c,r,s)}emplace(r,s,c){const f=2*r;return this.uint16[f+0]=s,this.uint16[f+1]=c,r}}d.prototype.bytesPerElement=4,wt("StructArrayLayout2ui4",d);class _ extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r){const s=this.length;return this.resize(s+1),this.emplace(s,r)}emplace(r,s){return this.uint16[1*r+0]=s,r}}_.prototype.bytesPerElement=2,wt("StructArrayLayout1ui2",_);class x extends Yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,c,f){const v=this.length;return this.resize(v+1),this.emplace(v,r,s,c,f)}emplace(r,s,c,f,v){const b=4*r;return this.float32[b+0]=s,this.float32[b+1]=c,this.float32[b+2]=f,this.float32[b+3]=v,r}}x.prototype.bytesPerElement=16,wt("StructArrayLayout4f16",x);class T extends el{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new H(this.anchorPointX,this.anchorPointY)}}T.prototype.size=20;class E extends pc{get(r){return new T(this,r)}}wt("CollisionBoxArray",E);class M extends el{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(r){this._structArray.uint8[this._pos1+37]=r}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(r){this._structArray.uint8[this._pos1+38]=r}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(r){this._structArray.uint32[this._pos4+10]=r}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}M.prototype.size=48;class D extends Hu{get(r){return new M(this,r)}}wt("PlacedSymbolArray",D);class B extends el{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(r){this._structArray.uint32[this._pos4+12]=r}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}B.prototype.size=64;class O extends g{get(r){return new B(this,r)}}wt("SymbolInstanceArray",O);class Z extends e{getoffsetX(r){return this.float32[1*r+0]}}wt("GlyphOffsetArray",Z);class K extends Jn{getx(r){return this.int16[3*r+0]}gety(r){return this.int16[3*r+1]}gettileUnitDistanceFromAnchor(r){return this.int16[3*r+2]}}wt("SymbolLineVertexArray",K);class ne extends el{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}ne.prototype.size=12;class ie extends i{get(r){return new ne(this,r)}}wt("TextAnchorOffsetArray",ie);class oe extends el{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}oe.prototype.size=8;class ce extends u{get(r){return new oe(this,r)}}wt("FeatureIndexArray",ce);class fe extends tl{}class me extends tl{}class ge extends tl{}class Te extends rl{}class _e extends fc{}class Oe extends ps{}class De extends Uu{}class Ze extends la{}class Ke extends ms{}class Ue extends Gu{}class ft extends gs{}class dt extends qu{}class Je extends il{}class Et extends d{}const Ht=oi([{name:"a_pos",components:2,type:"Int16"}],4),{members:mr}=Ht;class Kt{constructor(r=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=r}prepareSegment(r,s,c,f){const v=this.segments[this.segments.length-1];return r>Kt.MAX_VERTEX_ARRAY_LENGTH&&Pr(`Max vertices per segment is ${Kt.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${r}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${Kt.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!v||v.vertexLength+r>Kt.MAX_VERTEX_ARRAY_LENGTH||v.sortKey!==f?this.createNewSegment(s,c,f):v}createNewSegment(r,s,c){const f={vertexOffset:r.length,primitiveOffset:s.length,vertexLength:0,primitiveLength:0,vaos:{}};return c!==void 0&&(f.sortKey=c),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(f),f}getOrCreateLatestSegment(r,s,c){return this.prepareSegment(0,r,s,c)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const r of this.segments)for(const s in r.vaos)r.vaos[s].destroy()}static simpleSegment(r,s,c,f){return new Kt([{vertexOffset:r,primitiveOffset:s,vertexLength:c,primitiveLength:f,vaos:{},sortKey:0}])}}function br(o,r){return 256*(o=Tr(Math.floor(o),0,255))+Tr(Math.floor(r),0,255)}Kt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,wt("SegmentVector",Kt);const Ar=oi([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Or,yr,xr,si={exports:{}},_i={exports:{}},Ei={exports:{}},un=function(){if(xr)return si.exports;xr=1;var o=(Or||(Or=1,_i.exports=function(s,c){var f,v,b,w,S,C,A,R;for(v=s.length-(f=3&s.length),b=c,S=3432918353,C=461845907,R=0;R<v;)A=255&s.charCodeAt(R)|(255&s.charCodeAt(++R))<<8|(255&s.charCodeAt(++R))<<16|(255&s.charCodeAt(++R))<<24,++R,b=27492+(65535&(w=5*(65535&(b=(b^=A=(65535&(A=(A=(65535&A)*S+(((A>>>16)*S&65535)<<16)&4294967295)<<15|A>>>17))*C+(((A>>>16)*C&65535)<<16)&4294967295)<<13|b>>>19))+((5*(b>>>16)&65535)<<16)&4294967295))+((58964+(w>>>16)&65535)<<16);switch(A=0,f){case 3:A^=(255&s.charCodeAt(R+2))<<16;case 2:A^=(255&s.charCodeAt(R+1))<<8;case 1:b^=A=(65535&(A=(A=(65535&(A^=255&s.charCodeAt(R)))*S+(((A>>>16)*S&65535)<<16)&4294967295)<<15|A>>>17))*C+(((A>>>16)*C&65535)<<16)&4294967295}return b^=s.length,b=2246822507*(65535&(b^=b>>>16))+((2246822507*(b>>>16)&65535)<<16)&4294967295,b=3266489909*(65535&(b^=b>>>13))+((3266489909*(b>>>16)&65535)<<16)&4294967295,(b^=b>>>16)>>>0}),_i.exports),r=(yr||(yr=1,Ei.exports=function(s,c){for(var f,v=s.length,b=c^v,w=0;v>=4;)f=1540483477*(65535&(f=255&s.charCodeAt(w)|(255&s.charCodeAt(++w))<<8|(255&s.charCodeAt(++w))<<16|(255&s.charCodeAt(++w))<<24))+((1540483477*(f>>>16)&65535)<<16),b=1540483477*(65535&b)+((1540483477*(b>>>16)&65535)<<16)^(f=1540483477*(65535&(f^=f>>>24))+((1540483477*(f>>>16)&65535)<<16)),v-=4,++w;switch(v){case 3:b^=(255&s.charCodeAt(w+2))<<16;case 2:b^=(255&s.charCodeAt(w+1))<<8;case 1:b=1540483477*(65535&(b^=255&s.charCodeAt(w)))+((1540483477*(b>>>16)&65535)<<16)}return b=1540483477*(65535&(b^=b>>>13))+((1540483477*(b>>>16)&65535)<<16),(b^=b>>>15)>>>0}),Ei.exports);return si.exports=o,si.exports.murmur3=o,si.exports.murmur2=r,si.exports}(),go=I(un);class Qn{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(r,s,c,f){this.ids.push(Oo(r)),this.positions.push(s,c,f)}getPositions(r){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const s=Oo(r);let c=0,f=this.ids.length-1;for(;c<f;){const b=c+f>>1;this.ids[b]>=s?f=b:c=b+1}const v=[];for(;this.ids[c]===s;)v.push({index:this.positions[3*c],start:this.positions[3*c+1],end:this.positions[3*c+2]}),c++;return v}static serialize(r,s){const c=new Float64Array(r.ids),f=new Uint32Array(r.positions);return Fo(c,f,0,c.length-1),s&&s.push(c.buffer,f.buffer),{ids:c,positions:f}}static deserialize(r){const s=new Qn;return s.ids=r.ids,s.positions=r.positions,s.indexed=!0,s}}function Oo(o){const r=+o;return!isNaN(r)&&r<=Number.MAX_SAFE_INTEGER?r:go(String(o))}function Fo(o,r,s,c){for(;s<c;){const f=o[s+c>>1];let v=s-1,b=c+1;for(;;){do v++;while(o[v]<f);do b--;while(o[b]>f);if(v>=b)break;_s(o,v,b),_s(r,3*v,3*b),_s(r,3*v+1,3*b+1),_s(r,3*v+2,3*b+2)}b-s<c-b?(Fo(o,r,s,b),s=b+1):(Fo(o,r,b+1,c),c=b)}}function _s(o,r,s){const c=o[r];o[r]=o[s],o[s]=c}wt("FeaturePositionMap",Qn);class eo{constructor(r,s){this.gl=r.gl,this.location=s}}class _o extends eo{constructor(r,s){super(r,s),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))}}class gn extends eo{constructor(r,s){super(r,s),this.current=[0,0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3]))}}class yo extends eo{constructor(r,s){super(r,s),this.current=lr.transparent}set(r){r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a))}}const ys=new Float32Array(16);function vs(o){return[br(255*o.r,255*o.g),br(255*o.b,255*o.a)]}class Jr{constructor(r,s,c){this.value=r,this.uniformNames=s.map(f=>`u_${f}`),this.type=c}setUniform(r,s,c){r.set(c.constantOr(this.value))}getBinding(r,s,c){return this.type==="color"?new yo(r,s):new _o(r,s)}}class Qr{constructor(r,s){this.uniformNames=s.map(c=>`u_${c}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(r,s){this.pixelRatioFrom=s.pixelRatio,this.pixelRatioTo=r.pixelRatio,this.patternFrom=s.tlbr,this.patternTo=r.tlbr}setUniform(r,s,c,f){const v=f==="u_pattern_to"?this.patternTo:f==="u_pattern_from"?this.patternFrom:f==="u_pixel_ratio_to"?this.pixelRatioTo:f==="u_pixel_ratio_from"?this.pixelRatioFrom:null;v&&r.set(v)}getBinding(r,s,c){return c.substr(0,9)==="u_pattern"?new gn(r,s):new _o(r,s)}}class di{constructor(r,s,c,f){this.expression=r,this.type=c,this.maxValue=0,this.paintVertexAttributes=s.map(v=>({name:`a_${v}`,type:"Float32",components:c==="color"?2:1,offset:0})),this.paintVertexArray=new f}populatePaintArray(r,s,c,f,v){const b=this.paintVertexArray.length,w=this.expression.evaluate(new Dr(0),s,{},f,[],v);this.paintVertexArray.resize(r),this._setPaintValue(b,r,w)}updatePaintArray(r,s,c,f){const v=this.expression.evaluate({zoom:0},c,f);this._setPaintValue(r,s,v)}_setPaintValue(r,s,c){if(this.type==="color"){const f=vs(c);for(let v=r;v<s;v++)this.paintVertexArray.emplace(v,f[0],f[1])}else{for(let f=r;f<s;f++)this.paintVertexArray.emplace(f,c);this.maxValue=Math.max(this.maxValue,Math.abs(c))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Er{constructor(r,s,c,f,v,b){this.expression=r,this.uniformNames=s.map(w=>`u_${w}_t`),this.type=c,this.useIntegerZoom=f,this.zoom=v,this.maxValue=0,this.paintVertexAttributes=s.map(w=>({name:`a_${w}`,type:"Float32",components:c==="color"?4:2,offset:0})),this.paintVertexArray=new b}populatePaintArray(r,s,c,f,v){const b=this.expression.evaluate(new Dr(this.zoom),s,{},f,[],v),w=this.expression.evaluate(new Dr(this.zoom+1),s,{},f,[],v),S=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValue(S,r,b,w)}updatePaintArray(r,s,c,f){const v=this.expression.evaluate({zoom:this.zoom},c,f),b=this.expression.evaluate({zoom:this.zoom+1},c,f);this._setPaintValue(r,s,v,b)}_setPaintValue(r,s,c,f){if(this.type==="color"){const v=vs(c),b=vs(f);for(let w=r;w<s;w++)this.paintVertexArray.emplace(w,v[0],v[1],b[0],b[1])}else{for(let v=r;v<s;v++)this.paintVertexArray.emplace(v,c,f);this.maxValue=Math.max(this.maxValue,Math.abs(c),Math.abs(f))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(r,s){const c=this.useIntegerZoom?Math.floor(s.zoom):s.zoom,f=Tr(this.expression.interpolationFactor(c,this.zoom,this.zoom+1),0,1);r.set(f)}getBinding(r,s,c){return new _o(r,s)}}class Bo{constructor(r,s,c,f,v,b){this.expression=r,this.type=s,this.useIntegerZoom=c,this.zoom=f,this.layerId=b,this.zoomInPaintVertexArray=new v,this.zoomOutPaintVertexArray=new v}populatePaintArray(r,s,c){const f=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(r),this.zoomOutPaintVertexArray.resize(r),this._setPaintValues(f,r,s.patterns&&s.patterns[this.layerId],c)}updatePaintArray(r,s,c,f,v){this._setPaintValues(r,s,c.patterns&&c.patterns[this.layerId],v)}_setPaintValues(r,s,c,f){if(!f||!c)return;const{min:v,mid:b,max:w}=c,S=f[v],C=f[b],A=f[w];if(S&&C&&A)for(let R=r;R<s;R++)this.zoomInPaintVertexArray.emplace(R,C.tl[0],C.tl[1],C.br[0],C.br[1],S.tl[0],S.tl[1],S.br[0],S.br[1],C.pixelRatio,S.pixelRatio),this.zoomOutPaintVertexArray.emplace(R,C.tl[0],C.tl[1],C.br[0],C.br[1],A.tl[0],A.tl[1],A.br[0],A.br[1],C.pixelRatio,A.pixelRatio)}upload(r){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=r.createVertexBuffer(this.zoomInPaintVertexArray,Ar.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=r.createVertexBuffer(this.zoomOutPaintVertexArray,Ar.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class sf{constructor(r,s,c){this.binders={},this._buffers=[];const f=[];for(const v in r.paint._values){if(!c(v))continue;const b=r.paint.get(v);if(!(b instanceof Yn&&Js(b.property.specification)))continue;const w=sm(v,r.type),S=b.value,C=b.property.specification.type,A=b.property.useIntegerZoom,R=b.property.specification["property-type"],j=R==="cross-faded"||R==="cross-faded-data-driven";if(S.kind==="constant")this.binders[v]=j?new Qr(S.value,w):new Jr(S.value,w,C),f.push(`/u_${v}`);else if(S.kind==="source"||j){const $=af(v,C,"source");this.binders[v]=j?new Bo(S,C,A,s,$,r.id):new di(S,w,C,$),f.push(`/a_${v}`)}else{const $=af(v,C,"composite");this.binders[v]=new Er(S,w,C,A,s,$),f.push(`/z_${v}`)}}this.cacheKey=f.sort().join("")}getMaxValue(r){const s=this.binders[r];return s instanceof di||s instanceof Er?s.maxValue:0}populatePaintArrays(r,s,c,f,v){for(const b in this.binders){const w=this.binders[b];(w instanceof di||w instanceof Er||w instanceof Bo)&&w.populatePaintArray(r,s,c,f,v)}}setConstantPatternPositions(r,s){for(const c in this.binders){const f=this.binders[c];f instanceof Qr&&f.setConstantPatternPositions(r,s)}}updatePaintArrays(r,s,c,f,v){let b=!1;for(const w in r){const S=s.getPositions(w);for(const C of S){const A=c.feature(C.index);for(const R in this.binders){const j=this.binders[R];if((j instanceof di||j instanceof Er||j instanceof Bo)&&j.expression.isStateDependent===!0){const $=f.paint.get(R);j.expression=$.value,j.updatePaintArray(C.start,C.end,A,r[w],v),b=!0}}}}return b}defines(){const r=[];for(const s in this.binders){const c=this.binders[s];(c instanceof Jr||c instanceof Qr)&&r.push(...c.uniformNames.map(f=>`#define HAS_UNIFORM_${f}`))}return r}getBinderAttributes(){const r=[];for(const s in this.binders){const c=this.binders[s];if(c instanceof di||c instanceof Er)for(let f=0;f<c.paintVertexAttributes.length;f++)r.push(c.paintVertexAttributes[f].name);else if(c instanceof Bo)for(let f=0;f<Ar.members.length;f++)r.push(Ar.members[f].name)}return r}getBinderUniforms(){const r=[];for(const s in this.binders){const c=this.binders[s];if(c instanceof Jr||c instanceof Qr||c instanceof Er)for(const f of c.uniformNames)r.push(f)}return r}getPaintVertexBuffers(){return this._buffers}getUniforms(r,s){const c=[];for(const f in this.binders){const v=this.binders[f];if(v instanceof Jr||v instanceof Qr||v instanceof Er){for(const b of v.uniformNames)if(s[b]){const w=v.getBinding(r,s[b],b);c.push({name:b,property:f,binding:w})}}}return c}setUniforms(r,s,c,f){for(const{name:v,property:b,binding:w}of s)this.binders[b].setUniform(w,f,c.get(b),v)}updatePaintBuffers(r){this._buffers=[];for(const s in this.binders){const c=this.binders[s];if(r&&c instanceof Bo){const f=r.fromScale===2?c.zoomInPaintVertexBuffer:c.zoomOutPaintVertexBuffer;f&&this._buffers.push(f)}else(c instanceof di||c instanceof Er)&&c.paintVertexBuffer&&this._buffers.push(c.paintVertexBuffer)}}upload(r){for(const s in this.binders){const c=this.binders[s];(c instanceof di||c instanceof Er||c instanceof Bo)&&c.upload(r)}this.updatePaintBuffers()}destroy(){for(const r in this.binders){const s=this.binders[r];(s instanceof di||s instanceof Er||s instanceof Bo)&&s.destroy()}}}class bs{constructor(r,s,c=()=>!0){this.programConfigurations={};for(const f of r)this.programConfigurations[f.id]=new sf(f,s,c);this.needsUpload=!1,this._featureMap=new Qn,this._bufferOffset=0}populatePaintArrays(r,s,c,f,v,b){for(const w in this.programConfigurations)this.programConfigurations[w].populatePaintArrays(r,s,f,v,b);s.id!==void 0&&this._featureMap.add(s.id,c,this._bufferOffset,r),this._bufferOffset=r,this.needsUpload=!0}updatePaintArrays(r,s,c,f){for(const v of c)this.needsUpload=this.programConfigurations[v.id].updatePaintArrays(r,this._featureMap,s,v,f)||this.needsUpload}get(r){return this.programConfigurations[r]}upload(r){if(this.needsUpload){for(const s in this.programConfigurations)this.programConfigurations[s].upload(r);this.needsUpload=!1}}destroy(){for(const r in this.programConfigurations)this.programConfigurations[r].destroy()}}function sm(o,r){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[o]||[o.replace(`${r}-`,"").replace(/-/g,"_")]}function af(o,r,s){const c={color:{source:ps,composite:x},number:{source:e,composite:ps}},f=function(v){return{"line-pattern":{source:De,composite:De},"fill-pattern":{source:De,composite:De},"fill-extrusion-pattern":{source:De,composite:De}}[v]}(o);return f&&f[s]||c[r][s]}wt("ConstantBinder",Jr),wt("CrossFadedConstantBinder",Qr),wt("SourceExpressionBinder",di),wt("CrossFadedCompositeBinder",Bo),wt("CompositeExpressionBinder",Er),wt("ProgramConfiguration",sf,{omit:["_buffers"]}),wt("ProgramConfigurationSet",bs);const Wu=Math.pow(2,14)-1,jo=-Wu-1;function No(o){const r=Xe/o.extent,s=o.loadGeometry();for(let c=0;c<s.length;c++){const f=s[c];for(let v=0;v<f.length;v++){const b=f[v],w=Math.round(b.x*r),S=Math.round(b.y*r);b.x=Tr(w,jo,Wu),b.y=Tr(S,jo,Wu),(w<b.x||w>b.x+1||S<b.y||S>b.y+1)&&Pr("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return s}function Vo(o,r){return{type:o.type,id:o.id,properties:o.properties,geometry:r?No(o):[]}}const Ku=-32768;function Xu(o,r,s,c,f){o.emplaceBack(Ku+8*r+c,Ku+8*s+f)}class mc{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(s=>s.id),this.index=r.index,this.hasPattern=!1,this.layoutVertexArray=new me,this.indexArray=new Je,this.segments=new Kt,this.programConfigurations=new bs(r.layers,r.zoom),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(r,s,c){const f=this.layers[0],v=[];let b=null,w=!1,S=f.type==="heatmap";if(f.type==="circle"){const A=f;b=A.layout.get("circle-sort-key"),w=!b.isConstant(),S=S||A.paint.get("circle-pitch-alignment")==="map"}const C=S?s.subdivisionGranularity.circle:1;for(const{feature:A,id:R,index:j,sourceLayerIndex:$}of r){const G=this.layers[0]._featureFilter.needGeometry,W=Vo(A,G);if(!this.layers[0]._featureFilter.filter(new Dr(this.zoom),W,c))continue;const te=w?b.evaluate(W,{},c):void 0,se={id:R,properties:A.properties,type:A.type,sourceLayerIndex:$,index:j,geometry:G?W.geometry:No(A),patterns:{},sortKey:te};v.push(se)}w&&v.sort((A,R)=>A.sortKey-R.sortKey);for(const A of v){const{geometry:R,index:j,sourceLayerIndex:$}=A,G=r[j].feature;this.addFeature(A,R,j,c,C),s.featureIndex.insert(G,R,j,$,this.index)}}update(r,s,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,s,this.stateDependentLayers,c)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,mr),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(r,s,c,f,v=1){let b;switch(v){case 1:b=[0,7];break;case 3:b=[0,2,5,7];break;case 5:b=[0,1,3,4,6,7];break;case 7:b=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${v}; valid values are 1, 3, 5, 7.`)}const w=b.length;for(const S of s)for(const C of S){const A=C.x,R=C.y;if(A<0||A>=Xe||R<0||R>=Xe)continue;const j=this.segments.prepareSegment(w*w,this.layoutVertexArray,this.indexArray,r.sortKey),$=j.vertexLength;for(let G=0;G<w;G++)for(let W=0;W<w;W++)Xu(this.layoutVertexArray,A,R,b[W],b[G]);for(let G=0;G<w-1;G++)for(let W=0;W<w-1;W++){const te=$+G*w+W,se=$+(G+1)*w+W;this.indexArray.emplaceBack(te,se+1,te+1),this.indexArray.emplaceBack(te,se,se+1)}j.vertexLength+=w*w,j.primitiveLength+=(w-1)*(w-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,c,{},f)}}function gc(o,r){for(let s=0;s<o.length;s++)if(nl(r,o[s]))return!0;for(let s=0;s<r.length;s++)if(nl(o,r[s]))return!0;return!!am(o,r)}function v2(o,r,s){return!!nl(o,r)||!!lm(r,o,s)}function cy(o,r){if(o.length===1)return hy(r,o[0]);for(let s=0;s<r.length;s++){const c=r[s];for(let f=0;f<c.length;f++)if(nl(o,c[f]))return!0}for(let s=0;s<o.length;s++)if(hy(r,o[s]))return!0;for(let s=0;s<r.length;s++)if(am(o,r[s]))return!0;return!1}function b2(o,r,s){if(o.length>1){if(am(o,r))return!0;for(let c=0;c<r.length;c++)if(lm(r[c],o,s))return!0}for(let c=0;c<o.length;c++)if(lm(o[c],r,s))return!0;return!1}function am(o,r){if(o.length===0||r.length===0)return!1;for(let s=0;s<o.length-1;s++){const c=o[s],f=o[s+1];for(let v=0;v<r.length-1;v++)if(x2(c,f,r[v],r[v+1]))return!0}return!1}function x2(o,r,s,c){return Sr(o,s,c)!==Sr(r,s,c)&&Sr(o,r,s)!==Sr(o,r,c)}function lm(o,r,s){const c=s*s;if(r.length===1)return o.distSqr(r[0])<c;for(let f=1;f<r.length;f++)if(uy(o,r[f-1],r[f])<c)return!0;return!1}function uy(o,r,s){const c=r.distSqr(s);if(c===0)return o.distSqr(r);const f=((o.x-r.x)*(s.x-r.x)+(o.y-r.y)*(s.y-r.y))/c;return o.distSqr(f<0?r:f>1?s:s.sub(r)._mult(f)._add(r))}function hy(o,r){for(let s=0;s<o.length;s++)if(nl(o[s],r))return!0;return!1}function nl(o,r){let s=!1;for(let c=0,f=o.length-1;c<o.length;f=c++){const v=o[c],b=o[f];v.y>r.y!=b.y>r.y&&r.x<(b.x-v.x)*(r.y-v.y)/(b.y-v.y)+v.x&&(s=!s)}return s}function w2(o,r,s){const c=s[0],f=s[2];if(o.x<c.x&&r.x<c.x||o.x>f.x&&r.x>f.x||o.y<c.y&&r.y<c.y||o.y>f.y&&r.y>f.y)return!1;const v=Sr(o,r,s[0]);return v!==Sr(o,r,s[1])||v!==Sr(o,r,s[2])||v!==Sr(o,r,s[3])}function Yu(o,r,s){const c=r.paint.get(o).value;return c.kind==="constant"?c.value:s.programConfigurations.get(r.id).getMaxValue(o)}function lf(o){return Math.sqrt(o[0]*o[0]+o[1]*o[1])}function cf(o,r,s,c,f){if(!r[0]&&!r[1])return o;const v=H.convert(r)._mult(f);s==="viewport"&&v._rotate(-c);const b=[];for(let w=0;w<o.length;w++)b.push(o[w].sub(v));return b}let dy,fy;wt("CircleBucket",mc,{omit:["layers"]});var T2={get paint(){return fy=fy||new cn({"circle-radius":new Dt(U.paint_circle["circle-radius"]),"circle-color":new Dt(U.paint_circle["circle-color"]),"circle-blur":new Dt(U.paint_circle["circle-blur"]),"circle-opacity":new Dt(U.paint_circle["circle-opacity"]),"circle-translate":new Mt(U.paint_circle["circle-translate"]),"circle-translate-anchor":new Mt(U.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Mt(U.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Mt(U.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Dt(U.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Dt(U.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Dt(U.paint_circle["circle-stroke-opacity"])})},get layout(){return dy=dy||new cn({"circle-sort-key":new Dt(U.layout_circle["circle-sort-key"])})}};class S2 extends Ji{constructor(r){super(r,T2)}createBucket(r){return new mc(r)}queryRadius(r){const s=r;return Yu("circle-radius",this,s)+Yu("circle-stroke-width",this,s)+lf(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:r,feature:s,featureState:c,geometry:f,transform:v,pixelsToTileUnits:b,unwrappedTileID:w,getElevation:S}){const C=cf(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-v.bearingInRadians,b),A=this.paint.get("circle-radius").evaluate(s,c)+this.paint.get("circle-stroke-width").evaluate(s,c),R=this.paint.get("circle-pitch-alignment")==="map",j=R?C:function(G,W,te,se){return G.map(ye=>py(ye,W,te,se))}(C,v,w,S),$=R?A*b:A;for(const G of f)for(const W of G){const te=R?W:py(W,v,w,S);let se=$;const ye=v.projectTileCoordinates(W.x,W.y,w,S).signedDistanceFromCamera;if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?se*=ye/v.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(se*=v.cameraToCenterDistance/ye),v2(j,te,se))return!0}return!1}}function py(o,r,s,c){const f=r.projectTileCoordinates(o.x,o.y,s,c).point;return new H((.5*f.x+.5)*r.width,(.5*-f.y+.5)*r.height)}class my extends mc{}let gy;wt("HeatmapBucket",my,{omit:["layers"]});var E2={get paint(){return gy=gy||new cn({"heatmap-radius":new Dt(U.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Dt(U.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Mt(U.paint_heatmap["heatmap-intensity"]),"heatmap-color":new $u(U.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Mt(U.paint_heatmap["heatmap-opacity"])})}};function cm(o,{width:r,height:s},c,f){if(f){if(f instanceof Uint8ClampedArray)f=new Uint8Array(f.buffer);else if(f.length!==r*s*c)throw new RangeError(`mismatched image size. expected: ${f.length} but got: ${r*s*c}`)}else f=new Uint8Array(r*s*c);return o.width=r,o.height=s,o.data=f,o}function _y(o,{width:r,height:s},c){if(r===o.width&&s===o.height)return;const f=cm({},{width:r,height:s},c);um(o,f,{x:0,y:0},{x:0,y:0},{width:Math.min(o.width,r),height:Math.min(o.height,s)},c),o.width=r,o.height=s,o.data=f.data}function um(o,r,s,c,f,v){if(f.width===0||f.height===0)return r;if(f.width>o.width||f.height>o.height||s.x>o.width-f.width||s.y>o.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>r.width||f.height>r.height||c.x>r.width-f.width||c.y>r.height-f.height)throw new RangeError("out of range destination coordinates for image copy");const b=o.data,w=r.data;if(b===w)throw new Error("srcData equals dstData, so image is already copied");for(let S=0;S<f.height;S++){const C=((s.y+S)*o.width+s.x)*v,A=((c.y+S)*r.width+c.x)*v;for(let R=0;R<f.width*v;R++)w[A+R]=b[C+R]}return r}class Ju{constructor(r,s){cm(this,r,1,s)}resize(r){_y(this,r,1)}clone(){return new Ju({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,s,c,f,v){um(r,s,c,f,v,1)}}class Rn{constructor(r,s){cm(this,r,4,s)}resize(r){_y(this,r,4)}replace(r,s){s?this.data.set(r):this.data=r instanceof Uint8ClampedArray?new Uint8Array(r.buffer):r}clone(){return new Rn({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,s,c,f,v){um(r,s,c,f,v,4)}}function yy(o){const r={},s=o.resolution||256,c=o.clips?o.clips.length:1,f=o.image||new Rn({width:s,height:c});if(Math.log(s)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${s}`);const v=(b,w,S)=>{r[o.evaluationKey]=S;const C=o.expression.evaluate(r);f.data[b+w+0]=Math.floor(255*C.r/C.a),f.data[b+w+1]=Math.floor(255*C.g/C.a),f.data[b+w+2]=Math.floor(255*C.b/C.a),f.data[b+w+3]=Math.floor(255*C.a)};if(o.clips)for(let b=0,w=0;b<c;++b,w+=4*s)for(let S=0,C=0;S<s;S++,C+=4){const A=S/(s-1),{start:R,end:j}=o.clips[b];v(w,C,R*(1-A)+j*A)}else for(let b=0,w=0;b<s;b++,w+=4)v(0,w,b/(s-1));return f}wt("AlphaImage",Ju),wt("RGBAImage",Rn);const hm="big-fb";class C2 extends Ji{createBucket(r){return new my(r)}constructor(r){super(r,E2),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(r){r==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=yy({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(hm)&&this.heatmapFbos.delete(hm)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let vy;var I2={get paint(){return vy=vy||new cn({"hillshade-illumination-direction":new Mt(U.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Mt(U.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Mt(U.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Mt(U.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Mt(U.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Mt(U.paint_hillshade["hillshade-accent-color"])})}};class M2 extends Ji{constructor(r){super(r,I2)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const P2=oi([{name:"a_pos",components:2,type:"Int16"}],4),{members:A2}=P2;function dm(o,r,s){const c=s.patternDependencies;let f=!1;for(const v of r){const b=v.paint.get(`${o}-pattern`);b.isConstant()||(f=!0);const w=b.constantOr(null);w&&(f=!0,c[w.to]=!0,c[w.from]=!0)}return f}function fm(o,r,s,c,f){const v=f.patternDependencies;for(const b of r){const w=b.paint.get(`${o}-pattern`).value;if(w.kind!=="constant"){let S=w.evaluate({zoom:c-1},s,{},f.availableImages),C=w.evaluate({zoom:c},s,{},f.availableImages),A=w.evaluate({zoom:c+1},s,{},f.availableImages);S=S&&S.name?S.name:S,C=C&&C.name?C.name:C,A=A&&A.name?A.name:A,v[S]=!0,v[C]=!0,v[A]=!0,s.patterns[b.id]={min:S,mid:C,max:A}}}return s}function by(o,r,s,c,f){let v;if(f===function(b,w,S,C){let A=0;for(let R=w,j=S-C;R<S;R+=C)A+=(b[j]-b[R])*(b[R+1]+b[j+1]),j=R;return A}(o,r,s,c)>0)for(let b=r;b<s;b+=c)v=Sy(b/c|0,o[b],o[b+1],v);else for(let b=s-c;b>=r;b-=c)v=Sy(b/c|0,o[b],o[b+1],v);return v&&_c(v,v.next)&&(rh(v),v=v.next),v}function ol(o,r){if(!o)return o;r||(r=o);let s,c=o;do if(s=!1,c.steiner||!_c(c,c.next)&&ai(c.prev,c,c.next)!==0)c=c.next;else{if(rh(c),c=r=c.prev,c===c.next)break;s=!0}while(s||c!==r);return r}function Qu(o,r,s,c,f,v,b){if(!o)return;!b&&v&&function(S,C,A,R){let j=S;do j.z===0&&(j.z=pm(j.x,j.y,C,A,R)),j.prevZ=j.prev,j.nextZ=j.next,j=j.next;while(j!==S);j.prevZ.nextZ=null,j.prevZ=null,function($){let G,W=1;do{let te,se=$;$=null;let ye=null;for(G=0;se;){G++;let ue=se,V=0;for(let de=0;de<W&&(V++,ue=ue.nextZ,ue);de++);let ee=W;for(;V>0||ee>0&&ue;)V!==0&&(ee===0||!ue||se.z<=ue.z)?(te=se,se=se.nextZ,V--):(te=ue,ue=ue.nextZ,ee--),ye?ye.nextZ=te:$=te,te.prevZ=ye,ye=te;se=ue}ye.nextZ=null,W*=2}while(G>1)}(j)}(o,c,f,v);let w=o;for(;o.prev!==o.next;){const S=o.prev,C=o.next;if(v?L2(o,c,f,v):k2(o))r.push(S.i,o.i,C.i),rh(o),o=C.next,w=C.next;else if((o=C)===w){b?b===1?Qu(o=z2(ol(o),r),r,s,c,f,v,2):b===2&&R2(o,r,s,c,f,v):Qu(ol(o),r,s,c,f,v,1);break}}}function k2(o){const r=o.prev,s=o,c=o.next;if(ai(r,s,c)>=0)return!1;const f=r.x,v=s.x,b=c.x,w=r.y,S=s.y,C=c.y,A=Math.min(f,v,b),R=Math.min(w,S,C),j=Math.max(f,v,b),$=Math.max(w,S,C);let G=c.next;for(;G!==r;){if(G.x>=A&&G.x<=j&&G.y>=R&&G.y<=$&&eh(f,w,v,S,b,C,G.x,G.y)&&ai(G.prev,G,G.next)>=0)return!1;G=G.next}return!0}function L2(o,r,s,c){const f=o.prev,v=o,b=o.next;if(ai(f,v,b)>=0)return!1;const w=f.x,S=v.x,C=b.x,A=f.y,R=v.y,j=b.y,$=Math.min(w,S,C),G=Math.min(A,R,j),W=Math.max(w,S,C),te=Math.max(A,R,j),se=pm($,G,r,s,c),ye=pm(W,te,r,s,c);let ue=o.prevZ,V=o.nextZ;for(;ue&&ue.z>=se&&V&&V.z<=ye;){if(ue.x>=$&&ue.x<=W&&ue.y>=G&&ue.y<=te&&ue!==f&&ue!==b&&eh(w,A,S,R,C,j,ue.x,ue.y)&&ai(ue.prev,ue,ue.next)>=0||(ue=ue.prevZ,V.x>=$&&V.x<=W&&V.y>=G&&V.y<=te&&V!==f&&V!==b&&eh(w,A,S,R,C,j,V.x,V.y)&&ai(V.prev,V,V.next)>=0))return!1;V=V.nextZ}for(;ue&&ue.z>=se;){if(ue.x>=$&&ue.x<=W&&ue.y>=G&&ue.y<=te&&ue!==f&&ue!==b&&eh(w,A,S,R,C,j,ue.x,ue.y)&&ai(ue.prev,ue,ue.next)>=0)return!1;ue=ue.prevZ}for(;V&&V.z<=ye;){if(V.x>=$&&V.x<=W&&V.y>=G&&V.y<=te&&V!==f&&V!==b&&eh(w,A,S,R,C,j,V.x,V.y)&&ai(V.prev,V,V.next)>=0)return!1;V=V.nextZ}return!0}function z2(o,r){let s=o;do{const c=s.prev,f=s.next.next;!_c(c,f)&&wy(c,s,s.next,f)&&th(c,f)&&th(f,c)&&(r.push(c.i,s.i,f.i),rh(s),rh(s.next),s=o=f),s=s.next}while(s!==o);return ol(s)}function R2(o,r,s,c,f,v){let b=o;do{let w=b.next.next;for(;w!==b.prev;){if(b.i!==w.i&&j2(b,w)){let S=Ty(b,w);return b=ol(b,b.next),S=ol(S,S.next),Qu(b,r,s,c,f,v,0),void Qu(S,r,s,c,f,v,0)}w=w.next}b=b.next}while(b!==o)}function D2(o,r){let s=o.x-r.x;return s===0&&(s=o.y-r.y,s===0)&&(s=(o.next.y-o.y)/(o.next.x-o.x)-(r.next.y-r.y)/(r.next.x-r.x)),s}function O2(o,r){const s=function(f,v){let b=v;const w=f.x,S=f.y;let C,A=-1/0;if(_c(f,b))return b;do{if(_c(f,b.next))return b.next;if(S<=b.y&&S>=b.next.y&&b.next.y!==b.y){const W=b.x+(S-b.y)*(b.next.x-b.x)/(b.next.y-b.y);if(W<=w&&W>A&&(A=W,C=b.x<b.next.x?b:b.next,W===w))return C}b=b.next}while(b!==v);if(!C)return null;const R=C,j=C.x,$=C.y;let G=1/0;b=C;do{if(w>=b.x&&b.x>=j&&w!==b.x&&xy(S<$?w:A,S,j,$,S<$?A:w,S,b.x,b.y)){const W=Math.abs(S-b.y)/(w-b.x);th(b,f)&&(W<G||W===G&&(b.x>C.x||b.x===C.x&&F2(C,b)))&&(C=b,G=W)}b=b.next}while(b!==R);return C}(o,r);if(!s)return r;const c=Ty(s,o);return ol(c,c.next),ol(s,s.next)}function F2(o,r){return ai(o.prev,o,r.prev)<0&&ai(r.next,o,o.next)<0}function pm(o,r,s,c,f){return(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-s)*f|0)|o<<8))|o<<4))|o<<2))|o<<1))|(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-c)*f|0)|r<<8))|r<<4))|r<<2))|r<<1))<<1}function B2(o){let r=o,s=o;do(r.x<s.x||r.x===s.x&&r.y<s.y)&&(s=r),r=r.next;while(r!==o);return s}function xy(o,r,s,c,f,v,b,w){return(f-b)*(r-w)>=(o-b)*(v-w)&&(o-b)*(c-w)>=(s-b)*(r-w)&&(s-b)*(v-w)>=(f-b)*(c-w)}function eh(o,r,s,c,f,v,b,w){return!(o===b&&r===w)&&xy(o,r,s,c,f,v,b,w)}function j2(o,r){return o.next.i!==r.i&&o.prev.i!==r.i&&!function(s,c){let f=s;do{if(f.i!==s.i&&f.next.i!==s.i&&f.i!==c.i&&f.next.i!==c.i&&wy(f,f.next,s,c))return!0;f=f.next}while(f!==s);return!1}(o,r)&&(th(o,r)&&th(r,o)&&function(s,c){let f=s,v=!1;const b=(s.x+c.x)/2,w=(s.y+c.y)/2;do f.y>w!=f.next.y>w&&f.next.y!==f.y&&b<(f.next.x-f.x)*(w-f.y)/(f.next.y-f.y)+f.x&&(v=!v),f=f.next;while(f!==s);return v}(o,r)&&(ai(o.prev,o,r.prev)||ai(o,r.prev,r))||_c(o,r)&&ai(o.prev,o,o.next)>0&&ai(r.prev,r,r.next)>0)}function ai(o,r,s){return(r.y-o.y)*(s.x-r.x)-(r.x-o.x)*(s.y-r.y)}function _c(o,r){return o.x===r.x&&o.y===r.y}function wy(o,r,s,c){const f=hf(ai(o,r,s)),v=hf(ai(o,r,c)),b=hf(ai(s,c,o)),w=hf(ai(s,c,r));return f!==v&&b!==w||!(f!==0||!uf(o,s,r))||!(v!==0||!uf(o,c,r))||!(b!==0||!uf(s,o,c))||!(w!==0||!uf(s,r,c))}function uf(o,r,s){return r.x<=Math.max(o.x,s.x)&&r.x>=Math.min(o.x,s.x)&&r.y<=Math.max(o.y,s.y)&&r.y>=Math.min(o.y,s.y)}function hf(o){return o>0?1:o<0?-1:0}function th(o,r){return ai(o.prev,o,o.next)<0?ai(o,r,o.next)>=0&&ai(o,o.prev,r)>=0:ai(o,r,o.prev)<0||ai(o,o.next,r)<0}function Ty(o,r){const s=mm(o.i,o.x,o.y),c=mm(r.i,r.x,r.y),f=o.next,v=r.prev;return o.next=r,r.prev=o,s.next=f,f.prev=s,c.next=s,s.prev=c,v.next=c,c.prev=v,c}function Sy(o,r,s,c){const f=mm(o,r,s);return c?(f.next=c.next,f.prev=c,c.next.prev=f,c.next=f):(f.prev=f,f.next=f),f}function rh(o){o.next.prev=o.prev,o.prev.next=o.next,o.prevZ&&(o.prevZ.nextZ=o.nextZ),o.nextZ&&(o.nextZ.prevZ=o.prevZ)}function mm(o,r,s){return{i:o,x:r,y:s,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class yc{constructor(r,s){if(s>r)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=r,this._minGranularity=s}getGranularityForZoomLevel(r){return Math.max(Math.floor(this._baseZoomGranularity/(1<<r)),this._minGranularity,1)}}class df{constructor(r){this.fill=r.fill,this.line=r.line,this.tile=r.tile,this.stencil=r.stencil,this.circle=r.circle}}df.noSubdivision=new df({fill:new yc(0,0),line:new yc(0,0),tile:new yc(0,0),stencil:new yc(0,0),circle:1}),wt("SubdivisionGranularityExpression",yc),wt("SubdivisionGranularitySetting",df);const vc=-32768,ih=32767;class N2{constructor(r,s){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=r,this._granularityCellSize=Xe/r,this._canonical=s}_getKey(r,s){return(r+=32768)<<16|(s+=32768)<<0}_vertexToIndex(r,s){if(r<-32768||s<-32768||r>32767||s>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const c=0|Math.round(r),f=0|Math.round(s),v=this._getKey(c,f);if(this._vertexDictionary.has(v))return this._vertexDictionary.get(v);const b=this._vertexBuffer.length/2;return this._vertexDictionary.set(v,b),this._vertexBuffer.push(c,f),b}_subdivideTrianglesScanline(r){if(this._granularity<2)return function(f,v){const b=[];for(let w=0;w<v.length;w+=3){const S=v[w],C=v[w+1],A=v[w+2],R=f[2*S],j=f[2*S+1];(f[2*C]-R)*(f[2*A+1]-j)-(f[2*C+1]-j)*(f[2*A]-R)>0?(b.push(S),b.push(A),b.push(C)):(b.push(S),b.push(C),b.push(A))}return b}(this._vertexBuffer,r);const s=[],c=r.length;for(let f=0;f<c;f+=3){const v=[r[f+0],r[f+1],r[f+2]],b=[this._vertexBuffer[2*r[f+0]+0],this._vertexBuffer[2*r[f+0]+1],this._vertexBuffer[2*r[f+1]+0],this._vertexBuffer[2*r[f+1]+1],this._vertexBuffer[2*r[f+2]+0],this._vertexBuffer[2*r[f+2]+1]];let w=1/0,S=1/0,C=-1/0,A=-1/0;for(let W=0;W<3;W++){const te=b[2*W],se=b[2*W+1];w=Math.min(w,te),C=Math.max(C,te),S=Math.min(S,se),A=Math.max(A,se)}if(w===C||S===A)continue;const R=Math.floor(w/this._granularityCellSize),j=Math.ceil(C/this._granularityCellSize),$=Math.floor(S/this._granularityCellSize),G=Math.ceil(A/this._granularityCellSize);if(R!==j||$!==G)for(let W=$;W<G;W++){const te=this._scanlineGenerateVertexRingForCellRow(W,b,v);V2(this._vertexBuffer,te,s)}else s.push(...v)}return s}_scanlineGenerateVertexRingForCellRow(r,s,c){const f=r*this._granularityCellSize,v=f+this._granularityCellSize,b=[];for(let w=0;w<3;w++){const S=s[2*w],C=s[2*w+1],A=s[2*(w+1)%6],R=s[(2*(w+1)+1)%6],j=s[2*(w+2)%6],$=s[(2*(w+2)+1)%6],G=A-S,W=R-C,te=G===0,se=W===0,ye=(f-C)/W,ue=(v-C)/W,V=Math.min(ye,ue),ee=Math.max(ye,ue);if(!se&&(V>=1||ee<=0)||se&&(C<f||C>v)){R>=f&&R<=v&&b.push(c[(w+1)%3]);continue}!se&&V>0&&b.push(this._vertexToIndex(S+G*V,C+W*V));const de=S+G*Math.max(V,0),Fe=S+G*Math.min(ee,1);te||this._generateIntraEdgeVertices(b,S,C,A,R,de,Fe),!se&&ee<1&&b.push(this._vertexToIndex(S+G*ee,C+W*ee)),(se||R>=f&&R<=v)&&b.push(c[(w+1)%3]),!se&&(R<=f||R>=v)&&this._generateInterEdgeVertices(b,S,C,A,R,j,$,Fe,f,v)}return b}_generateIntraEdgeVertices(r,s,c,f,v,b,w){const S=f-s,C=v-c,A=C===0,R=A?Math.min(s,f):Math.min(b,w),j=A?Math.max(s,f):Math.max(b,w),$=Math.floor(R/this._granularityCellSize)+1,G=Math.ceil(j/this._granularityCellSize)-1;if(A?s<f:b<w)for(let W=$;W<=G;W++){const te=W*this._granularityCellSize;r.push(this._vertexToIndex(te,c+C*(te-s)/S))}else for(let W=G;W>=$;W--){const te=W*this._granularityCellSize;r.push(this._vertexToIndex(te,c+C*(te-s)/S))}}_generateInterEdgeVertices(r,s,c,f,v,b,w,S,C,A){const R=v-c,j=b-f,$=w-v,G=(C-v)/$,W=(A-v)/$,te=Math.min(G,W),se=Math.max(G,W),ye=f+j*te;let ue=Math.floor(Math.min(ye,S)/this._granularityCellSize)+1,V=Math.ceil(Math.max(ye,S)/this._granularityCellSize)-1,ee=S<ye;const de=$===0;if(de&&(w===C||w===A))return;if(de||te>=1||se<=0){const et=c-w,je=b+(s-b)*Math.min((C-w)/et,(A-w)/et);ue=Math.floor(Math.min(je,S)/this._granularityCellSize)+1,V=Math.ceil(Math.max(je,S)/this._granularityCellSize)-1,ee=S<je}const Fe=R>0?A:C;if(ee)for(let et=ue;et<=V;et++)r.push(this._vertexToIndex(et*this._granularityCellSize,Fe));else for(let et=V;et>=ue;et--)r.push(this._vertexToIndex(et*this._granularityCellSize,Fe))}_generateOutline(r){const s=[];for(const c of r){const f=sl(c,this._granularity,!0),v=this._pointArrayToIndices(f),b=[];for(let w=1;w<v.length;w++)b.push(v[w-1]),b.push(v[w]);s.push(b)}return s}_handlePoles(r){let s=!1,c=!1;this._canonical&&(this._canonical.y===0&&(s=!0),this._canonical.y===(1<<this._canonical.z)-1&&(c=!0)),(s||c)&&this._fillPoles(r,s,c)}_ensureNoPoleVertices(){const r=this._vertexBuffer;for(let s=0;s<r.length;s+=2){const c=r[s+1];c===vc&&(r[s+1]=-32767),c===ih&&(r[s+1]=32766)}}_generatePoleQuad(r,s,c,f,v,b){f>v!=(b===vc)?(r.push(s),r.push(c),r.push(this._vertexToIndex(f,b)),r.push(c),r.push(this._vertexToIndex(v,b)),r.push(this._vertexToIndex(f,b))):(r.push(c),r.push(s),r.push(this._vertexToIndex(f,b)),r.push(this._vertexToIndex(v,b)),r.push(c),r.push(this._vertexToIndex(f,b)))}_fillPoles(r,s,c){const f=this._vertexBuffer,v=Xe,b=r.length;for(let w=2;w<b;w+=3){const S=r[w-2],C=r[w-1],A=r[w],R=f[2*S],j=f[2*S+1],$=f[2*C],G=f[2*C+1],W=f[2*A],te=f[2*A+1];s&&(j===0&&G===0&&this._generatePoleQuad(r,S,C,R,$,vc),G===0&&te===0&&this._generatePoleQuad(r,C,A,$,W,vc),te===0&&j===0&&this._generatePoleQuad(r,A,S,W,R,vc)),c&&(j===v&&G===v&&this._generatePoleQuad(r,S,C,R,$,ih),G===v&&te===v&&this._generatePoleQuad(r,C,A,$,W,ih),te===v&&j===v&&this._generatePoleQuad(r,A,S,W,R,ih))}}_initializeVertices(r){for(let s=0;s<r.length;s+=2)this._vertexToIndex(r[s],r[s+1])}subdividePolygonInternal(r,s){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:c,holeIndices:f}=function(w){const S=[],C=[];for(const A of w)if(A.length!==0){A!==w[0]&&S.push(C.length/2);for(let R=0;R<A.length;R++)C.push(A[R].x),C.push(A[R].y)}return{flattened:C,holeIndices:S}}(r);let v;this._initializeVertices(c);try{const w=function(C,A,R=2){const j=A&&A.length,$=j?A[0]*R:C.length;let G=by(C,0,$,R,!0);const W=[];if(!G||G.next===G.prev)return W;let te,se,ye;if(j&&(G=function(ue,V,ee,de){const Fe=[];for(let et=0,je=V.length;et<je;et++){const $e=by(ue,V[et]*de,et<je-1?V[et+1]*de:ue.length,de,!1);$e===$e.next&&($e.steiner=!0),Fe.push(B2($e))}Fe.sort(D2);for(let et=0;et<Fe.length;et++)ee=O2(Fe[et],ee);return ee}(C,A,G,R)),C.length>80*R){te=1/0,se=1/0;let ue=-1/0,V=-1/0;for(let ee=R;ee<$;ee+=R){const de=C[ee],Fe=C[ee+1];de<te&&(te=de),Fe<se&&(se=Fe),de>ue&&(ue=de),Fe>V&&(V=Fe)}ye=Math.max(ue-te,V-se),ye=ye!==0?32767/ye:0}return Qu(G,W,R,te,se,ye,0),W}(c,f),S=this._convertIndices(c,w);v=this._subdivideTrianglesScanline(S)}catch(w){console.error(w)}let b=[];return s&&(b=this._generateOutline(r)),this._ensureNoPoleVertices(),this._handlePoles(v),{verticesFlattened:this._vertexBuffer,indicesTriangles:v,indicesLineList:b}}_convertIndices(r,s){const c=[];for(let f=0;f<s.length;f++)c.push(this._vertexToIndex(r[2*s[f]],r[2*s[f]+1]));return c}_pointArrayToIndices(r){const s=[];for(let c=0;c<r.length;c++){const f=r[c];s.push(this._vertexToIndex(f.x,f.y))}return s}}function Ey(o,r,s,c=!0){return new N2(s,r).subdividePolygonInternal(o,c)}function sl(o,r,s=!1){if(!o||o.length<1)return[];if(o.length<2)return[];const c=o[0],f=o[o.length-1],v=s&&(c.x!==f.x||c.y!==f.y);if(r<2)return v?[...o,o[0]]:[...o];const b=Math.floor(Xe/r),w=[];w.push(new H(o[0].x,o[0].y));const S=o.length,C=v?S:S-1;for(let A=0;A<C;A++){const R=o[A],j=A<S-1?o[A+1]:o[0],$=R.x,G=R.y,W=j.x,te=j.y,se=$!==W,ye=G!==te;if(!se&&!ye)continue;const ue=W-$,V=te-G,ee=Math.abs(ue),de=Math.abs(V);let Fe=$,et=G;for(;;){const $e=ue>0?(Math.floor(Fe/b)+1)*b:(Math.ceil(Fe/b)-1)*b,ot=V>0?(Math.floor(et/b)+1)*b:(Math.ceil(et/b)-1)*b,tt=Math.abs(Fe-$e),ct=Math.abs(et-ot),qe=Math.abs(Fe-W),Tt=Math.abs(et-te),zt=se?tt/ee:Number.POSITIVE_INFINITY,At=ye?ct/de:Number.POSITIVE_INFINITY;if((qe<=tt||!se)&&(Tt<=ct||!ye))break;if(zt<At&&se||!ye){Fe=$e,et+=V*zt;const Ct=new H(Fe,Math.round(et));w[w.length-1].x===Ct.x&&w[w.length-1].y===Ct.y||w.push(Ct)}else{Fe+=ue*At,et=ot;const Ct=new H(Math.round(Fe),et);w[w.length-1].x===Ct.x&&w[w.length-1].y===Ct.y||w.push(Ct)}}const je=new H(W,te);w[w.length-1].x===je.x&&w[w.length-1].y===je.y||w.push(je)}return w}function V2(o,r,s){if(r.length===0)throw new Error("Subdivision vertex ring is empty.");let c=0,f=o[2*r[0]];for(let S=1;S<r.length;S++){const C=o[2*r[S]];C<f&&(f=C,c=S)}const v=r.length;let b=c,w=(b+1)%v;for(;;){const S=b-1>=0?b-1:v-1,C=(w+1)%v,A=o[2*r[S]],R=o[2*r[C]],j=o[2*r[b]],$=o[2*r[b]+1],G=o[2*r[w]+1];let W=!1;if(A<R)W=!0;else if(A>R)W=!1;else{const te=G-$,se=-(o[2*r[w]]-j),ye=$<G?1:-1;((A-j)*te+(o[2*r[S]+1]-$)*se)*ye>((R-j)*te+(o[2*r[C]+1]-$)*se)*ye&&(W=!0)}if(W){const te=r[S],se=r[b],ye=r[w];te!==se&&te!==ye&&se!==ye&&s.push(ye,se,te),b--,b<0&&(b=v-1)}else{const te=r[C],se=r[b],ye=r[w];te!==se&&te!==ye&&se!==ye&&s.push(ye,se,te),w++,w>=v&&(w=0)}if(S===C)break}}function Cy(o,r,s,c,f,v,b,w,S){const C=f.length/2,A=b&&w&&S;if(C<Kt.MAX_VERTEX_ARRAY_LENGTH){const R=r.prepareSegment(C,s,c),j=R.vertexLength;for(let W=0;W<v.length;W+=3)c.emplaceBack(j+v[W],j+v[W+1],j+v[W+2]);let $,G;R.vertexLength+=C,R.primitiveLength+=v.length/3,A&&(G=b.prepareSegment(C,s,w),$=G.vertexLength,G.vertexLength+=C);for(let W=0;W<f.length;W+=2)o(f[W],f[W+1]);if(A)for(let W=0;W<S.length;W++){const te=S[W];for(let se=1;se<te.length;se+=2)w.emplaceBack($+te[se-1],$+te[se]);G.primitiveLength+=te.length/2}}else(function(R,j,$,G,W,te){const se=[];for(let de=0;de<G.length/2;de++)se.push(-1);const ye={count:0};let ue=0,V=R.getOrCreateLatestSegment(j,$),ee=V.vertexLength;for(let de=2;de<W.length;de+=3){const Fe=W[de-2],et=W[de-1],je=W[de];let $e=se[Fe]<ue,ot=se[et]<ue,tt=se[je]<ue;V.vertexLength+(($e?1:0)+(ot?1:0)+(tt?1:0))>Kt.MAX_VERTEX_ARRAY_LENGTH&&(V=R.createNewSegment(j,$),ue=ye.count,$e=!0,ot=!0,tt=!0,ee=0);const ct=nh(se,G,te,ye,Fe,$e,V),qe=nh(se,G,te,ye,et,ot,V),Tt=nh(se,G,te,ye,je,tt,V);$.emplaceBack(ee+ct-ue,ee+qe-ue,ee+Tt-ue),V.primitiveLength++}})(r,s,c,f,v,o),A&&function(R,j,$,G,W,te){const se=[];for(let de=0;de<G.length/2;de++)se.push(-1);const ye={count:0};let ue=0,V=R.getOrCreateLatestSegment(j,$),ee=V.vertexLength;for(let de=0;de<W.length;de++){const Fe=W[de];for(let et=1;et<W[de].length;et+=2){const je=Fe[et-1],$e=Fe[et];let ot=se[je]<ue,tt=se[$e]<ue;V.vertexLength+((ot?1:0)+(tt?1:0))>Kt.MAX_VERTEX_ARRAY_LENGTH&&(V=R.createNewSegment(j,$),ue=ye.count,ot=!0,tt=!0,ee=0);const ct=nh(se,G,te,ye,je,ot,V),qe=nh(se,G,te,ye,$e,tt,V);$.emplaceBack(ee+ct-ue,ee+qe-ue),V.primitiveLength++}}}(b,s,w,f,S,o),r.forceNewSegmentOnNextPrepare(),b==null||b.forceNewSegmentOnNextPrepare()}function nh(o,r,s,c,f,v,b){if(v){const w=c.count;return s(r[2*f],r[2*f+1]),o[f]=c.count,c.count++,b.vertexLength++,w}return o[f]}class gm{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(s=>s.id),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ge,this.indexArray=new Je,this.indexArray2=new Et,this.programConfigurations=new bs(r.layers,r.zoom),this.segments=new Kt,this.segments2=new Kt,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(r,s,c){this.hasPattern=dm("fill",this.layers,s);const f=this.layers[0].layout.get("fill-sort-key"),v=!f.isConstant(),b=[];for(const{feature:w,id:S,index:C,sourceLayerIndex:A}of r){const R=this.layers[0]._featureFilter.needGeometry,j=Vo(w,R);if(!this.layers[0]._featureFilter.filter(new Dr(this.zoom),j,c))continue;const $=v?f.evaluate(j,{},c,s.availableImages):void 0,G={id:S,properties:w.properties,type:w.type,sourceLayerIndex:A,index:C,geometry:R?j.geometry:No(w),patterns:{},sortKey:$};b.push(G)}v&&b.sort((w,S)=>w.sortKey-S.sortKey);for(const w of b){const{geometry:S,index:C,sourceLayerIndex:A}=w;if(this.hasPattern){const R=fm("fill",this.layers,w,this.zoom,s);this.patternFeatures.push(R)}else this.addFeature(w,S,C,c,{},s.subdivisionGranularity);s.featureIndex.insert(r[C].feature,S,C,A,this.index)}}update(r,s,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,s,this.stateDependentLayers,c)}addFeatures(r,s,c){for(const f of this.patternFeatures)this.addFeature(f,f.geometry,f.index,s,c,r.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,A2),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.indexBuffer2=r.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(r,s,c,f,v,b){for(const w of $a(s,500)){const S=Ey(w,f,b.fill.getGranularityForZoomLevel(f.z)),C=this.layoutVertexArray;Cy((A,R)=>{C.emplaceBack(A,R)},this.segments,this.layoutVertexArray,this.indexArray,S.verticesFlattened,S.indicesTriangles,this.segments2,this.indexArray2,S.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,c,v,f)}}let Iy,My;wt("FillBucket",gm,{omit:["layers","patternFeatures"]});var $2={get paint(){return My=My||new cn({"fill-antialias":new Mt(U.paint_fill["fill-antialias"]),"fill-opacity":new Dt(U.paint_fill["fill-opacity"]),"fill-color":new Dt(U.paint_fill["fill-color"]),"fill-outline-color":new Dt(U.paint_fill["fill-outline-color"]),"fill-translate":new Mt(U.paint_fill["fill-translate"]),"fill-translate-anchor":new Mt(U.paint_fill["fill-translate-anchor"]),"fill-pattern":new hc(U.paint_fill["fill-pattern"])})},get layout(){return Iy=Iy||new cn({"fill-sort-key":new Dt(U.layout_fill["fill-sort-key"])})}};class U2 extends Ji{constructor(r){super(r,$2)}recalculate(r,s){super.recalculate(r,s);const c=this.paint._values["fill-outline-color"];c.value.kind==="constant"&&c.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(r){return new gm(r)}queryRadius(){return lf(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:r,geometry:s,transform:c,pixelsToTileUnits:f}){return cy(cf(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-c.bearingInRadians,f),s)}isTileClipped(){return!0}}const G2=oi([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Z2=oi([{name:"a_centroid",components:2,type:"Int16"}],4),{members:q2}=G2;var _m,Py,ym,Ay,vm,ky,Ly,ff={};function zy(){if(Py)return _m;Py=1;var o=k();function r(f,v,b,w,S){this.properties={},this.extent=b,this.type=0,this._pbf=f,this._geometry=-1,this._keys=w,this._values=S,f.readFields(s,this,v)}function s(f,v,b){f==1?v.id=b.readVarint():f==2?function(w,S){for(var C=w.readVarint()+w.pos;w.pos<C;){var A=S._keys[w.readVarint()],R=S._values[w.readVarint()];S.properties[A]=R}}(b,v):f==3?v.type=b.readVarint():f==4&&(v._geometry=b.pos)}function c(f){for(var v,b,w=0,S=0,C=f.length,A=C-1;S<C;A=S++)w+=((b=f[A]).x-(v=f[S]).x)*(v.y+b.y);return w}return _m=r,r.types=["Unknown","Point","LineString","Polygon"],r.prototype.loadGeometry=function(){var f=this._pbf;f.pos=this._geometry;for(var v,b=f.readVarint()+f.pos,w=1,S=0,C=0,A=0,R=[];f.pos<b;){if(S<=0){var j=f.readVarint();w=7&j,S=j>>3}if(S--,w===1||w===2)C+=f.readSVarint(),A+=f.readSVarint(),w===1&&(v&&R.push(v),v=[]),v.push(new o(C,A));else{if(w!==7)throw new Error("unknown command "+w);v&&v.push(v[0].clone())}}return v&&R.push(v),R},r.prototype.bbox=function(){var f=this._pbf;f.pos=this._geometry;for(var v=f.readVarint()+f.pos,b=1,w=0,S=0,C=0,A=1/0,R=-1/0,j=1/0,$=-1/0;f.pos<v;){if(w<=0){var G=f.readVarint();b=7&G,w=G>>3}if(w--,b===1||b===2)(S+=f.readSVarint())<A&&(A=S),S>R&&(R=S),(C+=f.readSVarint())<j&&(j=C),C>$&&($=C);else if(b!==7)throw new Error("unknown command "+b)}return[A,j,R,$]},r.prototype.toGeoJSON=function(f,v,b){var w,S,C=this.extent*Math.pow(2,b),A=this.extent*f,R=this.extent*v,j=this.loadGeometry(),$=r.types[this.type];function G(se){for(var ye=0;ye<se.length;ye++){var ue=se[ye];se[ye]=[360*(ue.x+A)/C-180,360/Math.PI*Math.atan(Math.exp((180-360*(ue.y+R)/C)*Math.PI/180))-90]}}switch(this.type){case 1:var W=[];for(w=0;w<j.length;w++)W[w]=j[w][0];G(j=W);break;case 2:for(w=0;w<j.length;w++)G(j[w]);break;case 3:for(j=function(se){var ye=se.length;if(ye<=1)return[se];for(var ue,V,ee=[],de=0;de<ye;de++){var Fe=c(se[de]);Fe!==0&&(V===void 0&&(V=Fe<0),V===Fe<0?(ue&&ee.push(ue),ue=[se[de]]):ue.push(se[de]))}return ue&&ee.push(ue),ee}(j),w=0;w<j.length;w++)for(S=0;S<j[w].length;S++)G(j[w][S])}j.length===1?j=j[0]:$="Multi"+$;var te={type:"Feature",geometry:{type:$,coordinates:j},properties:this.properties};return"id"in this&&(te.id=this.id),te},_m}function Ry(){if(Ay)return ym;Ay=1;var o=zy();function r(c,f){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=c,this._keys=[],this._values=[],this._features=[],c.readFields(s,this,f),this.length=this._features.length}function s(c,f,v){c===15?f.version=v.readVarint():c===1?f.name=v.readString():c===5?f.extent=v.readVarint():c===2?f._features.push(v.pos):c===3?f._keys.push(v.readString()):c===4&&f._values.push(function(b){for(var w=null,S=b.readVarint()+b.pos;b.pos<S;){var C=b.readVarint()>>3;w=C===1?b.readString():C===2?b.readFloat():C===3?b.readDouble():C===4?b.readVarint64():C===5?b.readVarint():C===6?b.readSVarint():C===7?b.readBoolean():null}return w}(v))}return ym=r,r.prototype.feature=function(c){if(c<0||c>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[c];var f=this._pbf.readVarint()+this._pbf.pos;return new o(this._pbf,f,this.extent,this._keys,this._values)},ym}function Dy(){return Ly||(Ly=1,ff.VectorTile=function(){if(ky)return vm;ky=1;var o=Ry();function r(s,c,f){if(s===3){var v=new o(f,f.readVarint()+f.pos);v.length&&(c[v.name]=v)}}return vm=function(s,c){this.layers=s.readFields(r,{},c)},vm}(),ff.VectorTileFeature=zy(),ff.VectorTileLayer=Ry()),ff}var oh=I(Dy());const H2=oh.VectorTileFeature.types,bm=Math.pow(2,13);function sh(o,r,s,c,f,v,b,w){o.emplaceBack(r,s,2*Math.floor(c*bm)+b,f*bm*2,v*bm*2,Math.round(w))}class xm{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(s=>s.id),this.index=r.index,this.hasPattern=!1,this.layoutVertexArray=new Te,this.centroidVertexArray=new fe,this.indexArray=new Je,this.programConfigurations=new bs(r.layers,r.zoom),this.segments=new Kt,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(r,s,c){this.features=[],this.hasPattern=dm("fill-extrusion",this.layers,s);for(const{feature:f,id:v,index:b,sourceLayerIndex:w}of r){const S=this.layers[0]._featureFilter.needGeometry,C=Vo(f,S);if(!this.layers[0]._featureFilter.filter(new Dr(this.zoom),C,c))continue;const A={id:v,sourceLayerIndex:w,index:b,geometry:S?C.geometry:No(f),properties:f.properties,type:f.type,patterns:{}};this.hasPattern?this.features.push(fm("fill-extrusion",this.layers,A,this.zoom,s)):this.addFeature(A,A.geometry,b,c,{},s.subdivisionGranularity),s.featureIndex.insert(f,A.geometry,b,w,this.index,!0)}}addFeatures(r,s,c){for(const f of this.features){const{geometry:v}=f;this.addFeature(f,v,f.index,s,c,r.subdivisionGranularity)}}update(r,s,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,s,this.stateDependentLayers,c)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,q2),this.centroidVertexBuffer=r.createVertexBuffer(this.centroidVertexArray,Z2.members,!0),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(r,s,c,f,v,b){for(const w of $a(s,500)){const S={x:0,y:0,sampleCount:0},C=this.layoutVertexArray.length;this.processPolygon(S,f,r,w,b);const A=this.layoutVertexArray.length-C,R=Math.floor(S.x/S.sampleCount),j=Math.floor(S.y/S.sampleCount);for(let $=0;$<A;$++)this.centroidVertexArray.emplaceBack(R,j)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,c,v,f)}processPolygon(r,s,c,f,v){if(f.length<1||Oy(f[0]))return;for(const R of f)R.length!==0&&W2(r,R);const b={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},w=v.fill.getGranularityForZoomLevel(s.z),S=H2[c.type]==="Polygon";for(const R of f){if(R.length===0||Oy(R))continue;const j=sl(R,w,S);this._generateSideFaces(j,b)}if(!S)return;const C=Ey(f,s,w,!1),A=this.layoutVertexArray;Cy((R,j)=>{sh(A,R,j,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,C.verticesFlattened,C.indicesTriangles)}_generateSideFaces(r,s){let c=0;for(let f=1;f<r.length;f++){const v=r[f],b=r[f-1];if(K2(v,b))continue;s.segment.vertexLength+4>Kt.MAX_VERTEX_ARRAY_LENGTH&&(s.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const w=v.sub(b)._perp()._unit(),S=b.dist(v);c+S>32768&&(c=0),sh(this.layoutVertexArray,v.x,v.y,w.x,w.y,0,0,c),sh(this.layoutVertexArray,v.x,v.y,w.x,w.y,0,1,c),c+=S,sh(this.layoutVertexArray,b.x,b.y,w.x,w.y,0,0,c),sh(this.layoutVertexArray,b.x,b.y,w.x,w.y,0,1,c);const C=s.segment.vertexLength;this.indexArray.emplaceBack(C,C+2,C+1),this.indexArray.emplaceBack(C+1,C+2,C+3),s.segment.vertexLength+=4,s.segment.primitiveLength+=2}}}function W2(o,r){for(let s=0;s<r.length;s++){const c=r[s];s===r.length-1&&r[0].x===c.x&&r[0].y===c.y||(o.x+=c.x,o.y+=c.y,o.sampleCount++)}}function K2(o,r){return o.x===r.x&&(o.x<0||o.x>Xe)||o.y===r.y&&(o.y<0||o.y>Xe)}function Oy(o){return o.every(r=>r.x<0)||o.every(r=>r.x>Xe)||o.every(r=>r.y<0)||o.every(r=>r.y>Xe)}let Fy;wt("FillExtrusionBucket",xm,{omit:["layers","features"]});var X2={get paint(){return Fy=Fy||new cn({"fill-extrusion-opacity":new Mt(U["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Dt(U["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Mt(U["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Mt(U["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new hc(U["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Dt(U["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Dt(U["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Mt(U["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Y2 extends Ji{constructor(r){super(r,X2)}createBucket(r){return new xm(r)}queryRadius(){return lf(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:r,feature:s,featureState:c,geometry:f,transform:v,pixelsToTileUnits:b,pixelPosMatrix:w}){const S=cf(r,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-v.bearingInRadians,b),C=this.paint.get("fill-extrusion-height").evaluate(s,c),A=this.paint.get("fill-extrusion-base").evaluate(s,c),R=function($,G,W){const te=[];for(const se of $){const ye=[se.x,se.y,0,1];Ae(ye,ye,G),te.push(new H(ye[0]/ye[3],ye[1]/ye[3]))}return te}(S,w),j=function($,G,W,te){const se=[],ye=[],ue=te[8]*G,V=te[9]*G,ee=te[10]*G,de=te[11]*G,Fe=te[8]*W,et=te[9]*W,je=te[10]*W,$e=te[11]*W;for(const ot of $){const tt=[],ct=[];for(const qe of ot){const Tt=qe.x,zt=qe.y,At=te[0]*Tt+te[4]*zt+te[12],Ct=te[1]*Tt+te[5]*zt+te[13],nr=te[2]*Tt+te[6]*zt+te[14],ei=te[3]*Tt+te[7]*zt+te[15],vi=nr+ee,Gi=ei+de,On=At+Fe,yn=Ct+et,Oi=nr+je,Zr=ei+$e,Ci=new H((At+ue)/Gi,(Ct+V)/Gi);Ci.z=vi/Gi,tt.push(Ci);const Fi=new H(On/Zr,yn/Zr);Fi.z=Oi/Zr,ct.push(Fi)}se.push(tt),ye.push(ct)}return[se,ye]}(f,A,C,w);return function($,G,W){let te=1/0;cy(W,G)&&(te=By(W,G[0]));for(let se=0;se<G.length;se++){const ye=G[se],ue=$[se];for(let V=0;V<ye.length-1;V++){const ee=ye[V],de=[ee,ye[V+1],ue[V+1],ue[V],ee];gc(W,de)&&(te=Math.min(te,By(W,de)))}}return te!==1/0&&te}(j[0],j[1],R)}}function ah(o,r){return o.x*r.x+o.y*r.y}function By(o,r){if(o.length===1){let s=0;const c=r[s++];let f;for(;!f||c.equals(f);)if(f=r[s++],!f)return 1/0;for(;s<r.length;s++){const v=r[s],b=o[0],w=f.sub(c),S=v.sub(c),C=b.sub(c),A=ah(w,w),R=ah(w,S),j=ah(S,S),$=ah(C,w),G=ah(C,S),W=A*j-R*R,te=(j*$-R*G)/W,se=(A*G-R*$)/W,ye=c.z*(1-te-se)+f.z*te+v.z*se;if(isFinite(ye))return ye}return 1/0}{let s=1/0;for(const c of r)s=Math.min(s,c.z);return s}}const J2=oi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Q2}=J2,eT=oi([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:tT}=eT,rT=oh.VectorTileFeature.types,iT=Math.cos(Math.PI/180*37.5),jy=Math.pow(2,14)/.5;class wm{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(s=>s.id),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(s=>{this.gradients[s.id]={}}),this.layoutVertexArray=new _e,this.layoutVertexArray2=new Oe,this.indexArray=new Je,this.programConfigurations=new bs(r.layers,r.zoom),this.segments=new Kt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(r,s,c){this.hasPattern=dm("line",this.layers,s);const f=this.layers[0].layout.get("line-sort-key"),v=!f.isConstant(),b=[];for(const{feature:w,id:S,index:C,sourceLayerIndex:A}of r){const R=this.layers[0]._featureFilter.needGeometry,j=Vo(w,R);if(!this.layers[0]._featureFilter.filter(new Dr(this.zoom),j,c))continue;const $=v?f.evaluate(j,{},c):void 0,G={id:S,properties:w.properties,type:w.type,sourceLayerIndex:A,index:C,geometry:R?j.geometry:No(w),patterns:{},sortKey:$};b.push(G)}v&&b.sort((w,S)=>w.sortKey-S.sortKey);for(const w of b){const{geometry:S,index:C,sourceLayerIndex:A}=w;if(this.hasPattern){const R=fm("line",this.layers,w,this.zoom,s);this.patternFeatures.push(R)}else this.addFeature(w,S,C,c,{},s.subdivisionGranularity);s.featureIndex.insert(r[C].feature,S,C,A,this.index)}}update(r,s,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,s,this.stateDependentLayers,c)}addFeatures(r,s,c){for(const f of this.patternFeatures)this.addFeature(f,f.geometry,f.index,s,c,r.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=r.createVertexBuffer(this.layoutVertexArray2,tT)),this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,Q2),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(r){if(r.properties&&Object.prototype.hasOwnProperty.call(r.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(r.properties,"mapbox_clip_end"))return{start:+r.properties.mapbox_clip_start,end:+r.properties.mapbox_clip_end}}addFeature(r,s,c,f,v,b){const w=this.layers[0].layout,S=w.get("line-join").evaluate(r,{}),C=w.get("line-cap"),A=w.get("line-miter-limit"),R=w.get("line-round-limit");this.lineClips=this.lineFeatureClips(r);for(const j of s)this.addLine(j,r,S,C,A,R,f,b);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,c,v,f)}addLine(r,s,c,f,v,b,w,S){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,r=sl(r,w?S.line.getGranularityForZoomLevel(w.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ue=0;ue<r.length-1;ue++)this.totalDistance+=r[ue].dist(r[ue+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const C=rT[s.type]==="Polygon";let A=r.length;for(;A>=2&&r[A-1].equals(r[A-2]);)A--;let R=0;for(;R<A-1&&r[R].equals(r[R+1]);)R++;if(A<(C?3:2))return;c==="bevel"&&(v=1.05);const j=this.overscaling<=16?15*Xe/(512*this.overscaling):0,$=this.segments.prepareSegment(10*A,this.layoutVertexArray,this.indexArray);let G,W,te,se,ye;this.e1=this.e2=-1,C&&(G=r[A-2],ye=r[R].sub(G)._unit()._perp());for(let ue=R;ue<A;ue++){if(te=ue===A-1?C?r[R+1]:void 0:r[ue+1],te&&r[ue].equals(te))continue;ye&&(se=ye),G&&(W=G),G=r[ue],ye=te?te.sub(G)._unit()._perp():se,se=se||ye;let V=se.add(ye);V.x===0&&V.y===0||V._unit();const ee=se.x*ye.x+se.y*ye.y,de=V.x*ye.x+V.y*ye.y,Fe=de!==0?1/de:1/0,et=2*Math.sqrt(2-2*de),je=de<iT&&W&&te,$e=se.x*ye.y-se.y*ye.x>0;if(je&&ue>R){const ct=G.dist(W);if(ct>2*j){const qe=G.sub(G.sub(W)._mult(j/ct)._round());this.updateDistance(W,qe),this.addCurrentVertex(qe,se,0,0,$),W=qe}}const ot=W&&te;let tt=ot?c:C?"butt":f;if(ot&&tt==="round"&&(Fe<b?tt="miter":Fe<=2&&(tt="fakeround")),tt==="miter"&&Fe>v&&(tt="bevel"),tt==="bevel"&&(Fe>2&&(tt="flipbevel"),Fe<v&&(tt="miter")),W&&this.updateDistance(W,G),tt==="miter")V._mult(Fe),this.addCurrentVertex(G,V,0,0,$);else if(tt==="flipbevel"){if(Fe>100)V=ye.mult(-1);else{const ct=Fe*se.add(ye).mag()/se.sub(ye).mag();V._perp()._mult(ct*($e?-1:1))}this.addCurrentVertex(G,V,0,0,$),this.addCurrentVertex(G,V.mult(-1),0,0,$)}else if(tt==="bevel"||tt==="fakeround"){const ct=-Math.sqrt(Fe*Fe-1),qe=$e?ct:0,Tt=$e?0:ct;if(W&&this.addCurrentVertex(G,se,qe,Tt,$),tt==="fakeround"){const zt=Math.round(180*et/Math.PI/20);for(let At=1;At<zt;At++){let Ct=At/zt;if(Ct!==.5){const ei=Ct-.5;Ct+=Ct*ei*(Ct-1)*((1.0904+ee*(ee*(3.55645-1.43519*ee)-3.2452))*ei*ei+(.848013+ee*(.215638*ee-1.06021)))}const nr=ye.sub(se)._mult(Ct)._add(se)._unit()._mult($e?-1:1);this.addHalfVertex(G,nr.x,nr.y,!1,$e,0,$)}}te&&this.addCurrentVertex(G,ye,-qe,-Tt,$)}else if(tt==="butt")this.addCurrentVertex(G,V,0,0,$);else if(tt==="square"){const ct=W?1:-1;this.addCurrentVertex(G,V,ct,ct,$)}else tt==="round"&&(W&&(this.addCurrentVertex(G,se,0,0,$),this.addCurrentVertex(G,se,1,1,$,!0)),te&&(this.addCurrentVertex(G,ye,-1,-1,$,!0),this.addCurrentVertex(G,ye,0,0,$)));if(je&&ue<A-1){const ct=G.dist(te);if(ct>2*j){const qe=G.add(te.sub(G)._mult(j/ct)._round());this.updateDistance(G,qe),this.addCurrentVertex(qe,ye,0,0,$),G=qe}}}}addCurrentVertex(r,s,c,f,v,b=!1){const w=s.y*f-s.x,S=-s.y-s.x*f;this.addHalfVertex(r,s.x+s.y*c,s.y-s.x*c,b,!1,c,v),this.addHalfVertex(r,w,S,b,!0,-f,v),this.distance>jy/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(r,s,c,f,v,b))}addHalfVertex({x:r,y:s},c,f,v,b,w,S){const C=.5*(this.lineClips?this.scaledDistance*(jy-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((r<<1)+(v?1:0),(s<<1)+(b?1:0),Math.round(63*c)+128,Math.round(63*f)+128,1+(w===0?0:w<0?-1:1)|(63&C)<<2,C>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const A=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,A,this.e2),S.primitiveLength++),b?this.e2=A:this.e1=A}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(r,s){this.distance+=r.dist(s),this.updateScaledDistance()}}let Ny,Vy;wt("LineBucket",wm,{omit:["layers","patternFeatures"]});var $y={get paint(){return Vy=Vy||new cn({"line-opacity":new Dt(U.paint_line["line-opacity"]),"line-color":new Dt(U.paint_line["line-color"]),"line-translate":new Mt(U.paint_line["line-translate"]),"line-translate-anchor":new Mt(U.paint_line["line-translate-anchor"]),"line-width":new Dt(U.paint_line["line-width"]),"line-gap-width":new Dt(U.paint_line["line-gap-width"]),"line-offset":new Dt(U.paint_line["line-offset"]),"line-blur":new Dt(U.paint_line["line-blur"]),"line-dasharray":new Vu(U.paint_line["line-dasharray"]),"line-pattern":new hc(U.paint_line["line-pattern"]),"line-gradient":new $u(U.paint_line["line-gradient"])})},get layout(){return Ny=Ny||new cn({"line-cap":new Mt(U.layout_line["line-cap"]),"line-join":new Dt(U.layout_line["line-join"]),"line-miter-limit":new Mt(U.layout_line["line-miter-limit"]),"line-round-limit":new Mt(U.layout_line["line-round-limit"]),"line-sort-key":new Dt(U.layout_line["line-sort-key"])})}};class nT extends Dt{possiblyEvaluate(r,s){return s=new Dr(Math.floor(s.zoom),{now:s.now,fadeDuration:s.fadeDuration,zoomHistory:s.zoomHistory,transition:s.transition}),super.possiblyEvaluate(r,s)}evaluate(r,s,c,f){return s=Pt({},s,{zoom:Math.floor(s.zoom)}),super.evaluate(r,s,c,f)}}let pf;class oT extends Ji{constructor(r){super(r,$y),this.gradientVersion=0,pf||(pf=new nT($y.paint.properties["line-width"].specification),pf.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(r){if(r==="line-gradient"){const s=this.gradientExpression();this.stepInterpolant=!!function(c){return c._styleExpression!==void 0}(s)&&s._styleExpression.expression instanceof Gs,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(r,s){super.recalculate(r,s),this.paint._values["line-floorwidth"]=pf.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)}createBucket(r){return new wm(r)}queryRadius(r){const s=r,c=Uy(Yu("line-width",this,s),Yu("line-gap-width",this,s)),f=Yu("line-offset",this,s);return c/2+Math.abs(f)+lf(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:r,feature:s,featureState:c,geometry:f,transform:v,pixelsToTileUnits:b}){const w=cf(r,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-v.bearingInRadians,b),S=b/2*Uy(this.paint.get("line-width").evaluate(s,c),this.paint.get("line-gap-width").evaluate(s,c)),C=this.paint.get("line-offset").evaluate(s,c);return C&&(f=function(A,R){const j=[];for(let $=0;$<A.length;$++){const G=A[$],W=[];for(let te=0;te<G.length;te++){const se=G[te-1],ye=G[te],ue=G[te+1],V=te===0?new H(0,0):ye.sub(se)._unit()._perp(),ee=te===G.length-1?new H(0,0):ue.sub(ye)._unit()._perp(),de=V._add(ee)._unit(),Fe=de.x*ee.x+de.y*ee.y;Fe!==0&&de._mult(1/Fe),W.push(de._mult(R)._add(ye))}j.push(W)}return j}(f,C*b)),function(A,R,j){for(let $=0;$<R.length;$++){const G=R[$];if(A.length>=3){for(let W=0;W<G.length;W++)if(nl(A,G[W]))return!0}if(b2(A,G,j))return!0}return!1}(w,f,S)}isTileClipped(){return!0}}function Uy(o,r){return r>0?r+2*o:o}const sT=oi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),aT=oi([{name:"a_projected_pos",components:3,type:"Float32"}],4);oi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const lT=oi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);oi([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Gy=oi([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),cT=oi([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function uT(o,r,s){return o.sections.forEach(c=>{c.text=function(f,v,b){const w=v.layout.get("text-transform").evaluate(b,{});return w==="uppercase"?f=f.toLocaleUpperCase():w==="lowercase"&&(f=f.toLocaleLowerCase()),mo.applyArabicShaping&&(f=mo.applyArabicShaping(f)),f}(c.text,r,s)}),o}oi([{name:"triangle",components:3,type:"Uint16"}]),oi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),oi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),oi([{type:"Float32",name:"offsetX"}]),oi([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),oi([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const lh={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Zy,Tm,qy,yi=24,Sm={};function hT(){return Zy||(Zy=1,Sm.read=function(o,r,s,c,f){var v,b,w=8*f-c-1,S=(1<<w)-1,C=S>>1,A=-7,R=s?f-1:0,j=s?-1:1,$=o[r+R];for(R+=j,v=$&(1<<-A)-1,$>>=-A,A+=w;A>0;v=256*v+o[r+R],R+=j,A-=8);for(b=v&(1<<-A)-1,v>>=-A,A+=c;A>0;b=256*b+o[r+R],R+=j,A-=8);if(v===0)v=1-C;else{if(v===S)return b?NaN:1/0*($?-1:1);b+=Math.pow(2,c),v-=C}return($?-1:1)*b*Math.pow(2,v-c)},Sm.write=function(o,r,s,c,f,v){var b,w,S,C=8*v-f-1,A=(1<<C)-1,R=A>>1,j=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,$=c?0:v-1,G=c?1:-1,W=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(w=isNaN(r)?1:0,b=A):(b=Math.floor(Math.log(r)/Math.LN2),r*(S=Math.pow(2,-b))<1&&(b--,S*=2),(r+=b+R>=1?j/S:j*Math.pow(2,1-R))*S>=2&&(b++,S/=2),b+R>=A?(w=0,b=A):b+R>=1?(w=(r*S-1)*Math.pow(2,f),b+=R):(w=r*Math.pow(2,R-1)*Math.pow(2,f),b=0));f>=8;o[s+$]=255&w,$+=G,w/=256,f-=8);for(b=b<<f|w,C+=f;C>0;o[s+$]=255&b,$+=G,b/=256,C-=8);o[s+$-G]|=128*W}),Sm}function Hy(){if(qy)return Tm;qy=1,Tm=r;var o=hT();function r(V){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(V)?V:new Uint8Array(V||0),this.pos=0,this.type=0,this.length=this.buf.length}r.Varint=0,r.Fixed64=1,r.Bytes=2,r.Fixed32=5;var s=4294967296,c=1/s,f=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function v(V){return V.type===r.Bytes?V.readVarint()+V.pos:V.pos+1}function b(V,ee,de){return de?4294967296*ee+(V>>>0):4294967296*(ee>>>0)+(V>>>0)}function w(V,ee,de){var Fe=ee<=16383?1:ee<=2097151?2:ee<=268435455?3:Math.floor(Math.log(ee)/(7*Math.LN2));de.realloc(Fe);for(var et=de.pos-1;et>=V;et--)de.buf[et+Fe]=de.buf[et]}function S(V,ee){for(var de=0;de<V.length;de++)ee.writeVarint(V[de])}function C(V,ee){for(var de=0;de<V.length;de++)ee.writeSVarint(V[de])}function A(V,ee){for(var de=0;de<V.length;de++)ee.writeFloat(V[de])}function R(V,ee){for(var de=0;de<V.length;de++)ee.writeDouble(V[de])}function j(V,ee){for(var de=0;de<V.length;de++)ee.writeBoolean(V[de])}function $(V,ee){for(var de=0;de<V.length;de++)ee.writeFixed32(V[de])}function G(V,ee){for(var de=0;de<V.length;de++)ee.writeSFixed32(V[de])}function W(V,ee){for(var de=0;de<V.length;de++)ee.writeFixed64(V[de])}function te(V,ee){for(var de=0;de<V.length;de++)ee.writeSFixed64(V[de])}function se(V,ee){return(V[ee]|V[ee+1]<<8|V[ee+2]<<16)+16777216*V[ee+3]}function ye(V,ee,de){V[de]=ee,V[de+1]=ee>>>8,V[de+2]=ee>>>16,V[de+3]=ee>>>24}function ue(V,ee){return(V[ee]|V[ee+1]<<8|V[ee+2]<<16)+(V[ee+3]<<24)}return r.prototype={destroy:function(){this.buf=null},readFields:function(V,ee,de){for(de=de||this.length;this.pos<de;){var Fe=this.readVarint(),et=Fe>>3,je=this.pos;this.type=7&Fe,V(et,ee,this),this.pos===je&&this.skip(Fe)}return ee},readMessage:function(V,ee){return this.readFields(V,ee,this.readVarint()+this.pos)},readFixed32:function(){var V=se(this.buf,this.pos);return this.pos+=4,V},readSFixed32:function(){var V=ue(this.buf,this.pos);return this.pos+=4,V},readFixed64:function(){var V=se(this.buf,this.pos)+se(this.buf,this.pos+4)*s;return this.pos+=8,V},readSFixed64:function(){var V=se(this.buf,this.pos)+ue(this.buf,this.pos+4)*s;return this.pos+=8,V},readFloat:function(){var V=o.read(this.buf,this.pos,!0,23,4);return this.pos+=4,V},readDouble:function(){var V=o.read(this.buf,this.pos,!0,52,8);return this.pos+=8,V},readVarint:function(V){var ee,de,Fe=this.buf;return ee=127&(de=Fe[this.pos++]),de<128?ee:(ee|=(127&(de=Fe[this.pos++]))<<7,de<128?ee:(ee|=(127&(de=Fe[this.pos++]))<<14,de<128?ee:(ee|=(127&(de=Fe[this.pos++]))<<21,de<128?ee:function(et,je,$e){var ot,tt,ct=$e.buf;if(ot=(112&(tt=ct[$e.pos++]))>>4,tt<128||(ot|=(127&(tt=ct[$e.pos++]))<<3,tt<128)||(ot|=(127&(tt=ct[$e.pos++]))<<10,tt<128)||(ot|=(127&(tt=ct[$e.pos++]))<<17,tt<128)||(ot|=(127&(tt=ct[$e.pos++]))<<24,tt<128)||(ot|=(1&(tt=ct[$e.pos++]))<<31,tt<128))return b(et,ot,je);throw new Error("Expected varint not more than 10 bytes")}(ee|=(15&(de=Fe[this.pos]))<<28,V,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var V=this.readVarint();return V%2==1?(V+1)/-2:V/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var V=this.readVarint()+this.pos,ee=this.pos;return this.pos=V,V-ee>=12&&f?function(de,Fe,et){return f.decode(de.subarray(Fe,et))}(this.buf,ee,V):function(de,Fe,et){for(var je="",$e=Fe;$e<et;){var ot,tt,ct,qe=de[$e],Tt=null,zt=qe>239?4:qe>223?3:qe>191?2:1;if($e+zt>et)break;zt===1?qe<128&&(Tt=qe):zt===2?(192&(ot=de[$e+1]))==128&&(Tt=(31&qe)<<6|63&ot)<=127&&(Tt=null):zt===3?(tt=de[$e+2],(192&(ot=de[$e+1]))==128&&(192&tt)==128&&((Tt=(15&qe)<<12|(63&ot)<<6|63&tt)<=2047||Tt>=55296&&Tt<=57343)&&(Tt=null)):zt===4&&(tt=de[$e+2],ct=de[$e+3],(192&(ot=de[$e+1]))==128&&(192&tt)==128&&(192&ct)==128&&((Tt=(15&qe)<<18|(63&ot)<<12|(63&tt)<<6|63&ct)<=65535||Tt>=1114112)&&(Tt=null)),Tt===null?(Tt=65533,zt=1):Tt>65535&&(Tt-=65536,je+=String.fromCharCode(Tt>>>10&1023|55296),Tt=56320|1023&Tt),je+=String.fromCharCode(Tt),$e+=zt}return je}(this.buf,ee,V)},readBytes:function(){var V=this.readVarint()+this.pos,ee=this.buf.subarray(this.pos,V);return this.pos=V,ee},readPackedVarint:function(V,ee){if(this.type!==r.Bytes)return V.push(this.readVarint(ee));var de=v(this);for(V=V||[];this.pos<de;)V.push(this.readVarint(ee));return V},readPackedSVarint:function(V){if(this.type!==r.Bytes)return V.push(this.readSVarint());var ee=v(this);for(V=V||[];this.pos<ee;)V.push(this.readSVarint());return V},readPackedBoolean:function(V){if(this.type!==r.Bytes)return V.push(this.readBoolean());var ee=v(this);for(V=V||[];this.pos<ee;)V.push(this.readBoolean());return V},readPackedFloat:function(V){if(this.type!==r.Bytes)return V.push(this.readFloat());var ee=v(this);for(V=V||[];this.pos<ee;)V.push(this.readFloat());return V},readPackedDouble:function(V){if(this.type!==r.Bytes)return V.push(this.readDouble());var ee=v(this);for(V=V||[];this.pos<ee;)V.push(this.readDouble());return V},readPackedFixed32:function(V){if(this.type!==r.Bytes)return V.push(this.readFixed32());var ee=v(this);for(V=V||[];this.pos<ee;)V.push(this.readFixed32());return V},readPackedSFixed32:function(V){if(this.type!==r.Bytes)return V.push(this.readSFixed32());var ee=v(this);for(V=V||[];this.pos<ee;)V.push(this.readSFixed32());return V},readPackedFixed64:function(V){if(this.type!==r.Bytes)return V.push(this.readFixed64());var ee=v(this);for(V=V||[];this.pos<ee;)V.push(this.readFixed64());return V},readPackedSFixed64:function(V){if(this.type!==r.Bytes)return V.push(this.readSFixed64());var ee=v(this);for(V=V||[];this.pos<ee;)V.push(this.readSFixed64());return V},skip:function(V){var ee=7&V;if(ee===r.Varint)for(;this.buf[this.pos++]>127;);else if(ee===r.Bytes)this.pos=this.readVarint()+this.pos;else if(ee===r.Fixed32)this.pos+=4;else{if(ee!==r.Fixed64)throw new Error("Unimplemented type: "+ee);this.pos+=8}},writeTag:function(V,ee){this.writeVarint(V<<3|ee)},realloc:function(V){for(var ee=this.length||16;ee<this.pos+V;)ee*=2;if(ee!==this.length){var de=new Uint8Array(ee);de.set(this.buf),this.buf=de,this.length=ee}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(V){this.realloc(4),ye(this.buf,V,this.pos),this.pos+=4},writeSFixed32:function(V){this.realloc(4),ye(this.buf,V,this.pos),this.pos+=4},writeFixed64:function(V){this.realloc(8),ye(this.buf,-1&V,this.pos),ye(this.buf,Math.floor(V*c),this.pos+4),this.pos+=8},writeSFixed64:function(V){this.realloc(8),ye(this.buf,-1&V,this.pos),ye(this.buf,Math.floor(V*c),this.pos+4),this.pos+=8},writeVarint:function(V){(V=+V||0)>268435455||V<0?function(ee,de){var Fe,et;if(ee>=0?(Fe=ee%4294967296|0,et=ee/4294967296|0):(et=~(-ee/4294967296),4294967295^(Fe=~(-ee%4294967296))?Fe=Fe+1|0:(Fe=0,et=et+1|0)),ee>=18446744073709552e3||ee<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");de.realloc(10),function(je,$e,ot){ot.buf[ot.pos++]=127&je|128,je>>>=7,ot.buf[ot.pos++]=127&je|128,je>>>=7,ot.buf[ot.pos++]=127&je|128,je>>>=7,ot.buf[ot.pos++]=127&je|128,ot.buf[ot.pos]=127&(je>>>=7)}(Fe,0,de),function(je,$e){var ot=(7&je)<<4;$e.buf[$e.pos++]|=ot|((je>>>=3)?128:0),je&&($e.buf[$e.pos++]=127&je|((je>>>=7)?128:0),je&&($e.buf[$e.pos++]=127&je|((je>>>=7)?128:0),je&&($e.buf[$e.pos++]=127&je|((je>>>=7)?128:0),je&&($e.buf[$e.pos++]=127&je|((je>>>=7)?128:0),je&&($e.buf[$e.pos++]=127&je)))))}(et,de)}(V,this):(this.realloc(4),this.buf[this.pos++]=127&V|(V>127?128:0),V<=127||(this.buf[this.pos++]=127&(V>>>=7)|(V>127?128:0),V<=127||(this.buf[this.pos++]=127&(V>>>=7)|(V>127?128:0),V<=127||(this.buf[this.pos++]=V>>>7&127))))},writeSVarint:function(V){this.writeVarint(V<0?2*-V-1:2*V)},writeBoolean:function(V){this.writeVarint(!!V)},writeString:function(V){V=String(V),this.realloc(4*V.length),this.pos++;var ee=this.pos;this.pos=function(Fe,et,je){for(var $e,ot,tt=0;tt<et.length;tt++){if(($e=et.charCodeAt(tt))>55295&&$e<57344){if(!ot){$e>56319||tt+1===et.length?(Fe[je++]=239,Fe[je++]=191,Fe[je++]=189):ot=$e;continue}if($e<56320){Fe[je++]=239,Fe[je++]=191,Fe[je++]=189,ot=$e;continue}$e=ot-55296<<10|$e-56320|65536,ot=null}else ot&&(Fe[je++]=239,Fe[je++]=191,Fe[je++]=189,ot=null);$e<128?Fe[je++]=$e:($e<2048?Fe[je++]=$e>>6|192:($e<65536?Fe[je++]=$e>>12|224:(Fe[je++]=$e>>18|240,Fe[je++]=$e>>12&63|128),Fe[je++]=$e>>6&63|128),Fe[je++]=63&$e|128)}return je}(this.buf,V,this.pos);var de=this.pos-ee;de>=128&&w(ee,de,this),this.pos=ee-1,this.writeVarint(de),this.pos+=de},writeFloat:function(V){this.realloc(4),o.write(this.buf,V,this.pos,!0,23,4),this.pos+=4},writeDouble:function(V){this.realloc(8),o.write(this.buf,V,this.pos,!0,52,8),this.pos+=8},writeBytes:function(V){var ee=V.length;this.writeVarint(ee),this.realloc(ee);for(var de=0;de<ee;de++)this.buf[this.pos++]=V[de]},writeRawMessage:function(V,ee){this.pos++;var de=this.pos;V(ee,this);var Fe=this.pos-de;Fe>=128&&w(de,Fe,this),this.pos=de-1,this.writeVarint(Fe),this.pos+=Fe},writeMessage:function(V,ee,de){this.writeTag(V,r.Bytes),this.writeRawMessage(ee,de)},writePackedVarint:function(V,ee){ee.length&&this.writeMessage(V,S,ee)},writePackedSVarint:function(V,ee){ee.length&&this.writeMessage(V,C,ee)},writePackedBoolean:function(V,ee){ee.length&&this.writeMessage(V,j,ee)},writePackedFloat:function(V,ee){ee.length&&this.writeMessage(V,A,ee)},writePackedDouble:function(V,ee){ee.length&&this.writeMessage(V,R,ee)},writePackedFixed32:function(V,ee){ee.length&&this.writeMessage(V,$,ee)},writePackedSFixed32:function(V,ee){ee.length&&this.writeMessage(V,G,ee)},writePackedFixed64:function(V,ee){ee.length&&this.writeMessage(V,W,ee)},writePackedSFixed64:function(V,ee){ee.length&&this.writeMessage(V,te,ee)},writeBytesField:function(V,ee){this.writeTag(V,r.Bytes),this.writeBytes(ee)},writeFixed32Field:function(V,ee){this.writeTag(V,r.Fixed32),this.writeFixed32(ee)},writeSFixed32Field:function(V,ee){this.writeTag(V,r.Fixed32),this.writeSFixed32(ee)},writeFixed64Field:function(V,ee){this.writeTag(V,r.Fixed64),this.writeFixed64(ee)},writeSFixed64Field:function(V,ee){this.writeTag(V,r.Fixed64),this.writeSFixed64(ee)},writeVarintField:function(V,ee){this.writeTag(V,r.Varint),this.writeVarint(ee)},writeSVarintField:function(V,ee){this.writeTag(V,r.Varint),this.writeSVarint(ee)},writeStringField:function(V,ee){this.writeTag(V,r.Bytes),this.writeString(ee)},writeFloatField:function(V,ee){this.writeTag(V,r.Fixed32),this.writeFloat(ee)},writeDoubleField:function(V,ee){this.writeTag(V,r.Fixed64),this.writeDouble(ee)},writeBooleanField:function(V,ee){this.writeVarintField(V,!!ee)}},Tm}var Em=I(Hy());const Cm=3;function dT(o,r,s){o===1&&s.readMessage(fT,r)}function fT(o,r,s){if(o===3){const{id:c,bitmap:f,width:v,height:b,left:w,top:S,advance:C}=s.readMessage(pT,{});r.push({id:c,bitmap:new Ju({width:v+2*Cm,height:b+2*Cm},f),metrics:{width:v,height:b,left:w,top:S,advance:C}})}}function pT(o,r,s){o===1?r.id=s.readVarint():o===2?r.bitmap=s.readBytes():o===3?r.width=s.readVarint():o===4?r.height=s.readVarint():o===5?r.left=s.readSVarint():o===6?r.top=s.readSVarint():o===7&&(r.advance=s.readVarint())}const mT=Cm;function Wy(o){let r=0,s=0;for(const b of o)r+=b.w*b.h,s=Math.max(s,b.w);o.sort((b,w)=>w.h-b.h);const c=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(r/.95)),s),h:1/0}];let f=0,v=0;for(const b of o)for(let w=c.length-1;w>=0;w--){const S=c[w];if(!(b.w>S.w||b.h>S.h)){if(b.x=S.x,b.y=S.y,v=Math.max(v,b.y+b.h),f=Math.max(f,b.x+b.w),b.w===S.w&&b.h===S.h){const C=c.pop();w<c.length&&(c[w]=C)}else b.h===S.h?(S.x+=b.w,S.w-=b.w):b.w===S.w?(S.y+=b.h,S.h-=b.h):(c.push({x:S.x+b.w,y:S.y,w:S.w-b.w,h:b.h}),S.y+=b.h,S.h-=b.h);break}}return{w:f,h:v,fill:r/(f*v)||0}}const _n=1;class Im{constructor(r,{pixelRatio:s,version:c,stretchX:f,stretchY:v,content:b,textFitWidth:w,textFitHeight:S}){this.paddedRect=r,this.pixelRatio=s,this.stretchX=f,this.stretchY=v,this.content=b,this.version=c,this.textFitWidth=w,this.textFitHeight=S}get tl(){return[this.paddedRect.x+_n,this.paddedRect.y+_n]}get br(){return[this.paddedRect.x+this.paddedRect.w-_n,this.paddedRect.y+this.paddedRect.h-_n]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*_n)/this.pixelRatio,(this.paddedRect.h-2*_n)/this.pixelRatio]}}class Ky{constructor(r,s){const c={},f={};this.haveRenderCallbacks=[];const v=[];this.addImages(r,c,v),this.addImages(s,f,v);const{w:b,h:w}=Wy(v),S=new Rn({width:b||1,height:w||1});for(const C in r){const A=r[C],R=c[C].paddedRect;Rn.copy(A.data,S,{x:0,y:0},{x:R.x+_n,y:R.y+_n},A.data)}for(const C in s){const A=s[C],R=f[C].paddedRect,j=R.x+_n,$=R.y+_n,G=A.data.width,W=A.data.height;Rn.copy(A.data,S,{x:0,y:0},{x:j,y:$},A.data),Rn.copy(A.data,S,{x:0,y:W-1},{x:j,y:$-1},{width:G,height:1}),Rn.copy(A.data,S,{x:0,y:0},{x:j,y:$+W},{width:G,height:1}),Rn.copy(A.data,S,{x:G-1,y:0},{x:j-1,y:$},{width:1,height:W}),Rn.copy(A.data,S,{x:0,y:0},{x:j+G,y:$},{width:1,height:W})}this.image=S,this.iconPositions=c,this.patternPositions=f}addImages(r,s,c){for(const f in r){const v=r[f],b={x:0,y:0,w:v.data.width+2*_n,h:v.data.height+2*_n};c.push(b),s[f]=new Im(b,v),v.hasRenderCallback&&this.haveRenderCallbacks.push(f)}}patchUpdatedImages(r,s){r.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const c in r.updatedImages)this.patchUpdatedImage(this.iconPositions[c],r.getImage(c),s),this.patchUpdatedImage(this.patternPositions[c],r.getImage(c),s)}patchUpdatedImage(r,s,c){if(!r||!s||r.version===s.version)return;r.version=s.version;const[f,v]=r.tl;c.update(s.data,void 0,{x:f,y:v})}}var ca;wt("ImagePosition",Im),wt("ImageAtlas",Ky),m.ah=void 0,(ca=m.ah||(m.ah={}))[ca.none=0]="none",ca[ca.horizontal=1]="horizontal",ca[ca.vertical=2]="vertical",ca[ca.horizontalOnly=3]="horizontalOnly";const mf=-17;class ch{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(r,s,c){const f=new ch;return f.scale=r||1,f.fontStack=s,f.verticalAlign=c||"bottom",f}static forImage(r,s){const c=new ch;return c.imageName=r,c.verticalAlign=s||"bottom",c}}class bc{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(r,s){const c=new bc;for(let f=0;f<r.sections.length;f++){const v=r.sections[f];v.image?c.addImageSection(v):c.addTextSection(v,s)}return c}length(){return this.text.length}getSection(r){return this.sections[this.sectionIndex[r]]}getSectionIndex(r){return this.sectionIndex[r]}getCharCode(r){return this.text.charCodeAt(r)}verticalizePunctuation(){this.text=function(r){let s="";for(let c=0;c<r.length;c++){const f=r.charCodeAt(c+1)||null,v=r.charCodeAt(c-1)||null;s+=f&&ju(f)&&!lh[r[c+1]]||v&&ju(v)&&!lh[r[c-1]]||!lh[r[c]]?r[c]:lh[r[c]]}return s}(this.text)}trim(){let r=0;for(let c=0;c<this.text.length&&_f[this.text.charCodeAt(c)];c++)r++;let s=this.text.length;for(let c=this.text.length-1;c>=0&&c>=r&&_f[this.text.charCodeAt(c)];c--)s--;this.text=this.text.substring(r,s),this.sectionIndex=this.sectionIndex.slice(r,s)}substring(r,s){const c=new bc;return c.text=this.text.substring(r,s),c.sectionIndex=this.sectionIndex.slice(r,s),c.sections=this.sections,c}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((r,s)=>Math.max(r,this.sections[s].scale),0)}getMaxImageSize(r){let s=0,c=0;for(let f=0;f<this.length();f++){const v=this.getSection(f);if(v.imageName){const b=r[v.imageName];if(!b)continue;const w=b.displaySize;s=Math.max(s,w[0]),c=Math.max(c,w[1])}}return{maxImageWidth:s,maxImageHeight:c}}addTextSection(r,s){this.text+=r.text,this.sections.push(ch.forText(r.scale,r.fontStack||s,r.verticalAlign));const c=this.sections.length-1;for(let f=0;f<r.text.length;++f)this.sectionIndex.push(c)}addImageSection(r){const s=r.image?r.image.name:"";if(s.length===0)return void Pr("Can't add FormattedSection with an empty image.");const c=this.getNextImageSectionCharCode();c?(this.text+=String.fromCharCode(c),this.sections.push(ch.forImage(s,r.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):Pr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function gf(o,r,s,c,f,v,b,w,S,C,A,R,j,$,G){const W=bc.fromFeature(o,f);let te;R===m.ah.vertical&&W.verticalizePunctuation();const{processBidirectionalText:se,processStyledBidirectionalText:ye}=mo;if(se&&W.sections.length===1){te=[];const ee=se(W.toString(),Mm(W,C,v,r,c,$));for(const de of ee){const Fe=new bc;Fe.text=de,Fe.sections=W.sections;for(let et=0;et<de.length;et++)Fe.sectionIndex.push(0);te.push(Fe)}}else if(ye){te=[];const ee=ye(W.text,W.sectionIndex,Mm(W,C,v,r,c,$));for(const de of ee){const Fe=new bc;Fe.text=de[0],Fe.sectionIndex=de[1],Fe.sections=W.sections,te.push(Fe)}}else te=function(ee,de){const Fe=[],et=ee.text;let je=0;for(const $e of de)Fe.push(ee.substring(je,$e)),je=$e;return je<et.length&&Fe.push(ee.substring(je,et.length)),Fe}(W,Mm(W,C,v,r,c,$));const ue=[],V={positionedLines:ue,text:W.toString(),top:A[1],bottom:A[1],left:A[0],right:A[0],writingMode:R,iconsInText:!1,verticalizable:!1};return function(ee,de,Fe,et,je,$e,ot,tt,ct,qe,Tt,zt){let At=0,Ct=0,nr=0,ei=0;const vi=tt==="right"?1:tt==="left"?0:.5,Gi=yi/zt;let On=0;for(const Zr of je){Zr.trim();const Ci=Zr.getMaxScale(),Fi={positionedGlyphs:[],lineOffset:0};ee.positionedLines[On]=Fi;const Bi=Fi.positionedGlyphs;let hn=0;if(!Zr.length()){Ct+=$e,++On;continue}const Fn=vT(et,Zr,Gi);for(let vn=0;vn<Zr.length();vn++){const bi=Zr.getSection(vn),Mi=Zr.getSectionIndex(vn),Pi=Zr.getCharCode(vn),fi=bT(ct,Tt,Pi);let Fr;if(bi.imageName){if(ee.iconsInText=!0,bi.scale=bi.scale*Gi,Fr=wT(bi,fi,Ci,Fn,et),!Fr)continue;hn=Math.max(hn,Fr.imageOffset)}else if(Fr=xT(bi,Pi,fi,Fn,de,Fe),!Fr)continue;const{rect:vo,metrics:Sc,baselineOffset:bo}=Fr;Bi.push({glyph:Pi,imageName:bi.imageName,x:At,y:Ct+bo+mf,vertical:fi,scale:bi.scale,fontStack:bi.fontStack,sectionIndex:Mi,metrics:Sc,rect:vo}),fi?(ee.verticalizable=!0,At+=(bi.imageName?Sc.advance:yi)*bi.scale+qe):At+=Sc.advance*bi.scale+qe}Bi.length!==0&&(nr=Math.max(At-qe,nr),TT(Bi,0,Bi.length-1,vi)),At=0,Fi.lineOffset=Math.max(hn,(Ci-1)*yi);const Ii=$e*Ci+hn;Ct+=Ii,ei=Math.max(Ii,ei),++On}const{horizontalAlign:yn,verticalAlign:Oi}=Pm(ot);(function(Zr,Ci,Fi,Bi,hn,Fn,Ii,vn,bi){const Mi=(Ci-Fi)*hn;let Pi=0;Pi=Fn!==Ii?-vn*Bi-mf:-Bi*bi*Ii+.5*Ii;for(const fi of Zr)for(const Fr of fi.positionedGlyphs)Fr.x+=Mi,Fr.y+=Pi})(ee.positionedLines,vi,yn,Oi,nr,ei,$e,Ct,je.length),ee.top+=-Oi*Ct,ee.bottom=ee.top+Ct,ee.left+=-yn*nr,ee.right=ee.left+nr}(V,r,s,c,te,b,w,S,R,C,j,G),!function(ee){for(const de of ee)if(de.positionedGlyphs.length!==0)return!1;return!0}(ue)&&V}const _f={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},gT={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},_T={40:!0};function Xy(o,r,s,c,f,v){if(r.imageName){const b=c[r.imageName];return b?b.displaySize[0]*r.scale*yi/v+f:0}{const b=s[r.fontStack],w=b&&b[o];return w?w.metrics.advance*r.scale+f:0}}function Yy(o,r,s,c){const f=Math.pow(o-r,2);return c?o<r?f/2:2*f:f+Math.abs(s)*s}function yT(o,r,s){let c=0;return o===10&&(c-=1e4),s&&(c+=150),o!==40&&o!==65288||(c+=50),r!==41&&r!==65289||(c+=50),c}function Jy(o,r,s,c,f,v){let b=null,w=Yy(r,s,f,v);for(const S of c){const C=Yy(r-S.x,s,f,v)+S.badness;C<=w&&(b=S,w=C)}return{index:o,x:r,priorBreak:b,badness:w}}function Qy(o){return o?Qy(o.priorBreak).concat(o.index):[]}function Mm(o,r,s,c,f,v){if(!o)return[];const b=[],w=function(R,j,$,G,W,te){let se=0;for(let ye=0;ye<R.length();ye++){const ue=R.getSection(ye);se+=Xy(R.getCharCode(ye),ue,G,W,j,te)}return se/Math.max(1,Math.ceil(se/$))}(o,r,s,c,f,v),S=o.text.indexOf("")>=0;let C=0;for(let R=0;R<o.length();R++){const j=o.getSection(R),$=o.getCharCode(R);if(_f[$]||(C+=Xy($,j,c,f,r,v)),R<o.length()-1){const G=!((A=$)<11904)&&(!!rr["CJK Compatibility Forms"](A)||!!rr["CJK Compatibility"](A)||!!rr["CJK Strokes"](A)||!!rr["CJK Symbols and Punctuation"](A)||!!rr["Enclosed CJK Letters and Months"](A)||!!rr["Halfwidth and Fullwidth Forms"](A)||!!rr["Ideographic Description Characters"](A)||!!rr["Vertical Forms"](A)||Fu.test(String.fromCodePoint(A)));(gT[$]||G||j.imageName||R!==o.length()-2&&_T[o.getCharCode(R+1)])&&b.push(Jy(R+1,C,w,b,yT($,o.getCharCode(R+1),G&&S),!1))}}var A;return Qy(Jy(o.length(),C,w,b,0,!0))}function Pm(o){let r=.5,s=.5;switch(o){case"right":case"top-right":case"bottom-right":r=1;break;case"left":case"top-left":case"bottom-left":r=0}switch(o){case"bottom":case"bottom-right":case"bottom-left":s=1;break;case"top":case"top-right":case"top-left":s=0}return{horizontalAlign:r,verticalAlign:s}}function vT(o,r,s){const c=r.getMaxScale()*yi,{maxImageWidth:f,maxImageHeight:v}=r.getMaxImageSize(o),b=Math.max(c,v*s);return{verticalLineContentWidth:Math.max(c,f*s),horizontalLineContentHeight:b}}function ev(o){switch(o){case"top":return 0;case"center":return .5;default:return 1}}function bT(o,r,s){return!(o===m.ah.horizontal||!r&&!Bu(s)||r&&(_f[s]||(c=s,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(c)))));var c}function xT(o,r,s,c,f,v){const b=v[o.fontStack],w=function(C,A,R,j){if(C&&C.rect)return C;const $=A[R.fontStack],G=$&&$[j];return G?{rect:null,metrics:G.metrics}:null}(b&&b[r],f,o,r);if(w===null)return null;let S;if(s)S=c.verticalLineContentWidth-o.scale*yi;else{const C=ev(o.verticalAlign);S=(c.horizontalLineContentHeight-o.scale*yi)*C}return{rect:w.rect,metrics:w.metrics,baselineOffset:S}}function wT(o,r,s,c,f){const v=f[o.imageName];if(!v)return null;const b=v.paddedRect,w=v.displaySize,S={width:w[0],height:w[1],left:_n,top:-3,advance:r?w[1]:w[0]};let C;if(r)C=c.verticalLineContentWidth-w[1]*o.scale;else{const A=ev(o.verticalAlign);C=(c.horizontalLineContentHeight-w[1]*o.scale)*A}return{rect:b,metrics:S,baselineOffset:C,imageOffset:(r?w[0]:w[1])*o.scale-yi*s}}function TT(o,r,s,c){if(c===0)return;const f=o[s],v=(o[s].x+f.metrics.advance*f.scale)*c;for(let b=r;b<=s;b++)o[b].x-=v}function ST(o,r,s){const{horizontalAlign:c,verticalAlign:f}=Pm(s),v=r[0]-o.displaySize[0]*c,b=r[1]-o.displaySize[1]*f;return{image:o,top:b,bottom:b+o.displaySize[1],left:v,right:v+o.displaySize[0]}}function tv(o){var r,s;let c=o.left,f=o.top,v=o.right-c,b=o.bottom-f;const w=(r=o.image.textFitWidth)!==null&&r!==void 0?r:"stretchOrShrink",S=(s=o.image.textFitHeight)!==null&&s!==void 0?s:"stretchOrShrink",C=(o.image.content[2]-o.image.content[0])/(o.image.content[3]-o.image.content[1]);if(S==="proportional"){if(w==="stretchOnly"&&v/b<C||w==="proportional"){const A=Math.ceil(b*C);c*=A/v,v=A}}else if(w==="proportional"&&S==="stretchOnly"&&C!==0&&v/b>C){const A=Math.ceil(v/C);f*=A/b,b=A}return{x1:c,y1:f,x2:c+v,y2:f+b}}function rv(o,r,s,c,f,v){const b=o.image;let w;if(b.content){const te=b.content,se=b.pixelRatio||1;w=[te[0]/se,te[1]/se,b.displaySize[0]-te[2]/se,b.displaySize[1]-te[3]/se]}const S=r.left*v,C=r.right*v;let A,R,j,$;s==="width"||s==="both"?($=f[0]+S-c[3],R=f[0]+C+c[1]):($=f[0]+(S+C-b.displaySize[0])/2,R=$+b.displaySize[0]);const G=r.top*v,W=r.bottom*v;return s==="height"||s==="both"?(A=f[1]+G-c[0],j=f[1]+W+c[2]):(A=f[1]+(G+W-b.displaySize[1])/2,j=A+b.displaySize[1]),{image:b,top:A,right:R,bottom:j,left:$,collisionPadding:w}}const uh=255,$o=128,ua=uh*$o;function iv(o,r){const{expression:s}=r;if(s.kind==="constant")return{kind:"constant",layoutSize:s.evaluate(new Dr(o+1))};if(s.kind==="source")return{kind:"source"};{const{zoomStops:c,interpolationType:f}=s;let v=0;for(;v<c.length&&c[v]<=o;)v++;v=Math.max(0,v-1);let b=v;for(;b<c.length&&c[b]<o+1;)b++;b=Math.min(c.length-1,b);const w=c[v],S=c[b];return s.kind==="composite"?{kind:"composite",minZoom:w,maxZoom:S,interpolationType:f}:{kind:"camera",minZoom:w,maxZoom:S,minSize:s.evaluate(new Dr(w)),maxSize:s.evaluate(new Dr(S)),interpolationType:f}}}function Am(o,r,s){let c="never";const f=o.get(r);return f?c=f:o.get(s)&&(c="always"),c}const ET=oh.VectorTileFeature.types,CT=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function yf(o,r,s,c,f,v,b,w,S,C,A,R,j){const $=w?Math.min(ua,Math.round(w[0])):0,G=w?Math.min(ua,Math.round(w[1])):0;o.emplaceBack(r,s,Math.round(32*c),Math.round(32*f),v,b,($<<1)+(S?1:0),G,16*C,16*A,256*R,256*j)}function km(o,r,s){o.emplaceBack(r.x,r.y,s),o.emplaceBack(r.x,r.y,s),o.emplaceBack(r.x,r.y,s),o.emplaceBack(r.x,r.y,s)}function IT(o){for(const r of o.sections)if(im(r.text))return!0;return!1}class Lm{constructor(r){this.layoutVertexArray=new Ze,this.indexArray=new Je,this.programConfigurations=r,this.segments=new Kt,this.dynamicLayoutVertexArray=new Ke,this.opacityVertexArray=new Ue,this.hasVisibleVertices=!1,this.placedSymbolArray=new D}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(r,s,c,f){this.isEmpty()||(c&&(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,sT.members),this.indexBuffer=r.createIndexBuffer(this.indexArray,s),this.dynamicLayoutVertexBuffer=r.createVertexBuffer(this.dynamicLayoutVertexArray,aT.members,!0),this.opacityVertexBuffer=r.createVertexBuffer(this.opacityVertexArray,CT,!0),this.opacityVertexBuffer.itemSize=1),(c||f)&&this.programConfigurations.upload(r))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}wt("SymbolBuffers",Lm);class zm{constructor(r,s,c){this.layoutVertexArray=new r,this.layoutAttributes=s,this.indexArray=new c,this.segments=new Kt,this.collisionVertexArray=new dt}upload(r){this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=r.createVertexBuffer(this.collisionVertexArray,lT.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}wt("CollisionBuffers",zm);class xc{constructor(r){this.collisionBoxArray=r.collisionBoxArray,this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(b=>b.id),this.index=r.index,this.pixelRatio=r.pixelRatio,this.sourceLayerIndex=r.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const s=this.layers[0]._unevaluatedLayout._values;this.textSizeData=iv(this.zoom,s["text-size"]),this.iconSizeData=iv(this.zoom,s["icon-size"]);const c=this.layers[0].layout,f=c.get("symbol-sort-key"),v=c.get("symbol-z-order");this.canOverlap=Am(c,"text-overlap","text-allow-overlap")!=="never"||Am(c,"icon-overlap","icon-allow-overlap")!=="never"||c.get("text-ignore-placement")||c.get("icon-ignore-placement"),this.sortFeaturesByKey=v!=="viewport-y"&&!f.isConstant(),this.sortFeaturesByY=(v==="viewport-y"||v==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,c.get("symbol-placement")==="point"&&(this.writingModes=c.get("text-writing-mode").map(b=>m.ah[b])),this.stateDependentLayerIds=this.layers.filter(b=>b.isStateDependent()).map(b=>b.id),this.sourceID=r.sourceID}createArrays(){this.text=new Lm(new bs(this.layers,this.zoom,r=>/^text/.test(r))),this.icon=new Lm(new bs(this.layers,this.zoom,r=>/^icon/.test(r))),this.glyphOffsetArray=new Z,this.lineVertexArray=new K,this.symbolInstances=new O,this.textAnchorOffsets=new ie}calculateGlyphDependencies(r,s,c,f,v){for(let b=0;b<r.length;b++)if(s[r.charCodeAt(b)]=!0,(c||f)&&v){const w=lh[r.charAt(b)];w&&(s[w.charCodeAt(0)]=!0)}}populate(r,s,c){const f=this.layers[0],v=f.layout,b=v.get("text-font"),w=v.get("text-field"),S=v.get("icon-image"),C=(w.value.kind!=="constant"||w.value.value instanceof Xi&&!w.value.value.isEmpty()||w.value.value.toString().length>0)&&(b.value.kind!=="constant"||b.value.value.length>0),A=S.value.kind!=="constant"||!!S.value.value||Object.keys(S.parameters).length>0,R=v.get("symbol-sort-key");if(this.features=[],!C&&!A)return;const j=s.iconDependencies,$=s.glyphDependencies,G=s.availableImages,W=new Dr(this.zoom);for(const{feature:te,id:se,index:ye,sourceLayerIndex:ue}of r){const V=f._featureFilter.needGeometry,ee=Vo(te,V);if(!f._featureFilter.filter(W,ee,c))continue;let de,Fe;if(V||(ee.geometry=No(te)),C){const je=f.getValueAndResolveTokens("text-field",ee,c,G),$e=Xi.factory(je),ot=this.hasRTLText=this.hasRTLText||IT($e);(!ot||mo.getRTLTextPluginStatus()==="unavailable"||ot&&mo.isParsed())&&(de=uT($e,f,ee))}if(A){const je=f.getValueAndResolveTokens("icon-image",ee,c,G);Fe=je instanceof sn?je:sn.fromString(je)}if(!de&&!Fe)continue;const et=this.sortFeaturesByKey?R.evaluate(ee,{},c):void 0;if(this.features.push({id:se,text:de,icon:Fe,index:ye,sourceLayerIndex:ue,geometry:ee.geometry,properties:te.properties,type:ET[te.type],sortKey:et}),Fe&&(j[Fe.name]=!0),de){const je=b.evaluate(ee,{},c).join(","),$e=v.get("text-rotation-alignment")!=="viewport"&&v.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(m.ah.vertical)>=0;for(const ot of de.sections)if(ot.image)j[ot.image.name]=!0;else{const tt=lc(de.toString()),ct=ot.fontStack||je,qe=$[ct]=$[ct]||{};this.calculateGlyphDependencies(ot.text,qe,$e,this.allowVerticalPlacement,tt)}}}v.get("symbol-placement")==="line"&&(this.features=function(te){const se={},ye={},ue=[];let V=0;function ee(je){ue.push(te[je]),V++}function de(je,$e,ot){const tt=ye[je];return delete ye[je],ye[$e]=tt,ue[tt].geometry[0].pop(),ue[tt].geometry[0]=ue[tt].geometry[0].concat(ot[0]),tt}function Fe(je,$e,ot){const tt=se[$e];return delete se[$e],se[je]=tt,ue[tt].geometry[0].shift(),ue[tt].geometry[0]=ot[0].concat(ue[tt].geometry[0]),tt}function et(je,$e,ot){const tt=ot?$e[0][$e[0].length-1]:$e[0][0];return`${je}:${tt.x}:${tt.y}`}for(let je=0;je<te.length;je++){const $e=te[je],ot=$e.geometry,tt=$e.text?$e.text.toString():null;if(!tt){ee(je);continue}const ct=et(tt,ot),qe=et(tt,ot,!0);if(ct in ye&&qe in se&&ye[ct]!==se[qe]){const Tt=Fe(ct,qe,ot),zt=de(ct,qe,ue[Tt].geometry);delete se[ct],delete ye[qe],ye[et(tt,ue[zt].geometry,!0)]=zt,ue[Tt].geometry=null}else ct in ye?de(ct,qe,ot):qe in se?Fe(ct,qe,ot):(ee(je),se[ct]=V-1,ye[qe]=V-1)}return ue.filter(je=>je.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((te,se)=>te.sortKey-se.sortKey)}update(r,s,c){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(r,s,this.layers,c),this.icon.programConfigurations.updatePaintArrays(r,s,this.layers,c))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(r){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(r),this.iconCollisionBox.upload(r)),this.text.upload(r,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(r,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(r,s){const c=this.lineVertexArray.length;if(r.segment!==void 0){let f=r.dist(s[r.segment+1]),v=r.dist(s[r.segment]);const b={};for(let w=r.segment+1;w<s.length;w++)b[w]={x:s[w].x,y:s[w].y,tileUnitDistanceFromAnchor:f},w<s.length-1&&(f+=s[w+1].dist(s[w]));for(let w=r.segment||0;w>=0;w--)b[w]={x:s[w].x,y:s[w].y,tileUnitDistanceFromAnchor:v},w>0&&(v+=s[w-1].dist(s[w]));for(let w=0;w<s.length;w++){const S=b[w];this.lineVertexArray.emplaceBack(S.x,S.y,S.tileUnitDistanceFromAnchor)}}return{lineStartIndex:c,lineLength:this.lineVertexArray.length-c}}addSymbols(r,s,c,f,v,b,w,S,C,A,R,j){const $=r.indexArray,G=r.layoutVertexArray,W=r.segments.prepareSegment(4*s.length,G,$,this.canOverlap?b.sortKey:void 0),te=this.glyphOffsetArray.length,se=W.vertexLength,ye=this.allowVerticalPlacement&&w===m.ah.vertical?Math.PI/2:0,ue=b.text&&b.text.sections;for(let V=0;V<s.length;V++){const{tl:ee,tr:de,bl:Fe,br:et,tex:je,pixelOffsetTL:$e,pixelOffsetBR:ot,minFontScaleX:tt,minFontScaleY:ct,glyphOffset:qe,isSDF:Tt,sectionIndex:zt}=s[V],At=W.vertexLength,Ct=qe[1];yf(G,S.x,S.y,ee.x,Ct+ee.y,je.x,je.y,c,Tt,$e.x,$e.y,tt,ct),yf(G,S.x,S.y,de.x,Ct+de.y,je.x+je.w,je.y,c,Tt,ot.x,$e.y,tt,ct),yf(G,S.x,S.y,Fe.x,Ct+Fe.y,je.x,je.y+je.h,c,Tt,$e.x,ot.y,tt,ct),yf(G,S.x,S.y,et.x,Ct+et.y,je.x+je.w,je.y+je.h,c,Tt,ot.x,ot.y,tt,ct),km(r.dynamicLayoutVertexArray,S,ye),$.emplaceBack(At,At+2,At+1),$.emplaceBack(At+1,At+2,At+3),W.vertexLength+=4,W.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(qe[0]),V!==s.length-1&&zt===s[V+1].sectionIndex||r.programConfigurations.populatePaintArrays(G.length,b,b.index,{},j,ue&&ue[zt])}r.placedSymbolArray.emplaceBack(S.x,S.y,te,this.glyphOffsetArray.length-te,se,C,A,S.segment,c?c[0]:0,c?c[1]:0,f[0],f[1],w,0,!1,0,R)}_addCollisionDebugVertex(r,s,c,f,v,b){return s.emplaceBack(0,0),r.emplaceBack(c.x,c.y,f,v,Math.round(b.x),Math.round(b.y))}addCollisionDebugVertices(r,s,c,f,v,b,w){const S=v.segments.prepareSegment(4,v.layoutVertexArray,v.indexArray),C=S.vertexLength,A=v.layoutVertexArray,R=v.collisionVertexArray,j=w.anchorX,$=w.anchorY;this._addCollisionDebugVertex(A,R,b,j,$,new H(r,s)),this._addCollisionDebugVertex(A,R,b,j,$,new H(c,s)),this._addCollisionDebugVertex(A,R,b,j,$,new H(c,f)),this._addCollisionDebugVertex(A,R,b,j,$,new H(r,f)),S.vertexLength+=4;const G=v.indexArray;G.emplaceBack(C,C+1),G.emplaceBack(C+1,C+2),G.emplaceBack(C+2,C+3),G.emplaceBack(C+3,C),S.primitiveLength+=4}addDebugCollisionBoxes(r,s,c,f){for(let v=r;v<s;v++){const b=this.collisionBoxArray.get(v);this.addCollisionDebugVertices(b.x1,b.y1,b.x2,b.y2,f?this.textCollisionBox:this.iconCollisionBox,b.anchorPoint,c)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new zm(ft,Gy.members,Et),this.iconCollisionBox=new zm(ft,Gy.members,Et);for(let r=0;r<this.symbolInstances.length;r++){const s=this.symbolInstances.get(r);this.addDebugCollisionBoxes(s.textBoxStartIndex,s.textBoxEndIndex,s,!0),this.addDebugCollisionBoxes(s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s,!0),this.addDebugCollisionBoxes(s.iconBoxStartIndex,s.iconBoxEndIndex,s,!1),this.addDebugCollisionBoxes(s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex,s,!1)}}_deserializeCollisionBoxesForSymbol(r,s,c,f,v,b,w,S,C){const A={};for(let R=s;R<c;R++){const j=r.get(R);A.textBox={x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,anchorPointX:j.anchorPointX,anchorPointY:j.anchorPointY},A.textFeatureIndex=j.featureIndex;break}for(let R=f;R<v;R++){const j=r.get(R);A.verticalTextBox={x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,anchorPointX:j.anchorPointX,anchorPointY:j.anchorPointY},A.verticalTextFeatureIndex=j.featureIndex;break}for(let R=b;R<w;R++){const j=r.get(R);A.iconBox={x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,anchorPointX:j.anchorPointX,anchorPointY:j.anchorPointY},A.iconFeatureIndex=j.featureIndex;break}for(let R=S;R<C;R++){const j=r.get(R);A.verticalIconBox={x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,anchorPointX:j.anchorPointX,anchorPointY:j.anchorPointY},A.verticalIconFeatureIndex=j.featureIndex;break}return A}deserializeCollisionBoxes(r){this.collisionArrays=[];for(let s=0;s<this.symbolInstances.length;s++){const c=this.symbolInstances.get(s);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(r,c.textBoxStartIndex,c.textBoxEndIndex,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c.iconBoxStartIndex,c.iconBoxEndIndex,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(r,s){const c=r.placedSymbolArray.get(s),f=c.vertexStartIndex+4*c.numGlyphs;for(let v=c.vertexStartIndex;v<f;v+=4)r.indexArray.emplaceBack(v,v+2,v+1),r.indexArray.emplaceBack(v+1,v+2,v+3)}getSortedSymbolIndexes(r){if(this.sortedAngle===r&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const s=Math.sin(r),c=Math.cos(r),f=[],v=[],b=[];for(let w=0;w<this.symbolInstances.length;++w){b.push(w);const S=this.symbolInstances.get(w);f.push(0|Math.round(s*S.anchorX+c*S.anchorY)),v.push(S.featureIndex)}return b.sort((w,S)=>f[w]-f[S]||v[S]-v[w]),b}addToSortKeyRanges(r,s){const c=this.sortKeyRanges[this.sortKeyRanges.length-1];c&&c.sortKey===s?c.symbolInstanceEnd=r+1:this.sortKeyRanges.push({sortKey:s,symbolInstanceStart:r,symbolInstanceEnd:r+1})}sortFeatures(r){if(this.sortFeaturesByY&&this.sortedAngle!==r&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(r),this.sortedAngle=r,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const s of this.symbolInstanceIndexes){const c=this.symbolInstances.get(s);this.featureSortOrder.push(c.featureIndex),[c.rightJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.leftJustifiedTextSymbolIndex].forEach((f,v,b)=>{f>=0&&b.indexOf(f)===v&&this.addIndicesForPlacedSymbol(this.text,f)}),c.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,c.verticalPlacedTextSymbolIndex),c.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,c.placedIconSymbolIndex),c.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,c.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let nv,ov;wt("SymbolBucket",xc,{omit:["layers","collisionBoxArray","features","compareText"]}),xc.MAX_GLYPHS=65535,xc.addDynamicAttributes=km;var Rm={get paint(){return ov=ov||new cn({"icon-opacity":new Dt(U.paint_symbol["icon-opacity"]),"icon-color":new Dt(U.paint_symbol["icon-color"]),"icon-halo-color":new Dt(U.paint_symbol["icon-halo-color"]),"icon-halo-width":new Dt(U.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Dt(U.paint_symbol["icon-halo-blur"]),"icon-translate":new Mt(U.paint_symbol["icon-translate"]),"icon-translate-anchor":new Mt(U.paint_symbol["icon-translate-anchor"]),"text-opacity":new Dt(U.paint_symbol["text-opacity"]),"text-color":new Dt(U.paint_symbol["text-color"],{runtimeType:Ut,getOverride:o=>o.textColor,hasOverride:o=>!!o.textColor}),"text-halo-color":new Dt(U.paint_symbol["text-halo-color"]),"text-halo-width":new Dt(U.paint_symbol["text-halo-width"]),"text-halo-blur":new Dt(U.paint_symbol["text-halo-blur"]),"text-translate":new Mt(U.paint_symbol["text-translate"]),"text-translate-anchor":new Mt(U.paint_symbol["text-translate-anchor"])})},get layout(){return nv=nv||new cn({"symbol-placement":new Mt(U.layout_symbol["symbol-placement"]),"symbol-spacing":new Mt(U.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Mt(U.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Dt(U.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Mt(U.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Mt(U.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Mt(U.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Mt(U.layout_symbol["icon-ignore-placement"]),"icon-optional":new Mt(U.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Mt(U.layout_symbol["icon-rotation-alignment"]),"icon-size":new Dt(U.layout_symbol["icon-size"]),"icon-text-fit":new Mt(U.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Mt(U.layout_symbol["icon-text-fit-padding"]),"icon-image":new Dt(U.layout_symbol["icon-image"]),"icon-rotate":new Dt(U.layout_symbol["icon-rotate"]),"icon-padding":new Dt(U.layout_symbol["icon-padding"]),"icon-keep-upright":new Mt(U.layout_symbol["icon-keep-upright"]),"icon-offset":new Dt(U.layout_symbol["icon-offset"]),"icon-anchor":new Dt(U.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Mt(U.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Mt(U.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Mt(U.layout_symbol["text-rotation-alignment"]),"text-field":new Dt(U.layout_symbol["text-field"]),"text-font":new Dt(U.layout_symbol["text-font"]),"text-size":new Dt(U.layout_symbol["text-size"]),"text-max-width":new Dt(U.layout_symbol["text-max-width"]),"text-line-height":new Mt(U.layout_symbol["text-line-height"]),"text-letter-spacing":new Dt(U.layout_symbol["text-letter-spacing"]),"text-justify":new Dt(U.layout_symbol["text-justify"]),"text-radial-offset":new Dt(U.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Mt(U.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Dt(U.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Dt(U.layout_symbol["text-anchor"]),"text-max-angle":new Mt(U.layout_symbol["text-max-angle"]),"text-writing-mode":new Mt(U.layout_symbol["text-writing-mode"]),"text-rotate":new Dt(U.layout_symbol["text-rotate"]),"text-padding":new Mt(U.layout_symbol["text-padding"]),"text-keep-upright":new Mt(U.layout_symbol["text-keep-upright"]),"text-transform":new Dt(U.layout_symbol["text-transform"]),"text-offset":new Dt(U.layout_symbol["text-offset"]),"text-allow-overlap":new Mt(U.layout_symbol["text-allow-overlap"]),"text-overlap":new Mt(U.layout_symbol["text-overlap"]),"text-ignore-placement":new Mt(U.layout_symbol["text-ignore-placement"]),"text-optional":new Mt(U.layout_symbol["text-optional"])})}};class sv{constructor(r){if(r.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=r.property.overrides?r.property.overrides.runtimeType:ar,this.defaultValue=r}evaluate(r){if(r.formattedSection){const s=this.defaultValue.property.overrides;if(s&&s.hasOverride(r.formattedSection))return s.getOverride(r.formattedSection)}return r.feature&&r.featureState?this.defaultValue.evaluate(r.feature,r.featureState):this.defaultValue.property.specification.default}eachChild(r){this.defaultValue.isConstant()||r(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}wt("FormatSectionOverride",sv,{omit:["defaultValue"]});class vf extends Ji{constructor(r){super(r,Rm)}recalculate(r,s){if(super.recalculate(r,s),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const c=this.layout.get("text-writing-mode");if(c){const f=[];for(const v of c)f.indexOf(v)<0&&f.push(v);this.layout._values["text-writing-mode"]=f}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(r,s,c,f){const v=this.layout.get(r).evaluate(s,{},c,f),b=this._unevaluatedLayout._values[r];return b.isDataDriven()||Za(b.value)||!v?v:function(w,S){return S.replace(/{([^{}]+)}/g,(C,A)=>w&&A in w?String(w[A]):"")}(s.properties,v)}createBucket(r){return new xc(r)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const r of Rm.paint.overridableProperties){if(!vf.hasPaintOverride(this.layout,r))continue;const s=this.paint.get(r),c=new sv(s),f=new Qs(c,s.property.specification);let v=null;v=s.value.kind==="constant"||s.value.kind==="source"?new Eu("source",f):new Cu("composite",f,s.value.zoomStops),this.paint._values[r]=new Yn(s.property,v,s.parameters)}}_handleOverridablePaintPropertyUpdate(r,s,c){return!(!this.layout||s.isDataDriven()||c.isDataDriven())&&vf.hasPaintOverride(this.layout,r)}static hasPaintOverride(r,s){const c=r.get("text-field"),f=Rm.paint.properties[s];let v=!1;const b=w=>{for(const S of w)if(f.overrides&&f.overrides.hasOverride(S))return void(v=!0)};if(c.value.kind==="constant"&&c.value.value instanceof Xi)b(c.value.value.sections);else if(c.value.kind==="source"){const w=C=>{v||(C instanceof Ro&&Nr(C.value)===zr?b(C.value.sections):C instanceof qs?b(C.sections):C.eachChild(w))},S=c.value;S._styleExpression&&w(S._styleExpression.expression)}return v}}let av;var MT={get paint(){return av=av||new cn({"background-color":new Mt(U.paint_background["background-color"]),"background-pattern":new Vu(U.paint_background["background-pattern"]),"background-opacity":new Mt(U.paint_background["background-opacity"])})}};class PT extends Ji{constructor(r){super(r,MT)}}let lv;var AT={get paint(){return lv=lv||new cn({"raster-opacity":new Mt(U.paint_raster["raster-opacity"]),"raster-hue-rotate":new Mt(U.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Mt(U.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Mt(U.paint_raster["raster-brightness-max"]),"raster-saturation":new Mt(U.paint_raster["raster-saturation"]),"raster-contrast":new Mt(U.paint_raster["raster-contrast"]),"raster-resampling":new Mt(U.paint_raster["raster-resampling"]),"raster-fade-duration":new Mt(U.paint_raster["raster-fade-duration"])})}};class kT extends Ji{constructor(r){super(r,AT)}}class LT extends Ji{constructor(r){super(r,{}),this.onAdd=s=>{this.implementation.onAdd&&this.implementation.onAdd(s,s.painter.context.gl)},this.onRemove=s=>{this.implementation.onRemove&&this.implementation.onRemove(s,s.painter.context.gl)},this.implementation=r}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class zT{constructor(r){this._methodToThrottle=r,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const RT={once:!0},Dm=63710088e-1;class ha{constructor(r,s){if(isNaN(r)||isNaN(s))throw new Error(`Invalid LngLat object: (${r}, ${s})`);if(this.lng=+r,this.lat=+s,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new ha(Lr(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(r){const s=Math.PI/180,c=this.lat*s,f=r.lat*s,v=Math.sin(c)*Math.sin(f)+Math.cos(c)*Math.cos(f)*Math.cos((r.lng-this.lng)*s);return Dm*Math.acos(Math.min(v,1))}static convert(r){if(r instanceof ha)return r;if(Array.isArray(r)&&(r.length===2||r.length===3))return new ha(Number(r[0]),Number(r[1]));if(!Array.isArray(r)&&typeof r=="object"&&r!==null)return new ha(Number("lng"in r?r.lng:r.lon),Number(r.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const cv=2*Math.PI*Dm;function uv(o){return cv*Math.cos(o*Math.PI/180)}function hv(o){return(180+o)/360}function dv(o){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o*Math.PI/360)))/360}function fv(o,r){return o/uv(r)}function Om(o){return 360/Math.PI*Math.atan(Math.exp((180-360*o)*Math.PI/180))-90}function pv(o,r){return o*uv(Om(r))}class hh{constructor(r,s,c=0){this.x=+r,this.y=+s,this.z=+c}static fromLngLat(r,s=0){const c=ha.convert(r);return new hh(hv(c.lng),dv(c.lat),fv(s,c.lat))}toLngLat(){return new ha(360*this.x-180,Om(this.y))}toAltitude(){return pv(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/cv*(r=Om(this.y),1/Math.cos(r*Math.PI/180));var r}}function mv(o,r,s){var c=2*Math.PI*6378137/256/Math.pow(2,s);return[o*c-2*Math.PI*6378137/2,r*c-2*Math.PI*6378137/2]}class Fm{constructor(r,s,c){if(!function(f,v,b){return!(f<0||f>25||b<0||b>=Math.pow(2,f)||v<0||v>=Math.pow(2,f))}(r,s,c))throw new Error(`x=${s}, y=${c}, z=${r} outside of bounds. 0<=x<${Math.pow(2,r)}, 0<=y<${Math.pow(2,r)} 0<=z<=25 `);this.z=r,this.x=s,this.y=c,this.key=wc(0,r,r,s,c)}equals(r){return this.z===r.z&&this.x===r.x&&this.y===r.y}url(r,s,c){const f=(b=this.y,w=this.z,S=mv(256*(v=this.x),256*(b=Math.pow(2,w)-b-1),w),C=mv(256*(v+1),256*(b+1),w),S[0]+","+S[1]+","+C[0]+","+C[1]);var v,b,w,S,C;const A=function(R,j,$){let G,W="";for(let te=R;te>0;te--)G=1<<te-1,W+=(j&G?1:0)+($&G?2:0);return W}(this.z,this.x,this.y);return r[(this.x+this.y)%r.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(c==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,s>1?"@2x":"").replace(/{quadkey}/g,A).replace(/{bbox-epsg-3857}/g,f)}isChildOf(r){const s=this.z-r.z;return s>0&&r.x===this.x>>s&&r.y===this.y>>s}getTilePoint(r){const s=Math.pow(2,this.z);return new H((r.x*s-this.x)*Xe,(r.y*s-this.y)*Xe)}toString(){return`${this.z}/${this.x}/${this.y}`}}class gv{constructor(r,s){this.wrap=r,this.canonical=s,this.key=wc(r,s.z,s.z,s.x,s.y)}}class Dn{constructor(r,s,c,f,v){if(this.terrainRttPosMatrix32f=null,r<c)throw new Error(`overscaledZ should be >= z; overscaledZ = ${r}; z = ${c}`);this.overscaledZ=r,this.wrap=s,this.canonical=new Fm(c,+f,+v),this.key=wc(s,r,c,f,v)}clone(){return new Dn(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(r){return this.overscaledZ===r.overscaledZ&&this.wrap===r.wrap&&this.canonical.equals(r.canonical)}scaledTo(r){if(r>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${r}; overscaledZ = ${this.overscaledZ}`);const s=this.canonical.z-r;return r>this.canonical.z?new Dn(r,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Dn(r,this.wrap,r,this.canonical.x>>s,this.canonical.y>>s)}calculateScaledKey(r,s){if(r>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${r}; overscaledZ = ${this.overscaledZ}`);const c=this.canonical.z-r;return r>this.canonical.z?wc(this.wrap*+s,r,this.canonical.z,this.canonical.x,this.canonical.y):wc(this.wrap*+s,r,r,this.canonical.x>>c,this.canonical.y>>c)}isChildOf(r){if(r.wrap!==this.wrap)return!1;const s=this.canonical.z-r.canonical.z;return r.overscaledZ===0||r.overscaledZ<this.overscaledZ&&r.canonical.x===this.canonical.x>>s&&r.canonical.y===this.canonical.y>>s}children(r){if(this.overscaledZ>=r)return[new Dn(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const s=this.canonical.z+1,c=2*this.canonical.x,f=2*this.canonical.y;return[new Dn(s,this.wrap,s,c,f),new Dn(s,this.wrap,s,c+1,f),new Dn(s,this.wrap,s,c,f+1),new Dn(s,this.wrap,s,c+1,f+1)]}isLessThan(r){return this.wrap<r.wrap||!(this.wrap>r.wrap)&&(this.overscaledZ<r.overscaledZ||!(this.overscaledZ>r.overscaledZ)&&(this.canonical.x<r.canonical.x||!(this.canonical.x>r.canonical.x)&&this.canonical.y<r.canonical.y))}wrapped(){return new Dn(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(r){return new Dn(this.overscaledZ,r,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new gv(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(r){return this.canonical.getTilePoint(new hh(r.x-this.wrap,r.y))}}function wc(o,r,s,c,f){(o*=2)<0&&(o=-1*o-1);const v=1<<s;return(v*v*o+v*f+c).toString(36)+s.toString(36)+r.toString(36)}wt("CanonicalTileID",Fm),wt("OverscaledTileID",Dn,{omit:["terrainRttPosMatrix32f"]});class _v{constructor(r,s,c,f=1,v=1,b=1,w=0){if(this.uid=r,s.height!==s.width)throw new RangeError("DEM tiles must be square");if(c&&!["mapbox","terrarium","custom"].includes(c))return void Pr(`"${c}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=s.height;const S=this.dim=s.height-2;switch(this.data=new Uint32Array(s.data.buffer),c){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=f,this.greenFactor=v,this.blueFactor=b,this.baseShift=w;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let C=0;C<S;C++)this.data[this._idx(-1,C)]=this.data[this._idx(0,C)],this.data[this._idx(S,C)]=this.data[this._idx(S-1,C)],this.data[this._idx(C,-1)]=this.data[this._idx(C,0)],this.data[this._idx(C,S)]=this.data[this._idx(C,S-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(S,-1)]=this.data[this._idx(S-1,0)],this.data[this._idx(-1,S)]=this.data[this._idx(0,S-1)],this.data[this._idx(S,S)]=this.data[this._idx(S-1,S-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let C=0;C<S;C++)for(let A=0;A<S;A++){const R=this.get(C,A);R>this.max&&(this.max=R),R<this.min&&(this.min=R)}}get(r,s){const c=new Uint8Array(this.data.buffer),f=4*this._idx(r,s);return this.unpack(c[f],c[f+1],c[f+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(r,s){if(r<-1||r>=this.dim+1||s<-1||s>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(s+1)*this.stride+(r+1)}unpack(r,s,c){return r*this.redFactor+s*this.greenFactor+c*this.blueFactor-this.baseShift}getPixels(){return new Rn({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(r,s,c){if(this.dim!==r.dim)throw new Error("dem dimension mismatch");let f=s*this.dim,v=s*this.dim+this.dim,b=c*this.dim,w=c*this.dim+this.dim;switch(s){case-1:f=v-1;break;case 1:v=f+1}switch(c){case-1:b=w-1;break;case 1:w=b+1}const S=-s*this.dim,C=-c*this.dim;for(let A=b;A<w;A++)for(let R=f;R<v;R++)this.data[this._idx(R,A)]=r.data[this._idx(R+S,A+C)]}}wt("DEMData",_v);class yv{constructor(r){this._stringToNumber={},this._numberToString=[];for(let s=0;s<r.length;s++){const c=r[s];this._stringToNumber[c]=s,this._numberToString[s]=c}}encode(r){return this._stringToNumber[r]}decode(r){if(r>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${r} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[r]}}class vv{constructor(r,s,c,f,v){this.type="Feature",this._vectorTileFeature=r,r._z=s,r._x=c,r._y=f,this.properties=r.properties,this.id=v}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(r){this._geometry=r}toJSON(){const r={geometry:this.geometry};for(const s in this)s!=="_geometry"&&s!=="_vectorTileFeature"&&(r[s]=this[s]);return r}}class bv{constructor(r,s){this.tileID=r,this.x=r.canonical.x,this.y=r.canonical.y,this.z=r.canonical.z,this.grid=new Ka(Xe,16,0),this.grid3D=new Ka(Xe,16,0),this.featureIndexArray=new ce,this.promoteId=s}insert(r,s,c,f,v,b){const w=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(c,f,v);const S=b?this.grid3D:this.grid;for(let C=0;C<s.length;C++){const A=s[C],R=[1/0,1/0,-1/0,-1/0];for(let j=0;j<A.length;j++){const $=A[j];R[0]=Math.min(R[0],$.x),R[1]=Math.min(R[1],$.y),R[2]=Math.max(R[2],$.x),R[3]=Math.max(R[3],$.y)}R[0]<Xe&&R[1]<Xe&&R[2]>=0&&R[3]>=0&&S.insert(w,R[0],R[1],R[2],R[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new oh.VectorTile(new Em(this.rawTileData)).layers,this.sourceLayerCoder=new yv(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(r,s,c,f){this.loadVTLayers();const v=r.params,b=Xe/r.tileSize/r.scale,w=Iu(v.filter),S=r.queryGeometry,C=r.queryPadding*b,A=wv(S),R=this.grid.query(A.minX-C,A.minY-C,A.maxX+C,A.maxY+C),j=wv(r.cameraQueryGeometry),$=this.grid3D.query(j.minX-C,j.minY-C,j.maxX+C,j.maxY+C,(te,se,ye,ue)=>function(V,ee,de,Fe,et){for(const $e of V)if(ee<=$e.x&&de<=$e.y&&Fe>=$e.x&&et>=$e.y)return!0;const je=[new H(ee,de),new H(ee,et),new H(Fe,et),new H(Fe,de)];if(V.length>2){for(const $e of je)if(nl(V,$e))return!0}for(let $e=0;$e<V.length-1;$e++)if(w2(V[$e],V[$e+1],je))return!0;return!1}(r.cameraQueryGeometry,te-C,se-C,ye+C,ue+C));for(const te of $)R.push(te);R.sort(DT);const G={};let W;for(let te=0;te<R.length;te++){const se=R[te];if(se===W)continue;W=se;const ye=this.featureIndexArray.get(se);let ue=null;this.loadMatchingFeature(G,ye.bucketIndex,ye.sourceLayerIndex,ye.featureIndex,w,v.layers,v.availableImages,s,c,f,(V,ee,de)=>(ue||(ue=No(V)),ee.queryIntersectsFeature({queryGeometry:S,feature:V,featureState:de,geometry:ue,zoom:this.z,transform:r.transform,pixelsToTileUnits:b,pixelPosMatrix:r.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:r.getElevation})))}return G}loadMatchingFeature(r,s,c,f,v,b,w,S,C,A,R){const j=this.bucketLayerIDs[s];if(b&&!j.some(te=>b.has(te)))return;const $=this.sourceLayerCoder.decode(c),G=this.vtLayers[$].feature(f);if(v.needGeometry){const te=Vo(G,!0);if(!v.filter(new Dr(this.tileID.overscaledZ),te,this.tileID.canonical))return}else if(!v.filter(new Dr(this.tileID.overscaledZ),G))return;const W=this.getId(G,$);for(let te=0;te<j.length;te++){const se=j[te];if(b&&!b.has(se))continue;const ye=S[se];if(!ye)continue;let ue={};W&&A&&(ue=A.getState(ye.sourceLayer||"_geojsonTileLayer",W));const V=Pt({},C[se]);V.paint=xv(V.paint,ye.paint,G,ue,w),V.layout=xv(V.layout,ye.layout,G,ue,w);const ee=!R||R(G,ye,ue);if(!ee)continue;const de=new vv(G,this.z,this.x,this.y,W);de.layer=V;let Fe=r[se];Fe===void 0&&(Fe=r[se]=[]),Fe.push({featureIndex:f,feature:de,intersectionZ:ee})}}lookupSymbolFeatures(r,s,c,f,v,b,w,S){const C={};this.loadVTLayers();const A=Iu(v);for(const R of r)this.loadMatchingFeature(C,c,f,R,A,b,w,S,s);return C}hasLayer(r){for(const s of this.bucketLayerIDs)for(const c of s)if(r===c)return!0;return!1}getId(r,s){var c;let f=r.id;return this.promoteId&&(f=r.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[s]],typeof f=="boolean"&&(f=Number(f)),f===void 0&&(!((c=r.properties)===null||c===void 0)&&c.cluster)&&this.promoteId&&(f=Number(r.properties.cluster_id))),f}}function xv(o,r,s,c,f){return Jt(o,(v,b)=>{const w=r instanceof Qa?r.get(b):null;return w&&w.evaluate?w.evaluate(s,c,f):w})}function wv(o){let r=1/0,s=1/0,c=-1/0,f=-1/0;for(const v of o)r=Math.min(r,v.x),s=Math.min(s,v.y),c=Math.max(c,v.x),f=Math.max(f,v.y);return{minX:r,minY:s,maxX:c,maxY:f}}function DT(o,r){return r-o}function Tv(o,r,s,c,f){const v=[];for(let b=0;b<o.length;b++){const w=o[b];let S;for(let C=0;C<w.length-1;C++){let A=w[C],R=w[C+1];A.x<r&&R.x<r||(A.x<r?A=new H(r,A.y+(r-A.x)/(R.x-A.x)*(R.y-A.y))._round():R.x<r&&(R=new H(r,A.y+(r-A.x)/(R.x-A.x)*(R.y-A.y))._round()),A.y<s&&R.y<s||(A.y<s?A=new H(A.x+(s-A.y)/(R.y-A.y)*(R.x-A.x),s)._round():R.y<s&&(R=new H(A.x+(s-A.y)/(R.y-A.y)*(R.x-A.x),s)._round()),A.x>=c&&R.x>=c||(A.x>=c?A=new H(c,A.y+(c-A.x)/(R.x-A.x)*(R.y-A.y))._round():R.x>=c&&(R=new H(c,A.y+(c-A.x)/(R.x-A.x)*(R.y-A.y))._round()),A.y>=f&&R.y>=f||(A.y>=f?A=new H(A.x+(f-A.y)/(R.y-A.y)*(R.x-A.x),f)._round():R.y>=f&&(R=new H(A.x+(f-A.y)/(R.y-A.y)*(R.x-A.x),f)._round()),S&&A.equals(S[S.length-1])||(S=[A],v.push(S)),S.push(R)))))}}return v}wt("FeatureIndex",bv,{omit:["rawTileData","sourceLayerCoder"]});class da extends H{constructor(r,s,c,f){super(r,s),this.angle=c,f!==void 0&&(this.segment=f)}clone(){return new da(this.x,this.y,this.angle,this.segment)}}function Sv(o,r,s,c,f){if(r.segment===void 0||s===0)return!0;let v=r,b=r.segment+1,w=0;for(;w>-s/2;){if(b--,b<0)return!1;w-=o[b].dist(v),v=o[b]}w+=o[b].dist(o[b+1]),b++;const S=[];let C=0;for(;w<s/2;){const A=o[b],R=o[b+1];if(!R)return!1;let j=o[b-1].angleTo(A)-A.angleTo(R);for(j=Math.abs((j+3*Math.PI)%(2*Math.PI)-Math.PI),S.push({distance:w,angleDelta:j}),C+=j;w-S[0].distance>c;)C-=S.shift().angleDelta;if(C>f)return!1;b++,w+=A.dist(R)}return!0}function Ev(o){let r=0;for(let s=0;s<o.length-1;s++)r+=o[s].dist(o[s+1]);return r}function Cv(o,r,s){return o?.6*r*s:0}function Iv(o,r){return Math.max(o?o.right-o.left:0,r?r.right-r.left:0)}function OT(o,r,s,c,f,v){const b=Cv(s,f,v),w=Iv(s,c)*v;let S=0;const C=Ev(o)/2;for(let A=0;A<o.length-1;A++){const R=o[A],j=o[A+1],$=R.dist(j);if(S+$>C){const G=(C-S)/$,W=Ln.number(R.x,j.x,G),te=Ln.number(R.y,j.y,G),se=new da(W,te,j.angleTo(R),A);return se._round(),!b||Sv(o,se,w,b,r)?se:void 0}S+=$}}function FT(o,r,s,c,f,v,b,w,S){const C=Cv(c,v,b),A=Iv(c,f),R=A*b,j=o[0].x===0||o[0].x===S||o[0].y===0||o[0].y===S;return r-R<r/4&&(r=R+r/4),Mv(o,j?r/2*w%r:(A/2+2*v)*b*w%r,r,C,s,R,j,!1,S)}function Mv(o,r,s,c,f,v,b,w,S){const C=v/2,A=Ev(o);let R=0,j=r-s,$=[];for(let G=0;G<o.length-1;G++){const W=o[G],te=o[G+1],se=W.dist(te),ye=te.angleTo(W);for(;j+s<R+se;){j+=s;const ue=(j-R)/se,V=Ln.number(W.x,te.x,ue),ee=Ln.number(W.y,te.y,ue);if(V>=0&&V<S&&ee>=0&&ee<S&&j-C>=0&&j+C<=A){const de=new da(V,ee,ye,G);de._round(),c&&!Sv(o,de,v,c,f)||$.push(de)}}R+=se}return w||$.length||b||($=Mv(o,R/2,s,c,f,v,b,!0,S)),$}wt("Anchor",da);const dh=_n;function Pv(o,r,s,c){const f=[],v=o.image,b=v.pixelRatio,w=v.paddedRect.w-2*dh,S=v.paddedRect.h-2*dh;let C={x1:o.left,y1:o.top,x2:o.right,y2:o.bottom};const A=v.stretchX||[[0,w]],R=v.stretchY||[[0,S]],j=(qe,Tt)=>qe+Tt[1]-Tt[0],$=A.reduce(j,0),G=R.reduce(j,0),W=w-$,te=S-G;let se=0,ye=$,ue=0,V=G,ee=0,de=W,Fe=0,et=te;if(v.content&&c){const qe=v.content,Tt=qe[2]-qe[0],zt=qe[3]-qe[1];(v.textFitWidth||v.textFitHeight)&&(C=tv(o)),se=bf(A,0,qe[0]),ue=bf(R,0,qe[1]),ye=bf(A,qe[0],qe[2]),V=bf(R,qe[1],qe[3]),ee=qe[0]-se,Fe=qe[1]-ue,de=Tt-ye,et=zt-V}const je=C.x1,$e=C.y1,ot=C.x2-je,tt=C.y2-$e,ct=(qe,Tt,zt,At)=>{const Ct=xf(qe.stretch-se,ye,ot,je),nr=wf(qe.fixed-ee,de,qe.stretch,$),ei=xf(Tt.stretch-ue,V,tt,$e),vi=wf(Tt.fixed-Fe,et,Tt.stretch,G),Gi=xf(zt.stretch-se,ye,ot,je),On=wf(zt.fixed-ee,de,zt.stretch,$),yn=xf(At.stretch-ue,V,tt,$e),Oi=wf(At.fixed-Fe,et,At.stretch,G),Zr=new H(Ct,ei),Ci=new H(Gi,ei),Fi=new H(Gi,yn),Bi=new H(Ct,yn),hn=new H(nr/b,vi/b),Fn=new H(On/b,Oi/b),Ii=r*Math.PI/180;if(Ii){const Mi=Math.sin(Ii),Pi=Math.cos(Ii),fi=[Pi,-Mi,Mi,Pi];Zr._matMult(fi),Ci._matMult(fi),Bi._matMult(fi),Fi._matMult(fi)}const vn=qe.stretch+qe.fixed,bi=Tt.stretch+Tt.fixed;return{tl:Zr,tr:Ci,bl:Bi,br:Fi,tex:{x:v.paddedRect.x+dh+vn,y:v.paddedRect.y+dh+bi,w:zt.stretch+zt.fixed-vn,h:At.stretch+At.fixed-bi},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:hn,pixelOffsetBR:Fn,minFontScaleX:de/b/ot,minFontScaleY:et/b/tt,isSDF:s}};if(c&&(v.stretchX||v.stretchY)){const qe=Av(A,W,$),Tt=Av(R,te,G);for(let zt=0;zt<qe.length-1;zt++){const At=qe[zt],Ct=qe[zt+1];for(let nr=0;nr<Tt.length-1;nr++)f.push(ct(At,Tt[nr],Ct,Tt[nr+1]))}}else f.push(ct({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:w+1},{fixed:0,stretch:S+1}));return f}function bf(o,r,s){let c=0;for(const f of o)c+=Math.max(r,Math.min(s,f[1]))-Math.max(r,Math.min(s,f[0]));return c}function Av(o,r,s){const c=[{fixed:-1,stretch:0}];for(const[f,v]of o){const b=c[c.length-1];c.push({fixed:f-b.stretch,stretch:b.stretch}),c.push({fixed:f-b.stretch,stretch:b.stretch+(v-f)})}return c.push({fixed:r+dh,stretch:s}),c}function xf(o,r,s,c){return o/r*s+c}function wf(o,r,s,c){return o-r*s/c}class Tf{constructor(r,s,c,f,v,b,w,S,C,A){var R;if(this.boxStartIndex=r.length,C){let j=b.top,$=b.bottom;const G=b.collisionPadding;G&&(j-=G[1],$+=G[3]);let W=$-j;W>0&&(W=Math.max(10,W),this.circleDiameter=W)}else{const j=!((R=b.image)===null||R===void 0)&&R.content&&(b.image.textFitWidth||b.image.textFitHeight)?tv(b):{x1:b.left,y1:b.top,x2:b.right,y2:b.bottom};j.y1=j.y1*w-S[0],j.y2=j.y2*w+S[2],j.x1=j.x1*w-S[3],j.x2=j.x2*w+S[1];const $=b.collisionPadding;if($&&(j.x1-=$[0]*w,j.y1-=$[1]*w,j.x2+=$[2]*w,j.y2+=$[3]*w),A){const G=new H(j.x1,j.y1),W=new H(j.x2,j.y1),te=new H(j.x1,j.y2),se=new H(j.x2,j.y2),ye=A*Math.PI/180;G._rotate(ye),W._rotate(ye),te._rotate(ye),se._rotate(ye),j.x1=Math.min(G.x,W.x,te.x,se.x),j.x2=Math.max(G.x,W.x,te.x,se.x),j.y1=Math.min(G.y,W.y,te.y,se.y),j.y2=Math.max(G.y,W.y,te.y,se.y)}r.emplaceBack(s.x,s.y,j.x1,j.y1,j.x2,j.y2,c,f,v)}this.boxEndIndex=r.length}}class BT{constructor(r=[],s=(c,f)=>c<f?-1:c>f?1:0){if(this.data=r,this.length=this.data.length,this.compare=s,this.length>0)for(let c=(this.length>>1)-1;c>=0;c--)this._down(c)}push(r){this.data.push(r),this._up(this.length++)}pop(){if(this.length===0)return;const r=this.data[0],s=this.data.pop();return--this.length>0&&(this.data[0]=s,this._down(0)),r}peek(){return this.data[0]}_up(r){const{data:s,compare:c}=this,f=s[r];for(;r>0;){const v=r-1>>1,b=s[v];if(c(f,b)>=0)break;s[r]=b,r=v}s[r]=f}_down(r){const{data:s,compare:c}=this,f=this.length>>1,v=s[r];for(;r<f;){let b=1+(r<<1);const w=b+1;if(w<this.length&&c(s[w],s[b])<0&&(b=w),c(s[b],v)>=0)break;s[r]=s[b],r=b}s[r]=v}}function jT(o,r=1,s=!1){let c=1/0,f=1/0,v=-1/0,b=-1/0;const w=o[0];for(let $=0;$<w.length;$++){const G=w[$];(!$||G.x<c)&&(c=G.x),(!$||G.y<f)&&(f=G.y),(!$||G.x>v)&&(v=G.x),(!$||G.y>b)&&(b=G.y)}const S=Math.min(v-c,b-f);let C=S/2;const A=new BT([],NT);if(S===0)return new H(c,f);for(let $=c;$<v;$+=S)for(let G=f;G<b;G+=S)A.push(new Tc($+C,G+C,C,o));let R=function($){let G=0,W=0,te=0;const se=$[0];for(let ye=0,ue=se.length,V=ue-1;ye<ue;V=ye++){const ee=se[ye],de=se[V],Fe=ee.x*de.y-de.x*ee.y;W+=(ee.x+de.x)*Fe,te+=(ee.y+de.y)*Fe,G+=3*Fe}return new Tc(W/G,te/G,0,$)}(o),j=A.length;for(;A.length;){const $=A.pop();($.d>R.d||!R.d)&&(R=$,s&&console.log("found best %d after %d probes",Math.round(1e4*$.d)/1e4,j)),$.max-R.d<=r||(C=$.h/2,A.push(new Tc($.p.x-C,$.p.y-C,C,o)),A.push(new Tc($.p.x+C,$.p.y-C,C,o)),A.push(new Tc($.p.x-C,$.p.y+C,C,o)),A.push(new Tc($.p.x+C,$.p.y+C,C,o)),j+=4)}return s&&(console.log(`num probes: ${j}`),console.log(`best distance: ${R.d}`)),R.p}function NT(o,r){return r.max-o.max}function Tc(o,r,s,c){this.p=new H(o,r),this.h=s,this.d=function(f,v){let b=!1,w=1/0;for(let S=0;S<v.length;S++){const C=v[S];for(let A=0,R=C.length,j=R-1;A<R;j=A++){const $=C[A],G=C[j];$.y>f.y!=G.y>f.y&&f.x<(G.x-$.x)*(f.y-$.y)/(G.y-$.y)+$.x&&(b=!b),w=Math.min(w,uy(f,$,G))}}return(b?1:-1)*Math.sqrt(w)}(this.p,c),this.max=this.d+this.h*Math.SQRT2}var Ui;m.ay=void 0,(Ui=m.ay||(m.ay={}))[Ui.center=1]="center",Ui[Ui.left=2]="left",Ui[Ui.right=3]="right",Ui[Ui.top=4]="top",Ui[Ui.bottom=5]="bottom",Ui[Ui["top-left"]=6]="top-left",Ui[Ui["top-right"]=7]="top-right",Ui[Ui["bottom-left"]=8]="bottom-left",Ui[Ui["bottom-right"]=9]="bottom-right";const fa=7,Bm=Number.POSITIVE_INFINITY;function kv(o,r){return r[1]!==Bm?function(s,c,f){let v=0,b=0;switch(c=Math.abs(c),f=Math.abs(f),s){case"top-right":case"top-left":case"top":b=f-fa;break;case"bottom-right":case"bottom-left":case"bottom":b=-f+fa}switch(s){case"top-right":case"bottom-right":case"right":v=-c;break;case"top-left":case"bottom-left":case"left":v=c}return[v,b]}(o,r[0],r[1]):function(s,c){let f=0,v=0;c<0&&(c=0);const b=c/Math.SQRT2;switch(s){case"top-right":case"top-left":v=b-fa;break;case"bottom-right":case"bottom-left":v=-b+fa;break;case"bottom":v=-c+fa;break;case"top":v=c-fa}switch(s){case"top-right":case"bottom-right":f=-b;break;case"top-left":case"bottom-left":f=b;break;case"left":f=c;break;case"right":f=-c}return[f,v]}(o,r[0])}function Lv(o,r,s){var c;const f=o.layout,v=(c=f.get("text-variable-anchor-offset"))===null||c===void 0?void 0:c.evaluate(r,{},s);if(v){const w=v.values,S=[];for(let C=0;C<w.length;C+=2){const A=S[C]=w[C],R=w[C+1].map(j=>j*yi);A.startsWith("top")?R[1]-=fa:A.startsWith("bottom")&&(R[1]+=fa),S[C+1]=R}return new Yi(S)}const b=f.get("text-variable-anchor");if(b){let w;w=o._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[f.get("text-radial-offset").evaluate(r,{},s)*yi,Bm]:f.get("text-offset").evaluate(r,{},s).map(C=>C*yi);const S=[];for(const C of b)S.push(C,kv(C,w));return new Yi(S)}return null}function jm(o){switch(o){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function VT(o,r,s,c,f,v,b,w,S,C,A,R){let j=v.textMaxSize.evaluate(r,{});j===void 0&&(j=b);const $=o.layers[0].layout,G=$.get("icon-offset").evaluate(r,{},A),W=Rv(s.horizontal),te=b/24,se=o.tilePixelRatio*te,ye=o.tilePixelRatio*j/24,ue=o.tilePixelRatio*w,V=o.tilePixelRatio*$.get("symbol-spacing"),ee=$.get("text-padding")*o.tilePixelRatio,de=function(zt,At,Ct,nr=1){const ei=zt.get("icon-padding").evaluate(At,{},Ct),vi=ei&&ei.values;return[vi[0]*nr,vi[1]*nr,vi[2]*nr,vi[3]*nr]}($,r,A,o.tilePixelRatio),Fe=$.get("text-max-angle")/180*Math.PI,et=$.get("text-rotation-alignment")!=="viewport"&&$.get("symbol-placement")!=="point",je=$.get("icon-rotation-alignment")==="map"&&$.get("symbol-placement")!=="point",$e=$.get("symbol-placement"),ot=V/2,tt=$.get("icon-text-fit");let ct;c&&tt!=="none"&&(o.allowVerticalPlacement&&s.vertical&&(ct=rv(c,s.vertical,tt,$.get("icon-text-fit-padding"),G,te)),W&&(c=rv(c,W,tt,$.get("icon-text-fit-padding"),G,te)));const qe=A?R.line.getGranularityForZoomLevel(A.z):1,Tt=(zt,At)=>{At.x<0||At.x>=Xe||At.y<0||At.y>=Xe||function(Ct,nr,ei,vi,Gi,On,yn,Oi,Zr,Ci,Fi,Bi,hn,Fn,Ii,vn,bi,Mi,Pi,fi,Fr,vo,Sc,bo,GT){const Ec=Ct.addToLineVertexArray(nr,ei);let al,Cc,Ic,Mc,Bv=0,jv=0,Nv=0,Vv=0,Hm=-1,Wm=-1;const xs={};let $v=go("");if(Ct.allowVerticalPlacement&&vi.vertical){const Qi=Oi.layout.get("text-rotate").evaluate(Fr,{},bo)+90;Ic=new Tf(Zr,nr,Ci,Fi,Bi,vi.vertical,hn,Fn,Ii,Qi),yn&&(Mc=new Tf(Zr,nr,Ci,Fi,Bi,yn,bi,Mi,Ii,Qi))}if(Gi){const Qi=Oi.layout.get("icon-rotate").evaluate(Fr,{}),Bn=Oi.layout.get("icon-text-fit")!=="none",ll=Pv(Gi,Qi,Sc,Bn),wo=yn?Pv(yn,Qi,Sc,Bn):void 0;Cc=new Tf(Zr,nr,Ci,Fi,Bi,Gi,bi,Mi,!1,Qi),Bv=4*ll.length;const cl=Ct.iconSizeData;let Uo=null;cl.kind==="source"?(Uo=[$o*Oi.layout.get("icon-size").evaluate(Fr,{})],Uo[0]>ua&&Pr(`${Ct.layerIds[0]}: Value for "icon-size" is >= ${uh}. Reduce your "icon-size".`)):cl.kind==="composite"&&(Uo=[$o*vo.compositeIconSizes[0].evaluate(Fr,{},bo),$o*vo.compositeIconSizes[1].evaluate(Fr,{},bo)],(Uo[0]>ua||Uo[1]>ua)&&Pr(`${Ct.layerIds[0]}: Value for "icon-size" is >= ${uh}. Reduce your "icon-size".`)),Ct.addSymbols(Ct.icon,ll,Uo,fi,Pi,Fr,m.ah.none,nr,Ec.lineStartIndex,Ec.lineLength,-1,bo),Hm=Ct.icon.placedSymbolArray.length-1,wo&&(jv=4*wo.length,Ct.addSymbols(Ct.icon,wo,Uo,fi,Pi,Fr,m.ah.vertical,nr,Ec.lineStartIndex,Ec.lineLength,-1,bo),Wm=Ct.icon.placedSymbolArray.length-1)}const Uv=Object.keys(vi.horizontal);for(const Qi of Uv){const Bn=vi.horizontal[Qi];if(!al){$v=go(Bn.text);const wo=Oi.layout.get("text-rotate").evaluate(Fr,{},bo);al=new Tf(Zr,nr,Ci,Fi,Bi,Bn,hn,Fn,Ii,wo)}const ll=Bn.positionedLines.length===1;if(Nv+=zv(Ct,nr,Bn,On,Oi,Ii,Fr,vn,Ec,vi.vertical?m.ah.horizontal:m.ah.horizontalOnly,ll?Uv:[Qi],xs,Hm,vo,bo),ll)break}vi.vertical&&(Vv+=zv(Ct,nr,vi.vertical,On,Oi,Ii,Fr,vn,Ec,m.ah.vertical,["vertical"],xs,Wm,vo,bo));const ZT=al?al.boxStartIndex:Ct.collisionBoxArray.length,qT=al?al.boxEndIndex:Ct.collisionBoxArray.length,HT=Ic?Ic.boxStartIndex:Ct.collisionBoxArray.length,WT=Ic?Ic.boxEndIndex:Ct.collisionBoxArray.length,KT=Cc?Cc.boxStartIndex:Ct.collisionBoxArray.length,XT=Cc?Cc.boxEndIndex:Ct.collisionBoxArray.length,YT=Mc?Mc.boxStartIndex:Ct.collisionBoxArray.length,JT=Mc?Mc.boxEndIndex:Ct.collisionBoxArray.length;let xo=-1;const Ef=(Qi,Bn)=>Qi&&Qi.circleDiameter?Math.max(Qi.circleDiameter,Bn):Bn;xo=Ef(al,xo),xo=Ef(Ic,xo),xo=Ef(Cc,xo),xo=Ef(Mc,xo);const Gv=xo>-1?1:0;Gv&&(xo*=GT/yi),Ct.glyphOffsetArray.length>=xc.MAX_GLYPHS&&Pr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Fr.sortKey!==void 0&&Ct.addToSortKeyRanges(Ct.symbolInstances.length,Fr.sortKey);const QT=Lv(Oi,Fr,bo),[eS,tS]=function(Qi,Bn){const ll=Qi.length,wo=Bn==null?void 0:Bn.values;if((wo==null?void 0:wo.length)>0)for(let cl=0;cl<wo.length;cl+=2){const Uo=wo[cl+1];Qi.emplaceBack(m.ay[wo[cl]],Uo[0],Uo[1])}return[ll,Qi.length]}(Ct.textAnchorOffsets,QT);Ct.symbolInstances.emplaceBack(nr.x,nr.y,xs.right>=0?xs.right:-1,xs.center>=0?xs.center:-1,xs.left>=0?xs.left:-1,xs.vertical||-1,Hm,Wm,$v,ZT,qT,HT,WT,KT,XT,YT,JT,Ci,Nv,Vv,Bv,jv,Gv,0,hn,xo,eS,tS)}(o,At,zt,s,c,f,ct,o.layers[0],o.collisionBoxArray,r.index,r.sourceLayerIndex,o.index,se,[ee,ee,ee,ee],et,S,ue,de,je,G,r,v,C,A,b)};if($e==="line")for(const zt of Tv(r.geometry,0,0,Xe,Xe)){const At=sl(zt,qe),Ct=FT(At,V,Fe,s.vertical||W,c,24,ye,o.overscaling,Xe);for(const nr of Ct)W&&$T(o,W.text,ot,nr)||Tt(At,nr)}else if($e==="line-center"){for(const zt of r.geometry)if(zt.length>1){const At=sl(zt,qe),Ct=OT(At,Fe,s.vertical||W,c,24,ye);Ct&&Tt(At,Ct)}}else if(r.type==="Polygon")for(const zt of $a(r.geometry,0)){const At=jT(zt,16);Tt(sl(zt[0],qe,!0),new da(At.x,At.y,0))}else if(r.type==="LineString")for(const zt of r.geometry){const At=sl(zt,qe);Tt(At,new da(At[0].x,At[0].y,0))}else if(r.type==="Point")for(const zt of r.geometry)for(const At of zt)Tt([At],new da(At.x,At.y,0))}function zv(o,r,s,c,f,v,b,w,S,C,A,R,j,$,G){const W=function(ye,ue,V,ee,de,Fe,et,je){const $e=ee.layout.get("text-rotate").evaluate(Fe,{})*Math.PI/180,ot=[];for(const tt of ue.positionedLines)for(const ct of tt.positionedGlyphs){if(!ct.rect)continue;const qe=ct.rect||{};let Tt=mT+1,zt=!0,At=1,Ct=0;const nr=(de||je)&&ct.vertical,ei=ct.metrics.advance*ct.scale/2;if(je&&ue.verticalizable&&(Ct=tt.lineOffset/2-(ct.imageName?-(yi-ct.metrics.width*ct.scale)/2:(ct.scale-1)*yi)),ct.imageName){const Mi=et[ct.imageName];zt=Mi.sdf,At=Mi.pixelRatio,Tt=_n/At}const vi=de?[ct.x+ei,ct.y]:[0,0];let Gi=de?[0,0]:[ct.x+ei+V[0],ct.y+V[1]-Ct],On=[0,0];nr&&(On=Gi,Gi=[0,0]);const yn=ct.metrics.isDoubleResolution?2:1,Oi=(ct.metrics.left-Tt)*ct.scale-ei+Gi[0],Zr=(-ct.metrics.top-Tt)*ct.scale+Gi[1],Ci=Oi+qe.w/yn*ct.scale/At,Fi=Zr+qe.h/yn*ct.scale/At,Bi=new H(Oi,Zr),hn=new H(Ci,Zr),Fn=new H(Oi,Fi),Ii=new H(Ci,Fi);if(nr){const Mi=new H(-ei,ei-mf),Pi=-Math.PI/2,fi=yi/2-ei,Fr=new H(5-mf-fi,-(ct.imageName?fi:0)),vo=new H(...On);Bi._rotateAround(Pi,Mi)._add(Fr)._add(vo),hn._rotateAround(Pi,Mi)._add(Fr)._add(vo),Fn._rotateAround(Pi,Mi)._add(Fr)._add(vo),Ii._rotateAround(Pi,Mi)._add(Fr)._add(vo)}if($e){const Mi=Math.sin($e),Pi=Math.cos($e),fi=[Pi,-Mi,Mi,Pi];Bi._matMult(fi),hn._matMult(fi),Fn._matMult(fi),Ii._matMult(fi)}const vn=new H(0,0),bi=new H(0,0);ot.push({tl:Bi,tr:hn,bl:Fn,br:Ii,tex:qe,writingMode:ue.writingMode,glyphOffset:vi,sectionIndex:ct.sectionIndex,isSDF:zt,pixelOffsetTL:vn,pixelOffsetBR:bi,minFontScaleX:0,minFontScaleY:0})}return ot}(0,s,w,f,v,b,c,o.allowVerticalPlacement),te=o.textSizeData;let se=null;te.kind==="source"?(se=[$o*f.layout.get("text-size").evaluate(b,{})],se[0]>ua&&Pr(`${o.layerIds[0]}: Value for "text-size" is >= ${uh}. Reduce your "text-size".`)):te.kind==="composite"&&(se=[$o*$.compositeTextSizes[0].evaluate(b,{},G),$o*$.compositeTextSizes[1].evaluate(b,{},G)],(se[0]>ua||se[1]>ua)&&Pr(`${o.layerIds[0]}: Value for "text-size" is >= ${uh}. Reduce your "text-size".`)),o.addSymbols(o.text,W,se,w,v,b,C,r,S.lineStartIndex,S.lineLength,j,G);for(const ye of A)R[ye]=o.text.placedSymbolArray.length-1;return 4*W.length}function Rv(o){for(const r in o)return o[r];return null}function $T(o,r,s,c){const f=o.compareText;if(r in f){const v=f[r];for(let b=v.length-1;b>=0;b--)if(c.dist(v[b])<s)return!0}else f[r]=[];return f[r].push(c),!1}const Dv=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Nm{static from(r){if(!(r instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[s,c]=new Uint8Array(r,0,2);if(s!==219)throw new Error("Data does not appear to be in a KDBush format.");const f=c>>4;if(f!==1)throw new Error(`Got v${f} data when expected v1.`);const v=Dv[15&c];if(!v)throw new Error("Unrecognized array type.");const[b]=new Uint16Array(r,2,1),[w]=new Uint32Array(r,4,1);return new Nm(w,b,v,r)}constructor(r,s=64,c=Float64Array,f){if(isNaN(r)||r<0)throw new Error(`Unpexpected numItems value: ${r}.`);this.numItems=+r,this.nodeSize=Math.min(Math.max(+s,2),65535),this.ArrayType=c,this.IndexArrayType=r<65536?Uint16Array:Uint32Array;const v=Dv.indexOf(this.ArrayType),b=2*r*this.ArrayType.BYTES_PER_ELEMENT,w=r*this.IndexArrayType.BYTES_PER_ELEMENT,S=(8-w%8)%8;if(v<0)throw new Error(`Unexpected typed array class: ${c}.`);f&&f instanceof ArrayBuffer?(this.data=f,this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+w+S,2*r),this._pos=2*r,this._finished=!0):(this.data=new ArrayBuffer(8+b+w+S),this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+w+S,2*r),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+v]),new Uint16Array(this.data,2,1)[0]=s,new Uint32Array(this.data,4,1)[0]=r)}add(r,s){const c=this._pos>>1;return this.ids[c]=c,this.coords[this._pos++]=r,this.coords[this._pos++]=s,c}finish(){const r=this._pos>>1;if(r!==this.numItems)throw new Error(`Added ${r} items when expected ${this.numItems}.`);return Vm(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(r,s,c,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:v,coords:b,nodeSize:w}=this,S=[0,v.length-1,0],C=[];for(;S.length;){const A=S.pop()||0,R=S.pop()||0,j=S.pop()||0;if(R-j<=w){for(let te=j;te<=R;te++){const se=b[2*te],ye=b[2*te+1];se>=r&&se<=c&&ye>=s&&ye<=f&&C.push(v[te])}continue}const $=j+R>>1,G=b[2*$],W=b[2*$+1];G>=r&&G<=c&&W>=s&&W<=f&&C.push(v[$]),(A===0?r<=G:s<=W)&&(S.push(j),S.push($-1),S.push(1-A)),(A===0?c>=G:f>=W)&&(S.push($+1),S.push(R),S.push(1-A))}return C}within(r,s,c){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:f,coords:v,nodeSize:b}=this,w=[0,f.length-1,0],S=[],C=c*c;for(;w.length;){const A=w.pop()||0,R=w.pop()||0,j=w.pop()||0;if(R-j<=b){for(let te=j;te<=R;te++)Fv(v[2*te],v[2*te+1],r,s)<=C&&S.push(f[te]);continue}const $=j+R>>1,G=v[2*$],W=v[2*$+1];Fv(G,W,r,s)<=C&&S.push(f[$]),(A===0?r-c<=G:s-c<=W)&&(w.push(j),w.push($-1),w.push(1-A)),(A===0?r+c>=G:s+c>=W)&&(w.push($+1),w.push(R),w.push(1-A))}return S}}function Vm(o,r,s,c,f,v){if(f-c<=s)return;const b=c+f>>1;Ov(o,r,b,c,f,v),Vm(o,r,s,c,b-1,1-v),Vm(o,r,s,b+1,f,1-v)}function Ov(o,r,s,c,f,v){for(;f>c;){if(f-c>600){const C=f-c+1,A=s-c+1,R=Math.log(C),j=.5*Math.exp(2*R/3),$=.5*Math.sqrt(R*j*(C-j)/C)*(A-C/2<0?-1:1);Ov(o,r,s,Math.max(c,Math.floor(s-A*j/C+$)),Math.min(f,Math.floor(s+(C-A)*j/C+$)),v)}const b=r[2*s+v];let w=c,S=f;for(fh(o,r,c,s),r[2*f+v]>b&&fh(o,r,c,f);w<S;){for(fh(o,r,w,S),w++,S--;r[2*w+v]<b;)w++;for(;r[2*S+v]>b;)S--}r[2*c+v]===b?fh(o,r,c,S):(S++,fh(o,r,S,f)),S<=s&&(c=S+1),s<=S&&(f=S-1)}}function fh(o,r,s,c){$m(o,s,c),$m(r,2*s,2*c),$m(r,2*s+1,2*c+1)}function $m(o,r,s){const c=o[r];o[r]=o[s],o[s]=c}function Fv(o,r,s,c){const f=o-s,v=r-c;return f*f+v*v}var Um;m.ck=void 0,(Um=m.ck||(m.ck={})).create="create",Um.load="load",Um.fullLoad="fullLoad";let Sf=null,ph=[];const Gm=1e3/60,Zm="loadTime",qm="fullLoadTime",UT={mark(o){performance.mark(o)},frame(o){const r=o;Sf!=null&&ph.push(r-Sf),Sf=r},clearMetrics(){Sf=null,ph=[],performance.clearMeasures(Zm),performance.clearMeasures(qm);for(const o in m.ck)performance.clearMarks(m.ck[o])},getPerformanceMetrics(){performance.measure(Zm,m.ck.create,m.ck.load),performance.measure(qm,m.ck.create,m.ck.fullLoad);const o=performance.getEntriesByName(Zm)[0].duration,r=performance.getEntriesByName(qm)[0].duration,s=ph.length,c=1/(ph.reduce((v,b)=>v+b,0)/s/1e3),f=ph.filter(v=>v>Gm).reduce((v,b)=>v+(b-Gm)/Gm,0);return{loadTime:o,fullLoadTime:r,fps:c,percentDroppedFrames:f/(s+f)*100,totalFrames:s}}};m.$=hh,m.A=Me,m.B=Ln,m.C=Dr,m.D=Mt,m.E=Y,m.F=Qp,m.G=function(o){if(we==null){const r=o.navigator?o.navigator.userAgent:null;we=!!o.safari||!(!r||!(/\b(iPad|iPhone|iPod)\b/.test(r)||r.match("Safari")&&!r.match("Chrome")))}return we},m.H=class{constructor(o,r){this.target=o,this.mapId=r,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new zT(()=>this.process()),this.subscription=ut(this.target,"message",s=>this.receive(s),!1),this.globalScope=pe(self)?o:window}registerMessageHandler(o,r){this.messageHandlers[o]=r}sendAsync(o,r){return new Promise((s,c)=>{const f=Math.round(1e18*Math.random()).toString(36).substring(0,10),v=r?ut(r.signal,"abort",()=>{v==null||v.unsubscribe(),delete this.resolveRejects[f];const S={id:f,type:"<cancel>",origin:location.origin,targetMapId:o.targetMapId,sourceMapId:this.mapId};this.target.postMessage(S)},RT):null;this.resolveRejects[f]={resolve:S=>{v==null||v.unsubscribe(),s(S)},reject:S=>{v==null||v.unsubscribe(),c(S)}};const b=[],w=Object.assign(Object.assign({},o),{id:f,sourceMapId:this.mapId,origin:location.origin,data:fs(o.data,b)});this.target.postMessage(w,{transfer:b})})}receive(o){const r=o.data,s=r.id;if(!(r.origin!=="file://"&&location.origin!=="file://"&&r.origin!=="resource://android"&&location.origin!=="resource://android"&&r.origin!==location.origin||r.targetMapId&&this.mapId!==r.targetMapId)){if(r.type==="<cancel>"){delete this.tasks[s];const c=this.abortControllers[s];return delete this.abortControllers[s],void(c&&c.abort())}if(pe(self)||r.mustQueue)return this.tasks[s]=r,this.taskQueue.push(s),void this.invoker.trigger();this.processTask(s,r)}}process(){if(this.taskQueue.length===0)return;const o=this.taskQueue.shift(),r=this.tasks[o];delete this.tasks[o],this.taskQueue.length>0&&this.invoker.trigger(),r&&this.processTask(o,r)}processTask(o,r){return a(this,void 0,void 0,function*(){if(r.type==="<response>"){const f=this.resolveRejects[o];return delete this.resolveRejects[o],f?void(r.error?f.reject(Do(r.error)):f.resolve(Do(r.data))):void 0}if(!this.messageHandlers[r.type])return void this.completeTask(o,new Error(`Could not find a registered handler for ${r.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const s=Do(r.data),c=new AbortController;this.abortControllers[o]=c;try{const f=yield this.messageHandlers[r.type](r.sourceMapId,s,c);this.completeTask(o,null,f)}catch(f){this.completeTask(o,f)}})}completeTask(o,r,s){const c=[];delete this.abortControllers[o];const f={id:o,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:r?fs(r):null,data:fs(s,c)};this.target.postMessage(f,{transfer:c})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},m.I=Im,m.J=ir,m.K=function(){var o=new Me(16);return Me!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=0,o[12]=0,o[13]=0,o[14]=0),o[0]=1,o[5]=1,o[10]=1,o[15]=1,o},m.L=function(o,r,s){var c,f,v,b,w,S,C,A,R,j,$,G,W=s[0],te=s[1],se=s[2];return r===o?(o[12]=r[0]*W+r[4]*te+r[8]*se+r[12],o[13]=r[1]*W+r[5]*te+r[9]*se+r[13],o[14]=r[2]*W+r[6]*te+r[10]*se+r[14],o[15]=r[3]*W+r[7]*te+r[11]*se+r[15]):(f=r[1],v=r[2],b=r[3],w=r[4],S=r[5],C=r[6],A=r[7],R=r[8],j=r[9],$=r[10],G=r[11],o[0]=c=r[0],o[1]=f,o[2]=v,o[3]=b,o[4]=w,o[5]=S,o[6]=C,o[7]=A,o[8]=R,o[9]=j,o[10]=$,o[11]=G,o[12]=c*W+w*te+R*se+r[12],o[13]=f*W+S*te+j*se+r[13],o[14]=v*W+C*te+$*se+r[14],o[15]=b*W+A*te+G*se+r[15]),o},m.M=function(o,r,s){var c=s[0],f=s[1],v=s[2];return o[0]=r[0]*c,o[1]=r[1]*c,o[2]=r[2]*c,o[3]=r[3]*c,o[4]=r[4]*f,o[5]=r[5]*f,o[6]=r[6]*f,o[7]=r[7]*f,o[8]=r[8]*v,o[9]=r[9]*v,o[10]=r[10]*v,o[11]=r[11]*v,o[12]=r[12],o[13]=r[13],o[14]=r[14],o[15]=r[15],o},m.N=function(o,r,s){var c=r[0],f=r[1],v=r[2],b=r[3],w=r[4],S=r[5],C=r[6],A=r[7],R=r[8],j=r[9],$=r[10],G=r[11],W=r[12],te=r[13],se=r[14],ye=r[15],ue=s[0],V=s[1],ee=s[2],de=s[3];return o[0]=ue*c+V*w+ee*R+de*W,o[1]=ue*f+V*S+ee*j+de*te,o[2]=ue*v+V*C+ee*$+de*se,o[3]=ue*b+V*A+ee*G+de*ye,o[4]=(ue=s[4])*c+(V=s[5])*w+(ee=s[6])*R+(de=s[7])*W,o[5]=ue*f+V*S+ee*j+de*te,o[6]=ue*v+V*C+ee*$+de*se,o[7]=ue*b+V*A+ee*G+de*ye,o[8]=(ue=s[8])*c+(V=s[9])*w+(ee=s[10])*R+(de=s[11])*W,o[9]=ue*f+V*S+ee*j+de*te,o[10]=ue*v+V*C+ee*$+de*se,o[11]=ue*b+V*A+ee*G+de*ye,o[12]=(ue=s[12])*c+(V=s[13])*w+(ee=s[14])*R+(de=s[15])*W,o[13]=ue*f+V*S+ee*j+de*te,o[14]=ue*v+V*C+ee*$+de*se,o[15]=ue*b+V*A+ee*G+de*ye,o},m.O=function(o,r){const s={};for(let c=0;c<r.length;c++){const f=r[c];f in o&&(s[f]=o[f])}return s},m.P=H,m.Q=ha,m.R=Rn,m.S=dv,m.T=Ja,m.U=hv,m.V=Q,m.W=re,m.X=nt,m.Y=Dn,m.Z=Xe,m._=a,m.a=Ot,m.a$=function(o,r,s){var c=Math.sin(s),f=Math.cos(s),v=r[4],b=r[5],w=r[6],S=r[7],C=r[8],A=r[9],R=r[10],j=r[11];return r!==o&&(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[12]=r[12],o[13]=r[13],o[14]=r[14],o[15]=r[15]),o[4]=v*f+C*c,o[5]=b*f+A*c,o[6]=w*f+R*c,o[7]=S*f+j*c,o[8]=C*f-v*c,o[9]=A*f-b*c,o[10]=R*f-w*c,o[11]=j*f-S*c,o},m.a0=25,m.a1=Fm,m.a2=o=>{const r=window.document.createElement("video");return r.muted=!0,new Promise(s=>{r.onloadstart=()=>{s(r)};for(const c of o){const f=window.document.createElement("source");zi(c)||(r.crossOrigin="Anonymous"),f.src=c,r.appendChild(f)}})},m.a3=Ve,m.a4=function(){return Yt++},m.a5=E,m.a6=xc,m.a7=Iu,m.a8=Vo,m.a9=vv,m.aA=jm,m.aB=Pm,m.aC=Nm,m.aD=oi,m.aE=df,m.aF=fe,m.aG=Kt,m.aH=Je,m.aI=function(o){return Math.pow(2,o)},m.aJ=85.051129,m.aK=fv,m.aL=Lr,m.aM=ht,m.aN=pv,m.aO=function(o,r,s){return o[0]=r[0]*s,o[1]=r[1]*s,o[2]=r[2]*s,o},m.aP=function(o,r,s){return o[0]=r[0]+s[0],o[1]=r[1]+s[1],o[2]=r[2]+s[2],o},m.aQ=function(o){var r=new Me(3);return r[0]=o[0],r[1]=o[1],r[2]=o[2],r},m.aR=function(o,r,s){return o[0]=r[0]*s[0],o[1]=r[1]*s[1],o[2]=r[2]*s[2],o[3]=r[3]*s[3],o},m.aS=function(o,r,s){return o[0]=r[0]-s[0],o[1]=r[1]-s[1],o[2]=r[2]-s[2],o},m.aT=function(o,r){var s=r[0],c=r[1],f=r[2],v=s*s+c*c+f*f;return v>0&&(v=1/Math.sqrt(v)),o[0]=r[0]*v,o[1]=r[1]*v,o[2]=r[2]*v,o},m.aU=function(o,r,s){var c=r[0],f=r[1],v=r[2],b=s[0],w=s[1],S=s[2];return o[0]=f*S-v*w,o[1]=v*b-c*S,o[2]=c*w-f*b,o},m.aV=function(o,r){return o[0]*r[0]+o[1]*r[1]+o[2]*r[2]},m.aW=gv,m.aX=wc,m.aY=function(o,r,s,c,f){var v,b=1/Math.tan(r/2);return o[0]=b/s,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=b,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=-1,o[12]=0,o[13]=0,o[15]=0,f!=null&&f!==1/0?(o[10]=(f+c)*(v=1/(c-f)),o[14]=2*f*c*v):(o[10]=-1,o[14]=-2*c),o},m.aZ=function(o){var r=new Me(16);return r[0]=o[0],r[1]=o[1],r[2]=o[2],r[3]=o[3],r[4]=o[4],r[5]=o[5],r[6]=o[6],r[7]=o[7],r[8]=o[8],r[9]=o[9],r[10]=o[10],r[11]=o[11],r[12]=o[12],r[13]=o[13],r[14]=o[14],r[15]=o[15],r},m.a_=function(o,r,s){var c=Math.sin(s),f=Math.cos(s),v=r[0],b=r[1],w=r[2],S=r[3],C=r[4],A=r[5],R=r[6],j=r[7];return r!==o&&(o[8]=r[8],o[9]=r[9],o[10]=r[10],o[11]=r[11],o[12]=r[12],o[13]=r[13],o[14]=r[14],o[15]=r[15]),o[0]=v*f+C*c,o[1]=b*f+A*c,o[2]=w*f+R*c,o[3]=S*f+j*c,o[4]=C*f-v*c,o[5]=A*f-b*c,o[6]=R*f-w*c,o[7]=j*f-S*c,o},m.aa=function(o){const r={};if(o.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(s,c,f,v)=>{const b=f||v;return r[c]=!b||b.toLowerCase(),""}),r["max-age"]){const s=parseInt(r["max-age"],10);isNaN(s)?delete r["max-age"]:r["max-age"]=s}return r},m.ab=function(o){return Math.log(o)/Math.LN2},m.ac=function(o){var r=o[0],s=o[1];return r*r+s*s},m.ad=function(o){return o*Math.PI/180},m.ae=Tr,m.af=function(o,r){const s=[];for(const c in o)c in r||s.push(c);return s},m.ag=function(o,r){let s=0,c=0;if(o.kind==="constant")c=o.layoutSize;else if(o.kind!=="source"){const{interpolationType:f,minZoom:v,maxZoom:b}=o,w=f?Tr(Vi.interpolationFactor(f,r,v,b),0,1):0;o.kind==="camera"?c=Ln.number(o.minSize,o.maxSize,w):s=w}return{uSizeT:s,uSize:c}},m.ai=function(o,{uSize:r,uSizeT:s},{lowerSize:c,upperSize:f}){return o.kind==="source"?c/$o:o.kind==="composite"?Ln.number(c/$o,f/$o,s):r},m.aj=function(o,r){var s=r[0],c=r[1],f=r[2],v=r[3],b=r[4],w=r[5],S=r[6],C=r[7],A=r[8],R=r[9],j=r[10],$=r[11],G=r[12],W=r[13],te=r[14],se=r[15],ye=s*w-c*b,ue=s*S-f*b,V=s*C-v*b,ee=c*S-f*w,de=c*C-v*w,Fe=f*C-v*S,et=A*W-R*G,je=A*te-j*G,$e=A*se-$*G,ot=R*te-j*W,tt=R*se-$*W,ct=j*se-$*te,qe=ye*ct-ue*tt+V*ot+ee*$e-de*je+Fe*et;return qe?(o[0]=(w*ct-S*tt+C*ot)*(qe=1/qe),o[1]=(f*tt-c*ct-v*ot)*qe,o[2]=(W*Fe-te*de+se*ee)*qe,o[3]=(j*de-R*Fe-$*ee)*qe,o[4]=(S*$e-b*ct-C*je)*qe,o[5]=(s*ct-f*$e+v*je)*qe,o[6]=(te*V-G*Fe-se*ue)*qe,o[7]=(A*Fe-j*V+$*ue)*qe,o[8]=(b*tt-w*$e+C*et)*qe,o[9]=(c*$e-s*tt-v*et)*qe,o[10]=(G*de-W*V+se*ye)*qe,o[11]=(R*V-A*de-$*ye)*qe,o[12]=(w*je-b*ot-S*et)*qe,o[13]=(s*ot-c*je+f*et)*qe,o[14]=(W*ue-G*ee-te*ye)*qe,o[15]=(A*ee-R*ue+j*ye)*qe,o):null},m.ak=it,m.al=function(o){return Math.hypot(o[0],o[1])},m.am=function(o){return o[0]=0,o[1]=0,o},m.an=function(o,r,s){return o[0]=r[0]*s,o[1]=r[1]*s,o},m.ao=km,m.ap=Ae,m.aq=function(o,r,s,c){const f=r.y-o.y,v=r.x-o.x,b=c.y-s.y,w=c.x-s.x,S=b*v-w*f;if(S===0)return null;const C=(w*(o.y-s.y)-b*(o.x-s.x))/S;return new H(o.x+C*v,o.y+C*f)},m.ar=Tv,m.as=gc,m.at=Be,m.au=function(o){let r=1/0,s=1/0,c=-1/0,f=-1/0;for(const v of o)r=Math.min(r,v.x),s=Math.min(s,v.y),c=Math.max(c,v.x),f=Math.max(f,v.y);return[r,s,c,f]},m.av=yi,m.aw=xt,m.ax=function(o,r,s,c,f=!1){if(!s[0]&&!s[1])return[0,0];const v=f?c==="map"?-o.bearingInRadians:0:c==="viewport"?o.bearingInRadians:0;if(v){const b=Math.sin(v),w=Math.cos(v);s=[s[0]*w-s[1]*b,s[0]*b+s[1]*w]}return[f?s[0]:xt(r,s[0],o.zoom),f?s[1]:xt(r,s[1],o.zoom)]},m.az=Am,m.b=We,m.b$=o=>o.type==="symbol",m.b0=function(){const o=new Float32Array(16);return Be(o),o},m.b1=function(){const o=new Float64Array(16);return Be(o),o},m.b2=function(){return new Float64Array(16)},m.b3=function(o,r,s){const c=new Float64Array(4);return function(f,v,b,w){var S=.5*Math.PI/180;v*=S,b*=S,w*=S;var C=Math.sin(v),A=Math.cos(v),R=Math.sin(b),j=Math.cos(b),$=Math.sin(w),G=Math.cos(w);f[0]=C*j*G-A*R*$,f[1]=A*R*G+C*j*$,f[2]=A*j*$-C*R*G,f[3]=A*j*G+C*R*$}(c,o,r-90,s),c},m.b4=function(o,r,s,c){var f,v,b,w,S,C=r[0],A=r[1],R=r[2],j=r[3],$=s[0],G=s[1],W=s[2],te=s[3];return(v=C*$+A*G+R*W+j*te)<0&&(v=-v,$=-$,G=-G,W=-W,te=-te),1-v>le?(f=Math.acos(v),b=Math.sin(f),w=Math.sin((1-c)*f)/b,S=Math.sin(c*f)/b):(w=1-c,S=c),o[0]=w*C+S*$,o[1]=w*A+S*G,o[2]=w*R+S*W,o[3]=w*j+S*te,o},m.b5=function(o){const r=new Float64Array(9);var s,c,f,v,b,w,S,C,A,R,j,$,G,W,te,se,ye,ue;R=(f=(c=o)[0])*(S=f+f),j=(v=c[1])*S,G=(b=c[2])*S,W=b*(C=v+v),se=(w=c[3])*S,ye=w*C,ue=w*(A=b+b),(s=r)[0]=1-($=v*C)-(te=b*A),s[3]=j-ue,s[6]=G+ye,s[1]=j+ue,s[4]=1-R-te,s[7]=W-se,s[2]=G-ye,s[5]=W+se,s[8]=1-R-$;const V=ht(-Math.asin(Tr(r[2],-1,1)));let ee,de;return Math.hypot(r[5],r[8])<.001?(ee=0,de=-ht(Math.atan2(r[3],r[4]))):(ee=ht(r[5]===0&&r[8]===0?0:Math.atan2(r[5],r[8])),de=ht(r[1]===0&&r[0]===0?0:Math.atan2(r[1],r[0]))),{roll:ee,pitch:V+90,bearing:de}},m.b6=function(o,r){return o.roll==r.roll&&o.pitch==r.pitch&&o.bearing==r.bearing},m.b7=lr,m.b8=_o,m.b9=vc,m.bA=function(o,r){if(!o)return[{command:"setStyle",args:[r]}];let s=[];try{if(!ve(o.version,r.version))return[{command:"setStyle",args:[r]}];ve(o.center,r.center)||s.push({command:"setCenter",args:[r.center]}),ve(o.centerAltitude,r.centerAltitude)||s.push({command:"setCenterAltitude",args:[r.centerAltitude]}),ve(o.zoom,r.zoom)||s.push({command:"setZoom",args:[r.zoom]}),ve(o.bearing,r.bearing)||s.push({command:"setBearing",args:[r.bearing]}),ve(o.pitch,r.pitch)||s.push({command:"setPitch",args:[r.pitch]}),ve(o.roll,r.roll)||s.push({command:"setRoll",args:[r.roll]}),ve(o.sprite,r.sprite)||s.push({command:"setSprite",args:[r.sprite]}),ve(o.glyphs,r.glyphs)||s.push({command:"setGlyphs",args:[r.glyphs]}),ve(o.transition,r.transition)||s.push({command:"setTransition",args:[r.transition]}),ve(o.light,r.light)||s.push({command:"setLight",args:[r.light]}),ve(o.terrain,r.terrain)||s.push({command:"setTerrain",args:[r.terrain]}),ve(o.sky,r.sky)||s.push({command:"setSky",args:[r.sky]}),ve(o.projection,r.projection)||s.push({command:"setProjection",args:[r.projection]});const c={},f=[];(function(b,w,S,C){let A;for(A in w=w||{},b=b||{})Object.prototype.hasOwnProperty.call(b,A)&&(Object.prototype.hasOwnProperty.call(w,A)||Ge(A,S,C));for(A in w)Object.prototype.hasOwnProperty.call(w,A)&&(Object.prototype.hasOwnProperty.call(b,A)?ve(b[A],w[A])||(b[A].type==="geojson"&&w[A].type==="geojson"&&ke(b,w,A)?ze(S,{command:"setGeoJSONSourceData",args:[A,w[A].data]}):Ne(A,w,S,C)):Ce(A,w,S))})(o.sources,r.sources,f,c);const v=[];o.layers&&o.layers.forEach(b=>{"source"in b&&c[b.source]?s.push({command:"removeLayer",args:[b.id]}):v.push(b)}),s=s.concat(f),function(b,w,S){w=w||[];const C=(b=b||[]).map(mt),A=w.map(mt),R=b.reduce(gt,{}),j=w.reduce(gt,{}),$=C.slice(),G=Object.create(null);let W,te,se,ye,ue;for(let V=0,ee=0;V<C.length;V++)W=C[V],Object.prototype.hasOwnProperty.call(j,W)?ee++:(ze(S,{command:"removeLayer",args:[W]}),$.splice($.indexOf(W,ee),1));for(let V=0,ee=0;V<A.length;V++)W=A[A.length-1-V],$[$.length-1-V]!==W&&(Object.prototype.hasOwnProperty.call(R,W)?(ze(S,{command:"removeLayer",args:[W]}),$.splice($.lastIndexOf(W,$.length-ee),1)):ee++,ye=$[$.length-V],ze(S,{command:"addLayer",args:[j[W],ye]}),$.splice($.length-V,0,W),G[W]=!0);for(let V=0;V<A.length;V++)if(W=A[V],te=R[W],se=j[W],!G[W]&&!ve(te,se))if(ve(te.source,se.source)&&ve(te["source-layer"],se["source-layer"])&&ve(te.type,se.type)){for(ue in Qe(te.layout,se.layout,S,W,null,"setLayoutProperty"),Qe(te.paint,se.paint,S,W,null,"setPaintProperty"),ve(te.filter,se.filter)||ze(S,{command:"setFilter",args:[W,se.filter]}),ve(te.minzoom,se.minzoom)&&ve(te.maxzoom,se.maxzoom)||ze(S,{command:"setLayerZoomRange",args:[W,se.minzoom,se.maxzoom]}),te)Object.prototype.hasOwnProperty.call(te,ue)&&ue!=="layout"&&ue!=="paint"&&ue!=="filter"&&ue!=="metadata"&&ue!=="minzoom"&&ue!=="maxzoom"&&(ue.indexOf("paint.")===0?Qe(te[ue],se[ue],S,W,ue.slice(6),"setPaintProperty"):ve(te[ue],se[ue])||ze(S,{command:"setLayerProperty",args:[W,ue,se[ue]]}));for(ue in se)Object.prototype.hasOwnProperty.call(se,ue)&&!Object.prototype.hasOwnProperty.call(te,ue)&&ue!=="layout"&&ue!=="paint"&&ue!=="filter"&&ue!=="metadata"&&ue!=="minzoom"&&ue!=="maxzoom"&&(ue.indexOf("paint.")===0?Qe(te[ue],se[ue],S,W,ue.slice(6),"setPaintProperty"):ve(te[ue],se[ue])||ze(S,{command:"setLayerProperty",args:[W,ue,se[ue]]}))}else ze(S,{command:"removeLayer",args:[W]}),ye=$[$.lastIndexOf(W)+1],ze(S,{command:"addLayer",args:[se,ye]})}(v,r.layers,s)}catch(c){console.warn("Unable to compute style diff:",c),s=[{command:"setStyle",args:[r]}]}return s},m.bB=function(o){const r=[],s=o.id;return s===void 0&&r.push({message:`layers.${s}: missing required property "id"`}),o.render===void 0&&r.push({message:`layers.${s}: missing required method "render"`}),o.renderingMode&&o.renderingMode!=="2d"&&o.renderingMode!=="3d"&&r.push({message:`layers.${s}: property "renderingMode" must be either "2d" or "3d"`}),r},m.bC=function o(r,s){if(Array.isArray(r)){if(!Array.isArray(s)||r.length!==s.length)return!1;for(let c=0;c<r.length;c++)if(!o(r[c],s[c]))return!1;return!0}if(typeof r=="object"&&r!==null&&s!==null){if(typeof s!="object"||Object.keys(r).length!==Object.keys(s).length)return!1;for(const c in r)if(!o(r[c],s[c]))return!1;return!0}return r===s},m.bD=Jt,m.bE=hr,m.bF=class extends eo{constructor(o,r){super(o,r),this.current=0}set(o){this.current!==o&&(this.current=o,this.gl.uniform1i(this.location,o))}},m.bG=yo,m.bH=class extends eo{constructor(o,r){super(o,r),this.current=ys}set(o){if(o[12]!==this.current[12]||o[0]!==this.current[0])return this.current=o,void this.gl.uniformMatrix4fv(this.location,!1,o);for(let r=1;r<16;r++)if(o[r]!==this.current[r]){this.current=o,this.gl.uniformMatrix4fv(this.location,!1,o);break}}},m.bI=gn,m.bJ=class extends eo{constructor(o,r){super(o,r),this.current=[0,0,0]}set(o){o[0]===this.current[0]&&o[1]===this.current[1]&&o[2]===this.current[2]||(this.current=o,this.gl.uniform3f(this.location,o[0],o[1],o[2]))}},m.bK=class extends eo{constructor(o,r){super(o,r),this.current=[0,0]}set(o){o[0]===this.current[0]&&o[1]===this.current[1]||(this.current=o,this.gl.uniform2f(this.location,o[0],o[1]))}},m.bL=Ie,m.bM=function(o,r){var s=Math.sin(r),c=Math.cos(r);return o[0]=c,o[1]=s,o[2]=0,o[3]=-s,o[4]=c,o[5]=0,o[6]=0,o[7]=0,o[8]=1,o},m.bN=function(o,r,s){var c=r[0],f=r[1],v=r[2];return o[0]=c*s[0]+f*s[3]+v*s[6],o[1]=c*s[1]+f*s[4]+v*s[7],o[2]=c*s[2]+f*s[5]+v*s[8],o},m.bO=function(o,r,s,c,f,v,b){var w=1/(r-s),S=1/(c-f),C=1/(v-b);return o[0]=-2*w,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=-2*S,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=2*C,o[11]=0,o[12]=(r+s)*w,o[13]=(f+c)*S,o[14]=(b+v)*C,o[15]=1,o},m.bP=class extends Zu{},m.bQ=cT,m.bR=class extends il{},m.bS=hm,m.bT=function(o){return o<=1?1:Math.pow(2,Math.ceil(Math.log(o)/Math.LN2))},m.bU=yy,m.bV=function(o,r,s){var c=r[0],f=r[1],v=r[2],b=s[3]*c+s[7]*f+s[11]*v+s[15];return o[0]=(s[0]*c+s[4]*f+s[8]*v+s[12])/(b=b||1),o[1]=(s[1]*c+s[5]*f+s[9]*v+s[13])/b,o[2]=(s[2]*c+s[6]*f+s[10]*v+s[14])/b,o},m.bW=class extends dc{},m.bX=class extends _{},m.bY=function(o,r){return o[0]===r[0]&&o[1]===r[1]&&o[2]===r[2]&&o[3]===r[3]&&o[4]===r[4]&&o[5]===r[5]&&o[6]===r[6]&&o[7]===r[7]&&o[8]===r[8]&&o[9]===r[9]&&o[10]===r[10]&&o[11]===r[11]&&o[12]===r[12]&&o[13]===r[13]&&o[14]===r[14]&&o[15]===r[15]},m.bZ=function(o,r){var s=o[0],c=o[1],f=o[2],v=o[3],b=o[4],w=o[5],S=o[6],C=o[7],A=o[8],R=o[9],j=o[10],$=o[11],G=o[12],W=o[13],te=o[14],se=o[15],ye=r[0],ue=r[1],V=r[2],ee=r[3],de=r[4],Fe=r[5],et=r[6],je=r[7],$e=r[8],ot=r[9],tt=r[10],ct=r[11],qe=r[12],Tt=r[13],zt=r[14],At=r[15];return Math.abs(s-ye)<=le*Math.max(1,Math.abs(s),Math.abs(ye))&&Math.abs(c-ue)<=le*Math.max(1,Math.abs(c),Math.abs(ue))&&Math.abs(f-V)<=le*Math.max(1,Math.abs(f),Math.abs(V))&&Math.abs(v-ee)<=le*Math.max(1,Math.abs(v),Math.abs(ee))&&Math.abs(b-de)<=le*Math.max(1,Math.abs(b),Math.abs(de))&&Math.abs(w-Fe)<=le*Math.max(1,Math.abs(w),Math.abs(Fe))&&Math.abs(S-et)<=le*Math.max(1,Math.abs(S),Math.abs(et))&&Math.abs(C-je)<=le*Math.max(1,Math.abs(C),Math.abs(je))&&Math.abs(A-$e)<=le*Math.max(1,Math.abs(A),Math.abs($e))&&Math.abs(R-ot)<=le*Math.max(1,Math.abs(R),Math.abs(ot))&&Math.abs(j-tt)<=le*Math.max(1,Math.abs(j),Math.abs(tt))&&Math.abs($-ct)<=le*Math.max(1,Math.abs($),Math.abs(ct))&&Math.abs(G-qe)<=le*Math.max(1,Math.abs(G),Math.abs(qe))&&Math.abs(W-Tt)<=le*Math.max(1,Math.abs(W),Math.abs(Tt))&&Math.abs(te-zt)<=le*Math.max(1,Math.abs(te),Math.abs(zt))&&Math.abs(se-At)<=le*Math.max(1,Math.abs(se),Math.abs(At))},m.b_=function(o,r){return o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5],o[6]=r[6],o[7]=r[7],o[8]=r[8],o[9]=r[9],o[10]=r[10],o[11]=r[11],o[12]=r[12],o[13]=r[13],o[14]=r[14],o[15]=r[15],o},m.ba=ih,m.bb=yc,m.bc=Rt,m.bd=Mr,m.be=gi,m.bf=function(o,r,s,c,f){return Rt(c,f,Tr((o-r)/(s-r),0,1))},m.bg=yt,m.bh=function(){return new Float64Array(4)},m.bi=function(){return new Float64Array(3)},m.bj=function(o,r,s,c){var f=[],v=[];return f[0]=r[0]-s[0],f[1]=r[1]-s[1],f[2]=r[2]-s[2],v[0]=f[0]*Math.cos(c)-f[1]*Math.sin(c),v[1]=f[0]*Math.sin(c)+f[1]*Math.cos(c),v[2]=f[2],o[0]=v[0]+s[0],o[1]=v[1]+s[1],o[2]=v[2]+s[2],o},m.bk=function(o,r,s,c){var f=[],v=[];return f[0]=r[0]-s[0],f[1]=r[1]-s[1],f[2]=r[2]-s[2],v[0]=f[0],v[1]=f[1]*Math.cos(c)-f[2]*Math.sin(c),v[2]=f[1]*Math.sin(c)+f[2]*Math.cos(c),o[0]=v[0]+s[0],o[1]=v[1]+s[1],o[2]=v[2]+s[2],o},m.bl=function(o,r,s,c){var f=[],v=[];return f[0]=r[0]-s[0],f[1]=r[1]-s[1],f[2]=r[2]-s[2],v[0]=f[2]*Math.sin(c)+f[0]*Math.cos(c),v[1]=f[1],v[2]=f[2]*Math.cos(c)-f[0]*Math.sin(c),o[0]=v[0]+s[0],o[1]=v[1]+s[1],o[2]=v[2]+s[2],o},m.bm=function(o,r,s){var c=Math.sin(s),f=Math.cos(s),v=r[0],b=r[1],w=r[2],S=r[3],C=r[8],A=r[9],R=r[10],j=r[11];return r!==o&&(o[4]=r[4],o[5]=r[5],o[6]=r[6],o[7]=r[7],o[12]=r[12],o[13]=r[13],o[14]=r[14],o[15]=r[15]),o[0]=v*f-C*c,o[1]=b*f-A*c,o[2]=w*f-R*c,o[3]=S*f-j*c,o[8]=v*c+C*f,o[9]=b*c+A*f,o[10]=w*c+R*f,o[11]=S*c+j*f,o},m.bn=function(o,r){const s=yt(o,360),c=yt(r,360),f=c-s,v=c>s?f-360:f+360;return Math.abs(f)<Math.abs(v)?f:v},m.bo=function(o){return o[0]=0,o[1]=0,o[2]=0,o},m.bp=function(o,r,s,c){const f=Math.sqrt(o*o+r*r),v=Math.sqrt(s*s+c*c);o/=f,r/=f,s/=v,c/=v;const b=Math.acos(o*s+r*c);return-r*s+o*c>0?b:-b},m.bq=function(o,r){return o[0]*r[0]+o[1]*r[1]+o[2]*r[2]+o[3]},m.br=Dm,m.bs=function(o,r){const s=yt(o,2*Math.PI),c=yt(r,2*Math.PI);return Math.min(Math.abs(s-c),Math.abs(s-c+2*Math.PI),Math.abs(s-c-2*Math.PI))},m.bt=function(o){return Math.hypot(o[0],o[1],o[2])},m.bu=function(){const o={},r=U.$version;for(const s in U.$root){const c=U.$root[s];if(c.required){let f=null;f=s==="version"?r:c.type==="array"?[]:{},f!=null&&(o[s]=f)}}return o},m.bv=Ou,m.bw=Wr,m.bx=function(o){o=o.slice();const r=Object.create(null);for(let s=0;s<o.length;s++)r[o[s].id]=o[s];for(let s=0;s<o.length;s++)"ref"in o[s]&&(o[s]=xe(o[s],r[o[s].ref]));return o},m.by=function(o){if(o.type==="custom")return new LT(o);switch(o.type){case"background":return new PT(o);case"circle":return new S2(o);case"fill":return new U2(o);case"fill-extrusion":return new Y2(o);case"heatmap":return new C2(o);case"hillshade":return new M2(o);case"line":return new oT(o);case"raster":return new kT(o);case"symbol":return new vf(o)}},m.bz=vr,m.c=It,m.c0=o=>o.type==="circle",m.c1=o=>o.type==="heatmap",m.c2=o=>o.type==="line",m.c3=o=>o.type==="fill",m.c4=o=>o.type==="fill-extrusion",m.c5=o=>o.type==="hillshade",m.c6=o=>o.type==="raster",m.c7=o=>o.type==="background",m.c8=o=>o.type==="custom",m.c9=_r,m.cA=class{constructor(o){this._marks={start:[o.url,"start"].join("#"),end:[o.url,"end"].join("#"),measure:o.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let o=performance.getEntriesByName(this._marks.measure);return o.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),o=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),o}},m.cB=function(o,r,s,c,f){return a(this,void 0,void 0,function*(){if(re())try{return yield nt(o,r,s,c,f)}catch{}return function(v,b,w,S,C){const A=v.width,R=v.height;st&&_t||(st=new OffscreenCanvas(A,R),_t=st.getContext("2d",{willReadFrequently:!0})),st.width=A,st.height=R,_t.drawImage(v,0,0,A,R);const j=_t.getImageData(b,w,S,C);return _t.clearRect(0,0,A,R),j.data}(o,r,s,c,f)})},m.cC=_v,m.cD=I,m.cE=k,m.cF=Dy,m.cG=Hy,m.cH=ec,m.cI=mo,m.ca=function(o,r,s){const c=vt(r.x-s.x,r.y-s.y),f=vt(o.x-s.x,o.y-s.y);var v,b;return ht(Math.atan2(c[0]*f[1]-c[1]*f[0],(v=c)[0]*(b=f)[0]+v[1]*b[1]))},m.cb=pr,m.cc=function(o,r){return Lt[r]&&(o instanceof MouseEvent||o instanceof WheelEvent)},m.cd=function(o,r){return lt[r]&&"touches"in o},m.ce=function(o){return lt[o]||Lt[o]},m.cf=function(o,r,s){var c=r[0],f=r[1];return o[0]=s[0]*c+s[4]*f+s[12],o[1]=s[1]*c+s[5]*f+s[13],o},m.cg=function(o,r){const{x:s,y:c}=hh.fromLngLat(r);return!(o<0||o>25||c<0||c>=1||s<0||s>=1)},m.ch=function(o,r){return o[0]=r[0],o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=r[1],o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=r[2],o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o},m.ci=class extends Jn{},m.cj=UT,m.cl=function(o){return o.message===bt},m.cm=er,m.cn=function(o,r){Ot.REGISTERED_PROTOCOLS[o]=r},m.co=function(o){delete Ot.REGISTERED_PROTOCOLS[o]},m.cp=function(o,r){const s={};for(let f=0;f<o.length;f++){const v=r&&r[o[f].id]||Jp(o[f]);r&&(r[o[f].id]=v);let b=s[v];b||(b=s[v]=[]),b.push(o[f])}const c=[];for(const f in s)c.push(s[f]);return c},m.cq=wt,m.cr=yv,m.cs=bv,m.ct=Ky,m.cu=function(o){o.bucket.createArrays(),o.bucket.tilePixelRatio=Xe/(512*o.bucket.overscaling),o.bucket.compareText={},o.bucket.iconsNeedLinear=!1;const r=o.bucket.layers[0],s=r.layout,c=r._unevaluatedLayout._values,f={layoutIconSize:c["icon-size"].possiblyEvaluate(new Dr(o.bucket.zoom+1),o.canonical),layoutTextSize:c["text-size"].possiblyEvaluate(new Dr(o.bucket.zoom+1),o.canonical),textMaxSize:c["text-size"].possiblyEvaluate(new Dr(18))};if(o.bucket.textSizeData.kind==="composite"){const{minZoom:C,maxZoom:A}=o.bucket.textSizeData;f.compositeTextSizes=[c["text-size"].possiblyEvaluate(new Dr(C),o.canonical),c["text-size"].possiblyEvaluate(new Dr(A),o.canonical)]}if(o.bucket.iconSizeData.kind==="composite"){const{minZoom:C,maxZoom:A}=o.bucket.iconSizeData;f.compositeIconSizes=[c["icon-size"].possiblyEvaluate(new Dr(C),o.canonical),c["icon-size"].possiblyEvaluate(new Dr(A),o.canonical)]}const v=s.get("text-line-height")*yi,b=s.get("text-rotation-alignment")!=="viewport"&&s.get("symbol-placement")!=="point",w=s.get("text-keep-upright"),S=s.get("text-size");for(const C of o.bucket.features){const A=s.get("text-font").evaluate(C,{},o.canonical).join(","),R=S.evaluate(C,{},o.canonical),j=f.layoutTextSize.evaluate(C,{},o.canonical),$=f.layoutIconSize.evaluate(C,{},o.canonical),G={horizontal:{},vertical:void 0},W=C.text;let te,se=[0,0];if(W){const V=W.toString(),ee=s.get("text-letter-spacing").evaluate(C,{},o.canonical)*yi,de=Qd(V)?ee:0,Fe=s.get("text-anchor").evaluate(C,{},o.canonical),et=Lv(r,C,o.canonical);if(!et){const tt=s.get("text-radial-offset").evaluate(C,{},o.canonical);se=tt?kv(Fe,[tt*yi,Bm]):s.get("text-offset").evaluate(C,{},o.canonical).map(ct=>ct*yi)}let je=b?"center":s.get("text-justify").evaluate(C,{},o.canonical);const $e=s.get("symbol-placement")==="point"?s.get("text-max-width").evaluate(C,{},o.canonical)*yi:1/0,ot=()=>{o.bucket.allowVerticalPlacement&&lc(V)&&(G.vertical=gf(W,o.glyphMap,o.glyphPositions,o.imagePositions,A,$e,v,Fe,"left",de,se,m.ah.vertical,!0,j,R))};if(!b&&et){const tt=new Set;if(je==="auto")for(let qe=0;qe<et.values.length;qe+=2)tt.add(jm(et.values[qe]));else tt.add(je);let ct=!1;for(const qe of tt)if(!G.horizontal[qe])if(ct)G.horizontal[qe]=G.horizontal[0];else{const Tt=gf(W,o.glyphMap,o.glyphPositions,o.imagePositions,A,$e,v,"center",qe,de,se,m.ah.horizontal,!1,j,R);Tt&&(G.horizontal[qe]=Tt,ct=Tt.positionedLines.length===1)}ot()}else{je==="auto"&&(je=jm(Fe));const tt=gf(W,o.glyphMap,o.glyphPositions,o.imagePositions,A,$e,v,Fe,je,de,se,m.ah.horizontal,!1,j,R);tt&&(G.horizontal[je]=tt),ot(),lc(V)&&b&&w&&(G.vertical=gf(W,o.glyphMap,o.glyphPositions,o.imagePositions,A,$e,v,Fe,je,de,se,m.ah.vertical,!1,j,R))}}let ye=!1;if(C.icon&&C.icon.name){const V=o.imageMap[C.icon.name];V&&(te=ST(o.imagePositions[C.icon.name],s.get("icon-offset").evaluate(C,{},o.canonical),s.get("icon-anchor").evaluate(C,{},o.canonical)),ye=!!V.sdf,o.bucket.sdfIcons===void 0?o.bucket.sdfIcons=ye:o.bucket.sdfIcons!==ye&&Pr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(V.pixelRatio!==o.bucket.pixelRatio||s.get("icon-rotate").constantOr(1)!==0)&&(o.bucket.iconsNeedLinear=!0))}const ue=Rv(G.horizontal)||G.vertical;o.bucket.iconsInText=!!ue&&ue.iconsInText,(ue||te)&&VT(o.bucket,C,G,te,o.imageMap,f,j,$,se,ye,o.canonical,o.subdivisionGranularity)}o.showCollisionBoxes&&o.bucket.generateCollisionDebugBuffers()},m.cv=wm,m.cw=gm,m.cx=xm,m.cy=oh,m.cz=Em,m.d=zi,m.e=Pt,m.f=o=>a(void 0,void 0,void 0,function*(){if(o.byteLength===0)return createImageBitmap(new ImageData(1,1));const r=new Blob([new Uint8Array(o)],{type:"image/png"});try{return createImageBitmap(r)}catch(s){throw new Error(`Could not load image because of ${s.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),m.g=qt,m.h=o=>new Promise((r,s)=>{const c=new Image;c.onload=()=>{r(c),URL.revokeObjectURL(c.src),c.onload=null,window.requestAnimationFrame(()=>{c.src=at})},c.onerror=()=>s(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const f=new Blob([new Uint8Array(o)],{type:"image/png"});c.src=o.byteLength?URL.createObjectURL(f):at}),m.i=pe,m.j=(o,r)=>Kr(Pt(o,{type:"json"}),r),m.k=q,m.l=Pe,m.m=Kr,m.n=(o,r)=>Kr(Pt(o,{type:"arrayBuffer"}),r),m.o=function(o){return new Em(o).readFields(dT,[])},m.p=Wy,m.q=Ju,m.r=cn,m.s=ut,m.t=Ru,m.u=rr,m.v=U,m.w=Pr,m.x=sa,m.y=ds,m.z=function([o,r,s]){return r+=90,r*=Math.PI/180,s*=Math.PI/180,{x:o*Math.cos(r)*Math.sin(s),y:o*Math.sin(r)*Math.sin(s),z:o*Math.cos(s)}}}),p("worker",["./shared"],function(m){class a{constructor(q){this.keyCache={},q&&this.replace(q)}replace(q){this._layerConfigs={},this._layers={},this.update(q,[])}update(q,Y){for(const he of q){this._layerConfigs[he.id]=he;const xe=this._layers[he.id]=m.by(he);xe._featureFilter=m.a7(xe.filter),this.keyCache[he.id]&&delete this.keyCache[he.id]}for(const he of Y)delete this.keyCache[he],delete this._layerConfigs[he],delete this._layers[he];this.familiesBySource={};const U=m.cp(Object.values(this._layerConfigs),this.keyCache);for(const he of U){const xe=he.map(ke=>this._layers[ke.id]),ve=xe[0];if(ve.visibility==="none")continue;const ze=ve.source||"";let Ce=this.familiesBySource[ze];Ce||(Ce=this.familiesBySource[ze]={});const Ge=ve.sourceLayer||"_geojsonTileLayer";let Ne=Ce[Ge];Ne||(Ne=Ce[Ge]=[]),Ne.push(xe)}}}class I{constructor(q){const Y={},U=[];for(const ze in q){const Ce=q[ze],Ge=Y[ze]={};for(const Ne in Ce){const ke=Ce[+Ne];if(!ke||ke.bitmap.width===0||ke.bitmap.height===0)continue;const Qe={x:0,y:0,w:ke.bitmap.width+2,h:ke.bitmap.height+2};U.push(Qe),Ge[Ne]={rect:Qe,metrics:ke.metrics}}}const{w:he,h:xe}=m.p(U),ve=new m.q({width:he||1,height:xe||1});for(const ze in q){const Ce=q[ze];for(const Ge in Ce){const Ne=Ce[+Ge];if(!Ne||Ne.bitmap.width===0||Ne.bitmap.height===0)continue;const ke=Y[ze][Ge].rect;m.q.copy(Ne.bitmap,ve,{x:0,y:0},{x:ke.x+1,y:ke.y+1},Ne.bitmap)}}this.image=ve,this.positions=Y}}m.cq("GlyphAtlas",I);class z{constructor(q){this.tileID=new m.Y(q.tileID.overscaledZ,q.tileID.wrap,q.tileID.canonical.z,q.tileID.canonical.x,q.tileID.canonical.y),this.uid=q.uid,this.zoom=q.zoom,this.pixelRatio=q.pixelRatio,this.tileSize=q.tileSize,this.source=q.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=q.showCollisionBoxes,this.collectResourceTiming=!!q.collectResourceTiming,this.returnDependencies=!!q.returnDependencies,this.promoteId=q.promoteId,this.inFlightDependencies=[]}parse(q,Y,U,he,xe){return m._(this,void 0,void 0,function*(){this.status="parsing",this.data=q,this.collisionBoxArray=new m.a5;const ve=new m.cr(Object.keys(q.layers).sort()),ze=new m.cs(this.tileID,this.promoteId);ze.bucketLayerIDs=[];const Ce={},Ge={featureIndex:ze,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:U,subdivisionGranularity:xe},Ne=Y.familiesBySource[this.source];for(const pt in Ne){const Ut=q.layers[pt];if(!Ut)continue;Ut.version===1&&m.w(`Vector tile source "${this.source}" layer "${pt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Xr=ve.encode(pt),uo=[];for(let Ft=0;Ft<Ut.length;Ft++){const mi=Ut.feature(Ft),zr=ze.getId(mi,pt);uo.push({feature:mi,id:zr,index:Ft,sourceLayerIndex:Xr})}for(const Ft of Ne[pt]){const mi=Ft[0];mi.source!==this.source&&m.w(`layer.source = ${mi.source} does not equal this.source = ${this.source}`),mi.minzoom&&this.zoom<Math.floor(mi.minzoom)||mi.maxzoom&&this.zoom>=mi.maxzoom||mi.visibility!=="none"&&(P(Ft,this.zoom,U),(Ce[mi.id]=mi.createBucket({index:ze.bucketLayerIDs.length,layers:Ft,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Xr,sourceID:this.source})).populate(uo,Ge,this.tileID.canonical),ze.bucketLayerIDs.push(Ft.map(zr=>zr.id)))}}const ke=m.bD(Ge.glyphDependencies,pt=>Object.keys(pt).map(Number));this.inFlightDependencies.forEach(pt=>pt==null?void 0:pt.abort()),this.inFlightDependencies=[];let Qe=Promise.resolve({});if(Object.keys(ke).length){const pt=new AbortController;this.inFlightDependencies.push(pt),Qe=he.sendAsync({type:"GG",data:{stacks:ke,source:this.source,tileID:this.tileID,type:"glyphs"}},pt)}const mt=Object.keys(Ge.iconDependencies);let gt=Promise.resolve({});if(mt.length){const pt=new AbortController;this.inFlightDependencies.push(pt),gt=he.sendAsync({type:"GI",data:{icons:mt,source:this.source,tileID:this.tileID,type:"icons"}},pt)}const Ve=Object.keys(Ge.patternDependencies);let Nt=Promise.resolve({});if(Ve.length){const pt=new AbortController;this.inFlightDependencies.push(pt),Nt=he.sendAsync({type:"GI",data:{icons:Ve,source:this.source,tileID:this.tileID,type:"patterns"}},pt)}const[kt,jt,ar]=yield Promise.all([Qe,gt,Nt]),rt=new I(kt),St=new m.ct(jt,ar);for(const pt in Ce){const Ut=Ce[pt];Ut instanceof m.a6?(P(Ut.layers,this.zoom,U),m.cu({bucket:Ut,glyphMap:kt,glyphPositions:rt.positions,imageMap:jt,imagePositions:St.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:Ge.subdivisionGranularity})):Ut.hasPattern&&(Ut instanceof m.cv||Ut instanceof m.cw||Ut instanceof m.cx)&&(P(Ut.layers,this.zoom,U),Ut.addFeatures(Ge,this.tileID.canonical,St.patternPositions))}return this.status="done",{buckets:Object.values(Ce).filter(pt=>!pt.isEmpty()),featureIndex:ze,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:rt.image,imageAtlas:St,glyphMap:this.returnDependencies?kt:null,iconMap:this.returnDependencies?jt:null,glyphPositions:this.returnDependencies?rt.positions:null}})}}function P(Pe,q,Y){const U=new m.C(q);for(const he of Pe)he.recalculate(U,Y)}class k{constructor(q,Y,U){this.actor=q,this.layerIndex=Y,this.availableImages=U,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(q,Y){return m._(this,void 0,void 0,function*(){const U=yield m.n(q.request,Y);try{return{vectorTile:new m.cy.VectorTile(new m.cz(U.data)),rawData:U.data,cacheControl:U.cacheControl,expires:U.expires}}catch(he){const xe=new Uint8Array(U.data);let ve=`Unable to parse the tile at ${q.request.url}, `;throw ve+=xe[0]===31&&xe[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${he.message}`,new Error(ve)}})}loadTile(q){return m._(this,void 0,void 0,function*(){const Y=q.uid,U=!!(q&&q.request&&q.request.collectResourceTiming)&&new m.cA(q.request),he=new z(q);this.loading[Y]=he;const xe=new AbortController;he.abort=xe;try{const ve=yield this.loadVectorTile(q,xe);if(delete this.loading[Y],!ve)return null;const ze=ve.rawData,Ce={};ve.expires&&(Ce.expires=ve.expires),ve.cacheControl&&(Ce.cacheControl=ve.cacheControl);const Ge={};if(U){const ke=U.finish();ke&&(Ge.resourceTiming=JSON.parse(JSON.stringify(ke)))}he.vectorTile=ve.vectorTile;const Ne=he.parse(ve.vectorTile,this.layerIndex,this.availableImages,this.actor,q.subdivisionGranularity);this.loaded[Y]=he,this.fetching[Y]={rawTileData:ze,cacheControl:Ce,resourceTiming:Ge};try{const ke=yield Ne;return m.e({rawTileData:ze.slice(0)},ke,Ce,Ge)}finally{delete this.fetching[Y]}}catch(ve){throw delete this.loading[Y],he.status="done",this.loaded[Y]=he,ve}})}reloadTile(q){return m._(this,void 0,void 0,function*(){const Y=q.uid;if(!this.loaded||!this.loaded[Y])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const U=this.loaded[Y];if(U.showCollisionBoxes=q.showCollisionBoxes,U.status==="parsing"){const he=yield U.parse(U.vectorTile,this.layerIndex,this.availableImages,this.actor,q.subdivisionGranularity);let xe;if(this.fetching[Y]){const{rawTileData:ve,cacheControl:ze,resourceTiming:Ce}=this.fetching[Y];delete this.fetching[Y],xe=m.e({rawTileData:ve.slice(0)},he,ze,Ce)}else xe=he;return xe}if(U.status==="done"&&U.vectorTile)return U.parse(U.vectorTile,this.layerIndex,this.availableImages,this.actor,q.subdivisionGranularity)})}abortTile(q){return m._(this,void 0,void 0,function*(){const Y=this.loading,U=q.uid;Y&&Y[U]&&Y[U].abort&&(Y[U].abort.abort(),delete Y[U])})}removeTile(q){return m._(this,void 0,void 0,function*(){this.loaded&&this.loaded[q.uid]&&delete this.loaded[q.uid]})}}class N{constructor(){this.loaded={}}loadTile(q){return m._(this,void 0,void 0,function*(){const{uid:Y,encoding:U,rawImageData:he,redFactor:xe,greenFactor:ve,blueFactor:ze,baseShift:Ce}=q,Ge=he.width+2,Ne=he.height+2,ke=m.b(he)?new m.R({width:Ge,height:Ne},yield m.cB(he,-1,-1,Ge,Ne)):he,Qe=new m.cC(Y,ke,U,xe,ve,ze,Ce);return this.loaded=this.loaded||{},this.loaded[Y]=Qe,Qe})}removeTile(q){const Y=this.loaded,U=q.uid;Y&&Y[U]&&delete Y[U]}}var F,H,X=function(){if(H)return F;function Pe(Y,U){if(Y.length!==0){q(Y[0],U);for(var he=1;he<Y.length;he++)q(Y[he],!U)}}function q(Y,U){for(var he=0,xe=0,ve=0,ze=Y.length,Ce=ze-1;ve<ze;Ce=ve++){var Ge=(Y[ve][0]-Y[Ce][0])*(Y[Ce][1]+Y[ve][1]),Ne=he+Ge;xe+=Math.abs(he)>=Math.abs(Ge)?he-Ne+Ge:Ge-Ne+he,he=Ne}he+xe>=0!=!!U&&Y.reverse()}return H=1,F=function Y(U,he){var xe,ve=U&&U.type;if(ve==="FeatureCollection")for(xe=0;xe<U.features.length;xe++)Y(U.features[xe],he);else if(ve==="GeometryCollection")for(xe=0;xe<U.geometries.length;xe++)Y(U.geometries[xe],he);else if(ve==="Feature")Y(U.geometry,he);else if(ve==="Polygon")Pe(U.coordinates,he);else if(ve==="MultiPolygon")for(xe=0;xe<U.coordinates.length;xe++)Pe(U.coordinates[xe],he);return U}}(),ae=m.cD(X);const Se=m.cy.VectorTileFeature.prototype.toGeoJSON;class be{constructor(q){this._feature=q,this.extent=m.Z,this.type=q.type,this.properties=q.tags,"id"in q&&!isNaN(q.id)&&(this.id=parseInt(q.id,10))}loadGeometry(){if(this._feature.type===1){const q=[];for(const Y of this._feature.geometry)q.push([new m.P(Y[0],Y[1])]);return q}{const q=[];for(const Y of this._feature.geometry){const U=[];for(const he of Y)U.push(new m.P(he[0],he[1]));q.push(U)}return q}}toGeoJSON(q,Y,U){return Se.call(this,q,Y,U)}}class Q{constructor(q){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=m.Z,this.length=q.length,this._features=q}feature(q){return new be(this._features[q])}}var re,J,le,Me={exports:{}},Ie=function(){if(le)return Me.exports;le=1;var Pe=m.cG(),q=function(){if(J)return re;J=1;var Ne=m.cE(),ke=m.cF().VectorTileFeature;function Qe(gt,Ve){this.options=Ve||{},this.features=gt,this.length=gt.length}function mt(gt,Ve){this.id=typeof gt.id=="number"?gt.id:void 0,this.type=gt.type,this.rawGeometry=gt.type===1?[gt.geometry]:gt.geometry,this.properties=gt.tags,this.extent=Ve||4096}return re=Qe,Qe.prototype.feature=function(gt){return new mt(this.features[gt],this.options.extent)},mt.prototype.loadGeometry=function(){var gt=this.rawGeometry;this.geometry=[];for(var Ve=0;Ve<gt.length;Ve++){for(var Nt=gt[Ve],kt=[],jt=0;jt<Nt.length;jt++)kt.push(new Ne(Nt[jt][0],Nt[jt][1]));this.geometry.push(kt)}return this.geometry},mt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var gt=this.geometry,Ve=1/0,Nt=-1/0,kt=1/0,jt=-1/0,ar=0;ar<gt.length;ar++)for(var rt=gt[ar],St=0;St<rt.length;St++){var pt=rt[St];Ve=Math.min(Ve,pt.x),Nt=Math.max(Nt,pt.x),kt=Math.min(kt,pt.y),jt=Math.max(jt,pt.y)}return[Ve,kt,Nt,jt]},mt.prototype.toGeoJSON=ke.prototype.toGeoJSON,re}();function Y(Ne){var ke=new Pe;return function(Qe,mt){for(var gt in Qe.layers)mt.writeMessage(3,U,Qe.layers[gt])}(Ne,ke),ke.finish()}function U(Ne,ke){var Qe;ke.writeVarintField(15,Ne.version||1),ke.writeStringField(1,Ne.name||""),ke.writeVarintField(5,Ne.extent||4096);var mt={keys:[],values:[],keycache:{},valuecache:{}};for(Qe=0;Qe<Ne.length;Qe++)mt.feature=Ne.feature(Qe),ke.writeMessage(2,he,mt);var gt=mt.keys;for(Qe=0;Qe<gt.length;Qe++)ke.writeStringField(3,gt[Qe]);var Ve=mt.values;for(Qe=0;Qe<Ve.length;Qe++)ke.writeMessage(4,Ge,Ve[Qe])}function he(Ne,ke){var Qe=Ne.feature;Qe.id!==void 0&&ke.writeVarintField(1,Qe.id),ke.writeMessage(2,xe,Ne),ke.writeVarintField(3,Qe.type),ke.writeMessage(4,Ce,Qe)}function xe(Ne,ke){var Qe=Ne.feature,mt=Ne.keys,gt=Ne.values,Ve=Ne.keycache,Nt=Ne.valuecache;for(var kt in Qe.properties){var jt=Qe.properties[kt],ar=Ve[kt];if(jt!==null){ar===void 0&&(mt.push(kt),Ve[kt]=ar=mt.length-1),ke.writeVarint(ar);var rt=typeof jt;rt!=="string"&&rt!=="boolean"&&rt!=="number"&&(jt=JSON.stringify(jt));var St=rt+":"+jt,pt=Nt[St];pt===void 0&&(gt.push(jt),Nt[St]=pt=gt.length-1),ke.writeVarint(pt)}}}function ve(Ne,ke){return(ke<<3)+(7&Ne)}function ze(Ne){return Ne<<1^Ne>>31}function Ce(Ne,ke){for(var Qe=Ne.loadGeometry(),mt=Ne.type,gt=0,Ve=0,Nt=Qe.length,kt=0;kt<Nt;kt++){var jt=Qe[kt],ar=1;mt===1&&(ar=jt.length),ke.writeVarint(ve(1,ar));for(var rt=mt===3?jt.length-1:jt.length,St=0;St<rt;St++){St===1&&mt!==1&&ke.writeVarint(ve(2,rt-1));var pt=jt[St].x-gt,Ut=jt[St].y-Ve;ke.writeVarint(ze(pt)),ke.writeVarint(ze(Ut)),gt+=pt,Ve+=Ut}mt===3&&ke.writeVarint(ve(7,1))}}function Ge(Ne,ke){var Qe=typeof Ne;Qe==="string"?ke.writeStringField(1,Ne):Qe==="boolean"?ke.writeBooleanField(7,Ne):Qe==="number"&&(Ne%1!=0?ke.writeDoubleField(3,Ne):Ne<0?ke.writeSVarintField(6,Ne):ke.writeVarintField(5,Ne))}return Me.exports=Y,Me.exports.fromVectorTileJs=Y,Me.exports.fromGeojsonVt=function(Ne,ke){ke=ke||{};var Qe={};for(var mt in Ne)Qe[mt]=new q(Ne[mt].features,ke),Qe[mt].name=mt,Qe[mt].version=ke.version,Qe[mt].extent=ke.extent;return Y({layers:Qe})},Me.exports.GeoJSONWrapper=q,Me.exports}(),Be=m.cD(Ie);const Ee={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Pe=>Pe},Re=Math.fround||(Ae=new Float32Array(1),Pe=>(Ae[0]=+Pe,Ae[0]));var Ae;const He=3,it=5,vt=6;class Xe{constructor(q){this.options=Object.assign(Object.create(Ee),q),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(q){const{log:Y,minZoom:U,maxZoom:he}=this.options;Y&&console.time("total time");const xe=`prepare ${q.length} points`;Y&&console.time(xe),this.points=q;const ve=[];for(let Ce=0;Ce<q.length;Ce++){const Ge=q[Ce];if(!Ge.geometry)continue;const[Ne,ke]=Ge.geometry.coordinates,Qe=Re(Rt(Ne)),mt=Re(Mr(ke));ve.push(Qe,mt,1/0,Ce,-1,1),this.options.reduce&&ve.push(0)}let ze=this.trees[he+1]=this._createTree(ve);Y&&console.timeEnd(xe);for(let Ce=he;Ce>=U;Ce--){const Ge=+Date.now();ze=this.trees[Ce]=this._createTree(this._cluster(ze,Ce)),Y&&console.log("z%d: %d clusters in %dms",Ce,ze.numItems,+Date.now()-Ge)}return Y&&console.timeEnd("total time"),this}getClusters(q,Y){let U=((q[0]+180)%360+360)%360-180;const he=Math.max(-90,Math.min(90,q[1]));let xe=q[2]===180?180:((q[2]+180)%360+360)%360-180;const ve=Math.max(-90,Math.min(90,q[3]));if(q[2]-q[0]>=360)U=-180,xe=180;else if(U>xe){const ke=this.getClusters([U,he,180,ve],Y),Qe=this.getClusters([-180,he,xe,ve],Y);return ke.concat(Qe)}const ze=this.trees[this._limitZoom(Y)],Ce=ze.range(Rt(U),Mr(ve),Rt(xe),Mr(he)),Ge=ze.data,Ne=[];for(const ke of Ce){const Qe=this.stride*ke;Ne.push(Ge[Qe+it]>1?xt(Ge,Qe,this.clusterProps):this.points[Ge[Qe+He]])}return Ne}getChildren(q){const Y=this._getOriginId(q),U=this._getOriginZoom(q),he="No cluster with the specified id.",xe=this.trees[U];if(!xe)throw new Error(he);const ve=xe.data;if(Y*this.stride>=ve.length)throw new Error(he);const ze=this.options.radius/(this.options.extent*Math.pow(2,U-1)),Ce=xe.within(ve[Y*this.stride],ve[Y*this.stride+1],ze),Ge=[];for(const Ne of Ce){const ke=Ne*this.stride;ve[ke+4]===q&&Ge.push(ve[ke+it]>1?xt(ve,ke,this.clusterProps):this.points[ve[ke+He]])}if(Ge.length===0)throw new Error(he);return Ge}getLeaves(q,Y,U){const he=[];return this._appendLeaves(he,q,Y=Y||10,U=U||0,0),he}getTile(q,Y,U){const he=this.trees[this._limitZoom(q)],xe=Math.pow(2,q),{extent:ve,radius:ze}=this.options,Ce=ze/ve,Ge=(U-Ce)/xe,Ne=(U+1+Ce)/xe,ke={features:[]};return this._addTileFeatures(he.range((Y-Ce)/xe,Ge,(Y+1+Ce)/xe,Ne),he.data,Y,U,xe,ke),Y===0&&this._addTileFeatures(he.range(1-Ce/xe,Ge,1,Ne),he.data,xe,U,xe,ke),Y===xe-1&&this._addTileFeatures(he.range(0,Ge,Ce/xe,Ne),he.data,-1,U,xe,ke),ke.features.length?ke:null}getClusterExpansionZoom(q){let Y=this._getOriginZoom(q)-1;for(;Y<=this.options.maxZoom;){const U=this.getChildren(q);if(Y++,U.length!==1)break;q=U[0].properties.cluster_id}return Y}_appendLeaves(q,Y,U,he,xe){const ve=this.getChildren(Y);for(const ze of ve){const Ce=ze.properties;if(Ce&&Ce.cluster?xe+Ce.point_count<=he?xe+=Ce.point_count:xe=this._appendLeaves(q,Ce.cluster_id,U,he,xe):xe<he?xe++:q.push(ze),q.length===U)break}return xe}_createTree(q){const Y=new m.aC(q.length/this.stride|0,this.options.nodeSize,Float32Array);for(let U=0;U<q.length;U+=this.stride)Y.add(q[U],q[U+1]);return Y.finish(),Y.data=q,Y}_addTileFeatures(q,Y,U,he,xe,ve){for(const ze of q){const Ce=ze*this.stride,Ge=Y[Ce+it]>1;let Ne,ke,Qe;if(Ge)Ne=yt(Y,Ce,this.clusterProps),ke=Y[Ce],Qe=Y[Ce+1];else{const Ve=this.points[Y[Ce+He]];Ne=Ve.properties;const[Nt,kt]=Ve.geometry.coordinates;ke=Rt(Nt),Qe=Mr(kt)}const mt={type:1,geometry:[[Math.round(this.options.extent*(ke*xe-U)),Math.round(this.options.extent*(Qe*xe-he))]],tags:Ne};let gt;gt=Ge||this.options.generateId?Y[Ce+He]:this.points[Y[Ce+He]].id,gt!==void 0&&(mt.id=gt),ve.features.push(mt)}}_limitZoom(q){return Math.max(this.options.minZoom,Math.min(Math.floor(+q),this.options.maxZoom+1))}_cluster(q,Y){const{radius:U,extent:he,reduce:xe,minPoints:ve}=this.options,ze=U/(he*Math.pow(2,Y)),Ce=q.data,Ge=[],Ne=this.stride;for(let ke=0;ke<Ce.length;ke+=Ne){if(Ce[ke+2]<=Y)continue;Ce[ke+2]=Y;const Qe=Ce[ke],mt=Ce[ke+1],gt=q.within(Ce[ke],Ce[ke+1],ze),Ve=Ce[ke+it];let Nt=Ve;for(const kt of gt){const jt=kt*Ne;Ce[jt+2]>Y&&(Nt+=Ce[jt+it])}if(Nt>Ve&&Nt>=ve){let kt,jt=Qe*Ve,ar=mt*Ve,rt=-1;const St=((ke/Ne|0)<<5)+(Y+1)+this.points.length;for(const pt of gt){const Ut=pt*Ne;if(Ce[Ut+2]<=Y)continue;Ce[Ut+2]=Y;const Xr=Ce[Ut+it];jt+=Ce[Ut]*Xr,ar+=Ce[Ut+1]*Xr,Ce[Ut+4]=St,xe&&(kt||(kt=this._map(Ce,ke,!0),rt=this.clusterProps.length,this.clusterProps.push(kt)),xe(kt,this._map(Ce,Ut)))}Ce[ke+4]=St,Ge.push(jt/Nt,ar/Nt,1/0,St,-1,Nt),xe&&Ge.push(rt)}else{for(let kt=0;kt<Ne;kt++)Ge.push(Ce[ke+kt]);if(Nt>1)for(const kt of gt){const jt=kt*Ne;if(!(Ce[jt+2]<=Y)){Ce[jt+2]=Y;for(let ar=0;ar<Ne;ar++)Ge.push(Ce[jt+ar])}}}}return Ge}_getOriginId(q){return q-this.points.length>>5}_getOriginZoom(q){return(q-this.points.length)%32}_map(q,Y,U){if(q[Y+it]>1){const ve=this.clusterProps[q[Y+vt]];return U?Object.assign({},ve):ve}const he=this.points[q[Y+He]].properties,xe=this.options.map(he);return U&&xe===he?Object.assign({},xe):xe}}function xt(Pe,q,Y){return{type:"Feature",id:Pe[q+He],properties:yt(Pe,q,Y),geometry:{type:"Point",coordinates:[(U=Pe[q],360*(U-.5)),_r(Pe[q+1])]}};var U}function yt(Pe,q,Y){const U=Pe[q+it],he=U>=1e4?`${Math.round(U/1e3)}k`:U>=1e3?Math.round(U/100)/10+"k":U,xe=Pe[q+vt],ve=xe===-1?{}:Object.assign({},Y[xe]);return Object.assign(ve,{cluster:!0,cluster_id:Pe[q+He],point_count:U,point_count_abbreviated:he})}function Rt(Pe){return Pe/360+.5}function Mr(Pe){const q=Math.sin(Pe*Math.PI/180),Y=.5-.25*Math.log((1+q)/(1-q))/Math.PI;return Y<0?0:Y>1?1:Y}function _r(Pe){const q=(180-360*Pe)*Math.PI/180;return 360*Math.atan(Math.exp(q))/Math.PI-90}function pr(Pe,q,Y,U){let he=U;const xe=q+(Y-q>>1);let ve,ze=Y-q;const Ce=Pe[q],Ge=Pe[q+1],Ne=Pe[Y],ke=Pe[Y+1];for(let Qe=q+3;Qe<Y;Qe+=3){const mt=Tr(Pe[Qe],Pe[Qe+1],Ce,Ge,Ne,ke);if(mt>he)ve=Qe,he=mt;else if(mt===he){const gt=Math.abs(Qe-xe);gt<ze&&(ve=Qe,ze=gt)}}he>U&&(ve-q>3&&pr(Pe,q,ve,U),Pe[ve+2]=he,Y-ve>3&&pr(Pe,ve,Y,U))}function Tr(Pe,q,Y,U,he,xe){let ve=he-Y,ze=xe-U;if(ve!==0||ze!==0){const Ce=((Pe-Y)*ve+(q-U)*ze)/(ve*ve+ze*ze);Ce>1?(Y=he,U=xe):Ce>0&&(Y+=ve*Ce,U+=ze*Ce)}return ve=Pe-Y,ze=q-U,ve*ve+ze*ze}function Lr(Pe,q,Y,U){const he={id:Pe??null,type:q,geometry:Y,tags:U,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(q==="Point"||q==="MultiPoint"||q==="LineString")Pt(he,Y);else if(q==="Polygon")Pt(he,Y[0]);else if(q==="MultiLineString")for(const xe of Y)Pt(he,xe);else if(q==="MultiPolygon")for(const xe of Y)Pt(he,xe[0]);return he}function Pt(Pe,q){for(let Y=0;Y<q.length;Y+=3)Pe.minX=Math.min(Pe.minX,q[Y]),Pe.minY=Math.min(Pe.minY,q[Y+1]),Pe.maxX=Math.max(Pe.maxX,q[Y]),Pe.maxY=Math.max(Pe.maxY,q[Y+1])}function Yt(Pe,q,Y,U){if(!q.geometry)return;const he=q.geometry.coordinates;if(he&&he.length===0)return;const xe=q.geometry.type,ve=Math.pow(Y.tolerance/((1<<Y.maxZoom)*Y.extent),2);let ze=[],Ce=q.id;if(Y.promoteId?Ce=q.properties[Y.promoteId]:Y.generateId&&(Ce=U||0),xe==="Point")Jt(he,ze);else if(xe==="MultiPoint")for(const Ge of he)Jt(Ge,ze);else if(xe==="LineString")hr(he,ze,ve,!1);else if(xe==="MultiLineString"){if(Y.lineMetrics){for(const Ge of he)ze=[],hr(Ge,ze,ve,!1),Pe.push(Lr(Ce,"LineString",ze,q.properties));return}vr(he,ze,ve,!1)}else if(xe==="Polygon")vr(he,ze,ve,!0);else{if(xe!=="MultiPolygon"){if(xe==="GeometryCollection"){for(const Ge of q.geometry.geometries)Yt(Pe,{id:Ce,geometry:Ge,properties:q.properties},Y,U);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Ge of he){const Ne=[];vr(Ge,Ne,ve,!0),ze.push(Ne)}}Pe.push(Lr(Ce,xe,ze,q.properties))}function Jt(Pe,q){q.push(Ti(Pe[0]),Pr(Pe[1]),0)}function hr(Pe,q,Y,U){let he,xe,ve=0;for(let Ce=0;Ce<Pe.length;Ce++){const Ge=Ti(Pe[Ce][0]),Ne=Pr(Pe[Ce][1]);q.push(Ge,Ne,0),Ce>0&&(ve+=U?(he*Ne-Ge*xe)/2:Math.sqrt(Math.pow(Ge-he,2)+Math.pow(Ne-xe,2))),he=Ge,xe=Ne}const ze=q.length-3;q[2]=1,pr(q,0,ze,Y),q[ze+2]=1,q.size=Math.abs(ve),q.start=0,q.end=q.size}function vr(Pe,q,Y,U){for(let he=0;he<Pe.length;he++){const xe=[];hr(Pe[he],xe,Y,U),q.push(xe)}}function Ti(Pe){return Pe/360+.5}function Pr(Pe){const q=Math.sin(Pe*Math.PI/180),Y=.5-.25*Math.log((1+q)/(1-q))/Math.PI;return Y<0?0:Y>1?1:Y}function Sr(Pe,q,Y,U,he,xe,ve,ze){if(U/=q,xe>=(Y/=q)&&ve<U)return Pe;if(ve<Y||xe>=U)return null;const Ce=[];for(const Ge of Pe){const Ne=Ge.geometry;let ke=Ge.type;const Qe=he===0?Ge.minX:Ge.minY,mt=he===0?Ge.maxX:Ge.maxY;if(Qe>=Y&&mt<U){Ce.push(Ge);continue}if(mt<Y||Qe>=U)continue;let gt=[];if(ke==="Point"||ke==="MultiPoint")pe(Ne,gt,Y,U,he);else if(ke==="LineString")we(Ne,gt,Y,U,he,!1,ze.lineMetrics);else if(ke==="MultiLineString")at(Ne,gt,Y,U,he,!1);else if(ke==="Polygon")at(Ne,gt,Y,U,he,!0);else if(ke==="MultiPolygon")for(const Ve of Ne){const Nt=[];at(Ve,Nt,Y,U,he,!0),Nt.length&&gt.push(Nt)}if(gt.length){if(ze.lineMetrics&&ke==="LineString"){for(const Ve of gt)Ce.push(Lr(Ge.id,ke,Ve,Ge.tags));continue}ke!=="LineString"&&ke!=="MultiLineString"||(gt.length===1?(ke="LineString",gt=gt[0]):ke="MultiLineString"),ke!=="Point"&&ke!=="MultiPoint"||(ke=gt.length===3?"Point":"MultiPoint"),Ce.push(Lr(Ge.id,ke,gt,Ge.tags))}}return Ce.length?Ce:null}function pe(Pe,q,Y,U,he){for(let xe=0;xe<Pe.length;xe+=3){const ve=Pe[xe+he];ve>=Y&&ve<=U&&nt(q,Pe[xe],Pe[xe+1],Pe[xe+2])}}function we(Pe,q,Y,U,he,xe,ve){let ze=We(Pe);const Ce=he===0?st:_t;let Ge,Ne,ke=Pe.start;for(let Nt=0;Nt<Pe.length-3;Nt+=3){const kt=Pe[Nt],jt=Pe[Nt+1],ar=Pe[Nt+2],rt=Pe[Nt+3],St=Pe[Nt+4],pt=he===0?kt:jt,Ut=he===0?rt:St;let Xr=!1;ve&&(Ge=Math.sqrt(Math.pow(kt-rt,2)+Math.pow(jt-St,2))),pt<Y?Ut>Y&&(Ne=Ce(ze,kt,jt,rt,St,Y),ve&&(ze.start=ke+Ge*Ne)):pt>U?Ut<U&&(Ne=Ce(ze,kt,jt,rt,St,U),ve&&(ze.start=ke+Ge*Ne)):nt(ze,kt,jt,ar),Ut<Y&&pt>=Y&&(Ne=Ce(ze,kt,jt,rt,St,Y),Xr=!0),Ut>U&&pt<=U&&(Ne=Ce(ze,kt,jt,rt,St,U),Xr=!0),!xe&&Xr&&(ve&&(ze.end=ke+Ge*Ne),q.push(ze),ze=We(Pe)),ve&&(ke+=Ge)}let Qe=Pe.length-3;const mt=Pe[Qe],gt=Pe[Qe+1],Ve=he===0?mt:gt;Ve>=Y&&Ve<=U&&nt(ze,mt,gt,Pe[Qe+2]),Qe=ze.length-3,xe&&Qe>=3&&(ze[Qe]!==ze[0]||ze[Qe+1]!==ze[1])&&nt(ze,ze[0],ze[1],ze[2]),ze.length&&q.push(ze)}function We(Pe){const q=[];return q.size=Pe.size,q.start=Pe.start,q.end=Pe.end,q}function at(Pe,q,Y,U,he,xe){for(const ve of Pe)we(ve,q,Y,U,he,xe,!1)}function nt(Pe,q,Y,U){Pe.push(q,Y,U)}function st(Pe,q,Y,U,he,xe){const ve=(xe-q)/(U-q);return nt(Pe,xe,Y+(he-Y)*ve,1),ve}function _t(Pe,q,Y,U,he,xe){const ve=(xe-Y)/(he-Y);return nt(Pe,q+(U-q)*ve,xe,1),ve}function ut(Pe,q){const Y=[];for(let U=0;U<Pe.length;U++){const he=Pe[U],xe=he.type;let ve;if(xe==="Point"||xe==="MultiPoint"||xe==="LineString")ve=ht(he.geometry,q);else if(xe==="MultiLineString"||xe==="Polygon"){ve=[];for(const ze of he.geometry)ve.push(ht(ze,q))}else if(xe==="MultiPolygon"){ve=[];for(const ze of he.geometry){const Ce=[];for(const Ge of ze)Ce.push(ht(Ge,q));ve.push(Ce)}}Y.push(Lr(he.id,xe,ve,he.tags))}return Y}function ht(Pe,q){const Y=[];Y.size=Pe.size,Pe.start!==void 0&&(Y.start=Pe.start,Y.end=Pe.end);for(let U=0;U<Pe.length;U+=3)Y.push(Pe[U]+q,Pe[U+1],Pe[U+2]);return Y}function lt(Pe,q){if(Pe.transformed)return Pe;const Y=1<<Pe.z,U=Pe.x,he=Pe.y;for(const xe of Pe.features){const ve=xe.geometry,ze=xe.type;if(xe.geometry=[],ze===1)for(let Ce=0;Ce<ve.length;Ce+=2)xe.geometry.push(Lt(ve[Ce],ve[Ce+1],q,Y,U,he));else for(let Ce=0;Ce<ve.length;Ce++){const Ge=[];for(let Ne=0;Ne<ve[Ce].length;Ne+=2)Ge.push(Lt(ve[Ce][Ne],ve[Ce][Ne+1],q,Y,U,he));xe.geometry.push(Ge)}}return Pe.transformed=!0,Pe}function Lt(Pe,q,Y,U,he,xe){return[Math.round(Y*(Pe*U-he)),Math.round(Y*(q*U-xe))]}function bt(Pe,q,Y,U,he){const xe=q===he.maxZoom?0:he.tolerance/((1<<q)*he.extent),ve={features:[],numPoints:0,numSimplified:0,numFeatures:Pe.length,source:null,x:Y,y:U,z:q,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const ze of Pe)It(ve,ze,xe,he);return ve}function It(Pe,q,Y,U){const he=q.geometry,xe=q.type,ve=[];if(Pe.minX=Math.min(Pe.minX,q.minX),Pe.minY=Math.min(Pe.minY,q.minY),Pe.maxX=Math.max(Pe.maxX,q.maxX),Pe.maxY=Math.max(Pe.maxY,q.maxY),xe==="Point"||xe==="MultiPoint")for(let ze=0;ze<he.length;ze+=3)ve.push(he[ze],he[ze+1]),Pe.numPoints++,Pe.numSimplified++;else if(xe==="LineString")Ot(ve,he,Pe,Y,!1,!1);else if(xe==="MultiLineString"||xe==="Polygon")for(let ze=0;ze<he.length;ze++)Ot(ve,he[ze],Pe,Y,xe==="Polygon",ze===0);else if(xe==="MultiPolygon")for(let ze=0;ze<he.length;ze++){const Ce=he[ze];for(let Ge=0;Ge<Ce.length;Ge++)Ot(ve,Ce[Ge],Pe,Y,!0,Ge===0)}if(ve.length){let ze=q.tags||null;if(xe==="LineString"&&U.lineMetrics){ze={};for(const Ge in q.tags)ze[Ge]=q.tags[Ge];ze.mapbox_clip_start=he.start/he.size,ze.mapbox_clip_end=he.end/he.size}const Ce={geometry:ve,type:xe==="Polygon"||xe==="MultiPolygon"?3:xe==="LineString"||xe==="MultiLineString"?2:1,tags:ze};q.id!==null&&(Ce.id=q.id),Pe.features.push(Ce)}}function Ot(Pe,q,Y,U,he,xe){const ve=U*U;if(U>0&&q.size<(he?ve:U))return void(Y.numPoints+=q.length/3);const ze=[];for(let Ce=0;Ce<q.length;Ce+=3)(U===0||q[Ce+2]>ve)&&(Y.numSimplified++,ze.push(q[Ce],q[Ce+1])),Y.numPoints++;he&&function(Ce,Ge){let Ne=0;for(let ke=0,Qe=Ce.length,mt=Qe-2;ke<Qe;mt=ke,ke+=2)Ne+=(Ce[ke]-Ce[mt])*(Ce[ke+1]+Ce[mt+1]);if(Ne>0===Ge)for(let ke=0,Qe=Ce.length;ke<Qe/2;ke+=2){const mt=Ce[ke],gt=Ce[ke+1];Ce[ke]=Ce[Qe-2-ke],Ce[ke+1]=Ce[Qe-1-ke],Ce[Qe-2-ke]=mt,Ce[Qe-1-ke]=gt}}(ze,xe),Pe.push(ze)}const qt={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class ir{constructor(q,Y){const U=(Y=this.options=function(xe,ve){for(const ze in ve)xe[ze]=ve[ze];return xe}(Object.create(qt),Y)).debug;if(U&&console.time("preprocess data"),Y.maxZoom<0||Y.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Y.promoteId&&Y.generateId)throw new Error("promoteId and generateId cannot be used together.");let he=function(xe,ve){const ze=[];if(xe.type==="FeatureCollection")for(let Ce=0;Ce<xe.features.length;Ce++)Yt(ze,xe.features[Ce],ve,Ce);else Yt(ze,xe.type==="Feature"?xe:{geometry:xe},ve);return ze}(q,Y);this.tiles={},this.tileCoords=[],U&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Y.indexMaxZoom,Y.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),he=function(xe,ve){const ze=ve.buffer/ve.extent;let Ce=xe;const Ge=Sr(xe,1,-1-ze,ze,0,-1,2,ve),Ne=Sr(xe,1,1-ze,2+ze,0,-1,2,ve);return(Ge||Ne)&&(Ce=Sr(xe,1,-ze,1+ze,0,-1,2,ve)||[],Ge&&(Ce=ut(Ge,1).concat(Ce)),Ne&&(Ce=Ce.concat(ut(Ne,-1)))),Ce}(he,Y),he.length&&this.splitTile(he,0,0,0),U&&(he.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(q,Y,U,he,xe,ve,ze){const Ce=[q,Y,U,he],Ge=this.options,Ne=Ge.debug;for(;Ce.length;){he=Ce.pop(),U=Ce.pop(),Y=Ce.pop(),q=Ce.pop();const ke=1<<Y,Qe=er(Y,U,he);let mt=this.tiles[Qe];if(!mt&&(Ne>1&&console.time("creation"),mt=this.tiles[Qe]=bt(q,Y,U,he,Ge),this.tileCoords.push({z:Y,x:U,y:he}),Ne)){Ne>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Y,U,he,mt.numFeatures,mt.numPoints,mt.numSimplified),console.timeEnd("creation"));const Xr=`z${Y}`;this.stats[Xr]=(this.stats[Xr]||0)+1,this.total++}if(mt.source=q,xe==null){if(Y===Ge.indexMaxZoom||mt.numPoints<=Ge.indexMaxPoints)continue}else{if(Y===Ge.maxZoom||Y===xe)continue;if(xe!=null){const Xr=xe-Y;if(U!==ve>>Xr||he!==ze>>Xr)continue}}if(mt.source=null,q.length===0)continue;Ne>1&&console.time("clipping");const gt=.5*Ge.buffer/Ge.extent,Ve=.5-gt,Nt=.5+gt,kt=1+gt;let jt=null,ar=null,rt=null,St=null,pt=Sr(q,ke,U-gt,U+Nt,0,mt.minX,mt.maxX,Ge),Ut=Sr(q,ke,U+Ve,U+kt,0,mt.minX,mt.maxX,Ge);q=null,pt&&(jt=Sr(pt,ke,he-gt,he+Nt,1,mt.minY,mt.maxY,Ge),ar=Sr(pt,ke,he+Ve,he+kt,1,mt.minY,mt.maxY,Ge),pt=null),Ut&&(rt=Sr(Ut,ke,he-gt,he+Nt,1,mt.minY,mt.maxY,Ge),St=Sr(Ut,ke,he+Ve,he+kt,1,mt.minY,mt.maxY,Ge),Ut=null),Ne>1&&console.timeEnd("clipping"),Ce.push(jt||[],Y+1,2*U,2*he),Ce.push(ar||[],Y+1,2*U,2*he+1),Ce.push(rt||[],Y+1,2*U+1,2*he),Ce.push(St||[],Y+1,2*U+1,2*he+1)}}getTile(q,Y,U){q=+q,Y=+Y,U=+U;const he=this.options,{extent:xe,debug:ve}=he;if(q<0||q>24)return null;const ze=1<<q,Ce=er(q,Y=Y+ze&ze-1,U);if(this.tiles[Ce])return lt(this.tiles[Ce],xe);ve>1&&console.log("drilling down to z%d-%d-%d",q,Y,U);let Ge,Ne=q,ke=Y,Qe=U;for(;!Ge&&Ne>0;)Ne--,ke>>=1,Qe>>=1,Ge=this.tiles[er(Ne,ke,Qe)];return Ge&&Ge.source?(ve>1&&(console.log("found parent tile z%d-%d-%d",Ne,ke,Qe),console.time("drilling down")),this.splitTile(Ge.source,Ne,ke,Qe,q,Y,U),ve>1&&console.timeEnd("drilling down"),this.tiles[Ce]?lt(this.tiles[Ce],xe):null):null}}function er(Pe,q,Y){return 32*((1<<Pe)*Y+q)+Pe}function Wr(Pe,q){return q?Pe.properties[q]:Pe.id}function Kr(Pe,q){if(Pe==null)return!0;if(Pe.type==="Feature")return Wr(Pe,q)!=null;if(Pe.type==="FeatureCollection"){const Y=new Set;for(const U of Pe.features){const he=Wr(U,q);if(he==null||Y.has(he))return!1;Y.add(he)}return!0}return!1}function zi(Pe,q){const Y=new Map;if(Pe!=null)if(Pe.type==="Feature")Y.set(Wr(Pe,q),Pe);else for(const U of Pe.features)Y.set(Wr(U,q),U);return Y}class Si extends k{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(q,Y){return m._(this,void 0,void 0,function*(){const U=q.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const he=this._geoJSONIndex.getTile(U.z,U.x,U.y);if(!he)return null;const xe=new Q(he.features);let ve=Be(xe);return ve.byteOffset===0&&ve.byteLength===ve.buffer.byteLength||(ve=new Uint8Array(ve)),{vectorTile:xe,rawData:ve.buffer}})}loadData(q){return m._(this,void 0,void 0,function*(){var Y;(Y=this._pendingRequest)===null||Y===void 0||Y.abort();const U=!!(q&&q.request&&q.request.collectResourceTiming)&&new m.cA(q.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(q,this._pendingRequest),this._geoJSONIndex=q.cluster?new Xe(function({superclusterOptions:ve,clusterProperties:ze}){if(!ze||!ve)return ve;const Ce={},Ge={},Ne={accumulated:null,zoom:0},ke={properties:null},Qe=Object.keys(ze);for(const mt of Qe){const[gt,Ve]=ze[mt],Nt=m.cH(Ve),kt=m.cH(typeof gt=="string"?[gt,["accumulated"],["get",mt]]:gt);Ce[mt]=Nt.value,Ge[mt]=kt.value}return ve.map=mt=>{ke.properties=mt;const gt={};for(const Ve of Qe)gt[Ve]=Ce[Ve].evaluate(Ne,ke);return gt},ve.reduce=(mt,gt)=>{ke.properties=gt;for(const Ve of Qe)Ne.accumulated=mt[Ve],mt[Ve]=Ge[Ve].evaluate(Ne,ke)},ve}(q)).load((yield this._pendingData).features):(he=yield this._pendingData,new ir(he,q.geojsonVtOptions)),this.loaded={};const xe={};if(U){const ve=U.finish();ve&&(xe.resourceTiming={},xe.resourceTiming[q.source]=JSON.parse(JSON.stringify(ve)))}return xe}catch(xe){if(delete this._pendingRequest,m.cl(xe))return{abandoned:!0};throw xe}var he})}getData(){return m._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(q){const Y=this.loaded;return Y&&Y[q.uid]?super.reloadTile(q):this.loadTile(q)}loadAndProcessGeoJSON(q,Y){return m._(this,void 0,void 0,function*(){let U=yield this.loadGeoJSON(q,Y);if(delete this._pendingRequest,typeof U!="object")throw new Error(`Input data given to '${q.source}' is not a valid GeoJSON object.`);if(ae(U,!0),q.filter){const he=m.cH(q.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(he.result==="error")throw new Error(he.value.map(ve=>`${ve.key}: ${ve.message}`).join(", "));U={type:"FeatureCollection",features:U.features.filter(ve=>he.value.evaluate({zoom:0},ve))}}return U})}loadGeoJSON(q,Y){return m._(this,void 0,void 0,function*(){const{promoteId:U}=q;if(q.request){const he=yield m.j(q.request,Y);return this._dataUpdateable=Kr(he.data,U)?zi(he.data,U):void 0,he.data}if(typeof q.data=="string")try{const he=JSON.parse(q.data);return this._dataUpdateable=Kr(he,U)?zi(he,U):void 0,he}catch{throw new Error(`Input data given to '${q.source}' is not a valid GeoJSON object.`)}if(!q.dataDiff)throw new Error(`Input data given to '${q.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${q.source}`);return function(he,xe,ve){var ze,Ce,Ge,Ne;if(xe.removeAll&&he.clear(),xe.remove)for(const ke of xe.remove)he.delete(ke);if(xe.add)for(const ke of xe.add){const Qe=Wr(ke,ve);Qe!=null&&he.set(Qe,ke)}if(xe.update)for(const ke of xe.update){let Qe=he.get(ke.id);if(Qe==null)continue;const mt=!ke.removeAllProperties&&(((ze=ke.removeProperties)===null||ze===void 0?void 0:ze.length)>0||((Ce=ke.addOrUpdateProperties)===null||Ce===void 0?void 0:Ce.length)>0);if((ke.newGeometry||ke.removeAllProperties||mt)&&(Qe=Object.assign({},Qe),he.set(ke.id,Qe),mt&&(Qe.properties=Object.assign({},Qe.properties))),ke.newGeometry&&(Qe.geometry=ke.newGeometry),ke.removeAllProperties)Qe.properties={};else if(((Ge=ke.removeProperties)===null||Ge===void 0?void 0:Ge.length)>0)for(const gt of ke.removeProperties)Object.prototype.hasOwnProperty.call(Qe.properties,gt)&&delete Qe.properties[gt];if(((Ne=ke.addOrUpdateProperties)===null||Ne===void 0?void 0:Ne.length)>0)for(const{key:gt,value:Ve}of ke.addOrUpdateProperties)Qe.properties[gt]=Ve}}(this._dataUpdateable,q.dataDiff,U),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(q){return m._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(q){return this._geoJSONIndex.getClusterExpansionZoom(q.clusterId)}getClusterChildren(q){return this._geoJSONIndex.getChildren(q.clusterId)}getClusterLeaves(q){return this._geoJSONIndex.getLeaves(q.clusterId,q.limit,q.offset)}}class Ki{constructor(q){this.self=q,this.actor=new m.H(q),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(Y,U)=>{if(this.externalWorkerSourceTypes[Y])throw new Error(`Worker source with name "${Y}" already registered.`);this.externalWorkerSourceTypes[Y]=U},this.self.addProtocol=m.cn,this.self.removeProtocol=m.co,this.self.registerRTLTextPlugin=Y=>{m.cI.setMethods(Y)},this.actor.registerMessageHandler("LDT",(Y,U)=>this._getDEMWorkerSource(Y,U.source).loadTile(U)),this.actor.registerMessageHandler("RDT",(Y,U)=>m._(this,void 0,void 0,function*(){this._getDEMWorkerSource(Y,U.source).removeTile(U)})),this.actor.registerMessageHandler("GCEZ",(Y,U)=>m._(this,void 0,void 0,function*(){return this._getWorkerSource(Y,U.type,U.source).getClusterExpansionZoom(U)})),this.actor.registerMessageHandler("GCC",(Y,U)=>m._(this,void 0,void 0,function*(){return this._getWorkerSource(Y,U.type,U.source).getClusterChildren(U)})),this.actor.registerMessageHandler("GCL",(Y,U)=>m._(this,void 0,void 0,function*(){return this._getWorkerSource(Y,U.type,U.source).getClusterLeaves(U)})),this.actor.registerMessageHandler("LD",(Y,U)=>this._getWorkerSource(Y,U.type,U.source).loadData(U)),this.actor.registerMessageHandler("GD",(Y,U)=>this._getWorkerSource(Y,U.type,U.source).getData()),this.actor.registerMessageHandler("LT",(Y,U)=>this._getWorkerSource(Y,U.type,U.source).loadTile(U)),this.actor.registerMessageHandler("RT",(Y,U)=>this._getWorkerSource(Y,U.type,U.source).reloadTile(U)),this.actor.registerMessageHandler("AT",(Y,U)=>this._getWorkerSource(Y,U.type,U.source).abortTile(U)),this.actor.registerMessageHandler("RMT",(Y,U)=>this._getWorkerSource(Y,U.type,U.source).removeTile(U)),this.actor.registerMessageHandler("RS",(Y,U)=>m._(this,void 0,void 0,function*(){if(!this.workerSources[Y]||!this.workerSources[Y][U.type]||!this.workerSources[Y][U.type][U.source])return;const he=this.workerSources[Y][U.type][U.source];delete this.workerSources[Y][U.type][U.source],he.removeSource!==void 0&&he.removeSource(U)})),this.actor.registerMessageHandler("RM",Y=>m._(this,void 0,void 0,function*(){delete this.layerIndexes[Y],delete this.availableImages[Y],delete this.workerSources[Y],delete this.demWorkerSources[Y]})),this.actor.registerMessageHandler("SR",(Y,U)=>m._(this,void 0,void 0,function*(){this.referrer=U})),this.actor.registerMessageHandler("SRPS",(Y,U)=>this._syncRTLPluginState(Y,U)),this.actor.registerMessageHandler("IS",(Y,U)=>m._(this,void 0,void 0,function*(){this.self.importScripts(U)})),this.actor.registerMessageHandler("SI",(Y,U)=>this._setImages(Y,U)),this.actor.registerMessageHandler("UL",(Y,U)=>m._(this,void 0,void 0,function*(){this._getLayerIndex(Y).update(U.layers,U.removedIds)})),this.actor.registerMessageHandler("SL",(Y,U)=>m._(this,void 0,void 0,function*(){this._getLayerIndex(Y).replace(U)}))}_setImages(q,Y){return m._(this,void 0,void 0,function*(){this.availableImages[q]=Y;for(const U in this.workerSources[q]){const he=this.workerSources[q][U];for(const xe in he)he[xe].availableImages=Y}})}_syncRTLPluginState(q,Y){return m._(this,void 0,void 0,function*(){return yield m.cI.syncState(Y,this.self.importScripts)})}_getAvailableImages(q){let Y=this.availableImages[q];return Y||(Y=[]),Y}_getLayerIndex(q){let Y=this.layerIndexes[q];return Y||(Y=this.layerIndexes[q]=new a),Y}_getWorkerSource(q,Y,U){if(this.workerSources[q]||(this.workerSources[q]={}),this.workerSources[q][Y]||(this.workerSources[q][Y]={}),!this.workerSources[q][Y][U]){const he={sendAsync:(xe,ve)=>(xe.targetMapId=q,this.actor.sendAsync(xe,ve))};switch(Y){case"vector":this.workerSources[q][Y][U]=new k(he,this._getLayerIndex(q),this._getAvailableImages(q));break;case"geojson":this.workerSources[q][Y][U]=new Si(he,this._getLayerIndex(q),this._getAvailableImages(q));break;default:this.workerSources[q][Y][U]=new this.externalWorkerSourceTypes[Y](he,this._getLayerIndex(q),this._getAvailableImages(q))}}return this.workerSources[q][Y][U]}_getDEMWorkerSource(q,Y){return this.demWorkerSources[q]||(this.demWorkerSources[q]={}),this.demWorkerSources[q][Y]||(this.demWorkerSources[q][Y]=new N),this.demWorkerSources[q][Y]}}return m.i(self)&&(self.worker=new Ki(self)),Ki}),p("index",["exports","./shared"],function(m,a){var I="5.3.0";function z(){var g=new a.A(4);return a.A!=Float32Array&&(g[1]=0,g[2]=0),g[0]=1,g[3]=1,g}let P,k;const N={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(g,e,i){const u=requestAnimationFrame(_=>{d(),e(_)}),{unsubscribe:d}=a.s(g.signal,"abort",()=>{d(),cancelAnimationFrame(u),i(a.c())},!1)},frameAsync(g){return new Promise((e,i)=>{this.frame(g,e,i)})},getImageData(g,e=0){return this.getImageCanvasContext(g).getImageData(-e,-e,g.width+2*e,g.height+2*e)},getImageCanvasContext(g){const e=window.document.createElement("canvas"),i=e.getContext("2d",{willReadFrequently:!0});if(!i)throw new Error("failed to create canvas 2d context");return e.width=g.width,e.height=g.height,i.drawImage(g,0,0,g.width,g.height),i},resolveURL:g=>(P||(P=document.createElement("a")),P.href=g,P.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(k==null&&(k=matchMedia("(prefers-reduced-motion: reduce)")),k.matches)}};class F{static testProp(e){if(!F.docStyle)return e[0];for(let i=0;i<e.length;i++)if(e[i]in F.docStyle)return e[i];return e[0]}static create(e,i,u){const d=window.document.createElement(e);return i!==void 0&&(d.className=i),u&&u.appendChild(d),d}static createNS(e,i){return window.document.createElementNS(e,i)}static disableDrag(){F.docStyle&&F.selectProp&&(F.userSelect=F.docStyle[F.selectProp],F.docStyle[F.selectProp]="none")}static enableDrag(){F.docStyle&&F.selectProp&&(F.docStyle[F.selectProp]=F.userSelect)}static setTransform(e,i){e.style[F.transformProp]=i}static addEventListener(e,i,u,d={}){e.addEventListener(i,u,"passive"in d?d:d.capture)}static removeEventListener(e,i,u,d={}){e.removeEventListener(i,u,"passive"in d?d:d.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",F.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",F.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",F.suppressClickInternal,!0)},0)}static getScale(e){const i=e.getBoundingClientRect();return{x:i.width/e.offsetWidth||1,y:i.height/e.offsetHeight||1,boundingClientRect:i}}static getPoint(e,i,u){const d=i.boundingClientRect;return new a.P((u.clientX-d.left)/i.x-e.clientLeft,(u.clientY-d.top)/i.y-e.clientTop)}static mousePos(e,i){const u=F.getScale(e);return F.getPoint(e,u,i)}static touchPos(e,i){const u=[],d=F.getScale(e);for(let _=0;_<i.length;_++)u.push(F.getPoint(e,d,i[_]));return u}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}static sanitize(e){const i=new DOMParser().parseFromString(e,"text/html").body||document.createElement("body"),u=i.querySelectorAll("script");for(const d of u)d.remove();return F.clean(i),i.innerHTML}static isPossiblyDangerous(e,i){const u=i.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!u.includes("javascript:")&&!u.includes("data:"))||!!e.startsWith("on")||void 0}static clean(e){const i=e.children;for(const u of i)F.removeAttributes(u),F.clean(u)}static removeAttributes(e){for(const{name:i,value:u}of e.attributes)F.isPossiblyDangerous(i,u)&&e.removeAttribute(i)}}F.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,F.selectProp=F.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),F.transformProp=F.testProp(["transform","WebkitTransform"]);const H={supported:!1,testSupport:function(g){!Se&&ae&&(be?Q(g):X=g)}};let X,ae,Se=!1,be=!1;function Q(g){const e=g.createTexture();g.bindTexture(g.TEXTURE_2D,e);try{if(g.texImage2D(g.TEXTURE_2D,0,g.RGBA,g.RGBA,g.UNSIGNED_BYTE,ae),g.isContextLost())return;H.supported=!0}catch{}g.deleteTexture(e),Se=!0}var re;typeof document<"u"&&(ae=document.createElement("img"),ae.onload=()=>{X&&Q(X),X=null,be=!0},ae.onerror=()=>{Se=!0,X=null},ae.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(g){let e,i,u,d;g.resetRequestQueue=()=>{e=[],i=0,u=0,d={}},g.addThrottleControl=E=>{const M=u++;return d[M]=E,M},g.removeThrottleControl=E=>{delete d[E],x()},g.getImage=(E,M,D=!0)=>new Promise((B,O)=>{H.supported&&(E.headers||(E.headers={}),E.headers.accept="image/webp,*/*"),a.e(E,{type:"image"}),e.push({abortController:M,requestParameters:E,supportImageRefresh:D,state:"queued",onError:Z=>{O(Z)},onSuccess:Z=>{B(Z)}}),x()});const _=E=>a._(this,void 0,void 0,function*(){E.state="running";const{requestParameters:M,supportImageRefresh:D,onError:B,onSuccess:O,abortController:Z}=E,K=D===!1&&!a.i(self)&&!a.g(M.url)&&(!M.headers||Object.keys(M.headers).reduce((oe,ce)=>oe&&ce==="accept",!0));i++;const ne=K?T(M,Z):a.m(M,Z);try{const oe=yield ne;delete E.abortController,E.state="completed",oe.data instanceof HTMLImageElement||a.b(oe.data)?O(oe):oe.data&&O({data:yield(ie=oe.data,typeof createImageBitmap=="function"?a.f(ie):a.h(ie)),cacheControl:oe.cacheControl,expires:oe.expires})}catch(oe){delete E.abortController,B(oe)}finally{i--,x()}var ie}),x=()=>{const E=(()=>{for(const M of Object.keys(d))if(d[M]())return!0;return!1})()?a.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:a.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let M=i;M<E&&e.length>0;M++){const D=e.shift();D.abortController.signal.aborted?M--:_(D)}},T=(E,M)=>new Promise((D,B)=>{const O=new Image,Z=E.url,K=E.credentials;K&&K==="include"?O.crossOrigin="use-credentials":(K&&K==="same-origin"||!a.d(Z))&&(O.crossOrigin="anonymous"),M.signal.addEventListener("abort",()=>{O.src="",B(a.c())}),O.fetchPriority="high",O.onload=()=>{O.onerror=O.onload=null,D({data:O})},O.onerror=()=>{O.onerror=O.onload=null,M.signal.aborted||B(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},O.src=Z})}(re||(re={})),re.resetRequestQueue();class J{constructor(e){this._transformRequestFn=e}transformRequest(e,i){return this._transformRequestFn&&this._transformRequestFn(e,i)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function le(g){const e=[];if(typeof g=="string")e.push({id:"default",url:g});else if(g&&g.length>0){const i=[];for(const{id:u,url:d}of g){const _=`${u}${d}`;i.indexOf(_)===-1&&(i.push(_),e.push({id:u,url:d}))}}return e}function Me(g,e,i){try{const u=new URL(g);return u.pathname+=`${e}${i}`,u.toString()}catch{throw new Error(`Invalid sprite URL "${g}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}class Ie{constructor(e,i,u,d){this.context=e,this.format=u,this.texture=e.gl.createTexture(),this.update(i,d)}update(e,i,u){const{width:d,height:_}=e,x=!(this.size&&this.size[0]===d&&this.size[1]===_||u),{context:T}=this,{gl:E}=T;if(this.useMipmap=!!(i&&i.useMipmap),E.bindTexture(E.TEXTURE_2D,this.texture),T.pixelStoreUnpackFlipY.set(!1),T.pixelStoreUnpack.set(1),T.pixelStoreUnpackPremultiplyAlpha.set(this.format===E.RGBA&&(!i||i.premultiply!==!1)),x)this.size=[d,_],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||a.b(e)?E.texImage2D(E.TEXTURE_2D,0,this.format,this.format,E.UNSIGNED_BYTE,e):E.texImage2D(E.TEXTURE_2D,0,this.format,d,_,0,this.format,E.UNSIGNED_BYTE,e.data);else{const{x:M,y:D}=u||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||a.b(e)?E.texSubImage2D(E.TEXTURE_2D,0,M,D,E.RGBA,E.UNSIGNED_BYTE,e):E.texSubImage2D(E.TEXTURE_2D,0,M,D,d,_,E.RGBA,E.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&E.generateMipmap(E.TEXTURE_2D)}bind(e,i,u){const{context:d}=this,{gl:_}=d;_.bindTexture(_.TEXTURE_2D,this.texture),u!==_.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(u=_.LINEAR),e!==this.filter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,e),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,u||e),this.filter=e),i!==this.wrap&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,i),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,i),this.wrap=i)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}function Be(g){const{userImage:e}=g;return!!(e&&e.render&&e.render())&&(g.data.replace(new Uint8Array(e.data.buffer)),!0)}class Ee extends a.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:i,promiseResolve:u}of this.requestors)u(this._getImagesForIds(i));this.requestors=[]}}getImage(e){const i=this.images[e];if(i&&!i.data&&i.spriteData){const u=i.spriteData;i.data=new a.R({width:u.width,height:u.height},u.context.getImageData(u.x,u.y,u.width,u.height).data),i.spriteData=null}return i}addImage(e,i){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,i)&&(this.images[e]=i)}_validate(e,i){let u=!0;const d=i.data||i.spriteData;return this._validateStretch(i.stretchX,d&&d.width)||(this.fire(new a.k(new Error(`Image "${e}" has invalid "stretchX" value`))),u=!1),this._validateStretch(i.stretchY,d&&d.height)||(this.fire(new a.k(new Error(`Image "${e}" has invalid "stretchY" value`))),u=!1),this._validateContent(i.content,i)||(this.fire(new a.k(new Error(`Image "${e}" has invalid "content" value`))),u=!1),u}_validateStretch(e,i){if(!e)return!0;let u=0;for(const d of e){if(d[0]<u||d[1]<d[0]||i<d[1])return!1;u=d[1]}return!0}_validateContent(e,i){if(!e)return!0;if(e.length!==4)return!1;const u=i.spriteData,d=u&&u.width||i.data.width,_=u&&u.height||i.data.height;return!(e[0]<0||d<e[0]||e[1]<0||_<e[1]||e[2]<0||d<e[2]||e[3]<0||_<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,i,u=!0){const d=this.getImage(e);if(u&&(d.data.width!==i.data.width||d.data.height!==i.data.height))throw new Error(`size mismatch between old image (${d.data.width}x${d.data.height}) and new image (${i.data.width}x${i.data.height}).`);i.version=d.version+1,this.images[e]=i,this.updatedImages[e]=!0}removeImage(e){const i=this.images[e];delete this.images[e],delete this.patterns[e],i.userImage&&i.userImage.onRemove&&i.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise((i,u)=>{let d=!0;if(!this.isLoaded())for(const _ of e)this.images[_]||(d=!1);this.isLoaded()||d?i(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:i})})}_getImagesForIds(e){const i={};for(const u of e){let d=this.getImage(u);d||(this.fire(new a.l("styleimagemissing",{id:u})),d=this.getImage(u)),d?i[u]={data:d.data.clone(),pixelRatio:d.pixelRatio,sdf:d.sdf,version:d.version,stretchX:d.stretchX,stretchY:d.stretchY,content:d.content,textFitWidth:d.textFitWidth,textFitHeight:d.textFitHeight,hasRenderCallback:!!(d.userImage&&d.userImage.render)}:a.w(`Image "${u}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return i}getPixelSize(){const{width:e,height:i}=this.atlasImage;return{width:e,height:i}}getPattern(e){const i=this.patterns[e],u=this.getImage(e);if(!u)return null;if(i&&i.position.version===u.version)return i.position;if(i)i.position.version=u.version;else{const d={w:u.data.width+2,h:u.data.height+2,x:0,y:0},_=new a.I(d,u);this.patterns[e]={bin:d,position:_}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const i=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Ie(e,this.atlasImage,i.RGBA),this.atlasTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const _ in this.patterns)e.push(this.patterns[_].bin);const{w:i,h:u}=a.p(e),d=this.atlasImage;d.resize({width:i||1,height:u||1});for(const _ in this.patterns){const{bin:x}=this.patterns[_],T=x.x+1,E=x.y+1,M=this.getImage(_).data,D=M.width,B=M.height;a.R.copy(M,d,{x:0,y:0},{x:T,y:E},{width:D,height:B}),a.R.copy(M,d,{x:0,y:B-1},{x:T,y:E-1},{width:D,height:1}),a.R.copy(M,d,{x:0,y:0},{x:T,y:E+B},{width:D,height:1}),a.R.copy(M,d,{x:D-1,y:0},{x:T-1,y:E},{width:1,height:B}),a.R.copy(M,d,{x:0,y:0},{x:T+D,y:E},{width:1,height:B})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const i of e){if(this.callbackDispatchedThisFrame[i])continue;this.callbackDispatchedThisFrame[i]=!0;const u=this.getImage(i);u||a.w(`Image with ID: "${i}" was not found`),Be(u)&&this.updateImage(i,u)}}}const Re=1e20;function Ae(g,e,i,u,d,_,x,T,E){for(let M=e;M<e+u;M++)He(g,i*_+M,_,d,x,T,E);for(let M=i;M<i+d;M++)He(g,M*_+e,1,u,x,T,E)}function He(g,e,i,u,d,_,x){_[0]=0,x[0]=-1e20,x[1]=Re,d[0]=g[e];for(let T=1,E=0,M=0;T<u;T++){d[T]=g[e+T*i];const D=T*T;do{const B=_[E];M=(d[T]-d[B]+D-B*B)/(T-B)/2}while(M<=x[E]&&--E>-1);E++,_[E]=T,x[E]=M,x[E+1]=Re}for(let T=0,E=0;T<u;T++){for(;x[E+1]<T;)E++;const M=_[E],D=T-M;g[e+T*i]=d[M]+D*D}}class it{constructor(e,i){this.requestManager=e,this.localIdeographFontFamily=i,this.entries={}}setURL(e){this.url=e}getGlyphs(e){return a._(this,void 0,void 0,function*(){const i=[];for(const _ in e)for(const x of e[_])i.push(this._getAndCacheGlyphsPromise(_,x));const u=yield Promise.all(i),d={};for(const{stack:_,id:x,glyph:T}of u)d[_]||(d[_]={}),d[_][x]=T&&{id:T.id,bitmap:T.bitmap.clone(),metrics:T.metrics};return d})}_getAndCacheGlyphsPromise(e,i){return a._(this,void 0,void 0,function*(){let u=this.entries[e];u||(u=this.entries[e]={glyphs:{},requests:{},ranges:{}});let d=u.glyphs[i];if(d!==void 0)return{stack:e,id:i,glyph:d};if(d=this._tinySDF(u,e,i),d)return u.glyphs[i]=d,{stack:e,id:i,glyph:d};const _=Math.floor(i/256);if(256*_>65535)throw new Error("glyphs > 65535 not supported");if(u.ranges[_])return{stack:e,id:i,glyph:d};if(!this.url)throw new Error("glyphsUrl is not set");if(!u.requests[_]){const T=it.loadGlyphRange(e,_,this.url,this.requestManager);u.requests[_]=T}const x=yield u.requests[_];for(const T in x)this._doesCharSupportLocalGlyph(+T)||(u.glyphs[+T]=x[+T]);return u.ranges[_]=!0,{stack:e,id:i,glyph:x[i]||null}})}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(e))||a.u["CJK Unified Ideographs"](e)||a.u["Hangul Syllables"](e)||a.u.Hiragana(e)||a.u.Katakana(e)||a.u["CJK Symbols and Punctuation"](e)||a.u["Halfwidth and Fullwidth Forms"](e))}_tinySDF(e,i,u){const d=this.localIdeographFontFamily;if(!d||!this._doesCharSupportLocalGlyph(u))return;let _=e.tinySDF;if(!_){let T="400";/bold/i.test(i)?T="900":/medium/i.test(i)?T="500":/light/i.test(i)&&(T="200"),_=e.tinySDF=new it.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:d,fontWeight:T})}const x=_.draw(String.fromCharCode(u));return{id:u,bitmap:new a.q({width:x.width||60,height:x.height||60},x.data),metrics:{width:x.glyphWidth/2||24,height:x.glyphHeight/2||24,left:x.glyphLeft/2+.5||0,top:x.glyphTop/2-27.5||-8,advance:x.glyphAdvance/2||24,isDoubleResolution:!0}}}}it.loadGlyphRange=function(g,e,i,u){return a._(this,void 0,void 0,function*(){const d=256*e,_=d+255,x=u.transformRequest(i.replace("{fontstack}",g).replace("{range}",`${d}-${_}`),"Glyphs"),T=yield a.n(x,new AbortController);if(!T||!T.data)throw new Error(`Could not load glyph range. range: ${e}, ${d}-${_}`);const E={};for(const M of a.o(T.data))E[M.id]=M;return E})},it.TinySDF=class{constructor({fontSize:g=24,buffer:e=3,radius:i=8,cutoff:u=.25,fontFamily:d="sans-serif",fontWeight:_="normal",fontStyle:x="normal"}={}){this.buffer=e,this.cutoff=u,this.radius=i;const T=this.size=g+4*e,E=this._createCanvas(T),M=this.ctx=E.getContext("2d",{willReadFrequently:!0});M.font=`${x} ${_} ${g}px ${d}`,M.textBaseline="alphabetic",M.textAlign="left",M.fillStyle="black",this.gridOuter=new Float64Array(T*T),this.gridInner=new Float64Array(T*T),this.f=new Float64Array(T),this.z=new Float64Array(T+1),this.v=new Uint16Array(T)}_createCanvas(g){const e=document.createElement("canvas");return e.width=e.height=g,e}draw(g){const{width:e,actualBoundingBoxAscent:i,actualBoundingBoxDescent:u,actualBoundingBoxLeft:d,actualBoundingBoxRight:_}=this.ctx.measureText(g),x=Math.ceil(i),T=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(_-d))),E=Math.min(this.size-this.buffer,x+Math.ceil(u)),M=T+2*this.buffer,D=E+2*this.buffer,B=Math.max(M*D,0),O=new Uint8ClampedArray(B),Z={data:O,width:M,height:D,glyphWidth:T,glyphHeight:E,glyphTop:x,glyphLeft:0,glyphAdvance:e};if(T===0||E===0)return Z;const{ctx:K,buffer:ne,gridInner:ie,gridOuter:oe}=this;K.clearRect(ne,ne,T,E),K.fillText(g,ne,ne+x);const ce=K.getImageData(ne,ne,T,E);oe.fill(Re,0,B),ie.fill(0,0,B);for(let fe=0;fe<E;fe++)for(let me=0;me<T;me++){const ge=ce.data[4*(fe*T+me)+3]/255;if(ge===0)continue;const Te=(fe+ne)*M+me+ne;if(ge===1)oe[Te]=0,ie[Te]=Re;else{const _e=.5-ge;oe[Te]=_e>0?_e*_e:0,ie[Te]=_e<0?_e*_e:0}}Ae(oe,0,0,M,D,M,this.f,this.v,this.z),Ae(ie,ne,ne,T,E,M,this.f,this.v,this.z);for(let fe=0;fe<B;fe++){const me=Math.sqrt(oe[fe])-Math.sqrt(ie[fe]);O[fe]=Math.round(255-255*(me/this.radius+this.cutoff))}return Z}};class vt{constructor(){this.specification=a.v.light.position}possiblyEvaluate(e,i){return a.z(e.expression.evaluate(i))}interpolate(e,i,u){return{x:a.B.number(e.x,i.x,u),y:a.B.number(e.y,i.y,u),z:a.B.number(e.z,i.z,u)}}}let Xe;class xt extends a.E{constructor(e){super(),Xe=Xe||new a.r({anchor:new a.D(a.v.light.anchor),position:new vt,color:new a.D(a.v.light.color),intensity:new a.D(a.v.light.intensity)}),this._transitionable=new a.T(Xe),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,i={}){if(!this._validate(a.t,e,i))for(const u in e){const d=e[u];u.endsWith("-transition")?this._transitionable.setTransition(u.slice(0,-11),d):this._transitionable.setValue(u,d)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,i,u){return(!u||u.validate!==!1)&&a.x(this,e.call(a.y,{value:i,style:{glyphs:!0,sprite:!0},styleSpec:a.v}))}}const yt=new a.r({"sky-color":new a.D(a.v.sky["sky-color"]),"horizon-color":new a.D(a.v.sky["horizon-color"]),"fog-color":new a.D(a.v.sky["fog-color"]),"fog-ground-blend":new a.D(a.v.sky["fog-ground-blend"]),"horizon-fog-blend":new a.D(a.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new a.D(a.v.sky["sky-horizon-blend"]),"atmosphere-blend":new a.D(a.v.sky["atmosphere-blend"])});class Rt extends a.E{constructor(e){super(),this._transitionable=new a.T(yt),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new a.C(0))}setSky(e,i={}){if(!this._validate(a.F,e,i)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const u in e){const d=e[u];u.endsWith("-transition")?this._transitionable.setTransition(u.slice(0,-11),d):this._transitionable.setValue(u,d)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,i,u={}){return(u==null?void 0:u.validate)!==!1&&a.x(this,e.call(a.y,a.e({value:i,style:{glyphs:!0,sprite:!0},styleSpec:a.v})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class Mr{constructor(e,i){this.width=e,this.height=i,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,i){const u=e.join(",")+String(i);return this.dashEntry[u]||(this.dashEntry[u]=this.addDash(e,i)),this.dashEntry[u]}getDashRanges(e,i,u){const d=[];let _=e.length%2==1?-e[e.length-1]*u:0,x=e[0]*u,T=!0;d.push({left:_,right:x,isDash:T,zeroLength:e[0]===0});let E=e[0];for(let M=1;M<e.length;M++){T=!T;const D=e[M];_=E*u,E+=D,x=E*u,d.push({left:_,right:x,isDash:T,zeroLength:D===0})}return d}addRoundDash(e,i,u){const d=i/2;for(let _=-u;_<=u;_++){const x=this.width*(this.nextRow+u+_);let T=0,E=e[T];for(let M=0;M<this.width;M++){M/E.right>1&&(E=e[++T]);const D=Math.abs(M-E.left),B=Math.abs(M-E.right),O=Math.min(D,B);let Z;const K=_/u*(d+1);if(E.isDash){const ne=d-Math.abs(K);Z=Math.sqrt(O*O+ne*ne)}else Z=d-Math.sqrt(O*O+K*K);this.data[x+M]=Math.max(0,Math.min(255,Z+128))}}}addRegularDash(e){for(let T=e.length-1;T>=0;--T){const E=e[T],M=e[T+1];E.zeroLength?e.splice(T,1):M&&M.isDash===E.isDash&&(M.left=E.left,e.splice(T,1))}const i=e[0],u=e[e.length-1];i.isDash===u.isDash&&(i.left=u.left-this.width,u.right=i.right+this.width);const d=this.width*this.nextRow;let _=0,x=e[_];for(let T=0;T<this.width;T++){T/x.right>1&&(x=e[++_]);const E=Math.abs(T-x.left),M=Math.abs(T-x.right),D=Math.min(E,M);this.data[d+T]=Math.max(0,Math.min(255,(x.isDash?D:-D)+128))}}addDash(e,i){const u=i?7:0,d=2*u+1;if(this.nextRow+d>this.height)return a.w("LineAtlas out of space"),null;let _=0;for(let T=0;T<e.length;T++)_+=e[T];if(_!==0){const T=this.width/_,E=this.getDashRanges(e,this.width,T);i?this.addRoundDash(E,T,u):this.addRegularDash(E)}const x={y:(this.nextRow+u+.5)/this.height,height:2*u/this.height,width:_};return this.nextRow+=d,this.dirty=!0,x}bind(e){const i=e.gl;this.texture?(i.bindTexture(i.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,i.texSubImage2D(i.TEXTURE_2D,0,0,0,this.width,this.height,i.ALPHA,i.UNSIGNED_BYTE,this.data))):(this.texture=i.createTexture(),i.bindTexture(i.TEXTURE_2D,this.texture),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.REPEAT),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.REPEAT),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texImage2D(i.TEXTURE_2D,0,i.ALPHA,this.width,this.height,0,i.ALPHA,i.UNSIGNED_BYTE,this.data))}}const _r="maplibre_preloaded_worker_pool";class pr{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<pr.workerCount;)this.workers.push(new Worker(a.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach(i=>{i.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[_r]}numActive(){return Object.keys(this.active).length}}const Tr=Math.floor(N.hardwareConcurrency/2);let Lr,Pt;function Yt(){return Lr||(Lr=new pr),Lr}pr.workerCount=a.G(globalThis)?Math.max(Math.min(Tr,3),1):1;class Jt{constructor(e,i){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=i;const u=this.workerPool.acquire(i);for(let d=0;d<u.length;d++){const _=new a.H(u[d],i);_.name=`Worker ${d}`,this.actors.push(_)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,i){const u=[];for(const d of this.actors)u.push(d.sendAsync({type:e,data:i}));return Promise.all(u)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach(i=>{i.remove()}),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,i){for(const u of this.actors)u.registerMessageHandler(e,i)}}function hr(){return Pt||(Pt=new Jt(Yt(),a.J),Pt.registerMessageHandler("GR",(g,e,i)=>a.m(e,i))),Pt}function vr(g,e){const i=a.K();return a.L(i,i,[1,1,0]),a.M(i,i,[.5*g.width,.5*g.height,1]),g.calculatePosMatrix?a.N(i,i,g.calculatePosMatrix(e.toUnwrapped())):i}function Ti(g,e,i,u,d,_,x){var T;const E=function(O,Z,K){if(O)for(const ne of O){const ie=Z[ne];if(ie&&ie.source===K&&ie.type==="fill-extrusion")return!0}else for(const ne in Z){const ie=Z[ne];if(ie.source===K&&ie.type==="fill-extrusion")return!0}return!1}((T=d==null?void 0:d.layers)!==null&&T!==void 0?T:null,e,g.id),M=_.maxPitchScaleFactor(),D=g.tilesIn(u,M,E);D.sort(Pr);const B=[];for(const O of D)B.push({wrappedTileID:O.tileID.wrapped().key,queryResults:O.tile.queryRenderedFeatures(e,i,g._state,O.queryGeometry,O.cameraQueryGeometry,O.scale,d,_,M,vr(g.transform,O.tileID),x?(Z,K)=>x(O.tileID,Z,K):void 0)});return function(O,Z){for(const K in O)for(const ne of O[K])Sr(ne,Z);return O}(function(O){const Z={},K={};for(const ne of O){const ie=ne.queryResults,oe=ne.wrappedTileID,ce=K[oe]=K[oe]||{};for(const fe in ie){const me=ie[fe],ge=ce[fe]=ce[fe]||{},Te=Z[fe]=Z[fe]||[];for(const _e of me)ge[_e.featureIndex]||(ge[_e.featureIndex]=!0,Te.push(_e))}}return Z}(B),g)}function Pr(g,e){const i=g.tileID,u=e.tileID;return i.overscaledZ-u.overscaledZ||i.canonical.y-u.canonical.y||i.wrap-u.wrap||i.canonical.x-u.canonical.x}function Sr(g,e){const i=g.feature,u=e.getFeatureState(i.layer["source-layer"],i.id);i.source=i.layer.source,i.layer["source-layer"]&&(i.sourceLayer=i.layer["source-layer"]),i.state=u}function pe(g,e,i){return a._(this,void 0,void 0,function*(){let u=g;if(g.url?u=(yield a.j(e.transformRequest(g.url,"Source"),i)).data:yield N.frameAsync(i),!u)return null;const d=a.O(a.e(u,g),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in u&&u.vector_layers&&(d.vectorLayerIds=u.vector_layers.map(_=>_.id)),d})}class we{constructor(e,i){e&&(i?this.setSouthWest(e).setNorthEast(i):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof a.Q?new a.Q(e.lng,e.lat):a.Q.convert(e),this}setSouthWest(e){return this._sw=e instanceof a.Q?new a.Q(e.lng,e.lat):a.Q.convert(e),this}extend(e){const i=this._sw,u=this._ne;let d,_;if(e instanceof a.Q)d=e,_=e;else{if(!(e instanceof we))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(we.convert(e)):this.extend(a.Q.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(a.Q.convert(e)):this;if(d=e._sw,_=e._ne,!d||!_)return this}return i||u?(i.lng=Math.min(d.lng,i.lng),i.lat=Math.min(d.lat,i.lat),u.lng=Math.max(_.lng,u.lng),u.lat=Math.max(_.lat,u.lat)):(this._sw=new a.Q(d.lng,d.lat),this._ne=new a.Q(_.lng,_.lat)),this}getCenter(){return new a.Q((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new a.Q(this.getWest(),this.getNorth())}getSouthEast(){return new a.Q(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:i,lat:u}=a.Q.convert(e);let d=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(d=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&d}static convert(e){return e instanceof we?e:e&&new we(e)}static fromLngLat(e,i=0){const u=360*i/40075017,d=u/Math.cos(Math.PI/180*e.lat);return new we(new a.Q(e.lng-d,e.lat-u),new a.Q(e.lng+d,e.lat+u))}adjustAntiMeridian(){const e=new a.Q(this._sw.lng,this._sw.lat),i=new a.Q(this._ne.lng,this._ne.lat);return new we(e,e.lng>i.lng?new a.Q(i.lng+360,i.lat):i)}}class We{constructor(e,i,u){this.bounds=we.convert(this.validateBounds(e)),this.minzoom=i||0,this.maxzoom=u||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const i=Math.pow(2,e.z),u=Math.floor(a.U(this.bounds.getWest())*i),d=Math.floor(a.S(this.bounds.getNorth())*i),_=Math.ceil(a.U(this.bounds.getEast())*i),x=Math.ceil(a.S(this.bounds.getSouth())*i);return e.x>=u&&e.x<_&&e.y>=d&&e.y<x}}class at extends a.E{constructor(e,i,u,d){if(super(),this.id=e,this.dispatcher=u,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.e(this,a.O(i,["url","scheme","tileSize","promoteId"])),this._options=a.e({type:"vector"},i),this._collectResourceTiming=i.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(d)}load(){return a._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new a.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield pe(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(a.e(this,e),e.bounds&&(this.tileBounds=new We(e.bounds,this.minzoom,this.maxzoom)),this.fire(new a.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.l("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new a.k(e))}})}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return a.e({},this._options)}loadTile(e){return a._(this,void 0,void 0,function*(){const i=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),u={request:this.map._requestManager.transformRequest(i,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};u.request.collectResourceTiming=this._collectResourceTiming;let d="RT";if(e.actor&&e.state!=="expired"){if(e.state==="loading")return new Promise((_,x)=>{e.reloadPromise={resolve:_,reject:x}})}else e.actor=this.dispatcher.getActor(),d="LT";e.abortController=new AbortController;try{const _=yield e.actor.sendAsync({type:d,data:u},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,_)}catch(_){if(delete e.abortController,e.aborted)return;if(_&&_.status!==404)throw _;this._afterTileLoadWorkerResponse(e,null)}})}_afterTileLoadWorkerResponse(e,i){if(i&&i.resourceTiming&&(e.resourceTiming=i.resourceTiming),i&&this.map._refreshExpiredTiles&&e.setExpiryData(i),e.loadVectorData(i,this.map.painter),e.reloadPromise){const u=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(u.resolve).catch(u.reject)}}abortTile(e){return a._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))})}unloadTile(e){return a._(this,void 0,void 0,function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class nt extends a.E{constructor(e,i,u,d){super(),this.id=e,this.dispatcher=u,this.setEventedParent(d),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.e({type:"raster"},i),a.e(this,a.O(i,["url","scheme","tileSize"]))}load(){return a._(this,arguments,void 0,function*(e=!1){this._loaded=!1,this.fire(new a.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const i=yield pe(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,i&&(a.e(this,i),i.bounds&&(this.tileBounds=new We(i.bounds,this.minzoom,this.maxzoom)),this.fire(new a.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:e})))}catch(i){this._tileJSONRequest=null,this.fire(new a.k(i))}})}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load(!0)}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}serialize(){return a.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return a._(this,void 0,void 0,function*(){const i=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const u=yield re.getImage(this.map._requestManager.transformRequest(i,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(u&&u.data){this.map._refreshExpiredTiles&&u.cacheControl&&u.expires&&e.setExpiryData({cacheControl:u.cacheControl,expires:u.expires});const d=this.map.painter.context,_=d.gl,x=u.data;e.texture=this.map.painter.getTileTexture(x.width),e.texture?e.texture.update(x,{useMipmap:!0}):(e.texture=new Ie(d,x,_.RGBA,{useMipmap:!0}),e.texture.bind(_.LINEAR,_.CLAMP_TO_EDGE,_.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(u){if(delete e.abortController,e.aborted)e.state="unloaded";else if(u)throw e.state="errored",u}})}abortTile(e){return a._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)})}unloadTile(e){return a._(this,void 0,void 0,function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)})}hasTransition(){return!1}}class st extends nt{constructor(e,i,u,d){super(e,i,u,d),this.type="raster-dem",this.maxzoom=22,this._options=a.e({type:"raster-dem"},i),this.encoding=i.encoding||"mapbox",this.redFactor=i.redFactor,this.greenFactor=i.greenFactor,this.blueFactor=i.blueFactor,this.baseShift=i.baseShift}loadTile(e){return a._(this,void 0,void 0,function*(){const i=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),u=this.map._requestManager.transformRequest(i,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const d=yield re.getImage(u,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(d&&d.data){const _=d.data;this.map._refreshExpiredTiles&&d.cacheControl&&d.expires&&e.setExpiryData({cacheControl:d.cacheControl,expires:d.expires});const x=a.b(_)&&a.V()?_:yield this.readImageNow(_),T={type:this.type,uid:e.uid,source:this.id,rawImageData:x,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();const E=yield e.actor.sendAsync({type:"LDT",data:T});e.dem=E,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(d){if(delete e.abortController,e.aborted)e.state="unloaded";else if(d)throw e.state="errored",d}})}readImageNow(e){return a._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&a.W()){const i=e.width+2,u=e.height+2;try{return new a.R({width:i,height:u},yield a.X(e,-1,-1,i,u))}catch{}}return N.getImageData(e,1)})}_getNeighboringTiles(e){const i=e.canonical,u=Math.pow(2,i.z),d=(i.x-1+u)%u,_=i.x===0?e.wrap-1:e.wrap,x=(i.x+1+u)%u,T=i.x+1===u?e.wrap+1:e.wrap,E={};return E[new a.Y(e.overscaledZ,_,i.z,d,i.y).key]={backfilled:!1},E[new a.Y(e.overscaledZ,T,i.z,x,i.y).key]={backfilled:!1},i.y>0&&(E[new a.Y(e.overscaledZ,_,i.z,d,i.y-1).key]={backfilled:!1},E[new a.Y(e.overscaledZ,e.wrap,i.z,i.x,i.y-1).key]={backfilled:!1},E[new a.Y(e.overscaledZ,T,i.z,x,i.y-1).key]={backfilled:!1}),i.y+1<u&&(E[new a.Y(e.overscaledZ,_,i.z,d,i.y+1).key]={backfilled:!1},E[new a.Y(e.overscaledZ,e.wrap,i.z,i.x,i.y+1).key]={backfilled:!1},E[new a.Y(e.overscaledZ,T,i.z,x,i.y+1).key]={backfilled:!1}),E}unloadTile(e){return a._(this,void 0,void 0,function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))})}}class _t extends a.E{constructor(e,i,u,d){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=u.getActor(),this.setEventedParent(d),this._data=i.data,this._options=a.e({},i),this._collectResourceTiming=i.collectResourceTiming,i.maxzoom!==void 0&&(this.maxzoom=i.maxzoom),i.type&&(this.type=i.type),i.attribution&&(this.attribution=i.attribution),this.promoteId=i.promoteId,i.clusterMaxZoom!==void 0&&this.maxzoom<=i.clusterMaxZoom&&a.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${i.clusterMaxZoom}".`),this.workerOptions=a.e({source:this.id,cluster:i.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(i.buffer!==void 0?i.buffer:128),tolerance:this._pixelsToTileUnits(i.tolerance!==void 0?i.tolerance:.375),extent:a.Z,maxZoom:this.maxzoom,lineMetrics:i.lineMetrics||!1,generateId:i.generateId||!1},superclusterOptions:{maxZoom:i.clusterMaxZoom!==void 0?i.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,i.clusterMinPoints||2),extent:a.Z,radius:this._pixelsToTileUnits(i.clusterRadius||50),log:!1,generateId:i.generateId||!1},clusterProperties:i.clusterProperties,filter:i.filter},i.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(e){return e*(a.Z/this.tileSize)}load(){return a._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}getData(){return a._(this,void 0,void 0,function*(){const e=a.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})})}getCoordinatesFromGeometry(e){return e.type==="GeometryCollection"?e.geometries.map(i=>i.coordinates).flat(1/0):e.coordinates.flat(1/0)}getBounds(){return a._(this,void 0,void 0,function*(){const e=new we,i=yield this.getData();let u;switch(i.type){case"FeatureCollection":u=i.features.map(d=>this.getCoordinatesFromGeometry(d.geometry)).flat(1/0);break;case"Feature":u=this.getCoordinatesFromGeometry(i.geometry);break;default:u=this.getCoordinatesFromGeometry(i)}if(u.length==0)return e;for(let d=0;d<u.length-1;d+=2)e.extend([u[d],u[d+1]]);return e})}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(e.clusterRadius)),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=e.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,i,u){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:i,offset:u}})}_updateWorkerData(e){return a._(this,void 0,void 0,function*(){const i=a.e({type:this.type},this.workerOptions);e?i.dataDiff=e:typeof this._data=="string"?(i.request=this.map._requestManager.transformRequest(N.resolveURL(this._data),"Source"),i.request.collectResourceTiming=this._collectResourceTiming):i.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new a.l("dataloading",{dataType:"source"}));try{const u=yield this.actor.sendAsync({type:"LD",data:i});if(this._pendingLoads--,this._removed||u.abandoned)return void this.fire(new a.l("dataabort",{dataType:"source"}));let d=null;u.resourceTiming&&u.resourceTiming[this.id]&&(d=u.resourceTiming[this.id].slice(0));const _={dataType:"source"};this._collectResourceTiming&&d&&d.length>0&&a.e(_,{resourceTiming:d}),this.fire(new a.l("data",Object.assign(Object.assign({},_),{sourceDataType:"metadata"}))),this.fire(new a.l("data",Object.assign(Object.assign({},_),{sourceDataType:"content"})))}catch(u){if(this._pendingLoads--,this._removed)return void this.fire(new a.l("dataabort",{dataType:"source"}));this.fire(new a.k(u))}})}loaded(){return this._pendingLoads===0}loadTile(e){return a._(this,void 0,void 0,function*(){const i=e.actor?"RT":"LT";e.actor=this.actor;const u={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};e.abortController=new AbortController;const d=yield this.actor.sendAsync({type:i,data:u},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(d,this.map.painter,i==="RT")})}abortTile(e){return a._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0})}unloadTile(e){return a._(this,void 0,void 0,function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return a.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class ut extends a.E{constructor(e,i,u,d){super(),this.flippedWindingOrder=!1,this.id=e,this.dispatcher=u,this.coordinates=i.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(d),this.options=i}load(e){return a._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new a.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const i=yield re.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,i&&i.data&&(this.image=i.data,e&&(this.coordinates=e),this._finishLoading())}catch(i){this._request=null,this._loaded=!0,this.fire(new a.k(i))}})}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const i=e.map(a.$.fromLngLat);var u;return this.tileID=function(d){let _=1/0,x=1/0,T=-1/0,E=-1/0;for(const O of d)_=Math.min(_,O.x),x=Math.min(x,O.y),T=Math.max(T,O.x),E=Math.max(E,O.y);const M=Math.max(T-_,E-x),D=Math.max(0,Math.floor(-Math.log(M)/Math.LN2)),B=Math.pow(2,D);return new a.a1(D,Math.floor((_+T)/2*B),Math.floor((x+E)/2*B))}(i),this.terrainTileRanges=this._getOverlappingTileRanges(i),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=i.map(d=>this.tileID.getTilePoint(d)._round()),this.flippedWindingOrder=((u=this.tileCoords)[1].x-u[0].x)*(u[2].y-u[0].y)-(u[1].y-u[0].y)*(u[2].x-u[0].x)<0,this.fire(new a.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const e=this.map.painter.context,i=e.gl;this.texture||(this.texture=new Ie(e,this.image,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE));let u=!1;for(const d in this.tiles){const _=this.tiles[d];_.state!=="loaded"&&(_.state="loaded",_.texture=this.texture,u=!0)}u&&this.fire(new a.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return a._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(e){let i=1/0,u=1/0,d=-1/0,_=-1/0;for(const T of e)i=Math.min(i,T.x),u=Math.min(u,T.y),d=Math.max(d,T.x),_=Math.max(_,T.y);const x={};for(let T=0;T<=a.a0;T++){const E=Math.pow(2,T),M=Math.floor(i*E),D=Math.floor(u*E),B=Math.floor(d*E),O=Math.floor(_*E);x[T]={minTileX:M,minTileY:D,maxTileX:B,maxTileY:O}}return x}}class ht extends ut{constructor(e,i,u,d){super(e,i,u,d),this.roundZoom=!0,this.type="video",this.options=i}load(){return a._(this,void 0,void 0,function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const i of e.urls)this.urls.push(this.map._requestManager.transformRequest(i,"Source").url);try{const i=yield a.a2(this.urls);if(this._loaded=!0,!i)return;this.video=i,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(i){this.fire(new a.k(i))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const i=this.video.seekable;e<i.start(0)||e>i.end(0)?this.fire(new a.k(new a.a3(`sources.${this.id}`,null,`Playback for this video can be set only between the ${i.start(0)} and ${i.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const e=this.map.painter.context,i=e.gl;this.texture?this.video.paused||(this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),i.texSubImage2D(i.TEXTURE_2D,0,0,0,i.RGBA,i.UNSIGNED_BYTE,this.video)):(this.texture=new Ie(e,this.video,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE));let u=!1;for(const d in this.tiles){const _=this.tiles[d];_.state!=="loaded"&&(_.state="loaded",_.texture=this.texture,u=!0)}u&&this.fire(new a.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class lt extends ut{constructor(e,i,u,d){super(e,i,u,d),i.coordinates?Array.isArray(i.coordinates)&&i.coordinates.length===4&&!i.coordinates.some(_=>!Array.isArray(_)||_.length!==2||_.some(x=>typeof x!="number"))||this.fire(new a.k(new a.a3(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.k(new a.a3(`sources.${e}`,null,'missing required property "coordinates"'))),i.animate&&typeof i.animate!="boolean"&&this.fire(new a.k(new a.a3(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),i.canvas?typeof i.canvas=="string"||i.canvas instanceof HTMLCanvasElement||this.fire(new a.k(new a.a3(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.k(new a.a3(`sources.${e}`,null,'missing required property "canvas"'))),this.options=i,this.animate=i.animate===void 0||i.animate}load(){return a._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const i=this.map.painter.context,u=i.gl;this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Ie(i,this.canvas,u.RGBA,{premultiply:!0});let d=!1;for(const _ in this.tiles){const x=this.tiles[_];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture,d=!0)}d&&this.fire(new a.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const Lt={},bt=g=>{switch(g){case"geojson":return _t;case"image":return ut;case"raster":return nt;case"raster-dem":return st;case"vector":return at;case"video":return ht;case"canvas":return lt}return Lt[g]},It="RTLPluginLoaded";class Ot extends a.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=hr()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch(i=>{throw this.status="error",i})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return a._(this,arguments,void 0,function*(i,u=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=N.resolveURL(i),!this.url)throw new Error(`requested url ${i} is invalid`);if(this.status==="unavailable"){if(!u)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return a._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new a.l(It))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let qt=null;function ir(){return qt||(qt=new Ot),qt}class er{constructor(e,i){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=a.a4(),this.uses=0,this.tileSize=i,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){const i=e+this.timeAdded;i<this.fadeEndTime||(this.fadeEndTime=i)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,i,u){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(d,_){const x={};if(!_)return x;for(const T of d){const E=T.layerIds.map(M=>_.getLayer(M)).filter(Boolean);if(E.length!==0){T.layers=E,T.stateDependentLayerIds&&(T.stateDependentLayers=T.stateDependentLayerIds.map(M=>E.filter(D=>D.id===M)[0]));for(const M of E)x[M.id]=T}}return x}(e.buckets,i==null?void 0:i.style),this.hasSymbolBuckets=!1;for(const d in this.buckets){const _=this.buckets[d];if(_ instanceof a.a6){if(this.hasSymbolBuckets=!0,!u)break;_.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const d in this.buckets){const _=this.buckets[d];if(_ instanceof a.a6&&_.hasRTLText){this.hasRTLText=!0,ir().lazyLoad();break}}this.queryPadding=0;for(const d in this.buckets){const _=this.buckets[d];this.queryPadding=Math.max(this.queryPadding,i.style.getLayer(d).queryRadius(_))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new a.a5}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const u in this.buckets){const d=this.buckets[u];d.uploadPending()&&d.upload(e)}const i=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Ie(e,this.imageAtlas.image,i.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Ie(e,this.glyphAtlasImage,i.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,i,u,d,_,x,T,E,M,D,B){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:d,cameraQueryGeometry:_,scale:x,tileSize:this.tileSize,pixelPosMatrix:D,transform:E,params:T,queryPadding:this.queryPadding*M,getElevation:B},e,i,u):{}}querySourceFeatures(e,i){const u=this.latestFeatureIndex;if(!u||!u.rawTileData)return;const d=u.loadVTLayers(),_=i&&i.sourceLayer?i.sourceLayer:"",x=d._geojsonTileLayer||d[_];if(!x)return;const T=a.a7(i&&i.filter),{z:E,x:M,y:D}=this.tileID.canonical,B={z:E,x:M,y:D};for(let O=0;O<x.length;O++){const Z=x.feature(O);if(T.needGeometry){const ie=a.a8(Z,!0);if(!T.filter(new a.C(this.tileID.overscaledZ),ie,this.tileID.canonical))continue}else if(!T.filter(new a.C(this.tileID.overscaledZ),Z))continue;const K=u.getId(Z,_),ne=new a.a9(Z,E,M,D,K);ne.tile=B,e.push(ne)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const i=this.expirationTime;if(e.cacheControl){const u=a.aa(e.cacheControl);u["max-age"]&&(this.expirationTime=Date.now()+1e3*u["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const u=Date.now();let d=!1;if(this.expirationTime>u)d=!1;else if(i)if(this.expirationTime<i)d=!0;else{const _=this.expirationTime-i;_?this.expirationTime=u+Math.max(_,3e4):d=!0}else d=!0;d?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,i){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;const u=this.latestFeatureIndex.loadVTLayers();for(const d in this.buckets){if(!i.style.hasLayer(d))continue;const _=this.buckets[d],x=_.layers[0].sourceLayer||"_geojsonTileLayer",T=u[x],E=e[x];if(!T||!E||Object.keys(E).length===0)continue;_.update(E,T,this.imageAtlas&&this.imageAtlas.patternPositions||{});const M=i&&i.style&&i.style.getLayer(d);M&&(this.queryPadding=Math.max(this.queryPadding,M.queryRadius(_)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<N.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=N.now()+e}setDependencies(e,i){const u={};for(const d of i)u[d]=!0;this.dependencies[e]=u}hasDependency(e,i){for(const u of e){const d=this.dependencies[u];if(d){for(const _ of i)if(d[_])return!0}}return!1}}class Wr{constructor(e,i){this.max=e,this.onRemove=i,this.reset()}reset(){for(const e in this.data)for(const i of this.data[e])i.timeout&&clearTimeout(i.timeout),this.onRemove(i.value);return this.data={},this.order=[],this}add(e,i,u){const d=e.wrapped().key;this.data[d]===void 0&&(this.data[d]=[]);const _={value:i,timeout:void 0};if(u!==void 0&&(_.timeout=setTimeout(()=>{this.remove(e,_)},u)),this.data[d].push(_),this.order.push(d),this.order.length>this.max){const x=this._getAndRemoveByKey(this.order[0]);x&&this.onRemove(x)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const i=this.data[e].shift();return i.timeout&&clearTimeout(i.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),i.value}getByKey(e){const i=this.data[e];return i?i[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,i){if(!this.has(e))return this;const u=e.wrapped().key,d=i===void 0?0:this.data[u].indexOf(i),_=this.data[u][d];return this.data[u].splice(d,1),_.timeout&&clearTimeout(_.timeout),this.data[u].length===0&&delete this.data[u],this.onRemove(_.value),this.order.splice(this.order.indexOf(u),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const i=this._getAndRemoveByKey(this.order[0]);i&&this.onRemove(i)}return this}filter(e){const i=[];for(const u in this.data)for(const d of this.data[u])e(d.value)||i.push(d);for(const u of i)this.remove(u.value.tileID,u)}}class Kr{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,i,u){const d=String(i);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][d]=this.stateChanges[e][d]||{},a.e(this.stateChanges[e][d],u),this.deletedStates[e]===null){this.deletedStates[e]={};for(const _ in this.state[e])_!==d&&(this.deletedStates[e][_]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][d]===null){this.deletedStates[e][d]={};for(const _ in this.state[e][d])u[_]||(this.deletedStates[e][d][_]=null)}else for(const _ in u)this.deletedStates[e]&&this.deletedStates[e][d]&&this.deletedStates[e][d][_]===null&&delete this.deletedStates[e][d][_]}removeFeatureState(e,i,u){if(this.deletedStates[e]===null)return;const d=String(i);if(this.deletedStates[e]=this.deletedStates[e]||{},u&&i!==void 0)this.deletedStates[e][d]!==null&&(this.deletedStates[e][d]=this.deletedStates[e][d]||{},this.deletedStates[e][d][u]=null);else if(i!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][d])for(u in this.deletedStates[e][d]={},this.stateChanges[e][d])this.deletedStates[e][d][u]=null;else this.deletedStates[e][d]=null;else this.deletedStates[e]=null}getState(e,i){const u=String(i),d=a.e({},(this.state[e]||{})[u],(this.stateChanges[e]||{})[u]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const _=this.deletedStates[e][i];if(_===null)return{};for(const x in _)delete d[x]}return d}initializeTileState(e,i){e.setFeatureState(this.state,i)}coalesceChanges(e,i){const u={};for(const d in this.stateChanges){this.state[d]=this.state[d]||{};const _={};for(const x in this.stateChanges[d])this.state[d][x]||(this.state[d][x]={}),a.e(this.state[d][x],this.stateChanges[d][x]),_[x]=this.state[d][x];u[d]=_}for(const d in this.deletedStates){this.state[d]=this.state[d]||{};const _={};if(this.deletedStates[d]===null)for(const x in this.state[d])_[x]={},this.state[d][x]={};else for(const x in this.deletedStates[d]){if(this.deletedStates[d][x]===null)this.state[d][x]={};else for(const T of Object.keys(this.deletedStates[d][x]))delete this.state[d][x][T];_[x]=this.state[d][x]}u[d]=u[d]||{},a.e(u[d],_)}if(this.stateChanges={},this.deletedStates={},Object.keys(u).length!==0)for(const d in e)e[d].setFeatureState(u,i)}}function zi(g,e,i){const u=e.intersectsFrustum(g);if(!i)return u;const d=e.intersectsPlane(i);return u===0||d===0?0:u===2&&d===2?2:1}function Si(g,e,i,u,d){let _=g;const x=Math.atan(e/i),T=Math.hypot(e,i);return _=g+a.ab(u/T/Math.max(.5,Math.cos(a.ad(d/2)))),_+=1*a.ab(Math.cos(x))/2,_+=a.ae(g-_,-0,0),_}function Ki(g,e){const i=(e.roundZoom?Math.round:Math.floor)(g.zoom+a.ab(g.tileSize/e.tileSize));return Math.max(0,i)}function Pe(g,e){const i=g.getCameraFrustum(),u=g.getClippingPlane(),d=g.screenPointToMercatorCoordinate(g.getCameraPoint()),_=a.$.fromLngLat(g.center,g.elevation);d.z=_.z+Math.cos(g.pitchInRadians)*g.cameraToCenterDistance/g.worldSize;const x=g.getCoveringTilesDetailsProvider(),T=x.allowVariableZoom(g,e),E=Ki(g,e),M=e.minzoom||0,D=e.maxzoom!==void 0?e.maxzoom:g.maxZoom,B=Math.min(Math.max(0,E),D),O=Math.pow(2,B),Z=[O*d.x,O*d.y,0],K=[O*_.x,O*_.y,0],ne=Math.hypot(_.x-d.x,_.y-d.y),ie=Math.abs(_.z-d.z),oe=Math.hypot(ne,ie),ce=ge=>({zoom:0,x:0,y:0,wrap:ge,fullyVisible:!1}),fe=[],me=[];if(g.renderWorldCopies&&x.allowWorldCopies())for(let ge=1;ge<=3;ge++)fe.push(ce(-ge)),fe.push(ce(ge));for(fe.push(ce(0));fe.length>0;){const ge=fe.pop(),Te=ge.x,_e=ge.y;let Oe=ge.fullyVisible;const De={x:Te,y:_e,z:ge.zoom},Ze=x.getTileAABB(De,ge.wrap,g.elevation,e);if(!Oe){const dt=zi(i,Ze,u);if(dt===0)continue;Oe=dt===2}const Ke=x.distanceToTile2d(d.x,d.y,De,Ze);let Ue=E;T&&(Ue=(e.calculateTileZoom||Si)(g.zoom+a.ab(g.tileSize/e.tileSize),Ke,ie,oe,g.fov)),Ue=(e.roundZoom?Math.round:Math.floor)(Ue),Ue=Math.max(0,Ue);const ft=Math.min(Ue,D);if(ge.wrap=x.getWrap(_,De,ge.wrap),ge.zoom>=ft){if(ge.zoom<M)continue;const dt=B-ge.zoom,Je=Z[0]-.5-(Te<<dt),Et=Z[1]-.5-(_e<<dt),Ht=e.reparseOverscaled?Math.max(ge.zoom,Ue):ge.zoom;me.push({tileID:new a.Y(ge.zoom===D?Ht:ge.zoom,ge.wrap,ge.zoom,Te,_e),distanceSq:a.ac([K[0]-.5-Te,K[1]-.5-_e]),tileDistanceToCamera:Math.sqrt(Je*Je+Et*Et)})}else for(let dt=0;dt<4;dt++)fe.push({zoom:ge.zoom+1,x:(Te<<1)+dt%2,y:(_e<<1)+(dt>>1),wrap:ge.wrap,fullyVisible:Oe})}return me.sort((ge,Te)=>ge.distanceSq-Te.distanceSq).map(ge=>ge.tileID)}class q extends a.E{constructor(e,i,u){super(),this.id=e,this.dispatcher=u,this.on("data",d=>this._dataHandler(d)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((d,_,x,T)=>{const E=new(bt(_.type))(d,_,x,T);if(E.id!==d)throw new Error(`Expected Source id to be ${d} instead of ${E.id}`);return E})(e,i,u,this),this._tiles={},this._cache=new Wr(0,d=>this._unloadTile(d)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Kr,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const i=this._tiles[e];if(i.state!=="loaded"&&i.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,i,u){return a._(this,void 0,void 0,function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,i,u)}catch(d){e.state="errored",d.status!==404?this._source.fire(new a.k(d,{tile:e})):this.update(this.transform,this.terrain)}})}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new a.l("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const i in this._tiles){const u=this._tiles[i];u.upload(e),u.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(e=>e.tileID).sort(Y).map(e=>e.key)}getRenderableIds(e){const i=[];for(const u in this._tiles)this._isIdRenderable(u,e)&&i.push(this._tiles[u]);return e?i.sort((u,d)=>{const _=u.tileID,x=d.tileID,T=new a.P(_.canonical.x,_.canonical.y)._rotate(-this.transform.bearingInRadians),E=new a.P(x.canonical.x,x.canonical.y)._rotate(-this.transform.bearingInRadians);return _.overscaledZ-x.overscaledZ||E.y-T.y||E.x-T.x}).map(u=>u.tileID.key):i.map(u=>u.tileID).sort(Y).map(u=>u.key)}hasRenderableParent(e){const i=this.findLoadedParent(e,0);return!!i&&this._isIdRenderable(i.tileID.key)}_isIdRenderable(e,i){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(i||!this._tiles[e].holdingForFade())}reload(e){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const i in this._tiles)(e||this._tiles[i].state!=="errored")&&this._reloadTile(i,"reloading")}}_reloadTile(e,i){return a._(this,void 0,void 0,function*(){const u=this._tiles[e];u&&(u.state!=="loading"&&(u.state=i),yield this._loadTile(u,e,i))})}_tileLoaded(e,i,u){e.timeAdded=N.now(),u==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(i,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new a.l("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){const i=this.getRenderableIds();for(let d=0;d<i.length;d++){const _=i[d];if(e.neighboringTiles&&e.neighboringTiles[_]){const x=this.getTileByID(_);u(e,x),u(x,e)}}function u(d,_){d.needsHillshadePrepare=!0,d.needsTerrainPrepare=!0;let x=_.tileID.canonical.x-d.tileID.canonical.x;const T=_.tileID.canonical.y-d.tileID.canonical.y,E=Math.pow(2,d.tileID.canonical.z),M=_.tileID.key;x===0&&T===0||Math.abs(T)>1||(Math.abs(x)>1&&(Math.abs(x+E)===1?x+=E:Math.abs(x-E)===1&&(x-=E)),_.dem&&d.dem&&(d.dem.backfillBorder(_.dem,x,T),d.neighboringTiles&&d.neighboringTiles[M]&&(d.neighboringTiles[M].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,i,u,d){for(const _ in this._tiles){let x=this._tiles[_];if(d[_]||!x.hasData()||x.tileID.overscaledZ<=i||x.tileID.overscaledZ>u)continue;let T=x.tileID;for(;x&&x.tileID.overscaledZ>i+1;){const M=x.tileID.scaledTo(x.tileID.overscaledZ-1);x=this._tiles[M.key],x&&x.hasData()&&(T=M)}let E=T;for(;E.overscaledZ>i;)if(E=E.scaledTo(E.overscaledZ-1),e[E.key]||e[E.canonical.key]){d[T.key]=T;break}}}findLoadedParent(e,i){if(e.key in this._loadedParentTiles){const u=this._loadedParentTiles[e.key];return u&&u.tileID.overscaledZ>=i?u:null}for(let u=e.overscaledZ-1;u>=i;u--){const d=e.scaledTo(u),_=this._getLoadedTile(d);if(_)return _}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){const i=this._tiles[e.key];return i&&i.hasData()?i:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){const i=Math.ceil(e.width/this._source.tileSize)+1,u=Math.ceil(e.height/this._source.tileSize)+1,d=Math.floor(i*u*(this._maxTileCacheZoomLevels===null?a.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),_=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,d):d;this._cache.setMaxSize(_)}handleWrapJump(e){const i=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,i){const u={};for(const d in this._tiles){const _=this._tiles[d];_.tileID=_.tileID.unwrapTo(_.tileID.wrap+i),u[_.tileID.key]=_}this._tiles=u;for(const d in this._timers)clearTimeout(this._timers[d]),delete this._timers[d];for(const d in this._tiles)this._setTileReloadTimer(d,this._tiles[d])}}_updateCoveredAndRetainedTiles(e,i,u,d,_,x){const T={},E={},M=Object.keys(e),D=N.now();for(const B of M){const O=e[B],Z=this._tiles[B];if(!Z||Z.fadeEndTime!==0&&Z.fadeEndTime<=D)continue;const K=this.findLoadedParent(O,i),ne=this.findLoadedSibling(O),ie=K||ne||null;ie&&(this._addTile(ie.tileID),T[ie.tileID.key]=ie.tileID),E[B]=O}this._retainLoadedChildren(E,d,u,e);for(const B in T)e[B]||(this._coveredTiles[B]=!0,e[B]=T[B]);if(x){const B={},O={};for(const Z of _)this._tiles[Z.key].hasData()?B[Z.key]=Z:O[Z.key]=Z;for(const Z in O){const K=O[Z].children(this._source.maxzoom);this._tiles[K[0].key]&&this._tiles[K[1].key]&&this._tiles[K[2].key]&&this._tiles[K[3].key]&&(B[K[0].key]=e[K[0].key]=K[0],B[K[1].key]=e[K[1].key]=K[1],B[K[2].key]=e[K[2].key]=K[2],B[K[3].key]=e[K[3].key]=K[3],delete O[Z])}for(const Z in O){const K=O[Z],ne=this.findLoadedParent(K,this._source.minzoom),ie=this.findLoadedSibling(K),oe=ne||ie||null;if(oe){B[oe.tileID.key]=e[oe.tileID.key]=oe.tileID;for(const ce in B)B[ce].isChildOf(oe.tileID)&&delete B[ce]}}for(const Z in this._tiles)B[Z]||(this._coveredTiles[Z]=!0)}}update(e,i){if(!this._sourceLoaded||this._paused)return;let u;this.transform=e,this.terrain=i,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?u=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(D=>new a.Y(D.canonical.z,D.wrap,D.canonical.z,D.canonical.x,D.canonical.y)):(u=Pe(e,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:i,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(u=u.filter(D=>this._source.hasTile(D)))):u=[];const d=Ki(e,this._source),_=Math.max(d-q.maxOverzooming,this._source.minzoom),x=Math.max(d+q.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const D={};for(const B of u)if(B.canonical.z>this._source.minzoom){const O=B.scaledTo(B.canonical.z-1);D[O.key]=O;const Z=B.scaledTo(Math.max(this._source.minzoom,Math.min(B.canonical.z,5)));D[Z.key]=Z}u=u.concat(Object.values(D))}const T=u.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,T&&this.fire(new a.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const E=this._updateRetainedTiles(u,d);U(this._source.type)&&this._updateCoveredAndRetainedTiles(E,_,x,d,u,i);for(const D in E)this._tiles[D].clearFadeHold();const M=a.af(this._tiles,E);for(const D of M){const B=this._tiles[D];B.hasSymbolBuckets&&!B.holdingForFade()?B.setHoldDuration(this.map._fadeDuration):B.hasSymbolBuckets&&!B.symbolFadeFinished()||this._removeTile(D)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,i){var u;const d={},_={},x=Math.max(i-q.maxOverzooming,this._source.minzoom),T=Math.max(i+q.maxUnderzooming,this._source.minzoom),E={};for(const M of e){const D=this._addTile(M);d[M.key]=M,D.hasData()||i<this._source.maxzoom&&(E[M.key]=M)}this._retainLoadedChildren(E,i,T,d);for(const M of e){let D=this._tiles[M.key];if(D.hasData())continue;if(i+1>this._source.maxzoom){const O=M.children(this._source.maxzoom)[0],Z=this.getTile(O);if(Z&&Z.hasData()){d[O.key]=O;continue}}else{const O=M.children(this._source.maxzoom);if(d[O[0].key]&&d[O[1].key]&&d[O[2].key]&&d[O[3].key])continue}let B=D.wasRequested();for(let O=M.overscaledZ-1;O>=x;--O){const Z=M.scaledTo(O);if(_[Z.key])break;if(_[Z.key]=!0,D=this.getTile(Z),!D&&B&&(D=this._addTile(Z)),D){const K=D.hasData();if((K||!(!((u=this.map)===null||u===void 0)&&u.cancelPendingTileRequestsWhileZooming)||B)&&(d[Z.key]=Z),B=D.wasRequested(),K)break}}}return d}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const i=[];let u,d=this._tiles[e].tileID;for(;d.overscaledZ>0;){if(d.key in this._loadedParentTiles){u=this._loadedParentTiles[d.key];break}i.push(d.key);const _=d.scaledTo(d.overscaledZ-1);if(u=this._getLoadedTile(_),u)break;d=_}for(const _ of i)this._loadedParentTiles[_]=u}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const e in this._tiles){const i=this._tiles[e].tileID,u=this._getLoadedTile(i);this._loadedSiblingTiles[i.key]=u}}_addTile(e){let i=this._tiles[e.key];if(i)return i;i=this._cache.getAndRemove(e),i&&(this._setTileReloadTimer(e.key,i),i.tileID=e,this._state.initializeTileState(i,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,i)));const u=i;return i||(i=new er(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(i,e.key,i.state)),i.uses++,this._tiles[e.key]=i,u||this._source.fire(new a.l("dataloading",{tile:i,coord:i.tileID,dataType:"source"})),i}_setTileReloadTimer(e,i){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const u=i.getExpiryTimeout();u&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},u))}_removeTile(e){const i=this._tiles[e];i&&(i.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),i.uses>0||(i.hasData()&&i.state!=="reloading"?this._cache.add(i.tileID,i,i.getExpiryTimeout()):(i.aborted=!0,this._abortTile(i),this._unloadTile(i))))}_dataHandler(e){const i=e.sourceDataType;e.dataType==="source"&&i==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&i==="content"&&(this.reload(e.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,i,u){const d=[],_=this.transform;if(!_)return d;const x=u?_.getCameraQueryGeometry(e):e,T=e.map(K=>_.screenPointToMercatorCoordinate(K,this.terrain)),E=x.map(K=>_.screenPointToMercatorCoordinate(K,this.terrain)),M=this.getIds();let D=1/0,B=1/0,O=-1/0,Z=-1/0;for(const K of E)D=Math.min(D,K.x),B=Math.min(B,K.y),O=Math.max(O,K.x),Z=Math.max(Z,K.y);for(let K=0;K<M.length;K++){const ne=this._tiles[M[K]];if(ne.holdingForFade())continue;const ie=ne.tileID,oe=Math.pow(2,_.zoom-ne.tileID.overscaledZ),ce=i*ne.queryPadding*a.Z/ne.tileSize/oe,fe=[ie.getTilePoint(new a.$(D,B)),ie.getTilePoint(new a.$(O,Z))];if(fe[0].x-ce<a.Z&&fe[0].y-ce<a.Z&&fe[1].x+ce>=0&&fe[1].y+ce>=0){const me=T.map(Te=>ie.getTilePoint(Te)),ge=E.map(Te=>ie.getTilePoint(Te));d.push({tile:ne,tileID:ie,queryGeometry:me,cameraQueryGeometry:ge,scale:oe})}}return d}getVisibleCoordinates(e){const i=this.getRenderableIds(e).map(u=>this._tiles[u].tileID);return this.transform&&this.transform.populateCache(i),i}hasTransition(){if(this._source.hasTransition())return!0;if(U(this._source.type)){const e=N.now();for(const i in this._tiles)if(this._tiles[i].fadeEndTime>=e)return!0}return!1}setFeatureState(e,i,u){this._state.updateState(e=e||"_geojsonTileLayer",i,u)}removeFeatureState(e,i,u){this._state.removeFeatureState(e=e||"_geojsonTileLayer",i,u)}getFeatureState(e,i){return this._state.getState(e=e||"_geojsonTileLayer",i)}setDependencies(e,i,u){const d=this._tiles[e];d&&d.setDependencies(i,u)}reloadTilesForDependencies(e,i){for(const u in this._tiles)this._tiles[u].hasDependency(e,i)&&this._reloadTile(u,"reloading");this._cache.filter(u=>!u.hasDependency(e,i))}}function Y(g,e){const i=Math.abs(2*g.wrap)-+(g.wrap<0),u=Math.abs(2*e.wrap)-+(e.wrap<0);return g.overscaledZ-e.overscaledZ||u-i||e.canonical.y-g.canonical.y||e.canonical.x-g.canonical.x}function U(g){return g==="raster"||g==="image"||g==="video"}q.maxOverzooming=10,q.maxUnderzooming=3;class he{constructor(e,i){this.reset(e,i)}reset(e,i){this.points=e||[],this._distances=[0];for(let u=1;u<this.points.length;u++)this._distances[u]=this._distances[u-1]+this.points[u].dist(this.points[u-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(i||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=a.ae(e,0,1);let i=1,u=this._distances[i];const d=e*this.paddedLength+this.padding;for(;u<d&&i<this._distances.length;)u=this._distances[++i];const _=i-1,x=this._distances[_],T=u-x,E=T>0?(d-x)/T:0;return this.points[_].mult(1-E).add(this.points[i].mult(E))}}function xe(g,e){let i=!0;return g==="always"||g!=="never"&&e!=="never"||(i=!1),i}class ve{constructor(e,i,u){const d=this.boxCells=[],_=this.circleCells=[];this.xCellCount=Math.ceil(e/u),this.yCellCount=Math.ceil(i/u);for(let x=0;x<this.xCellCount*this.yCellCount;x++)d.push([]),_.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=i,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/i,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,i,u,d,_){this._forEachCell(i,u,d,_,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(i),this.bboxes.push(u),this.bboxes.push(d),this.bboxes.push(_)}insertCircle(e,i,u,d){this._forEachCell(i-d,u-d,i+d,u+d,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(i),this.circles.push(u),this.circles.push(d)}_insertBoxCell(e,i,u,d,_,x){this.boxCells[_].push(x)}_insertCircleCell(e,i,u,d,_,x){this.circleCells[_].push(x)}_query(e,i,u,d,_,x,T){if(u<0||e>this.width||d<0||i>this.height)return[];const E=[];if(e<=0&&i<=0&&this.width<=u&&this.height<=d){if(_)return[{key:null,x1:e,y1:i,x2:u,y2:d}];for(let M=0;M<this.boxKeys.length;M++)E.push({key:this.boxKeys[M],x1:this.bboxes[4*M],y1:this.bboxes[4*M+1],x2:this.bboxes[4*M+2],y2:this.bboxes[4*M+3]});for(let M=0;M<this.circleKeys.length;M++){const D=this.circles[3*M],B=this.circles[3*M+1],O=this.circles[3*M+2];E.push({key:this.circleKeys[M],x1:D-O,y1:B-O,x2:D+O,y2:B+O})}}else this._forEachCell(e,i,u,d,this._queryCell,E,{hitTest:_,overlapMode:x,seenUids:{box:{},circle:{}}},T);return E}query(e,i,u,d){return this._query(e,i,u,d,!1,null)}hitTest(e,i,u,d,_,x){return this._query(e,i,u,d,!0,_,x).length>0}hitTestCircle(e,i,u,d,_){const x=e-u,T=e+u,E=i-u,M=i+u;if(T<0||x>this.width||M<0||E>this.height)return!1;const D=[];return this._forEachCell(x,E,T,M,this._queryCellCircle,D,{hitTest:!0,overlapMode:d,circle:{x:e,y:i,radius:u},seenUids:{box:{},circle:{}}},_),D.length>0}_queryCell(e,i,u,d,_,x,T,E){const{seenUids:M,hitTest:D,overlapMode:B}=T,O=this.boxCells[_];if(O!==null){const K=this.bboxes;for(const ne of O)if(!M.box[ne]){M.box[ne]=!0;const ie=4*ne,oe=this.boxKeys[ne];if(e<=K[ie+2]&&i<=K[ie+3]&&u>=K[ie+0]&&d>=K[ie+1]&&(!E||E(oe))&&(!D||!xe(B,oe.overlapMode))&&(x.push({key:oe,x1:K[ie],y1:K[ie+1],x2:K[ie+2],y2:K[ie+3]}),D))return!0}}const Z=this.circleCells[_];if(Z!==null){const K=this.circles;for(const ne of Z)if(!M.circle[ne]){M.circle[ne]=!0;const ie=3*ne,oe=this.circleKeys[ne];if(this._circleAndRectCollide(K[ie],K[ie+1],K[ie+2],e,i,u,d)&&(!E||E(oe))&&(!D||!xe(B,oe.overlapMode))){const ce=K[ie],fe=K[ie+1],me=K[ie+2];if(x.push({key:oe,x1:ce-me,y1:fe-me,x2:ce+me,y2:fe+me}),D)return!0}}}return!1}_queryCellCircle(e,i,u,d,_,x,T,E){const{circle:M,seenUids:D,overlapMode:B}=T,O=this.boxCells[_];if(O!==null){const K=this.bboxes;for(const ne of O)if(!D.box[ne]){D.box[ne]=!0;const ie=4*ne,oe=this.boxKeys[ne];if(this._circleAndRectCollide(M.x,M.y,M.radius,K[ie+0],K[ie+1],K[ie+2],K[ie+3])&&(!E||E(oe))&&!xe(B,oe.overlapMode))return x.push(!0),!0}}const Z=this.circleCells[_];if(Z!==null){const K=this.circles;for(const ne of Z)if(!D.circle[ne]){D.circle[ne]=!0;const ie=3*ne,oe=this.circleKeys[ne];if(this._circlesCollide(K[ie],K[ie+1],K[ie+2],M.x,M.y,M.radius)&&(!E||E(oe))&&!xe(B,oe.overlapMode))return x.push(!0),!0}}}_forEachCell(e,i,u,d,_,x,T,E){const M=this._convertToXCellCoord(e),D=this._convertToYCellCoord(i),B=this._convertToXCellCoord(u),O=this._convertToYCellCoord(d);for(let Z=M;Z<=B;Z++)for(let K=D;K<=O;K++)if(_.call(this,e,i,u,d,this.xCellCount*K+Z,x,T,E))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,i,u,d,_,x){const T=d-e,E=_-i,M=u+x;return M*M>T*T+E*E}_circleAndRectCollide(e,i,u,d,_,x,T){const E=(x-d)/2,M=Math.abs(e-(d+E));if(M>E+u)return!1;const D=(T-_)/2,B=Math.abs(i-(_+D));if(B>D+u)return!1;if(M<=E||B<=D)return!0;const O=M-E,Z=B-D;return O*O+Z*Z<=u*u}}function ze(g,e,i){const u=a.K();if(!g){const{vecSouth:B,vecEast:O}=Ge(e),Z=z();Z[0]=O[0],Z[1]=O[1],Z[2]=B[0],Z[3]=B[1],d=Z,(D=(x=(_=Z)[0])*(M=_[3])-(E=_[2])*(T=_[1]))&&(d[0]=M*(D=1/D),d[1]=-T*D,d[2]=-E*D,d[3]=x*D),u[0]=Z[0],u[1]=Z[1],u[4]=Z[2],u[5]=Z[3]}var d,_,x,T,E,M,D;return a.M(u,u,[1/i,1/i,1]),u}function Ce(g,e,i,u){if(g){const d=a.K();if(!e){const{vecSouth:_,vecEast:x}=Ge(i);d[0]=x[0],d[1]=x[1],d[4]=_[0],d[5]=_[1]}return a.M(d,d,[u,u,1]),d}return i.pixelsToClipSpaceMatrix}function Ge(g){const e=Math.cos(g.rollInRadians),i=Math.sin(g.rollInRadians),u=Math.cos(g.pitchInRadians),d=Math.cos(g.bearingInRadians),_=Math.sin(g.bearingInRadians),x=a.ak();x[0]=-d*u*i-_*e,x[1]=-_*u*i+d*e;const T=a.al(x);T<1e-9?a.am(x):a.an(x,x,1/T);const E=a.ak();E[0]=d*u*e-_*i,E[1]=_*u*e+d*i;const M=a.al(E);return M<1e-9?a.am(E):a.an(E,E,1/M),{vecEast:E,vecSouth:x}}function Ne(g,e,i,u){let d;u?(d=[g,e,u(g,e),1],a.ap(d,d,i)):(d=[g,e,0,1],mi(d,d,i));const _=d[3];return{point:new a.P(d[0]/_,d[1]/_),signedDistanceFromCamera:_,isOccluded:!1}}function ke(g,e){return .5+g/e*.5}function Qe(g,e){return g.x>=-e[0]&&g.x<=e[0]&&g.y>=-e[1]&&g.y<=e[1]}function mt(g,e,i,u,d,_,x,T,E,M,D,B,O){const Z=i?g.textSizeData:g.iconSizeData,K=a.ag(Z,e.transform.zoom),ne=[256/e.width*2+1,256/e.height*2+1],ie=i?g.text.dynamicLayoutVertexArray:g.icon.dynamicLayoutVertexArray;ie.clear();const oe=g.lineVertexArray,ce=i?g.text.placedSymbolArray:g.icon.placedSymbolArray,fe=e.transform.width/e.transform.height;let me=!1;for(let ge=0;ge<ce.length;ge++){const Te=ce.get(ge);if(Te.hidden||Te.writingMode===a.ah.vertical&&!me){Ft(Te.numGlyphs,ie);continue}me=!1;const _e=new a.P(Te.anchorX,Te.anchorY),Oe={getElevation:O,pitchedLabelPlaneMatrix:u,lineVertexArray:oe,pitchWithMap:_,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:e.transform,tileAnchorPoint:_e,unwrappedTileID:E,width:M,height:D,translation:B},De=St(Te.anchorX,Te.anchorY,Oe);if(!Qe(De.point,ne)){Ft(Te.numGlyphs,ie);continue}const Ze=ke(e.transform.cameraToCenterDistance,De.signedDistanceFromCamera),Ke=a.ai(Z,K,Te),Ue=_?Ke*e.transform.getPitchedTextCorrection(Te.anchorX,Te.anchorY,E)/Ze:Ke*Ze,ft=Nt({projectionContext:Oe,pitchedLabelPlaneMatrixInverse:d,symbol:Te,fontSize:Ue,flip:!1,keepUpright:x,glyphOffsetArray:g.glyphOffsetArray,dynamicLayoutVertexArray:ie,aspectRatio:fe,rotateToLine:T});me=ft.useVertical,(ft.notEnoughRoom||me||ft.needsFlipping&&Nt({projectionContext:Oe,pitchedLabelPlaneMatrixInverse:d,symbol:Te,fontSize:Ue,flip:!0,keepUpright:x,glyphOffsetArray:g.glyphOffsetArray,dynamicLayoutVertexArray:ie,aspectRatio:fe,rotateToLine:T}).notEnoughRoom)&&Ft(Te.numGlyphs,ie)}i?g.text.dynamicLayoutVertexBuffer.updateData(ie):g.icon.dynamicLayoutVertexBuffer.updateData(ie)}function gt(g,e,i,u,d,_,x,T){const E=_.glyphStartIndex+_.numGlyphs,M=_.lineStartIndex,D=_.lineStartIndex+_.lineLength,B=e.getoffsetX(_.glyphStartIndex),O=e.getoffsetX(E-1),Z=Xr(g*B,i,u,d,_.segment,M,D,T,x);if(!Z)return null;const K=Xr(g*O,i,u,d,_.segment,M,D,T,x);return K?T.projectionCache.anyProjectionOccluded?null:{first:Z,last:K}:null}function Ve(g,e,i,u){return g===a.ah.horizontal&&Math.abs(i.y-e.y)>Math.abs(i.x-e.x)*u?{useVertical:!0}:(g===a.ah.vertical?e.y<i.y:e.x>i.x)?{needsFlipping:!0}:null}function Nt(g){const{projectionContext:e,pitchedLabelPlaneMatrixInverse:i,symbol:u,fontSize:d,flip:_,keepUpright:x,glyphOffsetArray:T,dynamicLayoutVertexArray:E,aspectRatio:M,rotateToLine:D}=g,B=d/24,O=u.lineOffsetX*B,Z=u.lineOffsetY*B;let K;if(u.numGlyphs>1){const ne=u.glyphStartIndex+u.numGlyphs,ie=u.lineStartIndex,oe=u.lineStartIndex+u.lineLength,ce=gt(B,T,O,Z,_,u,D,e);if(!ce)return{notEnoughRoom:!0};const fe=rt(ce.first.point.x,ce.first.point.y,e,i),me=rt(ce.last.point.x,ce.last.point.y,e,i);if(x&&!_){const ge=Ve(u.writingMode,fe,me,M);if(ge)return ge}K=[ce.first];for(let ge=u.glyphStartIndex+1;ge<ne-1;ge++)K.push(Xr(B*T.getoffsetX(ge),O,Z,_,u.segment,ie,oe,e,D));K.push(ce.last)}else{if(x&&!_){const ie=ar(e.tileAnchorPoint.x,e.tileAnchorPoint.y,e).point,oe=u.lineStartIndex+u.segment+1,ce=new a.P(e.lineVertexArray.getx(oe),e.lineVertexArray.gety(oe)),fe=ar(ce.x,ce.y,e),me=fe.signedDistanceFromCamera>0?fe.point:kt(e.tileAnchorPoint,ce,ie,1,e),ge=rt(ie.x,ie.y,e,i),Te=rt(me.x,me.y,e,i),_e=Ve(u.writingMode,ge,Te,M);if(_e)return _e}const ne=Xr(B*T.getoffsetX(u.glyphStartIndex),O,Z,_,u.segment,u.lineStartIndex,u.lineStartIndex+u.lineLength,e,D);if(!ne||e.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};K=[ne]}for(const ne of K)a.ao(E,ne.point,ne.angle);return{}}function kt(g,e,i,u,d){const _=g.add(g.sub(e)._unit()),x=ar(_.x,_.y,d).point,T=i.sub(x);return i.add(T._mult(u/T.mag()))}function jt(g,e,i){const u=e.projectionCache;if(u.projections[g])return u.projections[g];const d=new a.P(e.lineVertexArray.getx(g),e.lineVertexArray.gety(g)),_=ar(d.x,d.y,e);if(_.signedDistanceFromCamera>0)return u.projections[g]=_.point,u.anyProjectionOccluded=u.anyProjectionOccluded||_.isOccluded,_.point;const x=g-i.direction;return kt(i.distanceFromAnchor===0?e.tileAnchorPoint:new a.P(e.lineVertexArray.getx(x),e.lineVertexArray.gety(x)),d,i.previousVertex,i.absOffsetX-i.distanceFromAnchor+1,e)}function ar(g,e,i){const u=g+i.translation[0],d=e+i.translation[1];let _;return i.pitchWithMap?(_=Ne(u,d,i.pitchedLabelPlaneMatrix,i.getElevation),_.isOccluded=!1):(_=i.transform.projectTileCoordinates(u,d,i.unwrappedTileID,i.getElevation),_.point.x=(.5*_.point.x+.5)*i.width,_.point.y=(.5*-_.point.y+.5)*i.height),_}function rt(g,e,i,u){if(i.pitchWithMap){const d=[g,e,0,1];return a.ap(d,d,u),i.transform.projectTileCoordinates(d[0]/d[3],d[1]/d[3],i.unwrappedTileID,i.getElevation).point}return{x:g/i.width*2-1,y:e/i.height*2-1}}function St(g,e,i){return i.transform.projectTileCoordinates(g,e,i.unwrappedTileID,i.getElevation)}function pt(g,e,i){return g._unit()._perp()._mult(e*i)}function Ut(g,e,i,u,d,_,x,T,E){if(T.projectionCache.offsets[g])return T.projectionCache.offsets[g];const M=i.add(e);if(g+E.direction<u||g+E.direction>=d)return T.projectionCache.offsets[g]=M,M;const D=jt(g+E.direction,T,E),B=pt(D.sub(i),x,E.direction),O=i.add(B),Z=D.add(B);return T.projectionCache.offsets[g]=a.aq(_,M,O,Z)||M,T.projectionCache.offsets[g]}function Xr(g,e,i,u,d,_,x,T,E){const M=u?g-e:g+e;let D=M>0?1:-1,B=0;u&&(D*=-1,B=Math.PI),D<0&&(B+=Math.PI);let O,Z=D>0?_+d:_+d+1;T.projectionCache.cachedAnchorPoint?O=T.projectionCache.cachedAnchorPoint:(O=ar(T.tileAnchorPoint.x,T.tileAnchorPoint.y,T).point,T.projectionCache.cachedAnchorPoint=O);let K,ne,ie=O,oe=O,ce=0,fe=0;const me=Math.abs(M),ge=[];let Te;for(;ce+fe<=me;){if(Z+=D,Z<_||Z>=x)return null;ce+=fe,oe=ie,ne=K;const De={absOffsetX:me,direction:D,distanceFromAnchor:ce,previousVertex:oe};if(ie=jt(Z,T,De),i===0)ge.push(oe),Te=ie.sub(oe);else{let Ze;const Ke=ie.sub(oe);Ze=Ke.mag()===0?pt(jt(Z+D,T,De).sub(ie),i,D):pt(Ke,i,D),ne||(ne=oe.add(Ze)),K=Ut(Z,Ze,ie,_,x,ne,i,T,De),ge.push(ne),Te=K.sub(ne)}fe=Te.mag()}const _e=Te._mult((me-ce)/fe)._add(ne||oe),Oe=B+Math.atan2(ie.y-oe.y,ie.x-oe.x);return ge.push(_e),{point:_e,angle:E?Oe:0,path:ge}}const uo=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Ft(g,e){for(let i=0;i<g;i++){const u=e.length;e.resize(u+4),e.float32.set(uo,3*u)}}function mi(g,e,i){const u=e[0],d=e[1];return g[0]=i[0]*u+i[4]*d+i[12],g[1]=i[1]*u+i[5]*d+i[13],g[3]=i[3]*u+i[7]*d+i[15],g}const zr=100;class Dl{constructor(e,i=new ve(e.width+200,e.height+200,25),u=new ve(e.width+200,e.height+200,25)){this.transform=e,this.grid=i,this.ignoredGrid=u,this.pitchFactor=Math.cos(e.pitch*Math.PI/180)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+zr,this.screenBottomBoundary=e.height+zr,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,i,u,d,_,x,T,E,M,D,B,O){const Z=this.projectAndGetPerspectiveRatio(e.anchorPointX+E[0],e.anchorPointY+E[1],_,D,O),K=u*Z.perspectiveRatio;let ne;if(x||T)ne=this._projectCollisionBox(e,K,d,_,x,T,E,Z,D,B,O);else{const Te=Z.x+(B?B.x*K:0),_e=Z.y+(B?B.y*K:0);ne={allPointsOccluded:!1,box:[Te+e.x1*K,_e+e.y1*K,Te+e.x2*K,_e+e.y2*K]}}const[ie,oe,ce,fe]=ne.box,me=x?ne.allPointsOccluded:Z.isOccluded;let ge=me;return ge||(ge=Z.perspectiveRatio<this.perspectiveRatioCutoff),ge||(ge=!this.isInsideGrid(ie,oe,ce,fe)),ge||i!=="always"&&this.grid.hitTest(ie,oe,ce,fe,i,M)?{box:[ie,oe,ce,fe],placeable:!1,offscreen:!1,occluded:me}:{box:[ie,oe,ce,fe],placeable:!0,offscreen:this.isOffscreen(ie,oe,ce,fe),occluded:me}}placeCollisionCircles(e,i,u,d,_,x,T,E,M,D,B,O,Z,K){const ne=[],ie=new a.P(i.anchorX,i.anchorY),oe=this.getPerspectiveRatio(ie.x,ie.y,x,K),ce=(M?_*this.transform.getPitchedTextCorrection(i.anchorX,i.anchorY,x)/oe:_*oe)/a.av,fe={getElevation:K,pitchedLabelPlaneMatrix:T,lineVertexArray:u,pitchWithMap:M,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:ie,unwrappedTileID:x,width:this.transform.width,height:this.transform.height,translation:Z},me=gt(ce,d,i.lineOffsetX*ce,i.lineOffsetY*ce,!1,i,!1,fe);let ge=!1,Te=!1,_e=!0;if(me){const Oe=.5*B*oe+O,De=new a.P(-100,-100),Ze=new a.P(this.screenRightBoundary,this.screenBottomBoundary),Ke=new he,Ue=me.first,ft=me.last;let dt=[];for(let Ht=Ue.path.length-1;Ht>=1;Ht--)dt.push(Ue.path[Ht]);for(let Ht=1;Ht<ft.path.length;Ht++)dt.push(ft.path[Ht]);const Je=2.5*Oe;if(M){const Ht=this.projectPathToScreenSpace(dt,fe);dt=Ht.some(mr=>mr.signedDistanceFromCamera<=0)?[]:Ht.map(mr=>mr.point)}let Et=[];if(dt.length>0){const Ht=dt[0].clone(),mr=dt[0].clone();for(let Kt=1;Kt<dt.length;Kt++)Ht.x=Math.min(Ht.x,dt[Kt].x),Ht.y=Math.min(Ht.y,dt[Kt].y),mr.x=Math.max(mr.x,dt[Kt].x),mr.y=Math.max(mr.y,dt[Kt].y);Et=Ht.x>=De.x&&mr.x<=Ze.x&&Ht.y>=De.y&&mr.y<=Ze.y?[dt]:mr.x<De.x||Ht.x>Ze.x||mr.y<De.y||Ht.y>Ze.y?[]:a.ar([dt],De.x,De.y,Ze.x,Ze.y)}for(const Ht of Et){Ke.reset(Ht,.25*Oe);let mr=0;mr=Ke.length<=.5*Oe?1:Math.ceil(Ke.paddedLength/Je)+1;for(let Kt=0;Kt<mr;Kt++){const br=Kt/Math.max(mr-1,1),Ar=Ke.lerp(br),Or=Ar.x+zr,yr=Ar.y+zr;ne.push(Or,yr,Oe,0);const xr=Or-Oe,si=yr-Oe,_i=Or+Oe,Ei=yr+Oe;if(_e=_e&&this.isOffscreen(xr,si,_i,Ei),Te=Te||this.isInsideGrid(xr,si,_i,Ei),e!=="always"&&this.grid.hitTestCircle(Or,yr,Oe,e,D)&&(ge=!0,!E))return{circles:[],offscreen:!1,collisionDetected:ge}}}}return{circles:!E&&ge||!Te||oe<this.perspectiveRatioCutoff?[]:ne,offscreen:_e,collisionDetected:ge}}projectPathToScreenSpace(e,i){const u=function(d,_){const x=a.K();return a.aj(x,_.pitchedLabelPlaneMatrix),d.map(T=>{const E=Ne(T.x,T.y,x,_.getElevation),M=_.transform.projectTileCoordinates(E.point.x,E.point.y,_.unwrappedTileID,_.getElevation);return M.point.x=(.5*M.point.x+.5)*_.width,M.point.y=(.5*-M.point.y+.5)*_.height,M})}(e,i);return function(d){let _=0,x=0,T=0,E=0;for(let M=0;M<d.length;M++)d[M].isOccluded?(T=M+1,E=0):(E++,E>x&&(x=E,_=T));return d.slice(_,_+x)}(u)}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const i=[];let u=1/0,d=1/0,_=-1/0,x=-1/0;for(const D of e){const B=new a.P(D.x+zr,D.y+zr);u=Math.min(u,B.x),d=Math.min(d,B.y),_=Math.max(_,B.x),x=Math.max(x,B.y),i.push(B)}const T=this.grid.query(u,d,_,x).concat(this.ignoredGrid.query(u,d,_,x)),E={},M={};for(const D of T){const B=D.key;if(E[B.bucketInstanceId]===void 0&&(E[B.bucketInstanceId]={}),E[B.bucketInstanceId][B.featureIndex])continue;const O=[new a.P(D.x1,D.y1),new a.P(D.x2,D.y1),new a.P(D.x2,D.y2),new a.P(D.x1,D.y2)];a.as(i,O)&&(E[B.bucketInstanceId][B.featureIndex]=!0,M[B.bucketInstanceId]===void 0&&(M[B.bucketInstanceId]=[]),M[B.bucketInstanceId].push(B.featureIndex))}return M}insertCollisionBox(e,i,u,d,_,x){(u?this.ignoredGrid:this.grid).insert({bucketInstanceId:d,featureIndex:_,collisionGroupID:x,overlapMode:i},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,i,u,d,_,x){const T=u?this.ignoredGrid:this.grid,E={bucketInstanceId:d,featureIndex:_,collisionGroupID:x,overlapMode:i};for(let M=0;M<e.length;M+=4)T.insertCircle(E,e[M],e[M+1],e[M+2])}projectAndGetPerspectiveRatio(e,i,u,d,_){if(_){let x;d?(x=[e,i,d(e,i),1],a.ap(x,x,_)):(x=[e,i,0,1],mi(x,x,_));const T=x[3];return{x:(x[0]/T+1)/2*this.transform.width+zr,y:(-x[1]/T+1)/2*this.transform.height+zr,perspectiveRatio:.5+this.transform.cameraToCenterDistance/T*.5,isOccluded:!1,signedDistanceFromCamera:T}}{const x=this.transform.projectTileCoordinates(e,i,u,d);return{x:(x.point.x+1)/2*this.transform.width+zr,y:(1-x.point.y)/2*this.transform.height+zr,perspectiveRatio:.5+this.transform.cameraToCenterDistance/x.signedDistanceFromCamera*.5,isOccluded:x.isOccluded,signedDistanceFromCamera:x.signedDistanceFromCamera}}}getPerspectiveRatio(e,i,u,d){const _=this.transform.projectTileCoordinates(e,i,u,d);return .5+this.transform.cameraToCenterDistance/_.signedDistanceFromCamera*.5}isOffscreen(e,i,u,d){return u<zr||e>=this.screenRightBoundary||d<zr||i>this.screenBottomBoundary}isInsideGrid(e,i,u,d){return u>=0&&e<this.gridRightBoundary&&d>=0&&i<this.gridBottomBoundary}getViewportMatrix(){const e=a.at([]);return a.L(e,e,[-100,-100,0]),e}_projectCollisionBox(e,i,u,d,_,x,T,E,M,D,B){let O=1,Z=0,K=0,ne=1;const ie=e.anchorPointX+T[0],oe=e.anchorPointY+T[1];if(x&&!_){const dt=this.projectAndGetPerspectiveRatio(ie+1,oe,d,M,B),Je=dt.x-E.x,Et=Math.atan((dt.y-E.y)/Je)+(Je<0?Math.PI:0),Ht=Math.sin(Et),mr=Math.cos(Et);O=mr,Z=Ht,K=-Ht,ne=mr}else if(!x&&_){const dt=Ge(this.transform);O=dt.vecEast[0],Z=dt.vecEast[1],K=dt.vecSouth[0],ne=dt.vecSouth[1]}let ce=E.x,fe=E.y,me=i;_&&(ce=ie,fe=oe,me=Math.pow(2,-(this.transform.zoom-u.overscaledZ)),me*=this.transform.getPitchedTextCorrection(ie,oe,d),D||(me*=a.ae(.5+E.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),D&&(ce+=O*D.x*me+K*D.y*me,fe+=Z*D.x*me+ne*D.y*me);const ge=e.x1*me,Te=e.x2*me,_e=(ge+Te)/2,Oe=e.y1*me,De=e.y2*me,Ze=(Oe+De)/2,Ke=[{offsetX:ge,offsetY:Oe},{offsetX:_e,offsetY:Oe},{offsetX:Te,offsetY:Oe},{offsetX:Te,offsetY:Ze},{offsetX:Te,offsetY:De},{offsetX:_e,offsetY:De},{offsetX:ge,offsetY:De},{offsetX:ge,offsetY:Ze}];let Ue=[];for(const{offsetX:dt,offsetY:Je}of Ke)Ue.push(new a.P(ce+O*dt+K*Je,fe+Z*dt+ne*Je));let ft=!1;if(_){const dt=Ue.map(Je=>this.projectAndGetPerspectiveRatio(Je.x,Je.y,d,M,B));ft=dt.some(Je=>!Je.isOccluded),Ue=dt.map(Je=>new a.P(Je.x,Je.y))}else ft=!0;return{box:a.au(Ue),allPointsOccluded:!ft}}}class Ds{constructor(e,i,u,d){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?i:-i))):d&&u?1:0,this.placed=u}isHidden(){return this.opacity===0&&!this.placed}}class Ao{constructor(e,i,u,d,_){this.text=new Ds(e?e.text:null,i,u,_),this.icon=new Ds(e?e.icon:null,i,d,_)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class on{constructor(e,i,u){this.text=e,this.icon=i,this.skipFade=u}}class Gr{constructor(e,i,u,d,_){this.bucketInstanceId=e,this.featureIndex=i,this.sourceLayerIndex=u,this.bucketIndex=d,this.tileID=_}}class Op{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const i=++this.maxGroupID;this.collisionGroups[e]={ID:i,predicate:u=>u.collisionGroupID===i}}return this.collisionGroups[e]}}function Os(g,e,i,u,d){const{horizontalAlign:_,verticalAlign:x}=a.aB(g);return new a.P(-(_-.5)*e+u[0]*d,-(x-.5)*i+u[1]*d)}class nu{constructor(e,i,u,d,_){this.transform=e.clone(),this.terrain=i,this.collisionIndex=new Dl(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=u,this.retainedQueryData={},this.collisionGroups=new Op(d),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=_,_&&(_.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const i=this.terrain;return i?(u,d)=>i.getElevation(e,u,d):null}getBucketParts(e,i,u,d){const _=u.getBucket(i),x=u.latestFeatureIndex;if(!_||!x||i.id!==_.layerIds[0])return;const T=u.collisionBoxArray,E=_.layers[0].layout,M=_.layers[0].paint,D=Math.pow(2,this.transform.zoom-u.tileID.overscaledZ),B=u.tileSize/a.Z,O=u.tileID.toUnwrapped(),Z=E.get("text-rotation-alignment")==="map",K=a.aw(u,1,this.transform.zoom),ne=a.ax(this.collisionIndex.transform,u,M.get("text-translate"),M.get("text-translate-anchor")),ie=a.ax(this.collisionIndex.transform,u,M.get("icon-translate"),M.get("icon-translate-anchor")),oe=ze(Z,this.transform,K);this.retainedQueryData[_.bucketInstanceId]=new Gr(_.bucketInstanceId,x,_.sourceLayerIndex,_.index,u.tileID);const ce={bucket:_,layout:E,translationText:ne,translationIcon:ie,unwrappedTileID:O,pitchedLabelPlaneMatrix:oe,scale:D,textPixelRatio:B,holdingForFade:u.holdingForFade(),collisionBoxArray:T,partiallyEvaluatedTextSize:a.ag(_.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(_.sourceID)};if(d)for(const fe of _.sortKeyRanges){const{sortKey:me,symbolInstanceStart:ge,symbolInstanceEnd:Te}=fe;e.push({sortKey:me,symbolInstanceStart:ge,symbolInstanceEnd:Te,parameters:ce})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:_.symbolInstances.length,parameters:ce})}attemptAnchorPlacement(e,i,u,d,_,x,T,E,M,D,B,O,Z,K,ne,ie,oe,ce,fe,me){const ge=a.ay[e.textAnchor],Te=[e.textOffset0,e.textOffset1],_e=Os(ge,u,d,Te,_),Oe=this.collisionIndex.placeCollisionBox(i,O,E,M,D,T,x,ie,B.predicate,fe,_e,me);if((!ce||this.collisionIndex.placeCollisionBox(ce,O,E,M,D,T,x,oe,B.predicate,fe,_e,me).placeable)&&Oe.placeable){let De;if(this.prevPlacement&&this.prevPlacement.variableOffsets[Z.crossTileID]&&this.prevPlacement.placements[Z.crossTileID]&&this.prevPlacement.placements[Z.crossTileID].text&&(De=this.prevPlacement.variableOffsets[Z.crossTileID].anchor),Z.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[Z.crossTileID]={textOffset:Te,width:u,height:d,anchor:ge,textBoxScale:_,prevAnchor:De},this.markUsedJustification(K,ge,Z,ne),K.allowVerticalPlacement&&(this.markUsedOrientation(K,ne,Z),this.placedOrientations[Z.crossTileID]=ne),{shift:_e,placedGlyphBoxes:Oe}}}placeLayerBucketPart(e,i,u){const{bucket:d,layout:_,translationText:x,translationIcon:T,unwrappedTileID:E,pitchedLabelPlaneMatrix:M,textPixelRatio:D,holdingForFade:B,collisionBoxArray:O,partiallyEvaluatedTextSize:Z,collisionGroup:K}=e.parameters,ne=_.get("text-optional"),ie=_.get("icon-optional"),oe=a.az(_,"text-overlap","text-allow-overlap"),ce=oe==="always",fe=a.az(_,"icon-overlap","icon-allow-overlap"),me=fe==="always",ge=_.get("text-rotation-alignment")==="map",Te=_.get("text-pitch-alignment")==="map",_e=_.get("icon-text-fit")!=="none",Oe=_.get("symbol-z-order")==="viewport-y",De=ce&&(me||!d.hasIconData()||ie),Ze=me&&(ce||!d.hasTextData()||ne);!d.collisionArrays&&O&&d.deserializeCollisionBoxes(O);const Ke=this.retainedQueryData[d.bucketInstanceId].tileID,Ue=this._getTerrainElevationFunc(Ke),ft=this.transform.getFastPathSimpleProjectionMatrix(Ke),dt=(Je,Et,Ht)=>{var mr,Kt;if(i[Je.crossTileID])return;if(B)return void(this.placements[Je.crossTileID]=new on(!1,!1,!1));let br=!1,Ar=!1,Or=!0,yr=null,xr={box:null,placeable:!1,offscreen:null,occluded:!1},si={placeable:!1},_i=null,Ei=null,un=null,go=0,Qn=0,Oo=0;Et.textFeatureIndex?go=Et.textFeatureIndex:Je.useRuntimeCollisionCircles&&(go=Je.featureIndex),Et.verticalTextFeatureIndex&&(Qn=Et.verticalTextFeatureIndex);const Fo=Et.textBox;if(Fo){const gn=Jr=>{let Qr=a.ah.horizontal;if(d.allowVerticalPlacement&&!Jr&&this.prevPlacement){const di=this.prevPlacement.placedOrientations[Je.crossTileID];di&&(this.placedOrientations[Je.crossTileID]=di,Qr=di,this.markUsedOrientation(d,Qr,Je))}return Qr},yo=(Jr,Qr)=>{if(d.allowVerticalPlacement&&Je.numVerticalGlyphVertices>0&&Et.verticalTextBox){for(const di of d.writingModes)if(di===a.ah.vertical?(xr=Qr(),si=xr):xr=Jr(),xr&&xr.placeable)break}else xr=Jr()},ys=Je.textAnchorOffsetStartIndex,vs=Je.textAnchorOffsetEndIndex;if(vs===ys){const Jr=(Qr,di)=>{const Er=this.collisionIndex.placeCollisionBox(Qr,oe,D,Ke,E,Te,ge,x,K.predicate,Ue,void 0,ft);return Er&&Er.placeable&&(this.markUsedOrientation(d,di,Je),this.placedOrientations[Je.crossTileID]=di),Er};yo(()=>Jr(Fo,a.ah.horizontal),()=>{const Qr=Et.verticalTextBox;return d.allowVerticalPlacement&&Je.numVerticalGlyphVertices>0&&Qr?Jr(Qr,a.ah.vertical):{box:null,offscreen:null}}),gn(xr&&xr.placeable)}else{let Jr=a.ay[(Kt=(mr=this.prevPlacement)===null||mr===void 0?void 0:mr.variableOffsets[Je.crossTileID])===null||Kt===void 0?void 0:Kt.anchor];const Qr=(Er,Bo,sf)=>{const bs=Er.x2-Er.x1,sm=Er.y2-Er.y1,af=Je.textBoxScale,Wu=_e&&fe==="never"?Bo:null;let jo=null,No=oe==="never"?1:2,Vo="never";Jr&&No++;for(let Ku=0;Ku<No;Ku++){for(let Xu=ys;Xu<vs;Xu++){const mc=d.textAnchorOffsets.get(Xu);if(Jr&&mc.textAnchor!==Jr)continue;const gc=this.attemptAnchorPlacement(mc,Er,bs,sm,af,ge,Te,D,Ke,E,K,Vo,Je,d,sf,x,T,Wu,Ue);if(gc&&(jo=gc.placedGlyphBoxes,jo&&jo.placeable))return br=!0,yr=gc.shift,jo}Jr?Jr=null:Vo=oe}return u&&!jo&&(jo={box:this.collisionIndex.placeCollisionBox(Fo,"always",D,Ke,E,Te,ge,x,K.predicate,Ue,void 0,ft).box,offscreen:!1,placeable:!1,occluded:!1}),jo};yo(()=>Qr(Fo,Et.iconBox,a.ah.horizontal),()=>{const Er=Et.verticalTextBox;return d.allowVerticalPlacement&&(!xr||!xr.placeable)&&Je.numVerticalGlyphVertices>0&&Er?Qr(Er,Et.verticalIconBox,a.ah.vertical):{box:null,occluded:!0,offscreen:null}}),xr&&(br=xr.placeable,Or=xr.offscreen);const di=gn(xr&&xr.placeable);if(!br&&this.prevPlacement){const Er=this.prevPlacement.variableOffsets[Je.crossTileID];Er&&(this.variableOffsets[Je.crossTileID]=Er,this.markUsedJustification(d,Er.anchor,Je,di))}}}if(_i=xr,br=_i&&_i.placeable,Or=_i&&_i.offscreen,Je.useRuntimeCollisionCircles){const gn=d.text.placedSymbolArray.get(Je.centerJustifiedTextSymbolIndex),yo=a.ai(d.textSizeData,Z,gn),ys=_.get("text-padding");Ei=this.collisionIndex.placeCollisionCircles(oe,gn,d.lineVertexArray,d.glyphOffsetArray,yo,E,M,u,Te,K.predicate,Je.collisionCircleDiameter,ys,x,Ue),Ei.circles.length&&Ei.collisionDetected&&!u&&a.w("Collisions detected, but collision boxes are not shown"),br=ce||Ei.circles.length>0&&!Ei.collisionDetected,Or=Or&&Ei.offscreen}if(Et.iconFeatureIndex&&(Oo=Et.iconFeatureIndex),Et.iconBox){const gn=yo=>this.collisionIndex.placeCollisionBox(yo,fe,D,Ke,E,Te,ge,T,K.predicate,Ue,_e&&yr?yr:void 0,ft);si&&si.placeable&&Et.verticalIconBox?(un=gn(Et.verticalIconBox),Ar=un.placeable):(un=gn(Et.iconBox),Ar=un.placeable),Or=Or&&un.offscreen}const _s=ne||Je.numHorizontalGlyphVertices===0&&Je.numVerticalGlyphVertices===0,eo=ie||Je.numIconVertices===0;_s||eo?eo?_s||(Ar=Ar&&br):br=Ar&&br:Ar=br=Ar&&br;const _o=Ar&&un.placeable;if(br&&_i.placeable&&this.collisionIndex.insertCollisionBox(_i.box,oe,_.get("text-ignore-placement"),d.bucketInstanceId,si&&si.placeable&&Qn?Qn:go,K.ID),_o&&this.collisionIndex.insertCollisionBox(un.box,fe,_.get("icon-ignore-placement"),d.bucketInstanceId,Oo,K.ID),Ei&&br&&this.collisionIndex.insertCollisionCircles(Ei.circles,oe,_.get("text-ignore-placement"),d.bucketInstanceId,go,K.ID),u&&this.storeCollisionData(d.bucketInstanceId,Ht,Et,_i,un,Ei),Je.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(d.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Je.crossTileID]=new on((br||De)&&!(_i!=null&&_i.occluded),(Ar||Ze)&&!(un!=null&&un.occluded),Or||d.justReloaded),i[Je.crossTileID]=!0};if(Oe){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Je=d.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let Et=Je.length-1;Et>=0;--Et){const Ht=Je[Et];dt(d.symbolInstances.get(Ht),d.collisionArrays[Ht],Ht)}}else for(let Je=e.symbolInstanceStart;Je<e.symbolInstanceEnd;Je++)dt(d.symbolInstances.get(Je),d.collisionArrays[Je],Je);d.justReloaded=!1}storeCollisionData(e,i,u,d,_,x){if(u.textBox||u.iconBox){let T,E;this.collisionBoxArrays.has(e)?T=this.collisionBoxArrays.get(e):(T=new Map,this.collisionBoxArrays.set(e,T)),T.has(i)?E=T.get(i):(E={text:null,icon:null},T.set(i,E)),u.textBox&&(E.text=d.box),u.iconBox&&(E.icon=_.box)}if(x){let T=this.collisionCircleArrays[e];T===void 0&&(T=this.collisionCircleArrays[e]=[]);for(let E=0;E<x.circles.length;E+=4)T.push(x.circles[E+0]-zr),T.push(x.circles[E+1]-zr),T.push(x.circles[E+2]),T.push(x.collisionDetected?1:0)}}markUsedJustification(e,i,u,d){let _;_=d===a.ah.vertical?u.verticalPlacedTextSymbolIndex:{left:u.leftJustifiedTextSymbolIndex,center:u.centerJustifiedTextSymbolIndex,right:u.rightJustifiedTextSymbolIndex}[a.aA(i)];const x=[u.leftJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.rightJustifiedTextSymbolIndex,u.verticalPlacedTextSymbolIndex];for(const T of x)T>=0&&(e.text.placedSymbolArray.get(T).crossTileID=_>=0&&T!==_?0:u.crossTileID)}markUsedOrientation(e,i,u){const d=i===a.ah.horizontal||i===a.ah.horizontalOnly?i:0,_=i===a.ah.vertical?i:0,x=[u.leftJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.rightJustifiedTextSymbolIndex];for(const T of x)e.text.placedSymbolArray.get(T).placedOrientation=d;u.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(u.verticalPlacedTextSymbolIndex).placedOrientation=_)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const i=this.prevPlacement;let u=!1;this.prevZoomAdjustment=i?i.zoomAdjustment(this.transform.zoom):0;const d=i?i.symbolFadeChange(e):1,_=i?i.opacities:{},x=i?i.variableOffsets:{},T=i?i.placedOrientations:{};for(const E in this.placements){const M=this.placements[E],D=_[E];D?(this.opacities[E]=new Ao(D,d,M.text,M.icon),u=u||M.text!==D.text.placed||M.icon!==D.icon.placed):(this.opacities[E]=new Ao(null,d,M.text,M.icon,M.skipFade),u=u||M.text||M.icon)}for(const E in _){const M=_[E];if(!this.opacities[E]){const D=new Ao(M,d,!1,!1);D.isHidden()||(this.opacities[E]=D,u=u||M.text.placed||M.icon.placed)}}for(const E in x)this.variableOffsets[E]||!this.opacities[E]||this.opacities[E].isHidden()||(this.variableOffsets[E]=x[E]);for(const E in T)this.placedOrientations[E]||!this.opacities[E]||this.opacities[E].isHidden()||(this.placedOrientations[E]=T[E]);if(i&&i.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");u?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=i?i.lastPlacementChangeTime:e)}updateLayerOpacities(e,i){const u={};for(const d of i){const _=d.getBucket(e);_&&d.latestFeatureIndex&&e.id===_.layerIds[0]&&this.updateBucketOpacities(_,d.tileID,u,d.collisionBoxArray)}}updateBucketOpacities(e,i,u,d){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const _=e.layers[0],x=_.layout,T=new Ao(null,0,!1,!1,!0),E=x.get("text-allow-overlap"),M=x.get("icon-allow-overlap"),D=_._unevaluatedLayout.hasValue("text-variable-anchor")||_._unevaluatedLayout.hasValue("text-variable-anchor-offset"),B=x.get("text-rotation-alignment")==="map",O=x.get("text-pitch-alignment")==="map",Z=x.get("icon-text-fit")!=="none",K=new Ao(null,0,E&&(M||!e.hasIconData()||x.get("icon-optional")),M&&(E||!e.hasTextData()||x.get("text-optional")),!0);!e.collisionArrays&&d&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(d);const ne=(oe,ce,fe)=>{for(let me=0;me<ce/4;me++)oe.opacityVertexArray.emplaceBack(fe);oe.hasVisibleVertices=oe.hasVisibleVertices||fe!==La},ie=this.collisionBoxArrays.get(e.bucketInstanceId);for(let oe=0;oe<e.symbolInstances.length;oe++){const ce=e.symbolInstances.get(oe),{numHorizontalGlyphVertices:fe,numVerticalGlyphVertices:me,crossTileID:ge}=ce;let Te=this.opacities[ge];u[ge]?Te=T:Te||(Te=K,this.opacities[ge]=Te),u[ge]=!0;const _e=ce.numIconVertices>0,Oe=this.placedOrientations[ce.crossTileID],De=Oe===a.ah.vertical,Ze=Oe===a.ah.horizontal||Oe===a.ah.horizontalOnly;if(fe>0||me>0){const Ue=dd(Te.text);ne(e.text,fe,De?La:Ue),ne(e.text,me,Ze?La:Ue);const ft=Te.text.isHidden();[ce.rightJustifiedTextSymbolIndex,ce.centerJustifiedTextSymbolIndex,ce.leftJustifiedTextSymbolIndex].forEach(Et=>{Et>=0&&(e.text.placedSymbolArray.get(Et).hidden=ft||De?1:0)}),ce.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(ce.verticalPlacedTextSymbolIndex).hidden=ft||Ze?1:0);const dt=this.variableOffsets[ce.crossTileID];dt&&this.markUsedJustification(e,dt.anchor,ce,Oe);const Je=this.placedOrientations[ce.crossTileID];Je&&(this.markUsedJustification(e,"left",ce,Je),this.markUsedOrientation(e,Je,ce))}if(_e){const Ue=dd(Te.icon),ft=!(Z&&ce.verticalPlacedIconSymbolIndex&&De);ce.placedIconSymbolIndex>=0&&(ne(e.icon,ce.numIconVertices,ft?Ue:La),e.icon.placedSymbolArray.get(ce.placedIconSymbolIndex).hidden=Te.icon.isHidden()),ce.verticalPlacedIconSymbolIndex>=0&&(ne(e.icon,ce.numVerticalIconVertices,ft?La:Ue),e.icon.placedSymbolArray.get(ce.verticalPlacedIconSymbolIndex).hidden=Te.icon.isHidden())}const Ke=ie&&ie.has(oe)?ie.get(oe):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const Ue=e.collisionArrays[oe];if(Ue){let ft=new a.P(0,0);if(Ue.textBox||Ue.verticalTextBox){let dt=!0;if(D){const Je=this.variableOffsets[ge];Je?(ft=Os(Je.anchor,Je.width,Je.height,Je.textOffset,Je.textBoxScale),B&&ft._rotate(O?-this.transform.bearingInRadians:this.transform.bearingInRadians)):dt=!1}if(Ue.textBox||Ue.verticalTextBox){let Je;Ue.textBox&&(Je=De),Ue.verticalTextBox&&(Je=Ze),ko(e.textCollisionBox.collisionVertexArray,Te.text.placed,!dt||Je,Ke.text,ft.x,ft.y)}}if(Ue.iconBox||Ue.verticalIconBox){const dt=!!(!Ze&&Ue.verticalIconBox);let Je;Ue.iconBox&&(Je=dt),Ue.verticalIconBox&&(Je=!dt),ko(e.iconCollisionBox.collisionVertexArray,Te.icon.placed,Je,Ke.icon,Z?ft.x:0,Z?ft.y:0)}}}}if(e.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);e.bucketInstanceId in this.collisionCircleArrays&&(e.collisionCircleArray=this.collisionCircleArrays[e.bucketInstanceId],delete this.collisionCircleArrays[e.bucketInstanceId])}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,i){const u=this.zoomAtLastRecencyCheck===i?1-this.zoomAdjustment(i):1;return this.zoomAtLastRecencyCheck=i,this.commitTime+this.fadeDuration*u>e}setStale(){this.stale=!0}}function ko(g,e,i,u,d,_){u&&u.length!==0||(u=[0,0,0,0]);const x=u[0]-zr,T=u[1]-zr,E=u[2]-zr,M=u[3]-zr;g.emplaceBack(e?1:0,i?1:0,d||0,_||0,x,T),g.emplaceBack(e?1:0,i?1:0,d||0,_||0,E,T),g.emplaceBack(e?1:0,i?1:0,d||0,_||0,E,M),g.emplaceBack(e?1:0,i?1:0,d||0,_||0,x,M)}const Fs=Math.pow(2,25),ld=Math.pow(2,24),cd=Math.pow(2,17),ud=Math.pow(2,16),Bs=Math.pow(2,9),hd=Math.pow(2,8),Fp=Math.pow(2,1);function dd(g){if(g.opacity===0&&!g.placed)return 0;if(g.opacity===1&&g.placed)return 4294967295;const e=g.placed?1:0,i=Math.floor(127*g.opacity);return i*Fs+e*ld+i*cd+e*ud+i*Bs+e*hd+i*Fp+e}const La=0;class fd{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,i,u,d,_){const x=this._bucketParts;for(;this._currentTileIndex<e.length;)if(i.getBucketParts(x,d,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,_())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,x.sort((T,E)=>T.sortKey-E.sortKey));this._currentPartIndex<x.length;)if(i.placeLayerBucketPart(x[this._currentPartIndex],this._seenCrossTileIDs,u),this._currentPartIndex++,_())return!0;return!1}}class pd{constructor(e,i,u,d,_,x,T,E){this.placement=new nu(e,i,x,T,E),this._currentPlacementIndex=u.length-1,this._forceFullPlacement=d,this._showCollisionBoxes=_,this._done=!1}isDone(){return this._done}continuePlacement(e,i,u){const d=N.now(),_=()=>!this._forceFullPlacement&&N.now()-d>2;for(;this._currentPlacementIndex>=0;){const x=i[e[this._currentPlacementIndex]],T=this.placement.collisionIndex.transform.zoom;if(x.type==="symbol"&&(!x.minzoom||x.minzoom<=T)&&(!x.maxzoom||x.maxzoom>T)){if(this._inProgressLayer||(this._inProgressLayer=new fd(x)),this._inProgressLayer.continuePlacement(u[x.source],this.placement,this._showCollisionBoxes,x,_))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const rs=512/a.Z/2;class ou{constructor(e,i,u){this.tileID=e,this.bucketInstanceId=u,this._symbolsByKey={};const d=new Map;for(let _=0;_<i.length;_++){const x=i.get(_),T=x.key,E=d.get(T);E?E.push(x):d.set(T,[x])}for(const[_,x]of d){const T={positions:x.map(E=>({x:Math.floor(E.anchorX*rs),y:Math.floor(E.anchorY*rs)})),crossTileIDs:x.map(E=>E.crossTileID)};if(T.positions.length>128){const E=new a.aC(T.positions.length,16,Uint16Array);for(const{x:M,y:D}of T.positions)E.add(M,D);E.finish(),delete T.positions,T.index=E}this._symbolsByKey[_]=T}}getScaledCoordinates(e,i){const{x:u,y:d,z:_}=this.tileID.canonical,{x,y:T,z:E}=i.canonical,M=rs/Math.pow(2,E-_),D=(T*a.Z+e.anchorY)*M,B=d*a.Z*rs;return{x:Math.floor((x*a.Z+e.anchorX)*M-u*a.Z*rs),y:Math.floor(D-B)}}findMatches(e,i,u){const d=this.tileID.canonical.z<i.canonical.z?1:Math.pow(2,this.tileID.canonical.z-i.canonical.z);for(let _=0;_<e.length;_++){const x=e.get(_);if(x.crossTileID)continue;const T=this._symbolsByKey[x.key];if(!T)continue;const E=this.getScaledCoordinates(x,i);if(T.index){const M=T.index.range(E.x-d,E.y-d,E.x+d,E.y+d).sort();for(const D of M){const B=T.crossTileIDs[D];if(!u[B]){u[B]=!0,x.crossTileID=B;break}}}else if(T.positions)for(let M=0;M<T.positions.length;M++){const D=T.positions[M],B=T.crossTileIDs[M];if(Math.abs(D.x-E.x)<=d&&Math.abs(D.y-E.y)<=d&&!u[B]){u[B]=!0,x.crossTileID=B;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:e})=>e)}}class md{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class su{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const i=Math.round((e-this.lng)/360);if(i!==0)for(const u in this.indexes){const d=this.indexes[u],_={};for(const x in d){const T=d[x];T.tileID=T.tileID.unwrapTo(T.tileID.wrap+i),_[T.tileID.key]=T}this.indexes[u]=_}this.lng=e}addBucket(e,i,u){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===i.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let _=0;_<i.symbolInstances.length;_++)i.symbolInstances.get(_).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const d=this.usedCrossTileIDs[e.overscaledZ];for(const _ in this.indexes){const x=this.indexes[_];if(Number(_)>e.overscaledZ)for(const T in x){const E=x[T];E.tileID.isChildOf(e)&&E.findMatches(i.symbolInstances,e,d)}else{const T=x[e.scaledTo(Number(_)).key];T&&T.findMatches(i.symbolInstances,e,d)}}for(let _=0;_<i.symbolInstances.length;_++){const x=i.symbolInstances.get(_);x.crossTileID||(x.crossTileID=u.generate(),d[x.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new ou(e,i.symbolInstances,i.bucketInstanceId),!0}removeBucketCrossTileIDs(e,i){for(const u of i.getCrossTileIDsLists())for(const d of u)delete this.usedCrossTileIDs[e][d]}removeStaleBuckets(e){let i=!1;for(const u in this.indexes){const d=this.indexes[u];for(const _ in d)e[d[_].bucketInstanceId]||(this.removeBucketCrossTileIDs(u,d[_]),delete d[_],i=!0)}return i}}class Ol{constructor(){this.layerIndexes={},this.crossTileIDs=new md,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,i,u){let d=this.layerIndexes[e.id];d===void 0&&(d=this.layerIndexes[e.id]=new su);let _=!1;const x={};d.handleWrapJump(u);for(const T of i){const E=T.getBucket(e);E&&e.id===E.layerIds[0]&&(E.bucketInstanceId||(E.bucketInstanceId=++this.maxBucketInstanceId),d.addBucket(T.tileID,E,this.crossTileIDs)&&(_=!0),x[E.bucketInstanceId]=!0)}return d.removeStaleBuckets(x)&&(_=!0),_}pruneUnusedLayers(e){const i={};e.forEach(u=>{i[u]=!0});for(const u in this.layerIndexes)i[u]||delete this.layerIndexes[u]}}var za="void main() {fragColor=vec4(1.0);}";const An={prelude:tr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:tr("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:tr("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:tr(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:tr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:tr(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:tr(za,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:tr(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:tr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:tr("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:tr("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:tr("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:tr(za,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:tr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:tr(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:tr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:tr(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:tr(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:tr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:tr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));fragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:tr(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:tr(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:tr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:tr(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:tr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:tr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:tr(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:tr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:tr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:tr("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:tr("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:tr("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:tr("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:tr(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:tr("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function tr(g,e){const i=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,u=e.match(/in ([\w]+) ([\w]+)/g),d=g.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),_=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),x=_?_.concat(d):d,T={};return{fragmentSource:g=g.replace(i,(E,M,D,B,O)=>(T[O]=!0,M==="define"?`
#ifndef HAS_UNIFORM_u_${O}
in ${D} ${B} ${O};
#else
uniform ${D} ${B} u_${O};
#endif
`:`
#ifdef HAS_UNIFORM_u_${O}
    ${D} ${B} ${O} = u_${O};
#endif
`)),vertexSource:e=e.replace(i,(E,M,D,B,O)=>{const Z=B==="float"?"vec2":"vec4",K=O.match(/color/)?"color":Z;return T[O]?M==="define"?`
#ifndef HAS_UNIFORM_u_${O}
uniform lowp float u_${O}_t;
in ${D} ${Z} a_${O};
out ${D} ${B} ${O};
#else
uniform ${D} ${B} u_${O};
#endif
`:K==="vec4"?`
#ifndef HAS_UNIFORM_u_${O}
    ${O} = a_${O};
#else
    ${D} ${B} ${O} = u_${O};
#endif
`:`
#ifndef HAS_UNIFORM_u_${O}
    ${O} = unpack_mix_${K}(a_${O}, u_${O}_t);
#else
    ${D} ${B} ${O} = u_${O};
#endif
`:M==="define"?`
#ifndef HAS_UNIFORM_u_${O}
uniform lowp float u_${O}_t;
in ${D} ${Z} a_${O};
#else
uniform ${D} ${B} u_${O};
#endif
`:K==="vec4"?`
#ifndef HAS_UNIFORM_u_${O}
    ${D} ${B} ${O} = a_${O};
#else
    ${D} ${B} ${O} = u_${O};
#endif
`:`
#ifndef HAS_UNIFORM_u_${O}
    ${D} ${B} ${O} = unpack_mix_${K}(a_${O}, u_${O}_t);
#else
    ${D} ${B} ${O} = u_${O};
#endif
`}),staticAttributes:u,staticUniforms:x}}class is{constructor(e,i,u){this.vertexBuffer=e,this.indexBuffer=i,this.segments=u}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var Lo=a.aD([{name:"a_pos",type:"Int16",components:2}]);const ho="#define PROJECTION_MERCATOR",js="mercator";class lr{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return js}get shaderDefine(){return ho}get shaderPreludeCode(){return An.projectionMercator}get vertexShaderPreludeCode(){return An.projectionMercator.vertexSource}get subdivisionGranularity(){return a.aE.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(e){}getMeshFromTileID(e,i,u,d,_){if(this._cachedMesh)return this._cachedMesh;const x=new a.aF;x.emplaceBack(0,0),x.emplaceBack(a.Z,0),x.emplaceBack(0,a.Z),x.emplaceBack(a.Z,a.Z);const T=e.createVertexBuffer(x,Lo.members),E=a.aG.simpleSegment(0,0,4,2),M=new a.aH;M.emplaceBack(1,0,2),M.emplaceBack(1,2,3);const D=e.createIndexBuffer(M);return this._cachedMesh=new is(T,D,E),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(e){}}function En(g,e){const i=a.ae(e.lat,-85.051129,a.aJ);return new a.P(a.U(e.lng)*g,a.S(i)*g)}function Ra(g,e){return new a.$(e.x/g,e.y/g).toLngLat()}function Ns(g){return g.cameraToCenterDistance*Math.min(.85*Math.tan(a.ad(90-g.pitch)),Math.tan(a.ad(89.25-g.pitch)))}function Xi(g,e){const i=g.canonical,u=e/a.aI(i.z),d=i.x+Math.pow(2,i.z)*g.wrap,_=a.at(new Float64Array(16));return a.L(_,_,[d*u,i.y*u,0]),a.M(_,_,[u/a.Z,u/a.Z,1]),_}function Ri(g,e,i,u,d){const _=a.$.fromLngLat(g,e),x=d*a.aK(1,g.lat),T=x*Math.cos(a.ad(i)),E=Math.sqrt(x*x-T*T),M=E*Math.sin(a.ad(-u)),D=E*Math.cos(a.ad(-u));return new a.$(_.x+M,_.y+D,_.z+T)}class jr{constructor(e=0,i=0,u=0,d=0){if(isNaN(e)||e<0||isNaN(i)||i<0||isNaN(u)||u<0||isNaN(d)||d<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=i,this.left=u,this.right=d}interpolate(e,i,u){return i.top!=null&&e.top!=null&&(this.top=a.B.number(e.top,i.top,u)),i.bottom!=null&&e.bottom!=null&&(this.bottom=a.B.number(e.bottom,i.bottom,u)),i.left!=null&&e.left!=null&&(this.left=a.B.number(e.left,i.left,u)),i.right!=null&&e.right!=null&&(this.right=a.B.number(e.right,i.right,u)),this}getCenter(e,i){const u=a.ae((this.left+e-this.right)/2,0,e),d=a.ae((this.top+i-this.bottom)/2,0,i);return new a.P(u,d)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new jr(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Fl(g,e){if(!g.renderWorldCopies||g.lngRange)return;const i=e.lng-g.center.lng;e.lng+=i>180?-360:i<-180?360:0}function Yi(g){return Math.max(0,Math.floor(g))}class sn{constructor(e,i,u,d,_,x){this._callbacks=e,this._tileSize=512,this._renderWorldCopies=x===void 0||!!x,this._minZoom=i||0,this._maxZoom=u||22,this._minPitch=d??0,this._maxPitch=_??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new a.Q(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Yi(this._zoom),this._scale=a.aI(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new jr,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(e,i,u){this._latRange=e.latRange,this._lngRange=e.lngRange,this._width=e.width,this._height=e.height,this._center=e.center,this._elevation=e.elevation,this._minElevationForCurrentTile=e.minElevationForCurrentTile,this._zoom=e.zoom,this._tileZoom=Yi(this._zoom),this._scale=a.aI(this._zoom),this._bearingInRadians=e.bearingInRadians,this._fovInRadians=e.fovInRadians,this._pitchInRadians=e.pitchInRadians,this._rollInRadians=e.rollInRadians,this._unmodified=e.unmodified,this._edgeInsets=new jr(e.padding.top,e.padding.bottom,e.padding.left,e.padding.right),this._minZoom=e.minZoom,this._maxZoom=e.maxZoom,this._minPitch=e.minPitch,this._maxPitch=e.maxPitch,this._renderWorldCopies=e.renderWorldCopies,this._cameraToCenterDistance=e.cameraToCenterDistance,this._nearZ=e.nearZ,this._farZ=e.farZ,this._autoCalculateNearFarZ=!u&&e.autoCalculateNearFarZ,i&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(e){this._minElevationForCurrentTile=e}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(e){this._minZoom!==e&&(this._minZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(e){this._minPitch!==e&&(this._minPitch=e,this.setPitch(Math.max(this.pitch,e)))}get maxPitch(){return this._maxPitch}setMaxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.setPitch(Math.min(this.pitch,e)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(e){const i=a.aL(e,-180,180)*Math.PI/180;var u,d,_,x,T,E,M,D,B;this._bearingInRadians!==i&&(this._unmodified=!1,this._bearingInRadians=i,this._calcMatrices(),this._rotationMatrix=z(),u=this._rotationMatrix,_=-this._bearingInRadians,x=(d=this._rotationMatrix)[0],T=d[1],E=d[2],M=d[3],D=Math.sin(_),B=Math.cos(_),u[0]=x*B+E*D,u[1]=T*B+M*D,u[2]=x*-D+E*B,u[3]=T*-D+M*B)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(e){const i=a.ae(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==i&&(this._unmodified=!1,this._pitchInRadians=i,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(e){const i=e/180*Math.PI;this._rollInRadians!==i&&(this._unmodified=!1,this._rollInRadians=i,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return a.aM(this._fovInRadians)}setFov(e){e=a.ae(e,.1,150),this.fov!==e&&(this._unmodified=!1,this._fovInRadians=a.ad(e),this._calcMatrices())}get zoom(){return this._zoom}setZoom(e){const i=this.getConstrained(this._center,e).zoom;this._zoom!==i&&(this._unmodified=!1,this._zoom=i,this._tileZoom=Math.max(0,Math.floor(i)),this._scale=a.aI(i),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(e,i){this._autoCalculateNearFarZ=!1,this._nearZ=e,this._farZ=i,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,i,u){this._unmodified=!1,this._edgeInsets.interpolate(e,i,u),this._constrain(),this._calcMatrices()}resize(e,i,u=!0){this._width=e,this._height=i,u&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new we([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(e){e?(this._lngRange=[e.getWest(),e.getEast()],this._latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-85.051129,a.aJ])}getConstrained(e,i){return this._callbacks.getConstrained(e,i)}getCameraQueryGeometry(e,i){if(i.length===1)return[i[0],e];{let u=e.x,d=e.y,_=e.x,x=e.y;for(const T of i)u=Math.min(u,T.x),d=Math.min(d,T.y),_=Math.max(_,T.x),x=Math.max(x,T.y);return[new a.P(u,d),new a.P(_,d),new a.P(_,x),new a.P(u,x),new a.P(u,d)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:i,zoom:u}=this.getConstrained(this.center,this.zoom);this.setCenter(i),this.setZoom(u),this._unmodified=e,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let e=a.at(new Float64Array(16));a.M(e,e,[this._width/2,-this._height/2,1]),a.L(e,e,[1,-1,0]),this._clipSpaceToPixelsMatrix=e,e=a.at(new Float64Array(16)),a.M(e,e,[1,-1,1]),a.L(e,e,[-1,-1,0]),a.M(e,e,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=e,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(e,i,u,d){const _=u!==void 0?u:this.bearing,x=d=d!==void 0?d:this.pitch,T=a.$.fromLngLat(e,i),E=-Math.cos(a.ad(x)),M=Math.sin(a.ad(x)),D=M*Math.sin(a.ad(_)),B=-M*Math.cos(a.ad(_));let O=this.elevation;const Z=i-O;let K;E*Z>=0||Math.abs(E)<.1?(K=1e4,O=i+K*E):K=-Z/E;let ne,ie,oe=a.aN(1,T.y),ce=0;do{if(ce+=1,ce>10)break;ie=K/oe,ne=new a.$(T.x+D*ie,T.y+B*ie),oe=1/ne.meterInMercatorCoordinateUnits()}while(Math.abs(K-ie*oe)>1e-12);return{center:ne.toLngLat(),elevation:O,zoom:a.ab(this.height/2/Math.tan(this.fovInRadians/2)/ie/this.tileSize)}}recalculateZoomAndCenter(e){if(this.elevation-e==0)return;const i=a.aK(1,this.center.lat)*this.worldSize,u=this.cameraToCenterDistance/i,d=a.$.fromLngLat(this.center,this.elevation),_=Ri(this.center,this.elevation,this.pitch,this.bearing,u);this._elevation=e;const x=this.calculateCenterFromCameraLngLatAlt(_.toLngLat(),a.aN(_.z,d.y),this.bearing,this.pitch);this._elevation=x.elevation,this._center=x.center,this.setZoom(x.zoom)}getCameraPoint(){const e=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.P(e*Math.sin(this.rollInRadians),e*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const e=a.aK(1,this.center.lat)*this.worldSize;return Ri(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/e).toLngLat()}getMercatorTileCoordinates(e){if(!e)return[0,0,1,1];const i=e.canonical.z>=0?1<<e.canonical.z:Math.pow(2,e.canonical.z);return[e.canonical.x/i,e.canonical.y/i,1/i/a.Z,1/i/a.Z]}}class gi{constructor(e,i){this.min=e,this.max=i,this.center=a.aO([],a.aP([],this.min,this.max),.5)}quadrant(e){const i=[e%2==0,e<2],u=a.aQ(this.min),d=a.aQ(this.max);for(let _=0;_<i.length;_++)u[_]=i[_]?this.min[_]:this.center[_],d[_]=i[_]?this.center[_]:this.max[_];return d[2]=this.max[2],new gi(u,d)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersectsFrustum(e){let i=!0;for(let u=0;u<e.planes.length;u++){const d=this.intersectsPlane(e.planes[u]);if(d===0)return 0;d===1&&(i=!1)}return i?2:e.aabb.min[0]>this.max[0]||e.aabb.min[1]>this.max[1]||e.aabb.min[2]>this.max[2]||e.aabb.max[0]<this.min[0]||e.aabb.max[1]<this.min[1]||e.aabb.max[2]<this.min[2]?0:1}intersectsPlane(e){let i=e[3],u=e[3];for(let d=0;d<3;d++)e[d]>0?(i+=e[d]*this.min[d],u+=e[d]*this.max[d]):(u+=e[d]*this.min[d],i+=e[d]*this.max[d]);return i>=0?2:u<0?0:1}}class gd{distanceToTile2d(e,i,u,d){const _=d.distanceX([e,i]),x=d.distanceY([e,i]);return Math.hypot(_,x)}getWrap(e,i,u){return u}getTileAABB(e,i,u,d){var _,x;let T=u,E=u;if(d.terrain){const D=new a.Y(e.z,i,e.z,e.x,e.y),B=d.terrain.getMinMaxElevation(D);T=(_=B.minElevation)!==null&&_!==void 0?_:u,E=(x=B.maxElevation)!==null&&x!==void 0?x:u}const M=1<<e.z;return new gi([i+e.x/M,e.y/M,T],[i+(e.x+1)/M,(e.y+1)/M,E])}allowVariableZoom(e,i){const u=e.fov*(Math.abs(Math.cos(e.rollInRadians))*e.height+Math.abs(Math.sin(e.rollInRadians))*e.width)/e.height,d=a.ae(78.5-u/2,0,60);return!!i.terrain||e.pitch>d}allowWorldCopies(){return!0}recalculateCache(){}}class zo{constructor(e,i,u){this.points=e,this.planes=i,this.aabb=u}static fromInvProjectionMatrix(e,i=1,u=0){const d=Math.pow(2,u),_=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(M=>{const D=1/(M=a.ap([],M,e))[3]/i*d;return a.aR(M,M,[D,D,1/M[3],D])}),x=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(M=>{const D=a.aS([],_[M[0]],_[M[1]]),B=a.aS([],_[M[2]],_[M[1]]),O=a.aT([],a.aU([],D,B)),Z=-a.aV(O,_[M[1]]);return O.concat(Z)}),T=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],E=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const M of _)for(let D=0;D<3;D++)T[D]=Math.min(T[D],M[D]),E[D]=Math.max(E[D],M[D]);return new zo(_,x,new gi(T,E))}}class Nr{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,i,u){return this._helper.interpolatePadding(e,i,u)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,i,u=!0){this._helper.resize(e,i,u)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,i){this._helper.overrideNearFarZ(e,i)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e,i){}constructor(e,i,u,d,_){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new sn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(x,T)=>this.getConstrained(x,T)},e,i,u,d,_),this._coveringTilesDetailsProvider=new gd}clone(){const e=new Nr;return e.apply(this),e}apply(e,i,u){this._helper.apply(e,i,u)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(e){const i=[new a.aW(0,e)];if(this._helper._renderWorldCopies){const u=this.screenPointToMercatorCoordinate(new a.P(0,0)),d=this.screenPointToMercatorCoordinate(new a.P(this._helper._width,0)),_=this.screenPointToMercatorCoordinate(new a.P(this._helper._width,this._helper._height)),x=this.screenPointToMercatorCoordinate(new a.P(0,this._helper._height)),T=Math.floor(Math.min(u.x,d.x,_.x,x.x)),E=Math.floor(Math.max(u.x,d.x,_.x,x.x)),M=1;for(let D=T-M;D<=E+M;D++)D!==0&&i.push(new a.aW(D,e))}return i}getCameraFrustum(){return zo.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){const i=this.screenPointToLocation(this.centerPoint,e),u=e?e.getElevationForLngLatZoom(i,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(u)}setLocationAtPoint(e,i){const u=a.aK(this.elevation,this.center.lat),d=this.screenPointToMercatorCoordinateAtZ(i,u),_=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,u),x=a.$.fromLngLat(e),T=new a.$(x.x-(d.x-_.x),x.y-(d.y-_.y));this.setCenter(T==null?void 0:T.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(e,i){return i?this.coordinatePoint(a.$.fromLngLat(e),i.getElevationForLngLatZoom(e,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(a.$.fromLngLat(e))}screenPointToLocation(e,i){var u;return(u=this.screenPointToMercatorCoordinate(e,i))===null||u===void 0?void 0:u.toLngLat()}screenPointToMercatorCoordinate(e,i){if(i){const u=i.pointCoordinate(e);if(u!=null)return u}return this.screenPointToMercatorCoordinateAtZ(e)}screenPointToMercatorCoordinateAtZ(e,i){const u=i||0,d=[e.x,e.y,0,1],_=[e.x,e.y,1,1];a.ap(d,d,this._pixelMatrixInverse),a.ap(_,_,this._pixelMatrixInverse);const x=d[3],T=_[3],E=d[1]/x,M=_[1]/T,D=d[2]/x,B=_[2]/T,O=D===B?0:(u-D)/(B-D);return new a.$(a.B.number(d[0]/x,_[0]/T,O)/this.worldSize,a.B.number(E,M,O)/this.worldSize,u)}coordinatePoint(e,i=0,u=this._pixelMatrix){const d=[e.x*this.worldSize,e.y*this.worldSize,i,1];return a.ap(d,d,u),new a.P(d[0]/d[3],d[1]/d[3])}getBounds(){const e=Math.max(0,this._helper._height/2-Ns(this));return new we().extend(this.screenPointToLocation(new a.P(0,e))).extend(this.screenPointToLocation(new a.P(this._helper._width,e))).extend(this.screenPointToLocation(new a.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new a.P(0,this._helper._height)))}isPointOnMapSurface(e,i){return i?i.pointCoordinate(e)!=null:e.y>this.height/2-Ns(this)}calculatePosMatrix(e,i=!1,u){var d;const _=(d=e.key)!==null&&d!==void 0?d:a.aX(e.wrap,e.canonical.z,e.canonical.z,e.canonical.x,e.canonical.y),x=i?this._alignedPosMatrixCache:this._posMatrixCache;if(x.has(_)){const M=x.get(_);return u?M.f32:M.f64}const T=Xi(e,this.worldSize);a.N(T,i?this._alignedProjMatrix:this._viewProjMatrix,T);const E={f64:T,f32:new Float32Array(T)};return x.set(_,E),u?E.f32:E.f64}calculateFogMatrix(e){const i=e.key,u=this._fogMatrixCacheF32;if(u.has(i))return u.get(i);const d=Xi(e,this.worldSize);return a.N(d,this._fogMatrix,d),u.set(i,new Float32Array(d)),u.get(i)}getConstrained(e,i){i=a.ae(+i,this.minZoom,this.maxZoom);const u={center:new a.Q(e.lng,e.lat),zoom:i};let d=this._helper._lngRange;this._helper._renderWorldCopies||d!==null||(d=[-179.9999999999,180-1e-10]);const _=this.tileSize*a.aI(u.zoom);let x=0,T=_,E=0,M=_,D=0,B=0;const{x:O,y:Z}=this.size;if(this._helper._latRange){const fe=this._helper._latRange;x=a.S(fe[1])*_,T=a.S(fe[0])*_,T-x<Z&&(D=Z/(T-x))}d&&(E=a.aL(a.U(d[0])*_,0,_),M=a.aL(a.U(d[1])*_,0,_),M<E&&(M+=_),M-E<O&&(B=O/(M-E)));const{x:K,y:ne}=En(_,e);let ie,oe;const ce=Math.max(B||0,D||0);if(ce){const fe=new a.P(B?(M+E)/2:K,D?(T+x)/2:ne);return u.center=Ra(_,fe).wrap(),u.zoom+=a.ab(ce),u}if(this._helper._latRange){const fe=Z/2;ne-fe<x&&(oe=x+fe),ne+fe>T&&(oe=T-fe)}if(d){const fe=(E+M)/2;let me=K;this._helper._renderWorldCopies&&(me=a.aL(K,fe-_/2,fe+_/2));const ge=O/2;me-ge<E&&(ie=E+ge),me+ge>M&&(ie=M-ge)}if(ie!==void 0||oe!==void 0){const fe=new a.P(ie??K,oe??ne);u.center=Ra(_,fe).wrap()}return u}calculateCenterFromCameraLngLatAlt(e,i,u,d){return this._helper.calculateCenterFromCameraLngLatAlt(e,i,u,d)}_calculateNearFarZIfNeeded(e,i,u){if(!this._helper.autoCalculateNearFarZ)return;const d=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),_=e-d*this._helper._pixelPerMeter/Math.cos(i),x=d<0?_:e,T=Math.PI/2+this.pitchInRadians,E=a.ad(this.fov)*(Math.abs(Math.cos(a.ad(this.roll)))*this.height+Math.abs(Math.sin(a.ad(this.roll)))*this.width)/this.height*(.5+u.y/this.height),M=Math.sin(E)*x/Math.sin(a.ae(Math.PI-T-E,.01,Math.PI-.01)),D=Ns(this),B=Math.atan(D/this._helper.cameraToCenterDistance),O=a.ad(.75),Z=B>O?2*B*(.5+u.y/(2*D)):O,K=Math.sin(Z)*x/Math.sin(a.ae(Math.PI-T-Z,.01,Math.PI-.01)),ne=Math.min(M,K);this._helper._farZ=1.01*(Math.cos(Math.PI/2-i)*ne+x),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const e=this.centerOffset,i=En(this.worldSize,this.center),u=i.x,d=i.y;this._helper._pixelPerMeter=a.aK(1,this.center.lat)*this.worldSize;const _=a.ad(Math.min(this.pitch,89.25)),x=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(_));let T;this._calculateNearFarZIfNeeded(x,_,e),T=new Float64Array(16),a.aY(T,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),a.aj(this._invProjMatrix,T),T[8]=2*-e.x/this._helper._width,T[9]=2*e.y/this._helper._height,this._projectionMatrix=a.aZ(T),a.M(T,T,[1,-1,1]),a.L(T,T,[0,0,-this._helper.cameraToCenterDistance]),a.a_(T,T,-this.rollInRadians),a.a$(T,T,this.pitchInRadians),a.a_(T,T,-this.bearingInRadians),a.L(T,T,[-u,-d,0]),this._mercatorMatrix=a.M([],T,[this.worldSize,this.worldSize,this.worldSize]),a.M(T,T,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=a.N(new Float64Array(16),this.clipSpaceToPixelsMatrix,T),a.L(T,T,[0,0,-this.elevation]),this._viewProjMatrix=T,this._invViewProjMatrix=a.aj([],T);const E=[0,0,-1,1];a.ap(E,E,this._invViewProjMatrix),this._cameraPosition=[E[0]/E[3],E[1]/E[3],E[2]/E[3]],this._fogMatrix=new Float64Array(16),a.aY(this._fogMatrix,this.fovInRadians,this.width/this.height,x,this._helper._farZ),this._fogMatrix[8]=2*-e.x/this.width,this._fogMatrix[9]=2*e.y/this.height,a.M(this._fogMatrix,this._fogMatrix,[1,-1,1]),a.L(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),a.a_(this._fogMatrix,this._fogMatrix,-this.rollInRadians),a.a$(this._fogMatrix,this._fogMatrix,this.pitchInRadians),a.a_(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),a.L(this._fogMatrix,this._fogMatrix,[-u,-d,0]),a.M(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),a.L(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=a.N(new Float64Array(16),this.clipSpaceToPixelsMatrix,T);const M=this._helper._width%2/2,D=this._helper._height%2/2,B=Math.cos(this.bearingInRadians),O=Math.sin(-this.bearingInRadians),Z=u-Math.round(u)+B*M+O*D,K=d-Math.round(d)+B*D+O*M,ne=new Float64Array(T);if(a.L(ne,ne,[Z>.5?Z-1:Z,K>.5?K-1:K,0]),this._alignedProjMatrix=ne,T=a.aj(new Float64Array(16),this._pixelMatrix),!T)throw new Error("failed to invert matrix");this._pixelMatrixInverse=T,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const e=this.screenPointToMercatorCoordinate(new a.P(0,0)),i=[e.x*this.worldSize,e.y*this.worldSize,0,1];return a.ap(i,i,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const e=a.aK(1,this.center.lat)*this.worldSize;return Ri(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/e).toLngLat()}lngLatToCameraDepth(e,i){const u=a.$.fromLngLat(e),d=[u.x*this.worldSize,u.y*this.worldSize,i,1];return a.ap(d,d,this._viewProjMatrix),d[2]/d[3]}getProjectionData(e){const{overscaledTileID:i,aligned:u,applyTerrainMatrix:d}=e,_=this._helper.getMercatorTileCoordinates(i),x=i?this.calculatePosMatrix(i,u,!0):null;let T;return T=i&&i.terrainRttPosMatrix32f&&d?i.terrainRttPosMatrix32f:x||a.b0(),{mainMatrix:T,tileMercatorCoords:_,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:T}}isLocationOccluded(e){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(e,i,u){return 1}transformLightDirection(e){return a.aQ(e)}getRayDirectionFromPixel(e){throw new Error("Not implemented.")}projectTileCoordinates(e,i,u,d){const _=this.calculatePosMatrix(u);let x;d?(x=[e,i,d(e,i),1],a.ap(x,x,_)):(x=[e,i,0,1],mi(x,x,_));const T=x[3];return{point:new a.P(x[0]/T,x[1]/T),signedDistanceFromCamera:T,isOccluded:!1}}populateCache(e){for(const i of e)this.calculatePosMatrix(i)}getMatrixForModel(e,i){const u=a.$.fromLngLat(e,i),d=u.meterInMercatorCoordinateUnits(),_=a.b1();return a.L(_,_,[u.x,u.y,u.z]),a.a_(_,_,Math.PI),a.a$(_,_,Math.PI/2),a.M(_,_,[-d,d,d]),_}getProjectionDataForCustomLayer(e=!0){const i=new a.Y(0,0,0,0,0),u=this.getProjectionData({overscaledTileID:i,applyGlobeMatrix:e}),d=Xi(i,this.worldSize);a.N(d,this._viewProjMatrix,d),u.tileMercatorCoords=[0,0,1,1];const _=[a.Z,a.Z,this.worldSize/this._helper.pixelsPerMeter],x=a.b2();return a.M(x,d,_),u.fallbackMatrix=x,u.mainMatrix=x,u}getFastPathSimpleProjectionMatrix(e){return this.calculatePosMatrix(e)}}function Vs(){a.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Ro(g){if(g.useSlerp)if(g.k<1){const e=a.b3(g.startEulerAngles.roll,g.startEulerAngles.pitch,g.startEulerAngles.bearing),i=a.b3(g.endEulerAngles.roll,g.endEulerAngles.pitch,g.endEulerAngles.bearing),u=new Float64Array(4);a.b4(u,e,i,g.k);const d=a.b5(u);g.tr.setRoll(d.roll),g.tr.setPitch(d.pitch),g.tr.setBearing(d.bearing)}else g.tr.setRoll(g.endEulerAngles.roll),g.tr.setPitch(g.endEulerAngles.pitch),g.tr.setBearing(g.endEulerAngles.bearing);else g.tr.setRoll(a.B.number(g.startEulerAngles.roll,g.endEulerAngles.roll,g.k)),g.tr.setPitch(a.B.number(g.startEulerAngles.pitch,g.endEulerAngles.pitch,g.k)),g.tr.setBearing(a.B.number(g.startEulerAngles.bearing,g.endEulerAngles.bearing,g.k))}function Da(g,e,i,u,d){const _=d.padding,x=En(d.worldSize,i.getNorthWest()),T=En(d.worldSize,i.getNorthEast()),E=En(d.worldSize,i.getSouthEast()),M=En(d.worldSize,i.getSouthWest()),D=a.ad(-u),B=x.rotate(D),O=T.rotate(D),Z=E.rotate(D),K=M.rotate(D),ne=new a.P(Math.max(B.x,O.x,K.x,Z.x),Math.max(B.y,O.y,K.y,Z.y)),ie=new a.P(Math.min(B.x,O.x,K.x,Z.x),Math.min(B.y,O.y,K.y,Z.y)),oe=ne.sub(ie),ce=(d.width-(_.left+_.right+e.left+e.right))/oe.x,fe=(d.height-(_.top+_.bottom+e.top+e.bottom))/oe.y;if(fe<0||ce<0)return void Vs();const me=Math.min(a.ab(d.scale*Math.min(ce,fe)),g.maxZoom),ge=a.P.convert(g.offset),Te=new a.P((e.left-e.right)/2,(e.top-e.bottom)/2).rotate(a.ad(u)),_e=ge.add(Te).mult(d.scale/a.aI(me));return{center:Ra(d.worldSize,x.add(E).div(2).sub(_e)),zoom:me,bearing:u}}class an{get useGlobeControls(){return!1}handlePanInertia(e,i){return{easingOffset:e,easingCenter:i.center}}handleMapControlsRollPitchBearingZoom(e,i){e.bearingDelta&&i.setBearing(i.bearing+e.bearingDelta),e.pitchDelta&&i.setPitch(i.pitch+e.pitchDelta),e.rollDelta&&i.setRoll(i.roll+e.rollDelta),e.zoomDelta&&i.setZoom(i.zoom+e.zoomDelta)}handleMapControlsPan(e,i,u){e.around.distSqr(i.centerPoint)<.01||i.setLocationAtPoint(u,e.around)}cameraForBoxAndBearing(e,i,u,d,_){return Da(e,i,u,d,_)}handleJumpToCenterZoom(e,i){e.zoom!==(i.zoom!==void 0?+i.zoom:e.zoom)&&e.setZoom(+i.zoom),i.center!==void 0&&e.setCenter(a.Q.convert(i.center))}handleEaseTo(e,i){const u=e.zoom,d=e.padding,_={roll:e.roll,pitch:e.pitch,bearing:e.bearing},x={roll:i.roll===void 0?e.roll:i.roll,pitch:i.pitch===void 0?e.pitch:i.pitch,bearing:i.bearing===void 0?e.bearing:i.bearing},T=i.zoom!==void 0,E=!e.isPaddingEqual(i.padding);let M=!1;const D=T?+i.zoom:e.zoom;let B=e.centerPoint.add(i.offsetAsPoint);const O=e.screenPointToLocation(B),{center:Z,zoom:K}=e.getConstrained(a.Q.convert(i.center||O),D??u);Fl(e,Z);const ne=En(e.worldSize,O),ie=En(e.worldSize,Z).sub(ne),oe=a.aI(K-u);return M=K!==u,{easeFunc:ce=>{if(M&&e.setZoom(a.B.number(u,K,ce)),a.b6(_,x)||Ro({startEulerAngles:_,endEulerAngles:x,tr:e,k:ce,useSlerp:_.roll!=x.roll}),E&&(e.interpolatePadding(d,i.padding,ce),B=e.centerPoint.add(i.offsetAsPoint)),i.around)e.setLocationAtPoint(i.around,i.aroundPoint);else{const fe=a.aI(e.zoom-u),me=K>u?Math.min(2,oe):Math.max(.5,oe),ge=Math.pow(me,1-ce),Te=Ra(e.worldSize,ne.add(ie.mult(ce*ge)).mult(fe));e.setLocationAtPoint(e.renderWorldCopies?Te.wrap():Te,B)}},isZooming:M,elevationCenter:Z}}handleFlyTo(e,i){const u=i.zoom!==void 0,d=e.zoom,_=e.getConstrained(a.Q.convert(i.center||i.locationAtOffset),u?+i.zoom:d),x=_.center,T=_.zoom;Fl(e,x);const E=En(e.worldSize,i.locationAtOffset),M=En(e.worldSize,x).sub(E),D=M.mag(),B=a.aI(T-d);let O;if(i.minZoom!==void 0){const Z=Math.min(+i.minZoom,d,T),K=e.getConstrained(x,Z).zoom;O=a.aI(K-d)}return{easeFunc:(Z,K,ne,ie)=>{e.setZoom(Z===1?T:d+a.ab(K));const oe=Z===1?x:Ra(e.worldSize,E.add(M.mult(ne)).mult(K));e.setLocationAtPoint(e.renderWorldCopies?oe.wrap():oe,ie)},scaleOfZoom:B,targetCenter:x,scaleOfMinZoom:O,pixelPathLength:D}}}class Rr{constructor(e,i,u){this.blendFunction=e,this.blendColor=i,this.mask=u}}Rr.Replace=[1,0],Rr.disabled=new Rr(Rr.Replace,a.b7.transparent,[!1,!1,!1,!1]),Rr.unblended=new Rr(Rr.Replace,a.b7.transparent,[!0,!0,!0,!0]),Rr.alphaBlended=new Rr([1,771],a.b7.transparent,[!0,!0,!0,!0]);const Hn=2305;class dr{constructor(e,i,u){this.enable=e,this.mode=i,this.frontFace=u}}dr.disabled=new dr(!1,1029,Hn),dr.backCCW=new dr(!0,1029,Hn),dr.frontCCW=new dr(!0,1028,Hn);class Wt{constructor(e,i,u){this.func=e,this.mask=i,this.range=u}}Wt.ReadOnly=!1,Wt.ReadWrite=!0,Wt.disabled=new Wt(519,Wt.ReadOnly,[0,1]);const $s=7680;class sr{constructor(e,i,u,d,_,x){this.test=e,this.ref=i,this.mask=u,this.fail=d,this.depthFail=_,this.pass=x}}sr.disabled=new sr({func:519,mask:0},0,0,$s,$s,$s);const Us=new WeakMap;function kn(g){var e;if(Us.has(g))return Us.get(g);{const i=(e=g.getParameter(g.VERSION))===null||e===void 0?void 0:e.startsWith("WebGL 2.0");return Us.set(g,i),i}}class Oa{get awaitingQuery(){return!!this._readbackQueue}constructor(e){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=e;const i=e.context,u=i.gl;this._texFormat=u.RGBA,this._texType=u.UNSIGNED_BYTE;const d=new a.aF;d.emplaceBack(-1,-1),d.emplaceBack(2,-1),d.emplaceBack(-1,2);const _=new a.aH;_.emplaceBack(0,1,2),this._fullscreenTriangle=new is(i.createVertexBuffer(d,Lo.members),i.createIndexBuffer(_),a.aG.simpleSegment(0,0,d.length,_.length)),this._resultBuffer=new Uint8Array(4),i.activeTexture.set(u.TEXTURE1);const x=u.createTexture();u.bindTexture(u.TEXTURE_2D,x),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.NEAREST),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.NEAREST),u.texImage2D(u.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=i.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(x),kn(u)&&(this._pbo=u.createBuffer(),u.bindBuffer(u.PIXEL_PACK_BUFFER,this._pbo),u.bufferData(u.PIXEL_PACK_BUFFER,4,u.STREAM_READ),u.bindBuffer(u.PIXEL_PACK_BUFFER,null))}destroy(){const e=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),e.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(e,i){const u=this._updateCount;return this._readbackQueue?u>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():u>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(e,i),this._updateCount++,this._measuredError}_bindFramebuffer(){const e=this._cachedRenderContext.context,i=e.gl;e.activeTexture.set(i.TEXTURE1),i.bindTexture(i.TEXTURE_2D,this._fbo.colorAttachment.get()),e.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(e,i){const u=this._cachedRenderContext.context,d=u.gl;if(this._bindFramebuffer(),u.viewport.set([0,0,this._texWidth,this._texHeight]),u.clear({color:a.b7.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(u,d.TRIANGLES,Wt.disabled,sr.disabled,Rr.unblended,dr.disabled,((_,x)=>({u_input:_,u_output_expected:x}))(e,i),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&kn(d)){d.bindBuffer(d.PIXEL_PACK_BUFFER,this._pbo),d.readBuffer(d.COLOR_ATTACHMENT0),d.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),d.bindBuffer(d.PIXEL_PACK_BUFFER,null);const _=d.fenceSync(d.SYNC_GPU_COMMANDS_COMPLETE,0);d.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:_}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const e=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&kn(e)){const i=e.clientWaitSync(this._readbackQueue.sync,0,0);if(i===e.WAIT_FAILED)return a.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(i===e.TIMEOUT_EXPIRED)return;e.bindBuffer(e.PIXEL_PACK_BUFFER,this._pbo),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),e.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=Oa._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(e){let i=0;return i+=e[0]/256,i+=e[1]/65536,i+=e[2]/16777216,e[3]<127&&(i=-i),i/128}}const Fa=a.Z/128;function Bl(g,e){const i=g.granularity!==void 0?Math.max(g.granularity,1):1,u=i+(g.generateBorders?2:0),d=i+(g.extendToNorthPole||g.generateBorders?1:0)+(g.extendToSouthPole||g.generateBorders?1:0),_=u+1,x=d+1,T=g.generateBorders?-1:0,E=g.generateBorders||g.extendToNorthPole?-1:0,M=i+(g.generateBorders?1:0),D=i+(g.generateBorders||g.extendToSouthPole?1:0),B=_*x,O=u*d*6,Z=_*x>65536;if(Z&&e==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const K=Z||e==="32bit",ne=new Int16Array(2*B);let ie=0;for(let fe=E;fe<=D;fe++)for(let me=T;me<=M;me++){let ge=me/i*a.Z;me===-1&&(ge=-64),me===i+1&&(ge=a.Z+Fa);let Te=fe/i*a.Z;fe===-1&&(Te=g.extendToNorthPole?a.b9:-64),fe===i+1&&(Te=g.extendToSouthPole?a.ba:a.Z+Fa),ne[ie++]=ge,ne[ie++]=Te}const oe=K?new Uint32Array(O):new Uint16Array(O);let ce=0;for(let fe=0;fe<d;fe++)for(let me=0;me<u;me++){const ge=me+1+fe*_,Te=me+(fe+1)*_,_e=me+1+(fe+1)*_;oe[ce++]=me+fe*_,oe[ce++]=Te,oe[ce++]=ge,oe[ce++]=ge,oe[ce++]=Te,oe[ce++]=_e}return{vertices:ne.buffer.slice(0),indices:oe.buffer.slice(0),uses32bitIndices:K}}const Ba=new a.aE({fill:new a.bb(128,2),line:new a.bb(512,0),tile:new a.bb(128,32),stencil:new a.bb(128,1),circle:3});class ja{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return An.projectionGlobe}get vertexShaderPreludeCode(){return An.projectionMercator.vertexSource}get subdivisionGranularity(){return Ba}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(e){this._errorMeasurement||(this._errorMeasurement=new Oa(e));const i=a.S(this._errorQueryLatitudeDegrees),u=2*Math.atan(Math.exp(Math.PI-i*Math.PI*2))-.5*Math.PI,d=this._errorMeasurement.updateErrorLoop(i,u),_=N.now();d!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=d,this._errorMeasurementLastChangeTime=_);const x=Math.min(Math.max((_-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=a.bc(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,a.bd(x))}_getMeshKey(e){return`${e.granularity.toString(36)}_${e.generateBorders?"b":""}${e.extendToNorthPole?"n":""}${e.extendToSouthPole?"s":""}`}getMeshFromTileID(e,i,u,d,_){const x=(_==="stencil"?Ba.stencil:Ba.tile).getGranularityForZoomLevel(i.z);return this._getMesh(e,{granularity:x,generateBorders:u,extendToNorthPole:i.y===0&&d,extendToSouthPole:i.y===(1<<i.z)-1&&d})}_getMesh(e,i){const u=this._getMeshKey(i);if(u in this._tileMeshCache)return this._tileMeshCache[u];const d=function(_,x){const T=Bl(x,"16bit"),E=a.aF.deserialize({arrayBuffer:T.vertices,length:T.vertices.byteLength/2/2}),M=a.aH.deserialize({arrayBuffer:T.indices,length:T.indices.byteLength/2/3});return new is(_.createVertexBuffer(E,Lo.members),_.createIndexBuffer(M),a.aG.simpleSegment(0,0,E.length,M.length))}(e,i);return this._tileMeshCache[u]=d,d}recalculate(e){}hasTransition(){const e=N.now();let i=!1;return i=i||(e-this._errorMeasurementLastChangeTime)/1e3<.7,i=i||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,i}setErrorQueryLatitudeDegrees(e){this._errorQueryLatitudeDegrees=e}}const jl=new a.r({type:new a.D(a.v.projection.type)});class Gs extends a.E{constructor(e){super(),this._transitionable=new a.T(jl),this.setProjection(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new a.C(0)),this._mercatorProjection=new lr,this._verticalPerspectiveProjection=new ja}get transitionState(){const e=this.properties.get("type");if(typeof e=="string"&&e==="mercator")return 0;if(typeof e=="string"&&e==="vertical-perspective")return 1;if(e instanceof a.be){if(e.from==="vertical-perspective"&&e.to==="mercator")return 1-e.transition;if(e.from==="mercator"&&e.to==="vertical-perspective")return e.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(e){this._mercatorProjection.updateGPUdependent(e),this._verticalPerspectiveProjection.updateGPUdependent(e)}getMeshFromTileID(e,i,u,d,_){return this.currentProjection.getMeshFromTileID(e,i,u,d,_)}setProjection(e){this._transitionable.setValue("type",(e==null?void 0:e.type)||"mercator")}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}setErrorQueryLatitudeDegrees(e){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(e),this._mercatorProjection.setErrorQueryLatitudeDegrees(e)}}function _d(g){const e=Nl(g.worldSize,g.center.lat);return 2*Math.PI*e}function ns(g,e,i,u,d){const _=1/(1<<d),x=e/a.Z*_+u*_,T=a.bg((g/a.Z*_+i*_)*Math.PI*2+Math.PI,2*Math.PI),E=2*Math.atan(Math.exp(Math.PI-x*Math.PI*2))-.5*Math.PI,M=Math.cos(E),D=new Float64Array(3);return D[0]=Math.sin(T)*M,D[1]=Math.sin(E),D[2]=Math.cos(T)*M,D}function Di(g){return function(e,i){const u=Math.cos(i),d=new Float64Array(3);return d[0]=Math.sin(e)*u,d[1]=Math.sin(i),d[2]=Math.cos(e)*u,d}(g.lng*Math.PI/180,g.lat*Math.PI/180)}function Nl(g,e){return g/(2*Math.PI)/Math.cos(e*Math.PI/180)}function yd(g){const e=Math.asin(g[1])/Math.PI*180,i=Math.sqrt(g[0]*g[0]+g[2]*g[2]);if(i>1e-6){const u=g[0]/i,d=Math.acos(g[2]/i),_=(u>0?d:-d)/Math.PI*180;return new a.Q(a.aL(_,-180,180),e)}return new a.Q(0,e)}function Vi(g){return Math.cos(g*Math.PI/180)}function hi(g,e){const i=Vi(g),u=Vi(e);return a.ab(u/i)}function Ln(g,e){const i=g.rotate(e.bearingInRadians),u=e.zoom+hi(e.center.lat,0),d=a.bc(1/Vi(e.center.lat),1/Vi(Math.min(Math.abs(e.center.lat),60)),a.bf(u,7,3,0,1)),_=360/_d({worldSize:e.worldSize,center:{lat:e.center.lat}});return new a.Q(e.center.lng-i.x*_*d,a.ae(e.center.lat+i.y*_,-85.051129,a.aJ))}function Zs(g){const e=.5*g,i=Math.sin(e),u=Math.cos(e);return Math.log(i+u)-Math.log(u-i)}function au(g,e,i,u){const d=g.lat+i*u;if(Math.abs(i)>1){const _=(Math.sign(g.lat+i)!==Math.sign(g.lat)?-Math.abs(g.lat):Math.abs(g.lat))*Math.PI/180,x=Math.abs(g.lat+i)*Math.PI/180,T=Zs(_+u*(x-_)),E=Zs(_),M=Zs(x);return new a.Q(g.lng+e*((T-E)/(M-E)),d)}return new a.Q(g.lng+e*u,d)}class vd{constructor(e){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._aabbFactory=e}recalculateCache(){if(!this._hadAnyChanges)return;const e=this._cachePrevious;this._cachePrevious=this._cache,this._cache=e,this._cache.clear(),this._hadAnyChanges=!1}getTileAABB(e,i,u,d){const _=`${e.z}_${e.x}_${e.y}`,x=this._cache.get(_);if(x)return x;const T=this._cachePrevious.get(_);if(T)return this._cache.set(_,T),T;const E=this._aabbFactory(e,i,u,d);return this._cache.set(_,E),this._hadAnyChanges=!0,E}}function fo(g,e,i){const u=g-e;return u<0?-u:Math.max(0,u-i)}function lu(g,e,i,u,d){const _=g-i;let x;return x=_<0?Math.min(-_,1+_-d):_>1?Math.min(Math.max(_-d,0),1-_):0,Math.max(x,fo(e,u,d))}class Bp{constructor(){this._aabbCache=new vd(this._computeTileAABB)}recalculateCache(){this._aabbCache.recalculateCache()}distanceToTile2d(e,i,u,d){const _=1<<u.z,x=1/_,T=u.x/_,E=u.y/_;let M=2;return M=Math.min(M,lu(e,i,T,E,x)),M=Math.min(M,lu(e,i,T+.5,-E-x,x)),M=Math.min(M,lu(e,i,T+.5,2-E-x,x)),M}getWrap(e,i,u){const d=1<<i.z,_=1/d,x=i.x/d,T=fo(e.x,x,_),E=fo(e.x,x-1,_),M=fo(e.x,x+1,_),D=Math.min(T,E,M);return D===M?1:D===E?-1:0}allowVariableZoom(e,i){return Ki(e,i)>4}allowWorldCopies(){return!1}getTileAABB(e,i,u,d){return this._aabbCache.getTileAABB(e,i,u,d)}_computeTileAABB(e,i,u,d){if(e.z<=0)return new gi([-1,-1,-1],[1,1,1]);if(e.z===1)return new gi([e.x===0?-1:0,e.y===0?0:-1,-1],[e.x===0?0:1,e.y===0?1:0,1]);{const _=[ns(0,0,e.x,e.y,e.z),ns(a.Z,0,e.x,e.y,e.z),ns(a.Z,a.Z,e.x,e.y,e.z),ns(0,a.Z,e.x,e.y,e.z)],x=[1,1,1],T=[-1,-1,-1];for(const E of _)for(let M=0;M<3;M++)x[M]=Math.min(x[M],E[M]),T[M]=Math.max(T[M],E[M]);if(e.y===0||e.y===(1<<e.z)-1){const E=[0,e.y===0?1:-1,0];for(let M=0;M<3;M++)x[M]=Math.min(x[M],E[M]),T[M]=Math.max(T[M],E[M])}return new gi(x,T)}}}class Vl{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,i,u){return this._helper.interpolatePadding(e,i,u)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,i){this._helper.resize(e,i)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,i){this._helper.overrideNearFarZ(e,i)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e){}constructor(){this._cachedClippingPlane=a.bh(),this._projectionMatrix=a.b1(),this._globeViewProjMatrix32f=a.b0(),this._globeViewProjMatrixNoCorrection=a.b1(),this._globeViewProjMatrixNoCorrectionInverted=a.b1(),this._globeProjMatrixInverted=a.b1(),this._cameraPosition=a.bi(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new sn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,i)=>this.getConstrained(e,i)}),this._coveringTilesDetailsProvider=new Bp}clone(){const e=new Vl;return e.apply(this),e}apply(e,i){this._globeLatitudeErrorCorrectionRadians=i||0,this._helper.apply(e)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const e=a.bi();return e[0]=this._cameraPosition[0],e[1]=this._cameraPosition[1],e[2]=this._cameraPosition[2],e}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(e){const{overscaledTileID:i,applyGlobeMatrix:u}=e,d=this._helper.getMercatorTileCoordinates(i);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:d,clippingPlane:this._cachedClippingPlane,projectionTransition:u?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(e){const i=this.pitchInRadians,u=this.cameraToCenterDistance/e,d=Math.sin(i)*u,_=Math.cos(i)*u+1,x=1/Math.sqrt(d*d+_*_)*1;let T=-d,E=_;const M=Math.sqrt(T*T+E*E);T/=M,E/=M;const D=[0,T,E];return a.bj(D,D,[0,0,0],-this.bearingInRadians),a.bk(D,D,[0,0,0],-1*this.center.lat*Math.PI/180),a.bl(D,D,[0,0,0],this.center.lng*Math.PI/180),a.aO(D,D,.25),[...D,.25*-x]}isLocationOccluded(e){return!this.isSurfacePointVisible(Di(e))}transformLightDirection(e){const i=this._helper._center.lng*Math.PI/180,u=this._helper._center.lat*Math.PI/180,d=Math.cos(u),_=[Math.sin(i)*d,Math.sin(u),Math.cos(i)*d],x=[_[2],0,-_[0]],T=[0,0,0];a.aU(T,x,_),a.aT(x,x),a.aT(T,T);const E=[0,0,0];return a.aT(E,[x[0]*e[0]+T[0]*e[1]+_[0]*e[2],x[1]*e[0]+T[1]*e[1]+_[1]*e[2],x[2]*e[0]+T[2]*e[1]+_[2]*e[2]]),E}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(e,i,u){const d=function(T,E,M){const D=1/(1<<M.z);return new a.$(T/a.Z*D+M.x*D,E/a.Z*D+M.y*D)}(e,i,u.canonical),_=(x=d.y,[a.bg(d.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-x*Math.PI*2))-.5*Math.PI]);var x;return this.getCircleRadiusCorrection()/Math.cos(_[1])}projectTileCoordinates(e,i,u,d){const _=u.canonical,x=ns(e,i,_.x,_.y,_.z),T=1+(d?d(e,i):0)/a.br,E=[x[0]*T,x[1]*T,x[2]*T,1];a.ap(E,E,this._globeViewProjMatrixNoCorrection);const M=this._cachedClippingPlane,D=M[0]*x[0]+M[1]*x[1]+M[2]*x[2]+M[3]<0;return{point:new a.P(E[0]/E[3],E[1]/E[3]),signedDistanceFromCamera:E[3],isOccluded:D}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const e=Nl(this.worldSize,this.center.lat),i=a.b2(),u=a.b2();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*e),a.aY(i,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const d=this.centerOffset;i[8]=2*-d.x/this._helper._width,i[9]=2*d.y/this._helper._height,this._projectionMatrix=a.aZ(i),this._globeProjMatrixInverted=a.b2(),a.aj(this._globeProjMatrixInverted,i),a.L(i,i,[0,0,-this.cameraToCenterDistance]),a.a_(i,i,this.rollInRadians),a.a$(i,i,-this.pitchInRadians),a.a_(i,i,this.bearingInRadians),a.L(i,i,[0,0,-e]);const _=a.bi();_[0]=e,_[1]=e,_[2]=e,a.a$(u,i,this.center.lat*Math.PI/180),a.bm(u,u,-this.center.lng*Math.PI/180),a.M(u,u,_),this._globeViewProjMatrixNoCorrection=u,a.a$(i,i,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),a.bm(i,i,-this.center.lng*Math.PI/180),a.M(i,i,_),this._globeViewProjMatrix32f=new Float32Array(i),this._globeViewProjMatrixNoCorrectionInverted=a.b2(),a.aj(this._globeViewProjMatrixNoCorrectionInverted,u);const x=a.bi();this._cameraPosition=a.bi(),this._cameraPosition[2]=this.cameraToCenterDistance/e,a.bj(this._cameraPosition,this._cameraPosition,x,-this.rollInRadians),a.bk(this._cameraPosition,this._cameraPosition,x,this.pitchInRadians),a.bj(this._cameraPosition,this._cameraPosition,x,-this.bearingInRadians),a.aP(this._cameraPosition,this._cameraPosition,[0,0,1]),a.bk(this._cameraPosition,this._cameraPosition,x,-this.center.lat*Math.PI/180),a.bl(this._cameraPosition,this._cameraPosition,x,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(e);const T=a.aZ(this._globeViewProjMatrixNoCorrectionInverted);a.M(T,T,[1,1,-1]),this._cachedFrustum=zo.fromInvProjectionMatrix(T)}calculateFogMatrix(e){a.w("calculateFogMatrix is not supported on globe projection.");const i=a.b2();return a.at(i),i}getVisibleUnwrappedCoordinates(e){return[new a.aW(0,e)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){e&&a.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,i){if(!this._globeViewProjMatrixNoCorrection)return 1;const u=Di(e);a.aO(u,u,1+i/a.br);const d=a.bh();return a.ap(d,[u[0],u[1],u[2],1],this._globeViewProjMatrixNoCorrection),d[2]/d[3]}populateCache(e){}getBounds(){const e=.5*this.width,i=.5*this.height,u=[new a.P(0,0),new a.P(e,0),new a.P(this.width,0),new a.P(this.width,i),new a.P(this.width,this.height),new a.P(e,this.height),new a.P(0,this.height),new a.P(0,i)],d=[];for(const B of u)d.push(this.unprojectScreenPoint(B));let _=0,x=0,T=0,E=0;const M=this.center;for(const B of d){const O=a.bn(M.lng,B.lng),Z=a.bn(M.lat,B.lat);O<x&&(x=O),O>_&&(_=O),Z<E&&(E=Z),Z>T&&(T=Z)}const D=[M.lng+x,M.lat+E,M.lng+_,M.lat+T];return this.isSurfacePointOnScreen([0,1,0])&&(D[3]=90,D[0]=-180,D[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(D[1]=-90,D[0]=-180,D[2]=180),new we(D)}getConstrained(e,i){const u=a.ae(e.lat,-85.051129,a.aJ),d=a.ae(+i,this.minZoom+hi(0,u),this.maxZoom);return{center:new a.Q(e.lng,u),zoom:d}}calculateCenterFromCameraLngLatAlt(e,i,u,d){return this._helper.calculateCenterFromCameraLngLatAlt(e,i,u,d)}setLocationAtPoint(e,i){const u=Di(this.unprojectScreenPoint(i)),d=Di(e),_=a.bi();a.bo(_);const x=a.bi();a.bl(x,u,_,-this.center.lng*Math.PI/180),a.bk(x,x,_,this.center.lat*Math.PI/180);const T=d[0]*d[0]+d[2]*d[2],E=x[0]*x[0];if(T<E)return;const M=Math.sqrt(T-E),D=-M,B=a.bp(d[0],d[2],x[0],M),O=a.bp(d[0],d[2],x[0],D),Z=a.bi();a.bl(Z,d,_,-B);const K=a.bp(Z[1],Z[2],x[1],x[2]),ne=a.bi();a.bl(ne,d,_,-O);const ie=a.bp(ne[1],ne[2],x[1],x[2]),oe=.5*Math.PI,ce=K>=-oe&&K<=oe,fe=ie>=-oe&&ie<=oe;let me,ge;if(ce&&fe){const De=this.center.lng*Math.PI/180,Ze=this.center.lat*Math.PI/180;a.bs(B,De)+a.bs(K,Ze)<a.bs(O,De)+a.bs(ie,Ze)?(me=B,ge=K):(me=O,ge=ie)}else if(ce)me=B,ge=K;else{if(!fe)return;me=O,ge=ie}const Te=me/Math.PI*180,_e=ge/Math.PI*180,Oe=this.center.lat;this.setCenter(new a.Q(Te,a.ae(_e,-90,90))),this.setZoom(this.zoom+hi(Oe,this.center.lat))}locationToScreenPoint(e,i){const u=Di(e);if(i){const d=i.getElevationForLngLatZoom(e,this._helper._tileZoom);a.aO(u,u,1+d/a.br)}return this._projectSurfacePointToScreen(u)}_projectSurfacePointToScreen(e){const i=a.bh();return a.ap(i,[...e,1],this._globeViewProjMatrixNoCorrection),i[0]/=i[3],i[1]/=i[3],new a.P((.5*i[0]+.5)*this.width,(.5*-i[1]+.5)*this.height)}screenPointToMercatorCoordinate(e,i){if(i){const u=i.pointCoordinate(e);if(u)return u}return a.$.fromLngLat(this.unprojectScreenPoint(e))}screenPointToLocation(e,i){var u;return(u=this.screenPointToMercatorCoordinate(e,i))===null||u===void 0?void 0:u.toLngLat()}isPointOnMapSurface(e,i){const u=this._cameraPosition,d=this.getRayDirectionFromPixel(e);return!!this.rayPlanetIntersection(u,d)}getRayDirectionFromPixel(e){const i=a.bh();i[0]=e.x/this.width*2-1,i[1]=-1*(e.y/this.height*2-1),i[2]=1,i[3]=1,a.ap(i,i,this._globeViewProjMatrixNoCorrectionInverted),i[0]/=i[3],i[1]/=i[3],i[2]/=i[3];const u=a.bi();u[0]=i[0]-this._cameraPosition[0],u[1]=i[1]-this._cameraPosition[1],u[2]=i[2]-this._cameraPosition[2];const d=a.bi();return a.aT(d,u),d}isSurfacePointVisible(e){const i=this._cachedClippingPlane;return i[0]*e[0]+i[1]*e[1]+i[2]*e[2]+i[3]>=0}isSurfacePointOnScreen(e){if(!this.isSurfacePointVisible(e))return!1;const i=a.bh();return a.ap(i,[...e,1],this._globeViewProjMatrixNoCorrection),i[0]/=i[3],i[1]/=i[3],i[2]/=i[3],i[0]>-1&&i[0]<1&&i[1]>-1&&i[1]<1&&i[2]>-1&&i[2]<1}rayPlanetIntersection(e,i){const u=a.aV(e,i),d=a.bi(),_=a.bi();a.aO(_,i,u),a.aS(d,e,_);const x=1-a.aV(d,d);if(x<0)return null;const T=a.aV(e,e)-1,E=-u+(u<0?1:-1)*Math.sqrt(x),M=T/E,D=E;return{tMin:Math.min(M,D),tMax:Math.max(M,D)}}unprojectScreenPoint(e){const i=this._cameraPosition,u=this.getRayDirectionFromPixel(e),d=this.rayPlanetIntersection(i,u);if(d){const M=a.bi();a.aP(M,i,[u[0]*d.tMin,u[1]*d.tMin,u[2]*d.tMin]);const D=a.bi();return a.aT(D,M),yd(D)}const _=this._cachedClippingPlane[0]*u[0]+this._cachedClippingPlane[1]*u[1]+this._cachedClippingPlane[2]*u[2],x=-a.bq(this._cachedClippingPlane,i)/_,T=a.bi();if(x>0)a.aP(T,i,[u[0]*x,u[1]*x,u[2]*x]);else{const M=a.bi();a.aP(M,i,[2*u[0],2*u[1],2*u[2]]);const D=a.bq(this._cachedClippingPlane,M);a.aS(T,M,[this._cachedClippingPlane[0]*D,this._cachedClippingPlane[1]*D,this._cachedClippingPlane[2]*D])}const E=a.bi();return a.aT(E,T),yd(E)}getMatrixForModel(e,i){const u=a.Q.convert(e),d=1/a.br,_=a.b1();return a.bm(_,_,u.lng/180*Math.PI),a.a$(_,_,-u.lat/180*Math.PI),a.L(_,_,[0,0,1+i/a.br]),a.a$(_,_,.5*Math.PI),a.M(_,_,[d,d,d]),_}getProjectionDataForCustomLayer(e=!0){const i=this.getProjectionData({overscaledTileID:new a.Y(0,0,0,0,0),applyGlobeMatrix:e});return i.tileMercatorCoords=[0,0,1,1],i}getFastPathSimpleProjectionMatrix(e){}}class $l{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,i,u){return this._helper.interpolatePadding(e,i,u)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,i,u=!0){this._helper.resize(e,i,u)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,i){this._helper.overrideNearFarZ(e,i)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(e,i){this._globeness=e,this._globeLatitudeErrorCorrectionRadians=i,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().recalculateCache(),this._mercatorTransform.getCoveringTilesDetailsProvider().recalculateCache()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new sn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,i)=>this.getConstrained(e,i)}),this._globeness=1,this._mercatorTransform=new Nr,this._verticalPerspectiveTransform=new Vl}clone(){const e=new $l;return e._globeness=this._globeness,e._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,e.apply(this),e}apply(e){this._helper.apply(e),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(e){const i=this._mercatorTransform.getProjectionData(e),u=this._verticalPerspectiveTransform.getProjectionData(e);return{mainMatrix:this.isGlobeRendering?u.mainMatrix:i.mainMatrix,clippingPlane:u.clippingPlane,tileMercatorCoords:u.tileMercatorCoords,projectionTransition:e.applyGlobeMatrix?this._globeness:0,fallbackMatrix:i.fallbackMatrix}}isLocationOccluded(e){return this.currentTransform.isLocationOccluded(e)}transformLightDirection(e){return this.currentTransform.transformLightDirection(e)}getPixelScale(){return a.bc(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return a.bc(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(e,i,u){const d=this._mercatorTransform.getPitchedTextCorrection(e,i,u),_=this._verticalPerspectiveTransform.getPitchedTextCorrection(e,i,u);return a.bc(d,_,this._globeness)}projectTileCoordinates(e,i,u,d){return this.currentTransform.projectTileCoordinates(e,i,u,d)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(e){return this.currentTransform.calculateFogMatrix(e)}getVisibleUnwrappedCoordinates(e){return this.currentTransform.getVisibleUnwrappedCoordinates(e)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(e){this._mercatorTransform.recalculateZoomAndCenter(e),this._verticalPerspectiveTransform.recalculateZoomAndCenter(e)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,i){return this.currentTransform.lngLatToCameraDepth(e,i)}populateCache(e){this._mercatorTransform.populateCache(e),this._verticalPerspectiveTransform.populateCache(e)}getBounds(){return this.currentTransform.getBounds()}getConstrained(e,i){return this.currentTransform.getConstrained(e,i)}calculateCenterFromCameraLngLatAlt(e,i,u,d){return this._helper.calculateCenterFromCameraLngLatAlt(e,i,u,d)}setLocationAtPoint(e,i){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(e,i),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(e,i),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(e,i){return this.currentTransform.locationToScreenPoint(e,i)}screenPointToMercatorCoordinate(e,i){return this.currentTransform.screenPointToMercatorCoordinate(e,i)}screenPointToLocation(e,i){return this.currentTransform.screenPointToLocation(e,i)}isPointOnMapSurface(e,i){return this.currentTransform.isPointOnMapSurface(e,i)}getRayDirectionFromPixel(e){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(e)}getMatrixForModel(e,i){return this.currentTransform.getMatrixForModel(e,i)}getProjectionDataForCustomLayer(e=!0){const i=this._mercatorTransform.getProjectionDataForCustomLayer(e);if(!this.isGlobeRendering)return i;const u=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(e);return u.fallbackMatrix=i.mainMatrix,u}getFastPathSimpleProjectionMatrix(e){return this.currentTransform.getFastPathSimpleProjectionMatrix(e)}}class zn{get useGlobeControls(){return!0}handlePanInertia(e,i){const u=Ln(e,i);return Math.abs(u.lng-i.center.lng)>180&&(u.lng=i.center.lng+179.5*Math.sign(u.lng-i.center.lng)),{easingCenter:u,easingOffset:new a.P(0,0)}}handleMapControlsRollPitchBearingZoom(e,i){const u=e.around,d=i.screenPointToLocation(u);e.bearingDelta&&i.setBearing(i.bearing+e.bearingDelta),e.pitchDelta&&i.setPitch(i.pitch+e.pitchDelta),e.rollDelta&&i.setRoll(i.roll+e.rollDelta);const _=i.zoom;e.zoomDelta&&i.setZoom(i.zoom+e.zoomDelta);const x=i.zoom-_;if(x===0)return;const T=a.bn(i.center.lng,d.lng),E=T/(Math.abs(T/180)+1),M=a.bn(i.center.lat,d.lat),D=i.getRayDirectionFromPixel(u),B=i.cameraPosition,O=-1*a.aV(B,D),Z=a.bi();a.aP(Z,B,[D[0]*O,D[1]*O,D[2]*O]);const K=a.bt(Z)-1,ne=Math.exp(.5*-Math.max(K-.3,0)),ie=Nl(i.worldSize,i.center.lat)/Math.min(i.width,i.height),oe=a.bf(ie,.9,.5,1,.25),ce=(1-a.aI(-x))*Math.min(ne,oe),fe=i.center.lat,me=i.zoom,ge=new a.Q(i.center.lng+E*ce,a.ae(i.center.lat+M*ce,-85.051129,a.aJ));i.setLocationAtPoint(d,u);const Te=i.center,_e=a.bf(Math.abs(T),45,85,0,1),Oe=a.bf(ie,.75,.35,0,1),De=Math.pow(Math.max(_e,Oe),.25),Ze=a.bn(Te.lng,ge.lng),Ke=a.bn(Te.lat,ge.lat);i.setCenter(new a.Q(Te.lng+Ze*De,Te.lat+Ke*De).wrap()),i.setZoom(me+hi(fe,i.center.lat))}handleMapControlsPan(e,i,u){if(!e.panDelta)return;const d=i.center.lat,_=i.zoom;i.setCenter(Ln(e.panDelta,i).wrap()),i.setZoom(_+hi(d,i.center.lat))}cameraForBoxAndBearing(e,i,u,d,_){const x=Da(e,i,u,d,_),T=i.left/_.width*2-1,E=(_.width-i.right)/_.width*2-1,M=i.top/_.height*-2+1,D=(_.height-i.bottom)/_.height*-2+1,B=a.bn(u.getWest(),u.getEast())<0,O=B?u.getEast():u.getWest(),Z=B?u.getWest():u.getEast(),K=Math.max(u.getNorth(),u.getSouth()),ne=Math.min(u.getNorth(),u.getSouth()),ie=O+.5*a.bn(O,Z),oe=K+.5*a.bn(K,ne),ce=_.clone();ce.setCenter(x.center),ce.setBearing(x.bearing),ce.setPitch(0),ce.setRoll(0),ce.setZoom(x.zoom);const fe=ce.modelViewProjectionMatrix,me=[Di(u.getNorthWest()),Di(u.getNorthEast()),Di(u.getSouthWest()),Di(u.getSouthEast()),Di(new a.Q(Z,oe)),Di(new a.Q(O,oe)),Di(new a.Q(ie,K)),Di(new a.Q(ie,ne))],ge=Di(x.center);let Te=Number.POSITIVE_INFINITY;for(const _e of me)T<0&&(Te=zn.getLesserNonNegativeNonNull(Te,zn.solveVectorScale(_e,ge,fe,"x",T))),E>0&&(Te=zn.getLesserNonNegativeNonNull(Te,zn.solveVectorScale(_e,ge,fe,"x",E))),M>0&&(Te=zn.getLesserNonNegativeNonNull(Te,zn.solveVectorScale(_e,ge,fe,"y",M))),D<0&&(Te=zn.getLesserNonNegativeNonNull(Te,zn.solveVectorScale(_e,ge,fe,"y",D)));if(Number.isFinite(Te)&&Te!==0)return x.zoom=ce.zoom+a.ab(Te),x;Vs()}handleJumpToCenterZoom(e,i){const u=e.center.lat,d=e.getConstrained(i.center?a.Q.convert(i.center):e.center,e.zoom).center;e.setCenter(d.wrap());const _=i.zoom!==void 0?+i.zoom:e.zoom+hi(u,d.lat);e.zoom!==_&&e.setZoom(_)}handleEaseTo(e,i){const u=e.zoom,d=e.center,_=e.padding,x={roll:e.roll,pitch:e.pitch,bearing:e.bearing},T={roll:i.roll===void 0?e.roll:i.roll,pitch:i.pitch===void 0?e.pitch:i.pitch,bearing:i.bearing===void 0?e.bearing:i.bearing},E=i.zoom!==void 0,M=!e.isPaddingEqual(i.padding);let D=!1;const B=i.center?a.Q.convert(i.center):d,O=e.getConstrained(B,u).center;Fl(e,O);const Z=e.clone();Z.setCenter(O),Z.setZoom(E?+i.zoom:u+hi(d.lat,B.lat)),Z.setBearing(i.bearing);const K=new a.P(a.ae(e.centerPoint.x+i.offsetAsPoint.x,0,e.width),a.ae(e.centerPoint.y+i.offsetAsPoint.y,0,e.height));Z.setLocationAtPoint(O,K);const ne=(i.offset&&i.offsetAsPoint.mag())>0?Z.center:O,ie=E?+i.zoom:u+hi(d.lat,ne.lat),oe=u+hi(d.lat,0),ce=ie+hi(ne.lat,0),fe=a.bn(d.lng,ne.lng),me=a.bn(d.lat,ne.lat),ge=a.aI(ce-oe);return D=ie!==u,{easeFunc:Te=>{if(a.b6(x,T)||Ro({startEulerAngles:x,endEulerAngles:T,tr:e,k:Te,useSlerp:x.roll!=T.roll}),M&&e.interpolatePadding(_,i.padding,Te),i.around)a.w("Easing around a point is not supported under globe projection."),e.setLocationAtPoint(i.around,i.aroundPoint);else{const _e=ce>oe?Math.min(2,ge):Math.max(.5,ge),Oe=Math.pow(_e,1-Te),De=au(d,fe,me,Te*Oe);e.setCenter(De.wrap())}if(D){const _e=a.B.number(oe,ce,Te)+hi(0,e.center.lat);e.setZoom(_e)}},isZooming:D,elevationCenter:ne}}handleFlyTo(e,i){const u=i.zoom!==void 0,d=e.center,_=e.zoom,x=e.padding,T=!e.isPaddingEqual(i.padding),E=e.getConstrained(a.Q.convert(i.center||i.locationAtOffset),_).center,M=u?+i.zoom:e.zoom+hi(e.center.lat,E.lat),D=e.clone();D.setCenter(E),D.setZoom(M),D.setBearing(i.bearing);const B=new a.P(a.ae(e.centerPoint.x+i.offsetAsPoint.x,0,e.width),a.ae(e.centerPoint.y+i.offsetAsPoint.y,0,e.height));D.setLocationAtPoint(E,B);const O=D.center;Fl(e,O);const Z=function(me,ge,Te){const _e=Di(ge),Oe=Di(Te),De=a.aV(_e,Oe),Ze=Math.acos(De),Ke=_d(me);return Ze/(2*Math.PI)*Ke}(e,d,O),K=_+hi(d.lat,0),ne=M+hi(O.lat,0),ie=a.aI(ne-K);let oe;if(typeof i.minZoom=="number"){const me=+i.minZoom+hi(O.lat,0),ge=Math.min(me,K,ne)+hi(0,O.lat),Te=e.getConstrained(O,ge).zoom+hi(O.lat,0);oe=a.aI(Te-K)}const ce=a.bn(d.lng,O.lng),fe=a.bn(d.lat,O.lat);return{easeFunc:(me,ge,Te,_e)=>{const Oe=au(d,ce,fe,Te);T&&e.interpolatePadding(x,i.padding,me);const De=me===1?O:Oe;e.setCenter(De.wrap());const Ze=K+a.ab(ge);e.setZoom(me===1?M:Ze+hi(0,De.lat))},scaleOfZoom:ie,targetCenter:O,scaleOfMinZoom:oe,pixelPathLength:Z}}static solveVectorScale(e,i,u,d,_){const x=d==="x"?[u[0],u[4],u[8],u[12]]:[u[1],u[5],u[9],u[13]],T=[u[3],u[7],u[11],u[15]],E=e[0]*x[0]+e[1]*x[1]+e[2]*x[2],M=e[0]*T[0]+e[1]*T[1]+e[2]*T[2],D=i[0]*x[0]+i[1]*x[1]+i[2]*x[2],B=i[0]*T[0]+i[1]*T[1]+i[2]*T[2];return D+_*M===E+_*B||T[3]*(E-D)+x[3]*(B-M)+E*B==D*M?null:(D+x[3]-_*B-_*T[3])/(D-E-_*B+_*M)}static getLesserNonNegativeNonNull(e,i){return i!==null&&i>=0&&i<e?i:e}}class bd{constructor(e){this._globe=e,this._mercatorCameraHelper=new an,this._verticalPerspectiveCameraHelper=new zn}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(e,i){return this.currentHelper.handlePanInertia(e,i)}handleMapControlsRollPitchBearingZoom(e,i){return this.currentHelper.handleMapControlsRollPitchBearingZoom(e,i)}handleMapControlsPan(e,i,u){this.currentHelper.handleMapControlsPan(e,i,u)}cameraForBoxAndBearing(e,i,u,d,_){return this.currentHelper.cameraForBoxAndBearing(e,i,u,d,_)}handleJumpToCenterZoom(e,i){this.currentHelper.handleJumpToCenterZoom(e,i)}handleEaseTo(e,i){return this.currentHelper.handleEaseTo(e,i)}handleFlyTo(e,i){return this.currentHelper.handleFlyTo(e,i)}}const os=(g,e)=>a.x(g,e&&e.filter(i=>i.identifier!=="source.canvas")),cu=a.bu();class qs extends a.E{constructor(e,i={}){super(),this._rtlPluginLoaded=()=>{for(const u in this.sourceCaches){const d=this.sourceCaches[u].getSource().type;d!=="vector"&&d!=="geojson"||this.sourceCaches[u].reload()}},this.map=e,this.dispatcher=new Jt(Yt(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",(u,d)=>this.getGlyphs(u,d)),this.dispatcher.registerMessageHandler("GI",(u,d)=>this.getImages(u,d)),this.imageManager=new Ee,this.imageManager.setEventedParent(this),this.glyphManager=new it(e._requestManager,i.localIdeographFontFamily),this.lineAtlas=new Mr(256,512),this.crossTileSymbolIndex=new Ol,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.bv,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",a.bw()),ir().on(It,this._rtlPluginLoaded),this.on("data",u=>{if(u.dataType!=="source"||u.sourceDataType!=="metadata")return;const d=this.sourceCaches[u.sourceId];if(!d)return;const _=d.getSource();if(_&&_.vectorLayerIds)for(const x in this._layers){const T=this._layers[x];T.source===_.id&&this._validateLayer(T)}})}loadURL(e,i={},u){this.fire(new a.l("dataloading",{dataType:"style"})),i.validate=typeof i.validate!="boolean"||i.validate;const d=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;const _=this._loadStyleRequest;a.j(d,this._loadStyleRequest).then(x=>{this._loadStyleRequest=null,this._load(x.data,i,u)}).catch(x=>{this._loadStyleRequest=null,x&&!_.signal.aborted&&this.fire(new a.k(x))})}loadJSON(e,i={},u){this.fire(new a.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,N.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,i.validate=i.validate!==!1,this._load(e,i,u)}).catch(()=>{})}loadEmpty(){this.fire(new a.l("dataloading",{dataType:"style"})),this._load(cu,{validate:!1})}_load(e,i,u){var d,_;const x=i.transformStyle?i.transformStyle(u,e):e;if(!i.validate||!os(this,a.y(x))){this._loaded=!0,this.stylesheet=x;for(const T in x.sources)this.addSource(T,x.sources[T],{validate:!1});x.sprite?this._loadSprite(x.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(x.glyphs),this._createLayers(),this.light=new xt(this.stylesheet.light),this._setProjectionInternal(((d=this.stylesheet.projection)===null||d===void 0?void 0:d.type)||"mercator"),this.sky=new Rt(this.stylesheet.sky),this.map.setTerrain((_=this.stylesheet.terrain)!==null&&_!==void 0?_:null),this.fire(new a.l("data",{dataType:"style"})),this.fire(new a.l("style.load"))}}_createLayers(){const e=a.bx(this.stylesheet.layers);this.dispatcher.broadcast("SL",e),this._order=e.map(i=>i.id),this._layers={},this._serializedLayers=null;for(const i of e){const u=a.by(i);u.setEventedParent(this,{layer:{id:i.id}}),this._layers[i.id]=u}}_loadSprite(e,i=!1,u=void 0){let d;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(_,x,T,E){return a._(this,void 0,void 0,function*(){const M=le(_),D=T>1?"@2x":"",B={},O={};for(const{id:Z,url:K}of M){const ne=x.transformRequest(Me(K,D,".json"),"SpriteJSON");B[Z]=a.j(ne,E);const ie=x.transformRequest(Me(K,D,".png"),"SpriteImage");O[Z]=re.getImage(ie,E)}return yield Promise.all([...Object.values(B),...Object.values(O)]),function(Z,K){return a._(this,void 0,void 0,function*(){const ne={};for(const ie in Z){ne[ie]={};const oe=N.getImageCanvasContext((yield K[ie]).data),ce=(yield Z[ie]).data;for(const fe in ce){const{width:me,height:ge,x:Te,y:_e,sdf:Oe,pixelRatio:De,stretchX:Ze,stretchY:Ke,content:Ue,textFitWidth:ft,textFitHeight:dt}=ce[fe];ne[ie][fe]={data:null,pixelRatio:De,sdf:Oe,stretchX:Ze,stretchY:Ke,content:Ue,textFitWidth:ft,textFitHeight:dt,spriteData:{width:me,height:ge,x:Te,y:_e,context:oe}}}}return ne})}(B,O)})}(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(_=>{if(this._spriteRequest=null,_)for(const x in _){this._spritesImagesIds[x]=[];const T=this._spritesImagesIds[x]?this._spritesImagesIds[x].filter(E=>!(E in _)):[];for(const E of T)this.imageManager.removeImage(E),this._changedImages[E]=!0;for(const E in _[x]){const M=x==="default"?E:`${x}:${E}`;this._spritesImagesIds[x].push(M),M in this.imageManager.images?this.imageManager.updateImage(M,_[x][E],!1):this.imageManager.addImage(M,_[x][E]),i&&(this._changedImages[M]=!0)}}}).catch(_=>{this._spriteRequest=null,d=_,this.fire(new a.k(d))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),i&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new a.l("data",{dataType:"style"})),u&&u(d)})}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new a.l("data",{dataType:"style"}))}_validateLayer(e){const i=this.sourceCaches[e.source];if(!i)return;const u=e.sourceLayer;if(!u)return;const d=i.getSource();(d.type==="geojson"||d.vectorLayerIds&&d.vectorLayerIds.indexOf(u)===-1)&&this.fire(new a.k(new Error(`Source layer "${u}" does not exist on source "${d.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,i=!1){const u=this._serializedAllLayers();if(!e||e.length===0)return Object.values(i?a.bz(u):u);const d=[];for(const _ of e)if(u[_]){const x=i?a.bz(u[_]):u[_];d.push(x)}return d}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const i=Object.keys(this._layers);for(const u of i){const d=this._layers[u];d.type!=="custom"&&(e[u]=d.serialize())}return e}hasTransitions(){var e,i,u;if(!((e=this.light)===null||e===void 0)&&e.hasTransition()||!((i=this.sky)===null||i===void 0)&&i.hasTransition()||!((u=this.projection)===null||u===void 0)&&u.hasTransition())return!0;for(const d in this.sourceCaches)if(this.sourceCaches[d].hasTransition())return!0;for(const d in this._layers)if(this._layers[d].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const i=this._changed;if(i){const d=Object.keys(this._updatedLayers),_=Object.keys(this._removedLayers);(d.length||_.length)&&this._updateWorkerLayers(d,_);for(const x in this._updatedSources){const T=this._updatedSources[x];if(T==="reload")this._reloadSource(x);else{if(T!=="clear")throw new Error(`Invalid action ${T}`);this._clearSource(x)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const x in this._updatedPaintProps)this._layers[x].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}const u={};for(const d in this.sourceCaches){const _=this.sourceCaches[d];u[d]=_.used,_.used=!1}for(const d of this._order){const _=this._layers[d];_.recalculate(e,this._availableImages),!_.isHidden(e.zoom)&&_.source&&(this.sourceCaches[_.source].used=!0)}for(const d in u){const _=this.sourceCaches[d];!!u[d]!=!!_.used&&_.fire(new a.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:d}))}this.light.recalculate(e),this.sky.recalculate(e),this.projection.recalculate(e),this.z=e.zoom,i&&this.fire(new a.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const i in this.sourceCaches)this.sourceCaches[i].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,i){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:i})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,i={}){var u;this._checkLoaded();const d=this.serialize();if(e=i.transformStyle?i.transformStyle(d,e):e,((u=i.validate)===null||u===void 0||u)&&os(this,a.y(e)))return!1;(e=a.bz(e)).layers=a.bx(e.layers);const _=a.bA(d,e),x=this._getOperationsToPerform(_);if(x.unimplemented.length>0)throw new Error(`Unimplemented: ${x.unimplemented.join(", ")}.`);if(x.operations.length===0)return!1;for(const T of x.operations)T();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){const i=[],u=[];for(const d of e)switch(d.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":i.push(()=>this.addLayer.apply(this,d.args));break;case"removeLayer":i.push(()=>this.removeLayer.apply(this,d.args));break;case"setPaintProperty":i.push(()=>this.setPaintProperty.apply(this,d.args));break;case"setLayoutProperty":i.push(()=>this.setLayoutProperty.apply(this,d.args));break;case"setFilter":i.push(()=>this.setFilter.apply(this,d.args));break;case"addSource":i.push(()=>this.addSource.apply(this,d.args));break;case"removeSource":i.push(()=>this.removeSource.apply(this,d.args));break;case"setLayerZoomRange":i.push(()=>this.setLayerZoomRange.apply(this,d.args));break;case"setLight":i.push(()=>this.setLight.apply(this,d.args));break;case"setGeoJSONSourceData":i.push(()=>this.setGeoJSONSourceData.apply(this,d.args));break;case"setGlyphs":i.push(()=>this.setGlyphs.apply(this,d.args));break;case"setSprite":i.push(()=>this.setSprite.apply(this,d.args));break;case"setTerrain":i.push(()=>this.map.setTerrain.apply(this,d.args));break;case"setSky":i.push(()=>this.setSky.apply(this,d.args));break;case"setProjection":this.setProjection.apply(this,d.args);break;case"setTransition":i.push(()=>{});break;default:u.push(d.command)}return{operations:i,unimplemented:u}}addImage(e,i){if(this.getImage(e))return this.fire(new a.k(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,i),this._afterImageUpdated(e)}updateImage(e,i){this.imageManager.updateImage(e,i)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new a.k(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new a.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,i,u={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!i.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(i).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(i.type)>=0&&this._validate(a.y.source,`sources.${e}`,i,null,u))return;this.map&&this.map._collectResourceTiming&&(i.collectResourceTiming=!0);const d=this.sourceCaches[e]=new q(e,i,this.dispatcher);d.style=this,d.setEventedParent(this,()=>({isSourceLoaded:d.loaded(),source:d.serialize(),sourceId:e})),d.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(const u in this._layers)if(this._layers[u].source===e)return this.fire(new a.k(new Error(`Source "${e}" cannot be removed while layer "${u}" is using it.`)));const i=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],i.fire(new a.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),i.setEventedParent(null),i.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,i){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error(`There is no source with this ID=${e}`);const u=this.sourceCaches[e].getSource();if(u.type!=="geojson")throw new Error(`geojsonSource.type is ${u.type}, which is !== 'geojson`);u.setData(i),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,i,u={}){this._checkLoaded();const d=e.id;if(this.getLayer(d))return void this.fire(new a.k(new Error(`Layer "${d}" already exists on this map.`)));let _;if(e.type==="custom"){if(os(this,a.bB(e)))return;_=a.by(e)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(d,e.source),e=a.bz(e),e=a.e(e,{source:d})),this._validate(a.y.layer,`layers.${d}`,e,{arrayIndex:-1},u))return;_=a.by(e),this._validateLayer(_),_.setEventedParent(this,{layer:{id:d}})}const x=i?this._order.indexOf(i):this._order.length;if(i&&x===-1)this.fire(new a.k(new Error(`Cannot add layer "${d}" before non-existing layer "${i}".`)));else{if(this._order.splice(x,0,d),this._layerOrderChanged=!0,this._layers[d]=_,this._removedLayers[d]&&_.source&&_.type!=="custom"){const T=this._removedLayers[d];delete this._removedLayers[d],T.type!==_.type?this._updatedSources[_.source]="clear":(this._updatedSources[_.source]="reload",this.sourceCaches[_.source].pause())}this._updateLayer(_),_.onAdd&&_.onAdd(this.map)}}moveLayer(e,i){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new a.k(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===i)return;const u=this._order.indexOf(e);this._order.splice(u,1);const d=i?this._order.indexOf(i):this._order.length;i&&d===-1?this.fire(new a.k(new Error(`Cannot move layer "${e}" before non-existing layer "${i}".`))):(this._order.splice(d,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const i=this._layers[e];if(!i)return void this.fire(new a.k(new Error(`Cannot remove non-existing layer "${e}".`)));i.setEventedParent(null);const u=this._order.indexOf(e);this._order.splice(u,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=i,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],i.onRemove&&i.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,i,u){this._checkLoaded();const d=this.getLayer(e);d?d.minzoom===i&&d.maxzoom===u||(i!=null&&(d.minzoom=i),u!=null&&(d.maxzoom=u),this._updateLayer(d)):this.fire(new a.k(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,i,u={}){this._checkLoaded();const d=this.getLayer(e);if(d){if(!a.bC(d.filter,i))return i==null?(d.filter=void 0,void this._updateLayer(d)):void(this._validate(a.y.filter,`layers.${d.id}.filter`,i,null,u)||(d.filter=a.bz(i),this._updateLayer(d)))}else this.fire(new a.k(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return a.bz(this.getLayer(e).filter)}setLayoutProperty(e,i,u,d={}){this._checkLoaded();const _=this.getLayer(e);_?a.bC(_.getLayoutProperty(i),u)||(_.setLayoutProperty(i,u,d),this._updateLayer(_)):this.fire(new a.k(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,i){const u=this.getLayer(e);if(u)return u.getLayoutProperty(i);this.fire(new a.k(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,i,u,d={}){this._checkLoaded();const _=this.getLayer(e);_?a.bC(_.getPaintProperty(i),u)||(_.setPaintProperty(i,u,d)&&this._updateLayer(_),this._changed=!0,this._updatedPaintProps[e]=!0,this._serializedLayers=null):this.fire(new a.k(new Error(`Cannot style non-existing layer "${e}".`)))}getPaintProperty(e,i){return this.getLayer(e).getPaintProperty(i)}setFeatureState(e,i){this._checkLoaded();const u=e.source,d=e.sourceLayer,_=this.sourceCaches[u];if(_===void 0)return void this.fire(new a.k(new Error(`The source '${u}' does not exist in the map's style.`)));const x=_.getSource().type;x==="geojson"&&d?this.fire(new a.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):x!=="vector"||d?(e.id===void 0&&this.fire(new a.k(new Error("The feature id parameter must be provided."))),_.setFeatureState(d,e.id,i)):this.fire(new a.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,i){this._checkLoaded();const u=e.source,d=this.sourceCaches[u];if(d===void 0)return void this.fire(new a.k(new Error(`The source '${u}' does not exist in the map's style.`)));const _=d.getSource().type,x=_==="vector"?e.sourceLayer:void 0;_!=="vector"||x?i&&typeof e.id!="string"&&typeof e.id!="number"?this.fire(new a.k(new Error("A feature id is required to remove its specific state property."))):d.removeFeatureState(x,e.id,i):this.fire(new a.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const i=e.source,u=e.sourceLayer,d=this.sourceCaches[i];if(d!==void 0)return d.getSource().type!=="vector"||u?(e.id===void 0&&this.fire(new a.k(new Error("The feature id parameter must be provided."))),d.getFeatureState(u,e.id)):void this.fire(new a.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new a.k(new Error(`The source '${i}' does not exist in the map's style.`)))}getTransition(){return a.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=a.bD(this.sourceCaches,_=>_.serialize()),i=this._serializeByIds(this._order,!0),u=this.map.getTerrain()||void 0,d=this.stylesheet;return a.bE({version:d.version,name:d.name,metadata:d.metadata,light:d.light,sky:d.sky,center:d.center,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch,sprite:d.sprite,glyphs:d.glyphs,transition:d.transition,projection:d.projection,sources:e,layers:i,terrain:u},_=>_!==void 0)}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const i=x=>this._layers[x].type==="fill-extrusion",u={},d=[];for(let x=this._order.length-1;x>=0;x--){const T=this._order[x];if(i(T)){u[T]=x;for(const E of e){const M=E[T];if(M)for(const D of M)d.push(D)}}}d.sort((x,T)=>T.intersectionZ-x.intersectionZ);const _=[];for(let x=this._order.length-1;x>=0;x--){const T=this._order[x];if(i(T))for(let E=d.length-1;E>=0;E--){const M=d[E].feature;if(u[M.layer.id]<x)break;_.push(M),d.pop()}else for(const E of e){const M=E[T];if(M)for(const D of M)_.push(D.feature)}}return _}queryRenderedFeatures(e,i,u){i&&i.filter&&this._validate(a.y.filter,"queryRenderedFeatures.filter",i.filter,null,i);const d={};if(i&&i.layers){if(!(Array.isArray(i.layers)||i.layers instanceof Set))return this.fire(new a.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const M of i.layers){const D=this._layers[M];if(!D)return this.fire(new a.k(new Error(`The layer '${M}' does not exist in the map's style and cannot be queried for features.`))),[];d[D.source]=!0}}const _=[];i.availableImages=this._availableImages;const x=this._serializedAllLayers(),T=i.layers instanceof Set?i.layers:Array.isArray(i.layers)?new Set(i.layers):null,E=Object.assign(Object.assign({},i),{layers:T});for(const M in this.sourceCaches)i.layers&&!d[M]||_.push(Ti(this.sourceCaches[M],this._layers,x,e,E,u,this.map.terrain?(D,B,O)=>this.map.terrain.getElevation(D,B,O):void 0));return this.placement&&_.push(function(M,D,B,O,Z,K,ne){const ie={},oe=K.queryRenderedSymbols(O),ce=[];for(const fe of Object.keys(oe).map(Number))ce.push(ne[fe]);ce.sort(Pr);for(const fe of ce){const me=fe.featureIndex.lookupSymbolFeatures(oe[fe.bucketInstanceId],D,fe.bucketIndex,fe.sourceLayerIndex,Z.filter,Z.layers,Z.availableImages,M);for(const ge in me){const Te=ie[ge]=ie[ge]||[],_e=me[ge];_e.sort((Oe,De)=>{const Ze=fe.featureSortOrder;if(Ze){const Ke=Ze.indexOf(Oe.featureIndex);return Ze.indexOf(De.featureIndex)-Ke}return De.featureIndex-Oe.featureIndex});for(const Oe of _e)Te.push(Oe)}}return function(fe,me,ge){for(const Te in fe)for(const _e of fe[Te])Sr(_e,ge[me[Te].source]);return fe}(ie,M,B)}(this._layers,x,this.sourceCaches,e,E,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(_)}querySourceFeatures(e,i){i&&i.filter&&this._validate(a.y.filter,"querySourceFeatures.filter",i.filter,null,i);const u=this.sourceCaches[e];return u?function(d,_){const x=d.getRenderableIds().map(M=>d.getTileByID(M)),T=[],E={};for(let M=0;M<x.length;M++){const D=x[M],B=D.tileID.canonical.key;E[B]||(E[B]=!0,D.querySourceFeatures(T,_))}return T}(u,i):[]}getLight(){return this.light.getLight()}setLight(e,i={}){this._checkLoaded();const u=this.light.getLight();let d=!1;for(const x in e)if(!a.bC(e[x],u[x])){d=!0;break}if(!d)return;const _={now:N.now(),transition:a.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,i),this.light.updateTransitions(_)}getProjection(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.projection}setProjection(e){if(this._checkLoaded(),this.projection){if(this.projection.name===e.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=e,this._setProjectionInternal(e.type)}getSky(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.sky}setSky(e,i={}){this._checkLoaded();const u=this.getSky();let d=!1;if(!e&&!u)return;if(e&&!u)d=!0;else if(!e&&u)d=!0;else for(const x in e)if(!a.bC(e[x],u[x])){d=!0;break}if(!d)return;const _={now:N.now(),transition:a.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,i),this.sky.updateTransitions(_)}_setProjectionInternal(e){const i=function(u){if(Array.isArray(u)){const d=new Gs({type:u});return{projection:d,transform:new $l,cameraHelper:new bd(d)}}switch(u){case"mercator":return{projection:new lr,transform:new Nr,cameraHelper:new an};case"globe":{const d=new Gs({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:d,transform:new $l,cameraHelper:new bd(d)}}case"vertical-perspective":return{projection:new ja,transform:new Vl,cameraHelper:new zn};default:return a.w(`Unknown projection name: ${u}. Falling back to mercator projection.`),{projection:new lr,transform:new Nr,cameraHelper:new an}}}(e);this.projection=i.projection,this.map.migrateProjection(i.transform,i.cameraHelper);for(const u in this.sourceCaches)this.sourceCaches[u].reload()}_validate(e,i,u,d,_={}){return(!_||_.validate!==!1)&&os(this,e.call(a.y,a.e({key:i,style:this.serialize(),value:u,styleSpec:a.v},d)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),ir().off(It,this._rtlPluginLoaded);for(const i in this._layers)this._layers[i].setEventedParent(null);for(const i in this.sourceCaches){const u=this.sourceCaches[i];u.setEventedParent(null),u.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(const i in this.sourceCaches)this.sourceCaches[i].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,i,u,d,_=!1){let x=!1,T=!1;const E={};for(const M of this._order){const D=this._layers[M];if(D.type!=="symbol")continue;if(!E[D.source]){const O=this.sourceCaches[D.source];E[D.source]=O.getRenderableIds(!0).map(Z=>O.getTileByID(Z)).sort((Z,K)=>K.tileID.overscaledZ-Z.tileID.overscaledZ||(Z.tileID.isLessThan(K.tileID)?-1:1))}const B=this.crossTileSymbolIndex.addLayer(D,E[D.source],e.center.lng);x=x||B}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((_=_||this._layerOrderChanged||u===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(N.now(),e.zoom))&&(this.pauseablePlacement=new pd(e,this.map.terrain,this._order,_,i,u,d,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,E),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(N.now()),T=!0),x&&this.pauseablePlacement.placement.setStale()),T||x)for(const M of this._order){const D=this._layers[M];D.type==="symbol"&&this.placement.updateLayerOpacities(D,E[D.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(N.now())}_releaseSymbolFadeTiles(){for(const e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,i){return a._(this,void 0,void 0,function*(){const u=yield this.imageManager.getImages(i.icons);this._updateTilesForChangedImages();const d=this.sourceCaches[i.source];return d&&d.setDependencies(i.tileID.key,i.type,i.icons),u})}getGlyphs(e,i){return a._(this,void 0,void 0,function*(){const u=yield this.glyphManager.getGlyphs(i.stacks),d=this.sourceCaches[i.source];return d&&d.setDependencies(i.tileID.key,i.type,[""]),u})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,i={}){this._checkLoaded(),e&&this._validate(a.y.glyphs,"glyphs",e,null,i)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,i,u={},d){this._checkLoaded();const _=[{id:e,url:i}],x=[...le(this.stylesheet.sprite),..._];this._validate(a.y.sprite,"sprite",x,null,u)||(this.stylesheet.sprite=x,this._loadSprite(_,!0,d))}removeSprite(e){this._checkLoaded();const i=le(this.stylesheet.sprite);if(i.find(u=>u.id===e)){if(this._spritesImagesIds[e])for(const u of this._spritesImagesIds[e])this.imageManager.removeImage(u),this._changedImages[u]=!0;i.splice(i.findIndex(u=>u.id===e),1),this.stylesheet.sprite=i.length>0?i:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new a.l("data",{dataType:"style"}))}else this.fire(new a.k(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return le(this.stylesheet.sprite)}setSprite(e,i={},u){this._checkLoaded(),e&&this._validate(a.y.sprite,"sprite",e,null,i)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,u):(this._unloadSprite(),u&&u(null)))}}var uu=a.aD([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class hu{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,i,u,d,_,x,T,E,M){this.context=e;let D=this.boundPaintVertexBuffers.length!==d.length;for(let B=0;!D&&B<d.length;B++)this.boundPaintVertexBuffers[B]!==d[B]&&(D=!0);!this.vao||this.boundProgram!==i||this.boundLayoutVertexBuffer!==u||D||this.boundIndexBuffer!==_||this.boundVertexOffset!==x||this.boundDynamicVertexBuffer!==T||this.boundDynamicVertexBuffer2!==E||this.boundDynamicVertexBuffer3!==M?this.freshBind(i,u,d,_,x,T,E,M):(e.bindVertexArray.set(this.vao),T&&T.bind(),_&&_.dynamicDraw&&_.bind(),E&&E.bind(),M&&M.bind())}freshBind(e,i,u,d,_,x,T,E){const M=e.numAttributes,D=this.context,B=D.gl;this.vao&&this.destroy(),this.vao=D.createVertexArray(),D.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=i,this.boundPaintVertexBuffers=u,this.boundIndexBuffer=d,this.boundVertexOffset=_,this.boundDynamicVertexBuffer=x,this.boundDynamicVertexBuffer2=T,this.boundDynamicVertexBuffer3=E,i.enableAttributes(B,e);for(const O of u)O.enableAttributes(B,e);x&&x.enableAttributes(B,e),T&&T.enableAttributes(B,e),E&&E.enableAttributes(B,e),i.bind(),i.setVertexAttribPointers(B,e,_);for(const O of u)O.bind(),O.setVertexAttribPointers(B,e,_);x&&(x.bind(),x.setVertexAttribPointers(B,e,_)),d&&d.bind(),T&&(T.bind(),T.setVertexAttribPointers(B,e,_)),E&&(E.bind(),E.setVertexAttribPointers(B,e,_)),D.currentNumAttributes=M}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Wn=(g,e,i,u,d)=>({u_texture:0,u_ele_delta:g,u_fog_matrix:e,u_fog_color:i?i.properties.get("fog-color"):a.b7.white,u_fog_ground_blend:i?i.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:d?0:i?i.calculateFogBlendOpacity(u):0,u_horizon_color:i?i.properties.get("horizon-color"):a.b7.white,u_horizon_fog_blend:i?i.properties.get("horizon-fog-blend"):1,u_is_globe_mode:d?1:0}),jp={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function Hs(g){const e=[];for(let i=0;i<g.length;i++){if(g[i]===null)continue;const u=g[i].split(" ");e.push(u.pop())}return e}class Na{constructor(e,i,u,d,_,x,T,E){const M=e.gl;this.program=M.createProgram();const D=Hs(i.staticAttributes),B=u?u.getBinderAttributes():[],O=D.concat(B),Z=An.prelude.staticUniforms?Hs(An.prelude.staticUniforms):[],K=T.staticUniforms?Hs(T.staticUniforms):[],ne=i.staticUniforms?Hs(i.staticUniforms):[],ie=u?u.getBinderUniforms():[],oe=Z.concat(K).concat(ne).concat(ie),ce=[];for(const De of oe)ce.indexOf(De)<0&&ce.push(De);const fe=u?u.defines():[];kn(M)&&fe.unshift("#version 300 es"),_&&fe.push("#define OVERDRAW_INSPECTOR;"),x&&fe.push("#define TERRAIN3D;"),E&&fe.push(E);let me=fe.concat(An.prelude.fragmentSource,T.fragmentSource,i.fragmentSource).join(`
`),ge=fe.concat(An.prelude.vertexSource,T.vertexSource,i.vertexSource).join(`
`);kn(M)||(me=function(De){return De.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(me),ge=function(De){return De.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(ge));const Te=M.createShader(M.FRAGMENT_SHADER);if(M.isContextLost())return void(this.failedToCreate=!0);if(M.shaderSource(Te,me),M.compileShader(Te),!M.getShaderParameter(Te,M.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${M.getShaderInfoLog(Te)}`);M.attachShader(this.program,Te);const _e=M.createShader(M.VERTEX_SHADER);if(M.isContextLost())return void(this.failedToCreate=!0);if(M.shaderSource(_e,ge),M.compileShader(_e),!M.getShaderParameter(_e,M.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${M.getShaderInfoLog(_e)}`);M.attachShader(this.program,_e),this.attributes={};const Oe={};this.numAttributes=O.length;for(let De=0;De<this.numAttributes;De++)O[De]&&(M.bindAttribLocation(this.program,De,O[De]),this.attributes[O[De]]=De);if(M.linkProgram(this.program),!M.getProgramParameter(this.program,M.LINK_STATUS))throw new Error(`Program failed to link: ${M.getProgramInfoLog(this.program)}`);M.deleteShader(_e),M.deleteShader(Te);for(let De=0;De<ce.length;De++){const Ze=ce[De];if(Ze&&!Oe[Ze]){const Ke=M.getUniformLocation(this.program,Ze);Ke&&(Oe[Ze]=Ke)}}this.fixedUniforms=d(e,Oe),this.terrainUniforms=((De,Ze)=>({u_depth:new a.bF(De,Ze.u_depth),u_terrain:new a.bF(De,Ze.u_terrain),u_terrain_dim:new a.b8(De,Ze.u_terrain_dim),u_terrain_matrix:new a.bH(De,Ze.u_terrain_matrix),u_terrain_unpack:new a.bI(De,Ze.u_terrain_unpack),u_terrain_exaggeration:new a.b8(De,Ze.u_terrain_exaggeration)}))(e,Oe),this.projectionUniforms=((De,Ze)=>({u_projection_matrix:new a.bH(De,Ze.u_projection_matrix),u_projection_tile_mercator_coords:new a.bI(De,Ze.u_projection_tile_mercator_coords),u_projection_clipping_plane:new a.bI(De,Ze.u_projection_clipping_plane),u_projection_transition:new a.b8(De,Ze.u_projection_transition),u_projection_fallback_matrix:new a.bH(De,Ze.u_projection_fallback_matrix)}))(e,Oe),this.binderUniforms=u?u.getUniforms(e,Oe):[]}draw(e,i,u,d,_,x,T,E,M,D,B,O,Z,K,ne,ie,oe,ce,fe){const me=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(u),e.setStencilMode(d),e.setColorMode(_),e.setCullFace(x),E){e.activeTexture.set(me.TEXTURE2),me.bindTexture(me.TEXTURE_2D,E.depthTexture),e.activeTexture.set(me.TEXTURE3),me.bindTexture(me.TEXTURE_2D,E.texture);for(const Te in this.terrainUniforms)this.terrainUniforms[Te].set(E[Te])}if(M)for(const Te in M)this.projectionUniforms[jp[Te]].set(M[Te]);if(T)for(const Te in this.fixedUniforms)this.fixedUniforms[Te].set(T[Te]);ie&&ie.setUniforms(e,this.binderUniforms,K,{zoom:ne});let ge=0;switch(i){case me.LINES:ge=2;break;case me.TRIANGLES:ge=3;break;case me.LINE_STRIP:ge=1}for(const Te of Z.get()){const _e=Te.vaos||(Te.vaos={});(_e[D]||(_e[D]=new hu)).bind(e,this,B,ie?ie.getPaintVertexBuffers():[],O,Te.vertexOffset,oe,ce,fe),me.drawElements(i,Te.primitiveLength*ge,me.UNSIGNED_SHORT,Te.primitiveOffset*ge*2)}}}function Ws(g,e,i){const u=1/a.aw(i,1,e.transform.tileZoom),d=Math.pow(2,i.tileID.overscaledZ),_=i.tileSize*Math.pow(2,e.transform.tileZoom)/d,x=_*(i.tileID.canonical.x+i.tileID.wrap*d),T=_*i.tileID.canonical.y;return{u_image:0,u_texsize:i.imageAtlasTexture.size,u_scale:[u,g.fromScale,g.toScale],u_fade:g.t,u_pixel_coord_upper:[x>>16,T>>16],u_pixel_coord_lower:[65535&x,65535&T]}}const xd=(g,e,i,u)=>{const d=g.style.light,_=d.properties.get("position"),x=[_.x,_.y,_.z],T=a.bL();d.properties.get("anchor")==="viewport"&&a.bM(T,g.transform.bearingInRadians),a.bN(x,x,T);const E=g.transform.transformLightDirection(x),M=d.properties.get("color");return{u_lightpos:x,u_lightpos_globe:E,u_lightintensity:d.properties.get("intensity"),u_lightcolor:[M.r,M.g,M.b],u_vertical_gradient:+e,u_opacity:i,u_fill_translate:u}},Ul=(g,e,i,u,d,_,x)=>a.e(xd(g,e,i,u),Ws(_,g,x),{u_height_factor:-Math.pow(2,d.overscaledZ)/x.tileSize/8}),wd=(g,e,i,u)=>a.e(Ws(e,g,i),{u_fill_translate:u}),Ks=(g,e)=>({u_world:g,u_fill_translate:e}),Np=(g,e,i,u,d)=>a.e(wd(g,e,i,d),{u_world:u}),Td=(g,e,i,u,d)=>{const _=g.transform;let x,T,E=0;if(i.paint.get("circle-pitch-alignment")==="map"){const M=a.aw(e,1,_.zoom);x=!0,T=[M,M],E=M/(a.Z*Math.pow(2,e.tileID.overscaledZ))*2*Math.PI*d}else x=!1,T=_.pixelsToGLUnits;return{u_camera_to_center_distance:_.cameraToCenterDistance,u_scale_with_map:+(i.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+x,u_device_pixel_ratio:g.pixelRatio,u_extrude_scale:T,u_globe_extrude_scale:E,u_translate:u}},Vp=g=>({u_pixel_extrude_scale:[1/g.width,1/g.height]}),Sd=g=>({u_viewport_size:[g.width,g.height]}),Gl=(g,e=1)=>({u_color:g,u_overlay:0,u_overlay_scale:e}),du=(g,e,i,u)=>{const d=a.aw(g,1,e)/(a.Z*Math.pow(2,g.tileID.overscaledZ))*2*Math.PI*u;return{u_extrude_scale:a.aw(g,1,e),u_intensity:i,u_globe_extrude_scale:d}},fu=(g,e,i,u)=>{const d=a.K();a.bO(d,0,g.width,g.height,0,0,1);const _=g.context.gl;return{u_matrix:d,u_world:[_.drawingBufferWidth,_.drawingBufferHeight],u_image:i,u_color_ramp:u,u_opacity:e.paint.get("heatmap-opacity")}},Ed=(g,e,i)=>{const u=i.paint.get("hillshade-shadow-color"),d=i.paint.get("hillshade-highlight-color"),_=i.paint.get("hillshade-accent-color");let x=i.paint.get("hillshade-illumination-direction")*(Math.PI/180);return i.paint.get("hillshade-illumination-anchor")==="viewport"&&(x+=g.transform.bearingInRadians),{u_image:0,u_latrange:ss(0,e.tileID),u_light:[i.paint.get("hillshade-exaggeration"),x],u_shadow:u,u_highlight:d,u_accent:_}},Cd=(g,e)=>{const i=e.stride,u=a.K();return a.bO(u,0,a.Z,-8192,0,0,1),a.L(u,u,[0,-8192,0]),{u_matrix:u,u_image:1,u_dimension:[i,i],u_zoom:g.overscaledZ,u_unpack:e.getUnpackVector()}};function ss(g,e){const i=Math.pow(2,e.canonical.z),u=e.canonical.y;return[new a.$(0,u/i).toLngLat().lat,new a.$(0,(u+1)/i).toLngLat().lat]}const Zl=(g,e,i,u)=>{const d=g.transform;return{u_translation:Md(g,e,i),u_ratio:u/a.aw(e,1,d.zoom),u_device_pixel_ratio:g.pixelRatio,u_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]]}},Id=(g,e,i,u,d)=>a.e(Zl(g,e,i,u),{u_image:0,u_image_height:d}),Va=(g,e,i,u,d)=>{const _=g.transform,x=$a(e,_);return{u_translation:Md(g,e,i),u_texsize:e.imageAtlasTexture.size,u_ratio:u/a.aw(e,1,_.zoom),u_device_pixel_ratio:g.pixelRatio,u_image:0,u_scale:[x,d.fromScale,d.toScale],u_fade:d.t,u_units_to_pixels:[1/_.pixelsToGLUnits[0],1/_.pixelsToGLUnits[1]]}},$p=(g,e,i,u,d,_)=>{const x=g.lineAtlas,T=$a(e,g.transform),E=i.layout.get("line-cap")==="round",M=x.getDash(d.from,E),D=x.getDash(d.to,E),B=M.width*_.fromScale,O=D.width*_.toScale;return a.e(Zl(g,e,i,u),{u_patternscale_a:[T/B,-M.height/2],u_patternscale_b:[T/O,-D.height/2],u_sdfgamma:x.width/(256*Math.min(B,O)*g.pixelRatio)/2,u_image:0,u_tex_y_a:M.y,u_tex_y_b:D.y,u_mix:_.t})};function $a(g,e){return 1/a.aw(g,1,e.tileZoom)}function Md(g,e,i){return a.ax(g.transform,e,i.paint.get("line-translate"),i.paint.get("line-translate-anchor"))}const Up=(g,e,i,u,d)=>{return{u_tl_parent:g,u_scale_parent:e,u_buffer_scale:1,u_fade_t:i.mix,u_opacity:i.opacity*u.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:u.paint.get("raster-brightness-min"),u_brightness_high:u.paint.get("raster-brightness-max"),u_saturation_factor:(x=u.paint.get("raster-saturation"),x>0?1-1/(1.001-x):-x),u_contrast_factor:(_=u.paint.get("raster-contrast"),_>0?1/(1-_):1+_),u_spin_weights:Pd(u.paint.get("raster-hue-rotate")),u_coords_top:[d[0].x,d[0].y,d[1].x,d[1].y],u_coords_bottom:[d[3].x,d[3].y,d[2].x,d[2].y]};var _,x};function Pd(g){g*=Math.PI/180;const e=Math.sin(g),i=Math.cos(g);return[(2*i+1)/3,(-Math.sqrt(3)*e-i+1)/3,(Math.sqrt(3)*e-i+1)/3]}const pu=(g,e,i,u,d,_,x,T,E,M,D,B,O)=>{const Z=x.transform;return{u_is_size_zoom_constant:+(g==="constant"||g==="source"),u_is_size_feature_constant:+(g==="constant"||g==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:Z.cameraToCenterDistance,u_pitch:Z.pitch/360*2*Math.PI,u_rotate_symbol:+i,u_aspect_ratio:Z.width/Z.height,u_fade_change:x.options.fadeDuration?x.symbolFadeChange:1,u_label_plane_matrix:T,u_coord_matrix:E,u_is_text:+D,u_pitch_with_map:+u,u_is_along_line:d,u_is_variable_anchor:_,u_texsize:B,u_texture:0,u_translation:M,u_pitched_scale:O}},mu=(g,e,i,u,d,_,x,T,E,M,D,B,O,Z)=>{const K=x.transform;return a.e(pu(g,e,i,u,d,_,x,T,E,M,D,B,Z),{u_gamma_scale:u?Math.cos(K.pitch*Math.PI/180)*K.cameraToCenterDistance:1,u_device_pixel_ratio:x.pixelRatio,u_is_halo:1})},gu=(g,e,i,u,d,_,x,T,E,M,D,B,O)=>a.e(mu(g,e,i,u,d,_,x,T,E,M,!0,D,0,O),{u_texsize_icon:B,u_texture_icon:1}),Ad=(g,e)=>({u_opacity:g,u_color:e}),ql=(g,e,i,u,d)=>a.e(function(_,x,T,E){const M=T.imageManager.getPattern(_.from.toString()),D=T.imageManager.getPattern(_.to.toString()),{width:B,height:O}=T.imageManager.getPixelSize(),Z=Math.pow(2,E.tileID.overscaledZ),K=E.tileSize*Math.pow(2,T.transform.tileZoom)/Z,ne=K*(E.tileID.canonical.x+E.tileID.wrap*Z),ie=K*E.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:M.tl,u_pattern_br_a:M.br,u_pattern_tl_b:D.tl,u_pattern_br_b:D.br,u_texsize:[B,O],u_mix:x.t,u_pattern_size_a:M.displaySize,u_pattern_size_b:D.displaySize,u_scale_a:x.fromScale,u_scale_b:x.toScale,u_tile_units_to_pixels:1/a.aw(E,1,T.transform.tileZoom),u_pixel_coord_upper:[ne>>16,ie>>16],u_pixel_coord_lower:[65535&ne,65535&ie]}}(i,d,e,u),{u_opacity:g}),Kn=(g,e)=>{},_u={fillExtrusion:(g,e)=>({u_lightpos:new a.bJ(g,e.u_lightpos),u_lightpos_globe:new a.bJ(g,e.u_lightpos_globe),u_lightintensity:new a.b8(g,e.u_lightintensity),u_lightcolor:new a.bJ(g,e.u_lightcolor),u_vertical_gradient:new a.b8(g,e.u_vertical_gradient),u_opacity:new a.b8(g,e.u_opacity),u_fill_translate:new a.bK(g,e.u_fill_translate)}),fillExtrusionPattern:(g,e)=>({u_lightpos:new a.bJ(g,e.u_lightpos),u_lightpos_globe:new a.bJ(g,e.u_lightpos_globe),u_lightintensity:new a.b8(g,e.u_lightintensity),u_lightcolor:new a.bJ(g,e.u_lightcolor),u_vertical_gradient:new a.b8(g,e.u_vertical_gradient),u_height_factor:new a.b8(g,e.u_height_factor),u_opacity:new a.b8(g,e.u_opacity),u_fill_translate:new a.bK(g,e.u_fill_translate),u_image:new a.bF(g,e.u_image),u_texsize:new a.bK(g,e.u_texsize),u_pixel_coord_upper:new a.bK(g,e.u_pixel_coord_upper),u_pixel_coord_lower:new a.bK(g,e.u_pixel_coord_lower),u_scale:new a.bJ(g,e.u_scale),u_fade:new a.b8(g,e.u_fade)}),fill:(g,e)=>({u_fill_translate:new a.bK(g,e.u_fill_translate)}),fillPattern:(g,e)=>({u_image:new a.bF(g,e.u_image),u_texsize:new a.bK(g,e.u_texsize),u_pixel_coord_upper:new a.bK(g,e.u_pixel_coord_upper),u_pixel_coord_lower:new a.bK(g,e.u_pixel_coord_lower),u_scale:new a.bJ(g,e.u_scale),u_fade:new a.b8(g,e.u_fade),u_fill_translate:new a.bK(g,e.u_fill_translate)}),fillOutline:(g,e)=>({u_world:new a.bK(g,e.u_world),u_fill_translate:new a.bK(g,e.u_fill_translate)}),fillOutlinePattern:(g,e)=>({u_world:new a.bK(g,e.u_world),u_image:new a.bF(g,e.u_image),u_texsize:new a.bK(g,e.u_texsize),u_pixel_coord_upper:new a.bK(g,e.u_pixel_coord_upper),u_pixel_coord_lower:new a.bK(g,e.u_pixel_coord_lower),u_scale:new a.bJ(g,e.u_scale),u_fade:new a.b8(g,e.u_fade),u_fill_translate:new a.bK(g,e.u_fill_translate)}),circle:(g,e)=>({u_camera_to_center_distance:new a.b8(g,e.u_camera_to_center_distance),u_scale_with_map:new a.bF(g,e.u_scale_with_map),u_pitch_with_map:new a.bF(g,e.u_pitch_with_map),u_extrude_scale:new a.bK(g,e.u_extrude_scale),u_device_pixel_ratio:new a.b8(g,e.u_device_pixel_ratio),u_globe_extrude_scale:new a.b8(g,e.u_globe_extrude_scale),u_translate:new a.bK(g,e.u_translate)}),collisionBox:(g,e)=>({u_pixel_extrude_scale:new a.bK(g,e.u_pixel_extrude_scale)}),collisionCircle:(g,e)=>({u_viewport_size:new a.bK(g,e.u_viewport_size)}),debug:(g,e)=>({u_color:new a.bG(g,e.u_color),u_overlay:new a.bF(g,e.u_overlay),u_overlay_scale:new a.b8(g,e.u_overlay_scale)}),depth:Kn,clippingMask:Kn,heatmap:(g,e)=>({u_extrude_scale:new a.b8(g,e.u_extrude_scale),u_intensity:new a.b8(g,e.u_intensity),u_globe_extrude_scale:new a.b8(g,e.u_globe_extrude_scale)}),heatmapTexture:(g,e)=>({u_matrix:new a.bH(g,e.u_matrix),u_world:new a.bK(g,e.u_world),u_image:new a.bF(g,e.u_image),u_color_ramp:new a.bF(g,e.u_color_ramp),u_opacity:new a.b8(g,e.u_opacity)}),hillshade:(g,e)=>({u_image:new a.bF(g,e.u_image),u_latrange:new a.bK(g,e.u_latrange),u_light:new a.bK(g,e.u_light),u_shadow:new a.bG(g,e.u_shadow),u_highlight:new a.bG(g,e.u_highlight),u_accent:new a.bG(g,e.u_accent)}),hillshadePrepare:(g,e)=>({u_matrix:new a.bH(g,e.u_matrix),u_image:new a.bF(g,e.u_image),u_dimension:new a.bK(g,e.u_dimension),u_zoom:new a.b8(g,e.u_zoom),u_unpack:new a.bI(g,e.u_unpack)}),line:(g,e)=>({u_translation:new a.bK(g,e.u_translation),u_ratio:new a.b8(g,e.u_ratio),u_device_pixel_ratio:new a.b8(g,e.u_device_pixel_ratio),u_units_to_pixels:new a.bK(g,e.u_units_to_pixels)}),lineGradient:(g,e)=>({u_translation:new a.bK(g,e.u_translation),u_ratio:new a.b8(g,e.u_ratio),u_device_pixel_ratio:new a.b8(g,e.u_device_pixel_ratio),u_units_to_pixels:new a.bK(g,e.u_units_to_pixels),u_image:new a.bF(g,e.u_image),u_image_height:new a.b8(g,e.u_image_height)}),linePattern:(g,e)=>({u_translation:new a.bK(g,e.u_translation),u_texsize:new a.bK(g,e.u_texsize),u_ratio:new a.b8(g,e.u_ratio),u_device_pixel_ratio:new a.b8(g,e.u_device_pixel_ratio),u_image:new a.bF(g,e.u_image),u_units_to_pixels:new a.bK(g,e.u_units_to_pixels),u_scale:new a.bJ(g,e.u_scale),u_fade:new a.b8(g,e.u_fade)}),lineSDF:(g,e)=>({u_translation:new a.bK(g,e.u_translation),u_ratio:new a.b8(g,e.u_ratio),u_device_pixel_ratio:new a.b8(g,e.u_device_pixel_ratio),u_units_to_pixels:new a.bK(g,e.u_units_to_pixels),u_patternscale_a:new a.bK(g,e.u_patternscale_a),u_patternscale_b:new a.bK(g,e.u_patternscale_b),u_sdfgamma:new a.b8(g,e.u_sdfgamma),u_image:new a.bF(g,e.u_image),u_tex_y_a:new a.b8(g,e.u_tex_y_a),u_tex_y_b:new a.b8(g,e.u_tex_y_b),u_mix:new a.b8(g,e.u_mix)}),raster:(g,e)=>({u_tl_parent:new a.bK(g,e.u_tl_parent),u_scale_parent:new a.b8(g,e.u_scale_parent),u_buffer_scale:new a.b8(g,e.u_buffer_scale),u_fade_t:new a.b8(g,e.u_fade_t),u_opacity:new a.b8(g,e.u_opacity),u_image0:new a.bF(g,e.u_image0),u_image1:new a.bF(g,e.u_image1),u_brightness_low:new a.b8(g,e.u_brightness_low),u_brightness_high:new a.b8(g,e.u_brightness_high),u_saturation_factor:new a.b8(g,e.u_saturation_factor),u_contrast_factor:new a.b8(g,e.u_contrast_factor),u_spin_weights:new a.bJ(g,e.u_spin_weights),u_coords_top:new a.bI(g,e.u_coords_top),u_coords_bottom:new a.bI(g,e.u_coords_bottom)}),symbolIcon:(g,e)=>({u_is_size_zoom_constant:new a.bF(g,e.u_is_size_zoom_constant),u_is_size_feature_constant:new a.bF(g,e.u_is_size_feature_constant),u_size_t:new a.b8(g,e.u_size_t),u_size:new a.b8(g,e.u_size),u_camera_to_center_distance:new a.b8(g,e.u_camera_to_center_distance),u_pitch:new a.b8(g,e.u_pitch),u_rotate_symbol:new a.bF(g,e.u_rotate_symbol),u_aspect_ratio:new a.b8(g,e.u_aspect_ratio),u_fade_change:new a.b8(g,e.u_fade_change),u_label_plane_matrix:new a.bH(g,e.u_label_plane_matrix),u_coord_matrix:new a.bH(g,e.u_coord_matrix),u_is_text:new a.bF(g,e.u_is_text),u_pitch_with_map:new a.bF(g,e.u_pitch_with_map),u_is_along_line:new a.bF(g,e.u_is_along_line),u_is_variable_anchor:new a.bF(g,e.u_is_variable_anchor),u_texsize:new a.bK(g,e.u_texsize),u_texture:new a.bF(g,e.u_texture),u_translation:new a.bK(g,e.u_translation),u_pitched_scale:new a.b8(g,e.u_pitched_scale)}),symbolSDF:(g,e)=>({u_is_size_zoom_constant:new a.bF(g,e.u_is_size_zoom_constant),u_is_size_feature_constant:new a.bF(g,e.u_is_size_feature_constant),u_size_t:new a.b8(g,e.u_size_t),u_size:new a.b8(g,e.u_size),u_camera_to_center_distance:new a.b8(g,e.u_camera_to_center_distance),u_pitch:new a.b8(g,e.u_pitch),u_rotate_symbol:new a.bF(g,e.u_rotate_symbol),u_aspect_ratio:new a.b8(g,e.u_aspect_ratio),u_fade_change:new a.b8(g,e.u_fade_change),u_label_plane_matrix:new a.bH(g,e.u_label_plane_matrix),u_coord_matrix:new a.bH(g,e.u_coord_matrix),u_is_text:new a.bF(g,e.u_is_text),u_pitch_with_map:new a.bF(g,e.u_pitch_with_map),u_is_along_line:new a.bF(g,e.u_is_along_line),u_is_variable_anchor:new a.bF(g,e.u_is_variable_anchor),u_texsize:new a.bK(g,e.u_texsize),u_texture:new a.bF(g,e.u_texture),u_gamma_scale:new a.b8(g,e.u_gamma_scale),u_device_pixel_ratio:new a.b8(g,e.u_device_pixel_ratio),u_is_halo:new a.bF(g,e.u_is_halo),u_translation:new a.bK(g,e.u_translation),u_pitched_scale:new a.b8(g,e.u_pitched_scale)}),symbolTextAndIcon:(g,e)=>({u_is_size_zoom_constant:new a.bF(g,e.u_is_size_zoom_constant),u_is_size_feature_constant:new a.bF(g,e.u_is_size_feature_constant),u_size_t:new a.b8(g,e.u_size_t),u_size:new a.b8(g,e.u_size),u_camera_to_center_distance:new a.b8(g,e.u_camera_to_center_distance),u_pitch:new a.b8(g,e.u_pitch),u_rotate_symbol:new a.bF(g,e.u_rotate_symbol),u_aspect_ratio:new a.b8(g,e.u_aspect_ratio),u_fade_change:new a.b8(g,e.u_fade_change),u_label_plane_matrix:new a.bH(g,e.u_label_plane_matrix),u_coord_matrix:new a.bH(g,e.u_coord_matrix),u_is_text:new a.bF(g,e.u_is_text),u_pitch_with_map:new a.bF(g,e.u_pitch_with_map),u_is_along_line:new a.bF(g,e.u_is_along_line),u_is_variable_anchor:new a.bF(g,e.u_is_variable_anchor),u_texsize:new a.bK(g,e.u_texsize),u_texsize_icon:new a.bK(g,e.u_texsize_icon),u_texture:new a.bF(g,e.u_texture),u_texture_icon:new a.bF(g,e.u_texture_icon),u_gamma_scale:new a.b8(g,e.u_gamma_scale),u_device_pixel_ratio:new a.b8(g,e.u_device_pixel_ratio),u_is_halo:new a.bF(g,e.u_is_halo),u_translation:new a.bK(g,e.u_translation),u_pitched_scale:new a.b8(g,e.u_pitched_scale)}),background:(g,e)=>({u_opacity:new a.b8(g,e.u_opacity),u_color:new a.bG(g,e.u_color)}),backgroundPattern:(g,e)=>({u_opacity:new a.b8(g,e.u_opacity),u_image:new a.bF(g,e.u_image),u_pattern_tl_a:new a.bK(g,e.u_pattern_tl_a),u_pattern_br_a:new a.bK(g,e.u_pattern_br_a),u_pattern_tl_b:new a.bK(g,e.u_pattern_tl_b),u_pattern_br_b:new a.bK(g,e.u_pattern_br_b),u_texsize:new a.bK(g,e.u_texsize),u_mix:new a.b8(g,e.u_mix),u_pattern_size_a:new a.bK(g,e.u_pattern_size_a),u_pattern_size_b:new a.bK(g,e.u_pattern_size_b),u_scale_a:new a.b8(g,e.u_scale_a),u_scale_b:new a.b8(g,e.u_scale_b),u_pixel_coord_upper:new a.bK(g,e.u_pixel_coord_upper),u_pixel_coord_lower:new a.bK(g,e.u_pixel_coord_lower),u_tile_units_to_pixels:new a.b8(g,e.u_tile_units_to_pixels)}),terrain:(g,e)=>({u_texture:new a.bF(g,e.u_texture),u_ele_delta:new a.b8(g,e.u_ele_delta),u_fog_matrix:new a.bH(g,e.u_fog_matrix),u_fog_color:new a.bG(g,e.u_fog_color),u_fog_ground_blend:new a.b8(g,e.u_fog_ground_blend),u_fog_ground_blend_opacity:new a.b8(g,e.u_fog_ground_blend_opacity),u_horizon_color:new a.bG(g,e.u_horizon_color),u_horizon_fog_blend:new a.b8(g,e.u_horizon_fog_blend),u_is_globe_mode:new a.b8(g,e.u_is_globe_mode)}),terrainDepth:(g,e)=>({u_ele_delta:new a.b8(g,e.u_ele_delta)}),terrainCoords:(g,e)=>({u_texture:new a.bF(g,e.u_texture),u_terrain_coords_id:new a.b8(g,e.u_terrain_coords_id),u_ele_delta:new a.b8(g,e.u_ele_delta)}),projectionErrorMeasurement:(g,e)=>({u_input:new a.b8(g,e.u_input),u_output_expected:new a.b8(g,e.u_output_expected)}),atmosphere:(g,e)=>({u_sun_pos:new a.bJ(g,e.u_sun_pos),u_atmosphere_blend:new a.b8(g,e.u_atmosphere_blend),u_globe_position:new a.bJ(g,e.u_globe_position),u_globe_radius:new a.b8(g,e.u_globe_radius),u_inv_proj_matrix:new a.bH(g,e.u_inv_proj_matrix)}),sky:(g,e)=>({u_sky_color:new a.bG(g,e.u_sky_color),u_horizon_color:new a.bG(g,e.u_horizon_color),u_horizon:new a.bK(g,e.u_horizon),u_horizon_normal:new a.bK(g,e.u_horizon_normal),u_sky_horizon_blend:new a.b8(g,e.u_sky_horizon_blend),u_sky_blend:new a.b8(g,e.u_sky_blend)})};class yu{constructor(e,i,u){this.context=e;const d=e.gl;this.buffer=d.createBuffer(),this.dynamicDraw=!!u,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),d.bufferData(d.ELEMENT_ARRAY_BUFFER,i.arrayBuffer,this.dynamicDraw?d.DYNAMIC_DRAW:d.STATIC_DRAW),this.dynamicDraw||delete i.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const i=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),i.bufferSubData(i.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const vu={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class kd{constructor(e,i,u,d){this.length=i.length,this.attributes=u,this.itemSize=i.bytesPerElement,this.dynamicDraw=d,this.context=e;const _=e.gl;this.buffer=_.createBuffer(),e.bindVertexBuffer.set(this.buffer),_.bufferData(_.ARRAY_BUFFER,i.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||delete i.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const i=this.context.gl;this.bind(),i.bufferSubData(i.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,i){for(let u=0;u<this.attributes.length;u++){const d=i.attributes[this.attributes[u].name];d!==void 0&&e.enableVertexAttribArray(d)}}setVertexAttribPointers(e,i,u){for(let d=0;d<this.attributes.length;d++){const _=this.attributes[d],x=i.attributes[_.name];x!==void 0&&e.vertexAttribPointer(x,_.components,e[vu[_.type]],!1,this.itemSize,_.offset+this.itemSize*(u||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class fr{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class as extends fr{getDefault(){return a.b7.transparent}set(e){const i=this.current;(e.r!==i.r||e.g!==i.g||e.b!==i.b||e.a!==i.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class bu extends fr{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class Gp extends fr{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class Zp extends fr{getDefault(){return[!0,!0,!0,!0]}set(e){const i=this.current;(e[0]!==i[0]||e[1]!==i[1]||e[2]!==i[2]||e[3]!==i[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class qp extends fr{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class Hp extends fr{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class Ld extends fr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const i=this.current;(e.func!==i.func||e.ref!==i.ref||e.mask!==i.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class Wp extends fr{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const i=this.current;(e[0]!==i[0]||e[1]!==i[1]||e[2]!==i[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class zd extends fr{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;e?i.enable(i.STENCIL_TEST):i.disable(i.STENCIL_TEST),this.current=e,this.dirty=!1}}class Hl extends fr{getDefault(){return[0,1]}set(e){const i=this.current;(e[0]!==i[0]||e[1]!==i[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class Wl extends fr{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;e?i.enable(i.DEPTH_TEST):i.disable(i.DEPTH_TEST),this.current=e,this.dirty=!1}}class Kl extends fr{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class xu extends fr{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;e?i.enable(i.BLEND):i.disable(i.BLEND),this.current=e,this.dirty=!1}}class ls extends fr{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const i=this.current;(e[0]!==i[0]||e[1]!==i[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class Xs extends fr{getDefault(){return a.b7.transparent}set(e){const i=this.current;(e.r!==i.r||e.g!==i.g||e.b!==i.b||e.a!==i.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Cn extends fr{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class Rd extends fr{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;e?i.enable(i.CULL_FACE):i.disable(i.CULL_FACE),this.current=e,this.dirty=!1}}class Dd extends fr{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class wu extends fr{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class cs extends fr{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class Xl extends fr{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class Yl extends fr{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const i=this.current;(e[0]!==i[0]||e[1]!==i[1]||e[2]!==i[2]||e[3]!==i[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Ua extends fr{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;i.bindFramebuffer(i.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class Jl extends fr{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;i.bindRenderbuffer(i.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Od extends fr{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;i.bindTexture(i.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class Ys extends fr{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;i.bindBuffer(i.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Js extends fr{getDefault(){return null}set(e){const i=this.gl;i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Fd extends fr{getDefault(){return null}set(e){var i;if(e===this.current&&!this.dirty)return;const u=this.gl;kn(u)?u.bindVertexArray(e):(i=u.getExtension("OES_vertex_array_object"))===null||i===void 0||i.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class Tu extends fr{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;i.pixelStorei(i.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class ur extends fr{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class Ql extends fr{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class Su extends fr{constructor(e,i){super(e),this.context=e,this.parent=i}getDefault(){return null}}class Bd extends Su{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const i=this.gl;i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class Ga extends Su{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const i=this.gl;i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Kp extends Su{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const i=this.gl;i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,e),this.current=e,this.dirty=!1}}const jd="Framebuffer is not complete";class Nd{constructor(e,i,u,d,_){this.context=e,this.width=i,this.height=u;const x=e.gl,T=this.framebuffer=x.createFramebuffer();if(this.colorAttachment=new Bd(e,T),d)this.depthAttachment=_?new Kp(e,T):new Ga(e,T);else if(_)throw new Error("Stencil cannot be set without depth");if(x.checkFramebufferStatus(x.FRAMEBUFFER)!==x.FRAMEBUFFER_COMPLETE)throw new Error(jd)}destroy(){const e=this.context.gl,i=this.colorAttachment.get();if(i&&e.deleteTexture(i),this.depthAttachment){const u=this.depthAttachment.get();u&&e.deleteRenderbuffer(u)}e.deleteFramebuffer(this.framebuffer)}}class Xp{constructor(e){var i,u;if(this.gl=e,this.clearColor=new as(this),this.clearDepth=new bu(this),this.clearStencil=new Gp(this),this.colorMask=new Zp(this),this.depthMask=new qp(this),this.stencilMask=new Hp(this),this.stencilFunc=new Ld(this),this.stencilOp=new Wp(this),this.stencilTest=new zd(this),this.depthRange=new Hl(this),this.depthTest=new Wl(this),this.depthFunc=new Kl(this),this.blend=new xu(this),this.blendFunc=new ls(this),this.blendColor=new Xs(this),this.blendEquation=new Cn(this),this.cullFace=new Rd(this),this.cullFaceSide=new Dd(this),this.frontFace=new wu(this),this.program=new cs(this),this.activeTexture=new Xl(this),this.viewport=new Yl(this),this.bindFramebuffer=new Ua(this),this.bindRenderbuffer=new Jl(this),this.bindTexture=new Od(this),this.bindVertexBuffer=new Ys(this),this.bindElementBuffer=new Js(this),this.bindVertexArray=new Fd(this),this.pixelStoreUnpack=new Tu(this),this.pixelStoreUnpackPremultiplyAlpha=new ur(this),this.pixelStoreUnpackFlipY=new Ql(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),kn(e)){this.HALF_FLOAT=e.HALF_FLOAT;const d=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(i=e.RGBA16F)!==null&&i!==void 0?i:d==null?void 0:d.RGBA16F_EXT,this.RGB16F=(u=e.RGB16F)!==null&&u!==void 0?u:d==null?void 0:d.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const d=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=d==null?void 0:d.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,i){return new yu(this,e,i)}createVertexBuffer(e,i,u){return new kd(this,e,i,u)}createRenderbuffer(e,i,u){const d=this.gl,_=d.createRenderbuffer();return this.bindRenderbuffer.set(_),d.renderbufferStorage(d.RENDERBUFFER,e,i,u),this.bindRenderbuffer.set(null),_}createFramebuffer(e,i,u,d){return new Nd(this,e,i,u,d)}clear({color:e,depth:i,stencil:u}){const d=this.gl;let _=0;e&&(_|=d.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),i!==void 0&&(_|=d.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(i),this.depthMask.set(!0)),u!==void 0&&(_|=d.STENCIL_BUFFER_BIT,this.clearStencil.set(u),this.stencilMask.set(255)),d.clear(_)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){a.bC(e.blendFunction,Rr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return kn(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))===null||e===void 0?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var i;return kn(this.gl)?this.gl.deleteVertexArray(e):(i=this.gl.getExtension("OES_vertex_array_object"))===null||i===void 0?void 0:i.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}let Qs;function Za(g,e,i,u,d){const _=g.context,x=g.transform,T=_.gl,E=g.useProgram("collisionBox"),M=[];let D=0,B=0;for(let oe=0;oe<u.length;oe++){const ce=u[oe],fe=e.getTile(ce).getBucket(i);if(!fe)continue;const me=d?fe.textCollisionBox:fe.iconCollisionBox,ge=fe.collisionCircleArray;ge.length>0&&(M.push({circleArray:ge,circleOffset:B,coord:ce}),D+=ge.length/4,B=D),me&&E.draw(_,T.LINES,Wt.disabled,sr.disabled,g.colorModeForRenderPass(),dr.disabled,Vp(g.transform),g.style.map.terrain&&g.style.map.terrain.getTerrainData(ce),x.getProjectionData({overscaledTileID:ce,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),i.id,me.layoutVertexBuffer,me.indexBuffer,me.segments,null,g.transform.zoom,null,null,me.collisionVertexBuffer)}if(!d||!M.length)return;const O=g.useProgram("collisionCircle"),Z=new a.bP;Z.resize(4*D),Z._trim();let K=0;for(const oe of M)for(let ce=0;ce<oe.circleArray.length/4;ce++){const fe=4*ce,me=oe.circleArray[fe+0],ge=oe.circleArray[fe+1],Te=oe.circleArray[fe+2],_e=oe.circleArray[fe+3];Z.emplace(K++,me,ge,Te,_e,0),Z.emplace(K++,me,ge,Te,_e,1),Z.emplace(K++,me,ge,Te,_e,2),Z.emplace(K++,me,ge,Te,_e,3)}(!Qs||Qs.length<2*D)&&(Qs=function(oe){const ce=2*oe,fe=new a.bR;fe.resize(ce),fe._trim();for(let me=0;me<ce;me++){const ge=6*me;fe.uint16[ge+0]=4*me+0,fe.uint16[ge+1]=4*me+1,fe.uint16[ge+2]=4*me+2,fe.uint16[ge+3]=4*me+2,fe.uint16[ge+4]=4*me+3,fe.uint16[ge+5]=4*me+0}return fe}(D));const ne=_.createIndexBuffer(Qs,!0),ie=_.createVertexBuffer(Z,a.bQ.members,!0);for(const oe of M){const ce=Sd(g.transform);O.draw(_,T.TRIANGLES,Wt.disabled,sr.disabled,g.colorModeForRenderPass(),dr.disabled,ce,g.style.map.terrain&&g.style.map.terrain.getTerrainData(oe.coord),null,i.id,ie,ne,a.aG.simpleSegment(0,2*oe.circleOffset,oe.circleArray.length,oe.circleArray.length/2),null,g.transform.zoom,null,null,null)}ie.destroy(),ne.destroy()}const ec=a.at(new Float32Array(16));function Eu(g,e,i,u,d,_){const{horizontalAlign:x,verticalAlign:T}=a.aB(g);return new a.P((-(x-.5)*e/d+u[0])*_,(-(T-.5)*i/d+u[1])*_)}function Cu(g,e,i,u,d,_){const x=e.tileAnchorPoint.add(new a.P(e.translation[0],e.translation[1]));if(e.pitchWithMap){let T=u.mult(_);i||(T=T.rotate(-d));const E=x.add(T);return Ne(E.x,E.y,e.pitchedLabelPlaneMatrix,e.getElevation).point}if(i){const T=ar(e.tileAnchorPoint.x+1,e.tileAnchorPoint.y,e).point.sub(g),E=Math.atan(T.y/T.x)+(T.x<0?Math.PI:0);return g.add(u.rotate(E))}return g.add(u)}function Vd(g,e,i,u,d,_,x,T,E,M,D,B){const O=g.text.placedSymbolArray,Z=g.text.dynamicLayoutVertexArray,K=g.icon.dynamicLayoutVertexArray,ne={};Z.clear();for(let ie=0;ie<O.length;ie++){const oe=O.get(ie),ce=oe.hidden||!oe.crossTileID||g.allowVerticalPlacement&&!oe.placedOrientation?null:u[oe.crossTileID];if(ce){const fe=new a.P(oe.anchorX,oe.anchorY),me={getElevation:B,width:d.width,height:d.height,pitchedLabelPlaneMatrix:_,pitchWithMap:i,transform:d,tileAnchorPoint:fe,translation:M,unwrappedTileID:D},ge=i?St(fe.x,fe.y,me):ar(fe.x,fe.y,me),Te=ke(d.cameraToCenterDistance,ge.signedDistanceFromCamera);let _e=a.ai(g.textSizeData,T,oe)*Te/a.av;i&&(_e*=g.tilePixelRatio/x);const{width:Oe,height:De,anchor:Ze,textOffset:Ke,textBoxScale:Ue}=ce,ft=Eu(Ze,Oe,De,Ke,Ue,_e),dt=d.getPitchedTextCorrection(fe.x+M[0],fe.y+M[1],D),Je=Cu(ge.point,me,e,ft,-d.bearingInRadians,dt),Et=g.allowVerticalPlacement&&oe.placedOrientation===a.ah.vertical?Math.PI/2:0;for(let Ht=0;Ht<oe.numGlyphs;Ht++)a.ao(Z,Je,Et);E&&oe.associatedIconIndex>=0&&(ne[oe.associatedIconIndex]={shiftedAnchor:Je,angle:Et})}else Ft(oe.numGlyphs,Z)}if(E){K.clear();const ie=g.icon.placedSymbolArray;for(let oe=0;oe<ie.length;oe++){const ce=ie.get(oe);if(ce.hidden)Ft(ce.numGlyphs,K);else{const fe=ne[oe];if(fe)for(let me=0;me<ce.numGlyphs;me++)a.ao(K,fe.shiftedAnchor,fe.angle);else Ft(ce.numGlyphs,K)}}g.icon.dynamicLayoutVertexBuffer.updateData(K)}g.text.dynamicLayoutVertexBuffer.updateData(Z)}function tc(g,e,i){return i.iconsInText&&e?"symbolTextAndIcon":g?"symbolSDF":"symbolIcon"}function qa(g,e,i,u,d,_,x,T,E,M,D,B,O){const Z=g.context,K=Z.gl,ne=g.transform,ie=T==="map",oe=E==="map",ce=T!=="viewport"&&i.layout.get("symbol-placement")!=="point",fe=ie&&!oe&&!ce,me=!i.layout.get("symbol-sort-key").isConstant();let ge=!1;const Te=g.getDepthModeForSublayer(0,Wt.ReadOnly),_e=i._unevaluatedLayout.hasValue("text-variable-anchor")||i._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Oe=[],De=ne.getCircleRadiusCorrection();for(const Ze of u){const Ke=e.getTile(Ze),Ue=Ke.getBucket(i);if(!Ue)continue;const ft=d?Ue.text:Ue.icon;if(!ft||!ft.segments.get().length||!ft.hasVisibleVertices)continue;const dt=ft.programConfigurations.get(i.id),Je=d||Ue.sdfIcons,Et=d?Ue.textSizeData:Ue.iconSizeData,Ht=oe||ne.pitch!==0,mr=g.useProgram(tc(Je,d,Ue),dt),Kt=a.ag(Et,ne.zoom),br=g.style.map.terrain&&g.style.map.terrain.getTerrainData(Ze);let Ar,Or,yr,xr,si=[0,0],_i=null;if(d)Or=Ke.glyphAtlasTexture,yr=K.LINEAR,Ar=Ke.glyphAtlasTexture.size,Ue.iconsInText&&(si=Ke.imageAtlasTexture.size,_i=Ke.imageAtlasTexture,xr=Ht||g.options.rotating||g.options.zooming||Et.kind==="composite"||Et.kind==="camera"?K.LINEAR:K.NEAREST);else{const Jr=i.layout.get("icon-size").constantOr(0)!==1||Ue.iconsNeedLinear;Or=Ke.imageAtlasTexture,yr=Je||g.options.rotating||g.options.zooming||Jr||Ht?K.LINEAR:K.NEAREST,Ar=Ke.imageAtlasTexture.size}const Ei=a.aw(Ke,1,g.transform.zoom),un=ze(ie,g.transform,Ei),go=a.K();a.aj(go,un);const Qn=Ce(oe,ie,g.transform,Ei),Oo=a.ax(ne,Ke,_,x),Fo=ne.getProjectionData({overscaledTileID:Ze,applyGlobeMatrix:!O,applyTerrainMatrix:!0}),_s=_e&&Ue.hasTextData(),eo=i.layout.get("icon-text-fit")!=="none"&&_s&&Ue.hasIconData();if(ce){const Jr=g.style.map.terrain?(di,Er)=>g.style.map.terrain.getElevation(Ze,di,Er):null,Qr=i.layout.get("text-rotation-alignment")==="map";mt(Ue,g,d,un,go,oe,M,Qr,Ze.toUnwrapped(),ne.width,ne.height,Oo,Jr)}const _o=d&&_e||eo,gn=ce||_o?ec:oe?un:g.transform.clipSpaceToPixelsMatrix,yo=Je&&i.paint.get(d?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let ys;ys=Je?Ue.iconsInText?gu(Et.kind,Kt,fe,oe,ce,_o,g,gn,Qn,Oo,Ar,si,De):mu(Et.kind,Kt,fe,oe,ce,_o,g,gn,Qn,Oo,d,Ar,0,De):pu(Et.kind,Kt,fe,oe,ce,_o,g,gn,Qn,Oo,d,Ar,De);const vs={program:mr,buffers:ft,uniformValues:ys,projectionData:Fo,atlasTexture:Or,atlasTextureIcon:_i,atlasInterpolation:yr,atlasInterpolationIcon:xr,isSDF:Je,hasHalo:yo};if(me&&Ue.canOverlap){ge=!0;const Jr=ft.segments.get();for(const Qr of Jr)Oe.push({segments:new a.aG([Qr]),sortKey:Qr.sortKey,state:vs,terrainData:br})}else Oe.push({segments:ft.segments,sortKey:0,state:vs,terrainData:br})}ge&&Oe.sort((Ze,Ke)=>Ze.sortKey-Ke.sortKey);for(const Ze of Oe){const Ke=Ze.state;if(Z.activeTexture.set(K.TEXTURE0),Ke.atlasTexture.bind(Ke.atlasInterpolation,K.CLAMP_TO_EDGE),Ke.atlasTextureIcon&&(Z.activeTexture.set(K.TEXTURE1),Ke.atlasTextureIcon&&Ke.atlasTextureIcon.bind(Ke.atlasInterpolationIcon,K.CLAMP_TO_EDGE)),Ke.isSDF){const Ue=Ke.uniformValues;Ke.hasHalo&&(Ue.u_is_halo=1,rc(Ke.buffers,Ze.segments,i,g,Ke.program,Te,D,B,Ue,Ke.projectionData,Ze.terrainData)),Ue.u_is_halo=0}rc(Ke.buffers,Ze.segments,i,g,Ke.program,Te,D,B,Ke.uniformValues,Ke.projectionData,Ze.terrainData)}}function rc(g,e,i,u,d,_,x,T,E,M,D){const B=u.context;d.draw(B,B.gl.TRIANGLES,_,x,T,dr.backCCW,E,D,M,i.id,g.layoutVertexBuffer,g.indexBuffer,e,i.paint,u.transform.zoom,g.programConfigurations.get(i.id),g.dynamicLayoutVertexBuffer,g.opacityVertexBuffer)}function Yp(g,e,i,u,d){const _=g.context,x=_.gl,T=sr.disabled,E=new Rr([x.ONE,x.ONE],a.b7.transparent,[!0,!0,!0,!0]),M=e.getBucket(i);if(!M)return;const D=u.key;let B=i.heatmapFbos.get(D);B||(B=$d(_,e.tileSize,e.tileSize),i.heatmapFbos.set(D,B)),_.bindFramebuffer.set(B.framebuffer),_.viewport.set([0,0,e.tileSize,e.tileSize]),_.clear({color:a.b7.transparent});const O=M.programConfigurations.get(i.id),Z=g.useProgram("heatmap",O,!d),K=g.transform.getProjectionData({overscaledTileID:e.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),ne=g.style.map.terrain.getTerrainData(u);Z.draw(_,x.TRIANGLES,Wt.disabled,T,E,dr.disabled,du(e,g.transform.zoom,i.paint.get("heatmap-intensity"),1),ne,K,i.id,M.layoutVertexBuffer,M.indexBuffer,M.segments,i.paint,g.transform.zoom,O)}function Iu(g,e,i,u,d){const _=g.context,x=_.gl,T=g.transform;_.setColorMode(g.colorModeForRenderPass());const E=Mu(_,e),M=i.key,D=e.heatmapFbos.get(M);if(!D)return;_.activeTexture.set(x.TEXTURE0),x.bindTexture(x.TEXTURE_2D,D.colorAttachment.get()),_.activeTexture.set(x.TEXTURE1),E.bind(x.LINEAR,x.CLAMP_TO_EDGE);const B=T.getProjectionData({overscaledTileID:i,applyTerrainMatrix:d,applyGlobeMatrix:!u});g.useProgram("heatmapTexture").draw(_,x.TRIANGLES,Wt.disabled,sr.disabled,g.colorModeForRenderPass(),dr.disabled,fu(g,e,0,1),null,B,e.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments,e.paint,T.zoom),D.destroy(),e.heatmapFbos.delete(M)}function $d(g,e,i){var u,d;const _=g.gl,x=_.createTexture();_.bindTexture(_.TEXTURE_2D,x),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,_.CLAMP_TO_EDGE),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,_.CLAMP_TO_EDGE),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,_.LINEAR),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,_.LINEAR);const T=(u=g.HALF_FLOAT)!==null&&u!==void 0?u:_.UNSIGNED_BYTE,E=(d=g.RGBA16F)!==null&&d!==void 0?d:_.RGBA;_.texImage2D(_.TEXTURE_2D,0,E,e,i,0,_.RGBA,T,null);const M=g.createFramebuffer(e,i,!1,!1);return M.colorAttachment.set(x),M}function Mu(g,e){return e.colorRampTexture||(e.colorRampTexture=new Ie(g,e.colorRamp,g.gl.RGBA)),e.colorRampTexture}function Ha(g,e,i,u,d){if(!i||!u||!u.imageAtlas)return;const _=u.imageAtlas.patternPositions;let x=_[i.to.toString()],T=_[i.from.toString()];if(!x&&T&&(x=T),!T&&x&&(T=x),!x||!T){const E=d.getPaintProperty(e);x=_[E],T=_[E]}x&&T&&g.setConstantPatternPositions(x,T)}function ic(g,e,i,u,d,_,x,T){const E=g.context.gl,M="fill-pattern",D=i.paint.get(M),B=D&&D.constantOr(1),O=i.getCrossfadeParameters();let Z,K,ne,ie,oe;const ce=g.transform,fe=i.paint.get("fill-translate"),me=i.paint.get("fill-translate-anchor");x?(K=B&&!i.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Z=E.LINES):(K=B?"fillPattern":"fill",Z=E.TRIANGLES);const ge=D.constantOr(null);for(const Te of u){const _e=e.getTile(Te);if(B&&!_e.patternsLoaded())continue;const Oe=_e.getBucket(i);if(!Oe)continue;const De=Oe.programConfigurations.get(i.id),Ze=g.useProgram(K,De),Ke=g.style.map.terrain&&g.style.map.terrain.getTerrainData(Te);B&&(g.context.activeTexture.set(E.TEXTURE0),_e.imageAtlasTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE),De.updatePaintBuffers(O)),Ha(De,M,ge,_e,i);const Ue=ce.getProjectionData({overscaledTileID:Te,applyGlobeMatrix:!T,applyTerrainMatrix:!0}),ft=a.ax(ce,_e,fe,me);if(x){ie=Oe.indexBuffer2,oe=Oe.segments2;const Je=[E.drawingBufferWidth,E.drawingBufferHeight];ne=K==="fillOutlinePattern"&&B?Np(g,O,_e,Je,ft):Ks(Je,ft)}else ie=Oe.indexBuffer,oe=Oe.segments,ne=B?wd(g,O,_e,ft):{u_fill_translate:ft};let dt;if(g.renderPass==="translucent"&&T){const[Je]=g.getStencilConfigForOverlapAndUpdateStencilID(u);dt=Je[Te.overscaledZ]}else dt=g.stencilModeForClipping(Te);Ze.draw(g.context,Z,d,dt,_,dr.backCCW,ne,Ke,Ue,i.id,Oe.layoutVertexBuffer,ie,oe,i.paint,g.transform.zoom,De)}}function nc(g,e,i,u,d,_,x,T){const E=g.context,M=E.gl,D="fill-extrusion-pattern",B=i.paint.get(D),O=B.constantOr(1),Z=i.getCrossfadeParameters(),K=i.paint.get("fill-extrusion-opacity"),ne=B.constantOr(null),ie=g.transform;for(const oe of u){const ce=e.getTile(oe),fe=ce.getBucket(i);if(!fe)continue;const me=g.style.map.terrain&&g.style.map.terrain.getTerrainData(oe),ge=fe.programConfigurations.get(i.id),Te=g.useProgram(O?"fillExtrusionPattern":"fillExtrusion",ge);O&&(g.context.activeTexture.set(M.TEXTURE0),ce.imageAtlasTexture.bind(M.LINEAR,M.CLAMP_TO_EDGE),ge.updatePaintBuffers(Z));const _e=ie.getProjectionData({overscaledTileID:oe,applyGlobeMatrix:!T,applyTerrainMatrix:!0});Ha(ge,D,ne,ce,i);const Oe=a.ax(ie,ce,i.paint.get("fill-extrusion-translate"),i.paint.get("fill-extrusion-translate-anchor")),De=i.paint.get("fill-extrusion-vertical-gradient"),Ze=O?Ul(g,De,K,Oe,oe,Z,ce):xd(g,De,K,Oe);Te.draw(E,E.gl.TRIANGLES,d,_,x,dr.backCCW,Ze,me,_e,i.id,fe.layoutVertexBuffer,fe.indexBuffer,fe.segments,i.paint,g.transform.zoom,ge,g.style.map.terrain&&fe.centroidVertexBuffer)}}function oc(g,e,i,u,d,_,x,T,E){var M;const D=g.style.projection,B=g.context,O=g.transform,Z=B.gl,K=g.useProgram("hillshade"),ne=!g.options.moving;for(const ie of u){const oe=e.getTile(ie),ce=oe.fbo;if(!ce)continue;const fe=D.getMeshFromTileID(B,ie.canonical,T,!0,"raster"),me=(M=g.style.map.terrain)===null||M===void 0?void 0:M.getTerrainData(ie);B.activeTexture.set(Z.TEXTURE0),Z.bindTexture(Z.TEXTURE_2D,ce.colorAttachment.get());const ge=O.getProjectionData({overscaledTileID:ie,aligned:ne,applyGlobeMatrix:!E,applyTerrainMatrix:!0});K.draw(B,Z.TRIANGLES,_,d[ie.overscaledZ],x,dr.backCCW,Ed(g,oe,i),me,ge,i.id,fe.vertexBuffer,fe.indexBuffer,fe.segments)}}const ea=[new a.P(0,0),new a.P(a.Z,0),new a.P(a.Z,a.Z),new a.P(0,a.Z)];function ta(g,e,i,u,d,_,x,T,E=!1,M=!1){const D=u[u.length-1].overscaledZ,B=g.context,O=B.gl,Z=g.useProgram("raster"),K=g.transform,ne=g.style.projection,ie=g.colorModeForRenderPass(),oe=!g.options.moving;for(const ce of u){const fe=g.getDepthModeForSublayer(ce.overscaledZ-D,i.paint.get("raster-opacity")===1?Wt.ReadWrite:Wt.ReadOnly,O.LESS),me=e.getTile(ce);me.registerFadeDuration(i.paint.get("raster-fade-duration"));const ge=e.findLoadedParent(ce,0),Te=e.findLoadedSibling(ce),_e=Jp(me,ge||Te||null,e,i,g.transform,g.style.map.terrain);let Oe,De;const Ze=i.paint.get("raster-resampling")==="nearest"?O.NEAREST:O.LINEAR;B.activeTexture.set(O.TEXTURE0),me.texture.bind(Ze,O.CLAMP_TO_EDGE,O.LINEAR_MIPMAP_NEAREST),B.activeTexture.set(O.TEXTURE1),ge?(ge.texture.bind(Ze,O.CLAMP_TO_EDGE,O.LINEAR_MIPMAP_NEAREST),Oe=Math.pow(2,ge.tileID.overscaledZ-me.tileID.overscaledZ),De=[me.tileID.canonical.x*Oe%1,me.tileID.canonical.y*Oe%1]):me.texture.bind(Ze,O.CLAMP_TO_EDGE,O.LINEAR_MIPMAP_NEAREST),me.texture.useMipmap&&B.extTextureFilterAnisotropic&&g.transform.pitch>20&&O.texParameterf(O.TEXTURE_2D,B.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,B.extTextureFilterAnisotropicMax);const Ke=g.style.map.terrain&&g.style.map.terrain.getTerrainData(ce),Ue=K.getProjectionData({overscaledTileID:ce,aligned:oe,applyGlobeMatrix:!M,applyTerrainMatrix:!0}),ft=Up(De||[0,0],Oe||1,_e,i,T),dt=ne.getMeshFromTileID(B,ce.canonical,_,x,"raster");Z.draw(B,O.TRIANGLES,fe,d?d[ce.overscaledZ]:sr.disabled,ie,E?dr.frontCCW:dr.backCCW,ft,Ke,Ue,i.id,dt.vertexBuffer,dt.indexBuffer,dt.segments)}}function Jp(g,e,i,u,d,_){const x=u.paint.get("raster-fade-duration");if(!_&&x>0){const T=N.now(),E=(T-g.timeAdded)/x,M=e?(T-e.timeAdded)/x:-1,D=i.getSource(),B=Ki(d,{tileSize:D.tileSize,roundZoom:D.roundZoom}),O=!e||Math.abs(e.tileID.overscaledZ-B)>Math.abs(g.tileID.overscaledZ-B),Z=O&&g.refreshedUponExpiration?1:a.ae(O?E:1-M,0,1);return g.refreshedUponExpiration&&E>=1&&(g.refreshedUponExpiration=!1),e?{opacity:1,mix:1-Z}:{opacity:Z,mix:0}}return{opacity:1,mix:0}}const Ud=new a.b7(1,0,0,1),ni=new a.b7(0,1,0,1),us=new a.b7(0,0,1,1),In=new a.b7(1,0,1,1),Pu=new a.b7(0,1,1,1);function sc(g,e,i,u){po(g,0,e+i/2,g.transform.width,i,u)}function Au(g,e,i,u){po(g,e-i/2,0,i,g.transform.height,u)}function po(g,e,i,u,d,_){const x=g.context,T=x.gl;T.enable(T.SCISSOR_TEST),T.scissor(e*g.pixelRatio,i*g.pixelRatio,u*g.pixelRatio,d*g.pixelRatio),x.clear({color:_}),T.disable(T.SCISSOR_TEST)}function Wa(g,e,i){const u=g.context,d=u.gl,_=g.useProgram("debug"),x=Wt.disabled,T=sr.disabled,E=g.colorModeForRenderPass(),M="$debug",D=g.style.map.terrain&&g.style.map.terrain.getTerrainData(i);u.activeTexture.set(d.TEXTURE0);const B=e.getTileByID(i.key).latestRawTileData,O=Math.floor((B&&B.byteLength||0)/1024),Z=e.getTile(i).tileSize,K=512/Math.min(Z,512)*(i.overscaledZ/g.transform.zoom)*.5;let ne=i.canonical.toString();i.overscaledZ!==i.canonical.z&&(ne+=` => ${i.overscaledZ}`),function(oe,ce){oe.initDebugOverlayCanvas();const fe=oe.debugOverlayCanvas,me=oe.context.gl,ge=oe.debugOverlayCanvas.getContext("2d");ge.clearRect(0,0,fe.width,fe.height),ge.shadowColor="white",ge.shadowBlur=2,ge.lineWidth=1.5,ge.strokeStyle="white",ge.textBaseline="top",ge.font="bold 36px Open Sans, sans-serif",ge.fillText(ce,5,5),ge.strokeText(ce,5,5),oe.debugOverlayTexture.update(fe),oe.debugOverlayTexture.bind(me.LINEAR,me.CLAMP_TO_EDGE)}(g,`${ne} ${O}kB`);const ie=g.transform.getProjectionData({overscaledTileID:i,applyGlobeMatrix:!0,applyTerrainMatrix:!0});_.draw(u,d.TRIANGLES,x,T,Rr.alphaBlended,dr.disabled,Gl(a.b7.transparent,K),null,ie,M,g.debugBuffer,g.quadTriangleIndexBuffer,g.debugSegments),_.draw(u,d.LINE_STRIP,x,T,E,dr.disabled,Gl(a.b7.red),D,ie,M,g.debugBuffer,g.tileBorderIndexBuffer,g.debugSegments)}function ac(g,e,i,u){const{isRenderingGlobe:d}=u,_=g.context,x=_.gl,T=g.transform,E=g.colorModeForRenderPass(),M=g.getDepthModeFor3D(),D=g.useProgram("terrain");_.bindFramebuffer.set(null),_.viewport.set([0,0,g.width,g.height]);for(const B of i){const O=e.getTerrainMesh(B.tileID),Z=g.renderToTexture.getTexture(B),K=e.getTerrainData(B.tileID);_.activeTexture.set(x.TEXTURE0),x.bindTexture(x.TEXTURE_2D,Z.texture);const ne=e.getMeshFrameDelta(T.zoom),ie=T.calculateFogMatrix(B.tileID.toUnwrapped()),oe=Wn(ne,ie,g.style.sky,T.pitch,d),ce=T.getProjectionData({overscaledTileID:B.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});D.draw(_,x.TRIANGLES,M,sr.disabled,E,dr.backCCW,oe,K,ce,"terrain",O.vertexBuffer,O.indexBuffer,O.segments)}}function ku(g,e){if(!e.mesh){const i=new a.aF;i.emplaceBack(-1,-1),i.emplaceBack(1,-1),i.emplaceBack(1,1),i.emplaceBack(-1,1);const u=new a.aH;u.emplaceBack(0,1,2),u.emplaceBack(0,2,3),e.mesh=new is(g.createVertexBuffer(i,Lo.members),g.createIndexBuffer(u),a.aG.simpleSegment(0,0,i.length,u.length))}return e.mesh}class Gd{constructor(e,i){this.context=new Xp(e),this.transform=i,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:a.at(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=q.maxUnderzooming+q.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Ol}resize(e,i,u){if(this.width=Math.floor(e*u),this.height=Math.floor(i*u),this.pixelRatio=u,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const d of this.style._order)this.style._layers[d].resize()}setup(){const e=this.context,i=new a.aF;i.emplaceBack(0,0),i.emplaceBack(a.Z,0),i.emplaceBack(0,a.Z),i.emplaceBack(a.Z,a.Z),this.tileExtentBuffer=e.createVertexBuffer(i,Lo.members),this.tileExtentSegments=a.aG.simpleSegment(0,0,4,2);const u=new a.aF;u.emplaceBack(0,0),u.emplaceBack(a.Z,0),u.emplaceBack(0,a.Z),u.emplaceBack(a.Z,a.Z),this.debugBuffer=e.createVertexBuffer(u,Lo.members),this.debugSegments=a.aG.simpleSegment(0,0,4,5);const d=new a.bW;d.emplaceBack(0,0,0,0),d.emplaceBack(a.Z,0,a.Z,0),d.emplaceBack(0,a.Z,0,a.Z),d.emplaceBack(a.Z,a.Z,a.Z,a.Z),this.rasterBoundsBuffer=e.createVertexBuffer(d,uu.members),this.rasterBoundsSegments=a.aG.simpleSegment(0,0,4,2);const _=new a.aF;_.emplaceBack(0,0),_.emplaceBack(a.Z,0),_.emplaceBack(0,a.Z),_.emplaceBack(a.Z,a.Z),this.rasterBoundsBufferPosOnly=e.createVertexBuffer(_,Lo.members),this.rasterBoundsSegmentsPosOnly=a.aG.simpleSegment(0,0,4,5);const x=new a.aF;x.emplaceBack(0,0),x.emplaceBack(1,0),x.emplaceBack(0,1),x.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(x,Lo.members),this.viewportSegments=a.aG.simpleSegment(0,0,4,2);const T=new a.bX;T.emplaceBack(0),T.emplaceBack(1),T.emplaceBack(3),T.emplaceBack(2),T.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(T);const E=new a.aH;E.emplaceBack(1,0,2),E.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(E);const M=this.context.gl;this.stencilClearMode=new sr({func:M.ALWAYS,mask:0},0,255,M.ZERO,M.ZERO,M.ZERO),this.tileExtentMesh=new is(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const e=this.context,i=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const u=a.K();a.bO(u,0,this.width,this.height,0,0,1),a.M(u,u,[i.drawingBufferWidth,i.drawingBufferHeight,0]);const d={mainMatrix:u,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:u};this.useProgram("clippingMask",null,!0).draw(e,i.TRIANGLES,Wt.disabled,this.stencilClearMode,Rr.disabled,dr.disabled,null,null,d,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,i,u){if(this.currentStencilSource===e.source||!e.isTileClipped()||!i||!i.length)return;this.currentStencilSource=e.source,this.nextStencilID+i.length>256&&this.clearStencil();const d=this.context;d.setColorMode(Rr.disabled),d.setDepthMode(Wt.disabled);const _={};for(const x of i)_[x.key]=this.nextStencilID++;this._renderTileMasks(_,i,u,!0),this._renderTileMasks(_,i,u,!1),this._tileClippingMaskIDs=_}_renderTileMasks(e,i,u,d){const _=this.context,x=_.gl,T=this.style.projection,E=this.transform,M=this.useProgram("clippingMask");for(const D of i){const B=e[D.key],O=this.style.map.terrain&&this.style.map.terrain.getTerrainData(D),Z=T.getMeshFromTileID(this.context,D.canonical,d,!0,"stencil"),K=E.getProjectionData({overscaledTileID:D,applyGlobeMatrix:!0,applyTerrainMatrix:!0});M.draw(_,x.TRIANGLES,Wt.disabled,new sr({func:x.ALWAYS,mask:0},B,255,x.KEEP,x.KEEP,x.REPLACE),Rr.disabled,u?dr.disabled:dr.backCCW,null,O,K,"$clipping",Z.vertexBuffer,Z.indexBuffer,Z.segments)}}_renderTilesDepthBuffer(){const e=this.context,i=e.gl,u=this.style.projection,d=this.transform,_=this.useProgram("depth"),x=this.getDepthModeFor3D(),T=Pe(d,{tileSize:d.tileSize});for(const E of T){const M=this.style.map.terrain&&this.style.map.terrain.getTerrainData(E),D=u.getMeshFromTileID(this.context,E.canonical,!0,!0,"raster"),B=d.getProjectionData({overscaledTileID:E,applyGlobeMatrix:!0,applyTerrainMatrix:!0});_.draw(e,i.TRIANGLES,x,sr.disabled,Rr.disabled,dr.backCCW,null,M,B,"$clipping",D.vertexBuffer,D.indexBuffer,D.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,i=this.context.gl;return new sr({func:i.NOTEQUAL,mask:255},e,255,i.KEEP,i.KEEP,i.REPLACE)}stencilModeForClipping(e){const i=this.context.gl;return new sr({func:i.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,i.KEEP,i.KEEP,i.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(e){const i=this.context.gl,u=e.sort((x,T)=>T.overscaledZ-x.overscaledZ),d=u[u.length-1].overscaledZ,_=u[0].overscaledZ-d+1;if(_>1){this.currentStencilSource=void 0,this.nextStencilID+_>256&&this.clearStencil();const x={};for(let T=0;T<_;T++)x[T+d]=new sr({func:i.GEQUAL,mask:255},T+this.nextStencilID,255,i.KEEP,i.KEEP,i.REPLACE);return this.nextStencilID+=_,[x,u]}return[{[d]:sr.disabled},u]}stencilConfigForOverlapTwoPass(e){const i=this.context.gl,u=e.sort((x,T)=>T.overscaledZ-x.overscaledZ),d=u[u.length-1].overscaledZ,_=u[0].overscaledZ-d+1;if(this.clearStencil(),_>1){const x={},T={};for(let E=0;E<_;E++)x[E+d]=new sr({func:i.GREATER,mask:255},_+1+E,255,i.KEEP,i.KEEP,i.REPLACE),T[E+d]=new sr({func:i.GREATER,mask:255},1+E,255,i.KEEP,i.KEEP,i.REPLACE);return this.nextStencilID=2*_+1,[x,T,u]}return this.nextStencilID=3,[{[d]:new sr({func:i.GREATER,mask:255},2,255,i.KEEP,i.KEEP,i.REPLACE)},{[d]:new sr({func:i.GREATER,mask:255},1,255,i.KEEP,i.KEEP,i.REPLACE)},u]}colorModeForRenderPass(){const e=this.context.gl;return this._showOverdrawInspector?new Rr([e.CONSTANT_COLOR,e.ONE],new a.b7(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Rr.unblended:Rr.alphaBlended}getDepthModeForSublayer(e,i,u){if(!this.opaquePassEnabledForLayer())return Wt.disabled;const d=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new Wt(u||this.context.gl.LEQUAL,i,[d,d])}getDepthModeFor3D(){return new Wt(this.context.gl.LEQUAL,Wt.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,i){var u,d;this.style=e,this.options=i,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(N.now()),this.imageManager.beginFrame();const _=this.style._order,x=this.style.sourceCaches,T={},E={},M={},D={isRenderingToTexture:!1,isRenderingGlobe:((u=e.projection)===null||u===void 0?void 0:u.transitionState)>0};for(const O in x){const Z=x[O];Z.used&&Z.prepare(this.context),T[O]=Z.getVisibleCoordinates(!1),E[O]=T[O].slice().reverse(),M[O]=Z.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let O=0;O<_.length;O++)if(this.style._layers[_[O]].is3D()){this.opaquePassCutoff=O;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const O of _){const Z=this.style._layers[O];if(!Z.hasOffscreenPass()||Z.isHidden(this.transform.zoom))continue;const K=E[Z.source];(Z.type==="custom"||K.length)&&this.renderLayer(this,x[Z.source],Z,K,D)}if((d=this.style.projection)===null||d===void 0||d.updateGPUdependent({context:this.context,useProgram:O=>this.useProgram(O)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:i.showOverdrawInspector?a.b7.black:a.b7.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(O,Z){const K=O.context,ne=K.gl,ie=((Te,_e,Oe)=>{const De=Math.cos(_e.rollInRadians),Ze=Math.sin(_e.rollInRadians),Ke=Ns(_e),Ue=_e.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:Te.properties.get("sky-color"),u_horizon_color:Te.properties.get("horizon-color"),u_horizon:[(_e.width/2-Ke*Ze)*Oe,(_e.height/2+Ke*De)*Oe],u_horizon_normal:[-Ze,De],u_sky_horizon_blend:Te.properties.get("sky-horizon-blend")*_e.height/2*Oe,u_sky_blend:Ue}})(Z,O.style.map.transform,O.pixelRatio),oe=new Wt(ne.LEQUAL,Wt.ReadWrite,[0,1]),ce=sr.disabled,fe=O.colorModeForRenderPass(),me=O.useProgram("sky"),ge=ku(K,Z);me.draw(K,ne.TRIANGLES,oe,ce,fe,dr.disabled,ie,null,void 0,"sky",ge.vertexBuffer,ge.indexBuffer,ge.segments)}(this,this.style.sky),this._showOverdrawInspector=i.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=_.length-1;this.currentLayer>=0;this.currentLayer--){const O=this.style._layers[_[this.currentLayer]],Z=x[O.source],K=T[O.source];this._renderTileClippingMasks(O,K,!1),this.renderLayer(this,Z,O,K,D)}this.renderPass="translucent";let B=!1;for(this.currentLayer=0;this.currentLayer<_.length;this.currentLayer++){const O=this.style._layers[_[this.currentLayer]],Z=x[O.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(O,D))continue;this.opaquePassEnabledForLayer()||B||(B=!0,D.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const K=(O.type==="symbol"?M:E)[O.source];this._renderTileClippingMasks(O,T[O.source],!1),this.renderLayer(this,Z,O,K,D)}if(D.isRenderingGlobe&&function(O,Z,K){const ne=O.context,ie=ne.gl,oe=O.useProgram("atmosphere"),ce=new Wt(ie.LEQUAL,Wt.ReadOnly,[0,1]),fe=O.transform,me=function(Ue,ft){const dt=Ue.properties.get("position"),Je=[-dt.x,-dt.y,-dt.z],Et=a.at(new Float64Array(16));return Ue.properties.get("anchor")==="map"&&(a.a_(Et,Et,ft.rollInRadians),a.a$(Et,Et,-ft.pitchInRadians),a.a_(Et,Et,ft.bearingInRadians),a.a$(Et,Et,ft.center.lat*Math.PI/180),a.bm(Et,Et,-ft.center.lng*Math.PI/180)),a.bV(Je,Je,Et),Je}(K,O.transform),ge=fe.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Te=Z.properties.get("atmosphere-blend")*ge.projectionTransition;if(Te===0)return;const _e=Nl(fe.worldSize,fe.center.lat),Oe=fe.inverseProjectionMatrix,De=new Float64Array(4);De[3]=1,a.ap(De,De,fe.modelViewProjectionMatrix),De[0]/=De[3],De[1]/=De[3],De[2]/=De[3],De[3]=1,a.ap(De,De,Oe),De[0]/=De[3],De[1]/=De[3],De[2]/=De[3],De[3]=1;const Ze=((Ue,ft,dt,Je,Et)=>({u_sun_pos:Ue,u_atmosphere_blend:ft,u_globe_position:dt,u_globe_radius:Je,u_inv_proj_matrix:Et}))(me,Te,[De[0],De[1],De[2]],_e,Oe),Ke=ku(ne,Z);oe.draw(ne,ie.TRIANGLES,ce,sr.disabled,Rr.alphaBlended,dr.disabled,Ze,null,null,"atmosphere",Ke.vertexBuffer,Ke.indexBuffer,Ke.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const O=function(Z,K){let ne=null;const ie=Object.values(Z._layers).flatMap(me=>me.source&&!me.isHidden(K)?[Z.sourceCaches[me.source]]:[]),oe=ie.filter(me=>me.getSource().type==="vector"),ce=ie.filter(me=>me.getSource().type!=="vector"),fe=me=>{(!ne||ne.getSource().maxzoom<me.getSource().maxzoom)&&(ne=me)};return oe.forEach(me=>fe(me)),ne||ce.forEach(me=>fe(me)),ne}(this.style,this.transform.zoom);O&&function(Z,K,ne){for(let ie=0;ie<ne.length;ie++)Wa(Z,K,ne[ie])}(this,O,O.getVisibleCoordinates())}this.options.showPadding&&function(O){const Z=O.transform.padding;sc(O,O.transform.height-(Z.top||0),3,Ud),sc(O,Z.bottom||0,3,ni),Au(O,Z.left||0,3,us),Au(O,O.transform.width-(Z.right||0),3,In);const K=O.transform.centerPoint;(function(ne,ie,oe,ce){po(ne,ie-1,oe-10,2,20,ce),po(ne,ie-10,oe-1,20,2,ce)})(O,K.x,O.transform.height-K.y,Pu)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const i=this.terrainFacilitator.matrix,u=this.transform.modelViewProjectionMatrix;let d=this.terrainFacilitator.dirty;d||(d=e?!a.bY(i,u):!a.bZ(i,u)),d||(d=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),d&&(a.b_(i,u),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(_,x){const T=_.context,E=T.gl,M=_.transform,D=Rr.unblended,B=new Wt(E.LEQUAL,Wt.ReadWrite,[0,1]),O=x.sourceCache.getRenderableTiles(),Z=_.useProgram("terrainDepth");T.bindFramebuffer.set(x.getFramebuffer("depth").framebuffer),T.viewport.set([0,0,_.width/devicePixelRatio,_.height/devicePixelRatio]),T.clear({color:a.b7.transparent,depth:1});for(const K of O){const ne=x.getTerrainMesh(K.tileID),ie=x.getTerrainData(K.tileID),oe=M.getProjectionData({overscaledTileID:K.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),ce={u_ele_delta:x.getMeshFrameDelta(M.zoom)};Z.draw(T,E.TRIANGLES,B,sr.disabled,D,dr.backCCW,ce,ie,oe,"terrain",ne.vertexBuffer,ne.indexBuffer,ne.segments)}T.bindFramebuffer.set(null),T.viewport.set([0,0,_.width,_.height])}(this,this.style.map.terrain),function(_,x){const T=_.context,E=T.gl,M=_.transform,D=Rr.unblended,B=new Wt(E.LEQUAL,Wt.ReadWrite,[0,1]),O=x.getCoordsTexture(),Z=x.sourceCache.getRenderableTiles(),K=_.useProgram("terrainCoords");T.bindFramebuffer.set(x.getFramebuffer("coords").framebuffer),T.viewport.set([0,0,_.width/devicePixelRatio,_.height/devicePixelRatio]),T.clear({color:a.b7.transparent,depth:1}),x.coordsIndex=[];for(const ne of Z){const ie=x.getTerrainMesh(ne.tileID),oe=x.getTerrainData(ne.tileID);T.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,O.texture);const ce={u_terrain_coords_id:(255-x.coordsIndex.length)/255,u_texture:0,u_ele_delta:x.getMeshFrameDelta(M.zoom)},fe=M.getProjectionData({overscaledTileID:ne.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});K.draw(T,E.TRIANGLES,B,sr.disabled,D,dr.backCCW,ce,oe,fe,"terrain",ie.vertexBuffer,ie.indexBuffer,ie.segments),x.coordsIndex.push(ne.tileID.key)}T.bindFramebuffer.set(null),T.viewport.set([0,0,_.width,_.height])}(this,this.style.map.terrain))}renderLayer(e,i,u,d,_){u.isHidden(this.transform.zoom)||(u.type==="background"||u.type==="custom"||(d||[]).length)&&(this.id=u.id,a.b$(u)?function(x,T,E,M,D,B){if(x.renderPass!=="translucent")return;const{isRenderingToTexture:O}=B,Z=sr.disabled,K=x.colorModeForRenderPass();(E._unevaluatedLayout.hasValue("text-variable-anchor")||E._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(ne,ie,oe,ce,fe,me,ge,Te,_e){const Oe=ie.transform,De=ie.style.map.terrain,Ze=fe==="map",Ke=me==="map";for(const Ue of ne){const ft=ce.getTile(Ue),dt=ft.getBucket(oe);if(!dt||!dt.text||!dt.text.segments.get().length)continue;const Je=a.ag(dt.textSizeData,Oe.zoom),Et=a.aw(ft,1,ie.transform.zoom),Ht=ze(Ze,ie.transform,Et),mr=oe.layout.get("icon-text-fit")!=="none"&&dt.hasIconData();if(Je){const Kt=Math.pow(2,Oe.zoom-ft.tileID.overscaledZ),br=De?(Ar,Or)=>De.getElevation(Ue,Ar,Or):null;Vd(dt,Ze,Ke,_e,Oe,Ht,Kt,Je,mr,a.ax(Oe,ft,ge,Te),Ue.toUnwrapped(),br)}}}(M,x,E,T,E.layout.get("text-rotation-alignment"),E.layout.get("text-pitch-alignment"),E.paint.get("text-translate"),E.paint.get("text-translate-anchor"),D),E.paint.get("icon-opacity").constantOr(1)!==0&&qa(x,T,E,M,!1,E.paint.get("icon-translate"),E.paint.get("icon-translate-anchor"),E.layout.get("icon-rotation-alignment"),E.layout.get("icon-pitch-alignment"),E.layout.get("icon-keep-upright"),Z,K,O),E.paint.get("text-opacity").constantOr(1)!==0&&qa(x,T,E,M,!0,E.paint.get("text-translate"),E.paint.get("text-translate-anchor"),E.layout.get("text-rotation-alignment"),E.layout.get("text-pitch-alignment"),E.layout.get("text-keep-upright"),Z,K,O),T.map.showCollisionBoxes&&(Za(x,T,E,M,!0),Za(x,T,E,M,!1))}(e,i,u,d,this.style.placement.variableOffsets,_):a.c0(u)?function(x,T,E,M,D){if(x.renderPass!=="translucent")return;const{isRenderingToTexture:B}=D,O=E.paint.get("circle-opacity"),Z=E.paint.get("circle-stroke-width"),K=E.paint.get("circle-stroke-opacity"),ne=!E.layout.get("circle-sort-key").isConstant();if(O.constantOr(1)===0&&(Z.constantOr(1)===0||K.constantOr(1)===0))return;const ie=x.context,oe=ie.gl,ce=x.transform,fe=x.getDepthModeForSublayer(0,Wt.ReadOnly),me=sr.disabled,ge=x.colorModeForRenderPass(),Te=[],_e=ce.getCircleRadiusCorrection();for(let Oe=0;Oe<M.length;Oe++){const De=M[Oe],Ze=T.getTile(De),Ke=Ze.getBucket(E);if(!Ke)continue;const Ue=E.paint.get("circle-translate"),ft=E.paint.get("circle-translate-anchor"),dt=a.ax(ce,Ze,Ue,ft),Je=Ke.programConfigurations.get(E.id),Et=x.useProgram("circle",Je),Ht=Ke.layoutVertexBuffer,mr=Ke.indexBuffer,Kt=x.style.map.terrain&&x.style.map.terrain.getTerrainData(De),br={programConfiguration:Je,program:Et,layoutVertexBuffer:Ht,indexBuffer:mr,uniformValues:Td(x,Ze,E,dt,_e),terrainData:Kt,projectionData:ce.getProjectionData({overscaledTileID:De,applyGlobeMatrix:!B,applyTerrainMatrix:!0})};if(ne){const Ar=Ke.segments.get();for(const Or of Ar)Te.push({segments:new a.aG([Or]),sortKey:Or.sortKey,state:br})}else Te.push({segments:Ke.segments,sortKey:0,state:br})}ne&&Te.sort((Oe,De)=>Oe.sortKey-De.sortKey);for(const Oe of Te){const{programConfiguration:De,program:Ze,layoutVertexBuffer:Ke,indexBuffer:Ue,uniformValues:ft,terrainData:dt,projectionData:Je}=Oe.state;Ze.draw(ie,oe.TRIANGLES,fe,me,ge,dr.backCCW,ft,dt,Je,E.id,Ke,Ue,Oe.segments,E.paint,x.transform.zoom,De)}}(e,i,u,d,_):a.c1(u)?function(x,T,E,M,D){if(E.paint.get("heatmap-opacity")===0)return;const B=x.context,{isRenderingToTexture:O,isRenderingGlobe:Z}=D;if(x.style.map.terrain){for(const K of M){const ne=T.getTile(K);T.hasRenderableParent(K)||(x.renderPass==="offscreen"?Yp(x,ne,E,K,Z):x.renderPass==="translucent"&&Iu(x,E,K,O,Z))}B.viewport.set([0,0,x.width,x.height])}else x.renderPass==="offscreen"?function(K,ne,ie,oe){const ce=K.context,fe=ce.gl,me=K.transform,ge=sr.disabled,Te=new Rr([fe.ONE,fe.ONE],a.b7.transparent,[!0,!0,!0,!0]);(function(_e,Oe,De){const Ze=_e.gl;_e.activeTexture.set(Ze.TEXTURE1),_e.viewport.set([0,0,Oe.width/4,Oe.height/4]);let Ke=De.heatmapFbos.get(a.bS);Ke?(Ze.bindTexture(Ze.TEXTURE_2D,Ke.colorAttachment.get()),_e.bindFramebuffer.set(Ke.framebuffer)):(Ke=$d(_e,Oe.width/4,Oe.height/4),De.heatmapFbos.set(a.bS,Ke))})(ce,K,ie),ce.clear({color:a.b7.transparent});for(let _e=0;_e<oe.length;_e++){const Oe=oe[_e];if(ne.hasRenderableParent(Oe))continue;const De=ne.getTile(Oe),Ze=De.getBucket(ie);if(!Ze)continue;const Ke=Ze.programConfigurations.get(ie.id),Ue=K.useProgram("heatmap",Ke),ft=me.getProjectionData({overscaledTileID:Oe,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),dt=me.getCircleRadiusCorrection();Ue.draw(ce,fe.TRIANGLES,Wt.disabled,ge,Te,dr.backCCW,du(De,me.zoom,ie.paint.get("heatmap-intensity"),dt),null,ft,ie.id,Ze.layoutVertexBuffer,Ze.indexBuffer,Ze.segments,ie.paint,me.zoom,Ke)}ce.viewport.set([0,0,K.width,K.height])}(x,T,E,M):x.renderPass==="translucent"&&function(K,ne){const ie=K.context,oe=ie.gl;ie.setColorMode(K.colorModeForRenderPass());const ce=ne.heatmapFbos.get(a.bS);ce&&(ie.activeTexture.set(oe.TEXTURE0),oe.bindTexture(oe.TEXTURE_2D,ce.colorAttachment.get()),ie.activeTexture.set(oe.TEXTURE1),Mu(ie,ne).bind(oe.LINEAR,oe.CLAMP_TO_EDGE),K.useProgram("heatmapTexture").draw(ie,oe.TRIANGLES,Wt.disabled,sr.disabled,K.colorModeForRenderPass(),dr.disabled,fu(K,ne,0,1),null,null,ne.id,K.viewportBuffer,K.quadTriangleIndexBuffer,K.viewportSegments,ne.paint,K.transform.zoom))}(x,E)}(e,i,u,d,_):a.c2(u)?function(x,T,E,M,D){if(x.renderPass!=="translucent")return;const{isRenderingToTexture:B}=D,O=E.paint.get("line-opacity"),Z=E.paint.get("line-width");if(O.constantOr(1)===0||Z.constantOr(1)===0)return;const K=x.getDepthModeForSublayer(0,Wt.ReadOnly),ne=x.colorModeForRenderPass(),ie=E.paint.get("line-dasharray"),oe=E.paint.get("line-pattern"),ce=oe.constantOr(1),fe=E.paint.get("line-gradient"),me=E.getCrossfadeParameters(),ge=ce?"linePattern":ie?"lineSDF":fe?"lineGradient":"line",Te=x.context,_e=Te.gl,Oe=x.transform;let De=!0;for(const Ze of M){const Ke=T.getTile(Ze);if(ce&&!Ke.patternsLoaded())continue;const Ue=Ke.getBucket(E);if(!Ue)continue;const ft=Ue.programConfigurations.get(E.id),dt=x.context.program.get(),Je=x.useProgram(ge,ft),Et=De||Je.program!==dt,Ht=x.style.map.terrain&&x.style.map.terrain.getTerrainData(Ze),mr=oe.constantOr(null);if(mr&&Ke.imageAtlas){const yr=Ke.imageAtlas,xr=yr.patternPositions[mr.to.toString()],si=yr.patternPositions[mr.from.toString()];xr&&si&&ft.setConstantPatternPositions(xr,si)}const Kt=Oe.getProjectionData({overscaledTileID:Ze,applyGlobeMatrix:!B,applyTerrainMatrix:!0}),br=Oe.getPixelScale(),Ar=ce?Va(x,Ke,E,br,me):ie?$p(x,Ke,E,br,ie,me):fe?Id(x,Ke,E,br,Ue.lineClipsArray.length):Zl(x,Ke,E,br);if(ce)Te.activeTexture.set(_e.TEXTURE0),Ke.imageAtlasTexture.bind(_e.LINEAR,_e.CLAMP_TO_EDGE),ft.updatePaintBuffers(me);else if(ie&&(Et||x.lineAtlas.dirty))Te.activeTexture.set(_e.TEXTURE0),x.lineAtlas.bind(Te);else if(fe){const yr=Ue.gradients[E.id];let xr=yr.texture;if(E.gradientVersion!==yr.version){let si=256;if(E.stepInterpolant){const _i=T.getSource().maxzoom,Ei=Ze.canonical.z===_i?Math.ceil(1<<x.transform.maxZoom-Ze.canonical.z):1;si=a.ae(a.bT(Ue.maxLineLength/a.Z*1024*Ei),256,Te.maxTextureSize)}yr.gradient=a.bU({expression:E.gradientExpression(),evaluationKey:"lineProgress",resolution:si,image:yr.gradient||void 0,clips:Ue.lineClipsArray}),yr.texture?yr.texture.update(yr.gradient):yr.texture=new Ie(Te,yr.gradient,_e.RGBA),yr.version=E.gradientVersion,xr=yr.texture}Te.activeTexture.set(_e.TEXTURE0),xr.bind(E.stepInterpolant?_e.NEAREST:_e.LINEAR,_e.CLAMP_TO_EDGE)}let Or;if(B){const[yr]=x.getStencilConfigForOverlapAndUpdateStencilID(M);Or=yr[Ze.overscaledZ]}else Or=x.stencilModeForClipping(Ze);Je.draw(Te,_e.TRIANGLES,K,Or,ne,dr.disabled,Ar,Ht,Kt,E.id,Ue.layoutVertexBuffer,Ue.indexBuffer,Ue.segments,E.paint,x.transform.zoom,ft,Ue.layoutVertexBuffer2),De=!1}}(e,i,u,d,_):a.c3(u)?function(x,T,E,M,D){const B=E.paint.get("fill-color"),O=E.paint.get("fill-opacity");if(O.constantOr(1)===0)return;const{isRenderingToTexture:Z}=D,K=x.colorModeForRenderPass(),ne=E.paint.get("fill-pattern"),ie=x.opaquePassEnabledForLayer()&&!ne.constantOr(1)&&B.constantOr(a.b7.transparent).a===1&&O.constantOr(0)===1?"opaque":"translucent";if(x.renderPass===ie){const oe=x.getDepthModeForSublayer(1,x.renderPass==="opaque"?Wt.ReadWrite:Wt.ReadOnly);ic(x,T,E,M,oe,K,!1,Z)}if(x.renderPass==="translucent"&&E.paint.get("fill-antialias")){const oe=x.getDepthModeForSublayer(E.getPaintProperty("fill-outline-color")?2:0,Wt.ReadOnly);ic(x,T,E,M,oe,K,!0,Z)}}(e,i,u,d,_):a.c4(u)?function(x,T,E,M,D){const B=E.paint.get("fill-extrusion-opacity");if(B===0)return;const{isRenderingToTexture:O}=D;if(x.renderPass==="translucent"){const Z=new Wt(x.context.gl.LEQUAL,Wt.ReadWrite,x.depthRangeFor3D);if(B!==1||E.paint.get("fill-extrusion-pattern").constantOr(1))nc(x,T,E,M,Z,sr.disabled,Rr.disabled,O),nc(x,T,E,M,Z,x.stencilModeFor3D(),x.colorModeForRenderPass(),O);else{const K=x.colorModeForRenderPass();nc(x,T,E,M,Z,sr.disabled,K,O)}}}(e,i,u,d,_):a.c5(u)?function(x,T,E,M,D){if(x.renderPass!=="offscreen"&&x.renderPass!=="translucent")return;const{isRenderingToTexture:B}=D,O=x.context,Z=x.style.projection.useSubdivision,K=x.getDepthModeForSublayer(0,Wt.ReadOnly),ne=x.colorModeForRenderPass();if(x.renderPass==="offscreen")(function(ie,oe,ce,fe,me,ge,Te){const _e=ie.context,Oe=_e.gl;for(const De of ce){const Ze=oe.getTile(De),Ke=Ze.dem;if(!Ke||!Ke.data||!Ze.needsHillshadePrepare)continue;const Ue=Ke.dim,ft=Ke.stride,dt=Ke.getPixels();if(_e.activeTexture.set(Oe.TEXTURE1),_e.pixelStoreUnpackPremultiplyAlpha.set(!1),Ze.demTexture=Ze.demTexture||ie.getTileTexture(ft),Ze.demTexture){const Et=Ze.demTexture;Et.update(dt,{premultiply:!1}),Et.bind(Oe.NEAREST,Oe.CLAMP_TO_EDGE)}else Ze.demTexture=new Ie(_e,dt,Oe.RGBA,{premultiply:!1}),Ze.demTexture.bind(Oe.NEAREST,Oe.CLAMP_TO_EDGE);_e.activeTexture.set(Oe.TEXTURE0);let Je=Ze.fbo;if(!Je){const Et=new Ie(_e,{width:Ue,height:Ue,data:null},Oe.RGBA);Et.bind(Oe.LINEAR,Oe.CLAMP_TO_EDGE),Je=Ze.fbo=_e.createFramebuffer(Ue,Ue,!0,!1),Je.colorAttachment.set(Et.texture)}_e.bindFramebuffer.set(Je.framebuffer),_e.viewport.set([0,0,Ue,Ue]),ie.useProgram("hillshadePrepare").draw(_e,Oe.TRIANGLES,me,ge,Te,dr.disabled,Cd(Ze.tileID,Ke),null,null,fe.id,ie.rasterBoundsBuffer,ie.quadTriangleIndexBuffer,ie.rasterBoundsSegments),Ze.needsHillshadePrepare=!1}})(x,T,M,E,K,sr.disabled,ne),O.viewport.set([0,0,x.width,x.height]);else if(x.renderPass==="translucent")if(Z){const[ie,oe,ce]=x.stencilConfigForOverlapTwoPass(M);oc(x,T,E,ce,ie,K,ne,!1,B),oc(x,T,E,ce,oe,K,ne,!0,B)}else{const[ie,oe]=x.getStencilConfigForOverlapAndUpdateStencilID(M);oc(x,T,E,oe,ie,K,ne,!1,B)}}(e,i,u,d,_):a.c6(u)?function(x,T,E,M,D){if(x.renderPass!=="translucent"||E.paint.get("raster-opacity")===0||!M.length)return;const{isRenderingToTexture:B}=D,O=T.getSource(),Z=x.style.projection.useSubdivision;if(O instanceof ut)ta(x,T,E,M,null,!1,!1,O.tileCoords,O.flippedWindingOrder,B);else if(Z){const[K,ne,ie]=x.stencilConfigForOverlapTwoPass(M);ta(x,T,E,ie,K,!1,!0,ea,!1,B),ta(x,T,E,ie,ne,!0,!0,ea,!1,B)}else{const[K,ne]=x.getStencilConfigForOverlapAndUpdateStencilID(M);ta(x,T,E,ne,K,!1,!0,ea,!1,B)}}(e,i,u,d,_):a.c7(u)?function(x,T,E,M,D){const B=E.paint.get("background-color"),O=E.paint.get("background-opacity");if(O===0)return;const{isRenderingToTexture:Z}=D,K=x.context,ne=K.gl,ie=x.style.projection,oe=x.transform,ce=oe.tileSize,fe=E.paint.get("background-pattern");if(x.isPatternMissing(fe))return;const me=!fe&&B.a===1&&O===1&&x.opaquePassEnabledForLayer()?"opaque":"translucent";if(x.renderPass!==me)return;const ge=sr.disabled,Te=x.getDepthModeForSublayer(0,me==="opaque"?Wt.ReadWrite:Wt.ReadOnly),_e=x.colorModeForRenderPass(),Oe=x.useProgram(fe?"backgroundPattern":"background"),De=M||Pe(oe,{tileSize:ce,terrain:x.style.map.terrain});fe&&(K.activeTexture.set(ne.TEXTURE0),x.imageManager.bind(x.context));const Ze=E.getCrossfadeParameters();for(const Ke of De){const Ue=oe.getProjectionData({overscaledTileID:Ke,applyGlobeMatrix:!Z,applyTerrainMatrix:!0}),ft=fe?ql(O,x,fe,{tileID:Ke,tileSize:ce},Ze):Ad(O,B),dt=x.style.map.terrain&&x.style.map.terrain.getTerrainData(Ke),Je=ie.getMeshFromTileID(K,Ke.canonical,!1,!0,"raster");Oe.draw(K,ne.TRIANGLES,Te,ge,_e,dr.backCCW,ft,dt,Ue,E.id,Je.vertexBuffer,Je.indexBuffer,Je.segments)}}(e,0,u,d,_):a.c8(u)&&function(x,T,E,M){const{isRenderingGlobe:D}=M,B=x.context,O=E.implementation,Z=x.style.projection,K=x.transform,ne=K.getProjectionDataForCustomLayer(D),ie={farZ:K.farZ,nearZ:K.nearZ,fov:K.fov*Math.PI/180,modelViewProjectionMatrix:K.modelViewProjectionMatrix,projectionMatrix:K.projectionMatrix,shaderData:{variantName:Z.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${Z.shaderPreludeCode.vertexSource}`,define:Z.shaderDefine},defaultProjectionData:ne},oe=O.renderingMode?O.renderingMode:"2d";if(x.renderPass==="offscreen"){const ce=O.prerender;ce&&(x.setCustomLayerDefaults(),B.setColorMode(x.colorModeForRenderPass()),ce.call(O,B.gl,ie),B.setDirty(),x.setBaseState())}else if(x.renderPass==="translucent"){x.setCustomLayerDefaults(),B.setColorMode(x.colorModeForRenderPass()),B.setStencilMode(sr.disabled);const ce=oe==="3d"?x.getDepthModeFor3D():x.getDepthModeForSublayer(0,Wt.ReadOnly);B.setDepthMode(ce),O.render(B.gl,ie),B.setDirty(),x.setBaseState(),B.bindFramebuffer.set(null)}}(e,0,u,_))}saveTileTexture(e){const i=this._tileTextures[e.size[0]];i?i.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const i=this._tileTextures[e];return i&&i.length>0?i.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const i=this.imageManager.getPattern(e.from.toString()),u=this.imageManager.getPattern(e.to.toString());return!i||!u}useProgram(e,i,u=!1){this.cache=this.cache||{};const d=!!this.style.map.terrain,_=this.style.projection,x=e+(i?i.cacheKey:"")+`/${u?js:_.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(d?"/terrain":"");return this.cache[x]||(this.cache[x]=new Na(this.context,An[e],i,_u[e],this._showOverdrawInspector,d,u?An.projectionMercator:_.shaderPreludeCode,u?ho:_.shaderDefine)),this.cache[x]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Ie(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:i}=this.context.gl;return this.width!==e||this.height!==i}}function Lu(g,e){let i,u=!1,d=null,_=null;const x=()=>{d=null,u&&(g.apply(_,i),d=setTimeout(x,e),u=!1)};return(...T)=>(u=!0,_=this,i=T,d||x(),d)}class zu{constructor(e){this._getCurrentHash=()=>{const i=window.location.hash.replace("#","");if(this._hashName){let u;return i.split("&").map(d=>d.split("=")).forEach(d=>{d[0]===this._hashName&&(u=d)}),(u&&u[1]||"").split("/")}return i.split("/")},this._onHashChange=()=>{const i=this._getCurrentHash();if(!this._isValidHash(i))return!1;const u=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(i[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+i[2],+i[1]],zoom:+i[0],bearing:u,pitch:+(i[4]||0)}),!0},this._updateHashUnthrottled=()=>{const i=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,i)},this._removeHash=()=>{const i=this._getCurrentHash();if(i.length===0)return;const u=i.join("/");let d=u;d.split("&").length>0&&(d=d.split("&")[0]),this._hashName&&(d=`${this._hashName}=${u}`);let _=window.location.hash.replace(d,"");_.startsWith("#&")?_=_.slice(0,1)+_.slice(2):_==="#"&&(_="");let x=window.location.href.replace(/(#.+)?$/,_);x=x.replace("&&","&"),window.history.replaceState(window.history.state,null,x)},this._updateHash=Lu(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){const i=this._map.getCenter(),u=Math.round(100*this._map.getZoom())/100,d=Math.ceil((u*Math.LN2+Math.log(512/360/.5))/Math.LN10),_=Math.pow(10,d),x=Math.round(i.lng*_)/_,T=Math.round(i.lat*_)/_,E=this._map.getBearing(),M=this._map.getPitch();let D="";if(D+=e?`/${x}/${T}/${u}`:`${u}/${T}/${x}`,(E||M)&&(D+="/"+Math.round(10*E)/10),M&&(D+=`/${Math.round(M)}`),this._hashName){const B=this._hashName;let O=!1;const Z=window.location.hash.slice(1).split("&").map(K=>{const ne=K.split("=")[0];return ne===B?(O=!0,`${ne}=${D}`):K}).filter(K=>K);return O||Z.push(`${B}=${D}`),`#${Z.join("&")}`}return`#${D}`}_isValidHash(e){if(e.length<3||e.some(isNaN))return!1;try{new a.Q(+e[2],+e[1])}catch{return!1}const i=+e[0],u=+(e[3]||0),d=+(e[4]||0);return i>=this._map.getMinZoom()&&i<=this._map.getMaxZoom()&&u>=-180&&u<=180&&d>=this._map.getMinPitch()&&d<=this._map.getMaxPitch()}}const ra={linearity:.3,easing:a.c9(0,0,.3,1)},hs=a.e({deceleration:2500,maxSpeed:1400},ra),Zd=a.e({deceleration:20,maxSpeed:1400},ra),qd=a.e({deceleration:1e3,maxSpeed:360},ra),Hd=a.e({deceleration:1e3,maxSpeed:90},ra),Wd=a.e({deceleration:1e3,maxSpeed:360},ra);class Kd{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:N.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,i=N.now();for(;e.length>0&&i-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const i={zoom:0,bearing:0,pitch:0,roll:0,pan:new a.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:_}of this._inertiaBuffer)i.zoom+=_.zoomDelta||0,i.bearing+=_.bearingDelta||0,i.pitch+=_.pitchDelta||0,i.roll+=_.rollDelta||0,_.panDelta&&i.pan._add(_.panDelta),_.around&&(i.around=_.around),_.pinchAround&&(i.pinchAround=_.pinchAround);const u=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,d={};if(i.pan.mag()){const _=na(i.pan.mag(),u,a.e({},hs,e||{})),x=i.pan.mult(_.amount/i.pan.mag()),T=this._map.cameraHelper.handlePanInertia(x,this._map.transform);d.center=T.easingCenter,d.offset=T.easingOffset,ia(d,_)}if(i.zoom){const _=na(i.zoom,u,Zd);d.zoom=this._map.transform.zoom+_.amount,ia(d,_)}if(i.bearing){const _=na(i.bearing,u,qd);d.bearing=this._map.transform.bearing+a.ae(_.amount,-179,179),ia(d,_)}if(i.pitch){const _=na(i.pitch,u,Hd);d.pitch=this._map.transform.pitch+_.amount,ia(d,_)}if(i.roll){const _=na(i.roll,u,Wd);d.roll=this._map.transform.roll+a.ae(_.amount,-179,179),ia(d,_)}if(d.zoom||d.bearing){const _=i.pinchAround===void 0?i.around:i.pinchAround;d.around=_?this._map.unproject(_):this._map.getCenter()}return this.clear(),a.e(d,{noMoveStart:!0})}}function ia(g,e){(!g.duration||g.duration<e.duration)&&(g.duration=e.duration,g.easing=e.easing)}function na(g,e,i){const{maxSpeed:u,linearity:d,deceleration:_}=i,x=a.ae(g*d/(e/1e3),-u,u),T=Math.abs(x)/(_*d);return{easing:i.easing,duration:1e3*T,amount:x*(T/2)}}class $i extends a.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,i,u,d={}){u=u instanceof MouseEvent?u:new MouseEvent(e,u);const _=F.mousePos(i.getCanvas(),u),x=i.unproject(_);super(e,a.e({point:_,lngLat:x,originalEvent:u},d)),this._defaultPrevented=!1,this.target=i}}class oa extends a.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,i,u){const d=e==="touchend"?u.changedTouches:u.touches,_=F.touchPos(i.getCanvasContainer(),d),x=_.map(E=>i.unproject(E)),T=_.reduce((E,M,D,B)=>E.add(M.div(B.length)),new a.P(0,0));super(e,{points:_,point:T,lngLats:x,lngLat:i.unproject(T),originalEvent:u}),this._defaultPrevented=!1}}class Mn extends a.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,i,u){super(e,{originalEvent:u}),this._defaultPrevented=!1}}class Xn{constructor(e,i){this._map=e,this._clickTolerance=i.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new Mn(e.type,this._map,e))}mousedown(e,i){return this._mousedownPos=i,this._firePreventable(new $i(e.type,this._map,e))}mouseup(e){this._map.fire(new $i(e.type,this._map,e))}click(e,i){this._mousedownPos&&this._mousedownPos.dist(i)>=this._clickTolerance||this._map.fire(new $i(e.type,this._map,e))}dblclick(e){return this._firePreventable(new $i(e.type,this._map,e))}mouseover(e){this._map.fire(new $i(e.type,this._map,e))}mouseout(e){this._map.fire(new $i(e.type,this._map,e))}touchstart(e){return this._firePreventable(new oa(e.type,this._map,e))}touchmove(e){this._map.fire(new oa(e.type,this._map,e))}touchend(e){this._map.fire(new oa(e.type,this._map,e))}touchcancel(e){this._map.fire(new oa(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Xd{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new $i(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new $i("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new $i(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ln{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.screenPointToLocation(a.P.convert(e),this._map.terrain)}}class ds{constructor(e,i){this._map=e,this._tr=new ln(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=i.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,i){this.isEnabled()&&e.shiftKey&&e.button===0&&(F.disableDrag(),this._startPos=this._lastPos=i,this._active=!0)}mousemoveWindow(e,i){if(!this._active)return;const u=i;if(this._lastPos.equals(u)||!this._box&&u.dist(this._startPos)<this._clickTolerance)return;const d=this._startPos;this._lastPos=u,this._box||(this._box=F.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const _=Math.min(d.x,u.x),x=Math.max(d.x,u.x),T=Math.min(d.y,u.y),E=Math.max(d.y,u.y);F.setTransform(this._box,`translate(${_}px,${T}px)`),this._box.style.width=x-_+"px",this._box.style.height=E-T+"px"}mouseupWindow(e,i){if(!this._active||e.button!==0)return;const u=this._startPos,d=i;if(this.reset(),F.suppressClick(),u.x!==d.x||u.y!==d.y)return this._map.fire(new a.l("boxzoomend",{originalEvent:e})),{cameraAnimation:_=>_.fitScreenCoordinates(u,d,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(F.remove(this._box),this._box=null),F.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,i){return this._map.fire(new a.l(e,{originalEvent:i}))}}function Ru(g,e){if(g.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${g.length}, points ${e.length}`);const i={};for(let u=0;u<g.length;u++)i[g[u].identifier]=e[u];return i}class Qp{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,i,u){(this.centroid||u.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=e.timeStamp),u.length===this.numTouches&&(this.centroid=function(d){const _=new a.P(0,0);for(const x of d)_._add(x);return _.div(d.length)}(i),this.touches=Ru(u,i)))}touchmove(e,i,u){if(this.aborted||!this.centroid)return;const d=Ru(u,i);for(const _ in this.touches){const x=d[_];(!x||x.dist(this.touches[_])>30)&&(this.aborted=!0)}}touchend(e,i,u){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),u.length===0){const d=!this.aborted&&this.centroid;if(this.reset(),d)return d}}}class Du{constructor(e){this.singleTap=new Qp(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,i,u){this.singleTap.touchstart(e,i,u)}touchmove(e,i,u){this.singleTap.touchmove(e,i,u)}touchend(e,i,u){const d=this.singleTap.touchend(e,i,u);if(d){const _=e.timeStamp-this.lastTime<500,x=!this.lastTap||this.lastTap.dist(d)<30;if(_&&x||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=d,this.count===this.numTaps)return this.reset(),d}}}class em{constructor(e){this._tr=new ln(e),this._zoomIn=new Du({numTouches:1,numTaps:2}),this._zoomOut=new Du({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,i,u){this._zoomIn.touchstart(e,i,u),this._zoomOut.touchstart(e,i,u)}touchmove(e,i,u){this._zoomIn.touchmove(e,i,u),this._zoomOut.touchmove(e,i,u)}touchend(e,i,u){const d=this._zoomIn.touchend(e,i,u),_=this._zoomOut.touchend(e,i,u),x=this._tr;return d?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:x.zoom+1,around:x.unproject(d)},{originalEvent:e})}):_?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:x.zoom-1,around:x.unproject(_)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class sa{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){const i=this._moveFunction(...e);if(i.bearingDelta||i.pitchDelta||i.rollDelta||i.around||i.panDelta)return this._active=!0,i}dragStart(e,i){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=Array.isArray(i)?i[0]:i,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,i){if(!this.isEnabled())return;const u=this._lastPoint;if(!u)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const d=Array.isArray(i)?i[0]:i;return!this._moved&&d.dist(u)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=d,this._move(u,d))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&F.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Ka={0:1,2:2};class mn{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const i=F.mouseButton(e);this._eventButton=i}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!function(i,u){const d=Ka[u];return i.buttons===void 0||(i.buttons&d)!==d}(e,this._eventButton)}isValidEndEvent(e){return F.mouseButton(e)===this._eventButton}}class wt{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}class Yd{constructor(e=new mn({checkCorrectEvent:()=>!0}),i=new wt){this.mouseMoveStateManager=e,this.oneFingerTouchMoveStateManager=i}_executeRelevantHandler(e,i,u){return e instanceof MouseEvent?i(e):typeof TouchEvent<"u"&&e instanceof TouchEvent?u(e):void 0}startMove(e){this._executeRelevantHandler(e,i=>this.mouseMoveStateManager.startMove(i),i=>this.oneFingerTouchMoveStateManager.startMove(i))}endMove(e){this._executeRelevantHandler(e,i=>this.mouseMoveStateManager.endMove(i),i=>this.oneFingerTouchMoveStateManager.endMove(i))}isValidStartEvent(e){return this._executeRelevantHandler(e,i=>this.mouseMoveStateManager.isValidStartEvent(i),i=>this.oneFingerTouchMoveStateManager.isValidStartEvent(i))}isValidMoveEvent(e){return this._executeRelevantHandler(e,i=>this.mouseMoveStateManager.isValidMoveEvent(i),i=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(i))}isValidEndEvent(e){return this._executeRelevantHandler(e,i=>this.mouseMoveStateManager.isValidEndEvent(i),i=>this.oneFingerTouchMoveStateManager.isValidEndEvent(i))}}const aa=g=>{g.mousedown=g.dragStart,g.mousemoveWindow=g.dragMove,g.mouseup=g.dragEnd,g.contextmenu=e=>{e.preventDefault()}};class Jd{constructor(e,i){this._clickTolerance=e.clickTolerance||1,this._map=i,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new a.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,i,u){return this._calculateTransform(e,i,u)}touchmove(e,i,u){if(this._active){if(!this._shouldBePrevented(u.length))return e.preventDefault(),this._calculateTransform(e,i,u);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,i,u){this._calculateTransform(e,i,u),this._active&&this._shouldBePrevented(u.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,i,u){u.length>0&&(this._active=!0);const d=Ru(u,i),_=new a.P(0,0),x=new a.P(0,0);let T=0;for(const M in d){const D=d[M],B=this._touches[M];B&&(_._add(D),x._add(D.sub(B)),T++,d[M]=D)}if(this._touches=d,this._shouldBePrevented(T)||!x.mag())return;const E=x.div(T);return this._sum._add(E),this._sum.mag()<this._clickTolerance?void 0:{around:_.div(T),panDelta:E}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class fs{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,i,u){this._firstTwoTouches||u.length<2||(this._firstTwoTouches=[u[0].identifier,u[1].identifier],this._start([i[0],i[1]]))}touchmove(e,i,u){if(!this._firstTwoTouches)return;e.preventDefault();const[d,_]=this._firstTwoTouches,x=Do(u,i,d),T=Do(u,i,_);if(!x||!T)return;const E=this._aroundCenter?null:x.add(T).div(2);return this._move([x,T],E,e)}touchend(e,i,u){if(!this._firstTwoTouches)return;const[d,_]=this._firstTwoTouches,x=Do(u,i,d),T=Do(u,i,_);x&&T||(this._active&&F.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Do(g,e,i){for(let u=0;u<g.length;u++)if(g[u].identifier===i)return e[u]}function Ou(g,e){return Math.log(g/e)/Math.LN2}class rr extends fs{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,i){const u=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(Ou(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Ou(this._distance,u),pinchAround:i}}}function lc(g,e){return 180*g.angleWith(e)/Math.PI}class Qd extends fs{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,i,u){const d=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:lc(this._vector,d),pinchAround:i}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const i=25/(Math.PI*this._minDiameter)*360,u=lc(e,this._startVector);return Math.abs(u)<i}}function Xa(g){return Math.abs(g.y)>Math.abs(g.x)}class ef extends fs{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,i,u){super.touchstart(e,i,u),this._currentTouchCount=u.length}_start(e){this._lastPoints=e,Xa(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,i,u){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const d=e[0].sub(this._lastPoints[0]),_=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(d,_,u.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(d.y+_.y)/2*-.5}):void 0}gestureBeginsVertically(e,i,u){if(this._valid!==void 0)return this._valid;const d=e.mag()>=2,_=i.mag()>=2;if(!d&&!_)return;if(!d||!_)return this._firstMove===void 0&&(this._firstMove=u),u-this._firstMove<100&&void 0;const x=e.y>0==i.y>0;return Xa(e)&&Xa(i)&&x}}const tm={panStep:100,bearingStep:15,pitchStep:10};class Fu{constructor(e){this._tr=new ln(e);const i=tm;this._panStep=i.panStep,this._bearingStep=i.bearingStep,this._pitchStep=i.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let i=0,u=0,d=0,_=0,x=0;switch(e.keyCode){case 61:case 107:case 171:case 187:i=1;break;case 189:case 109:case 173:i=-1;break;case 37:e.shiftKey?u=-1:(e.preventDefault(),_=-1);break;case 39:e.shiftKey?u=1:(e.preventDefault(),_=1);break;case 38:e.shiftKey?d=1:(e.preventDefault(),x=-1);break;case 40:e.shiftKey?d=-1:(e.preventDefault(),x=1);break;default:return}return this._rotationDisabled&&(u=0,d=0),{cameraAnimation:T=>{const E=this._tr;T.easeTo({duration:300,easeId:"keyboardHandler",easing:Bu,zoom:i?Math.round(E.zoom)+i*(e.shiftKey?2:1):E.zoom,bearing:E.bearing+u*this._bearingStep,pitch:E.pitch+d*this._pitchStep,offset:[-_*this._panStep,-x*this._panStep],center:E.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Bu(g){return g*(2-g)}const ju=4.000244140625;class tf{constructor(e,i){this._onTimeout=u=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(u)},this._map=e,this._tr=new ln(e),this._triggerRenderFrame=i,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let i=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const u=N.now(),d=u-(this._lastWheelEventTime||0);this._lastWheelEventTime=u,i!==0&&i%ju==0?this._type="wheel":i!==0&&Math.abs(i)<4?this._type="trackpad":d>400?(this._type=null,this._lastValue=i,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(d*i)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,i+=this._lastValue)),e.shiftKey&&i&&(i/=4),this._type&&(this._lastWheelEvent=e,this._delta-=i,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const i=F.mousePos(this._map.getCanvas(),e),u=this._tr;this._aroundPoint=this._aroundCenter?u.transform.locationToScreenPoint(a.Q.convert(u.center)):i,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const e=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const T=e.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=T),typeof this._targetZoom=="number"&&(this._targetZoom+=T)}if(this._delta!==0){const T=this._type==="wheel"&&Math.abs(this._delta)>ju?this._wheelZoomRate:this._defaultZoomRate;let E=2/(1+Math.exp(-Math.abs(this._delta*T)));this._delta<0&&E!==0&&(E=1/E);const M=typeof this._targetZoom!="number"?e.scale:a.aI(this._targetZoom);this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,a.ab(M*E))),this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const i=typeof this._targetZoom!="number"?e.zoom:this._targetZoom,u=this._startZoom,d=this._easing;let _,x=!1;if(this._type==="wheel"&&u&&d){const T=N.now()-this._lastWheelEventTime,E=Math.min((T+5)/200,1),M=d(E);_=a.B.number(u,i,M),E<1?this._frameId||(this._frameId=!0):x=!0}else _=i,x=!0;return this._active=!0,x&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=_,{noInertia:!0,needsRenderFrame:!x,zoomDelta:_-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let i=a.cb;if(this._prevEase){const u=this._prevEase,d=(N.now()-u.start)/u.duration,_=u.easing(d+.01)-u.easing(d),x=.27/Math.sqrt(_*_+1e-4)*.01,T=Math.sqrt(.0729-x*x);i=a.c9(x,T,.25,1)}return this._prevEase={start:N.now(),duration:e,easing:i},i}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Nu{constructor(e,i){this._clickZoom=e,this._tapZoom=i}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class rm{constructor(e){this._tr=new ln(e),this.reset()}reset(){this._active=!1}dblclick(e,i){return e.preventDefault(),{cameraAnimation:u=>{u.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(i)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class im{constructor(){this._tap=new Du({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,i,u){if(!this._swipePoint)if(this._tapTime){const d=i[0],_=e.timeStamp-this._tapTime<500,x=this._tapPoint.dist(d)<30;_&&x?u.length>0&&(this._swipePoint=d,this._swipeTouch=u[0].identifier):this.reset()}else this._tap.touchstart(e,i,u)}touchmove(e,i,u){if(this._tapTime){if(this._swipePoint){if(u[0].identifier!==this._swipeTouch)return;const d=i[0],_=d.y-this._swipePoint.y;return this._swipePoint=d,e.preventDefault(),this._active=!0,{zoomDelta:_/128}}}else this._tap.touchmove(e,i,u)}touchend(e,i,u){if(this._tapTime)this._swipePoint&&u.length===0&&this.reset();else{const d=this._tap.touchend(e,i,u);d&&(this._tapTime=e.timeStamp,this._tapPoint=d)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class mo{constructor(e,i,u){this._el=e,this._mousePan=i,this._touchPan=u}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Dr{constructor(e,i,u,d){this._pitchWithRotate=e.pitchWithRotate,this._rollEnabled=e.rollEnabled,this._mouseRotate=i,this._mousePitch=u,this._mouseRoll=d}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class Ya{constructor(e,i,u,d){this._el=e,this._touchZoom=i,this._touchRotate=u,this._tapDragZoom=d,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class cc{constructor(e,i){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=i,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=F.create("div","maplibregl-cooperative-gesture-screen",e);let i=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(i=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const u=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),d=document.createElement("div");d.className="maplibregl-desktop-message",d.textContent=i,this._container.appendChild(d);const _=document.createElement("div");_.className="maplibregl-mobile-message",_.textContent=u,this._container.appendChild(_),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(F.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,i){this._enabled&&(this._map.fire(new a.l("cooperativegestureprevented",{gestureType:e,originalEvent:i})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const Ja=g=>g.zoom||g.drag||g.roll||g.pitch||g.rotate;class rf extends a.l{}function uc(g){return g.panDelta&&g.panDelta.mag()||g.zoomDelta||g.bearingDelta||g.pitchDelta||g.rollDelta}class nm{constructor(e,i){this.handleWindowEvent=d=>{this.handleEvent(d,`${d.type}Window`)},this.handleEvent=(d,_)=>{if(d.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const x=d.type==="renderFrame"?void 0:d,T={needsRenderFrame:!1},E={},M={};for(const{handlerName:O,handler:Z,allowed:K}of this._handlers){if(!Z.isEnabled())continue;let ne;if(this._blockedByActive(M,K,O))Z.reset();else if(Z[_||d.type]){if(a.cc(d,_||d.type)){const ie=F.mousePos(this._map.getCanvas(),d);ne=Z[_||d.type](d,ie)}else if(a.cd(d,_||d.type)){const ie=this._getMapTouches(d.touches),oe=F.touchPos(this._map.getCanvas(),ie);ne=Z[_||d.type](d,oe,ie)}else a.ce(_||d.type)||(ne=Z[_||d.type](d));this.mergeHandlerResult(T,E,ne,O,x),ne&&ne.needsRenderFrame&&this._triggerRenderFrame()}(ne||Z.isActive())&&(M[O]=Z)}const D={};for(const O in this._previousActiveHandlers)M[O]||(D[O]=x);this._previousActiveHandlers=M,(Object.keys(D).length||uc(T))&&(this._changes.push([T,E,D]),this._triggerRenderFrame()),(Object.keys(M).length||uc(T))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:B}=T;B&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],B(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Kd(e),this._bearingSnap=i.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(i);const u=this._el;this._listeners=[[u,"touchstart",{passive:!0}],[u,"touchmove",{passive:!1}],[u,"touchend",void 0],[u,"touchcancel",void 0],[u,"mousedown",void 0],[u,"mousemove",void 0],[u,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[u,"mouseover",void 0],[u,"mouseout",void 0],[u,"dblclick",void 0],[u,"click",void 0],[u,"keydown",{capture:!1}],[u,"keyup",void 0],[u,"wheel",{passive:!1}],[u,"contextmenu",void 0],[window,"blur",void 0]];for(const[d,_,x]of this._listeners)F.addEventListener(d,_,d===document?this.handleWindowEvent:this.handleEvent,x)}destroy(){for(const[e,i,u]of this._listeners)F.removeEventListener(e,i,e===document?this.handleWindowEvent:this.handleEvent,u)}_addDefaultHandlers(e){const i=this._map,u=i.getCanvasContainer();this._add("mapEvent",new Xn(i,e));const d=i.boxZoom=new ds(i,e);this._add("boxZoom",d),e.interactive&&e.boxZoom&&d.enable();const _=i.cooperativeGestures=new cc(i,e.cooperativeGestures);this._add("cooperativeGestures",_),e.cooperativeGestures&&_.enable();const x=new em(i),T=new rm(i);i.doubleClickZoom=new Nu(T,x),this._add("tapZoom",x),this._add("clickZoom",T),e.interactive&&e.doubleClickZoom&&i.doubleClickZoom.enable();const E=new im;this._add("tapDragZoom",E);const M=i.touchPitch=new ef(i);this._add("touchPitch",M),e.interactive&&e.touchPitch&&i.touchPitch.enable(e.touchPitch);const D=()=>i.project(i.getCenter()),B=function({enable:me,clickTolerance:ge,aroundCenter:Te=!0,minPixelCenterThreshold:_e=100,rotateDegreesPerPixelMoved:Oe=.8},De){const Ze=new mn({checkCorrectEvent:Ke=>F.mouseButton(Ke)===0&&Ke.ctrlKey||F.mouseButton(Ke)===2&&!Ke.ctrlKey});return new sa({clickTolerance:ge,move:(Ke,Ue)=>{const ft=De();if(Te&&Math.abs(ft.y-Ke.y)>_e)return{bearingDelta:a.ca(new a.P(Ke.x,Ue.y),Ue,ft)};let dt=(Ue.x-Ke.x)*Oe;return Te&&Ue.y<ft.y&&(dt=-dt),{bearingDelta:dt}},moveStateManager:Ze,enable:me,assignEvents:aa})}(e,D),O=function({enable:me,clickTolerance:ge,pitchDegreesPerPixelMoved:Te=-.5}){const _e=new mn({checkCorrectEvent:Oe=>F.mouseButton(Oe)===0&&Oe.ctrlKey||F.mouseButton(Oe)===2});return new sa({clickTolerance:ge,move:(Oe,De)=>({pitchDelta:(De.y-Oe.y)*Te}),moveStateManager:_e,enable:me,assignEvents:aa})}(e),Z=function({enable:me,clickTolerance:ge,rollDegreesPerPixelMoved:Te=.3},_e){const Oe=new mn({checkCorrectEvent:De=>F.mouseButton(De)===2&&De.ctrlKey});return new sa({clickTolerance:ge,move:(De,Ze)=>{const Ke=_e();let Ue=(Ze.x-De.x)*Te;return Ze.y<Ke.y&&(Ue=-Ue),{rollDelta:Ue}},moveStateManager:Oe,enable:me,assignEvents:aa})}(e,D);i.dragRotate=new Dr(e,B,O,Z),this._add("mouseRotate",B,["mousePitch"]),this._add("mousePitch",O,["mouseRotate","mouseRoll"]),this._add("mouseRoll",Z,["mousePitch"]),e.interactive&&e.dragRotate&&i.dragRotate.enable();const K=function({enable:me,clickTolerance:ge}){const Te=new mn({checkCorrectEvent:_e=>F.mouseButton(_e)===0&&!_e.ctrlKey});return new sa({clickTolerance:ge,move:(_e,Oe)=>({around:Oe,panDelta:Oe.sub(_e)}),activateOnStart:!0,moveStateManager:Te,enable:me,assignEvents:aa})}(e),ne=new Jd(e,i);i.dragPan=new mo(u,K,ne),this._add("mousePan",K),this._add("touchPan",ne,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&i.dragPan.enable(e.dragPan);const ie=new Qd,oe=new rr;i.touchZoomRotate=new Ya(u,oe,ie,E),this._add("touchRotate",ie,["touchPan","touchZoom"]),this._add("touchZoom",oe,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&i.touchZoomRotate.enable(e.touchZoomRotate);const ce=i.scrollZoom=new tf(i,()=>this._triggerRenderFrame());this._add("scrollZoom",ce,["mousePan"]),e.interactive&&e.scrollZoom&&i.scrollZoom.enable(e.scrollZoom);const fe=i.keyboard=new Fu(i);this._add("keyboard",fe),e.interactive&&e.keyboard&&i.keyboard.enable(),this._add("blockableMapEvent",new Xd(i))}_add(e,i,u){this._handlers.push({handlerName:e,handler:i,allowed:u}),this._handlersById[e]=i}stop(e){if(!this._updatingCamera){for(const{handler:i}of this._handlers)i.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Ja(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,i,u){for(const d in e)if(d!==u&&(!i||i.indexOf(d)<0))return!0;return!1}_getMapTouches(e){const i=[];for(const u of e)this._el.contains(u.target)&&i.push(u);return i}mergeHandlerResult(e,i,u,d,_){if(!u)return;a.e(e,u);const x={handlerName:d,originalEvent:u.originalEvent||_};u.zoomDelta!==void 0&&(i.zoom=x),u.panDelta!==void 0&&(i.drag=x),u.rollDelta!==void 0&&(i.roll=x),u.pitchDelta!==void 0&&(i.pitch=x),u.bearingDelta!==void 0&&(i.rotate=x)}_applyChanges(){const e={},i={},u={};for(const[d,_,x]of this._changes)d.panDelta&&(e.panDelta=(e.panDelta||new a.P(0,0))._add(d.panDelta)),d.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+d.zoomDelta),d.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+d.bearingDelta),d.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+d.pitchDelta),d.rollDelta&&(e.rollDelta=(e.rollDelta||0)+d.rollDelta),d.around!==void 0&&(e.around=d.around),d.pinchAround!==void 0&&(e.pinchAround=d.pinchAround),d.noInertia&&(e.noInertia=d.noInertia),a.e(i,_),a.e(u,x);this._updateMapTransform(e,i,u),this._changes=[]}_updateMapTransform(e,i,u){const d=this._map,_=d._getTransformForUpdate(),x=d.terrain;if(!(uc(e)||x&&this._terrainMovement))return this._fireEvents(i,u,!0);d._stop(!0);let{panDelta:T,zoomDelta:E,bearingDelta:M,pitchDelta:D,rollDelta:B,around:O,pinchAround:Z}=e;Z!==void 0&&(O=Z),O=O||d.transform.centerPoint,x&&!_.isPointOnMapSurface(O)&&(O=_.centerPoint);const K={panDelta:T,zoomDelta:E,rollDelta:B,pitchDelta:D,bearingDelta:M,around:O};this._map.cameraHelper.useGlobeControls&&!_.isPointOnMapSurface(O)&&(O=_.centerPoint);const ne=O.distSqr(_.centerPoint)<.01?_.center:_.screenPointToLocation(T?O.sub(T):O);x?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(K,_),this._terrainMovement||!i.drag&&!i.zoom?i.drag&&this._terrainMovement?_.setCenter(_.screenPointToLocation(_.centerPoint.sub(T))):this._map.cameraHelper.handleMapControlsPan(K,_,ne):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(K,_,ne))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(K,_),this._map.cameraHelper.handleMapControlsPan(K,_,ne)),d._applyUpdatedTransform(_),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(i,u,!0)}_fireEvents(e,i,u){const d=Ja(this._eventsInProgress),_=Ja(e),x={};for(const B in e){const{originalEvent:O}=e[B];this._eventsInProgress[B]||(x[`${B}start`]=O),this._eventsInProgress[B]=e[B]}!d&&_&&this._fireEvent("movestart",_.originalEvent);for(const B in x)this._fireEvent(B,x[B]);_&&this._fireEvent("move",_.originalEvent);for(const B in e){const{originalEvent:O}=e[B];this._fireEvent(B,O)}const T={};let E;for(const B in this._eventsInProgress){const{handlerName:O,originalEvent:Z}=this._eventsInProgress[B];this._handlersById[O].isActive()||(delete this._eventsInProgress[B],E=i[O]||Z,T[`${B}end`]=E)}for(const B in T)this._fireEvent(B,T[B]);const M=Ja(this._eventsInProgress),D=(d||_)&&!M;if(D&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const B=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&B.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(B)}if(u&&D){this._updatingCamera=!0;const B=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),O=Z=>Z!==0&&-this._bearingSnap<Z&&Z<this._bearingSnap;!B||!B.essential&&N.prefersReducedMotion?(this._map.fire(new a.l("moveend",{originalEvent:E})),O(this._map.getBearing())&&this._map.resetNorth()):(O(B.bearing||this._map.getBearing())&&(B.bearing=0),B.freezeElevation=!0,this._map.easeTo(B,{originalEvent:E})),this._updatingCamera=!1}}_fireEvent(e,i){this._map.fire(new a.l(e,i?{originalEvent:i}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{delete this._frameId,this.handleEvent(new rf("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Yn extends a.E{constructor(e,i,u){super(),this._renderFrameCallback=()=>{const d=Math.min((N.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(d)),d<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=u.bearingSnap,this.cameraHelper=i,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(e,i){e.apply(this.transform),this.transform=e,this.cameraHelper=i}getCenter(){return new a.Q(this.transform.center.lng,this.transform.center.lat)}setCenter(e,i){return this.jumpTo({center:e},i)}getCenterElevation(){return this.transform.elevation}setCenterElevation(e,i){return this.jumpTo({elevation:e},i),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(e){this._centerClampedToGround=e}panBy(e,i,u){return e=a.P.convert(e).mult(-1),this.panTo(this.transform.center,a.e({offset:e},i),u)}panTo(e,i,u){return this.easeTo(a.e({center:e},i),u)}getZoom(){return this.transform.zoom}setZoom(e,i){return this.jumpTo({zoom:e},i),this}zoomTo(e,i,u){return this.easeTo(a.e({zoom:e},i),u)}zoomIn(e,i){return this.zoomTo(this.getZoom()+1,e,i),this}zoomOut(e,i){return this.zoomTo(this.getZoom()-1,e,i),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(e,i){return e!=this.transform.fov&&(this.transform.setFov(e),this.fire(new a.l("movestart",i)).fire(new a.l("move",i)).fire(new a.l("moveend",i))),this}getBearing(){return this.transform.bearing}setBearing(e,i){return this.jumpTo({bearing:e},i),this}getPadding(){return this.transform.padding}setPadding(e,i){return this.jumpTo({padding:e},i),this}rotateTo(e,i,u){return this.easeTo(a.e({bearing:e},i),u)}resetNorth(e,i){return this.rotateTo(0,a.e({duration:1e3},e),i),this}resetNorthPitch(e,i){return this.easeTo(a.e({bearing:0,pitch:0,roll:0,duration:1e3},e),i),this}snapToNorth(e,i){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,i):this}getPitch(){return this.transform.pitch}setPitch(e,i){return this.jumpTo({pitch:e},i),this}getRoll(){return this.transform.roll}setRoll(e,i){return this.jumpTo({roll:e},i),this}cameraForBounds(e,i){e=we.convert(e).adjustAntiMeridian();const u=i&&i.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),u,i)}_cameraForBoxAndBearing(e,i,u,d){const _={top:0,bottom:0,right:0,left:0};if(typeof(d=a.e({padding:_,offset:[0,0],maxZoom:this.transform.maxZoom},d)).padding=="number"){const M=d.padding;d.padding={top:M,bottom:M,right:M,left:M}}const x=a.e(_,d.padding);d.padding=x;const T=this.transform,E=new we(e,i);return this.cameraHelper.cameraForBoxAndBearing(d,x,E,u,T)}fitBounds(e,i,u){return this._fitInternal(this.cameraForBounds(e,i),i,u)}fitScreenCoordinates(e,i,u,d,_){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(a.P.convert(e)),this.transform.screenPointToLocation(a.P.convert(i)),u,d),d,_)}_fitInternal(e,i,u){return e?(delete(i=a.e(e,i)).padding,i.linear?this.easeTo(i,u):this.flyTo(i,u)):this}jumpTo(e,i){this.stop();const u=this._getTransformForUpdate();let d=!1,_=!1,x=!1;const T=u.zoom;this.cameraHelper.handleJumpToCenterZoom(u,e);const E=u.zoom!==T;return"elevation"in e&&u.elevation!==+e.elevation&&u.setElevation(+e.elevation),"bearing"in e&&u.bearing!==+e.bearing&&(d=!0,u.setBearing(+e.bearing)),"pitch"in e&&u.pitch!==+e.pitch&&(_=!0,u.setPitch(+e.pitch)),"roll"in e&&u.roll!==+e.roll&&(x=!0,u.setRoll(+e.roll)),e.padding==null||u.isPaddingEqual(e.padding)||u.setPadding(e.padding),this._applyUpdatedTransform(u),this.fire(new a.l("movestart",i)).fire(new a.l("move",i)),E&&this.fire(new a.l("zoomstart",i)).fire(new a.l("zoom",i)).fire(new a.l("zoomend",i)),d&&this.fire(new a.l("rotatestart",i)).fire(new a.l("rotate",i)).fire(new a.l("rotateend",i)),_&&this.fire(new a.l("pitchstart",i)).fire(new a.l("pitch",i)).fire(new a.l("pitchend",i)),x&&this.fire(new a.l("rollstart",i)).fire(new a.l("roll",i)).fire(new a.l("rollend",i)),this.fire(new a.l("moveend",i))}calculateCameraOptionsFromTo(e,i,u,d=0){const _=a.$.fromLngLat(e,i),x=a.$.fromLngLat(u,d),T=x.x-_.x,E=x.y-_.y,M=x.z-_.z,D=Math.hypot(T,E,M);if(D===0)throw new Error("Can't calculate camera options with same From and To");const B=Math.hypot(T,E),O=a.ab(this.transform.cameraToCenterDistance/D/this.transform.tileSize),Z=180*Math.atan2(T,-E)/Math.PI;let K=180*Math.acos(B/D)/Math.PI;return K=M<0?90-K:90+K,{center:x.toLngLat(),elevation:d,zoom:O,pitch:K,bearing:Z}}calculateCameraOptionsFromCameraLngLatAltRotation(e,i,u,d,_){const x=this.transform.calculateCenterFromCameraLngLatAlt(e,i,u,d);return{center:x.center,elevation:x.elevation,zoom:x.zoom,bearing:u,pitch:d,roll:_}}easeTo(e,i){this._stop(!1,e.easeId),((e=a.e({offset:[0,0],duration:500,easing:a.cb},e)).animate===!1||!e.essential&&N.prefersReducedMotion)&&(e.duration=0);const u=this._getTransformForUpdate(),d=this.getBearing(),_=u.pitch,x=u.roll,T="bearing"in e?this._normalizeBearing(e.bearing,d):d,E="pitch"in e?+e.pitch:_,M="roll"in e?this._normalizeBearing(e.roll,x):x,D="padding"in e?e.padding:u.padding,B=a.P.convert(e.offset);let O,Z;e.around&&(O=a.Q.convert(e.around),Z=u.locationToScreenPoint(O));const K={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},ne=this.cameraHelper.handleEaseTo(u,{bearing:T,pitch:E,roll:M,padding:D,around:O,aroundPoint:Z,offsetAsPoint:B,offset:e.offset,zoom:e.zoom,center:e.center});return this._rotating=this._rotating||d!==T,this._pitching=this._pitching||E!==_,this._rolling=this._rolling||M!==x,this._padding=!u.isPaddingEqual(D),this._zooming=this._zooming||ne.isZooming,this._easeId=e.easeId,this._prepareEase(i,e.noMoveStart,K),this.terrain&&this._prepareElevation(ne.elevationCenter),this._ease(ie=>{ne.easeFunc(ie),this.terrain&&!e.freezeElevation&&this._updateElevation(ie),this._applyUpdatedTransform(u),this._fireMoveEvents(i)},ie=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(i,ie)},e),this}_prepareEase(e,i,u={}){this._moving=!0,i||u.moving||this.fire(new a.l("movestart",e)),this._zooming&&!u.zooming&&this.fire(new a.l("zoomstart",e)),this._rotating&&!u.rotating&&this.fire(new a.l("rotatestart",e)),this._pitching&&!u.pitching&&this.fire(new a.l("pitchstart",e)),this._rolling&&!u.rolling&&this.fire(new a.l("rollstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const i=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&i!==this._elevationTarget){const u=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(u-(i-(u*e+this._elevationStart))/(1-e)),this._elevationTarget=i}this.transform.setElevation(a.B.number(this._elevationStart,this._elevationTarget,e))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){if(!this.terrain&&e.elevation>=0&&e.pitch<=90)return{};const i=e.getCameraLngLat(),u=e.getCameraAltitude(),d=this.terrain?this.terrain.getElevationForLngLatZoom(i,e.zoom):0;if(u<d){const _=this.calculateCameraOptionsFromTo(i,d,e.center,e.elevation);return{pitch:_.pitch,zoom:_.zoom}}return{}}_applyUpdatedTransform(e){const i=[];if(i.push(d=>this._elevateCameraIfInsideTerrain(d)),this.transformCameraUpdate&&i.push(d=>this.transformCameraUpdate(d)),!i.length)return;const u=e.clone();for(const d of i){const _=u.clone(),{center:x,zoom:T,roll:E,pitch:M,bearing:D,elevation:B}=d(_);x&&_.setCenter(x),B!==void 0&&_.setElevation(B),T!==void 0&&_.setZoom(T),E!==void 0&&_.setRoll(E),M!==void 0&&_.setPitch(M),D!==void 0&&_.setBearing(D),u.apply(_)}this.transform.apply(u)}_fireMoveEvents(e){this.fire(new a.l("move",e)),this._zooming&&this.fire(new a.l("zoom",e)),this._rotating&&this.fire(new a.l("rotate",e)),this._pitching&&this.fire(new a.l("pitch",e)),this._rolling&&this.fire(new a.l("roll",e))}_afterEase(e,i){if(this._easeId&&i&&this._easeId===i)return;delete this._easeId;const u=this._zooming,d=this._rotating,_=this._pitching,x=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,u&&this.fire(new a.l("zoomend",e)),d&&this.fire(new a.l("rotateend",e)),_&&this.fire(new a.l("pitchend",e)),x&&this.fire(new a.l("rollend",e)),this.fire(new a.l("moveend",e))}flyTo(e,i){if(!e.essential&&N.prefersReducedMotion){const Ue=a.O(e,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(Ue,i)}this.stop(),e=a.e({offset:[0,0],speed:1.2,curve:1.42,easing:a.cb},e);const u=this._getTransformForUpdate(),d=u.bearing,_=u.pitch,x=u.roll,T=u.padding,E="bearing"in e?this._normalizeBearing(e.bearing,d):d,M="pitch"in e?+e.pitch:_,D="roll"in e?this._normalizeBearing(e.roll,x):x,B="padding"in e?e.padding:u.padding,O=a.P.convert(e.offset);let Z=u.centerPoint.add(O);const K=u.screenPointToLocation(Z),ne=this.cameraHelper.handleFlyTo(u,{bearing:E,pitch:M,roll:D,padding:B,locationAtOffset:K,offsetAsPoint:O,center:e.center,minZoom:e.minZoom,zoom:e.zoom});let ie=e.curve;const oe=Math.max(u.width,u.height),ce=oe/ne.scaleOfZoom,fe=ne.pixelPathLength;typeof ne.scaleOfMinZoom=="number"&&(ie=Math.sqrt(oe/ne.scaleOfMinZoom/fe*2));const me=ie*ie;function ge(Ue){const ft=(ce*ce-oe*oe+(Ue?-1:1)*me*me*fe*fe)/(2*(Ue?ce:oe)*me*fe);return Math.log(Math.sqrt(ft*ft+1)-ft)}function Te(Ue){return(Math.exp(Ue)-Math.exp(-Ue))/2}function _e(Ue){return(Math.exp(Ue)+Math.exp(-Ue))/2}const Oe=ge(!1);let De=function(Ue){return _e(Oe)/_e(Oe+ie*Ue)},Ze=function(Ue){return oe*((_e(Oe)*(Te(ft=Oe+ie*Ue)/_e(ft))-Te(Oe))/me)/fe;var ft},Ke=(ge(!0)-Oe)/ie;if(Math.abs(fe)<2e-6||!isFinite(Ke)){if(Math.abs(oe-ce)<1e-6)return this.easeTo(e,i);const Ue=ce<oe?-1:1;Ke=Math.abs(Math.log(ce/oe))/ie,Ze=()=>0,De=ft=>Math.exp(Ue*ie*ft)}return e.duration="duration"in e?+e.duration:1e3*Ke/("screenSpeed"in e?+e.screenSpeed/ie:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=d!==E,this._pitching=M!==_,this._rolling=D!==x,this._padding=!u.isPaddingEqual(B),this._prepareEase(i,!1),this.terrain&&this._prepareElevation(ne.targetCenter),this._ease(Ue=>{const ft=Ue*Ke,dt=1/De(ft),Je=Ze(ft);this._rotating&&u.setBearing(a.B.number(d,E,Ue)),this._pitching&&u.setPitch(a.B.number(_,M,Ue)),this._rolling&&u.setRoll(a.B.number(x,D,Ue)),this._padding&&(u.interpolatePadding(T,B,Ue),Z=u.centerPoint.add(O)),ne.easeFunc(Ue,dt,Je,Z),this.terrain&&!e.freezeElevation&&this._updateElevation(Ue),this._applyUpdatedTransform(u),this._fireMoveEvents(i)},()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(i)},e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,i){var u;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const d=this._onEaseEnd;delete this._onEaseEnd,d.call(this,i)}return e||(u=this.handlers)===null||u===void 0||u.stop(!1),this}_ease(e,i,u){u.animate===!1||u.duration===0?(e(1),i()):(this._easeStart=N.now(),this._easeOptions=u,this._onEaseFrame=e,this._onEaseEnd=i,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,i){e=a.aL(e,-180,180);const u=Math.abs(e-i);return Math.abs(e-360-i)<u&&(e-=360),Math.abs(e+360-i)<u&&(e+=360),e}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(a.Q.convert(e),this.transform.tileZoom):null}}const Qa={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Mt{constructor(e=Qa){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=i=>{!i||i.sourceDataType!=="metadata"&&i.sourceDataType!=="visibility"&&i.dataType!=="style"&&i.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=F.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=F.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=F.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){F.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,i){const u=this._map._getUIString(`AttributionControl.${i}`);e.title=u,e.setAttribute("aria-label",u)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map(d=>typeof d!="string"?"":d)):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const d=this._map.style.stylesheet;this.styleOwner=d.owner,this.styleId=d.id}const i=this._map.style.sourceCaches;for(const d in i){const _=i[d];if(_.used||_.usedForTerrain){const x=_.getSource();x.attribution&&e.indexOf(x.attribution)<0&&e.push(x.attribution)}}e=e.filter(d=>String(d).trim()),e.sort((d,_)=>d.length-_.length),e=e.filter((d,_)=>{for(let x=_+1;x<e.length;x++)if(e[x].indexOf(d)>=0)return!1;return!0});const u=e.join(" | ");u!==this._attribHTML&&(this._attribHTML=u,e.length?(this._innerContainer.innerHTML=F.sanitize(u),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Dt{constructor(e={}){this._updateCompact=()=>{const i=this._container.children;if(i.length){const u=i[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&u.classList.add("maplibregl-compact"):u.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=F.create("div","maplibregl-ctrl");const i=F.create("a","maplibregl-ctrl-logo");return i.target="_blank",i.rel="noopener nofollow",i.href="https://maplibre.org/",i.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),i.setAttribute("rel","noopener nofollow"),this._container.appendChild(i),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){F.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class hc{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const i=++this._id;return this._queue.push({callback:e,id:i,cancelled:!1}),i}remove(e){const i=this._currentlyRunning,u=i?this._queue.concat(i):this._queue;for(const d of u)if(d.id===e)return void(d.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const i=this._currentlyRunning=this._queue;this._queue=[];for(const u of i)if(!u.cancelled&&(u.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Vu=a.aD([{name:"a_pos3d",type:"Int16",components:3}]);class $u extends a.E{constructor(e){super(),this._lastTilesetChange=N.now(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=e._source.tileSize*2**this.deltaZoom,e.usedForTerrain=!0,e.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,i){this.sourceCache.update(e,i),this._renderableTilesKeys=[];const u={};for(const d of Pe(e,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:i,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))u[d.key]=!0,this._renderableTilesKeys.push(d.key),this._tiles[d.key]||(d.terrainRttPosMatrix32f=new Float64Array(16),a.bO(d.terrainRttPosMatrix32f,0,a.Z,a.Z,0,0,1),this._tiles[d.key]=new er(d,this.tileSize),this._lastTilesetChange=N.now());for(const d in this._tiles)u[d]||delete this._tiles[d]}freeRtt(e){for(const i in this._tiles){const u=this._tiles[i];(!e||u.tileID.equals(e)||u.tileID.isChildOf(e)||e.isChildOf(u.tileID))&&(u.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(e=>this.getTileByID(e))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e,i){return i?this._getTerrainCoordsForTileRanges(e,i):this._getTerrainCoordsForRegularTile(e)}_getTerrainCoordsForRegularTile(e){const i={};for(const u of this._renderableTilesKeys){const d=this._tiles[u].tileID,_=e.clone(),x=a.b2();if(d.canonical.equals(e.canonical))a.bO(x,0,a.Z,a.Z,0,0,1);else if(d.canonical.isChildOf(e.canonical)){const T=d.canonical.z-e.canonical.z,E=d.canonical.x-(d.canonical.x>>T<<T),M=d.canonical.y-(d.canonical.y>>T<<T),D=a.Z>>T;a.bO(x,0,D,D,0,0,1),a.L(x,x,[-E*D,-M*D,0])}else{if(!e.canonical.isChildOf(d.canonical))continue;{const T=e.canonical.z-d.canonical.z,E=e.canonical.x-(e.canonical.x>>T<<T),M=e.canonical.y-(e.canonical.y>>T<<T),D=a.Z>>T;a.bO(x,0,a.Z,a.Z,0,0,1),a.L(x,x,[E*D,M*D,0]),a.M(x,x,[1/2**T,1/2**T,0])}}_.terrainRttPosMatrix32f=new Float32Array(x),i[u]=_}return i}_getTerrainCoordsForTileRanges(e,i){const u={};for(const d of this._renderableTilesKeys){const _=this._tiles[d].tileID;if(!this._isWithinTileRanges(_,i))continue;const x=e.clone(),T=a.b2();if(_.canonical.z===e.canonical.z){const E=e.canonical.x-_.canonical.x,M=e.canonical.y-_.canonical.y;a.bO(T,0,a.Z,a.Z,0,0,1),a.L(T,T,[E*a.Z,M*a.Z,0])}else if(_.canonical.z>e.canonical.z){const E=_.canonical.z-e.canonical.z,M=_.canonical.x-(_.canonical.x>>E<<E),D=_.canonical.y-(_.canonical.y>>E<<E),B=e.canonical.x-(_.canonical.x>>E),O=e.canonical.y-(_.canonical.y>>E),Z=a.Z>>E;a.bO(T,0,Z,Z,0,0,1),a.L(T,T,[-M*Z+B*a.Z,-D*Z+O*a.Z,0])}else{const E=e.canonical.z-_.canonical.z,M=e.canonical.x-(e.canonical.x>>E<<E),D=e.canonical.y-(e.canonical.y>>E<<E),B=(e.canonical.x>>E)-_.canonical.x,O=(e.canonical.y>>E)-_.canonical.y,Z=a.Z<<E;a.bO(T,0,Z,Z,0,0,1),a.L(T,T,[M*a.Z+B*Z,D*a.Z+O*Z,0])}x.terrainRttPosMatrix32f=new Float32Array(T),u[d]=x}return u}getSourceTile(e,i){const u=this.sourceCache._source;let d=e.overscaledZ-this.deltaZoom;if(d>u.maxzoom&&(d=u.maxzoom),d<u.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(d).key);let _=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!_||!_.dem)&&i)for(;d>=u.minzoom&&(!_||!_.dem);)_=this.sourceCache.getTileByID(e.scaledTo(d--).key);return _}anyTilesAfterTime(e=Date.now()){return this._lastTilesetChange>=e}_isWithinTileRanges(e,i){return i[e.canonical.z]&&e.canonical.x>=i[e.canonical.z].minTileX&&e.canonical.x<=i[e.canonical.z].maxTileX&&e.canonical.y>=i[e.canonical.z].minTileY&&e.canonical.y<=i[e.canonical.z].maxTileY}}class cn{constructor(e,i,u){this._meshCache={},this.painter=e,this.sourceCache=new $u(i),this.options=u,this.exaggeration=typeof u.exaggeration=="number"?u.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,i,u,d=a.Z){var _;if(!(i>=0&&i<d&&u>=0&&u<d))return 0;const x=this.getTerrainData(e),T=(_=x.tile)===null||_===void 0?void 0:_.dem;if(!T)return 0;const E=a.cf([],[i/d*a.Z,u/d*a.Z],x.u_terrain_matrix),M=[E[0]*T.dim,E[1]*T.dim],D=Math.floor(M[0]),B=Math.floor(M[1]),O=M[0]-D,Z=M[1]-B;return T.get(D,B)*(1-O)*(1-Z)+T.get(D+1,B)*O*(1-Z)+T.get(D,B+1)*(1-O)*Z+T.get(D+1,B+1)*O*Z}getElevationForLngLatZoom(e,i){if(!a.cg(i,e.wrap()))return 0;const{tileID:u,mercatorX:d,mercatorY:_}=this._getOverscaledTileIDFromLngLatZoom(e,i);return this.getElevation(u,d%a.Z,_%a.Z,a.Z)}getElevation(e,i,u,d=a.Z){return this.getDEMElevation(e,i,u,d)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const d=this.painter.context,_=new a.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new Ie(d,_,d.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new Ie(d,new a.R({width:1,height:1}),d.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(d.gl.NEAREST,d.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=a.at([])}const i=this.sourceCache.getSourceTile(e,!0);if(i&&i.dem&&(!i.demTexture||i.needsTerrainPrepare)){const d=this.painter.context;i.demTexture=this.painter.getTileTexture(i.dem.stride),i.demTexture?i.demTexture.update(i.dem.getPixels(),{premultiply:!1}):i.demTexture=new Ie(d,i.dem.getPixels(),d.gl.RGBA,{premultiply:!1}),i.demTexture.bind(d.gl.NEAREST,d.gl.CLAMP_TO_EDGE),i.needsTerrainPrepare=!1}const u=i&&i+i.tileID.key+e.key;if(u&&!this._demMatrixCache[u]){const d=this.sourceCache.sourceCache._source.maxzoom;let _=e.canonical.z-i.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=d?_=e.canonical.z-d:a.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const x=e.canonical.x-(e.canonical.x>>_<<_),T=e.canonical.y-(e.canonical.y>>_<<_),E=a.ch(new Float64Array(16),[1/(a.Z<<_),1/(a.Z<<_),0]);a.L(E,E,[x*a.Z,T*a.Z,0]),this._demMatrixCache[e.key]={matrix:E,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:i&&i.dem&&i.dem.dim||1,u_terrain_matrix:u?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:i&&i.dem&&i.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(i&&i.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:i}}getFramebuffer(e){const i=this.painter,u=i.width/devicePixelRatio,d=i.height/devicePixelRatio;return!this._fbo||this._fbo.width===u&&this._fbo.height===d||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new Ie(i.context,{width:u,height:d,data:null},i.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(i.context.gl.NEAREST,i.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new Ie(i.context,{width:u,height:d,data:null},i.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(i.context.gl.NEAREST,i.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=i.context.createFramebuffer(u,d,!0,!1),this._fbo.depthAttachment.set(i.context.createRenderbuffer(i.context.gl.DEPTH_COMPONENT16,u,d))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const i=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let _=0,x=0;_<this._coordsTextureSize;_++)for(let T=0;T<this._coordsTextureSize;T++,x+=4)i[x+0]=255&T,i[x+1]=255&_,i[x+2]=T>>8<<4|_>>8,i[x+3]=0;const u=new a.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(i.buffer)),d=new Ie(e,u,e.gl.RGBA,{premultiply:!1});return d.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=d,d}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const i=new Uint8Array(4),u=this.painter.context,d=u.gl,_=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),x=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),T=Math.round(this.painter.height/devicePixelRatio);u.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),d.readPixels(_,T-x-1,1,1,d.RGBA,d.UNSIGNED_BYTE,i),u.bindFramebuffer.set(null);const E=i[0]+(i[2]>>4<<8),M=i[1]+((15&i[2])<<8),D=this.coordsIndex[255-i[3]],B=D&&this.sourceCache.getTileByID(D);if(!B)return null;const O=this._coordsTextureSize,Z=(1<<B.tileID.canonical.z)*O;return new a.$((B.tileID.canonical.x*O+E)/Z+B.tileID.wrap,(B.tileID.canonical.y*O+M)/Z,this.getElevation(B.tileID,E,M,O))}depthAtPoint(e){const i=new Uint8Array(4),u=this.painter.context,d=u.gl;return u.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),d.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,d.RGBA,d.UNSIGNED_BYTE,i),u.bindFramebuffer.set(null),(i[0]/16777216+i[1]/65536+i[2]/256+i[3])/256}getTerrainMesh(e){var i;const u=((i=this.painter.style.projection)===null||i===void 0?void 0:i.transitionState)>0,d=u&&e.canonical.y===0,_=u&&e.canonical.y===(1<<e.canonical.z)-1,x=`m_${d?"n":""}_${_?"s":""}`;if(this._meshCache[x])return this._meshCache[x];const T=this.painter.context,E=new a.ci,M=new a.aH,D=this.meshSize,B=a.Z/D,O=D*D;for(let _e=0;_e<=D;_e++)for(let Oe=0;Oe<=D;Oe++)E.emplaceBack(Oe*B,_e*B,0);for(let _e=0;_e<O;_e+=D+1)for(let Oe=0;Oe<D;Oe++)M.emplaceBack(Oe+_e,D+Oe+_e+1,D+Oe+_e+2),M.emplaceBack(Oe+_e,D+Oe+_e+2,Oe+_e+1);const Z=E.length,K=Z+(D+1),ne=(D+1)*D,ie=d?a.b9:0,oe=d?0:1,ce=_?a.ba:a.Z,fe=_?0:1;for(let _e=0;_e<=D;_e++)E.emplaceBack(_e*B,ie,oe);for(let _e=0;_e<=D;_e++)E.emplaceBack(_e*B,ce,fe);for(let _e=0;_e<D;_e++)M.emplaceBack(ne+_e,K+_e,K+_e+1),M.emplaceBack(ne+_e,K+_e+1,ne+_e+1),M.emplaceBack(0+_e,Z+_e+1,Z+_e),M.emplaceBack(0+_e,0+_e+1,Z+_e+1);const me=E.length,ge=me+2*(D+1);for(const _e of[0,1])for(let Oe=0;Oe<=D;Oe++)for(const De of[0,1])E.emplaceBack(_e*a.Z,Oe*B,De);for(let _e=0;_e<2*D;_e+=2)M.emplaceBack(me+_e,me+_e+1,me+_e+3),M.emplaceBack(me+_e,me+_e+3,me+_e+2),M.emplaceBack(ge+_e,ge+_e+3,ge+_e+1),M.emplaceBack(ge+_e,ge+_e+2,ge+_e+3);const Te=new is(T.createVertexBuffer(E,Vu.members),T.createIndexBuffer(M),a.aG.simpleSegment(0,0,E.length,M.length));return this._meshCache[x]=Te,Te}getMeshFrameDelta(e){return 2*Math.PI*a.br/Math.pow(2,Math.max(e,0))/5}getMinTileElevationForLngLatZoom(e,i){var u;const{tileID:d}=this._getOverscaledTileIDFromLngLatZoom(e,i);return(u=this.getMinMaxElevation(d).minElevation)!==null&&u!==void 0?u:0}getMinMaxElevation(e){const i=this.getTerrainData(e).tile,u={minElevation:null,maxElevation:null};return i&&i.dem&&(u.minElevation=i.dem.min*this.exaggeration,u.maxElevation=i.dem.max*this.exaggeration),u}_getOverscaledTileIDFromLngLatZoom(e,i){const u=a.$.fromLngLat(e.wrap()),d=(1<<i)*a.Z,_=u.x*d,x=u.y*d,T=Math.floor(_/a.Z),E=Math.floor(x/a.Z);return{tileID:new a.Y(i,0,i,T,E),mercatorX:_,mercatorY:x}}}class nf{constructor(e,i,u){this._context=e,this._size=i,this._tileSize=u,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const i=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),u=new Ie(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return u.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),i.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),i.colorAttachment.set(u.texture),{id:e,fbo:i,texture:u,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(i=>e.id!==i),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const i of this._recentlyUsed)if(!this._objects[i].inUse)return this._objects[i];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(e=>!e.inUse)===!1}}const Ji={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class om{constructor(e,i){this.painter=e,this.terrain=i,this.pool=new nf(e.context,30,i.sourceCache.tileSize*i.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,i){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter(u=>!e._layers[u].isHidden(i)),this._coordsAscending={};for(const u in e.sourceCaches){this._coordsAscending[u]={};const d=e.sourceCaches[u].getVisibleCoordinates(),_=e.sourceCaches[u].getSource(),x=_ instanceof ut?_.terrainTileRanges:null;for(const T of d){const E=this.terrain.sourceCache.getTerrainCoords(T,x);for(const M in E)this._coordsAscending[u][M]||(this._coordsAscending[u][M]=[]),this._coordsAscending[u][M].push(E[M])}}this._coordsAscendingStr={};for(const u of e._order){const d=e._layers[u],_=d.source;if(Ji[d.type]&&!this._coordsAscendingStr[_]){this._coordsAscendingStr[_]={};for(const x in this._coordsAscending[_])this._coordsAscendingStr[_][x]=this._coordsAscending[_][x].map(T=>T.key).sort().join()}}for(const u of this._renderableTiles)for(const d in this._coordsAscendingStr){const _=this._coordsAscendingStr[d][u.tileID.key];_&&_!==u.rttCoords[d]&&(u.rtt=[])}}renderLayer(e,i){if(e.isHidden(this.painter.transform.zoom))return!1;const u=Object.assign(Object.assign({},i),{isRenderingToTexture:!0}),d=e.type,_=this.painter,x=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(Ji[d]&&(this._prevType&&Ji[this._prevType]||this._stacks.push([]),this._prevType=d,this._stacks[this._stacks.length-1].push(e.id),!x))return!0;if(Ji[this._prevType]||Ji[d]&&x){this._prevType=d;const T=this._stacks.length-1,E=this._stacks[T]||[];for(const M of this._renderableTiles){if(this.pool.isFull()&&(ac(this.painter,this.terrain,this._rttTiles,u),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(M),M.rtt[T]){const B=this.pool.getObjectForId(M.rtt[T].id);if(B.stamp===M.rtt[T].stamp){this.pool.useObject(B);continue}}const D=this.pool.getOrCreateFreeObject();this.pool.useObject(D),this.pool.stampObject(D),M.rtt[T]={id:D.id,stamp:D.stamp},_.context.bindFramebuffer.set(D.fbo.framebuffer),_.context.clear({color:a.b7.transparent,stencil:0}),_.currentStencilSource=void 0;for(let B=0;B<E.length;B++){const O=_.style._layers[E[B]],Z=O.source?this._coordsAscending[O.source][M.tileID.key]:[M.tileID];_.context.viewport.set([0,0,D.fbo.width,D.fbo.height]),_._renderTileClippingMasks(O,Z,!0),_.renderLayer(_,_.style.sourceCaches[O.source],O,Z,u),O.source&&(M.rttCoords[O.source]=this._coordsAscendingStr[O.source][M.tileID.key])}}return ac(this.painter,this.terrain,this._rttTiles,u),this._rttTiles=[],this.pool.freeAllObjects(),Ji[d]}return!1}}const el={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Yr=I,oi={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Qa,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:a.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},of={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class tl{constructor(e,i,u=!1){this.mousedown=_=>{this.startMove(_,F.mousePos(this.element,_)),F.addEventListener(window,"mousemove",this.mousemove),F.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=_=>{this.move(_,F.mousePos(this.element,_))},this.mouseup=_=>{this._rotatePitchHanlder.dragEnd(_),this.offTemp()},this.touchstart=_=>{_.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=F.touchPos(this.element,_.targetTouches)[0],this.startMove(_,this._startPos),F.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),F.addEventListener(window,"touchend",this.touchend))},this.touchmove=_=>{_.targetTouches.length!==1?this.reset():(this._lastPos=F.touchPos(this.element,_.targetTouches)[0],this.move(_,this._lastPos))},this.touchend=_=>{_.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHanlder.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=i;const d=new Yd;this._rotatePitchHanlder=new sa({clickTolerance:3,move:(_,x)=>{const T=i.getBoundingClientRect(),E=new a.P((T.bottom-T.top)/2,(T.right-T.left)/2);return{bearingDelta:a.ca(new a.P(_.x,x.y),x,E),pitchDelta:u?-.5*(x.y-_.y):void 0}},moveStateManager:d,enable:!0,assignEvents:()=>{}}),this.map=e,F.addEventListener(i,"mousedown",this.mousedown),F.addEventListener(i,"touchstart",this.touchstart,{passive:!1}),F.addEventListener(i,"touchcancel",this.reset)}startMove(e,i){this._rotatePitchHanlder.dragStart(e,i),F.disableDrag()}move(e,i){const u=this.map,{bearingDelta:d,pitchDelta:_}=this._rotatePitchHanlder.dragMove(e,i)||{};d&&u.setBearing(u.getBearing()+d),_&&u.setPitch(u.getPitch()+_)}off(){const e=this.element;F.removeEventListener(e,"mousedown",this.mousedown),F.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),F.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),F.removeEventListener(window,"touchend",this.touchend),F.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){F.enableDrag(),F.removeEventListener(window,"mousemove",this.mousemove),F.removeEventListener(window,"mouseup",this.mouseup),F.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),F.removeEventListener(window,"touchend",this.touchend)}}let Jn;function dc(g,e,i){const u=new a.Q(g.lng,g.lat);if(g=new a.Q(g.lng,g.lat),e){const d=new a.Q(g.lng-360,g.lat),_=new a.Q(g.lng+360,g.lat),x=i.locationToScreenPoint(g).distSqr(e);i.locationToScreenPoint(d).distSqr(e)<x?g=d:i.locationToScreenPoint(_).distSqr(e)<x&&(g=_)}for(;Math.abs(g.lng-i.center.lng)>180;){const d=i.locationToScreenPoint(g);if(d.x>=0&&d.y>=0&&d.x<=i.width&&d.y<=i.height)break;g.lng>i.center.lng?g.lng-=360:g.lng+=360}return g.lng!==u.lng&&i.isPointOnMapSurface(i.locationToScreenPoint(g))?g:u}const rl={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function fc(g,e,i){const u=g.classList;for(const d in rl)u.remove(`maplibregl-${i}-anchor-${d}`);u.add(`maplibregl-${i}-anchor-${e}`)}class ps extends a.E{constructor(e){if(super(),this._onKeyPress=i=>{const u=i.code,d=i.charCode||i.keyCode;u!=="Space"&&u!=="Enter"&&d!==32&&d!==13||this.togglePopup()},this._onMapClick=i=>{const u=i.originalEvent.target,d=this._element;this._popup&&(u===d||d.contains(u))&&this.togglePopup()},this._update=i=>{var u;if(!this._map)return;const d=this._map.loaded()&&!this._map.isMoving();((i==null?void 0:i.type)==="terrain"||(i==null?void 0:i.type)==="render"&&!d)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?dc(this._lngLat,this._flatPos,this._map.transform):(u=this._lngLat)===null||u===void 0?void 0:u.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let _="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?_=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(_=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let x="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?x="rotateX(0deg)":this._pitchAlignment==="map"&&(x=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||i&&i.type!=="moveend"||(this._pos=this._pos.round()),F.setTransform(this._element,`${rl[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${x} ${_}`),N.frameAsync(new AbortController).then(()=>{this._updateOpacity(i&&i.type==="moveend")}).catch(()=>{})},this._onMove=i=>{if(!this._isDragging){const u=this._clickTolerance||this._map._clickTolerance;this._isDragging=i.point.dist(this._pointerdownPos)>=u}this._isDragging&&(this._pos=i.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.l("dragstart"))),this.fire(new a.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.l("dragend")),this._state="inactive"},this._addDragHandler=i=>{this._element.contains(i.originalEvent.target)&&(i.preventDefault(),this._positionDelta=i.point.sub(this._pos).add(this._offset),this._pointerdownPos=i.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(e==null?void 0:e.opacity,e==null?void 0:e.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=a.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=F.create("div");const i=F.createNS("http://www.w3.org/2000/svg","svg"),u=41,d=27;i.setAttributeNS(null,"display","block"),i.setAttributeNS(null,"height",`${u}px`),i.setAttributeNS(null,"width",`${d}px`),i.setAttributeNS(null,"viewBox",`0 0 ${d} ${u}`);const _=F.createNS("http://www.w3.org/2000/svg","g");_.setAttributeNS(null,"stroke","none"),_.setAttributeNS(null,"stroke-width","1"),_.setAttributeNS(null,"fill","none"),_.setAttributeNS(null,"fill-rule","evenodd");const x=F.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"fill-rule","nonzero");const T=F.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"transform","translate(3.0, 29.0)"),T.setAttributeNS(null,"fill","#000000");const E=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const oe of E){const ce=F.createNS("http://www.w3.org/2000/svg","ellipse");ce.setAttributeNS(null,"opacity","0.04"),ce.setAttributeNS(null,"cx","10.5"),ce.setAttributeNS(null,"cy","5.80029008"),ce.setAttributeNS(null,"rx",oe.rx),ce.setAttributeNS(null,"ry",oe.ry),T.appendChild(ce)}const M=F.createNS("http://www.w3.org/2000/svg","g");M.setAttributeNS(null,"fill",this._color);const D=F.createNS("http://www.w3.org/2000/svg","path");D.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),M.appendChild(D);const B=F.createNS("http://www.w3.org/2000/svg","g");B.setAttributeNS(null,"opacity","0.25"),B.setAttributeNS(null,"fill","#000000");const O=F.createNS("http://www.w3.org/2000/svg","path");O.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),B.appendChild(O);const Z=F.createNS("http://www.w3.org/2000/svg","g");Z.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Z.setAttributeNS(null,"fill","#FFFFFF");const K=F.createNS("http://www.w3.org/2000/svg","g");K.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ne=F.createNS("http://www.w3.org/2000/svg","circle");ne.setAttributeNS(null,"fill","#000000"),ne.setAttributeNS(null,"opacity","0.25"),ne.setAttributeNS(null,"cx","5.5"),ne.setAttributeNS(null,"cy","5.5"),ne.setAttributeNS(null,"r","5.4999962");const ie=F.createNS("http://www.w3.org/2000/svg","circle");ie.setAttributeNS(null,"fill","#FFFFFF"),ie.setAttributeNS(null,"cx","5.5"),ie.setAttributeNS(null,"cy","5.5"),ie.setAttributeNS(null,"r","5.4999962"),K.appendChild(ne),K.appendChild(ie),x.appendChild(T),x.appendChild(M),x.appendChild(B),x.appendChild(Z),x.appendChild(K),i.appendChild(x),i.setAttributeNS(null,"height",u*this._scale+"px"),i.setAttributeNS(null,"width",d*this._scale+"px"),this._element.appendChild(i),this._offset=a.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",i=>{i.preventDefault()}),this._element.addEventListener("mousedown",i=>{i.preventDefault()}),fc(this._element,this._anchor,"marker"),e&&e.className)for(const i of e.className.split(" "))this._element.classList.add(i);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),e.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),F.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=a.Q.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const d=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[d,-1*(38.1-13.5+d)],"bottom-right":[-d,-1*(38.1-13.5+d)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var i,u;if(!(!((i=this._map)===null||i===void 0)&&i.terrain)){const B=this._map.transform.isLocationOccluded(this._lngLat)?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==B&&(this._element.style.opacity=B))}if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const d=this._map,_=d.terrain.depthAtPoint(this._pos),x=d.terrain.getElevationForLngLatZoom(this._lngLat,d.transform.tileZoom);if(d.transform.lngLatToCameraDepth(this._lngLat,x)-_<.006)return void(this._element.style.opacity=this._opacity);const T=-this._offset.y/d.transform.pixelsPerMeter,E=Math.sin(d.getPitch()*Math.PI/180)*T,M=d.terrain.depthAtPoint(new a.P(this._pos.x,this._pos.y-this._offset.y)),D=d.transform.lngLatToCameraDepth(this._lngLat,x+E)-M>.006;!((u=this._popup)===null||u===void 0)&&u.isOpen()&&D&&this._popup.remove(),this._element.style.opacity=D?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=a.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,i){return(this._opacity===void 0||e===void 0&&i===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),i!==void 0&&(this._opacityWhenCovered=i),this._map&&this._updateOpacity(!0),this}}const Uu={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let la=0,ms=!1;const Gu={maxWidth:100,unit:"metric"};function pc(g,e,i){const u=i&&i.maxWidth||100,d=g._container.clientHeight/2,_=g._container.clientWidth/2,x=g.unproject([_-u/2,d]),T=g.unproject([_+u/2,d]),E=Math.round(g.project(T).x-g.project(x).x),M=Math.min(u,E,g._container.clientWidth),D=x.distanceTo(T);if(i&&i.unit==="imperial"){const B=3.2808*D;B>5280?gs(e,M,B/5280,g._getUIString("ScaleControl.Miles")):gs(e,M,B,g._getUIString("ScaleControl.Feet"))}else i&&i.unit==="nautical"?gs(e,M,D/1852,g._getUIString("ScaleControl.NauticalMiles")):D>=1e3?gs(e,M,D/1e3,g._getUIString("ScaleControl.Kilometers")):gs(e,M,D,g._getUIString("ScaleControl.Meters"))}function gs(g,e,i,u){const d=function(_){const x=Math.pow(10,`${Math.floor(_)}`.length-1);let T=_/x;return T=T>=10?10:T>=5?5:T>=3?3:T>=2?2:T>=1?1:function(E){const M=Math.pow(10,Math.ceil(-Math.log(E)/Math.LN10));return Math.round(E*M)/M}(T),x*T}(i);g.style.width=e*(d/i)+"px",g.innerHTML=`${d}&nbsp;${u}`}const Zu={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},qu=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function il(g){if(g){if(typeof g=="number"){const e=Math.round(Math.abs(g)/Math.SQRT2);return{center:new a.P(0,0),top:new a.P(0,g),"top-left":new a.P(e,e),"top-right":new a.P(-e,e),bottom:new a.P(0,-g),"bottom-left":new a.P(e,-e),"bottom-right":new a.P(-e,-e),left:new a.P(g,0),right:new a.P(-g,0)}}if(g instanceof a.P||Array.isArray(g)){const e=a.P.convert(g);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:a.P.convert(g.center||[0,0]),top:a.P.convert(g.top||[0,0]),"top-left":a.P.convert(g["top-left"]||[0,0]),"top-right":a.P.convert(g["top-right"]||[0,0]),bottom:a.P.convert(g.bottom||[0,0]),"bottom-left":a.P.convert(g["bottom-left"]||[0,0]),"bottom-right":a.P.convert(g["bottom-right"]||[0,0]),left:a.P.convert(g.left||[0,0]),right:a.P.convert(g.right||[0,0])}}return il(new a.P(0,0))}const Hu=I;m.AJAXError=a.cm,m.Event=a.l,m.Evented=a.E,m.LngLat=a.Q,m.MercatorCoordinate=a.$,m.Point=a.P,m.addProtocol=a.cn,m.config=a.a,m.removeProtocol=a.co,m.AttributionControl=Mt,m.BoxZoomHandler=ds,m.CanvasSource=lt,m.CooperativeGesturesHandler=cc,m.DoubleClickZoomHandler=Nu,m.DragPanHandler=mo,m.DragRotateHandler=Dr,m.EdgeInsets=jr,m.FullscreenControl=class extends a.E{constructor(g={}){super(),this._onFullscreenChange=()=>{var e;let i=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((e=i==null?void 0:i.shadowRoot)===null||e===void 0)&&e.fullscreenElement;)i=i.shadowRoot.fullscreenElement;i===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,g&&g.container&&(g.container instanceof HTMLElement?this._container=g.container:a.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(g){return this._map=g,this._container||(this._container=this._map.getContainer()),this._controlContainer=F.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){F.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const g=this._fullscreenButton=F.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);F.create("span","maplibregl-ctrl-icon",g).setAttribute("aria-hidden","true"),g.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const g=this._getTitle();this._fullscreenButton.setAttribute("aria-label",g),this._fullscreenButton.title=g}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new a.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new a.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},m.GeoJSONSource=_t,m.GeolocateControl=class extends a.E{constructor(g){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new a.l("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(e),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new a.l("geolocate",e)),this._finish()}},this._updateCamera=e=>{const i=new a.Q(e.coords.longitude,e.coords.latitude),u=e.coords.accuracy,d=this._map.getBearing(),_=a.e({bearing:d},this.options.fitBoundsOptions),x=we.fromLngLat(i,u);this._map.fitBounds(x,_,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const i=new a.Q(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(i).addTo(this._map),this._userLocationDotMarker.setLngLat(i).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=e=>{if(this._map){if(this.options.trackUserLocation)if(e.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(e.code===3&&ms)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new a.l("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",e=>e.preventDefault()),this._geolocateButton=F.create("button","maplibregl-ctrl-geolocate",this._container),F.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(e===!1){a.w("Geolocation support is not available so the GeolocateControl will be disabled.");const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i)}else{const i=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=F.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new ps({element:this._dotElement}),this._circleElement=F.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ps({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",i=>{i.geolocateSource||this._watchState!=="ACTIVE_LOCK"||i.originalEvent&&i.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new a.l("trackuserlocationend")),this.fire(new a.l("userlocationlostfocus")))})}},this.options=a.e({},Uu,g)}onAdd(g){return this._map=g,this._container=F.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return a._(this,arguments,void 0,function*(e=!1){if(Jn!==void 0&&!e)return Jn;if(window.navigator.permissions===void 0)return Jn=!!window.navigator.geolocation,Jn;try{Jn=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Jn=!!window.navigator.geolocation}return Jn})}().then(e=>this._finishSetupUI(e)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),F.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,la=0,ms=!1}_isOutOfMapMaxBounds(g){const e=this._map.getMaxBounds(),i=g.coords;return e&&(i.longitude<e.getWest()||i.longitude>e.getEast()||i.latitude<e.getSouth()||i.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const g=this._map.getBounds(),e=g.getSouthEast(),i=g.getNorthEast(),u=e.distanceTo(i),d=Math.ceil(this._accuracy/(u/this._map._container.clientHeight)*2);this._circleElement.style.width=`${d}px`,this._circleElement.style.height=`${d}px`}trigger(){if(!this._setup)return a.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":la--,ms=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new a.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.l("trackuserlocationstart")),this.fire(new a.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let g;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),la++,la>1?(g={maximumAge:6e5,timeout:0},ms=!0):(g=this.options.positionOptions,ms=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,g)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},m.GlobeControl=class{constructor(){this._toggleProjection=()=>{var g;const e=(g=this._map.getProjection())===null||g===void 0?void 0:g.type;this._map.setProjection(e!=="mercator"&&e?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var g;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((g=this._map.getProjection())===null||g===void 0?void 0:g.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(g){return this._map=g,this._container=F.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=F.create("button","maplibregl-ctrl-globe",this._container),F.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){F.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},m.Hash=zu,m.ImageSource=ut,m.KeyboardHandler=Fu,m.LngLatBounds=we,m.LogoControl=Dt,m.Map=class extends Yn{constructor(g){var e,i;a.cj.mark(a.ck.create);const u=Object.assign(Object.assign(Object.assign({},oi),g),{canvasContextAttributes:Object.assign(Object.assign({},oi.canvasContextAttributes),g.canvasContextAttributes)});if(u.minZoom!=null&&u.maxZoom!=null&&u.minZoom>u.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(u.minPitch!=null&&u.maxPitch!=null&&u.minPitch>u.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(u.minPitch!=null&&u.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(u.maxPitch!=null&&u.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const d=new Nr,_=new an;if(u.minZoom!==void 0&&d.setMinZoom(u.minZoom),u.maxZoom!==void 0&&d.setMaxZoom(u.maxZoom),u.minPitch!==void 0&&d.setMinPitch(u.minPitch),u.maxPitch!==void 0&&d.setMaxPitch(u.maxPitch),u.renderWorldCopies!==void 0&&d.setRenderWorldCopies(u.renderWorldCopies),super(d,_,{bearingSnap:u.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new hc,this._controls=[],this._mapId=a.a4(),this._contextLost=T=>{T.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new a.l("webglcontextlost",{originalEvent:T}))},this._contextRestored=T=>{this._setupPainter(),this.resize(),this._update(),this.fire(new a.l("webglcontextrestored",{originalEvent:T}))},this._onMapScroll=T=>{if(T.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=u.interactive,this._maxTileCacheSize=u.maxTileCacheSize,this._maxTileCacheZoomLevels=u.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},u.canvasContextAttributes),this._trackResize=u.trackResize===!0,this._bearingSnap=u.bearingSnap,this._centerClampedToGround=u.centerClampedToGround,this._refreshExpiredTiles=u.refreshExpiredTiles===!0,this._fadeDuration=u.fadeDuration,this._crossSourceCollisions=u.crossSourceCollisions===!0,this._collectResourceTiming=u.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},el),u.locale),this._clickTolerance=u.clickTolerance,this._overridePixelRatio=u.pixelRatio,this._maxCanvasSize=u.maxCanvasSize,this.transformCameraUpdate=u.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=u.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=re.addThrottleControl(()=>this.isMoving()),this._requestManager=new J(u.transformRequest),typeof u.container=="string"){if(this._container=document.getElementById(u.container),!this._container)throw new Error(`Container '${u.container}' not found.`)}else{if(!(u.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=u.container}if(u.maxBounds&&this.setMaxBounds(u.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let T=!1;const E=Lu(M=>{this._trackResize&&!this._removed&&(this.resize(M),this.redraw())},50);this._resizeObserver=new ResizeObserver(M=>{T?E(M):T=!0}),this._resizeObserver.observe(this._container)}this.handlers=new nm(this,u),this._hash=u.hash&&new zu(typeof u.hash=="string"&&u.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:u.center,elevation:u.elevation,zoom:u.zoom,bearing:u.bearing,pitch:u.pitch,roll:u.roll}),u.bounds&&(this.resize(),this.fitBounds(u.bounds,a.e({},u.fitBoundsOptions,{duration:0}))));const x=typeof u.style=="string"||((i=(e=u.style)===null||e===void 0?void 0:e.projection)===null||i===void 0?void 0:i.type)!=="globe";this.resize(null,x),this._localIdeographFontFamily=u.localIdeographFontFamily,this._validateStyle=u.validateStyle,u.style&&this.setStyle(u.style,{localIdeographFontFamily:u.localIdeographFontFamily}),u.attributionControl&&this.addControl(new Mt(typeof u.attributionControl=="boolean"?void 0:u.attributionControl)),u.maplibreLogo&&this.addControl(new Dt,u.logoPosition),this.on("style.load",()=>{if(x||this._resizeTransform(),this.transform.unmodified){const T=a.O(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(T)}}),this.on("data",T=>{this._update(T.dataType==="style"),this.fire(new a.l(`${T.dataType}data`,T))}),this.on("dataloading",T=>{this.fire(new a.l(`${T.dataType}dataloading`,T))}),this.on("dataabort",T=>{this.fire(new a.l("sourcedataabort",T))})}_getMapId(){return this._mapId}addControl(g,e){if(e===void 0&&(e=g.getDefaultPosition?g.getDefaultPosition():"top-right"),!g||!g.onAdd)return this.fire(new a.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const i=g.onAdd(this);this._controls.push(g);const u=this._controlPositions[e];return e.indexOf("bottom")!==-1?u.insertBefore(i,u.firstChild):u.appendChild(i),this}removeControl(g){if(!g||!g.onRemove)return this.fire(new a.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(g);return e>-1&&this._controls.splice(e,1),g.onRemove(this),this}hasControl(g){return this._controls.indexOf(g)>-1}calculateCameraOptionsFromTo(g,e,i,u){return u==null&&this.terrain&&(u=this.terrain.getElevationForLngLatZoom(i,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(g,e,i,u)}resize(g,e=!0){const[i,u]=this._containerDimensions(),d=this._getClampedPixelRatio(i,u);if(this._resizeCanvas(i,u,d),this.painter.resize(i,u,d),this.painter.overLimit()){const x=this.painter.context.gl;this._maxCanvasSize=[x.drawingBufferWidth,x.drawingBufferHeight];const T=this._getClampedPixelRatio(i,u);this._resizeCanvas(i,u,T),this.painter.resize(i,u,T)}this._resizeTransform(e);const _=!this._moving;return _&&(this.stop(),this.fire(new a.l("movestart",g)).fire(new a.l("move",g))),this.fire(new a.l("resize",g)),_&&this.fire(new a.l("moveend",g)),this}_resizeTransform(g=!0){var e;const[i,u]=this._containerDimensions();this.transform.resize(i,u,g),(e=this._requestedCameraState)===null||e===void 0||e.resize(i,u,g)}_getClampedPixelRatio(g,e){const{0:i,1:u}=this._maxCanvasSize,d=this.getPixelRatio(),_=g*d,x=e*d;return Math.min(_>i?i/_:1,x>u?u/x:1)*d}getPixelRatio(){var g;return(g=this._overridePixelRatio)!==null&&g!==void 0?g:devicePixelRatio}setPixelRatio(g){this._overridePixelRatio=g,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(g){return this.transform.setMaxBounds(we.convert(g)),this._update()}setMinZoom(g){if((g=g??-2)>=-2&&g<=this.transform.maxZoom)return this.transform.setMinZoom(g),this._update(),this.getZoom()<g&&this.setZoom(g),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(g){if((g=g??22)>=this.transform.minZoom)return this.transform.setMaxZoom(g),this._update(),this.getZoom()>g&&this.setZoom(g),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(g){if((g=g??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(g>=0&&g<=this.transform.maxPitch)return this.transform.setMinPitch(g),this._update(),this.getPitch()<g&&this.setPitch(g),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(g){if((g=g??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(g>=this.transform.minPitch)return this.transform.setMaxPitch(g),this._update(),this.getPitch()>g&&this.setPitch(g),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(g){return this.transform.setRenderWorldCopies(g),this._update()}project(g){return this.transform.locationToScreenPoint(a.Q.convert(g),this.style&&this.terrain)}unproject(g){return this.transform.screenPointToLocation(a.P.convert(g),this.terrain)}isMoving(){var g;return this._moving||((g=this.handlers)===null||g===void 0?void 0:g.isMoving())}isZooming(){var g;return this._zooming||((g=this.handlers)===null||g===void 0?void 0:g.isZooming())}isRotating(){var g;return this._rotating||((g=this.handlers)===null||g===void 0?void 0:g.isRotating())}_createDelegatedListener(g,e,i){if(g==="mouseenter"||g==="mouseover"){let u=!1;return{layers:e,listener:i,delegates:{mousemove:_=>{const x=e.filter(E=>this.getLayer(E)),T=x.length!==0?this.queryRenderedFeatures(_.point,{layers:x}):[];T.length?u||(u=!0,i.call(this,new $i(g,this,_.originalEvent,{features:T}))):u=!1},mouseout:()=>{u=!1}}}}if(g==="mouseleave"||g==="mouseout"){let u=!1;return{layers:e,listener:i,delegates:{mousemove:x=>{const T=e.filter(E=>this.getLayer(E));(T.length!==0?this.queryRenderedFeatures(x.point,{layers:T}):[]).length?u=!0:u&&(u=!1,i.call(this,new $i(g,this,x.originalEvent)))},mouseout:x=>{u&&(u=!1,i.call(this,new $i(g,this,x.originalEvent)))}}}}{const u=d=>{const _=e.filter(T=>this.getLayer(T)),x=_.length!==0?this.queryRenderedFeatures(d.point,{layers:_}):[];x.length&&(d.features=x,i.call(this,d),delete d.features)};return{layers:e,listener:i,delegates:{[g]:u}}}}_saveDelegatedListener(g,e){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[g]=this._delegatedListeners[g]||[],this._delegatedListeners[g].push(e)}_removeDelegatedListener(g,e,i){if(!this._delegatedListeners||!this._delegatedListeners[g])return;const u=this._delegatedListeners[g];for(let d=0;d<u.length;d++){const _=u[d];if(_.listener===i&&_.layers.length===e.length&&_.layers.every(x=>e.includes(x))){for(const x in _.delegates)this.off(x,_.delegates[x]);return void u.splice(d,1)}}}on(g,e,i){if(i===void 0)return super.on(g,e);const u=typeof e=="string"?[e]:e,d=this._createDelegatedListener(g,u,i);this._saveDelegatedListener(g,d);for(const _ in d.delegates)this.on(_,d.delegates[_]);return{unsubscribe:()=>{this._removeDelegatedListener(g,u,i)}}}once(g,e,i){if(i===void 0)return super.once(g,e);const u=typeof e=="string"?[e]:e,d=this._createDelegatedListener(g,u,i);for(const _ in d.delegates){const x=d.delegates[_];d.delegates[_]=(...T)=>{this._removeDelegatedListener(g,u,i),x(...T)}}this._saveDelegatedListener(g,d);for(const _ in d.delegates)this.once(_,d.delegates[_]);return this}off(g,e,i){return i===void 0?super.off(g,e):(this._removeDelegatedListener(g,typeof e=="string"?[e]:e,i),this)}queryRenderedFeatures(g,e){if(!this.style)return[];let i;const u=g instanceof a.P||Array.isArray(g),d=u?g:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(u?{}:g)||{},d instanceof a.P||typeof d[0]=="number")i=[a.P.convert(d)];else{const _=a.P.convert(d[0]),x=a.P.convert(d[1]);i=[_,new a.P(x.x,_.y),x,new a.P(_.x,x.y),_]}return this.style.queryRenderedFeatures(i,e,this.transform)}querySourceFeatures(g,e){return this.style.querySourceFeatures(g,e)}setStyle(g,e){return(e=a.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&g?(this._diffStyle(g,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(g,e))}setTransformRequest(g){return this._requestManager.setTransformRequest(g),this}_getUIString(g){const e=this._locale[g];if(e==null)throw new Error(`Missing UI string '${g}'`);return e}_updateStyle(g,e){var i,u;if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(g,e));const d=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!g)),g?(this.style=new qs(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof g=="string"?this.style.loadURL(g,e,d):this.style.loadJSON(g,e,d),this):((u=(i=this.style)===null||i===void 0?void 0:i.projection)===null||u===void 0||u.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new qs(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(g,e){if(typeof g=="string"){const i=this._requestManager.transformRequest(g,"Style");a.j(i,new AbortController).then(u=>{this._updateDiff(u.data,e)}).catch(u=>{u&&this.fire(new a.k(u))})}else typeof g=="object"&&this._updateDiff(g,e)}_updateDiff(g,e){try{this.style.setState(g,e)&&this._update(!0)}catch(i){a.w(`Unable to perform style diff: ${i.message||i.error||i}.  Rebuilding the style from scratch.`),this._updateStyle(g,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():a.w("There is no style added to the map.")}addSource(g,e){return this._lazyInitEmptyStyle(),this.style.addSource(g,e),this._update(!0)}isSourceLoaded(g){const e=this.style&&this.style.sourceCaches[g];if(e!==void 0)return e.loaded();this.fire(new a.k(new Error(`There is no source with ID '${g}'`)))}setTerrain(g){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),g){const e=this.style.sourceCaches[g.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${g.source}`);this.terrain===null&&e.reload();for(const i in this.style._layers){const u=this.style._layers[i];u.type==="hillshade"&&u.source===g.source&&a.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new cn(this.painter,e,g),this.painter.renderToTexture=new om(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=i=>{var u;i.dataType==="style"?this.terrain.sourceCache.freeRtt():i.dataType==="source"&&i.tile&&(i.sourceId!==g.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((u=i.source)===null||u===void 0?void 0:u.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(i.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new a.l("terrain",{terrain:g})),this}getTerrain(){var g,e;return(e=(g=this.terrain)===null||g===void 0?void 0:g.options)!==null&&e!==void 0?e:null}areTilesLoaded(){const g=this.style&&this.style.sourceCaches;for(const e in g){const i=g[e]._tiles;for(const u in i){const d=i[u];if(d.state!=="loaded"&&d.state!=="errored")return!1}}return!0}removeSource(g){return this.style.removeSource(g),this._update(!0)}getSource(g){return this.style.getSource(g)}addImage(g,e,i={}){const{pixelRatio:u=1,sdf:d=!1,stretchX:_,stretchY:x,content:T,textFitWidth:E,textFitHeight:M}=i;if(this._lazyInitEmptyStyle(),!(e instanceof HTMLImageElement||a.b(e))){if(e.width===void 0||e.height===void 0)return this.fire(new a.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:D,height:B,data:O}=e,Z=e;return this.style.addImage(g,{data:new a.R({width:D,height:B},new Uint8Array(O)),pixelRatio:u,stretchX:_,stretchY:x,content:T,textFitWidth:E,textFitHeight:M,sdf:d,version:0,userImage:Z}),Z.onAdd&&Z.onAdd(this,g),this}}{const{width:D,height:B,data:O}=N.getImageData(e);this.style.addImage(g,{data:new a.R({width:D,height:B},O),pixelRatio:u,stretchX:_,stretchY:x,content:T,textFitWidth:E,textFitHeight:M,sdf:d,version:0})}}updateImage(g,e){const i=this.style.getImage(g);if(!i)return this.fire(new a.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const u=e instanceof HTMLImageElement||a.b(e)?N.getImageData(e):e,{width:d,height:_,data:x}=u;if(d===void 0||_===void 0)return this.fire(new a.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(d!==i.data.width||_!==i.data.height)return this.fire(new a.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const T=!(e instanceof HTMLImageElement||a.b(e));return i.data.replace(x,T),this.style.updateImage(g,i),this}getImage(g){return this.style.getImage(g)}hasImage(g){return g?!!this.style.getImage(g):(this.fire(new a.k(new Error("Missing required image id"))),!1)}removeImage(g){this.style.removeImage(g)}loadImage(g){return re.getImage(this._requestManager.transformRequest(g,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(g,e){return this._lazyInitEmptyStyle(),this.style.addLayer(g,e),this._update(!0)}moveLayer(g,e){return this.style.moveLayer(g,e),this._update(!0)}removeLayer(g){return this.style.removeLayer(g),this._update(!0)}getLayer(g){return this.style.getLayer(g)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(g,e,i){return this.style.setLayerZoomRange(g,e,i),this._update(!0)}setFilter(g,e,i={}){return this.style.setFilter(g,e,i),this._update(!0)}getFilter(g){return this.style.getFilter(g)}setPaintProperty(g,e,i,u={}){return this.style.setPaintProperty(g,e,i,u),this._update(!0)}getPaintProperty(g,e){return this.style.getPaintProperty(g,e)}setLayoutProperty(g,e,i,u={}){return this.style.setLayoutProperty(g,e,i,u),this._update(!0)}getLayoutProperty(g,e){return this.style.getLayoutProperty(g,e)}setGlyphs(g,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(g,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(g,e,i={}){return this._lazyInitEmptyStyle(),this.style.addSprite(g,e,i,u=>{u||this._update(!0)}),this}removeSprite(g){return this._lazyInitEmptyStyle(),this.style.removeSprite(g),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(g,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(g,e,i=>{i||this._update(!0)}),this}setLight(g,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(g,e),this._update(!0)}getLight(){return this.style.getLight()}setSky(g,e={}){return this._lazyInitEmptyStyle(),this.style.setSky(g,e),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(g,e){return this.style.setFeatureState(g,e),this._update()}removeFeatureState(g,e){return this.style.removeFeatureState(g,e),this._update()}getFeatureState(g){return this.style.getFeatureState(g)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let g=0,e=0;return this._container&&(g=this._container.clientWidth||400,e=this._container.clientHeight||300),[g,e]}_setupContainer(){const g=this._container;g.classList.add("maplibregl-map");const e=this._canvasContainer=F.create("div","maplibregl-canvas-container",g);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=F.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const i=this._containerDimensions(),u=this._getClampedPixelRatio(i[0],i[1]);this._resizeCanvas(i[0],i[1],u);const d=this._controlContainer=F.create("div","maplibregl-control-container",g),_=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(x=>{_[x]=F.create("div",`maplibregl-ctrl-${x} `,d)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(g,e,i){this._canvas.width=Math.floor(i*g),this._canvas.height=Math.floor(i*e),this._canvas.style.width=`${g}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const g=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let e=null;this._canvas.addEventListener("webglcontextcreationerror",u=>{e={requestedAttributes:g},u&&(e.statusMessage=u.statusMessage,e.type=u.type)},{once:!0});let i=null;if(i=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,g):this._canvas.getContext("webgl2",g)||this._canvas.getContext("webgl",g),!i){const u="Failed to initialize WebGL";throw e?(e.message=u,new Error(JSON.stringify(e))):new Error(u)}this.painter=new Gd(i,this.transform),H.testSupport(i)}migrateProjection(g,e){super.migrateProjection(g,e),this.painter.transform=g,this.fire(new a.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(g){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||g,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(g){return this._update(),this._renderTaskQueue.add(g)}_cancelRenderFrame(g){this._renderTaskQueue.remove(g)}_render(g){var e,i,u,d,_;const x=this._idleTriggered?this._fadeDuration:0,T=((e=this.style.projection)===null||e===void 0?void 0:e.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(g),this._removed)return;let E=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const B=this.transform.zoom,O=N.now();this.style.zoomHistory.update(B,O);const Z=new a.C(B,{now:O,fadeDuration:x,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),K=Z.crossFadingFactor();K===1&&K===this._crossFadingFactor||(E=!0,this._crossFadingFactor=K),this.style.update(Z)}const M=((i=this.style.projection)===null||i===void 0?void 0:i.transitionState)>0!==T;(u=this.style.projection)===null||u===void 0||u.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((d=this.style.projection)===null||d===void 0?void 0:d.transitionState,(_=this.style.projection)===null||_===void 0?void 0:_.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||M)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,x,this._crossSourceCollisions,M),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:x,showPadding:this.showPadding}),this.fire(new a.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,a.cj.mark(a.ck.load),this.fire(new a.l("load"))),this.style&&(this.style.hasTransitions()||E)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const D=this._sourcesDirty||this._styleDirty||this._placementDirty;return D||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.l("idle")),!this._loaded||this._fullyLoaded||D||(this._fullyLoaded=!0,a.cj.mark(a.ck.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var g;this._hash&&this._hash.remove();for(const i of this._controls)i.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),re.removeThrottleControl(this._imageQueueHandle),(g=this._resizeObserver)===null||g===void 0||g.disconnect();const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e!=null&&e.loseContext&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),F.remove(this._canvasContainer),F.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),a.cj.clearMetrics(),this._removed=!0,this.fire(new a.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,N.frame(this._frameRequest,g=>{a.cj.frame(g),this._frameRequest=null;try{this._render(g)}catch(e){if(!a.cl(e)&&!function(i){return i.message===jd}(e))throw e}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(g){this._showTileBoundaries!==g&&(this._showTileBoundaries=g,this._update())}get showPadding(){return!!this._showPadding}set showPadding(g){this._showPadding!==g&&(this._showPadding=g,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(g){this._showCollisionBoxes!==g&&(this._showCollisionBoxes=g,g?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(g){this._showOverdrawInspector!==g&&(this._showOverdrawInspector=g,this._update())}get repaint(){return!!this._repaint}set repaint(g){this._repaint!==g&&(this._repaint=g,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(g){this._vertices=g,this._update()}get version(){return Yr}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(g){return this._lazyInitEmptyStyle(),this.style.setProjection(g),this._update(!0)}},m.MapMouseEvent=$i,m.MapTouchEvent=oa,m.MapWheelEvent=Mn,m.Marker=ps,m.NavigationControl=class{constructor(g){this._updateZoomButtons=()=>{const e=this._map.getZoom(),i=e===this._map.getMaxZoom(),u=e===this._map.getMinZoom();this._zoomInButton.disabled=i,this._zoomOutButton.disabled=u,this._zoomInButton.setAttribute("aria-disabled",i.toString()),this._zoomOutButton.setAttribute("aria-disabled",u.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(e,i)=>{const u=this._map._getUIString(`NavigationControl.${i}`);e.title=u,e.setAttribute("aria-label",u)},this.options=a.e({},of,g),this._container=F.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",e=>e.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",e=>this._map.zoomIn({},{originalEvent:e})),F.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",e=>this._map.zoomOut({},{originalEvent:e})),F.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})}),this._compassIcon=F.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(g){return this._map=g,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new tl(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){F.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(g,e){const i=F.create("button",g,this._container);return i.type="button",i.addEventListener("click",e),i}},m.Popup=class extends a.E{constructor(g){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:void 0)},this.remove=()=>(this._content&&F.remove(this._content),this._container&&(F.remove(this._container),delete this._container),this._closeButton&&this._closeButton.removeEventListener("click",this._onClose),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new a.l("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{var i;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=F.create("div","maplibregl-popup",this._map.getContainer()),this._tip=F.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const T of this.options.className.split(" "))this._container.classList.add(T);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?dc(this._lngLat,this._flatPos,this._map.transform):(i=this._lngLat)===null||i===void 0?void 0:i.wrap(),this._trackPointer&&!e)return;const u=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationToScreenPoint(this._lngLat));let d=this.options.anchor;const _=il(this.options.offset);if(!d){const T=this._container.offsetWidth,E=this._container.offsetHeight;let M;M=u.y+_.bottom.y<E?["top"]:u.y>this._map.transform.height-E?["bottom"]:[],u.x<T/2?M.push("left"):u.x>this._map.transform.width-T/2&&M.push("right"),d=M.length===0?"bottom":M.join("-")}let x=u.add(_[d]);this.options.subpixelPositioning||(x=x.round()),F.setTransform(this._container,`${rl[d]} translate(${x.x}px,${x.y}px)`),fc(this._container,d,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=a.e(Object.create(Zu),g)}addTo(g){return this._map&&this.remove(),this._map=g,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new a.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(g){return this._lngLat=a.Q.convert(g),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(g){return this.setDOMContent(document.createTextNode(g))}setHTML(g){const e=document.createDocumentFragment(),i=document.createElement("body");let u;for(i.innerHTML=g;u=i.firstChild,u;)e.appendChild(u);return this.setDOMContent(e)}getMaxWidth(){var g;return(g=this._container)===null||g===void 0?void 0:g.style.maxWidth}setMaxWidth(g){return this.options.maxWidth=g,this._update(),this}setDOMContent(g){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=F.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(g),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(g){return this._container&&this._container.classList.add(g),this}removeClassName(g){return this._container&&this._container.classList.remove(g),this}setOffset(g){return this.options.offset=g,this._update(),this}toggleClassName(g){if(this._container)return this._container.classList.toggle(g)}setSubpixelPositioning(g){this.options.subpixelPositioning=g}_createCloseButton(){this.options.closeButton&&(this._closeButton=F.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const g=this._container.querySelector(qu);g&&g.focus()}},m.RasterDEMTileSource=st,m.RasterTileSource=nt,m.ScaleControl=class{constructor(g){this._onMove=()=>{pc(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,pc(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Gu),g)}getDefaultPosition(){return"bottom-left"}onAdd(g){return this._map=g,this._container=F.create("div","maplibregl-ctrl maplibregl-ctrl-scale",g.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){F.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},m.ScrollZoomHandler=tf,m.Style=qs,m.TerrainControl=class{constructor(g){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=g}onAdd(g){return this._map=g,this._container=F.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=F.create("button","maplibregl-ctrl-terrain",this._container),F.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){F.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},m.TwoFingersTouchPitchHandler=ef,m.TwoFingersTouchRotateHandler=Qd,m.TwoFingersTouchZoomHandler=rr,m.TwoFingersTouchZoomRotateHandler=Ya,m.VectorTileSource=at,m.VideoSource=ht,m.addSourceType=(g,e)=>a._(void 0,void 0,void 0,function*(){if(bt(g))throw new Error(`A source type called "${g}" already exists.`);((i,u)=>{Lt[i]=u})(g,e)}),m.clearPrewarmedResources=function(){const g=Lr;g&&(g.isPreloaded()&&g.numActive()===1?(g.release(_r),Lr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},m.createTileMesh=Bl,m.getMaxParallelImageRequests=function(){return a.a.MAX_PARALLEL_IMAGE_REQUESTS},m.getRTLTextPluginStatus=function(){return ir().getRTLTextPluginStatus()},m.getVersion=function(){return Hu},m.getWorkerCount=function(){return pr.workerCount},m.getWorkerUrl=function(){return a.a.WORKER_URL},m.importScriptInWorkers=function(g){return hr().broadcast("IS",g)},m.prewarm=function(){Yt().acquire(_r)},m.setMaxParallelImageRequests=function(g){a.a.MAX_PARALLEL_IMAGE_REQUESTS=g},m.setRTLTextPlugin=function(g,e){return ir().setRTLTextPlugin(g,e)},m.setWorkerCount=function(g){pr.workerCount=g},m.setWorkerUrl=function(g){a.a.WORKER_URL=g}});var y=l;return y})}(Hf)),Hf.exports}var Jw=nD();const oD=rD(Jw),Ab=["3036","3622","3623","3624","3631","3641","3653","3724","3725","3741","3823","3824","3831","3841","3926","3927","3928","3942","4027","4028","4040","4042","4128","4129","4142","4229","4230","4328","4329","4429","4440","4529","4530","4531","4540","4629","4630","4631","4728","4729","4730","4731","4739","4740","4828","4829","4830","4831","4839","4928","4929","4930","4931","4932","4933","4934","4939","5029","5030","5031","5032","5033","5034","5035","5036","5038","5039","5129","5130","5131","5132","5133","5134","5135","5136","5137","5138","5139","5229","5231","5232","5233","5234","5235","5236","5237","5238","5239","5240","5332","5333","5334","5335","5336","5337","5338","5339","5340","5432","5433","5435","5436","5437","5438","5439","5440","5531","5536","5537","5538","5539","5540","5541","5636","5637","5638","5639","5640","5641","5738","5739","5740","5741","5839","5840","5841","5939","5940","5941","5942","6039","6040","6041","6139","6140","6141","6239","6240","6241","6243","6339","6340","6341","6342","6343","6439","6440","6441","6442","6443","6444","6445","6540","6541","6542","6543","6544","6545","6546","6641","6642","6643","6644","6645","6646","6647","6740","6741","6742","6747","6748","6840","6841","6842","6847","6848"],Le={LEVEL_80000:{LEVEL:8e4,DIGIT:4,DISTANCE:{LAT:40/60,LNG:1},SECTION:{X:{MIN:22,MAX:53},Y:{MIN:30,MAX:68},LAT:{MIN:20},LNG:{MIN:122}}},LEVEL_10000:{LEVEL:1e4,DIGIT:6,RANGE:{MIN:0,MAX:7},DISTANCE:{LAT:5/60,LNG:7/60+30/60/60}},LEVEL_5000:{LEVEL:5e3,DIGIT:7,RANGE:{MIN:1,MAX:4},DISTANCE:{LAT:150/60/60,LNG:225/60/60}},LEVEL_2000:{LEVEL:2e3,DIGIT:9,RANGE:{MIN:0,MAX:8},DISTANCE:{LAT:60/60/60,LNG:90/60/60}},LEVEL_1000:{LEVEL:1e3,DIGIT:8,RANGE:{MIN:0,MAX:9},DISTANCE:{LAT:30/60/60,LNG:45/60/60}},LEVEL_500:{LEVEL:500,DIGIT:9,RANGE:{MIN:1,MAX:4},DISTANCE:{LAT:15/60/60,LNG:22.5/60/60}},LEVEL_250:{LEVEL:250,DIGIT:10,RANGE:{MIN:1,MAX:4},DISTANCE:{LAT:7.5/60/60,LNG:11.25/60/60}},LEVEL_125:{LEVEL:125,DIGIT:11,RANGE:{MIN:1,MAX:4},DISTANCE:{LAT:3.75/60/60,LNG:5.625/60/60}}},Lc=Object.values(Le).map(t=>t.LEVEL),sD=[Le.LEVEL_10000.LEVEL,Le.LEVEL_5000.LEVEL,Le.LEVEL_2000.LEVEL];class Ih{constructor(n,l){this.lat=n,this.lng=l}}class Qw{constructor(n,l,h,p){this.northLat=n,this.eastLng=l,this.southLat=h,this.westLng=p}getCenter(){const n=(this.northLat+this.southLat)/2,l=(this.eastLng+this.westLng)/2;return new Ih(n,l)}getNorthEast(){return new Ih(this.northLat,this.eastLng)}getNorthWest(){return new Ih(this.northLat,this.westLng)}getSouthWest(){return new Ih(this.southLat,this.westLng)}getSouthEast(){return new Ih(this.southLat,this.eastLng)}contains(n){const l=n.lat,h=n.lng;return this.southLat<=l&&l<=this.northLat&&this.westLng<=h&&h<=this.eastLng}}class wn{static toCode(n,l,h=Le.LEVEL_125.LEVEL){if(Lc.includes(h)===!1)throw new Error(`invalid level. available : ${Lc.join(", ")}`);const p=Math.floor(n*60/40),y=n*60%40,m=Math.floor(y/5),a=y%5,I=Math.floor(a*60/30),z=a*60%30,P=Math.floor(z/15),k=z%15,N=Math.floor(k/7.5),F=k%7.5,H=Math.floor(F/3.75),X=Math.floor(l-100),ae=l-100-X,Se=Math.floor(ae*60/7.5),be=ae*60%7.5,Q=Math.floor(be*60/45),re=be*60%45,J=Math.floor(re/22.5),le=re%22.5,Me=Math.floor(le/11.25),Ie=le%11.25,Be=Math.floor(Ie/5.625),Ee=P*2+(J+1),Re=N*2+(Me+1),Ae=H*2+(Be+1),He=`${p}${X}${m}${Se}${I}${Q}${Ee}${Re}${Ae}`;if(wn.isValidCode(He)===!1)throw new Error(`lat: ${n} and lng: ${l} are invalid location.`);const it=He.slice(0,Le.LEVEL_10000.DIGIT);switch(h){case Le.LEVEL_80000.LEVEL:return He.slice(0,Le.LEVEL_80000.DIGIT);case Le.LEVEL_10000.LEVEL:return it;case Le.LEVEL_5000.LEVEL:return kb(it,n,l,h);case Le.LEVEL_2000.LEVEL:return kb(it,n,l,h);case Le.LEVEL_1000.LEVEL:return He.slice(0,Le.LEVEL_1000.DIGIT);case Le.LEVEL_500.LEVEL:return He.slice(0,Le.LEVEL_500.DIGIT);case Le.LEVEL_250.LEVEL:return He.slice(0,Le.LEVEL_250.DIGIT);default:return He}}static toLatLngBounds(n){const l=Lb(n),h=l[0],p=l[2];return new Qw(h[1],h[0],p[1],p[0])}static toGeoJSON(n,l={}){const h=Lb(n);return aD(h,l)}static getLevel(n){if(wn.isValidCode(n)===!1)throw new Error(`'${n}' is invalid mesh code.`);const l=n.length;return l===Le.LEVEL_80000.DIGIT?Le.LEVEL_80000.LEVEL:l===Le.LEVEL_10000.DIGIT?Le.LEVEL_10000.LEVEL:l===Le.LEVEL_5000.DIGIT?Le.LEVEL_5000.LEVEL:l===Le.LEVEL_2000.DIGIT&&n[n.length-1]==="5"?Le.LEVEL_2000.LEVEL:l===Le.LEVEL_1000.DIGIT?Le.LEVEL_1000.LEVEL:l===Le.LEVEL_500.DIGIT?Le.LEVEL_500.LEVEL:l===Le.LEVEL_250.DIGIT?Le.LEVEL_250.LEVEL:Le.LEVEL_125.LEVEL}static getCodes(n=null,l=null){if(n===null&&l===null)return Ab;if(n===null)throw new Error("code is required.");if(l===null)throw new Error("level is required.");if(wn.isValidCode(n)===!1)throw new Error(`'${n}' is invalid mesh code.`);if(Lc.includes(l)===!1)throw new Error(`${l} is invalid level. available : ${Lc.join(", ")}`);const h=wn.getLevel(n);if(h<=l)throw new Error("code level is lower than the specified level.");const p=[];if(h>Le.LEVEL_10000.LEVEL){for(let y=Le.LEVEL_10000.RANGE.MIN;y<=Le.LEVEL_10000.RANGE.MAX;y++)for(let m=Le.LEVEL_10000.RANGE.MIN;m<=Le.LEVEL_10000.RANGE.MAX;m++)p.push(`${n}${y}${m}`);if(l===Le.LEVEL_10000.LEVEL)return p}else p.push(n.slice(0,Le.LEVEL_10000.DIGIT));if(sD.includes(l)){if(l===Le.LEVEL_5000.LEVEL){const y=[];return p.forEach(m=>{for(let a=Le.LEVEL_5000.RANGE.MIN;a<=Le.LEVEL_5000.RANGE.MAX;a++)y.push(`${m}${a}`)}),y}else if(l===Le.LEVEL_2000.LEVEL){const y=[];return p.forEach(m=>{let a=[0,2,4,6,8],I=[0,2,4,6,8];if(h===Le.LEVEL_5000.LEVEL){const z=Number(n[6]);z===1?(a=[0,2,4],I=[0,2,4]):z===2?(a=[0,2,4],I=[4,6,8]):z===3?(a=[4,6,8],I=[0,2,4]):z===4&&(a=[4,6,8],I=[4,6,8])}a.forEach(z=>{I.forEach(P=>{y.push(`${m}${z}${P}5`)})})}),y}}else{const y=[];if(h>Le.LEVEL_1000.LEVEL){let z=Le.LEVEL_1000.RANGE.MIN,P=Le.LEVEL_1000.RANGE.MAX,k=Le.LEVEL_1000.RANGE.MIN,N=Le.LEVEL_1000.RANGE.MAX;if(h===Le.LEVEL_5000.LEVEL){const F=Number(n[6]);F===1?(P=(Le.LEVEL_1000.RANGE.MAX+1)/2,N=(Le.LEVEL_1000.RANGE.MAX+1)/2):F===2?(P=(Le.LEVEL_1000.RANGE.MAX+1)/2,k=(Le.LEVEL_1000.RANGE.MAX+1)/2):F===3?(z=(Le.LEVEL_1000.RANGE.MAX+1)/2,N=(Le.LEVEL_1000.RANGE.MAX+1)/2):F===4&&(z=(Le.LEVEL_1000.RANGE.MAX+1)/2,k=(Le.LEVEL_1000.RANGE.MAX+1)/2)}else if(h===Le.LEVEL_2000.LEVEL){const F=Number(n[7]),H=Number(n[6]);z=H,P=H+1,k=F,N=F+1}if(p.forEach(F=>{for(let H=z;H<=P;H++)for(let X=k;X<=N;X++)y.push(`${F}${H}${X}`)}),l===Le.LEVEL_1000.LEVEL)return y}else y.push(n.slice(0,Le.LEVEL_1000.DIGIT));const m=[];if(h>Le.LEVEL_500.LEVEL){if(y.forEach(z=>{for(let P=Le.LEVEL_500.RANGE.MIN;P<=Le.LEVEL_500.RANGE.MAX;P++)m.push(`${z}${P}`)}),l===Le.LEVEL_500.LEVEL)return m}else m.push(n.slice(0,Le.LEVEL_500.DIGIT));const a=[];if(h>Le.LEVEL_250.LEVEL){if(m.forEach(z=>{for(let P=Le.LEVEL_250.RANGE.MIN;P<=Le.LEVEL_250.RANGE.MAX;P++)a.push(`${z}${P}`)}),l===Le.LEVEL_250.LEVEL)return a}else a.push(n.slice(0,Le.LEVEL_250.DIGIT));const I=[];if(h>Le.LEVEL_125.LEVEL&&(a.forEach(z=>{for(let P=Le.LEVEL_125.RANGE.MIN;P<=Le.LEVEL_125.RANGE.MAX;P++)I.push(`${z}${P}`)}),l===Le.LEVEL_125.LEVEL))return I}}static getCodesWithinBounds(n,l=Le.LEVEL_80000.LEVEL){if(Lc.includes(l)===!1)throw new Error(`${l} is invalid level. available : ${Lc.join(", ")}`);const h=n.getNorthEast(),p=n.getSouthWest(),y=h.lat-p.lat,m=h.lng-p.lng,a=lD(l),I=a.LAT,z=a.LNG,P=Math.ceil(y/I)+1,k=Math.ceil(m/z)+1,N=[],F=1e-8;for(let H=0;H<=P;H++)for(let X=0;X<=k;X++){const ae=Math.min(Math.max(p.lat+I*H-I/2,p.lat+F),h.lat-F),Se=Math.min(Math.max(p.lng+z*X-z/2,p.lng+F),h.lng-F);try{const be=wn.toCode(ae,Se,l);N.includes(be)||N.push(be)}catch{}}return N}static isValidCode(n){if(n.length!==Le.LEVEL_80000.DIGIT&&n.length!==Le.LEVEL_10000.DIGIT&&n.length!==Le.LEVEL_5000.DIGIT&&n.length!==Le.LEVEL_2000.DIGIT&&n.length!==Le.LEVEL_1000.DIGIT&&n.length!==Le.LEVEL_500.DIGIT&&n.length!==Le.LEVEL_250.DIGIT&&n.length!==Le.LEVEL_125.DIGIT||!Ab.includes(n.slice(0,Le.LEVEL_80000.DIGIT)))return!1;if(n.length>=Le.LEVEL_10000.DIGIT){const l=Number(n[4]),h=Number(n[5]);if(l<Le.LEVEL_10000.RANGE.MIN||l>Le.LEVEL_10000.RANGE.MAX||h<Le.LEVEL_10000.RANGE.MIN||h>Le.LEVEL_10000.RANGE.MAX)return!1}if(e2(n)){if(n.length===Le.LEVEL_5000.DIGIT){const l=Number(n[6]);if(l<Le.LEVEL_5000.RANGE.MIN||l>Le.LEVEL_5000.RANGE.MAX)return!1}else if(n.length===Le.LEVEL_2000.DIGIT){const l=Number(n[6]),h=Number(n[7]),p=[0,2,4,6,8];if(!p.includes(l)||!p.includes(h))return!1}}else{if(n.length>=Le.LEVEL_1000.DIGIT){const l=Number(n[6]),h=Number(n[7]);if(l<Le.LEVEL_1000.RANGE.MIN||l>Le.LEVEL_1000.RANGE.MAX||h<Le.LEVEL_1000.RANGE.MIN||h>Le.LEVEL_1000.RANGE.MAX)return!1}if(n.length>=Le.LEVEL_500.DIGIT){const l=Number(n[8]);if(l<Le.LEVEL_500.RANGE.MIN||l>Le.LEVEL_500.RANGE.MAX)return!1}if(n.length>=Le.LEVEL_250.DIGIT){const l=Number(n[9]);if(l<Le.LEVEL_250.RANGE.MIN||l>Le.LEVEL_250.RANGE.MAX)return!1}if(n.length>=Le.LEVEL_125.DIGIT){const l=Number(n[10]);if(l<Le.LEVEL_125.RANGE.MIN||l>Le.LEVEL_125.RANGE.MAX)return!1}}return!0}}function kb(t,n,l,h){let p=t;const m=wn.toLatLngBounds(t).getSouthWest();if(h===Le.LEVEL_5000.LEVEL){const a=Math.floor((n-m.lat)/Le.LEVEL_5000.DISTANCE.LAT),I=Math.floor((l-m.lng)/Le.LEVEL_5000.DISTANCE.LNG);I===0&&a===0?p+="1":I===1&&a===0?p+="2":I===0&&a===1?p+="3":p+="4"}else if(h===Le.LEVEL_2000.LEVEL){const a=Math.floor((n-m.lat)/Le.LEVEL_2000.DISTANCE.LAT)*2,I=Math.floor((l-m.lng)/Le.LEVEL_2000.DISTANCE.LNG)*2;p+=`${a}${I}5`}return p}function Lb(t){if(wn.isValidCode(t)===!1)throw new Error(`'${t}' is invalid mesh code.`);const n=Number(t.slice(2,4)),l=Number(t.slice(0,2));let h=0,p=0,y=0,m=0;if(t.length>=Le.LEVEL_80000.DIGIT&&(h=Le.LEVEL_80000.SECTION.LNG.MIN+(n-Le.LEVEL_80000.SECTION.X.MIN)*Le.LEVEL_80000.DISTANCE.LNG,p=h+Le.LEVEL_80000.DISTANCE.LNG,y=Le.LEVEL_80000.SECTION.LAT.MIN+(l-Le.LEVEL_80000.SECTION.Y.MIN)*Le.LEVEL_80000.DISTANCE.LAT,m=y+Le.LEVEL_80000.DISTANCE.LAT),t.length>=Le.LEVEL_10000.DIGIT){const k=Number(t[5]),N=Number(t[4]);h+=k*Le.LEVEL_10000.DISTANCE.LNG,p=h+Le.LEVEL_10000.DISTANCE.LNG,y+=N*Le.LEVEL_10000.DISTANCE.LAT,m=y+Le.LEVEL_10000.DISTANCE.LAT}if(e2(t)){if(t.length===Le.LEVEL_5000.DIGIT){const k=Number(t[6]),N=k===1||k===3?0:1,F=k===1||k===2?0:1;h+=N*Le.LEVEL_5000.DISTANCE.LNG,p=h+Le.LEVEL_5000.DISTANCE.LNG,y+=F*Le.LEVEL_5000.DISTANCE.LAT,m=y+Le.LEVEL_5000.DISTANCE.LAT}else if(t.length===Le.LEVEL_2000.DIGIT){const k=Number(t[7]),N=Number(t[6]);h+=k/2*Le.LEVEL_2000.DISTANCE.LNG,p=h+Le.LEVEL_2000.DISTANCE.LNG,y+=N/2*Le.LEVEL_2000.DISTANCE.LAT,m=y+Le.LEVEL_2000.DISTANCE.LAT}}else{if(t.length>=Le.LEVEL_1000.DIGIT){const k=Number(t[7]),N=Number(t[6]);h+=k*Le.LEVEL_1000.DISTANCE.LNG,p=h+Le.LEVEL_1000.DISTANCE.LNG,y+=N*Le.LEVEL_1000.DISTANCE.LAT,m=y+Le.LEVEL_1000.DISTANCE.LAT}if(t.length>=Le.LEVEL_500.DIGIT){const k=Number(t[8]),N=k===1||k===3?0:1,F=k===1||k===2?0:1;h+=N*Le.LEVEL_500.DISTANCE.LNG,p=h+Le.LEVEL_500.DISTANCE.LNG,y+=F*Le.LEVEL_500.DISTANCE.LAT,m=y+Le.LEVEL_500.DISTANCE.LAT}if(t.length>=Le.LEVEL_250.DIGIT){const k=Number(t[9]),N=k===1||k===3?0:1,F=k===1||k===2?0:1;h+=N*Le.LEVEL_250.DISTANCE.LNG,p=h+Le.LEVEL_250.DISTANCE.LNG,y+=F*Le.LEVEL_250.DISTANCE.LAT,m=y+Le.LEVEL_250.DISTANCE.LAT}if(t.length>=Le.LEVEL_125.DIGIT){const k=Number(t[10]),N=k===1||k===3?0:1,F=k===1||k===2?0:1;h+=N*Le.LEVEL_125.DISTANCE.LNG,p=h+Le.LEVEL_125.DISTANCE.LNG,y+=F*Le.LEVEL_125.DISTANCE.LAT,m=y+Le.LEVEL_125.DISTANCE.LAT}}return[[p,m],[h,m],[h,y],[p,y]]}function aD(t,n={}){return t.push(t[0]),{type:"Feature",properties:n,geometry:{type:"Polygon",coordinates:[t]}}}function e2(t){return t.length===Le.LEVEL_10000.DIGIT||t.length===Le.LEVEL_5000.DIGIT||t.length===Le.LEVEL_2000.DIGIT&&t[t.length-1]==="5"}function lD(t){switch(t){case Le.LEVEL_10000.LEVEL:return Le.LEVEL_10000.DISTANCE;case Le.LEVEL_5000.LEVEL:return Le.LEVEL_5000.DISTANCE;case Le.LEVEL_2000.LEVEL:return Le.LEVEL_2000.DISTANCE;case Le.LEVEL_1000.LEVEL:return Le.LEVEL_1000.DISTANCE;case Le.LEVEL_500.LEVEL:return Le.LEVEL_500.DISTANCE;case Le.LEVEL_250.LEVEL:return Le.LEVEL_250.DISTANCE;case Le.LEVEL_125.LEVEL:return Le.LEVEL_125.DISTANCE;default:return Le.LEVEL_80000.DISTANCE}}const ro={toCode:wn.toCode,toLatLngBounds:wn.toLatLngBounds,toGeoJSON:wn.toGeoJSON,getLevel:wn.getLevel,getCodes:wn.getCodes,getCodesWithinBounds:wn.getCodesWithinBounds,isValidCode:wn.isValidCode};var $n=Uint8Array,Fc=Uint16Array,cD=Int32Array,t2=new $n([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),r2=new $n([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),uD=new $n([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),i2=function(t,n){for(var l=new Fc(31),h=0;h<31;++h)l[h]=n+=1<<t[h-1];for(var p=new cD(l[30]),h=1;h<30;++h)for(var y=l[h];y<l[h+1];++y)p[y]=y-l[h]<<5|h;return{b:l,r:p}},n2=i2(t2,2),o2=n2.b,hD=n2.r;o2[28]=258,hD[258]=28;var dD=i2(r2,0),fD=dD.b,h_=new Fc(32768);for(var ri=0;ri<32768;++ri){var va=(ri&43690)>>1|(ri&21845)<<1;va=(va&52428)>>2|(va&13107)<<2,va=(va&61680)>>4|(va&3855)<<4,h_[ri]=((va&65280)>>8|(va&255)<<8)>>1}var Fh=function(t,n,l){for(var h=t.length,p=0,y=new Fc(n);p<h;++p)t[p]&&++y[t[p]-1];var m=new Fc(n);for(p=1;p<n;++p)m[p]=m[p-1]+y[p-1]<<1;var a;if(l){a=new Fc(1<<n);var I=15-n;for(p=0;p<h;++p)if(t[p])for(var z=p<<4|t[p],P=n-t[p],k=m[t[p]-1]++<<P,N=k|(1<<P)-1;k<=N;++k)a[h_[k]>>I]=z}else for(a=new Fc(h),p=0;p<h;++p)t[p]&&(a[p]=h_[m[t[p]-1]++]>>15-t[p]);return a},ad=new $n(288);for(var ri=0;ri<144;++ri)ad[ri]=8;for(var ri=144;ri<256;++ri)ad[ri]=9;for(var ri=256;ri<280;++ri)ad[ri]=7;for(var ri=280;ri<288;++ri)ad[ri]=8;var s2=new $n(32);for(var ri=0;ri<32;++ri)s2[ri]=5;var pD=Fh(ad,9,1),mD=Fh(s2,5,1),bg=function(t){for(var n=t[0],l=1;l<t.length;++l)t[l]>n&&(n=t[l]);return n},To=function(t,n,l){var h=n/8|0;return(t[h]|t[h+1]<<8)>>(n&7)&l},xg=function(t,n){var l=n/8|0;return(t[l]|t[l+1]<<8|t[l+2]<<16)>>(n&7)},gD=function(t){return(t+7)/8|0},_D=function(t,n,l){return(l==null||l>t.length)&&(l=t.length),new $n(t.subarray(n,l))},yD=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Nn=function(t,n,l){var h=new Error(n||yD[t]);if(h.code=t,Error.captureStackTrace&&Error.captureStackTrace(h,Nn),!l)throw h;return h},ny=function(t,n,l,h){var p=t.length,y=0;if(!p||n.f&&!n.l)return l||new $n(0);var m=!l,a=m||n.i!=2,I=n.i;m&&(l=new $n(p*3));var z=function(Pr){var Sr=l.length;if(Pr>Sr){var pe=new $n(Math.max(Sr*2,Pr));pe.set(l),l=pe}},P=n.f||0,k=n.p||0,N=n.b||0,F=n.l,H=n.d,X=n.m,ae=n.n,Se=p*8;do{if(!F){P=To(t,k,1);var be=To(t,k+1,3);if(k+=3,be)if(be==1)F=pD,H=mD,X=9,ae=5;else if(be==2){var le=To(t,k,31)+257,Me=To(t,k+10,15)+4,Ie=le+To(t,k+5,31)+1;k+=14;for(var Be=new $n(Ie),Ee=new $n(19),Re=0;Re<Me;++Re)Ee[uD[Re]]=To(t,k+Re*3,7);k+=Me*3;for(var Ae=bg(Ee),He=(1<<Ae)-1,it=Fh(Ee,Ae,1),Re=0;Re<Ie;){var vt=it[To(t,k,He)];k+=vt&15;var Q=vt>>4;if(Q<16)Be[Re++]=Q;else{var Xe=0,xt=0;for(Q==16?(xt=3+To(t,k,3),k+=2,Xe=Be[Re-1]):Q==17?(xt=3+To(t,k,7),k+=3):Q==18&&(xt=11+To(t,k,127),k+=7);xt--;)Be[Re++]=Xe}}var yt=Be.subarray(0,le),Rt=Be.subarray(le);X=bg(yt),ae=bg(Rt),F=Fh(yt,X,1),H=Fh(Rt,ae,1)}else Nn(1);else{var Q=gD(k)+4,re=t[Q-4]|t[Q-3]<<8,J=Q+re;if(J>p){I&&Nn(0);break}a&&z(N+re),l.set(t.subarray(Q,J),N),n.b=N+=re,n.p=k=J*8,n.f=P;continue}if(k>Se){I&&Nn(0);break}}a&&z(N+131072);for(var Mr=(1<<X)-1,_r=(1<<ae)-1,pr=k;;pr=k){var Xe=F[xg(t,k)&Mr],Tr=Xe>>4;if(k+=Xe&15,k>Se){I&&Nn(0);break}if(Xe||Nn(2),Tr<256)l[N++]=Tr;else if(Tr==256){pr=k,F=null;break}else{var Lr=Tr-254;if(Tr>264){var Re=Tr-257,Pt=t2[Re];Lr=To(t,k,(1<<Pt)-1)+o2[Re],k+=Pt}var Yt=H[xg(t,k)&_r],Jt=Yt>>4;Yt||Nn(3),k+=Yt&15;var Rt=fD[Jt];if(Jt>3){var Pt=r2[Jt];Rt+=xg(t,k)&(1<<Pt)-1,k+=Pt}if(k>Se){I&&Nn(0);break}a&&z(N+131072);var hr=N+Lr;if(N<Rt){var vr=y-Rt,Ti=Math.min(Rt,hr);for(vr+N<0&&Nn(3);N<Ti;++N)l[N]=h[vr+N]}for(;N<hr;++N)l[N]=l[N-Rt]}}n.l=F,n.p=pr,n.b=N,n.f=P,F&&(P=1,n.m=X,n.d=H,n.n=ae)}while(!P);return N!=l.length&&m?_D(l,0,N):l.subarray(0,N)},vD=new $n(0),bD=function(t){(t[0]!=31||t[1]!=139||t[2]!=8)&&Nn(6,"invalid gzip data");var n=t[3],l=10;n&4&&(l+=(t[10]|t[11]<<8)+2);for(var h=(n>>3&1)+(n>>4&1);h>0;h-=!t[l++]);return l+(n&2)},xD=function(t){var n=t.length;return(t[n-4]|t[n-3]<<8|t[n-2]<<16|t[n-1]<<24)>>>0},wD=function(t,n){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&Nn(6,"invalid zlib data"),(t[1]>>5&1)==1&&Nn(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2};function TD(t,n){return ny(t,{i:2},n,n)}function SD(t,n){var l=bD(t);return l+8>t.length&&Nn(6,"invalid gzip data"),ny(t.subarray(l,-8),{i:2},new $n(xD(t)),n)}function ED(t,n){return ny(t.subarray(wD(t),-4),{i:2},n,n)}function CD(t,n){return t[0]==31&&t[1]==139&&t[2]==8?SD(t,n):(t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31?TD(t,n):ED(t,n)}var ID=typeof TextDecoder<"u"&&new TextDecoder,MD=0;try{ID.decode(vD,{stream:!0}),MD=1}catch{}var PD=Object.defineProperty,Bh=Math.pow,Br=(t,n)=>PD(t,"name",{value:n,configurable:!0}),qi=(t,n,l)=>new Promise((h,p)=>{var y=I=>{try{a(l.next(I))}catch(z){p(z)}},m=I=>{try{a(l.throw(I))}catch(z){p(z)}},a=I=>I.done?h(I.value):Promise.resolve(I.value).then(y,m);a((l=l.apply(t,n)).next())});Br((t,n)=>{let l=!1,h="",p=L.GridLayer.extend({createTile:Br((y,m)=>{let a=document.createElement("img"),I=new AbortController,z=I.signal;return a.cancel=()=>{I.abort()},l||(t.getHeader().then(P=>{P.tileType===1?console.error("Error: archive contains MVT vector tiles, but leafletRasterLayer is for displaying raster tiles. See https://github.com/protomaps/PMTiles/tree/main/js for details."):P.tileType===2?h="image/png":P.tileType===3?h="image/jpeg":P.tileType===4?h="image/webp":P.tileType===5&&(h="image/avif")}),l=!0),t.getZxy(y.z,y.x,y.y,z).then(P=>{if(P){let k=new Blob([P.data],{type:h}),N=window.URL.createObjectURL(k);a.src=N,a.cancel=void 0,m(void 0,a)}}).catch(P=>{if(P.name!=="AbortError")throw P}),a},"createTile"),_removeTile:Br(function(y){let m=this._tiles[y];m&&(m.el.cancel&&m.el.cancel(),m.el.width=0,m.el.height=0,m.el.deleted=!0,L.DomUtil.remove(m.el),delete this._tiles[y],this.fire("tileunload",{tile:m.el,coords:this._keyToTileCoords(y)}))},"_removeTile")});return new p(n)},"leafletRasterLayer");var AD=Br(t=>(n,l)=>{if(l instanceof AbortController)return t(n,l);let h=new AbortController;return t(n,h).then(p=>l(void 0,p.data,p.cacheControl||"",p.expires||""),p=>l(p)).catch(p=>l(p)),{cancel:Br(()=>h.abort(),"cancel")}},"v3compat"),a2=class{constructor(n){this.tilev4=Br((l,h)=>qi(this,null,function*(){if(l.type==="json"){let F=l.url.substr(10),H=this.tiles.get(F);if(H||(H=new zb(F),this.tiles.set(F,H)),this.metadata)return{data:yield H.getTileJson(l.url)};let X=yield H.getHeader();return(X.minLon>=X.maxLon||X.minLat>=X.maxLat)&&console.error(`Bounds of PMTiles archive ${X.minLon},${X.minLat},${X.maxLon},${X.maxLat} are not valid.`),{data:{tiles:[`${l.url}/{z}/{x}/{y}`],minzoom:X.minZoom,maxzoom:X.maxZoom,bounds:[X.minLon,X.minLat,X.maxLon,X.maxLat]}}}let p=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),y=l.url.match(p);if(!y)throw new Error("Invalid PMTiles protocol URL");let m=y[1],a=this.tiles.get(m);a||(a=new zb(m),this.tiles.set(m,a));let I=y[2],z=y[3],P=y[4],k=yield a.getHeader(),N=yield a==null?void 0:a.getZxy(+I,+z,+P,h.signal);if(N)return{data:new Uint8Array(N.data),cacheControl:N.cacheControl,expires:N.expires};if(k.tileType===1){if(this.errorOnMissingTile)throw new Error("Tile not found.");return{data:new Uint8Array}}return{data:null}}),"tilev4"),this.tile=AD(this.tilev4),this.tiles=new Map,this.metadata=(n==null?void 0:n.metadata)||!1,this.errorOnMissingTile=(n==null?void 0:n.errorOnMissingTile)||!1}add(n){this.tiles.set(n.source.getKey(),n)}get(n){return this.tiles.get(n)}};Br(a2,"Protocol");var kD=a2;function l2(t,n){return(n>>>0)*4294967296+(t>>>0)}Br(l2,"toNum");function c2(t,n){let l=n.buf,h=l[n.pos++],p=(h&112)>>4;if(h<128||(h=l[n.pos++],p|=(h&127)<<3,h<128)||(h=l[n.pos++],p|=(h&127)<<10,h<128)||(h=l[n.pos++],p|=(h&127)<<17,h<128)||(h=l[n.pos++],p|=(h&127)<<24,h<128)||(h=l[n.pos++],p|=(h&1)<<31,h<128))return l2(t,p);throw new Error("Expected varint not more than 10 bytes")}Br(c2,"readVarintRemainder");function Rc(t){let n=t.buf,l=n[t.pos++],h=l&127;return l<128||(l=n[t.pos++],h|=(l&127)<<7,l<128)||(l=n[t.pos++],h|=(l&127)<<14,l<128)||(l=n[t.pos++],h|=(l&127)<<21,l<128)?h:(l=n[t.pos],h|=(l&15)<<28,c2(h,t))}Br(Rc,"readVarint");function oy(t,n,l,h){if(h===0){l===1&&(n[0]=t-1-n[0],n[1]=t-1-n[1]);let p=n[0];n[0]=n[1],n[1]=p}}Br(oy,"rotate");function u2(t,n){let l=Bh(2,t),h=n,p=n,y=n,m=[0,0],a=1;for(;a<l;)h=1&y/2,p=1&(y^h),oy(a,m,h,p),m[0]+=a*h,m[1]+=a*p,y=y/4,a*=2;return[t,m[0],m[1]]}Br(u2,"idOnLevel");var LD=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function h2(t,n,l){if(t>26)throw new Error("Tile zoom level exceeds max safe number limit (26)");if(n>Bh(2,t)-1||l>Bh(2,t)-1)throw new Error("tile x/y outside zoom level bounds");let h=LD[t],p=Bh(2,t),y=0,m=0,a=0,I=[n,l],z=p/2;for(;z>0;)y=(I[0]&z)>0?1:0,m=(I[1]&z)>0?1:0,a+=z*z*(3*y^m),oy(z,I,y,m),z=z/2;return h+a}Br(h2,"zxyToTileId");function zD(t){let n=0;for(let l=0;l<27;l++){let h=(1<<l)*(1<<l);if(n+h>t)return u2(l,t-n);n+=h}throw new Error("Tile zoom level exceeds max safe number limit (26)")}Br(zD,"tileIdToZxy");var RD=(t=>(t[t.Unknown=0]="Unknown",t[t.None=1]="None",t[t.Gzip=2]="Gzip",t[t.Brotli=3]="Brotli",t[t.Zstd=4]="Zstd",t))(RD||{});function Dp(t,n){return qi(this,null,function*(){if(n===1||n===0)return t;if(n===2){if(typeof globalThis.DecompressionStream>"u")return CD(new Uint8Array(t));let l=new Response(t).body;if(!l)throw new Error("Failed to read response stream");let h=l.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(h).arrayBuffer()}throw new Error("Compression method not supported")})}Br(Dp,"defaultDecompress");var DD=(t=>(t[t.Unknown=0]="Unknown",t[t.Mvt=1]="Mvt",t[t.Png=2]="Png",t[t.Jpeg=3]="Jpeg",t[t.Webp=4]="Webp",t[t.Avif=5]="Avif",t))(DD||{});function d2(t){return t===1?".mvt":t===2?".png":t===3?".jpg":t===4?".webp":t===5?".avif":""}Br(d2,"tileTypeExt");var OD=127;function f2(t,n){let l=0,h=t.length-1;for(;l<=h;){let p=h+l>>1,y=n-t[p].tileId;if(y>0)l=p+1;else if(y<0)h=p-1;else return t[p]}return h>=0&&(t[h].runLength===0||n-t[h].tileId<t[h].runLength)?t[h]:null}Br(f2,"findTile");var FD=class{constructor(n){this.file=n}getKey(){return this.file.name}getBytes(n,l){return qi(this,null,function*(){return{data:yield this.file.slice(n,n+l).arrayBuffer()}})}};Br(FD,"FileSource");var p2=class{constructor(n,l=new Headers){this.url=n,this.customHeaders=l,this.mustReload=!1;let h="";"navigator"in globalThis&&(h=globalThis.navigator.userAgent||"");let p=h.indexOf("Windows")>-1,y=/Chrome|Chromium|Edg|OPR|Brave/.test(h);this.chromeWindowsNoCache=!1,p&&y&&(this.chromeWindowsNoCache=!0)}getKey(){return this.url}setHeaders(n){this.customHeaders=n}getBytes(n,l,h,p){return qi(this,null,function*(){let y,m;h?m=h:(y=new AbortController,m=y.signal);let a=new Headers(this.customHeaders);a.set("range",`bytes=${n}-${n+l-1}`);let I;this.mustReload?I="reload":this.chromeWindowsNoCache&&(I="no-store");let z=yield fetch(this.url,{signal:m,cache:I,headers:a});if(n===0&&z.status===416){let N=z.headers.get("Content-Range");if(!N||!N.startsWith("bytes */"))throw new Error("Missing content-length on 416 response");let F=+N.substr(8);z=yield fetch(this.url,{signal:m,cache:"reload",headers:{range:`bytes=0-${F-1}`}})}let P=z.headers.get("Etag");if(P!=null&&P.startsWith("W/")&&(P=null),z.status===416||p&&P&&P!==p)throw this.mustReload=!0,new d_(`Server returned non-matching ETag ${p} after one retry. Check browser extensions and servers for issues that may affect correct ETag headers.`);if(z.status>=300)throw new Error(`Bad response code: ${z.status}`);let k=z.headers.get("Content-Length");if(z.status===200&&(!k||+k>l))throw y&&y.abort(),new Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield z.arrayBuffer(),etag:P||void 0,cacheControl:z.headers.get("Cache-Control")||void 0,expires:z.headers.get("Expires")||void 0}})}};Br(p2,"FetchSource");var BD=p2;function io(t,n){let l=t.getUint32(n+4,!0),h=t.getUint32(n+0,!0);return l*Bh(2,32)+h}Br(io,"getUint64");function m2(t,n){let l=new DataView(t),h=l.getUint8(7);if(h>3)throw new Error(`Archive is spec version ${h} but this library supports up to spec version 3`);return{specVersion:h,rootDirectoryOffset:io(l,8),rootDirectoryLength:io(l,16),jsonMetadataOffset:io(l,24),jsonMetadataLength:io(l,32),leafDirectoryOffset:io(l,40),leafDirectoryLength:io(l,48),tileDataOffset:io(l,56),tileDataLength:io(l,64),numAddressedTiles:io(l,72),numTileEntries:io(l,80),numTileContents:io(l,88),clustered:l.getUint8(96)===1,internalCompression:l.getUint8(97),tileCompression:l.getUint8(98),tileType:l.getUint8(99),minZoom:l.getUint8(100),maxZoom:l.getUint8(101),minLon:l.getInt32(102,!0)/1e7,minLat:l.getInt32(106,!0)/1e7,maxLon:l.getInt32(110,!0)/1e7,maxLat:l.getInt32(114,!0)/1e7,centerZoom:l.getUint8(118),centerLon:l.getInt32(119,!0)/1e7,centerLat:l.getInt32(123,!0)/1e7,etag:n}}Br(m2,"bytesToHeader");function sy(t){let n={buf:new Uint8Array(t),pos:0},l=Rc(n),h=[],p=0;for(let y=0;y<l;y++){let m=Rc(n);h.push({tileId:p+m,offset:0,length:0,runLength:1}),p+=m}for(let y=0;y<l;y++)h[y].runLength=Rc(n);for(let y=0;y<l;y++)h[y].length=Rc(n);for(let y=0;y<l;y++){let m=Rc(n);m===0&&y>0?h[y].offset=h[y-1].offset+h[y-1].length:h[y].offset=m-1}return h}Br(sy,"deserializeIndex");var g2=class extends Error{};Br(g2,"EtagMismatch");var d_=g2;function ay(t,n){return qi(this,null,function*(){let l=yield t.getBytes(0,16384);if(new DataView(l.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");let h=l.data.slice(0,OD),p=m2(h,l.etag),y=l.data.slice(p.rootDirectoryOffset,p.rootDirectoryOffset+p.rootDirectoryLength),m=`${t.getKey()}|${p.etag||""}|${p.rootDirectoryOffset}|${p.rootDirectoryLength}`,a=sy(yield n(y,p.internalCompression));return[p,[m,a.length,a]]})}Br(ay,"getHeaderAndRoot");function ly(t,n,l,h,p){return qi(this,null,function*(){let y=yield t.getBytes(l,h,void 0,p.etag),m=yield n(y.data,p.internalCompression),a=sy(m);if(a.length===0)throw new Error("Empty directory is invalid");return a})}Br(ly,"getDirectory");var jD=class{constructor(n=100,l=!0,h=Dp){this.cache=new Map,this.maxCacheEntries=n,this.counter=1,this.decompress=h}getHeader(n){return qi(this,null,function*(){let l=n.getKey(),h=this.cache.get(l);if(h)return h.lastUsed=this.counter++,h.data;let p=yield ay(n,this.decompress);return p[1]&&this.cache.set(p[1][0],{lastUsed:this.counter++,data:p[1][2]}),this.cache.set(l,{lastUsed:this.counter++,data:p[0]}),this.prune(),p[0]})}getDirectory(n,l,h,p){return qi(this,null,function*(){let y=`${n.getKey()}|${p.etag||""}|${l}|${h}`,m=this.cache.get(y);if(m)return m.lastUsed=this.counter++,m.data;let a=yield ly(n,this.decompress,l,h,p);return this.cache.set(y,{lastUsed:this.counter++,data:a}),this.prune(),a})}prune(){if(this.cache.size>this.maxCacheEntries){let n=1/0,l;this.cache.forEach((h,p)=>{h.lastUsed<n&&(n=h.lastUsed,l=p)}),l&&this.cache.delete(l)}}invalidate(n){return qi(this,null,function*(){this.cache.delete(n.getKey())})}};Br(jD,"ResolvedValueCache");var _2=class{constructor(n=100,l=!0,h=Dp){this.cache=new Map,this.invalidations=new Map,this.maxCacheEntries=n,this.counter=1,this.decompress=h}getHeader(n){return qi(this,null,function*(){let l=n.getKey(),h=this.cache.get(l);if(h)return h.lastUsed=this.counter++,yield h.data;let p=new Promise((y,m)=>{ay(n,this.decompress).then(a=>{a[1]&&this.cache.set(a[1][0],{lastUsed:this.counter++,data:Promise.resolve(a[1][2])}),y(a[0]),this.prune()}).catch(a=>{m(a)})});return this.cache.set(l,{lastUsed:this.counter++,data:p}),p})}getDirectory(n,l,h,p){return qi(this,null,function*(){let y=`${n.getKey()}|${p.etag||""}|${l}|${h}`,m=this.cache.get(y);if(m)return m.lastUsed=this.counter++,yield m.data;let a=new Promise((I,z)=>{ly(n,this.decompress,l,h,p).then(P=>{I(P),this.prune()}).catch(P=>{z(P)})});return this.cache.set(y,{lastUsed:this.counter++,data:a}),a})}prune(){if(this.cache.size>=this.maxCacheEntries){let n=1/0,l;this.cache.forEach((h,p)=>{h.lastUsed<n&&(n=h.lastUsed,l=p)}),l&&this.cache.delete(l)}}invalidate(n){return qi(this,null,function*(){let l=n.getKey();if(this.invalidations.get(l))return yield this.invalidations.get(l);this.cache.delete(n.getKey());let h=new Promise((p,y)=>{this.getHeader(n).then(m=>{p(),this.invalidations.delete(l)}).catch(m=>{y(m)})});this.invalidations.set(l,h)})}};Br(_2,"SharedPromiseCache");var ND=_2,y2=class{constructor(n,l,h){typeof n=="string"?this.source=new BD(n):this.source=n,h?this.decompress=h:this.decompress=Dp,l?this.cache=l:this.cache=new ND}getHeader(){return qi(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(n,l,h,p){return qi(this,null,function*(){let y=h2(n,l,h),m=yield this.cache.getHeader(this.source);if(n<m.minZoom||n>m.maxZoom)return;let a=m.rootDirectoryOffset,I=m.rootDirectoryLength;for(let z=0;z<=3;z++){let P=yield this.cache.getDirectory(this.source,a,I,m),k=f2(P,y);if(k){if(k.runLength>0){let N=yield this.source.getBytes(m.tileDataOffset+k.offset,k.length,p,m.etag);return{data:yield this.decompress(N.data,m.tileCompression),cacheControl:N.cacheControl,expires:N.expires}}a=m.leafDirectoryOffset+k.offset,I=k.length}else return}throw new Error("Maximum directory depth exceeded")})}getZxy(n,l,h,p){return qi(this,null,function*(){try{return yield this.getZxyAttempt(n,l,h,p)}catch(y){if(y instanceof d_)return this.cache.invalidate(this.source),yield this.getZxyAttempt(n,l,h,p);throw y}})}getMetadataAttempt(){return qi(this,null,function*(){let n=yield this.cache.getHeader(this.source),l=yield this.source.getBytes(n.jsonMetadataOffset,n.jsonMetadataLength,void 0,n.etag),h=yield this.decompress(l.data,n.internalCompression),p=new TextDecoder("utf-8");return JSON.parse(p.decode(h))})}getMetadata(){return qi(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(n){if(n instanceof d_)return this.cache.invalidate(this.source),yield this.getMetadataAttempt();throw n}})}getTileJson(n){return qi(this,null,function*(){let l=yield this.getHeader(),h=yield this.getMetadata(),p=d2(l.tileType);return{tilejson:"3.0.0",scheme:"xyz",tiles:[`${n}/{z}/{x}/{y}${p}`],vector_layers:h.vector_layers,attribution:h.attribution,description:h.description,name:h.name,version:h.version,bounds:[l.minLon,l.minLat,l.maxLon,l.maxLat],center:[l.centerLon,l.centerLat,l.centerZoom],minzoom:l.minZoom,maxzoom:l.maxZoom}})}};Br(y2,"PMTiles");var zb=y2;const Rb={LIGHT:"https://api.protomaps.com/styles/v4/white/ja.json?key=afde32549db516d8",DARK:"https://api.protomaps.com/styles/v4/black/ja.json?key=afde32549db516d8"},wg=[{id:8e4,minZoom:4,maxZoom:8,level:"80km",name:"80(1)"},{id:1e4,minZoom:8,maxZoom:11,level:"10km",name:"10(2)"},{id:5e3,minZoom:11,maxZoom:12,level:"5km",name:"5"},{id:2e3,minZoom:12,maxZoom:13,level:"2km",name:"2"},{id:1e3,minZoom:13,maxZoom:14,level:"1km",name:"(3)"},{id:500,minZoom:14,maxZoom:15,level:"500m",name:"21"},{id:250,minZoom:15,maxZoom:16,level:"250m",name:"41"},{id:125,minZoom:16,maxZoom:18,level:"125m",name:"81"}],VD={class:"relative"},$D={class:"absolute top-2 left-2 z-10 flex items-center"},UD={class:"absolute top-2 right-2 z-10 flex items-center"},GD={class:"truncate"},ZD={class:"truncate"},qD=Ur({__name:"MeshMap",setup(t){const n=L_(),l=co(),h=mw(),p=$t(n.query.code||""),y=$t(wg[0]);let m=null;const a=$t(!1),I=$t(!1),z=Ye(()=>h.preference==="light"?Rb.LIGHT:Rb.DARK),P=Ye(()=>ro.isValidCode(p.value)),k=Ye(()=>I.value?"i-heroicons-clipboard-document-check":"i-heroicons-clipboard-document"),N=Ye(()=>I.value?"":"GeoJSON ");Li(h,()=>{if(!m)return;m.setStyle(z.value);const J=be(m.getZoom());setTimeout(()=>H(m,J),1e3)}),Li(p,J=>{if(m)if(J){if(!ro.isValidCode(J))return;X(m),F(J),l.push({query:{code:J}})}else{const le=be(m.getZoom());H(m,le),l.push({query:{}})}}),Li(y,J=>{if(!m)return;const le=m.getZoom();(le<=J.minZoom||le>J.maxZoom)&&m.setZoom(J.maxZoom)}),Sn(()=>{let J=[138.517821,34.380147],le=4,Me=8e4;if(p.value){const Ee=ro.toLatLngBounds(p.value).getCenter();J=[Ee.lng,Ee.lat],le=Q(p.value),Me=ro.getLevel(p.value)}m=new Jw.Map({container:"map",style:z.value,center:J,zoom:le,minZoom:4,maxZoom:18});const Ie=new kD;oD.addProtocol("pmtiles",Ie.tile),m.on("load",()=>{m&&(a.value=!0,H(m,Me),m.on("click","polygon-mesh-fill",Be=>{const Ee=Be.features;p.value=Ee[0].properties.code}))}),m.on("moveend",()=>{if(!m)return;const Be=be(m.getZoom());H(m,Be)})});function F(J){if(!m)return;const Me=ro.toLatLngBounds(J).getCenter(),Ie=Q(J);m.getZoom()===Ie?m.panTo([Me.lng,Me.lat]):m.flyTo({center:[Me.lng,Me.lat],zoom:Ie})}function H(J,le){const Me=wg.find(Ie=>Ie.id===le);Me&&(y.value=Me),X(J),ae(J,le)}async function X(J){const le=J.getSource("polygon-selected-mesh");if(!(le&&(await le.getData()).properties.code===p.value)&&(J.getLayer("polygon-selected-mesh")&&J.removeLayer("polygon-selected-mesh"),J.getSource("polygon-selected-mesh")&&J.removeSource("polygon-selected-mesh"),p.value)){J.addSource("polygon-selected-mesh",{type:"geojson",data:ro.toGeoJSON(p.value,{code:p.value})});const Me=J.getLayer("polygon-mesh-line")?"polygon-mesh-line":void 0;J.addLayer({id:"polygon-selected-mesh",type:"fill",source:"polygon-selected-mesh",paint:{"fill-color":"#f87171","fill-opacity":.5}},Me)}}async function ae(J,le){const Me=Se(J,le);if(!Me)return;const Ie=J.getSource("polygon-mesh");if(Ie){const Ae=(await Ie.getData()).features.map(He=>He.properties.code);if(Me.sort().toString()===Ae.sort().toString())return}const Be={type:"FeatureCollection",features:Me.map(Re=>ro.toGeoJSON(Re,{code:Re}))},Ee={type:"FeatureCollection",features:Me.map(Re=>{const He=ro.toLatLngBounds(Re).getCenter();return{type:"Feature",geometry:{type:"Point",coordinates:[He.lng,He.lat]},properties:{code:Re}}})};J.getLayer("polygon-mesh-line")&&J.removeLayer("polygon-mesh-line"),J.getLayer("polygon-mesh-fill")&&J.removeLayer("polygon-mesh-fill"),J.getLayer("polygon-mesh-symbol")&&J.removeLayer("polygon-mesh-symbol"),J.getSource("polygon-mesh")&&J.removeSource("polygon-mesh"),J.getSource("center-mesh")&&J.removeSource("center-mesh"),J.addSource("polygon-mesh",{type:"geojson",data:Be}),J.addSource("center-mesh",{type:"geojson",data:Ee}),J.addLayer({id:"polygon-mesh-line",type:"line",source:"polygon-mesh",paint:{"line-color":"#f87171","line-width":1}}),J.addLayer({id:"polygon-mesh-fill",type:"fill",source:"polygon-mesh",paint:{"fill-opacity":0}}),J.addLayer({id:"polygon-mesh-symbol",type:"symbol",source:"center-mesh",layout:{"text-field":["get","code"],"text-font":["Noto Sans Regular"],"text-size":["interpolate",["linear"],["zoom"],4,8,9,14],"text-anchor":"center","text-justify":"center","text-allow-overlap":!0},paint:{"text-halo-color":"#fff","text-halo-width":.8}})}function Se(J,le){if(le){const Me=J.getBounds().getNorthEast(),Ie=J.getBounds().getSouthWest(),Be=new Qw(Me.lat,Me.lng,Ie.lat,Ie.lng);return ro.getCodesWithinBounds(Be,le)}return ro.getCodes()}function be(J){let le;return J<=9?le=8e4:J>9&&J<=11?le=1e4:J>11&&J<=12?le=5e3:J>12&&J<=13?le=2e3:J>13&&J<=14?le=1e3:J>14&&J<=15?le=500:J>15&&J<=16?le=250:J>16?le=125:le=8e4,le}function Q(J){switch(ro.getLevel(J)){case 8e4:return 9;case 1e4:return 11;case 5e3:return 12;case 2e3:return 13;case 1e3:return 14;case 500:return 15;case 250:return 16;case 125:return 17;default:return 4}}async function re(){const J=ro.toGeoJSON(p.value,{code:p.value});await navigator.clipboard.writeText(JSON.stringify(J,null,2)),I.value=!0,setTimeout(()=>I.value=!1,3e3)}return(J,le)=>{const Me=pw,Ie=GL,Be=hw,Ee=tD;return Bt(),Vr("div",VD,[gr(a)?(Bt(),Vr(ki,{key:0},[xi("div",$D,[cr(Ie,{modelValue:gr(p),"onUpdate:modelValue":le[1]||(le[1]=Re=>li(p)?p.value=Re:null),name:"selectedCode",placeholder:"",icon:"i-heroicons-magnifying-glass-20-solid",autocomplete:"off",size:"md",ui:{icon:{trailing:{pointer:""}}}},{trailing:Zi(()=>[XS(cr(Me,{color:"gray",variant:"link",icon:"i-heroicons-x-mark-20-solid",padded:!1,onClick:le[0]||(le[0]=Re=>p.value="")},null,512),[[gC,gr(p)!==""]])]),_:1},8,["modelValue"]),gr(P)?(Bt(),kr(Me,{key:0,icon:gr(k),color:"white",variant:"solid",size:"md",class:"ml-2",onClick:re},{default:Zi(()=>[Tl(en(gr(N)),1)]),_:1},8,["icon"])):pi("",!0)]),xi("div",UD,[cr(Ee,{modelValue:gr(y),"onUpdate:modelValue":le[2]||(le[2]=Re=>li(y)?y.value=Re:null),options:gr(wg),class:"w-80"},{label:Zi(()=>[cr(Be,{variant:"outline",class:"w-12 justify-center"},{default:Zi(()=>[Tl(en(gr(y).level),1)]),_:1}),xi("span",GD,en(gr(y).name),1)]),option:Zi(({option:Re})=>[cr(Be,{variant:"outline",class:"w-12 justify-center"},{default:Zi(()=>[Tl(en(Re.level),1)]),_:2},1024),xi("span",ZD,en(Re.name),1)]),_:1},8,["modelValue","options"])])],64)):pi("",!0),le[3]||(le[3]=xi("div",{id:"map"},null,-1))])}}}),HD=Qo(qD,[["__scopeId","data-v-d0733d91"]]),WD={};function KD(t,n){const l=NL,h=HD;return Bt(),Vr("div",null,[cr(l),xi("main",null,[cr(h)])])}const XD=Qo(WD,[["render",KD]]),YD={__name:"nuxt-error-page",props:{error:Object},setup(t){const l=t.error;l.stack&&l.stack.split(`
`).splice(1).map(k=>({text:k.replace("webpack:/","").replace(".vue",".js").trim(),internal:k.includes("node_modules")&&!k.includes(".cache")||k.includes("internal")||k.includes("new Promise")})).map(k=>`<span class="stack${k.internal?" internal":""}">${k.text}</span>`).join(`
`);const h=Number(l.statusCode||500),p=h===404,y=l.statusMessage??(p?"Page Not Found":"Internal Server Error"),m=l.message||l.toString(),a=void 0,P=p?Pg(()=>Xg(()=>import("./CBJuTfH-.js"),__vite__mapDeps([0,1]),import.meta.url)):Pg(()=>Xg(()=>import("./D5Y6l-CT.js"),__vite__mapDeps([2,3]),import.meta.url));return(k,N)=>(Bt(),kr(gr(P),Wf(Zh({statusCode:gr(h),statusMessage:gr(y),description:gr(m),stack:gr(a)})),null,16))}},JD={key:0},Db={__name:"nuxt-root",setup(t){const n=()=>null,l=ii(),h=l.deferHydration();if(l.isHydrating){const I=l.hooks.hookOnce("app:error",h);co().beforeEach(I)}const p=!1;Pa(M1,L_()),l.hooks.callHookWith(I=>I.map(z=>z()),"vue:setup");const y=z_(),m=!1;Cx((I,z,P)=>{if(l.hooks.callHook("vue:error",I,z,P).catch(k=>console.error("[nuxt] Error in `vue:error` hook",k)),iM(I)&&(I.fatal||I.unhandled))return l.runWithContext(()=>tM(I)),!1});const a=!1;return(I,z)=>(Bt(),kr(UE,{onResolve:gr(h)},{default:Zi(()=>[gr(m)?(Bt(),Vr("div",JD)):gr(y)?(Bt(),kr(gr(YD),{key:1,error:gr(y)},null,8,["error"])):gr(a)?(Bt(),kr(gr(n),{key:2,context:gr(a)},null,8,["context"])):gr(p)?(Bt(),kr(Sa(gr(p)),{key:3})):(Bt(),kr(gr(XD),{key:4}))]),_:1},8,["onResolve"]))}};let Ob;{let t;Ob=async function(){var m,a;if(t)return t;const h=!!(((m=window.__NUXT__)==null?void 0:m.serverRendered)??((a=document.getElementById("__NUXT_DATA__"))==null?void 0:a.dataset.ssr)==="true")?RC(Db):zC(Db),p=UI({vueApp:h});async function y(I){var z;await p.callHook("app:error",I),(z=p.payload).error||(z.error=R_(I))}h.config.errorHandler=y,p.hook("app:suspense:resolve",()=>{h.config.errorHandler===y&&(h.config.errorHandler=void 0)});try{await qI(p,Uk)}catch(I){y(I)}try{await p.hooks.callHook("app:created",h),await p.hooks.callHook("app:beforeMount",h),h.mount(NI),await p.hooks.callHook("app:mounted",h),await tn()}catch(I){y(I)}return h},t=Ob().catch(n=>{throw console.error("Error while mounting app:",n),n})}export{Qo as _,xi as a,cr as b,Vr as c,Tl as d,sw as e,Bt as o,en as t,UM as u,Zi as w};
