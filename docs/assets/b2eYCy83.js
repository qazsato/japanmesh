const __vite__fileDeps=["./YvfZNES3.js","./IconCSS.Z2BAHt_z.css","./C_cJ6gtL.js","./error-404.CjGVuf6H.css","./DbCcxgd5.js","./error-500.DFBAsgKS.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
var FE=Object.defineProperty;var VE=(e,n,s)=>n in e?FE(e,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[n]=s;var Fa=(e,n,s)=>VE(e,typeof n!="symbol"?n+"":n,s);/**
* @vue/shared v3.4.29
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Ag(e,n){const s=new Set(e.split(","));return u=>s.has(u)}const Gi={},tc=[],Jn=()=>{},NE=()=>!1,hh=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),kg=e=>e.startsWith("onUpdate:"),wr=Object.assign,Mg=(e,n)=>{const s=e.indexOf(n);s>-1&&e.splice(s,1)},$E=Object.prototype.hasOwnProperty,hi=(e,n)=>$E.call(e,n),$t=Array.isArray,ic=e=>kf(e)==="[object Map]",gx=e=>kf(e)==="[object Set]",qt=e=>typeof e=="function",ir=e=>typeof e=="string",el=e=>typeof e=="symbol",ji=e=>e!==null&&typeof e=="object",Lg=e=>(ji(e)||qt(e))&&qt(e.then)&&qt(e.catch),yx=Object.prototype.toString,kf=e=>yx.call(e),jE=e=>kf(e).slice(8,-1),_x=e=>kf(e)==="[object Object]",Pg=e=>ir(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,rc=Ag(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Mf=e=>{const n=Object.create(null);return s=>n[s]||(n[s]=e(s))},UE=/-(\w)/g,Oo=Mf(e=>e.replace(UE,(n,s)=>s?s.toUpperCase():"")),qE=/\B([A-Z])/g,_c=Mf(e=>e.replace(qE,"-$1").toLowerCase()),Lf=Mf(e=>e.charAt(0).toUpperCase()+e.slice(1)),cm=Mf(e=>e?`on${Lf(e)}`:""),ta=(e,n)=>!Object.is(e,n),um=(e,...n)=>{for(let s=0;s<e.length;s++)e[s](...n)},vx=(e,n,s,u=!1)=>{Object.defineProperty(e,n,{configurable:!0,enumerable:!1,writable:u,value:s})},HE=e=>{const n=parseFloat(e);return isNaN(n)?e:n},xx=e=>{const n=ir(e)?Number(e):NaN;return isNaN(n)?e:n};let g0;const bx=()=>g0||(g0=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function ia(e){if($t(e)){const n={};for(let s=0;s<e.length;s++){const u=e[s],h=ir(u)?KE(u):ia(u);if(h)for(const g in h)n[g]=h[g]}return n}else if(ir(e)||ji(e))return e}const GE=/;(?![^(]*\))/g,ZE=/:([^]+)/,WE=/\/\*[^]*?\*\//g;function KE(e){const n={};return e.replace(WE,"").split(GE).forEach(s=>{if(s){const u=s.split(ZE);u.length>1&&(n[u[0].trim()]=u[1].trim())}}),n}function Mt(e){let n="";if(ir(e))n=e;else if($t(e))for(let s=0;s<e.length;s++){const u=Mt(e[s]);u&&(n+=u+" ")}else if(ji(e))for(const s in e)e[s]&&(n+=s+" ");return n.trim()}function Dm(e){if(!e)return null;let{class:n,style:s}=e;return n&&!ir(n)&&(e.class=Mt(n)),s&&(e.style=ia(s)),e}const XE="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",JE=Ag(XE);function wx(e){return!!e||e===""}const Ur=e=>ir(e)?e:e==null?"":$t(e)||ji(e)&&(e.toString===yx||!qt(e.toString))?JSON.stringify(e,Ex,2):String(e),Ex=(e,n)=>n&&n.__v_isRef?Ex(e,n.value):ic(n)?{[`Map(${n.size})`]:[...n.entries()].reduce((s,[u,h],g)=>(s[hm(u,g)+" =>"]=h,s),{})}:gx(n)?{[`Set(${n.size})`]:[...n.values()].map(s=>hm(s))}:el(n)?hm(n):ji(n)&&!$t(n)&&!_x(n)?String(n):n,hm=(e,n="")=>{var s;return el(e)?`Symbol(${(s=e.description)!=null?s:n})`:e};/**
* @vue/reactivity v3.4.29
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Dn;class Sx{constructor(n=!1){this.detached=n,this._active=!0,this.effects=[],this.cleanups=[],this.parent=Dn,!n&&Dn&&(this.index=(Dn.scopes||(Dn.scopes=[])).push(this)-1)}get active(){return this._active}run(n){if(this._active){const s=Dn;try{return Dn=this,n()}finally{Dn=s}}}on(){Dn=this}off(){Dn=this.parent}stop(n){if(this._active){let s,u;for(s=0,u=this.effects.length;s<u;s++)this.effects[s].stop();for(s=0,u=this.cleanups.length;s<u;s++)this.cleanups[s]();if(this.scopes)for(s=0,u=this.scopes.length;s<u;s++)this.scopes[s].stop(!0);if(!this.detached&&this.parent&&!n){const h=this.parent.scopes.pop();h&&h!==this&&(this.parent.scopes[this.index]=h,h.index=this.index)}this.parent=void 0,this._active=!1}}}function YE(e){return new Sx(e)}function QE(e,n=Dn){n&&n.active&&n.effects.push(e)}function zg(){return Dn}function Ix(e){Dn&&Dn.cleanups.push(e)}let Za;class Dg{constructor(n,s,u,h){this.fn=n,this.trigger=s,this.scheduler=u,this.active=!0,this.deps=[],this._dirtyLevel=5,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,QE(this,h)}get dirty(){if(this._dirtyLevel===2)return!1;if(this._dirtyLevel===3||this._dirtyLevel===4){this._dirtyLevel=1,na();for(let n=0;n<this._depsLength;n++){const s=this.deps[n];if(s.computed){if(s.computed.effect._dirtyLevel===2)return!0;if(eS(s.computed),this._dirtyLevel>=5)break}}this._dirtyLevel===1&&(this._dirtyLevel=0),oa()}return this._dirtyLevel>=5}set dirty(n){this._dirtyLevel=n?5:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let n=Qs,s=Za;try{return Qs=!0,Za=this,this._runnings++,y0(this),this.fn()}finally{_0(this),this._runnings--,Za=s,Qs=n}}stop(){this.active&&(y0(this),_0(this),this.onStop&&this.onStop(),this.active=!1)}}function eS(e){return e.value}function y0(e){e._trackId++,e._depsLength=0}function _0(e){if(e.deps.length>e._depsLength){for(let n=e._depsLength;n<e.deps.length;n++)Tx(e.deps[n],e);e.deps.length=e._depsLength}}function Tx(e,n){const s=e.get(n);s!==void 0&&n._trackId!==s&&(e.delete(n),e.size===0&&e.cleanup())}let Qs=!0,Rm=0;const Cx=[];function na(){Cx.push(Qs),Qs=!1}function oa(){const e=Cx.pop();Qs=e===void 0?!0:e}function Rg(){Rm++}function Og(){for(Rm--;!Rm&&Om.length;)Om.shift()()}function Ax(e,n,s){if(n.get(e)!==e._trackId){n.set(e,e._trackId);const u=e.deps[e._depsLength];u!==n?(u&&Tx(u,e),e.deps[e._depsLength++]=n):e._depsLength++}}const Om=[];function kx(e,n,s){Rg();for(const u of e.keys()){if(!e.computed&&u.computed&&e.get(u)===u._trackId&&u._runnings>0){u._dirtyLevel=2;continue}let h;u._dirtyLevel<n&&(h??(h=e.get(u)===u._trackId))&&(u._shouldSchedule||(u._shouldSchedule=u._dirtyLevel===0),u.computed&&u._dirtyLevel===2&&(u._shouldSchedule=!0),u._dirtyLevel=n),u._shouldSchedule&&(h??(h=e.get(u)===u._trackId))&&(u.trigger(),(!u._runnings||u.allowRecurse)&&u._dirtyLevel!==3&&(u._shouldSchedule=!1,u.scheduler&&Om.push(u.scheduler)))}Og()}const Mx=(e,n)=>{const s=new Map;return s.cleanup=e,s.computed=n,s},of=new WeakMap,Wa=Symbol(""),Bm=Symbol("");function En(e,n,s){if(Qs&&Za){let u=of.get(e);u||of.set(e,u=new Map);let h=u.get(s);h||u.set(s,h=Mx(()=>u.delete(s))),Ax(Za,h)}}function ds(e,n,s,u,h,g){const m=of.get(e);if(!m)return;let c=[];if(n==="clear")c=[...m.values()];else if(s==="length"&&$t(e)){const I=Number(u);m.forEach((M,k)=>{(k==="length"||!el(k)&&k>=I)&&c.push(M)})}else switch(s!==void 0&&c.push(m.get(s)),n){case"add":$t(e)?Pg(s)&&c.push(m.get("length")):(c.push(m.get(Wa)),ic(e)&&c.push(m.get(Bm)));break;case"delete":$t(e)||(c.push(m.get(Wa)),ic(e)&&c.push(m.get(Bm)));break;case"set":ic(e)&&c.push(m.get(Wa));break}Rg();for(const I of c)I&&kx(I,5);Og()}function tS(e,n){const s=of.get(e);return s&&s.get(n)}const iS=Ag("__proto__,__v_isRef,__isVue"),Lx=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(el)),v0=rS();function rS(){const e={};return["includes","indexOf","lastIndexOf"].forEach(n=>{e[n]=function(...s){const u=Vt(this);for(let g=0,m=this.length;g<m;g++)En(u,"get",g+"");const h=u[n](...s);return h===-1||h===!1?u[n](...s.map(Vt)):h}}),["push","pop","shift","unshift","splice"].forEach(n=>{e[n]=function(...s){na(),Rg();const u=Vt(this)[n].apply(this,s);return Og(),oa(),u}}),e}function nS(e){el(e)||(e=String(e));const n=Vt(this);return En(n,"has",e),n.hasOwnProperty(e)}class Px{constructor(n=!1,s=!1){this._isReadonly=n,this._isShallow=s}get(n,s,u){const h=this._isReadonly,g=this._isShallow;if(s==="__v_isReactive")return!h;if(s==="__v_isReadonly")return h;if(s==="__v_isShallow")return g;if(s==="__v_raw")return u===(h?g?yS:Ox:g?Rx:Dx).get(n)||Object.getPrototypeOf(n)===Object.getPrototypeOf(u)?n:void 0;const m=$t(n);if(!h){if(m&&hi(v0,s))return Reflect.get(v0,s,u);if(s==="hasOwnProperty")return nS}const c=Reflect.get(n,s,u);return(el(s)?Lx.has(s):iS(s))||(h||En(n,"get",s),g)?c:fr(c)?m&&Pg(s)?c:c.value:ji(c)?h?Vg(c):Bo(c):c}}class zx extends Px{constructor(n=!1){super(!1,n)}set(n,s,u,h){let g=n[s];if(!this._isShallow){const I=cc(g);if(!sf(u)&&!cc(u)&&(g=Vt(g),u=Vt(u)),!$t(n)&&fr(g)&&!fr(u))return I?!1:(g.value=u,!0)}const m=$t(n)&&Pg(s)?Number(s)<n.length:hi(n,s),c=Reflect.set(n,s,u,h);return n===Vt(h)&&(m?ta(u,g)&&ds(n,"set",s,u):ds(n,"add",s,u)),c}deleteProperty(n,s){const u=hi(n,s);n[s];const h=Reflect.deleteProperty(n,s);return h&&u&&ds(n,"delete",s,void 0),h}has(n,s){const u=Reflect.has(n,s);return(!el(s)||!Lx.has(s))&&En(n,"has",s),u}ownKeys(n){return En(n,"iterate",$t(n)?"length":Wa),Reflect.ownKeys(n)}}class oS extends Px{constructor(n=!1){super(!0,n)}set(n,s){return!0}deleteProperty(n,s){return!0}}const sS=new zx,aS=new oS,lS=new zx(!0);const Bg=e=>e,Pf=e=>Reflect.getPrototypeOf(e);function Ad(e,n,s=!1,u=!1){e=e.__v_raw;const h=Vt(e),g=Vt(n);s||(ta(n,g)&&En(h,"get",n),En(h,"get",g));const{has:m}=Pf(h),c=u?Bg:s?$g:th;if(m.call(h,n))return c(e.get(n));if(m.call(h,g))return c(e.get(g));e!==h&&e.get(n)}function kd(e,n=!1){const s=this.__v_raw,u=Vt(s),h=Vt(e);return n||(ta(e,h)&&En(u,"has",e),En(u,"has",h)),e===h?s.has(e):s.has(e)||s.has(h)}function Md(e,n=!1){return e=e.__v_raw,!n&&En(Vt(e),"iterate",Wa),Reflect.get(e,"size",e)}function x0(e){e=Vt(e);const n=Vt(this);return Pf(n).has.call(n,e)||(n.add(e),ds(n,"add",e,e)),this}function b0(e,n){n=Vt(n);const s=Vt(this),{has:u,get:h}=Pf(s);let g=u.call(s,e);g||(e=Vt(e),g=u.call(s,e));const m=h.call(s,e);return s.set(e,n),g?ta(n,m)&&ds(s,"set",e,n):ds(s,"add",e,n),this}function w0(e){const n=Vt(this),{has:s,get:u}=Pf(n);let h=s.call(n,e);h||(e=Vt(e),h=s.call(n,e)),u&&u.call(n,e);const g=n.delete(e);return h&&ds(n,"delete",e,void 0),g}function E0(){const e=Vt(this),n=e.size!==0,s=e.clear();return n&&ds(e,"clear",void 0,void 0),s}function Ld(e,n){return function(u,h){const g=this,m=g.__v_raw,c=Vt(m),I=n?Bg:e?$g:th;return!e&&En(c,"iterate",Wa),m.forEach((M,k)=>u.call(h,I(M),I(k),g))}}function Pd(e,n,s){return function(...u){const h=this.__v_raw,g=Vt(h),m=ic(g),c=e==="entries"||e===Symbol.iterator&&m,I=e==="keys"&&m,M=h[e](...u),k=s?Bg:n?$g:th;return!n&&En(g,"iterate",I?Bm:Wa),{next(){const{value:C,done:L}=M.next();return L?{value:C,done:L}:{value:c?[k(C[0]),k(C[1])]:k(C),done:L}},[Symbol.iterator](){return this}}}}function js(e){return function(...n){return e==="delete"?!1:e==="clear"?void 0:this}}function cS(){const e={get(g){return Ad(this,g)},get size(){return Md(this)},has:kd,add:x0,set:b0,delete:w0,clear:E0,forEach:Ld(!1,!1)},n={get(g){return Ad(this,g,!1,!0)},get size(){return Md(this)},has:kd,add:x0,set:b0,delete:w0,clear:E0,forEach:Ld(!1,!0)},s={get(g){return Ad(this,g,!0)},get size(){return Md(this,!0)},has(g){return kd.call(this,g,!0)},add:js("add"),set:js("set"),delete:js("delete"),clear:js("clear"),forEach:Ld(!0,!1)},u={get(g){return Ad(this,g,!0,!0)},get size(){return Md(this,!0)},has(g){return kd.call(this,g,!0)},add:js("add"),set:js("set"),delete:js("delete"),clear:js("clear"),forEach:Ld(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(g=>{e[g]=Pd(g,!1,!1),s[g]=Pd(g,!0,!1),n[g]=Pd(g,!1,!0),u[g]=Pd(g,!0,!0)}),[e,s,n,u]}const[uS,hS,dS,fS]=cS();function Fg(e,n){const s=n?e?fS:dS:e?hS:uS;return(u,h,g)=>h==="__v_isReactive"?!e:h==="__v_isReadonly"?e:h==="__v_raw"?u:Reflect.get(hi(s,h)&&h in u?s:u,h,g)}const pS={get:Fg(!1,!1)},mS={get:Fg(!1,!0)},gS={get:Fg(!0,!1)};const Dx=new WeakMap,Rx=new WeakMap,Ox=new WeakMap,yS=new WeakMap;function _S(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function vS(e){return e.__v_skip||!Object.isExtensible(e)?0:_S(jE(e))}function Bo(e){return cc(e)?e:Ng(e,!1,sS,pS,Dx)}function ec(e){return Ng(e,!1,lS,mS,Rx)}function Vg(e){return Ng(e,!0,aS,gS,Ox)}function Ng(e,n,s,u,h){if(!ji(e)||e.__v_raw&&!(n&&e.__v_isReactive))return e;const g=h.get(e);if(g)return g;const m=vS(e);if(m===0)return e;const c=new Proxy(e,m===2?u:s);return h.set(e,c),c}function Uu(e){return cc(e)?Uu(e.__v_raw):!!(e&&e.__v_isReactive)}function cc(e){return!!(e&&e.__v_isReadonly)}function sf(e){return!!(e&&e.__v_isShallow)}function Bx(e){return e?!!e.__v_raw:!1}function Vt(e){const n=e&&e.__v_raw;return n?Vt(n):e}function xS(e){return Object.isExtensible(e)&&vx(e,"__v_skip",!0),e}const th=e=>ji(e)?Bo(e):e,$g=e=>ji(e)?Vg(e):e;class Fx{constructor(n,s,u,h){this.getter=n,this._setter=s,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new Dg(()=>n(this._value),()=>qu(this,this.effect._dirtyLevel===3?3:4)),this.effect.computed=this,this.effect.active=this._cacheable=!h,this.__v_isReadonly=u}get value(){const n=Vt(this);return(!n._cacheable||n.effect.dirty)&&ta(n._value,n._value=n.effect.run())&&qu(n,5),Vx(n),n.effect._dirtyLevel>=2&&qu(n,3),n._value}set value(n){this._setter(n)}get _dirty(){return this.effect.dirty}set _dirty(n){this.effect.dirty=n}}function bS(e,n,s=!1){let u,h;const g=qt(e);return g?(u=e,h=Jn):(u=e.get,h=e.set),new Fx(u,h,g||!h,s)}function Vx(e){var n;Qs&&Za&&(e=Vt(e),Ax(Za,(n=e.dep)!=null?n:e.dep=Mx(()=>e.dep=void 0,e instanceof Fx?e:void 0)))}function qu(e,n=5,s,u){e=Vt(e);const h=e.dep;h&&kx(h,n)}function fr(e){return!!(e&&e.__v_isRef===!0)}function kt(e){return Nx(e,!1)}function uc(e){return Nx(e,!0)}function Nx(e,n){return fr(e)?e:new wS(e,n)}class wS{constructor(n,s){this.__v_isShallow=s,this.dep=void 0,this.__v_isRef=!0,this._rawValue=s?n:Vt(n),this._value=s?n:th(n)}get value(){return Vx(this),this._value}set value(n){const s=this.__v_isShallow||sf(n)||cc(n);n=s?n:Vt(n),ta(n,this._rawValue)&&(this._rawValue,this._rawValue=n,this._value=s?n:th(n),qu(this,5))}}function S0(e){qu(e,5)}function ni(e){return fr(e)?e.value:e}function dm(e){return qt(e)?e():ni(e)}const ES={get:(e,n,s)=>ni(Reflect.get(e,n,s)),set:(e,n,s,u)=>{const h=e[n];return fr(h)&&!fr(s)?(h.value=s,!0):Reflect.set(e,n,s,u)}};function $x(e){return Uu(e)?e:new Proxy(e,ES)}class SS{constructor(n,s,u){this._object=n,this._key=s,this._defaultValue=u,this.__v_isRef=!0}get value(){const n=this._object[this._key];return n===void 0?this._defaultValue:n}set value(n){this._object[this._key]=n}get dep(){return tS(Vt(this._object),this._key)}}class IS{constructor(n){this._getter=n,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}}function Qn(e,n,s){return fr(e)?e:qt(e)?new IS(e):ji(e)&&arguments.length>1?TS(e,n,s):kt(e)}function TS(e,n,s){const u=e[n];return fr(u)?u:new SS(e,n,s)}/**
* @vue/runtime-core v3.4.29
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function ea(e,n,s,u){try{return u?e(...u):e()}catch(h){vc(h,n,s)}}function eo(e,n,s,u){if(qt(e)){const h=ea(e,n,s,u);return h&&Lg(h)&&h.catch(g=>{vc(g,n,s)}),h}if($t(e)){const h=[];for(let g=0;g<e.length;g++)h.push(eo(e[g],n,s,u));return h}}function vc(e,n,s,u=!0){const h=n?n.vnode:null;if(n){let g=n.parent;const m=n.proxy,c=`https://vuejs.org/error-reference/#runtime-${s}`;for(;g;){const M=g.ec;if(M){for(let k=0;k<M.length;k++)if(M[k](e,m,c)===!1)return}g=g.parent}const I=n.appContext.config.errorHandler;if(I){na(),ea(I,null,10,[e,m,c]),oa();return}}CS(e,s,h,u)}function CS(e,n,s,u=!0){console.error(e)}let ih=!1,Fm=!1;const an=[];let zo=0;const nc=[];let Ks=null,qa=0;const jx=Promise.resolve();let jg=null;function qr(e){const n=jg||jx;return e?n.then(this?e.bind(this):e):n}function AS(e){let n=zo+1,s=an.length;for(;n<s;){const u=n+s>>>1,h=an[u],g=rh(h);g<e||g===e&&h.pre?n=u+1:s=u}return n}function zf(e){(!an.length||!an.includes(e,ih&&e.allowRecurse?zo+1:zo))&&(e.id==null?an.push(e):an.splice(AS(e.id),0,e),Ux())}function Ux(){!ih&&!Fm&&(Fm=!0,jg=jx.then(qx))}function kS(e){const n=an.indexOf(e);n>zo&&an.splice(n,1)}function Vm(e){$t(e)?nc.push(...e):(!Ks||!Ks.includes(e,e.allowRecurse?qa+1:qa))&&nc.push(e),Ux()}function I0(e,n,s=ih?zo+1:0){for(;s<an.length;s++){const u=an[s];if(u&&u.pre){if(e&&u.id!==e.uid)continue;an.splice(s,1),s--,u()}}}function af(e){if(nc.length){const n=[...new Set(nc)].sort((s,u)=>rh(s)-rh(u));if(nc.length=0,Ks){Ks.push(...n);return}for(Ks=n,qa=0;qa<Ks.length;qa++){const s=Ks[qa];s.active!==!1&&s()}Ks=null,qa=0}}const rh=e=>e.id==null?1/0:e.id,MS=(e,n)=>{const s=rh(e)-rh(n);if(s===0){if(e.pre&&!n.pre)return-1;if(n.pre&&!e.pre)return 1}return s};function qx(e){Fm=!1,ih=!0,an.sort(MS);try{for(zo=0;zo<an.length;zo++){const n=an[zo];n&&n.active!==!1&&ea(n,null,14)}}finally{zo=0,an.length=0,af(),ih=!1,jg=null,(an.length||nc.length)&&qx()}}function LS(e,n,...s){if(e.isUnmounted)return;const u=e.vnode.props||Gi;let h=s;const g=n.startsWith("update:"),m=g&&n.slice(7);if(m&&m in u){const k=`${m==="modelValue"?"model":m}Modifiers`,{number:C,trim:L}=u[k]||Gi;L&&(h=s.map(q=>ir(q)?q.trim():q)),C&&(h=s.map(HE))}let c,I=u[c=cm(n)]||u[c=cm(Oo(n))];!I&&g&&(I=u[c=cm(_c(n))]),I&&eo(I,e,6,h);const M=u[c+"Once"];if(M){if(!e.emitted)e.emitted={};else if(e.emitted[c])return;e.emitted[c]=!0,eo(M,e,6,h)}}function Hx(e,n,s=!1){const u=n.emitsCache,h=u.get(e);if(h!==void 0)return h;const g=e.emits;let m={},c=!1;if(!qt(e)){const I=M=>{const k=Hx(M,n,!0);k&&(c=!0,wr(m,k))};!s&&n.mixins.length&&n.mixins.forEach(I),e.extends&&I(e.extends),e.mixins&&e.mixins.forEach(I)}return!g&&!c?(ji(e)&&u.set(e,null),null):($t(g)?g.forEach(I=>m[I]=null):wr(m,g),ji(e)&&u.set(e,m),m)}function Df(e,n){return!e||!hh(n)?!1:(n=n.slice(2).replace(/Once$/,""),hi(e,n[0].toLowerCase()+n.slice(1))||hi(e,_c(n))||hi(e,n))}let Tr=null,Rf=null;function lf(e){const n=Tr;return Tr=e,Rf=e&&e.type.__scopeId||null,n}function Gx(e){Rf=e}function Zx(){Rf=null}function xr(e,n=Tr,s){if(!n||e._n)return e;const u=(...h)=>{u._d&&j0(-1);const g=lf(n);let m;try{m=e(...h)}finally{lf(g),u._d&&j0(1)}return m};return u._n=!0,u._c=!0,u._d=!0,u}function fm(e){const{type:n,vnode:s,proxy:u,withProxy:h,propsOptions:[g],slots:m,attrs:c,emit:I,render:M,renderCache:k,props:C,data:L,setupState:q,ctx:X,inheritAttrs:W}=e,ae=lf(e);let Ie,ee;try{if(s.shapeFlag&4){const ce=h||u,ne=ce;Ie=Xn(M.call(ne,ce,k,C,q,L,X)),ee=c}else{const ce=n;Ie=Xn(ce.length>1?ce(C,{attrs:c,slots:m,emit:I}):ce(C,null)),ee=n.props?c:zS(c)}}catch(ce){Wu.length=0,vc(ce,e,1),Ie=ei(Hr)}let H=Ie;if(ee&&W!==!1){const ce=Object.keys(ee),{shapeFlag:ne}=H;ce.length&&ne&7&&(g&&ce.some(kg)&&(ee=DS(ee,g)),H=Fo(H,ee,!1,!0))}return s.dirs&&(H=Fo(H,null,!1,!0),H.dirs=H.dirs?H.dirs.concat(s.dirs):s.dirs),s.transition&&(H.transition=s.transition),Ie=H,lf(ae),Ie}function PS(e,n=!0){let s;for(let u=0;u<e.length;u++){const h=e[u];if(sh(h)){if(h.type!==Hr||h.children==="v-if"){if(s)return;s=h}}else return}return s}const zS=e=>{let n;for(const s in e)(s==="class"||s==="style"||hh(s))&&((n||(n={}))[s]=e[s]);return n},DS=(e,n)=>{const s={};for(const u in e)(!kg(u)||!(u.slice(9)in n))&&(s[u]=e[u]);return s};function RS(e,n,s){const{props:u,children:h,component:g}=e,{props:m,children:c,patchFlag:I}=n,M=g.emitsOptions;if(n.dirs||n.transition)return!0;if(s&&I>=0){if(I&1024)return!0;if(I&16)return u?T0(u,m,M):!!m;if(I&8){const k=n.dynamicProps;for(let C=0;C<k.length;C++){const L=k[C];if(m[L]!==u[L]&&!Df(M,L))return!0}}}else return(h||c)&&(!c||!c.$stable)?!0:u===m?!1:u?m?T0(u,m,M):!0:!!m;return!1}function T0(e,n,s){const u=Object.keys(n);if(u.length!==Object.keys(e).length)return!0;for(let h=0;h<u.length;h++){const g=u[h];if(n[g]!==e[g]&&!Df(s,g))return!0}return!1}function Ug({vnode:e,parent:n},s){for(;n;){const u=n.subTree;if(u.suspense&&u.suspense.activeBranch===e&&(u.el=e.el),u===e)(e=n.vnode).el=s,n=n.parent;else break}}const Wx="components";function Nm(e,n){return Xx(Wx,e,!0,n)||e}const Kx=Symbol.for("v-ndc");function hs(e){return ir(e)?Xx(Wx,e,!1)||e:e||Kx}function Xx(e,n,s=!0,u=!1){const h=Tr||Ir;if(h){const g=h.type;{const c=VI(g,!1);if(c&&(c===n||c===Oo(n)||c===Lf(Oo(n))))return g}const m=C0(h[e]||g[e],n)||C0(h.appContext[e],n);return!m&&u?g:m}}function C0(e,n){return e&&(e[n]||e[Oo(n)]||e[Lf(Oo(n))])}const OS=e=>e.__isSuspense;let $m=0;const BS={name:"Suspense",__isSuspense:!0,process(e,n,s,u,h,g,m,c,I,M){if(e==null)VS(n,s,u,h,g,m,c,I,M);else{if(g&&g.deps>0&&!e.suspense.isInFallback){n.suspense=e.suspense,n.suspense.vnode=n,n.el=e.el;return}NS(e,n,s,u,h,m,c,I,M)}},hydrate:$S,create:qg,normalize:jS},FS=BS;function nh(e,n){const s=e.props&&e.props[n];qt(s)&&s()}function VS(e,n,s,u,h,g,m,c,I){const{p:M,o:{createElement:k}}=I,C=k("div"),L=e.suspense=qg(e,h,u,n,C,s,g,m,c,I);M(null,L.pendingBranch=e.ssContent,C,null,u,L,g,m),L.deps>0?(nh(e,"onPending"),nh(e,"onFallback"),M(null,e.ssFallback,n,s,u,null,g,m),oc(L,e.ssFallback)):L.resolve(!1,!0)}function NS(e,n,s,u,h,g,m,c,{p:I,um:M,o:{createElement:k}}){const C=n.suspense=e.suspense;C.vnode=n,n.el=e.el;const L=n.ssContent,q=n.ssFallback,{activeBranch:X,pendingBranch:W,isInFallback:ae,isHydrating:Ie}=C;if(W)C.pendingBranch=L,Do(L,W)?(I(W,L,C.hiddenContainer,null,h,C,g,m,c),C.deps<=0?C.resolve():ae&&(Ie||(I(X,q,s,u,h,null,g,m,c),oc(C,q)))):(C.pendingId=$m++,Ie?(C.isHydrating=!1,C.activeBranch=W):M(W,h,C),C.deps=0,C.effects.length=0,C.hiddenContainer=k("div"),ae?(I(null,L,C.hiddenContainer,null,h,C,g,m,c),C.deps<=0?C.resolve():(I(X,q,s,u,h,null,g,m,c),oc(C,q))):X&&Do(L,X)?(I(X,L,s,u,h,C,g,m,c),C.resolve(!0)):(I(null,L,C.hiddenContainer,null,h,C,g,m,c),C.deps<=0&&C.resolve()));else if(X&&Do(L,X))I(X,L,s,u,h,C,g,m,c),oc(C,L);else if(nh(n,"onPending"),C.pendingBranch=L,L.shapeFlag&512?C.pendingId=L.component.suspenseId:C.pendingId=$m++,I(null,L,C.hiddenContainer,null,h,C,g,m,c),C.deps<=0)C.resolve();else{const{timeout:ee,pendingId:H}=C;ee>0?setTimeout(()=>{C.pendingId===H&&C.fallback(q)},ee):ee===0&&C.fallback(q)}}function qg(e,n,s,u,h,g,m,c,I,M,k=!1){const{p:C,m:L,um:q,n:X,o:{parentNode:W,remove:ae}}=M;let Ie;const ee=US(e);ee&&n&&n.pendingBranch&&(Ie=n.pendingId,n.deps++);const H=e.props?xx(e.props.timeout):void 0,ce=g,ne={vnode:e,parent:n,parentComponent:s,namespace:m,container:u,hiddenContainer:h,deps:0,pendingId:$m++,timeout:typeof H=="number"?H:-1,activeBranch:null,pendingBranch:null,isInFallback:!k,isHydrating:k,isUnmounted:!1,effects:[],resolve(oe=!1,Ae=!1){const{vnode:be,activeBranch:Le,pendingBranch:me,pendingId:ke,effects:Me,parentComponent:Oe,container:Ge}=ne;let rt=!1;ne.isHydrating?ne.isHydrating=!1:oe||(rt=Le&&me.transition&&me.transition.mode==="out-in",rt&&(Le.transition.afterLeave=()=>{ke===ne.pendingId&&(L(me,Ge,g===ce?X(Le):g,0),Vm(Me))}),Le&&(W(Le.el)!==ne.hiddenContainer&&(g=X(Le)),q(Le,Oe,ne,!0)),rt||L(me,Ge,g,0)),oc(ne,me),ne.pendingBranch=null,ne.isInFallback=!1;let Ke=ne.parent,dt=!1;for(;Ke;){if(Ke.pendingBranch){Ke.effects.push(...Me),dt=!0;break}Ke=Ke.parent}!dt&&!rt&&Vm(Me),ne.effects=[],ee&&n&&n.pendingBranch&&Ie===n.pendingId&&(n.deps--,n.deps===0&&!Ae&&n.resolve()),nh(be,"onResolve")},fallback(oe){if(!ne.pendingBranch)return;const{vnode:Ae,activeBranch:be,parentComponent:Le,container:me,namespace:ke}=ne;nh(Ae,"onFallback");const Me=X(be),Oe=()=>{ne.isInFallback&&(C(null,oe,me,Me,Le,null,ke,c,I),oc(ne,oe))},Ge=oe.transition&&oe.transition.mode==="out-in";Ge&&(be.transition.afterLeave=Oe),ne.isInFallback=!0,q(be,Le,null,!0),Ge||Oe()},move(oe,Ae,be){ne.activeBranch&&L(ne.activeBranch,oe,Ae,be),ne.container=oe},next(){return ne.activeBranch&&X(ne.activeBranch)},registerDep(oe,Ae,be){const Le=!!ne.pendingBranch;Le&&ne.deps++;const me=oe.vnode.el;oe.asyncDep.catch(ke=>{vc(ke,oe,0)}).then(ke=>{if(oe.isUnmounted||ne.isUnmounted||ne.pendingId!==oe.suspenseId)return;oe.asyncResolved=!0;const{vnode:Me}=oe;Xm(oe,ke,!1),me&&(Me.el=me);const Oe=!me&&oe.subTree.el;Ae(oe,Me,W(me||oe.subTree.el),me?null:X(oe.subTree),ne,m,be),Oe&&ae(Oe),Ug(oe,Me.el),Le&&--ne.deps===0&&ne.resolve()})},unmount(oe,Ae){ne.isUnmounted=!0,ne.activeBranch&&q(ne.activeBranch,s,oe,Ae),ne.pendingBranch&&q(ne.pendingBranch,s,oe,Ae)}};return ne}function $S(e,n,s,u,h,g,m,c,I){const M=n.suspense=qg(n,u,s,e.parentNode,document.createElement("div"),null,h,g,m,c,!0),k=I(e,M.pendingBranch=n.ssContent,s,M,g,m);return M.deps===0&&M.resolve(!1,!0),k}function jS(e){const{shapeFlag:n,children:s}=e,u=n&32;e.ssContent=A0(u?s.default:s),e.ssFallback=u?A0(s.fallback):ei(Hr)}function A0(e){let n;if(qt(e)){const s=dc&&e._c;s&&(e._d=!1,_t()),e=e(),s&&(e._d=!0,n=Yn,Eb())}return $t(e)&&(e=PS(e)),e=Xn(e),n&&!e.dynamicChildren&&(e.dynamicChildren=n.filter(s=>s!==e)),e}function Jx(e,n){n&&n.pendingBranch?$t(e)?n.effects.push(...e):n.effects.push(e):Vm(e)}function oc(e,n){e.activeBranch=n;const{vnode:s,parentComponent:u}=e;let h=n.el;for(;!h&&n.component;)n=n.component.subTree,h=n.el;s.el=h,u&&u.subTree===s&&(u.vnode.el=h,Ug(u,h))}function US(e){const n=e.props&&e.props.suspensible;return n!=null&&n!==!1}function Of(e,n,s=Ir,u=!1){if(s){const h=s[e]||(s[e]=[]),g=n.__weh||(n.__weh=(...m)=>{na();const c=Xa(s),I=eo(n,s,e,m);return c(),oa(),I});return u?h.unshift(g):h.push(g),g}}const gs=e=>(n,s=Ir)=>{(!fh||e==="sp")&&Of(e,(...u)=>n(...u),s)},qS=gs("bm"),Wr=gs("m"),HS=gs("bu"),GS=gs("u"),Bf=gs("bum"),sa=gs("um"),ZS=gs("sp"),WS=gs("rtg"),KS=gs("rtc");function Yx(e,n=Ir){Of("ec",e,n)}function XS(e,n){if(Tr===null)return e;const s=Vf(Tr),u=e.dirs||(e.dirs=[]);for(let h=0;h<n.length;h++){let[g,m,c,I=Gi]=n[h];g&&(qt(g)&&(g={mounted:g,updated:g}),g.deep&&Ys(m),u.push({dir:g,instance:s,value:m,oldValue:void 0,arg:c,modifiers:I}))}return e}function Lo(e,n,s,u){const h=e.dirs,g=n&&n.dirs;for(let m=0;m<h.length;m++){const c=h[m];g&&(c.oldValue=g[m].value);let I=c.dir[u];I&&(na(),eo(I,s,8,[e.el,c,e,n]),oa())}}function oh(e,n,s,u){let h;const g=s;if($t(e)||ir(e)){h=new Array(e.length);for(let m=0,c=e.length;m<c;m++)h[m]=n(e[m],m,void 0,g)}else if(typeof e=="number"){h=new Array(e);for(let m=0;m<e;m++)h[m]=n(m+1,m,void 0,g)}else if(ji(e))if(e[Symbol.iterator])h=Array.from(e,(m,c)=>n(m,c,void 0,g));else{const m=Object.keys(e);h=new Array(m.length);for(let c=0,I=m.length;c<I;c++){const M=m[c];h[c]=n(e[M],M,c,g)}}else h=[];return h}function JS(e,n){for(let s=0;s<n.length;s++){const u=n[s];if($t(u))for(let h=0;h<u.length;h++)e[u[h].name]=u[h].fn;else u&&(e[u.name]=u.key?(...h)=>{const g=u.fn(...h);return g&&(g.key=u.key),g}:u.fn)}return e}/*! #__NO_SIDE_EFFECTS__ */function Ri(e,n){return qt(e)?wr({name:e.name},n,{setup:e}):e}const sc=e=>!!e.type.__asyncLoader;/*! #__NO_SIDE_EFFECTS__ */function cf(e){qt(e)&&(e={loader:e});const{loader:n,loadingComponent:s,errorComponent:u,delay:h=200,timeout:g,suspensible:m=!0,onError:c}=e;let I=null,M,k=0;const C=()=>(k++,I=null,L()),L=()=>{let q;return I||(q=I=n().catch(X=>{if(X=X instanceof Error?X:new Error(String(X)),c)return new Promise((W,ae)=>{c(X,()=>W(C()),()=>ae(X),k+1)});throw X}).then(X=>q!==I&&I?I:(X&&(X.__esModule||X[Symbol.toStringTag]==="Module")&&(X=X.default),M=X,X)))};return Ri({name:"AsyncComponentWrapper",__asyncLoader:L,get __asyncResolved(){return M},setup(){const q=Ir;if(M)return()=>pm(M,q);const X=ee=>{I=null,vc(ee,q,13,!u)};if(m&&q.suspense||fh)return L().then(ee=>()=>pm(ee,q)).catch(ee=>(X(ee),()=>u?ei(u,{error:ee}):null));const W=kt(!1),ae=kt(),Ie=kt(!!h);return h&&setTimeout(()=>{Ie.value=!1},h),g!=null&&setTimeout(()=>{if(!W.value&&!ae.value){const ee=new Error(`Async component timed out after ${g}ms.`);X(ee),ae.value=ee}},g),L().then(()=>{W.value=!0,q.parent&&dh(q.parent.vnode)&&(q.parent.effect.dirty=!0,zf(q.parent.update))}).catch(ee=>{X(ee),ae.value=ee}),()=>{if(W.value&&M)return pm(M,q);if(ae.value&&u)return ei(u,{error:ae.value});if(s&&!Ie.value)return ei(s)}}})}function pm(e,n){const{ref:s,props:u,children:h,ce:g}=n.vnode,m=ei(e,u,h);return m.ref=s,m.ce=g,delete n.vnode.ce,m}function sr(e,n,s={},u,h){if(Tr.isCE||Tr.parent&&sc(Tr.parent)&&Tr.parent.isCE)return n!=="default"&&(s.name=n),ei("slot",s,u&&u());let g=e[n];g&&g._c&&(g._d=!1),_t();const m=g&&Qx(g(s)),c=li(ar,{key:s.key||m&&m.key||`_${n}`},m||(u?u():[]),m&&e._===1?64:-2);return!h&&c.scopeId&&(c.slotScopeIds=[c.scopeId+"-s"]),g&&g._c&&(g._d=!0),c}function Qx(e){return e.some(n=>sh(n)?!(n.type===Hr||n.type===ar&&!Qx(n.children)):!0)?e:null}const jm=e=>e?Tb(e)?Vf(e):jm(e.parent):null,Hu=wr(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>jm(e.parent),$root:e=>jm(e.root),$emit:e=>e.emit,$options:e=>Hg(e),$forceUpdate:e=>e.f||(e.f=()=>{e.effect.dirty=!0,zf(e.update)}),$nextTick:e=>e.n||(e.n=qr.bind(e.proxy)),$watch:e=>EI.bind(e)}),mm=(e,n)=>e!==Gi&&!e.__isScriptSetup&&hi(e,n),YS={get({_:e},n){if(n==="__v_skip")return!0;const{ctx:s,setupState:u,data:h,props:g,accessCache:m,type:c,appContext:I}=e;let M;if(n[0]!=="$"){const q=m[n];if(q!==void 0)switch(q){case 1:return u[n];case 2:return h[n];case 4:return s[n];case 3:return g[n]}else{if(mm(u,n))return m[n]=1,u[n];if(h!==Gi&&hi(h,n))return m[n]=2,h[n];if((M=e.propsOptions[0])&&hi(M,n))return m[n]=3,g[n];if(s!==Gi&&hi(s,n))return m[n]=4,s[n];Um&&(m[n]=0)}}const k=Hu[n];let C,L;if(k)return n==="$attrs"&&En(e.attrs,"get",""),k(e);if((C=c.__cssModules)&&(C=C[n]))return C;if(s!==Gi&&hi(s,n))return m[n]=4,s[n];if(L=I.config.globalProperties,hi(L,n))return L[n]},set({_:e},n,s){const{data:u,setupState:h,ctx:g}=e;return mm(h,n)?(h[n]=s,!0):u!==Gi&&hi(u,n)?(u[n]=s,!0):hi(e.props,n)||n[0]==="$"&&n.slice(1)in e?!1:(g[n]=s,!0)},has({_:{data:e,setupState:n,accessCache:s,ctx:u,appContext:h,propsOptions:g}},m){let c;return!!s[m]||e!==Gi&&hi(e,m)||mm(n,m)||(c=g[0])&&hi(c,m)||hi(u,m)||hi(Hu,m)||hi(h.config.globalProperties,m)},defineProperty(e,n,s){return s.get!=null?e._.accessCache[n]=0:hi(s,"value")&&this.set(e,n,s.value,null),Reflect.defineProperty(e,n,s)}};function QS(){return eI().attrs}function eI(){const e=la();return e.setupContext||(e.setupContext=Ab(e))}function k0(e){return $t(e)?e.reduce((n,s)=>(n[s]=null,n),{}):e}function tI(e){const n=la();let s=e();return Km(),Lg(s)&&(s=s.catch(u=>{throw Xa(n),u})),[s,()=>Xa(n)]}let Um=!0;function iI(e){const n=Hg(e),s=e.proxy,u=e.ctx;Um=!1,n.beforeCreate&&M0(n.beforeCreate,e,"bc");const{data:h,computed:g,methods:m,watch:c,provide:I,inject:M,created:k,beforeMount:C,mounted:L,beforeUpdate:q,updated:X,activated:W,deactivated:ae,beforeDestroy:Ie,beforeUnmount:ee,destroyed:H,unmounted:ce,render:ne,renderTracked:oe,renderTriggered:Ae,errorCaptured:be,serverPrefetch:Le,expose:me,inheritAttrs:ke,components:Me,directives:Oe,filters:Ge}=n;if(M&&rI(M,u,null),m)for(const dt in m){const nt=m[dt];qt(nt)&&(u[dt]=nt.bind(s))}if(h){const dt=h.call(s,s);ji(dt)&&(e.data=Bo(dt))}if(Um=!0,g)for(const dt in g){const nt=g[dt],ti=qt(nt)?nt.bind(s,s):qt(nt.get)?nt.get.bind(s,s):Jn,Ut=!qt(nt)&&qt(nt.set)?nt.set.bind(s):Jn,Nt=Ve({get:ti,set:Ut});Object.defineProperty(u,dt,{enumerable:!0,configurable:!0,get:()=>Nt.value,set:jt=>Nt.value=jt})}if(c)for(const dt in c)eb(c[dt],u,s,dt);if(I){const dt=qt(I)?I.call(s):I;Reflect.ownKeys(dt).forEach(nt=>{aa(nt,dt[nt])})}k&&M0(k,e,"c");function Ke(dt,nt){$t(nt)?nt.forEach(ti=>dt(ti.bind(s))):nt&&dt(nt.bind(s))}if(Ke(qS,C),Ke(Wr,L),Ke(HS,q),Ke(GS,X),Ke(mb,W),Ke(gb,ae),Ke(Yx,be),Ke(KS,oe),Ke(WS,Ae),Ke(Bf,ee),Ke(sa,ce),Ke(ZS,Le),$t(me))if(me.length){const dt=e.exposed||(e.exposed={});me.forEach(nt=>{Object.defineProperty(dt,nt,{get:()=>s[nt],set:ti=>s[nt]=ti})})}else e.exposed||(e.exposed={});ne&&e.render===Jn&&(e.render=ne),ke!=null&&(e.inheritAttrs=ke),Me&&(e.components=Me),Oe&&(e.directives=Oe)}function rI(e,n,s=Jn){$t(e)&&(e=qm(e));for(const u in e){const h=e[u];let g;ji(h)?"default"in h?g=Zr(h.from||u,h.default,!0):g=Zr(h.from||u):g=Zr(h),fr(g)?Object.defineProperty(n,u,{enumerable:!0,configurable:!0,get:()=>g.value,set:m=>g.value=m}):n[u]=g}}function M0(e,n,s){eo($t(e)?e.map(u=>u.bind(n.proxy)):e.bind(n.proxy),n,s)}function eb(e,n,s,u){const h=u.includes(".")?pb(s,u):()=>s[u];if(ir(e)){const g=n[e];qt(g)&&Zi(h,g)}else if(qt(e))Zi(h,e.bind(s));else if(ji(e))if($t(e))e.forEach(g=>eb(g,n,s,u));else{const g=qt(e.handler)?e.handler.bind(s):n[e.handler];qt(g)&&Zi(h,g,e)}}function Hg(e){const n=e.type,{mixins:s,extends:u}=n,{mixins:h,optionsCache:g,config:{optionMergeStrategies:m}}=e.appContext,c=g.get(n);let I;return c?I=c:!h.length&&!s&&!u?I=n:(I={},h.length&&h.forEach(M=>uf(I,M,m,!0)),uf(I,n,m)),ji(n)&&g.set(n,I),I}function uf(e,n,s,u=!1){const{mixins:h,extends:g}=n;g&&uf(e,g,s,!0),h&&h.forEach(m=>uf(e,m,s,!0));for(const m in n)if(!(u&&m==="expose")){const c=nI[m]||s&&s[m];e[m]=c?c(e[m],n[m]):n[m]}return e}const nI={data:L0,props:P0,emits:P0,methods:ju,computed:ju,beforeCreate:yn,created:yn,beforeMount:yn,mounted:yn,beforeUpdate:yn,updated:yn,beforeDestroy:yn,beforeUnmount:yn,destroyed:yn,unmounted:yn,activated:yn,deactivated:yn,errorCaptured:yn,serverPrefetch:yn,components:ju,directives:ju,watch:sI,provide:L0,inject:oI};function L0(e,n){return n?e?function(){return wr(qt(e)?e.call(this,this):e,qt(n)?n.call(this,this):n)}:n:e}function oI(e,n){return ju(qm(e),qm(n))}function qm(e){if($t(e)){const n={};for(let s=0;s<e.length;s++)n[e[s]]=e[s];return n}return e}function yn(e,n){return e?[...new Set([].concat(e,n))]:n}function ju(e,n){return e?wr(Object.create(null),e,n):n}function P0(e,n){return e?$t(e)&&$t(n)?[...new Set([...e,...n])]:wr(Object.create(null),k0(e),k0(n??{})):n}function sI(e,n){if(!e)return n;if(!n)return e;const s=wr(Object.create(null),e);for(const u in n)s[u]=yn(e[u],n[u]);return s}function tb(){return{app:null,config:{isNativeTag:NE,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let aI=0;function lI(e,n){return function(u,h=null){qt(u)||(u=wr({},u)),h!=null&&!ji(h)&&(h=null);const g=tb(),m=new WeakSet;let c=!1;const I=g.app={_uid:aI++,_component:u,_props:h,_container:null,_context:g,_instance:null,version:kb,get config(){return g.config},set config(M){},use(M,...k){return m.has(M)||(M&&qt(M.install)?(m.add(M),M.install(I,...k)):qt(M)&&(m.add(M),M(I,...k))),I},mixin(M){return g.mixins.includes(M)||g.mixins.push(M),I},component(M,k){return k?(g.components[M]=k,I):g.components[M]},directive(M,k){return k?(g.directives[M]=k,I):g.directives[M]},mount(M,k,C){if(!c){const L=ei(u,h);return L.appContext=g,C===!0?C="svg":C===!1&&(C=void 0),k&&n?n(L,M):e(L,M,C),c=!0,I._container=M,M.__vue_app__=I,Vf(L.component)}},unmount(){c&&(e(null,I._container),delete I._container.__vue_app__)},provide(M,k){return g.provides[M]=k,I},runWithContext(M){const k=ac;ac=I;try{return M()}finally{ac=k}}};return I}}let ac=null;function aa(e,n){if(Ir){let s=Ir.provides;const u=Ir.parent&&Ir.parent.provides;u===s&&(s=Ir.provides=Object.create(u)),s[e]=n}}function Zr(e,n,s=!1){const u=Ir||Tr;if(u||ac){const h=u?u.parent==null?u.vnode.appContext&&u.vnode.appContext.provides:u.parent.provides:ac._context.provides;if(h&&e in h)return h[e];if(arguments.length>1)return s&&qt(n)?n.call(u&&u.proxy):n}}function ib(){return!!(Ir||Tr||ac)}const rb={},nb=()=>Object.create(rb),ob=e=>Object.getPrototypeOf(e)===rb;function cI(e,n,s,u=!1){const h={},g=nb();e.propsDefaults=Object.create(null),sb(e,n,h,g);for(const m in e.propsOptions[0])m in h||(h[m]=void 0);s?e.props=u?h:ec(h):e.type.props?e.props=h:e.props=g,e.attrs=g}function uI(e,n,s,u){const{props:h,attrs:g,vnode:{patchFlag:m}}=e,c=Vt(h),[I]=e.propsOptions;let M=!1;if((u||m>0)&&!(m&16)){if(m&8){const k=e.vnode.dynamicProps;for(let C=0;C<k.length;C++){let L=k[C];if(Df(e.emitsOptions,L))continue;const q=n[L];if(I)if(hi(g,L))q!==g[L]&&(g[L]=q,M=!0);else{const X=Oo(L);h[X]=Hm(I,c,X,q,e,!1)}else q!==g[L]&&(g[L]=q,M=!0)}}}else{sb(e,n,h,g)&&(M=!0);let k;for(const C in c)(!n||!hi(n,C)&&((k=_c(C))===C||!hi(n,k)))&&(I?s&&(s[C]!==void 0||s[k]!==void 0)&&(h[C]=Hm(I,c,C,void 0,e,!0)):delete h[C]);if(g!==c)for(const C in g)(!n||!hi(n,C))&&(delete g[C],M=!0)}M&&ds(e.attrs,"set","")}function sb(e,n,s,u){const[h,g]=e.propsOptions;let m=!1,c;if(n)for(let I in n){if(rc(I))continue;const M=n[I];let k;h&&hi(h,k=Oo(I))?!g||!g.includes(k)?s[k]=M:(c||(c={}))[k]=M:Df(e.emitsOptions,I)||(!(I in u)||M!==u[I])&&(u[I]=M,m=!0)}if(g){const I=Vt(s),M=c||Gi;for(let k=0;k<g.length;k++){const C=g[k];s[C]=Hm(h,I,C,M[C],e,!hi(M,C))}}return m}function Hm(e,n,s,u,h,g){const m=e[s];if(m!=null){const c=hi(m,"default");if(c&&u===void 0){const I=m.default;if(m.type!==Function&&!m.skipFactory&&qt(I)){const{propsDefaults:M}=h;if(s in M)u=M[s];else{const k=Xa(h);u=M[s]=I.call(null,n),k()}}else u=I}m[0]&&(g&&!c?u=!1:m[1]&&(u===""||u===_c(s))&&(u=!0))}return u}function ab(e,n,s=!1){const u=n.propsCache,h=u.get(e);if(h)return h;const g=e.props,m={},c=[];let I=!1;if(!qt(e)){const k=C=>{I=!0;const[L,q]=ab(C,n,!0);wr(m,L),q&&c.push(...q)};!s&&n.mixins.length&&n.mixins.forEach(k),e.extends&&k(e.extends),e.mixins&&e.mixins.forEach(k)}if(!g&&!I)return ji(e)&&u.set(e,tc),tc;if($t(g))for(let k=0;k<g.length;k++){const C=Oo(g[k]);z0(C)&&(m[C]=Gi)}else if(g)for(const k in g){const C=Oo(k);if(z0(C)){const L=g[k],q=m[C]=$t(L)||qt(L)?{type:L}:wr({},L);if(q){const X=O0(Boolean,q.type),W=O0(String,q.type);q[0]=X>-1,q[1]=W<0||X<W,(X>-1||hi(q,"default"))&&c.push(C)}}}const M=[m,c];return ji(e)&&u.set(e,M),M}function z0(e){return e[0]!=="$"&&!rc(e)}function D0(e){return e===null?"null":typeof e=="function"?e.name||"":typeof e=="object"&&e.constructor&&e.constructor.name||""}function R0(e,n){return D0(e)===D0(n)}function O0(e,n){return $t(n)?n.findIndex(s=>R0(s,e)):qt(n)&&R0(n,e)?0:-1}const lb=e=>e[0]==="_"||e==="$stable",Gg=e=>$t(e)?e.map(Xn):[Xn(e)],hI=(e,n,s)=>{if(n._n)return n;const u=xr((...h)=>Gg(n(...h)),s);return u._c=!1,u},cb=(e,n,s)=>{const u=e._ctx;for(const h in e){if(lb(h))continue;const g=e[h];if(qt(g))n[h]=hI(h,g,u);else if(g!=null){const m=Gg(g);n[h]=()=>m}}},ub=(e,n)=>{const s=Gg(n);e.slots.default=()=>s},dI=(e,n)=>{const s=e.slots=nb();if(e.vnode.shapeFlag&32){const u=n._;u?(wr(s,n),vx(s,"_",u,!0)):cb(n,s)}else n&&ub(e,n)},fI=(e,n,s)=>{const{vnode:u,slots:h}=e;let g=!0,m=Gi;if(u.shapeFlag&32){const c=n._;c?s&&c===1?g=!1:(wr(h,n),!s&&c===1&&delete h._):(g=!n.$stable,cb(n,h)),m=n}else n&&(ub(e,n),m={default:1});if(g)for(const c in h)!lb(c)&&m[c]==null&&delete h[c]};function hf(e,n,s,u,h=!1){if($t(e)){e.forEach((L,q)=>hf(L,n&&($t(n)?n[q]:n),s,u,h));return}if(sc(u)&&!h)return;const g=u.shapeFlag&4?Vf(u.component):u.el,m=h?null:g,{i:c,r:I}=e,M=n&&n.r,k=c.refs===Gi?c.refs={}:c.refs,C=c.setupState;if(M!=null&&M!==I&&(ir(M)?(k[M]=null,hi(C,M)&&(C[M]=null)):fr(M)&&(M.value=null)),qt(I))ea(I,c,12,[m,k]);else{const L=ir(I),q=fr(I);if(L||q){const X=()=>{if(e.f){const W=L?hi(C,I)?C[I]:k[I]:I.value;h?$t(W)&&Mg(W,g):$t(W)?W.includes(g)||W.push(g):L?(k[I]=[g],hi(C,I)&&(C[I]=k[I])):(I.value=[g],e.k&&(k[e.k]=I.value))}else L?(k[I]=m,hi(C,I)&&(C[I]=m)):q&&(I.value=m,e.k&&(k[e.k]=m))};m?(X.id=-1,wn(X,s)):X()}}}let B0=!1;const Jl=()=>{B0||(console.error("Hydration completed but contains mismatches."),B0=!0)},pI=e=>e.namespaceURI.includes("svg")&&e.tagName!=="foreignObject",mI=e=>e.namespaceURI.includes("MathML"),zd=e=>{if(pI(e))return"svg";if(mI(e))return"mathml"},Dd=e=>e.nodeType===8;function gI(e){const{mt:n,p:s,o:{patchProp:u,createText:h,nextSibling:g,parentNode:m,remove:c,insert:I,createComment:M}}=e,k=(H,ce)=>{if(!ce.hasChildNodes()){s(null,H,ce),af(),ce._vnode=H;return}C(ce.firstChild,H,null,null,null),af(),ce._vnode=H},C=(H,ce,ne,oe,Ae,be=!1)=>{be=be||!!ce.dynamicChildren;const Le=Dd(H)&&H.data==="[",me=()=>W(H,ce,ne,oe,Ae,Le),{type:ke,ref:Me,shapeFlag:Oe,patchFlag:Ge}=ce;let rt=H.nodeType;ce.el=H,Ge===-2&&(be=!1,ce.dynamicChildren=null);let Ke=null;switch(ke){case hc:rt!==3?ce.children===""?(I(ce.el=h(""),m(H),H),Ke=H):Ke=me():(H.data!==ce.children&&(Jl(),H.data=ce.children),Ke=g(H));break;case Hr:ee(H)?(Ke=g(H),Ie(ce.el=H.content.firstChild,H,ne)):rt!==8||Le?Ke=me():Ke=g(H);break;case Zu:if(Le&&(H=g(H),rt=H.nodeType),rt===1||rt===3){Ke=H;const dt=!ce.children.length;for(let nt=0;nt<ce.staticCount;nt++)dt&&(ce.children+=Ke.nodeType===1?Ke.outerHTML:Ke.data),nt===ce.staticCount-1&&(ce.anchor=Ke),Ke=g(Ke);return Le?g(Ke):Ke}else me();break;case ar:Le?Ke=X(H,ce,ne,oe,Ae,be):Ke=me();break;default:if(Oe&1)(rt!==1||ce.type.toLowerCase()!==H.tagName.toLowerCase())&&!ee(H)?Ke=me():Ke=L(H,ce,ne,oe,Ae,be);else if(Oe&6){ce.slotScopeIds=Ae;const dt=m(H);if(Le?Ke=ae(H):Dd(H)&&H.data==="teleport start"?Ke=ae(H,H.data,"teleport end"):Ke=g(H),n(ce,dt,null,ne,oe,zd(dt),be),sc(ce)){let nt;Le?(nt=ei(ar),nt.anchor=Ke?Ke.previousSibling:dt.lastChild):nt=H.nodeType===3?mo(""):ei("div"),nt.el=H,ce.component.subTree=nt}}else Oe&64?rt!==8?Ke=me():Ke=ce.type.hydrate(H,ce,ne,oe,Ae,be,e,q):Oe&128&&(Ke=ce.type.hydrate(H,ce,ne,oe,zd(m(H)),Ae,be,e,C))}return Me!=null&&hf(Me,null,oe,ce),Ke},L=(H,ce,ne,oe,Ae,be)=>{be=be||!!ce.dynamicChildren;const{type:Le,props:me,patchFlag:ke,shapeFlag:Me,dirs:Oe,transition:Ge}=ce,rt=Le==="input"||Le==="option";if(rt||ke!==-1){Oe&&Lo(ce,null,ne,"created");let Ke=!1;if(ee(H)){Ke=db(oe,Ge)&&ne&&ne.vnode.props&&ne.vnode.props.appear;const nt=H.content.firstChild;Ke&&Ge.beforeEnter(nt),Ie(nt,H,ne),ce.el=H=nt}if(Me&16&&!(me&&(me.innerHTML||me.textContent))){let nt=q(H.firstChild,ce,H,ne,oe,Ae,be);for(;nt;){Jl();const ti=nt;nt=nt.nextSibling,c(ti)}}else Me&8&&H.textContent!==ce.children&&(Jl(),H.textContent=ce.children);if(me)if(rt||!be||ke&48)for(const nt in me)(rt&&(nt.endsWith("value")||nt==="indeterminate")||hh(nt)&&!rc(nt)||nt[0]===".")&&u(H,nt,null,me[nt],void 0,void 0,ne);else me.onClick&&u(H,"onClick",null,me.onClick,void 0,void 0,ne);let dt;(dt=me&&me.onVnodeBeforeMount)&&Kn(dt,ne,ce),Oe&&Lo(ce,null,ne,"beforeMount"),((dt=me&&me.onVnodeMounted)||Oe||Ke)&&Jx(()=>{dt&&Kn(dt,ne,ce),Ke&&Ge.enter(H),Oe&&Lo(ce,null,ne,"mounted")},oe)}return H.nextSibling},q=(H,ce,ne,oe,Ae,be,Le)=>{Le=Le||!!ce.dynamicChildren;const me=ce.children,ke=me.length;for(let Me=0;Me<ke;Me++){const Oe=Le?me[Me]:me[Me]=Xn(me[Me]);H?H=C(H,Oe,oe,Ae,be,Le):Oe.type===hc&&!Oe.children?I(Oe.el=h(""),ne):(Jl(),s(null,Oe,ne,null,oe,Ae,zd(ne),be))}return H},X=(H,ce,ne,oe,Ae,be)=>{const{slotScopeIds:Le}=ce;Le&&(Ae=Ae?Ae.concat(Le):Le);const me=m(H),ke=q(g(H),ce,me,ne,oe,Ae,be);return ke&&Dd(ke)&&ke.data==="]"?g(ce.anchor=ke):(Jl(),I(ce.anchor=M("]"),me,ke),ke)},W=(H,ce,ne,oe,Ae,be)=>{if(Jl(),ce.el=null,be){const ke=ae(H);for(;;){const Me=g(H);if(Me&&Me!==ke)c(Me);else break}}const Le=g(H),me=m(H);return c(H),s(null,ce,me,Le,ne,oe,zd(me),Ae),Le},ae=(H,ce="[",ne="]")=>{let oe=0;for(;H;)if(H=g(H),H&&Dd(H)&&(H.data===ce&&oe++,H.data===ne)){if(oe===0)return g(H);oe--}return H},Ie=(H,ce,ne)=>{const oe=ce.parentNode;oe&&oe.replaceChild(H,ce);let Ae=ne;for(;Ae;)Ae.vnode.el===ce&&(Ae.vnode.el=Ae.subTree.el=H),Ae=Ae.parent},ee=H=>H.nodeType===1&&H.tagName.toLowerCase()==="template";return[k,C]}const wn=Jx;function yI(e){return hb(e)}function _I(e){return hb(e,gI)}function hb(e,n){const s=bx();s.__VUE__=!0;const{insert:u,remove:h,patchProp:g,createElement:m,createText:c,createComment:I,setText:M,setElementText:k,parentNode:C,nextSibling:L,setScopeId:q=Jn,insertStaticContent:X}=e,W=(he,ye,Be,le=null,He=null,tt=null,Ze=void 0,je=null,Qe=!!ye.dynamicChildren)=>{if(he===ye)return;he&&!Do(he,ye)&&(le=Pi(he),jt(he,He,tt,!0),he=null),ye.patchFlag===-2&&(Qe=!1,ye.dynamicChildren=null);const{type:We,ref:pt,shapeFlag:It}=ye;switch(We){case hc:ae(he,ye,Be,le);break;case Hr:Ie(he,ye,Be,le);break;case Zu:he==null&&ee(ye,Be,le,Ze);break;case ar:Me(he,ye,Be,le,He,tt,Ze,je,Qe);break;default:It&1?ne(he,ye,Be,le,He,tt,Ze,je,Qe):It&6?Oe(he,ye,Be,le,He,tt,Ze,je,Qe):(It&64||It&128)&&We.process(he,ye,Be,le,He,tt,Ze,je,Qe,pr)}pt!=null&&He&&hf(pt,he&&he.ref,tt,ye||he,!ye)},ae=(he,ye,Be,le)=>{if(he==null)u(ye.el=c(ye.children),Be,le);else{const He=ye.el=he.el;ye.children!==he.children&&M(He,ye.children)}},Ie=(he,ye,Be,le)=>{he==null?u(ye.el=I(ye.children||""),Be,le):ye.el=he.el},ee=(he,ye,Be,le)=>{[he.el,he.anchor]=X(he.children,ye,Be,le,he.el,he.anchor)},H=({el:he,anchor:ye},Be,le)=>{let He;for(;he&&he!==ye;)He=L(he),u(he,Be,le),he=He;u(ye,Be,le)},ce=({el:he,anchor:ye})=>{let Be;for(;he&&he!==ye;)Be=L(he),h(he),he=Be;h(ye)},ne=(he,ye,Be,le,He,tt,Ze,je,Qe)=>{ye.type==="svg"?Ze="svg":ye.type==="math"&&(Ze="mathml"),he==null?oe(ye,Be,le,He,tt,Ze,je,Qe):Le(he,ye,He,tt,Ze,je,Qe)},oe=(he,ye,Be,le,He,tt,Ze,je)=>{let Qe,We;const{props:pt,shapeFlag:It,transition:xt,dirs:Lt}=he;if(Qe=he.el=m(he.type,tt,pt&&pt.is,pt),It&8?k(Qe,he.children):It&16&&be(he.children,Qe,null,le,He,gm(he,tt),Ze,je),Lt&&Lo(he,null,le,"created"),Ae(Qe,he,he.scopeId,Ze,le),pt){for(const $e in pt)$e!=="value"&&!rc($e)&&g(Qe,$e,null,pt[$e],tt,he.children,le,He,fi);"value"in pt&&g(Qe,"value",null,pt.value,tt),(We=pt.onVnodeBeforeMount)&&Kn(We,le,he)}Lt&&Lo(he,null,le,"beforeMount");const Ht=db(He,xt);Ht&&xt.beforeEnter(Qe),u(Qe,ye,Be),((We=pt&&pt.onVnodeMounted)||Ht||Lt)&&wn(()=>{We&&Kn(We,le,he),Ht&&xt.enter(Qe),Lt&&Lo(he,null,le,"mounted")},He)},Ae=(he,ye,Be,le,He)=>{if(Be&&q(he,Be),le)for(let tt=0;tt<le.length;tt++)q(he,le[tt]);if(He){let tt=He.subTree;if(ye===tt){const Ze=He.vnode;Ae(he,Ze,Ze.scopeId,Ze.slotScopeIds,He.parent)}}},be=(he,ye,Be,le,He,tt,Ze,je,Qe=0)=>{for(let We=Qe;We<he.length;We++){const pt=he[We]=je?Js(he[We]):Xn(he[We]);W(null,pt,ye,Be,le,He,tt,Ze,je)}},Le=(he,ye,Be,le,He,tt,Ze)=>{const je=ye.el=he.el;let{patchFlag:Qe,dynamicChildren:We,dirs:pt}=ye;Qe|=he.patchFlag&16;const It=he.props||Gi,xt=ye.props||Gi;let Lt;if(Be&&Va(Be,!1),(Lt=xt.onVnodeBeforeUpdate)&&Kn(Lt,Be,ye,he),pt&&Lo(ye,he,Be,"beforeUpdate"),Be&&Va(Be,!0),We?me(he.dynamicChildren,We,je,Be,le,gm(ye,He),tt):Ze||nt(he,ye,je,null,Be,le,gm(ye,He),tt,!1),Qe>0){if(Qe&16)ke(je,ye,It,xt,Be,le,He);else if(Qe&2&&It.class!==xt.class&&g(je,"class",null,xt.class,He),Qe&4&&g(je,"style",It.style,xt.style,He),Qe&8){const Ht=ye.dynamicProps;for(let $e=0;$e<Ht.length;$e++){const Gt=Ht[$e],ai=It[Gt],mr=xt[Gt];(mr!==ai||Gt==="value")&&g(je,Gt,ai,mr,He,he.children,Be,le,fi)}}Qe&1&&he.children!==ye.children&&k(je,ye.children)}else!Ze&&We==null&&ke(je,ye,It,xt,Be,le,He);((Lt=xt.onVnodeUpdated)||pt)&&wn(()=>{Lt&&Kn(Lt,Be,ye,he),pt&&Lo(ye,he,Be,"updated")},le)},me=(he,ye,Be,le,He,tt,Ze)=>{for(let je=0;je<ye.length;je++){const Qe=he[je],We=ye[je],pt=Qe.el&&(Qe.type===ar||!Do(Qe,We)||Qe.shapeFlag&70)?C(Qe.el):Be;W(Qe,We,pt,null,le,He,tt,Ze,!0)}},ke=(he,ye,Be,le,He,tt,Ze)=>{if(Be!==le){if(Be!==Gi)for(const je in Be)!rc(je)&&!(je in le)&&g(he,je,Be[je],null,Ze,ye.children,He,tt,fi);for(const je in le){if(rc(je))continue;const Qe=le[je],We=Be[je];Qe!==We&&je!=="value"&&g(he,je,We,Qe,Ze,ye.children,He,tt,fi)}"value"in le&&g(he,"value",Be.value,le.value,Ze)}},Me=(he,ye,Be,le,He,tt,Ze,je,Qe)=>{const We=ye.el=he?he.el:c(""),pt=ye.anchor=he?he.anchor:c("");let{patchFlag:It,dynamicChildren:xt,slotScopeIds:Lt}=ye;Lt&&(je=je?je.concat(Lt):Lt),he==null?(u(We,Be,le),u(pt,Be,le),be(ye.children||[],Be,pt,He,tt,Ze,je,Qe)):It>0&&It&64&&xt&&he.dynamicChildren?(me(he.dynamicChildren,xt,Be,He,tt,Ze,je),(ye.key!=null||He&&ye===He.subTree)&&Zg(he,ye,!0)):nt(he,ye,Be,pt,He,tt,Ze,je,Qe)},Oe=(he,ye,Be,le,He,tt,Ze,je,Qe)=>{ye.slotScopeIds=je,he==null?ye.shapeFlag&512?He.ctx.activate(ye,Be,le,Ze,Qe):Ge(ye,Be,le,He,tt,Ze,Qe):rt(he,ye,Qe)},Ge=(he,ye,Be,le,He,tt,Ze)=>{const je=he.component=RI(he,le,He);if(dh(he)&&(je.ctx.renderer=pr),OI(je),je.asyncDep){if(He&&He.registerDep(je,Ke,Ze),!he.el){const Qe=je.subTree=ei(Hr);Ie(null,Qe,ye,Be)}}else Ke(je,he,ye,Be,He,tt,Ze)},rt=(he,ye,Be)=>{const le=ye.component=he.component;if(RS(he,ye,Be))if(le.asyncDep&&!le.asyncResolved){dt(le,ye,Be);return}else le.next=ye,kS(le.update),le.effect.dirty=!0,le.update();else ye.el=he.el,le.vnode=ye},Ke=(he,ye,Be,le,He,tt,Ze)=>{const je=()=>{if(he.isMounted){let{next:pt,bu:It,u:xt,parent:Lt,vnode:Ht}=he;{const Kr=fb(he);if(Kr){pt&&(pt.el=Ht.el,dt(he,pt,Ze)),Kr.asyncDep.then(()=>{he.isUnmounted||je()});return}}let $e=pt,Gt;Va(he,!1),pt?(pt.el=Ht.el,dt(he,pt,Ze)):pt=Ht,It&&um(It),(Gt=pt.props&&pt.props.onVnodeBeforeUpdate)&&Kn(Gt,Lt,pt,Ht),Va(he,!0);const ai=fm(he),mr=he.subTree;he.subTree=ai,W(mr,ai,C(mr.el),Pi(mr),he,He,tt),pt.el=ai.el,$e===null&&Ug(he,ai.el),xt&&wn(xt,He),(Gt=pt.props&&pt.props.onVnodeUpdated)&&wn(()=>Kn(Gt,Lt,pt,Ht),He)}else{let pt;const{el:It,props:xt}=ye,{bm:Lt,m:Ht,parent:$e}=he,Gt=sc(ye);if(Va(he,!1),Lt&&um(Lt),!Gt&&(pt=xt&&xt.onVnodeBeforeMount)&&Kn(pt,$e,ye),Va(he,!0),It&&lr){const ai=()=>{he.subTree=fm(he),lr(It,he.subTree,he,He,null)};Gt?ye.type.__asyncLoader().then(()=>!he.isUnmounted&&ai()):ai()}else{const ai=he.subTree=fm(he);W(null,ai,Be,le,he,He,tt),ye.el=ai.el}if(Ht&&wn(Ht,He),!Gt&&(pt=xt&&xt.onVnodeMounted)){const ai=ye;wn(()=>Kn(pt,$e,ai),He)}(ye.shapeFlag&256||$e&&sc($e.vnode)&&$e.vnode.shapeFlag&256)&&he.a&&wn(he.a,He),he.isMounted=!0,ye=Be=le=null}},Qe=he.effect=new Dg(je,Jn,()=>zf(We),he.scope),We=he.update=()=>{Qe.dirty&&Qe.run()};We.id=he.uid,Va(he,!0),We()},dt=(he,ye,Be)=>{ye.component=he;const le=he.vnode.props;he.vnode=ye,he.next=null,uI(he,ye.props,le,Be),fI(he,ye.children,Be),na(),I0(he),oa()},nt=(he,ye,Be,le,He,tt,Ze,je,Qe=!1)=>{const We=he&&he.children,pt=he?he.shapeFlag:0,It=ye.children,{patchFlag:xt,shapeFlag:Lt}=ye;if(xt>0){if(xt&128){Ut(We,It,Be,le,He,tt,Ze,je,Qe);return}else if(xt&256){ti(We,It,Be,le,He,tt,Ze,je,Qe);return}}Lt&8?(pt&16&&fi(We,He,tt),It!==We&&k(Be,It)):pt&16?Lt&16?Ut(We,It,Be,le,He,tt,Ze,je,Qe):fi(We,He,tt,!0):(pt&8&&k(Be,""),Lt&16&&be(It,Be,le,He,tt,Ze,je,Qe))},ti=(he,ye,Be,le,He,tt,Ze,je,Qe)=>{he=he||tc,ye=ye||tc;const We=he.length,pt=ye.length,It=Math.min(We,pt);let xt;for(xt=0;xt<It;xt++){const Lt=ye[xt]=Qe?Js(ye[xt]):Xn(ye[xt]);W(he[xt],Lt,Be,null,He,tt,Ze,je,Qe)}We>pt?fi(he,He,tt,!0,!1,It):be(ye,Be,le,He,tt,Ze,je,Qe,It)},Ut=(he,ye,Be,le,He,tt,Ze,je,Qe)=>{let We=0;const pt=ye.length;let It=he.length-1,xt=pt-1;for(;We<=It&&We<=xt;){const Lt=he[We],Ht=ye[We]=Qe?Js(ye[We]):Xn(ye[We]);if(Do(Lt,Ht))W(Lt,Ht,Be,null,He,tt,Ze,je,Qe);else break;We++}for(;We<=It&&We<=xt;){const Lt=he[It],Ht=ye[xt]=Qe?Js(ye[xt]):Xn(ye[xt]);if(Do(Lt,Ht))W(Lt,Ht,Be,null,He,tt,Ze,je,Qe);else break;It--,xt--}if(We>It){if(We<=xt){const Lt=xt+1,Ht=Lt<pt?ye[Lt].el:le;for(;We<=xt;)W(null,ye[We]=Qe?Js(ye[We]):Xn(ye[We]),Be,Ht,He,tt,Ze,je,Qe),We++}}else if(We>xt)for(;We<=It;)jt(he[We],He,tt,!0),We++;else{const Lt=We,Ht=We,$e=new Map;for(We=Ht;We<=xt;We++){const pi=ye[We]=Qe?Js(ye[We]):Xn(ye[We]);pi.key!=null&&$e.set(pi.key,We)}let Gt,ai=0;const mr=xt-Ht+1;let Kr=!1,Ye=0;const Bt=new Array(mr);for(We=0;We<mr;We++)Bt[We]=0;for(We=Lt;We<=It;We++){const pi=he[We];if(ai>=mr){jt(pi,He,tt,!0);continue}let Ii;if(pi.key!=null)Ii=$e.get(pi.key);else for(Gt=Ht;Gt<=xt;Gt++)if(Bt[Gt-Ht]===0&&Do(pi,ye[Gt])){Ii=Gt;break}Ii===void 0?jt(pi,He,tt,!0):(Bt[Ii-Ht]=We+1,Ii>=Ye?Ye=Ii:Kr=!0,W(pi,ye[Ii],Be,null,He,tt,Ze,je,Qe),ai++)}const Dt=Kr?vI(Bt):tc;for(Gt=Dt.length-1,We=mr-1;We>=0;We--){const pi=Ht+We,Ii=ye[pi],Ft=pi+1<pt?ye[pi+1].el:le;Bt[We]===0?W(null,Ii,Be,Ft,He,tt,Ze,je,Qe):Kr&&(Gt<0||We!==Dt[Gt]?Nt(Ii,Be,Ft,2):Gt--)}}},Nt=(he,ye,Be,le,He=null)=>{const{el:tt,type:Ze,transition:je,children:Qe,shapeFlag:We}=he;if(We&6){Nt(he.component.subTree,ye,Be,le);return}if(We&128){he.suspense.move(ye,Be,le);return}if(We&64){Ze.move(he,ye,Be,pr);return}if(Ze===ar){u(tt,ye,Be);for(let It=0;It<Qe.length;It++)Nt(Qe[It],ye,Be,le);u(he.anchor,ye,Be);return}if(Ze===Zu){H(he,ye,Be);return}if(le!==2&&We&1&&je)if(le===0)je.beforeEnter(tt),u(tt,ye,Be),wn(()=>je.enter(tt),He);else{const{leave:It,delayLeave:xt,afterLeave:Lt}=je,Ht=()=>u(tt,ye,Be),$e=()=>{It(tt,()=>{Ht(),Lt&&Lt()})};xt?xt(tt,Ht,$e):$e()}else u(tt,ye,Be)},jt=(he,ye,Be,le=!1,He=!1)=>{const{type:tt,props:Ze,ref:je,children:Qe,dynamicChildren:We,shapeFlag:pt,patchFlag:It,dirs:xt,memoIndex:Lt}=he;if(je!=null&&hf(je,null,Be,he,!0),Lt!=null&&(ye.renderCache[Lt]=void 0),pt&256){ye.ctx.deactivate(he);return}const Ht=pt&1&&xt,$e=!sc(he);let Gt;if($e&&(Gt=Ze&&Ze.onVnodeBeforeUnmount)&&Kn(Gt,ye,he),pt&6)Oi(he.component,Be,le);else{if(pt&128){he.suspense.unmount(Be,le);return}Ht&&Lo(he,null,ye,"beforeUnmount"),pt&64?he.type.remove(he,ye,Be,He,pr,le):We&&(tt!==ar||It>0&&It&64)?fi(We,ye,Be,!1,!0):(tt===ar&&It&384||!He&&pt&16)&&fi(Qe,ye,Be),le&&Si(he)}($e&&(Gt=Ze&&Ze.onVnodeUnmounted)||Ht)&&wn(()=>{Gt&&Kn(Gt,ye,he),Ht&&Lo(he,null,ye,"unmounted")},Be)},Si=he=>{const{type:ye,el:Be,anchor:le,transition:He}=he;if(ye===ar){Qi(Be,le);return}if(ye===Zu){ce(he);return}const tt=()=>{h(Be),He&&!He.persisted&&He.afterLeave&&He.afterLeave()};if(he.shapeFlag&1&&He&&!He.persisted){const{leave:Ze,delayLeave:je}=He,Qe=()=>Ze(Be,tt);je?je(he.el,tt,Qe):Qe()}else tt()},Qi=(he,ye)=>{let Be;for(;he!==ye;)Be=L(he),h(he),he=Be;h(ye)},Oi=(he,ye,Be)=>{const{bum:le,scope:He,update:tt,subTree:Ze,um:je,m:Qe,a:We}=he;F0(Qe),F0(We),le&&um(le),He.stop(),tt&&(tt.active=!1,jt(Ze,he,ye,Be)),je&&wn(je,ye),wn(()=>{he.isUnmounted=!0},ye),ye&&ye.pendingBranch&&!ye.isUnmounted&&he.asyncDep&&!he.asyncResolved&&he.suspenseId===ye.pendingId&&(ye.deps--,ye.deps===0&&ye.resolve())},fi=(he,ye,Be,le=!1,He=!1,tt=0)=>{for(let Ze=tt;Ze<he.length;Ze++)jt(he[Ze],ye,Be,le,He)},Pi=he=>he.shapeFlag&6?Pi(he.component.subTree):he.shapeFlag&128?he.suspense.next():L(he.anchor||he.el);let Bi=!1;const Br=(he,ye,Be)=>{he==null?ye._vnode&&jt(ye._vnode,null,null,!0):W(ye._vnode||null,he,ye,null,null,null,Be),Bi||(Bi=!0,I0(),af(),Bi=!1),ye._vnode=he},pr={p:W,um:jt,m:Nt,r:Si,mt:Ge,mc:be,pc:nt,pbc:me,n:Pi,o:e};let Fr,lr;return n&&([Fr,lr]=n(pr)),{render:Br,hydrate:Fr,createApp:lI(Br,Fr)}}function gm({type:e,props:n},s){return s==="svg"&&e==="foreignObject"||s==="mathml"&&e==="annotation-xml"&&n&&n.encoding&&n.encoding.includes("html")?void 0:s}function Va({effect:e,update:n},s){e.allowRecurse=n.allowRecurse=s}function db(e,n){return(!e||e&&!e.pendingBranch)&&n&&!n.persisted}function Zg(e,n,s=!1){const u=e.children,h=n.children;if($t(u)&&$t(h))for(let g=0;g<u.length;g++){const m=u[g];let c=h[g];c.shapeFlag&1&&!c.dynamicChildren&&((c.patchFlag<=0||c.patchFlag===32)&&(c=h[g]=Js(h[g]),c.el=m.el),!s&&c.patchFlag!==-2&&Zg(m,c)),c.type===hc&&(c.el=m.el)}}function vI(e){const n=e.slice(),s=[0];let u,h,g,m,c;const I=e.length;for(u=0;u<I;u++){const M=e[u];if(M!==0){if(h=s[s.length-1],e[h]<M){n[u]=h,s.push(u);continue}for(g=0,m=s.length-1;g<m;)c=g+m>>1,e[s[c]]<M?g=c+1:m=c;M<e[s[g]]&&(g>0&&(n[u]=s[g-1]),s[g]=u)}}for(g=s.length,m=s[g-1];g-- >0;)s[g]=m,m=n[m];return s}function fb(e){const n=e.subTree.component;if(n)return n.asyncDep&&!n.asyncResolved?n:fb(n)}function F0(e){if(e)for(let n=0;n<e.length;n++)e[n].active=!1}const xI=Symbol.for("v-scx"),bI=()=>Zr(xI);function Vn(e,n){return Ff(e,null,n)}function wI(e,n){return Ff(e,null,{flush:"post"})}const Rd={};function Zi(e,n,s){return Ff(e,n,s)}function Ff(e,n,{immediate:s,deep:u,flush:h,once:g,onTrack:m,onTrigger:c}=Gi){if(n&&g){const oe=n;n=(...Ae)=>{oe(...Ae),ne()}}const I=Ir,M=oe=>u===!0?oe:Ys(oe,u===!1?1:void 0);let k,C=!1,L=!1;if(fr(e)?(k=()=>e.value,C=sf(e)):Uu(e)?(k=()=>M(e),C=!0):$t(e)?(L=!0,C=e.some(oe=>Uu(oe)||sf(oe)),k=()=>e.map(oe=>{if(fr(oe))return oe.value;if(Uu(oe))return M(oe);if(qt(oe))return ea(oe,I,2)})):qt(e)?n?k=()=>ea(e,I,2):k=()=>(q&&q(),eo(e,I,3,[X])):k=Jn,n&&u){const oe=k;k=()=>Ys(oe())}let q,X=oe=>{q=H.onStop=()=>{ea(oe,I,4),q=H.onStop=void 0}},W;if(fh)if(X=Jn,n?s&&eo(n,I,3,[k(),L?[]:void 0,X]):k(),h==="sync"){const oe=bI();W=oe.__watcherHandles||(oe.__watcherHandles=[])}else return Jn;let ae=L?new Array(e.length).fill(Rd):Rd;const Ie=()=>{if(!(!H.active||!H.dirty))if(n){const oe=H.run();(u||C||(L?oe.some((Ae,be)=>ta(Ae,ae[be])):ta(oe,ae)))&&(q&&q(),eo(n,I,3,[oe,ae===Rd?void 0:L&&ae[0]===Rd?[]:ae,X]),ae=oe)}else H.run()};Ie.allowRecurse=!!n;let ee;h==="sync"?ee=Ie:h==="post"?ee=()=>wn(Ie,I&&I.suspense):(Ie.pre=!0,I&&(Ie.id=I.uid),ee=()=>zf(Ie));const H=new Dg(k,Jn,ee),ce=zg(),ne=()=>{H.stop(),ce&&Mg(ce.effects,H)};return n?s?Ie():ae=H.run():h==="post"?wn(H.run.bind(H),I&&I.suspense):H.run(),W&&W.push(ne),ne}function EI(e,n,s){const u=this.proxy,h=ir(e)?e.includes(".")?pb(u,e):()=>u[e]:e.bind(u,u);let g;qt(n)?g=n:(g=n.handler,s=n);const m=Xa(this),c=Ff(h,g.bind(u),s);return m(),c}function pb(e,n){const s=n.split(".");return()=>{let u=e;for(let h=0;h<s.length&&u;h++)u=u[s[h]];return u}}function Ys(e,n=1/0,s){if(n<=0||!ji(e)||e.__v_skip||(s=s||new Set,s.has(e)))return e;if(s.add(e),n--,fr(e))Ys(e.value,n,s);else if($t(e))for(let u=0;u<e.length;u++)Ys(e[u],n,s);else if(gx(e)||ic(e))e.forEach(u=>{Ys(u,n,s)});else if(_x(e)){for(const u in e)Ys(e[u],n,s);for(const u of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,u)&&Ys(e[u],n,s)}return e}const dh=e=>e.type.__isKeepAlive;function mb(e,n){yb(e,"a",n)}function gb(e,n){yb(e,"da",n)}function yb(e,n,s=Ir){const u=e.__wdc||(e.__wdc=()=>{let h=s;for(;h;){if(h.isDeactivated)return;h=h.parent}return e()});if(Of(n,u,s),s){let h=s.parent;for(;h&&h.parent;)dh(h.parent.vnode)&&SI(u,n,s,h),h=h.parent}}function SI(e,n,s,u){const h=Of(n,e,u,!0);sa(()=>{Mg(u[n],h)},s)}const Xs=Symbol("_leaveCb"),Od=Symbol("_enterCb");function II(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Wr(()=>{e.isMounted=!0}),Bf(()=>{e.isUnmounting=!0}),e}const Wn=[Function,Array],_b={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Wn,onEnter:Wn,onAfterEnter:Wn,onEnterCancelled:Wn,onBeforeLeave:Wn,onLeave:Wn,onAfterLeave:Wn,onLeaveCancelled:Wn,onBeforeAppear:Wn,onAppear:Wn,onAfterAppear:Wn,onAppearCancelled:Wn},vb=e=>{const n=e.subTree;return n.component?vb(n.component):n},TI={name:"BaseTransition",props:_b,setup(e,{slots:n}){const s=la(),u=II();return()=>{const h=n.default&&bb(n.default(),!0);if(!h||!h.length)return;let g=h[0];if(h.length>1){for(const L of h)if(L.type!==Hr){g=L;break}}const m=Vt(e),{mode:c}=m;if(u.isLeaving)return ym(g);const I=V0(g);if(!I)return ym(g);let M=Gm(I,m,u,s,L=>M=L);df(I,M);const k=s.subTree,C=k&&V0(k);if(C&&C.type!==Hr&&!Do(I,C)&&vb(s).type!==Hr){const L=Gm(C,m,u,s);if(df(C,L),c==="out-in"&&I.type!==Hr)return u.isLeaving=!0,L.afterLeave=()=>{u.isLeaving=!1,s.update.active!==!1&&(s.effect.dirty=!0,s.update())},ym(g);c==="in-out"&&I.type!==Hr&&(L.delayLeave=(q,X,W)=>{const ae=xb(u,C);ae[String(C.key)]=C,q[Xs]=()=>{X(),q[Xs]=void 0,delete M.delayedLeave},M.delayedLeave=W})}return g}}},CI=TI;function xb(e,n){const{leavingVNodes:s}=e;let u=s.get(n.type);return u||(u=Object.create(null),s.set(n.type,u)),u}function Gm(e,n,s,u,h){const{appear:g,mode:m,persisted:c=!1,onBeforeEnter:I,onEnter:M,onAfterEnter:k,onEnterCancelled:C,onBeforeLeave:L,onLeave:q,onAfterLeave:X,onLeaveCancelled:W,onBeforeAppear:ae,onAppear:Ie,onAfterAppear:ee,onAppearCancelled:H}=n,ce=String(e.key),ne=xb(s,e),oe=(Le,me)=>{Le&&eo(Le,u,9,me)},Ae=(Le,me)=>{const ke=me[1];oe(Le,me),$t(Le)?Le.every(Me=>Me.length<=1)&&ke():Le.length<=1&&ke()},be={mode:m,persisted:c,beforeEnter(Le){let me=I;if(!s.isMounted)if(g)me=ae||I;else return;Le[Xs]&&Le[Xs](!0);const ke=ne[ce];ke&&Do(e,ke)&&ke.el[Xs]&&ke.el[Xs](),oe(me,[Le])},enter(Le){let me=M,ke=k,Me=C;if(!s.isMounted)if(g)me=Ie||M,ke=ee||k,Me=H||C;else return;let Oe=!1;const Ge=Le[Od]=rt=>{Oe||(Oe=!0,rt?oe(Me,[Le]):oe(ke,[Le]),be.delayedLeave&&be.delayedLeave(),Le[Od]=void 0)};me?Ae(me,[Le,Ge]):Ge()},leave(Le,me){const ke=String(e.key);if(Le[Od]&&Le[Od](!0),s.isUnmounting)return me();oe(L,[Le]);let Me=!1;const Oe=Le[Xs]=Ge=>{Me||(Me=!0,me(),Ge?oe(W,[Le]):oe(X,[Le]),Le[Xs]=void 0,ne[ke]===e&&delete ne[ke])};ne[ke]=e,q?Ae(q,[Le,Oe]):Oe()},clone(Le){const me=Gm(Le,n,s,u,h);return h&&h(me),me}};return be}function ym(e){if(dh(e))return e=Fo(e),e.children=null,e}function V0(e){if(!dh(e))return e;const{shapeFlag:n,children:s}=e;if(s){if(n&16)return s[0];if(n&32&&qt(s.default))return s.default()}}function df(e,n){e.shapeFlag&6&&e.component?df(e.component.subTree,n):e.shapeFlag&128?(e.ssContent.transition=n.clone(e.ssContent),e.ssFallback.transition=n.clone(e.ssFallback)):e.transition=n}function bb(e,n=!1,s){let u=[],h=0;for(let g=0;g<e.length;g++){let m=e[g];const c=s==null?m.key:String(s)+String(m.key!=null?m.key:g);m.type===ar?(m.patchFlag&128&&h++,u=u.concat(bb(m.children,n,c))):(n||m.type!==Hr)&&u.push(c!=null?Fo(m,{key:c}):m)}if(h>1)for(let g=0;g<u.length;g++)u[g].patchFlag=-2;return u}const AI=e=>e.__isTeleport,Gu=e=>e&&(e.disabled||e.disabled===""),N0=e=>typeof SVGElement<"u"&&e instanceof SVGElement,$0=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,Zm=(e,n)=>{const s=e&&e.to;return ir(s)?n?n(s):null:s},kI={name:"Teleport",__isTeleport:!0,process(e,n,s,u,h,g,m,c,I,M){const{mc:k,pc:C,pbc:L,o:{insert:q,querySelector:X,createText:W,createComment:ae}}=M,Ie=Gu(n.props);let{shapeFlag:ee,children:H,dynamicChildren:ce}=n;if(e==null){const ne=n.el=W(""),oe=n.anchor=W("");q(ne,s,u),q(oe,s,u);const Ae=n.target=Zm(n.props,X),be=n.targetAnchor=W("");Ae&&(q(be,Ae),m==="svg"||N0(Ae)?m="svg":(m==="mathml"||$0(Ae))&&(m="mathml"));const Le=(me,ke)=>{ee&16&&k(H,me,ke,h,g,m,c,I)};Ie?Le(s,oe):Ae&&Le(Ae,be)}else{n.el=e.el;const ne=n.anchor=e.anchor,oe=n.target=e.target,Ae=n.targetAnchor=e.targetAnchor,be=Gu(e.props),Le=be?s:oe,me=be?ne:Ae;if(m==="svg"||N0(oe)?m="svg":(m==="mathml"||$0(oe))&&(m="mathml"),ce?(L(e.dynamicChildren,ce,Le,h,g,m,c),Zg(e,n,!0)):I||C(e,n,Le,me,h,g,m,c,!1),Ie)be?n.props&&e.props&&n.props.to!==e.props.to&&(n.props.to=e.props.to):Bd(n,s,ne,M,1);else if((n.props&&n.props.to)!==(e.props&&e.props.to)){const ke=n.target=Zm(n.props,X);ke&&Bd(n,ke,null,M,0)}else be&&Bd(n,oe,Ae,M,1)}wb(n)},remove(e,n,s,u,{um:h,o:{remove:g}},m){const{shapeFlag:c,children:I,anchor:M,targetAnchor:k,target:C,props:L}=e;if(C&&g(k),m&&g(M),c&16){const q=m||!Gu(L);for(let X=0;X<I.length;X++){const W=I[X];h(W,n,s,q,!!W.dynamicChildren)}}},move:Bd,hydrate:MI};function Bd(e,n,s,{o:{insert:u},m:h},g=2){g===0&&u(e.targetAnchor,n,s);const{el:m,anchor:c,shapeFlag:I,children:M,props:k}=e,C=g===2;if(C&&u(m,n,s),(!C||Gu(k))&&I&16)for(let L=0;L<M.length;L++)h(M[L],n,s,2);C&&u(c,n,s)}function MI(e,n,s,u,h,g,{o:{nextSibling:m,parentNode:c,querySelector:I}},M){const k=n.target=Zm(n.props,I);if(k){const C=k._lpa||k.firstChild;if(n.shapeFlag&16)if(Gu(n.props))n.anchor=M(m(e),n,c(e),s,u,h,g),n.targetAnchor=C;else{n.anchor=m(e);let L=C;for(;L;)if(L=m(L),L&&L.nodeType===8&&L.data==="teleport anchor"){n.targetAnchor=L,k._lpa=n.targetAnchor&&m(n.targetAnchor);break}M(C,n,k,s,u,h,g)}wb(n)}return n.anchor&&m(n.anchor)}const LI=kI;function wb(e){const n=e.ctx;if(n&&n.ut){let s=e.children[0].el;for(;s&&s!==e.targetAnchor;)s.nodeType===1&&s.setAttribute("data-v-owner",n.uid),s=s.nextSibling;n.ut()}}const ar=Symbol.for("v-fgt"),hc=Symbol.for("v-txt"),Hr=Symbol.for("v-cmt"),Zu=Symbol.for("v-stc"),Wu=[];let Yn=null;function _t(e=!1){Wu.push(Yn=e?null:[])}function Eb(){Wu.pop(),Yn=Wu[Wu.length-1]||null}let dc=1;function j0(e){dc+=e}function Sb(e){return e.dynamicChildren=dc>0?Yn||tc:null,Eb(),dc>0&&Yn&&Yn.push(e),e}function ri(e,n,s,u,h,g){return Sb($i(e,n,s,u,h,g,!0))}function li(e,n,s,u,h){return Sb(ei(e,n,s,u,h,!0))}function sh(e){return e?e.__v_isVNode===!0:!1}function Do(e,n){return e.type===n.type&&e.key===n.key}const Ib=({key:e})=>e??null,Gd=({ref:e,ref_key:n,ref_for:s})=>(typeof e=="number"&&(e=""+e),e!=null?ir(e)||fr(e)||qt(e)?{i:Tr,r:e,k:n,f:!!s}:e:null);function $i(e,n=null,s=null,u=0,h=null,g=e===ar?0:1,m=!1,c=!1){const I={__v_isVNode:!0,__v_skip:!0,type:e,props:n,key:n&&Ib(n),ref:n&&Gd(n),scopeId:Rf,slotScopeIds:null,children:s,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:g,patchFlag:u,dynamicProps:h,dynamicChildren:null,appContext:null,ctx:Tr};return c?(Wg(I,s),g&128&&e.normalize(I)):s&&(I.shapeFlag|=ir(s)?8:16),dc>0&&!m&&Yn&&(I.patchFlag>0||g&6)&&I.patchFlag!==32&&Yn.push(I),I}const ei=PI;function PI(e,n=null,s=null,u=0,h=null,g=!1){if((!e||e===Kx)&&(e=Hr),sh(e)){const c=Fo(e,n,!0);return s&&Wg(c,s),dc>0&&!g&&Yn&&(c.shapeFlag&6?Yn[Yn.indexOf(e)]=c:Yn.push(c)),c.patchFlag=-2,c}if(NI(e)&&(e=e.__vccOpts),n){n=ff(n);let{class:c,style:I}=n;c&&!ir(c)&&(n.class=Mt(c)),ji(I)&&(Bx(I)&&!$t(I)&&(I=wr({},I)),n.style=ia(I))}const m=ir(e)?1:OS(e)?128:AI(e)?64:ji(e)?4:qt(e)?2:0;return $i(e,n,s,u,h,m,g,!0)}function ff(e){return e?Bx(e)||ob(e)?wr({},e):e:null}function Fo(e,n,s=!1,u=!1){const{props:h,ref:g,patchFlag:m,children:c,transition:I}=e,M=n?br(h||{},n):h,k={__v_isVNode:!0,__v_skip:!0,type:e.type,props:M,key:M&&Ib(M),ref:n&&n.ref?s&&g?$t(g)?g.concat(Gd(n)):[g,Gd(n)]:Gd(n):g,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:c,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:n&&e.type!==ar?m===-1?16:m|16:m,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:I,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Fo(e.ssContent),ssFallback:e.ssFallback&&Fo(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return I&&u&&df(k,I.clone(k)),k}function mo(e=" ",n=0){return ei(hc,null,e,n)}function Li(e="",n=!1){return n?(_t(),li(Hr,null,e)):ei(Hr,null,e)}function Xn(e){return e==null||typeof e=="boolean"?ei(Hr):$t(e)?ei(ar,null,e.slice()):typeof e=="object"?Js(e):ei(hc,null,String(e))}function Js(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Fo(e)}function Wg(e,n){let s=0;const{shapeFlag:u}=e;if(n==null)n=null;else if($t(n))s=16;else if(typeof n=="object")if(u&65){const h=n.default;h&&(h._c&&(h._d=!1),Wg(e,h()),h._c&&(h._d=!0));return}else{s=32;const h=n._;!h&&!ob(n)?n._ctx=Tr:h===3&&Tr&&(Tr.slots._===1?n._=1:(n._=2,e.patchFlag|=1024))}else qt(n)?(n={default:n,_ctx:Tr},s=32):(n=String(n),u&64?(s=16,n=[mo(n)]):s=8);e.children=n,e.shapeFlag|=s}function br(...e){const n={};for(let s=0;s<e.length;s++){const u=e[s];for(const h in u)if(h==="class")n.class!==u.class&&(n.class=Mt([n.class,u.class]));else if(h==="style")n.style=ia([n.style,u.style]);else if(hh(h)){const g=n[h],m=u[h];m&&g!==m&&!($t(g)&&g.includes(m))&&(n[h]=g?[].concat(g,m):m)}else h!==""&&(n[h]=u[h])}return n}function Kn(e,n,s,u=null){eo(e,n,7,[s,u])}const zI=tb();let DI=0;function RI(e,n,s){const u=e.type,h=(n?n.appContext:e.appContext)||zI,g={uid:DI++,vnode:e,type:u,parent:n,appContext:h,root:null,next:null,subTree:null,effect:null,update:null,scope:new Sx(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:n?n.provides:Object.create(h.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:ab(u,h),emitsOptions:Hx(u,h),emit:null,emitted:null,propsDefaults:Gi,inheritAttrs:u.inheritAttrs,ctx:Gi,data:Gi,props:Gi,attrs:Gi,slots:Gi,refs:Gi,setupState:Gi,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:s,suspenseId:s?s.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return g.ctx={_:g},g.root=n?n.root:g,g.emit=LS.bind(null,g),e.ce&&e.ce(g),g}let Ir=null;const la=()=>Ir||Tr;let pf,Wm;{const e=bx(),n=(s,u)=>{let h;return(h=e[s])||(h=e[s]=[]),h.push(u),g=>{h.length>1?h.forEach(m=>m(g)):h[0](g)}};pf=n("__VUE_INSTANCE_SETTERS__",s=>Ir=s),Wm=n("__VUE_SSR_SETTERS__",s=>fh=s)}const Xa=e=>{const n=Ir;return pf(e),e.scope.on(),()=>{e.scope.off(),pf(n)}},Km=()=>{Ir&&Ir.scope.off(),pf(null)};function Tb(e){return e.vnode.shapeFlag&4}let fh=!1;function OI(e,n=!1){n&&Wm(n);const{props:s,children:u}=e.vnode,h=Tb(e);cI(e,s,h,n),dI(e,u);const g=h?BI(e,n):void 0;return n&&Wm(!1),g}function BI(e,n){const s=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,YS);const{setup:u}=s;if(u){const h=e.setupContext=u.length>1?Ab(e):null,g=Xa(e);na();const m=ea(u,e,0,[e.props,h]);if(oa(),g(),Lg(m)){if(m.then(Km,Km),n)return m.then(c=>{Xm(e,c,n)}).catch(c=>{vc(c,e,0)});e.asyncDep=m}else Xm(e,m,n)}else Cb(e,n)}function Xm(e,n,s){qt(n)?e.type.__ssrInlineRender?e.ssrRender=n:e.render=n:ji(n)&&(e.setupState=$x(n)),Cb(e,s)}let U0;function Cb(e,n,s){const u=e.type;if(!e.render){if(!n&&U0&&!u.render){const h=u.template||Hg(e).template;if(h){const{isCustomElement:g,compilerOptions:m}=e.appContext.config,{delimiters:c,compilerOptions:I}=u,M=wr(wr({isCustomElement:g,delimiters:c},m),I);u.render=U0(h,M)}}e.render=u.render||Jn}{const h=Xa(e);na();try{iI(e)}finally{oa(),h()}}}const FI={get(e,n){return En(e,"get",""),e[n]}};function Ab(e){const n=s=>{e.exposed=s||{}};return{attrs:new Proxy(e.attrs,FI),slots:e.slots,emit:e.emit,expose:n}}function Vf(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy($x(xS(e.exposed)),{get(n,s){if(s in n)return n[s];if(s in Hu)return Hu[s](e)},has(n,s){return s in n||s in Hu}})):e.proxy}function VI(e,n=!0){return qt(e)?e.displayName||e.name:e.name||n&&e.__name}function NI(e){return qt(e)&&"__vccOpts"in e}const Ve=(e,n)=>bS(e,n,fh);function Nn(e,n,s){const u=arguments.length;return u===2?ji(n)&&!$t(n)?sh(n)?ei(e,null,[n]):ei(e,n):ei(e,null,n):(u>3?s=Array.prototype.slice.call(arguments,2):u===3&&sh(s)&&(s=[s]),ei(e,n,s))}const kb="3.4.29";/**
* @vue/runtime-dom v3.4.29
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const $I="http://www.w3.org/2000/svg",jI="http://www.w3.org/1998/Math/MathML",us=typeof document<"u"?document:null,q0=us&&us.createElement("template"),UI={insert:(e,n,s)=>{n.insertBefore(e,s||null)},remove:e=>{const n=e.parentNode;n&&n.removeChild(e)},createElement:(e,n,s,u)=>{const h=n==="svg"?us.createElementNS($I,e):n==="mathml"?us.createElementNS(jI,e):s?us.createElement(e,{is:s}):us.createElement(e);return e==="select"&&u&&u.multiple!=null&&h.setAttribute("multiple",u.multiple),h},createText:e=>us.createTextNode(e),createComment:e=>us.createComment(e),setText:(e,n)=>{e.nodeValue=n},setElementText:(e,n)=>{e.textContent=n},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>us.querySelector(e),setScopeId(e,n){e.setAttribute(n,"")},insertStaticContent(e,n,s,u,h,g){const m=s?s.previousSibling:n.lastChild;if(h&&(h===g||h.nextSibling))for(;n.insertBefore(h.cloneNode(!0),s),!(h===g||!(h=h.nextSibling)););else{q0.innerHTML=u==="svg"?`<svg>${e}</svg>`:u==="mathml"?`<math>${e}</math>`:e;const c=q0.content;if(u==="svg"||u==="mathml"){const I=c.firstChild;for(;I.firstChild;)c.appendChild(I.firstChild);c.removeChild(I)}n.insertBefore(c,s)}return[m?m.nextSibling:n.firstChild,s?s.previousSibling:n.lastChild]}},Us="transition",Lu="animation",ah=Symbol("_vtc"),Nf=(e,{slots:n})=>Nn(CI,qI(e),n);Nf.displayName="Transition";const Mb={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};Nf.props=wr({},_b,Mb);const Na=(e,n=[])=>{$t(e)?e.forEach(s=>s(...n)):e&&e(...n)},H0=e=>e?$t(e)?e.some(n=>n.length>1):e.length>1:!1;function qI(e){const n={};for(const Me in e)Me in Mb||(n[Me]=e[Me]);if(e.css===!1)return n;const{name:s="v",type:u,duration:h,enterFromClass:g=`${s}-enter-from`,enterActiveClass:m=`${s}-enter-active`,enterToClass:c=`${s}-enter-to`,appearFromClass:I=g,appearActiveClass:M=m,appearToClass:k=c,leaveFromClass:C=`${s}-leave-from`,leaveActiveClass:L=`${s}-leave-active`,leaveToClass:q=`${s}-leave-to`}=e,X=HI(h),W=X&&X[0],ae=X&&X[1],{onBeforeEnter:Ie,onEnter:ee,onEnterCancelled:H,onLeave:ce,onLeaveCancelled:ne,onBeforeAppear:oe=Ie,onAppear:Ae=ee,onAppearCancelled:be=H}=n,Le=(Me,Oe,Ge)=>{$a(Me,Oe?k:c),$a(Me,Oe?M:m),Ge&&Ge()},me=(Me,Oe)=>{Me._isLeaving=!1,$a(Me,C),$a(Me,q),$a(Me,L),Oe&&Oe()},ke=Me=>(Oe,Ge)=>{const rt=Me?Ae:ee,Ke=()=>Le(Oe,Me,Ge);Na(rt,[Oe,Ke]),G0(()=>{$a(Oe,Me?I:g),qs(Oe,Me?k:c),H0(rt)||Z0(Oe,u,W,Ke)})};return wr(n,{onBeforeEnter(Me){Na(Ie,[Me]),qs(Me,g),qs(Me,m)},onBeforeAppear(Me){Na(oe,[Me]),qs(Me,I),qs(Me,M)},onEnter:ke(!1),onAppear:ke(!0),onLeave(Me,Oe){Me._isLeaving=!0;const Ge=()=>me(Me,Oe);qs(Me,C),qs(Me,L),WI(),G0(()=>{Me._isLeaving&&($a(Me,C),qs(Me,q),H0(ce)||Z0(Me,u,ae,Ge))}),Na(ce,[Me,Ge])},onEnterCancelled(Me){Le(Me,!1),Na(H,[Me])},onAppearCancelled(Me){Le(Me,!0),Na(be,[Me])},onLeaveCancelled(Me){me(Me),Na(ne,[Me])}})}function HI(e){if(e==null)return null;if(ji(e))return[_m(e.enter),_m(e.leave)];{const n=_m(e);return[n,n]}}function _m(e){return xx(e)}function qs(e,n){n.split(/\s+/).forEach(s=>s&&e.classList.add(s)),(e[ah]||(e[ah]=new Set)).add(n)}function $a(e,n){n.split(/\s+/).forEach(u=>u&&e.classList.remove(u));const s=e[ah];s&&(s.delete(n),s.size||(e[ah]=void 0))}function G0(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let GI=0;function Z0(e,n,s,u){const h=e._endId=++GI,g=()=>{h===e._endId&&u()};if(s)return setTimeout(g,s);const{type:m,timeout:c,propCount:I}=ZI(e,n);if(!m)return u();const M=m+"end";let k=0;const C=()=>{e.removeEventListener(M,L),g()},L=q=>{q.target===e&&++k>=I&&C()};setTimeout(()=>{k<I&&C()},c+1),e.addEventListener(M,L)}function ZI(e,n){const s=window.getComputedStyle(e),u=X=>(s[X]||"").split(", "),h=u(`${Us}Delay`),g=u(`${Us}Duration`),m=W0(h,g),c=u(`${Lu}Delay`),I=u(`${Lu}Duration`),M=W0(c,I);let k=null,C=0,L=0;n===Us?m>0&&(k=Us,C=m,L=g.length):n===Lu?M>0&&(k=Lu,C=M,L=I.length):(C=Math.max(m,M),k=C>0?m>M?Us:Lu:null,L=k?k===Us?g.length:I.length:0);const q=k===Us&&/\b(transform|all)(,|$)/.test(u(`${Us}Property`).toString());return{type:k,timeout:C,propCount:L,hasTransform:q}}function W0(e,n){for(;e.length<n.length;)e=e.concat(e);return Math.max(...n.map((s,u)=>K0(s)+K0(e[u])))}function K0(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function WI(){return document.body.offsetHeight}function KI(e,n,s){const u=e[ah];u&&(n=(n?[n,...u]:[...u]).join(" ")),n==null?e.removeAttribute("class"):s?e.setAttribute("class",n):e.className=n}const mf=Symbol("_vod"),Lb=Symbol("_vsh"),XI={beforeMount(e,{value:n},{transition:s}){e[mf]=e.style.display==="none"?"":e.style.display,s&&n?s.beforeEnter(e):Pu(e,n)},mounted(e,{value:n},{transition:s}){s&&n&&s.enter(e)},updated(e,{value:n,oldValue:s},{transition:u}){!n!=!s&&(u?n?(u.beforeEnter(e),Pu(e,!0),u.enter(e)):u.leave(e,()=>{Pu(e,!1)}):Pu(e,n))},beforeUnmount(e,{value:n}){Pu(e,n)}};function Pu(e,n){e.style.display=n?e[mf]:"none",e[Lb]=!n}const Pb=Symbol("");function QD(e){const n=la();if(!n)return;const s=n.ut=(h=e(n.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${n.uid}"]`)).forEach(g=>Ym(g,h))},u=()=>{const h=e(n.proxy);Jm(n.subTree,h),s(h)};Wr(()=>{wI(u);const h=new MutationObserver(u);h.observe(n.subTree.el.parentNode,{childList:!0}),sa(()=>h.disconnect())})}function Jm(e,n){if(e.shapeFlag&128){const s=e.suspense;e=s.activeBranch,s.pendingBranch&&!s.isHydrating&&s.effects.push(()=>{Jm(s.activeBranch,n)})}for(;e.component;)e=e.component.subTree;if(e.shapeFlag&1&&e.el)Ym(e.el,n);else if(e.type===ar)e.children.forEach(s=>Jm(s,n));else if(e.type===Zu){let{el:s,anchor:u}=e;for(;s&&(Ym(s,n),s!==u);)s=s.nextSibling}}function Ym(e,n){if(e.nodeType===1){const s=e.style;let u="";for(const h in n)s.setProperty(`--${h}`,n[h]),u+=`--${h}: ${n[h]};`;s[Pb]=u}}const JI=/(^|;)\s*display\s*:/;function YI(e,n,s){const u=e.style,h=ir(s);let g=!1;if(s&&!h){if(n)if(ir(n))for(const m of n.split(";")){const c=m.slice(0,m.indexOf(":")).trim();s[c]==null&&Zd(u,c,"")}else for(const m in n)s[m]==null&&Zd(u,m,"");for(const m in s)m==="display"&&(g=!0),Zd(u,m,s[m])}else if(h){if(n!==s){const m=u[Pb];m&&(s+=";"+m),u.cssText=s,g=JI.test(s)}}else n&&e.removeAttribute("style");mf in e&&(e[mf]=g?u.display:"",e[Lb]&&(u.display="none"))}const X0=/\s*!important$/;function Zd(e,n,s){if($t(s))s.forEach(u=>Zd(e,n,u));else if(s==null&&(s=""),n.startsWith("--"))e.setProperty(n,s);else{const u=QI(e,n);X0.test(s)?e.setProperty(_c(u),s.replace(X0,""),"important"):e[u]=s}}const J0=["Webkit","Moz","ms"],vm={};function QI(e,n){const s=vm[n];if(s)return s;let u=Oo(n);if(u!=="filter"&&u in e)return vm[n]=u;u=Lf(u);for(let h=0;h<J0.length;h++){const g=J0[h]+u;if(g in e)return vm[n]=g}return n}const Y0="http://www.w3.org/1999/xlink";function Q0(e,n,s,u,h,g=JE(n)){u&&n.startsWith("xlink:")?s==null?e.removeAttributeNS(Y0,n.slice(6,n.length)):e.setAttributeNS(Y0,n,s):s==null||g&&!wx(s)?e.removeAttribute(n):e.setAttribute(n,g?"":String(s))}function eT(e,n,s,u,h,g,m){if(n==="innerHTML"||n==="textContent"){u&&m(u,h,g),e[n]=s??"";return}const c=e.tagName;if(n==="value"&&c!=="PROGRESS"&&!c.includes("-")){const M=c==="OPTION"?e.getAttribute("value")||"":e.value,k=s==null?"":String(s);(M!==k||!("_value"in e))&&(e.value=k),s==null&&e.removeAttribute(n),e._value=s;return}let I=!1;if(s===""||s==null){const M=typeof e[n];M==="boolean"?s=wx(s):s==null&&M==="string"?(s="",I=!0):M==="number"&&(s=0,I=!0)}try{e[n]=s}catch{}I&&e.removeAttribute(n)}function tT(e,n,s,u){e.addEventListener(n,s,u)}function iT(e,n,s,u){e.removeEventListener(n,s,u)}const ev=Symbol("_vei");function rT(e,n,s,u,h=null){const g=e[ev]||(e[ev]={}),m=g[n];if(u&&m)m.value=u;else{const[c,I]=nT(n);if(u){const M=g[n]=aT(u,h);tT(e,c,M,I)}else m&&(iT(e,c,m,I),g[n]=void 0)}}const tv=/(?:Once|Passive|Capture)$/;function nT(e){let n;if(tv.test(e)){n={};let u;for(;u=e.match(tv);)e=e.slice(0,e.length-u[0].length),n[u[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):_c(e.slice(2)),n]}let xm=0;const oT=Promise.resolve(),sT=()=>xm||(oT.then(()=>xm=0),xm=Date.now());function aT(e,n){const s=u=>{if(!u._vts)u._vts=Date.now();else if(u._vts<=s.attached)return;eo(lT(u,s.value),n,5,[u])};return s.value=e,s.attached=sT(),s}function lT(e,n){if($t(n)){const s=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{s.call(e),e._stopped=!0},n.map(u=>h=>!h._stopped&&u&&u(h))}else return n}const iv=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,cT=(e,n,s,u,h,g,m,c,I)=>{const M=h==="svg";n==="class"?KI(e,u,M):n==="style"?YI(e,s,u):hh(n)?kg(n)||rT(e,n,s,u,m):(n[0]==="."?(n=n.slice(1),!0):n[0]==="^"?(n=n.slice(1),!1):uT(e,n,u,M))?(eT(e,n,u,g,m,c,I),(n==="value"||n==="checked"||n==="selected")&&Q0(e,n,u,M,m,n!=="value")):(n==="true-value"?e._trueValue=u:n==="false-value"&&(e._falseValue=u),Q0(e,n,u,M))};function uT(e,n,s,u){if(u)return!!(n==="innerHTML"||n==="textContent"||n in e&&iv(n)&&qt(s));if(n==="spellcheck"||n==="draggable"||n==="translate"||n==="form"||n==="list"&&e.tagName==="INPUT"||n==="type"&&e.tagName==="TEXTAREA")return!1;if(n==="width"||n==="height"){const h=e.tagName;if(h==="IMG"||h==="VIDEO"||h==="CANVAS"||h==="SOURCE")return!1}return iv(n)&&ir(s)?!1:n in e}const hT=["ctrl","shift","alt","meta"],dT={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,n)=>hT.some(s=>e[`${s}Key`]&&!n.includes(s))},bm=(e,n)=>{const s=e._withMods||(e._withMods={}),u=n.join(".");return s[u]||(s[u]=(h,...g)=>{for(let m=0;m<n.length;m++){const c=dT[n[m]];if(c&&c(h,n))return}return e(h,...g)})},zb=wr({patchProp:cT},UI);let Ku,rv=!1;function fT(){return Ku||(Ku=yI(zb))}function pT(){return Ku=rv?Ku:_I(zb),rv=!0,Ku}const mT=(...e)=>{const n=fT().createApp(...e),{mount:s}=n;return n.mount=u=>{const h=Rb(u);if(!h)return;const g=n._component;!qt(g)&&!g.render&&!g.template&&(g.template=h.innerHTML),h.innerHTML="";const m=s(h,!1,Db(h));return h instanceof Element&&(h.removeAttribute("v-cloak"),h.setAttribute("data-v-app","")),m},n},gT=(...e)=>{const n=pT().createApp(...e),{mount:s}=n;return n.mount=u=>{const h=Rb(u);if(h)return s(h,!0,Db(h))},n};function Db(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function Rb(e){return ir(e)?document.querySelector(e):e}const yT=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,_T=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,vT=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function xT(e,n){if(e==="__proto__"||e==="constructor"&&n&&typeof n=="object"&&"prototype"in n){bT(e);return}return n}function bT(e){console.warn(`[destr] Dropping "${e}" key to prevent prototype pollution.`)}function gf(e,n={}){if(typeof e!="string")return e;const s=e.trim();if(e[0]==='"'&&e.endsWith('"')&&!e.includes("\\"))return s.slice(1,-1);if(s.length<=9){const u=s.toLowerCase();if(u==="true")return!0;if(u==="false")return!1;if(u==="undefined")return;if(u==="null")return null;if(u==="nan")return Number.NaN;if(u==="infinity")return Number.POSITIVE_INFINITY;if(u==="-infinity")return Number.NEGATIVE_INFINITY}if(!vT.test(e)){if(n.strict)throw new SyntaxError("[destr] Invalid JSON");return e}try{if(yT.test(e)||_T.test(e)){if(n.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(e,xT)}return JSON.parse(e)}catch(u){if(n.strict)throw u;return e}}const wT=/#/g,ET=/&/g,ST=/\//g,IT=/=/g,Kg=/\+/g,TT=/%5e/gi,CT=/%60/gi,AT=/%7c/gi,kT=/%20/gi;function MT(e){return encodeURI(""+e).replace(AT,"|")}function Qm(e){return MT(typeof e=="string"?e:JSON.stringify(e)).replace(Kg,"%2B").replace(kT,"+").replace(wT,"%23").replace(ET,"%26").replace(CT,"`").replace(TT,"^").replace(ST,"%2F")}function wm(e){return Qm(e).replace(IT,"%3D")}function yf(e=""){try{return decodeURIComponent(""+e)}catch{return""+e}}function LT(e){return yf(e.replace(Kg," "))}function PT(e){return yf(e.replace(Kg," "))}function Xg(e=""){const n={};e[0]==="?"&&(e=e.slice(1));for(const s of e.split("&")){const u=s.match(/([^=]+)=?(.*)/)||[];if(u.length<2)continue;const h=LT(u[1]);if(h==="__proto__"||h==="constructor")continue;const g=PT(u[2]||"");n[h]===void 0?n[h]=g:Array.isArray(n[h])?n[h].push(g):n[h]=[n[h],g]}return n}function zT(e,n){return(typeof n=="number"||typeof n=="boolean")&&(n=String(n)),n?Array.isArray(n)?n.map(s=>`${wm(e)}=${Qm(s)}`).join("&"):`${wm(e)}=${Qm(n)}`:wm(e)}function Ob(e){return Object.keys(e).filter(n=>e[n]!==void 0).map(n=>zT(n,e[n])).filter(Boolean).join("&")}const DT=/^[\s\w\0+.-]{2,}:([/\\]{1,2})/,RT=/^[\s\w\0+.-]{2,}:([/\\]{2})?/,OT=/^([/\\]\s*){2,}[^/\\]/,BT=/^[\s\0]*(blob|data|javascript|vbscript):$/i,FT=/\/$|\/\?|\/#/,VT=/^\.?\//;function ca(e,n={}){return typeof n=="boolean"&&(n={acceptRelative:n}),n.strict?DT.test(e):RT.test(e)||(n.acceptRelative?OT.test(e):!1)}function NT(e){return!!e&&BT.test(e)}function eg(e="",n){return n?FT.test(e):e.endsWith("/")}function $f(e="",n){if(!n)return(eg(e)?e.slice(0,-1):e)||"/";if(!eg(e,!0))return e||"/";let s=e,u="";const h=e.indexOf("#");h>=0&&(s=e.slice(0,h),u=e.slice(h));const[g,...m]=s.split("?");return((g.endsWith("/")?g.slice(0,-1):g)||"/")+(m.length>0?`?${m.join("?")}`:"")+u}function _f(e="",n){if(!n)return e.endsWith("/")?e:e+"/";if(eg(e,!0))return e||"/";let s=e,u="";const h=e.indexOf("#");if(h>=0&&(s=e.slice(0,h),u=e.slice(h),!s))return u;const[g,...m]=s.split("?");return g+"/"+(m.length>0?`?${m.join("?")}`:"")+u}function $T(e=""){return e.startsWith("/")}function nv(e=""){return $T(e)?e:"/"+e}function jT(e,n){if(Bb(n)||ca(e))return e;const s=$f(n);return e.startsWith(s)?e:ph(s,e)}function UT(e,n){if(Bb(n))return e;const s=$f(n);if(!e.startsWith(s))return e;const u=e.slice(s.length);return u[0]==="/"?u:"/"+u}function Jg(e,n){const s=GT(e),u={...Xg(s.search),...n};return s.search=Ob(u),Nb(s)}function Bb(e){return!e||e==="/"}function qT(e){return e&&e!=="/"}function ph(e,...n){let s=e||"";for(const u of n.filter(h=>qT(h)))if(s){const h=u.replace(VT,"");s=_f(s)+h}else s=u;return s}function Fb(...e){var m,c,I,M;const n=/\/(?!\/)/,s=e.filter(Boolean),u=[];let h=0;for(const k of s)if(!(!k||k==="/")){for(const[C,L]of k.split(n).entries())if(!(!L||L===".")){if(L===".."){if(u.length===1&&ca(u[0]))continue;u.pop(),h--;continue}if(C===1&&((m=u[u.length-1])!=null&&m.endsWith(":/"))){u[u.length-1]+="/"+L;continue}u.push(L),h++}}let g=u.join("/");return h>=0?(c=s[0])!=null&&c.startsWith("/")&&!g.startsWith("/")?g="/"+g:(I=s[0])!=null&&I.startsWith("./")&&!g.startsWith("./")&&(g="./"+g):g="../".repeat(-1*h)+g,(M=s[s.length-1])!=null&&M.endsWith("/")&&!g.endsWith("/")&&(g+="/"),g}function HT(e,n,s={}){return s.trailingSlash||(e=_f(e),n=_f(n)),s.leadingSlash||(e=nv(e),n=nv(n)),s.encoding||(e=yf(e),n=yf(n)),e===n}const Vb=Symbol.for("ufo:protocolRelative");function GT(e="",n){const s=e.match(/^[\s\0]*(blob:|data:|javascript:|vbscript:)(.*)/i);if(s){const[,C,L=""]=s;return{protocol:C.toLowerCase(),pathname:L,href:C+L,auth:"",host:"",search:"",hash:""}}if(!ca(e,{acceptRelative:!0}))return ov(e);const[,u="",h,g=""]=e.replace(/\\/g,"/").match(/^[\s\0]*([\w+.-]{2,}:)?\/\/([^/@]+@)?(.*)/)||[],[,m="",c=""]=g.match(/([^#/?]*)(.*)?/)||[],{pathname:I,search:M,hash:k}=ov(c.replace(/\/(?=[A-Za-z]:)/,""));return{protocol:u.toLowerCase(),auth:h?h.slice(0,Math.max(0,h.length-1)):"",host:m,pathname:I,search:M,hash:k,[Vb]:!u}}function ov(e=""){const[n="",s="",u=""]=(e.match(/([^#?]*)(\?[^#]*)?(#.*)?/)||[]).splice(1);return{pathname:n,search:s,hash:u}}function Nb(e){const n=e.pathname||"",s=e.search?(e.search.startsWith("?")?"":"?")+e.search:"",u=e.hash||"",h=e.auth?e.auth+"@":"",g=e.host||"";return(e.protocol||e[Vb]?(e.protocol||"")+"//":"")+h+g+n+s+u}class ZT extends Error{constructor(n,s){super(n,s),this.name="FetchError",s!=null&&s.cause&&!this.cause&&(this.cause=s.cause)}}function WT(e){var I,M,k,C,L;const n=((I=e.error)==null?void 0:I.message)||((M=e.error)==null?void 0:M.toString())||"",s=((k=e.request)==null?void 0:k.method)||((C=e.options)==null?void 0:C.method)||"GET",u=((L=e.request)==null?void 0:L.url)||String(e.request)||"/",h=`[${s}] ${JSON.stringify(u)}`,g=e.response?`${e.response.status} ${e.response.statusText}`:"<no response>",m=`${h}: ${g}${n?` ${n}`:""}`,c=new ZT(m,e.error?{cause:e.error}:void 0);for(const q of["request","options","response"])Object.defineProperty(c,q,{get(){return e[q]}});for(const[q,X]of[["data","_data"],["status","status"],["statusCode","status"],["statusText","statusText"],["statusMessage","statusText"]])Object.defineProperty(c,q,{get(){return e.response&&e.response[X]}});return c}const KT=new Set(Object.freeze(["PATCH","POST","PUT","DELETE"]));function sv(e="GET"){return KT.has(e.toUpperCase())}function XT(e){if(e===void 0)return!1;const n=typeof e;return n==="string"||n==="number"||n==="boolean"||n===null?!0:n!=="object"?!1:Array.isArray(e)?!0:e.buffer?!1:e.constructor&&e.constructor.name==="Object"||typeof e.toJSON=="function"}const JT=new Set(["image/svg","application/xml","application/xhtml","application/html"]),YT=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function QT(e=""){if(!e)return"json";const n=e.split(";").shift()||"";return YT.test(n)?"json":JT.has(n)||n.startsWith("text/")?"text":"blob"}function eC(e,n,s=globalThis.Headers){const u={...n,...e};if(n!=null&&n.params&&(e!=null&&e.params)&&(u.params={...n==null?void 0:n.params,...e==null?void 0:e.params}),n!=null&&n.query&&(e!=null&&e.query)&&(u.query={...n==null?void 0:n.query,...e==null?void 0:e.query}),n!=null&&n.headers&&(e!=null&&e.headers)){u.headers=new s((n==null?void 0:n.headers)||{});for(const[h,g]of new s((e==null?void 0:e.headers)||{}))u.headers.set(h,g)}return u}const tC=new Set([408,409,425,429,500,502,503,504]),iC=new Set([101,204,205,304]);function $b(e={}){const{fetch:n=globalThis.fetch,Headers:s=globalThis.Headers,AbortController:u=globalThis.AbortController}=e;async function h(c){const I=c.error&&c.error.name==="AbortError"&&!c.options.timeout||!1;if(c.options.retry!==!1&&!I){let k;typeof c.options.retry=="number"?k=c.options.retry:k=sv(c.options.method)?0:1;const C=c.response&&c.response.status||500;if(k>0&&(Array.isArray(c.options.retryStatusCodes)?c.options.retryStatusCodes.includes(C):tC.has(C))){const L=c.options.retryDelay||0;return L>0&&await new Promise(q=>setTimeout(q,L)),g(c.request,{...c.options,retry:k-1})}}const M=WT(c);throw Error.captureStackTrace&&Error.captureStackTrace(M,g),M}const g=async function(I,M={}){var q;const k={request:I,options:eC(M,e.defaults,s),response:void 0,error:void 0};k.options.method=(q=k.options.method)==null?void 0:q.toUpperCase(),k.options.onRequest&&await k.options.onRequest(k),typeof k.request=="string"&&(k.options.baseURL&&(k.request=jT(k.request,k.options.baseURL)),(k.options.query||k.options.params)&&(k.request=Jg(k.request,{...k.options.params,...k.options.query}))),k.options.body&&sv(k.options.method)&&(XT(k.options.body)?(k.options.body=typeof k.options.body=="string"?k.options.body:JSON.stringify(k.options.body),k.options.headers=new s(k.options.headers||{}),k.options.headers.has("content-type")||k.options.headers.set("content-type","application/json"),k.options.headers.has("accept")||k.options.headers.set("accept","application/json")):("pipeTo"in k.options.body&&typeof k.options.body.pipeTo=="function"||typeof k.options.body.pipe=="function")&&("duplex"in k.options||(k.options.duplex="half")));let C;if(!k.options.signal&&k.options.timeout){const X=new u;C=setTimeout(()=>X.abort(),k.options.timeout),k.options.signal=X.signal}try{k.response=await n(k.request,k.options)}catch(X){return k.error=X,k.options.onRequestError&&await k.options.onRequestError(k),await h(k)}finally{C&&clearTimeout(C)}if(k.response.body&&!iC.has(k.response.status)&&k.options.method!=="HEAD"){const X=(k.options.parseResponse?"json":k.options.responseType)||QT(k.response.headers.get("content-type")||"");switch(X){case"json":{const W=await k.response.text(),ae=k.options.parseResponse||gf;k.response._data=ae(W);break}case"stream":{k.response._data=k.response.body;break}default:k.response._data=await k.response[X]()}}return k.options.onResponse&&await k.options.onResponse(k),!k.options.ignoreResponseError&&k.response.status>=400&&k.response.status<600?(k.options.onResponseError&&await k.options.onResponseError(k),await h(k)):k.response},m=async function(I,M){return(await g(I,M))._data};return m.raw=g,m.native=(...c)=>n(...c),m.create=(c={})=>$b({...e,defaults:{...e.defaults,...c}}),m}const Yg=function(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}(),rC=Yg.fetch||(()=>Promise.reject(new Error("[ofetch] global.fetch is not supported!"))),nC=Yg.Headers,oC=Yg.AbortController,sC=$b({fetch:rC,Headers:nC,AbortController:oC}),aC=sC,lC=()=>{var e;return((e=window==null?void 0:window.__NUXT__)==null?void 0:e.config)||{}},vf=lC().app,cC=()=>vf.baseURL,uC=()=>vf.buildAssetsDir,Qg=(...e)=>Fb(jb(),uC(),...e),jb=(...e)=>{const n=vf.cdnURL||vf.baseURL;return e.length?Fb(n,...e):n};globalThis.__buildAssetsURL=Qg,globalThis.__publicAssetsURL=jb;globalThis.$fetch||(globalThis.$fetch=aC.create({baseURL:cC()}));function tg(e,n={},s){for(const u in e){const h=e[u],g=s?`${s}:${u}`:u;typeof h=="object"&&h!==null?tg(h,n,g):typeof h=="function"&&(n[g]=h)}return n}const hC={run:e=>e()},dC=()=>hC,Ub=typeof console.createTask<"u"?console.createTask:dC;function fC(e,n){const s=n.shift(),u=Ub(s);return e.reduce((h,g)=>h.then(()=>u.run(()=>g(...n))),Promise.resolve())}function pC(e,n){const s=n.shift(),u=Ub(s);return Promise.all(e.map(h=>u.run(()=>h(...n))))}function Em(e,n){for(const s of[...e])s(n)}class mC{constructor(){this._hooks={},this._before=void 0,this._after=void 0,this._deprecatedMessages=void 0,this._deprecatedHooks={},this.hook=this.hook.bind(this),this.callHook=this.callHook.bind(this),this.callHookWith=this.callHookWith.bind(this)}hook(n,s,u={}){if(!n||typeof s!="function")return()=>{};const h=n;let g;for(;this._deprecatedHooks[n];)g=this._deprecatedHooks[n],n=g.to;if(g&&!u.allowDeprecated){let m=g.message;m||(m=`${h} hook has been deprecated`+(g.to?`, please use ${g.to}`:"")),this._deprecatedMessages||(this._deprecatedMessages=new Set),this._deprecatedMessages.has(m)||(console.warn(m),this._deprecatedMessages.add(m))}if(!s.name)try{Object.defineProperty(s,"name",{get:()=>"_"+n.replace(/\W+/g,"_")+"_hook_cb",configurable:!0})}catch{}return this._hooks[n]=this._hooks[n]||[],this._hooks[n].push(s),()=>{s&&(this.removeHook(n,s),s=void 0)}}hookOnce(n,s){let u,h=(...g)=>(typeof u=="function"&&u(),u=void 0,h=void 0,s(...g));return u=this.hook(n,h),u}removeHook(n,s){if(this._hooks[n]){const u=this._hooks[n].indexOf(s);u!==-1&&this._hooks[n].splice(u,1),this._hooks[n].length===0&&delete this._hooks[n]}}deprecateHook(n,s){this._deprecatedHooks[n]=typeof s=="string"?{to:s}:s;const u=this._hooks[n]||[];delete this._hooks[n];for(const h of u)this.hook(n,h)}deprecateHooks(n){Object.assign(this._deprecatedHooks,n);for(const s in n)this.deprecateHook(s,n[s])}addHooks(n){const s=tg(n),u=Object.keys(s).map(h=>this.hook(h,s[h]));return()=>{for(const h of u.splice(0,u.length))h()}}removeHooks(n){const s=tg(n);for(const u in s)this.removeHook(u,s[u])}removeAllHooks(){for(const n in this._hooks)delete this._hooks[n]}callHook(n,...s){return s.unshift(n),this.callHookWith(fC,n,...s)}callHookParallel(n,...s){return s.unshift(n),this.callHookWith(pC,n,...s)}callHookWith(n,s,...u){const h=this._before||this._after?{name:s,args:u,context:{}}:void 0;this._before&&Em(this._before,h);const g=n(s in this._hooks?[...this._hooks[s]]:[],u);return g instanceof Promise?g.finally(()=>{this._after&&h&&Em(this._after,h)}):(this._after&&h&&Em(this._after,h),g)}beforeEach(n){return this._before=this._before||[],this._before.push(n),()=>{if(this._before!==void 0){const s=this._before.indexOf(n);s!==-1&&this._before.splice(s,1)}}}afterEach(n){return this._after=this._after||[],this._after.push(n),()=>{if(this._after!==void 0){const s=this._after.indexOf(n);s!==-1&&this._after.splice(s,1)}}}}function qb(){return new mC}function gC(e={}){let n,s=!1;const u=m=>{if(n&&n!==m)throw new Error("Context conflict")};let h;if(e.asyncContext){const m=e.AsyncLocalStorage||globalThis.AsyncLocalStorage;m?h=new m:console.warn("[unctx] `AsyncLocalStorage` is not provided.")}const g=()=>{if(h&&n===void 0){const m=h.getStore();if(m!==void 0)return m}return n};return{use:()=>{const m=g();if(m===void 0)throw new Error("Context is not available");return m},tryUse:()=>g(),set:(m,c)=>{c||u(m),n=m,s=!0},unset:()=>{n=void 0,s=!1},call:(m,c)=>{u(m),n=m;try{return h?h.run(m,c):c()}finally{s||(n=void 0)}},async callAsync(m,c){n=m;const I=()=>{n=m},M=()=>n===m?I:void 0;ig.add(M);try{const k=h?h.run(m,c):c();return s||(n=void 0),await k}finally{ig.delete(M)}}}}function yC(e={}){const n={};return{get(s,u={}){return n[s]||(n[s]=gC({...e,...u})),n[s],n[s]}}}const xf=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof global<"u"?global:typeof window<"u"?window:{},av="__unctx__",_C=xf[av]||(xf[av]=yC()),vC=(e,n={})=>_C.get(e,n),lv="__unctx_async_handlers__",ig=xf[lv]||(xf[lv]=new Set);function Hb(e){const n=[];for(const h of ig){const g=h();g&&n.push(g)}const s=()=>{for(const h of n)h()};let u=e();return u&&typeof u=="object"&&"catch"in u&&(u=u.catch(h=>{throw s(),h})),[u,s]}const xC={componentName:"NuxtLink"},bC=null,wC="#__nuxt",Gb="nuxt-app",cv=36e5;function Zb(e=Gb){return vC(e,{asyncContext:!1})}const EC="__nuxt_plugin";function SC(e){let n=0;const s={_name:Gb,_scope:YE(),provide:void 0,globalName:"nuxt",versions:{get nuxt(){return"3.12.2"},get vue(){return s.vueApp.version}},payload:ec({data:ec({}),state:Bo({}),once:new Set,_errors:ec({})}),static:{data:{}},runWithContext(h){return s._scope.active&&!zg()?s._scope.run(()=>uv(s,h)):uv(s,h)},isHydrating:!0,deferHydration(){if(!s.isHydrating)return()=>{};n++;let h=!1;return()=>{if(!h&&(h=!0,n--,n===0))return s.isHydrating=!1,s.callHook("app:suspense:resolve")}},_asyncDataPromises:{},_asyncData:ec({}),_payloadRevivers:{},...e};if(window.__NUXT__)for(const h in window.__NUXT__)switch(h){case"data":case"state":case"_errors":Object.assign(s.payload[h],window.__NUXT__[h]);break;default:s.payload[h]=window.__NUXT__[h]}s.hooks=qb(),s.hook=s.hooks.hook,s.callHook=s.hooks.callHook,s.provide=(h,g)=>{const m="$"+h;Fd(s,m,g),Fd(s.vueApp.config.globalProperties,m,g)},Fd(s.vueApp,"$nuxt",s),Fd(s.vueApp.config.globalProperties,"$nuxt",s);{window.addEventListener("nuxt.preloadError",g=>{s.callHook("app:chunkError",{error:g.payload})}),window.useNuxtApp=window.useNuxtApp||Yi;const h=s.hook("app:error",(...g)=>{console.error("[nuxt] error caught during app initialization",...g)});s.hook("app:mounted",h)}const u=s.payload.config;return s.provide("config",u),s}function IC(e,n){n.hooks&&e.hooks.addHooks(n.hooks)}async function TC(e,n){if(typeof n=="function"){const{provide:s}=await e.runWithContext(()=>n(e))||{};if(s&&typeof s=="object")for(const u in s)e.provide(u,s[u])}}async function CC(e,n){const s=[],u=[],h=[],g=[];let m=0;async function c(I){var k;const M=((k=I.dependsOn)==null?void 0:k.filter(C=>n.some(L=>L._name===C)&&!s.includes(C)))??[];if(M.length>0)u.push([new Set(M),I]);else{const C=TC(e,I).then(async()=>{I._name&&(s.push(I._name),await Promise.all(u.map(async([L,q])=>{L.has(I._name)&&(L.delete(I._name),L.size===0&&(m++,await c(q)))})))});I.parallel?h.push(C.catch(L=>g.push(L))):await C}}for(const I of n)IC(e,I);for(const I of n)await c(I);if(await Promise.all(h),m)for(let I=0;I<m;I++)await Promise.all(h);if(g.length)throw g[0]}function _o(e){if(typeof e=="function")return e;const n=e._name||e.name;return delete e.name,Object.assign(e.setup||(()=>{}),e,{[EC]:!0,_name:n})}function uv(e,n,s){const u=()=>n();return Zb(e._name).set(e),e.vueApp.runWithContext(u)}function AC(e){var s;let n;return ib()&&(n=(s=la())==null?void 0:s.appContext.app.$nuxt),n=n||Zb(e).tryUse(),n||null}function Yi(e){const n=AC(e);if(!n)throw new Error("[nuxt] instance unavailable");return n}function fc(e){return Yi().$config}function Fd(e,n,s){Object.defineProperty(e,n,{get:()=>s})}const hv=Object.freeze({ignoreUnknown:!1,respectType:!1,respectFunctionNames:!1,respectFunctionProperties:!1,unorderedObjects:!0,unorderedArrays:!1,unorderedSets:!1,excludeKeys:void 0,excludeValues:void 0,replacer:void 0});function dv(e,n){n?n={...hv,...n}:n=hv;const s=Wb(n);return s.dispatch(e),s.toString()}const kC=Object.freeze(["prototype","__proto__","constructor"]);function Wb(e){let n="",s=new Map;const u=h=>{n+=h};return{toString(){return n},getContext(){return s},dispatch(h){return e.replacer&&(h=e.replacer(h)),this[h===null?"null":typeof h](h)},object(h){if(h&&typeof h.toJSON=="function")return this.object(h.toJSON());const g=Object.prototype.toString.call(h);let m="";const c=g.length;c<10?m="unknown:["+g+"]":m=g.slice(8,c-1),m=m.toLowerCase();let I=null;if((I=s.get(h))===void 0)s.set(h,s.size);else return this.dispatch("[CIRCULAR:"+I+"]");if(typeof Buffer<"u"&&Buffer.isBuffer&&Buffer.isBuffer(h))return u("buffer:"),u(h.toString("utf8"));if(m!=="object"&&m!=="function"&&m!=="asyncfunction")this[m]?this[m](h):e.ignoreUnknown||this.unkown(h,m);else{let M=Object.keys(h);e.unorderedObjects&&(M=M.sort());let k=[];e.respectType!==!1&&!fv(h)&&(k=kC),e.excludeKeys&&(M=M.filter(L=>!e.excludeKeys(L)),k=k.filter(L=>!e.excludeKeys(L))),u("object:"+(M.length+k.length)+":");const C=L=>{this.dispatch(L),u(":"),e.excludeValues||this.dispatch(h[L]),u(",")};for(const L of M)C(L);for(const L of k)C(L)}},array(h,g){if(g=g===void 0?e.unorderedArrays!==!1:g,u("array:"+h.length+":"),!g||h.length<=1){for(const I of h)this.dispatch(I);return}const m=new Map,c=h.map(I=>{const M=Wb(e);M.dispatch(I);for(const[k,C]of M.getContext())m.set(k,C);return M.toString()});return s=m,c.sort(),this.array(c,!1)},date(h){return u("date:"+h.toJSON())},symbol(h){return u("symbol:"+h.toString())},unkown(h,g){if(u(g),!!h&&(u(":"),h&&typeof h.entries=="function"))return this.array(Array.from(h.entries()),!0)},error(h){return u("error:"+h.toString())},boolean(h){return u("bool:"+h)},string(h){u("string:"+h.length+":"),u(h)},function(h){u("fn:"),fv(h)?this.dispatch("[native]"):this.dispatch(h.toString()),e.respectFunctionNames!==!1&&this.dispatch("function-name:"+String(h.name)),e.respectFunctionProperties&&this.object(h)},number(h){return u("number:"+h)},xml(h){return u("xml:"+h.toString())},null(){return u("Null")},undefined(){return u("Undefined")},regexp(h){return u("regex:"+h.toString())},uint8array(h){return u("uint8array:"),this.dispatch(Array.prototype.slice.call(h))},uint8clampedarray(h){return u("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(h))},int8array(h){return u("int8array:"),this.dispatch(Array.prototype.slice.call(h))},uint16array(h){return u("uint16array:"),this.dispatch(Array.prototype.slice.call(h))},int16array(h){return u("int16array:"),this.dispatch(Array.prototype.slice.call(h))},uint32array(h){return u("uint32array:"),this.dispatch(Array.prototype.slice.call(h))},int32array(h){return u("int32array:"),this.dispatch(Array.prototype.slice.call(h))},float32array(h){return u("float32array:"),this.dispatch(Array.prototype.slice.call(h))},float64array(h){return u("float64array:"),this.dispatch(Array.prototype.slice.call(h))},arraybuffer(h){return u("arraybuffer:"),this.dispatch(new Uint8Array(h))},url(h){return u("url:"+h.toString())},map(h){u("map:");const g=[...h];return this.array(g,e.unorderedSets!==!1)},set(h){u("set:");const g=[...h];return this.array(g,e.unorderedSets!==!1)},file(h){return u("file:"),this.dispatch([h.name,h.size,h.type,h.lastModfied])},blob(){if(e.ignoreUnknown)return u("[blob]");throw new Error(`Hashing Blob objects is currently not supported
Use "options.replacer" or "options.ignoreUnknown"
`)},domwindow(){return u("domwindow")},bigint(h){return u("bigint:"+h.toString())},process(){return u("process")},timer(){return u("timer")},pipe(){return u("pipe")},tcp(){return u("tcp")},udp(){return u("udp")},tty(){return u("tty")},statwatcher(){return u("statwatcher")},securecontext(){return u("securecontext")},connection(){return u("connection")},zlib(){return u("zlib")},context(){return u("context")},nodescript(){return u("nodescript")},httpparser(){return u("httpparser")},dataview(){return u("dataview")},signal(){return u("signal")},fsevent(){return u("fsevent")},tlswrap(){return u("tlswrap")}}}const Kb="[native code] }",MC=Kb.length;function fv(e){return typeof e!="function"?!1:Function.prototype.toString.call(e).slice(-MC)===Kb}function LC(e,n,s={}){return e===n||dv(e,s)===dv(n,s)}function PC(e,n){return{ctx:{table:e},matchAll:s=>Jb(s,e)}}function Xb(e){const n={};for(const s in e)n[s]=s==="dynamic"?new Map(Object.entries(e[s]).map(([u,h])=>[u,Xb(h)])):new Map(Object.entries(e[s]));return n}function zC(e){return PC(Xb(e))}function Jb(e,n,s){e.endsWith("/")&&(e=e.slice(0,-1)||"/");const u=[];for(const[g,m]of pv(n.wildcard))(e===g||e.startsWith(g+"/"))&&u.push(m);for(const[g,m]of pv(n.dynamic))if(e.startsWith(g+"/")){const c="/"+e.slice(g.length).split("/").splice(2).join("/");u.push(...Jb(c,m))}const h=n.static.get(e);return h&&u.push(h),u.filter(Boolean)}function pv(e){return[...e.entries()].sort((n,s)=>n[0].length-s[0].length)}function Sm(e){if(e===null||typeof e!="object")return!1;const n=Object.getPrototypeOf(e);return n!==null&&n!==Object.prototype&&Object.getPrototypeOf(n)!==null||Symbol.iterator in e?!1:Symbol.toStringTag in e?Object.prototype.toString.call(e)==="[object Module]":!0}function rg(e,n,s=".",u){if(!Sm(n))return rg(e,{},s,u);const h=Object.assign({},n);for(const g in e){if(g==="__proto__"||g==="constructor")continue;const m=e[g];m!=null&&(u&&u(h,g,m,s)||(Array.isArray(m)&&Array.isArray(h[g])?h[g]=[...m,...h[g]]:Sm(m)&&Sm(h[g])?h[g]=rg(m,h[g],(s?`${s}.`:"")+g.toString(),u):h[g]=m))}return h}function ey(e){return(...n)=>n.reduce((s,u)=>rg(s,u,"",e),{})}const jf=ey(),DC=ey((e,n,s)=>{if(e[n]!==void 0&&typeof s=="function")return e[n]=s(e[n]),!0});function RC(e,n){try{return n in e}catch{return!1}}var OC=Object.defineProperty,BC=(e,n,s)=>n in e?OC(e,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[n]=s,Ua=(e,n,s)=>(BC(e,typeof n!="symbol"?n+"":n,s),s);class ng extends Error{constructor(n,s={}){super(n,s),Ua(this,"statusCode",500),Ua(this,"fatal",!1),Ua(this,"unhandled",!1),Ua(this,"statusMessage"),Ua(this,"data"),Ua(this,"cause"),s.cause&&!this.cause&&(this.cause=s.cause)}toJSON(){const n={message:this.message,statusCode:og(this.statusCode,500)};return this.statusMessage&&(n.statusMessage=Yb(this.statusMessage)),this.data!==void 0&&(n.data=this.data),n}}Ua(ng,"__h3_error__",!0);function FC(e){if(typeof e=="string")return new ng(e);if(VC(e))return e;const n=new ng(e.message??e.statusMessage??"",{cause:e.cause||e});if(RC(e,"stack"))try{Object.defineProperty(n,"stack",{get(){return e.stack}})}catch{try{n.stack=e.stack}catch{}}if(e.data&&(n.data=e.data),e.statusCode?n.statusCode=og(e.statusCode,n.statusCode):e.status&&(n.statusCode=og(e.status,n.statusCode)),e.statusMessage?n.statusMessage=e.statusMessage:e.statusText&&(n.statusMessage=e.statusText),n.statusMessage){const s=n.statusMessage;Yb(n.statusMessage)!==s&&console.warn("[h3] Please prefer using `message` for longer error messages instead of `statusMessage`. In the future, `statusMessage` will be sanitized by default.")}return e.fatal!==void 0&&(n.fatal=e.fatal),e.unhandled!==void 0&&(n.unhandled=e.unhandled),n}function VC(e){var n;return((n=e==null?void 0:e.constructor)==null?void 0:n.__h3_error__)===!0}const NC=/[^\u0009\u0020-\u007E]/g;function Yb(e=""){return e.replace(NC,"")}function og(e,n=200){return!e||(typeof e=="string"&&(e=Number.parseInt(e,10)),e<100||e>999)?n:e}const Qb=Symbol("route"),Vo=()=>{var e;return(e=Yi())==null?void 0:e.$router},ty=()=>ib()?Zr(Qb,Yi()._route):Yi()._route;const $C=()=>{try{if(Yi()._processingMiddleware)return!0}catch{return!1}return!1},e1=(e,n)=>{e||(e="/");const s=typeof e=="string"?e:Jg(e.path||"/",e.query||{})+(e.hash||"");if(n!=null&&n.open){const{target:c="_blank",windowFeatures:I={}}=n.open,M=Object.entries(I).filter(([k,C])=>C!==void 0).map(([k,C])=>`${k.toLowerCase()}=${C}`).join(", ");return open(s,c,M),Promise.resolve()}const u=(n==null?void 0:n.external)||ca(s,{acceptRelative:!0});if(u){if(!(n!=null&&n.external))throw new Error("Navigating to an external URL is not allowed by default. Use `navigateTo(url, { external: true })`.");const{protocol:c}=new URL(s,window.location.href);if(c&&NT(c))throw new Error(`Cannot navigate to a URL with '${c}' protocol.`)}const h=$C();if(!u&&h)return e;const g=Vo(),m=Yi();return u?(m._scope.stop(),n!=null&&n.replace?location.replace(s):location.href=s,h?m.isHydrating?new Promise(()=>{}):!1:Promise.resolve()):n!=null&&n.replace?g.replace(e):g.push(e)},t1="__nuxt_error",iy=()=>Qn(Yi().payload,"error"),jC=e=>{const n=ry(e);try{const s=Yi(),u=iy();s.hooks.callHook("app:error",n),u.value=u.value||n}catch{throw n}return n},UC=async(e={})=>{const n=Yi(),s=iy();n.callHook("app:error:cleared",e),e.redirect&&await Vo().replace(e.redirect),s.value=bC},qC=e=>!!e&&typeof e=="object"&&t1 in e,ry=e=>{const n=FC(e);return Object.defineProperty(n,t1,{value:!0,configurable:!1,writable:!1}),n},HC=-1,GC=-2,ZC=-3,WC=-4,KC=-5,XC=-6;function JC(e,n){return YC(JSON.parse(e),n)}function YC(e,n){if(typeof e=="number")return h(e,!0);if(!Array.isArray(e)||e.length===0)throw new Error("Invalid input");const s=e,u=Array(s.length);function h(g,m=!1){if(g===HC)return;if(g===ZC)return NaN;if(g===WC)return 1/0;if(g===KC)return-1/0;if(g===XC)return-0;if(m)throw new Error("Invalid input");if(g in u)return u[g];const c=s[g];if(!c||typeof c!="object")u[g]=c;else if(Array.isArray(c))if(typeof c[0]=="string"){const I=c[0],M=n==null?void 0:n[I];if(M)return u[g]=M(h(c[1]));switch(I){case"Date":u[g]=new Date(c[1]);break;case"Set":const k=new Set;u[g]=k;for(let q=1;q<c.length;q+=1)k.add(h(c[q]));break;case"Map":const C=new Map;u[g]=C;for(let q=1;q<c.length;q+=2)C.set(h(c[q]),h(c[q+1]));break;case"RegExp":u[g]=new RegExp(c[1],c[2]);break;case"Object":u[g]=Object(c[1]);break;case"BigInt":u[g]=BigInt(c[1]);break;case"null":const L=Object.create(null);u[g]=L;for(let q=1;q<c.length;q+=2)L[c[q]]=h(c[q+1]);break;default:throw new Error(`Unknown type ${I}`)}}else{const I=new Array(c.length);u[g]=I;for(let M=0;M<c.length;M+=1){const k=c[M];k!==GC&&(I[M]=h(k))}}else{const I={};u[g]=I;for(const M in c){const k=c[M];I[M]=h(k)}}return u[g]}return h(0)}function QC(e){return Array.isArray(e)?e:[e]}const eA=["title","titleTemplate","script","style","noscript"],Wd=["base","meta","link","style","script","noscript"],tA=["title","titleTemplate","templateParams","base","htmlAttrs","bodyAttrs","meta","link","style","script","noscript"],iA=["base","title","titleTemplate","bodyAttrs","htmlAttrs","templateParams"],i1=["tagPosition","tagPriority","tagDuplicateStrategy","children","innerHTML","textContent","processTemplateParams"],rA=typeof window<"u";function ny(e){let n=9;for(let s=0;s<e.length;)n=Math.imul(n^e.charCodeAt(s++),9**9);return((n^n>>>9)+65536).toString(16).substring(1,8).toLowerCase()}function mv(e){return e._h||ny(e._d?e._d:`${e.tag}:${e.textContent||e.innerHTML||""}:${Object.entries(e.props).map(([n,s])=>`${n}:${String(s)}`).join(",")}`)}function r1(e,n){const{props:s,tag:u}=e;if(iA.includes(u))return u;if(u==="link"&&s.rel==="canonical")return"canonical";if(s.charset)return"charset";const h=["id"];u==="meta"&&h.push("name","property","http-equiv");for(const g of h)if(typeof s[g]<"u"){const m=String(s[g]);return`${u}:${g}:${m}`}return!1}function gv(e,n){return e==null?n||null:typeof e=="function"?e(n):e}async function nA(e,n,s){const u={tag:e,props:await n1(typeof n=="object"&&typeof n!="function"&&!(n instanceof Promise)?{...n}:{[["script","noscript","style"].includes(e)?"innerHTML":"textContent"]:n},["templateParams","titleTemplate"].includes(e))};return i1.forEach(h=>{const g=typeof u.props[h]<"u"?u.props[h]:s[h];typeof g<"u"&&((!["innerHTML","textContent","children"].includes(h)||eA.includes(u.tag))&&(u[h==="children"?"innerHTML":h]=g),delete u.props[h])}),u.props.body&&(u.tagPosition="bodyClose",delete u.props.body),u.tag==="script"&&typeof u.innerHTML=="object"&&(u.innerHTML=JSON.stringify(u.innerHTML),u.props.type=u.props.type||"application/json"),Array.isArray(u.props.content)?u.props.content.map(h=>({...u,props:{...u.props,content:h}})):u}function oA(e,n){var u;const s=e==="class"?" ":";";return typeof n=="object"&&!Array.isArray(n)&&(n=Object.entries(n).filter(([,h])=>h).map(([h,g])=>e==="style"?`${h}:${g}`:h)),(u=String(Array.isArray(n)?n.join(s):n))==null?void 0:u.split(s).filter(h=>h.trim()).filter(Boolean).join(s)}async function n1(e,n){for(const s of Object.keys(e)){if(["class","style"].includes(s)){e[s]=oA(s,e[s]);continue}if(e[s]instanceof Promise&&(e[s]=await e[s]),!n&&!i1.includes(s)){const u=String(e[s]),h=s.startsWith("data-");u==="true"||u===""?e[s]=h?"true":!0:e[s]||(h&&u==="false"?e[s]="false":delete e[s])}}return e}const sA=10;async function aA(e){const n=[];return Object.entries(e.resolvedInput).filter(([s,u])=>typeof u<"u"&&tA.includes(s)).forEach(([s,u])=>{const h=QC(u);n.push(...h.map(g=>nA(s,g,e)).flat())}),(await Promise.all(n)).flat().filter(Boolean).map((s,u)=>(s._e=e._i,e.mode&&(s._m=e.mode),s._p=(e._i<<sA)+u,s))}const yv={base:-10,title:10},_v={critical:-80,high:-10,low:20};function bf(e){let n=100;const s=e.tagPriority;return typeof s=="number"?s:(e.tag==="meta"?(e.props["http-equiv"]==="content-security-policy"&&(n=-30),e.props.charset&&(n=-20),e.props.name==="viewport"&&(n=-15)):e.tag==="link"&&e.props.rel==="preconnect"?n=20:e.tag in yv&&(n=yv[e.tag]),typeof s=="string"&&s in _v?n+_v[s]:n)}const lA=[{prefix:"before:",offset:-1},{prefix:"after:",offset:1}],vv=["onload","onerror","onabort","onprogress","onloadstart"],Hs="%separator";function Kd(e,n,s){if(typeof e!="string"||!e.includes("%"))return e;function u(m){let c;return["s","pageTitle"].includes(m)?c=n.pageTitle:m.includes(".")?c=m.split(".").reduce((I,M)=>I&&I[M]||void 0,n):c=n[m],typeof c<"u"?(c||"").replace(/"/g,'\\"'):!1}let h=e;try{h=decodeURI(e)}catch{}return(h.match(/%(\w+\.+\w+)|%(\w+)/g)||[]).sort().reverse().forEach(m=>{const c=u(m.slice(1));typeof c=="string"&&(e=e.replace(new RegExp(`\\${m}(\\W|$)`,"g"),(I,M)=>`${c}${M}`).trim())}),e.includes(Hs)&&(e.endsWith(Hs)&&(e=e.slice(0,-Hs.length).trim()),e.startsWith(Hs)&&(e=e.slice(Hs.length).trim()),e=e.replace(new RegExp(`\\${Hs}\\s*\\${Hs}`,"g"),Hs),e=Kd(e,{separator:s},s)),e}async function o1(e,n={}){var k;const s=n.document||e.resolvedOptions.document;if(!s||!e.dirty)return;const u={shouldRender:!0,tags:[]};if(await e.hooks.callHook("dom:beforeRender",u),!u.shouldRender)return;const h=(await e.resolveTags()).map(C=>({tag:C,id:Wd.includes(C.tag)?mv(C):C.tag,shouldRender:!0}));let g=e._dom;if(!g){g={elMap:{htmlAttrs:s.documentElement,bodyAttrs:s.body}};for(const C of["body","head"]){const L=(k=s[C])==null?void 0:k.children,q=[];for(const X of[...L].filter(W=>Wd.includes(W.tagName.toLowerCase()))){const W={tag:X.tagName.toLowerCase(),props:await n1(X.getAttributeNames().reduce((ee,H)=>({...ee,[H]:X.getAttribute(H)}),{})),innerHTML:X.innerHTML};let ae=1,Ie=r1(W);for(;Ie&&q.find(ee=>ee._d===Ie);)Ie=`${Ie}:${ae++}`;W._d=Ie||void 0,q.push(W),g.elMap[X.getAttribute("data-hid")||mv(W)]=X}}}g.pendingSideEffects={...g.sideEffects||{}},g.sideEffects={};function m(C,L,q){const X=`${C}:${L}`;g.sideEffects[X]=q,delete g.pendingSideEffects[X]}function c({id:C,$el:L,tag:q}){const X=q.tag.endsWith("Attrs");g.elMap[C]=L,X||(["textContent","innerHTML"].forEach(W=>{q[W]&&q[W]!==L[W]&&(L[W]=q[W])}),m(C,"el",()=>{var W;(W=g.elMap[C])==null||W.remove(),delete g.elMap[C]}));for(const[W,ae]of Object.entries(q._eventHandlers||{}))L.getAttribute(`data-${W}`)!==""&&((q.tag==="bodyAttrs"?s.defaultView:L).addEventListener(W.replace("on",""),ae.bind(L)),L.setAttribute(`data-${W}`,""));Object.entries(q.props).forEach(([W,ae])=>{const Ie=`attr:${W}`;if(W==="class")for(const ee of(ae||"").split(" ").filter(Boolean))X&&m(C,`${Ie}:${ee}`,()=>L.classList.remove(ee)),!L.classList.contains(ee)&&L.classList.add(ee);else if(W==="style")for(const ee of(ae||"").split(";").filter(Boolean)){const[H,...ce]=ee.split(":").map(ne=>ne.trim());m(C,`${Ie}:${ee}:${H}`,()=>{L.style.removeProperty(H)}),L.style.setProperty(H,ce.join(":"))}else L.getAttribute(W)!==ae&&L.setAttribute(W,ae===!0?"":String(ae)),X&&m(C,Ie,()=>L.removeAttribute(W))})}const I=[],M={bodyClose:void 0,bodyOpen:void 0,head:void 0};for(const C of h){const{tag:L,shouldRender:q,id:X}=C;if(q){if(L.tag==="title"){s.title=L.textContent;continue}C.$el=C.$el||g.elMap[X],C.$el?c(C):Wd.includes(L.tag)&&I.push(C)}}for(const C of I){const L=C.tag.tagPosition||"head";C.$el=s.createElement(C.tag.tag),c(C),M[L]=M[L]||s.createDocumentFragment(),M[L].appendChild(C.$el)}for(const C of h)await e.hooks.callHook("dom:renderTag",C,s,m);M.head&&s.head.appendChild(M.head),M.bodyOpen&&s.body.insertBefore(M.bodyOpen,s.body.firstChild),M.bodyClose&&s.body.appendChild(M.bodyClose),Object.values(g.pendingSideEffects).forEach(C=>C()),e._dom=g,e.dirty=!1,await e.hooks.callHook("dom:rendered",{renders:h})}async function cA(e,n={}){const s=n.delayFn||(u=>setTimeout(u,10));return e._domUpdatePromise=e._domUpdatePromise||new Promise(u=>s(async()=>{await o1(e,n),delete e._domUpdatePromise,u()}))}function uA(e){return n=>{var u,h;const s=((h=(u=n.resolvedOptions.document)==null?void 0:u.head.querySelector('script[id="unhead:payload"]'))==null?void 0:h.innerHTML)||!1;return s&&n.push(JSON.parse(s)),{mode:"client",hooks:{"entries:updated":function(g){cA(g,e)}}}}}const hA=["templateParams","htmlAttrs","bodyAttrs"],dA={hooks:{"tag:normalise":function({tag:e}){["hid","vmid","key"].forEach(u=>{e.props[u]&&(e.key=e.props[u],delete e.props[u])});const s=r1(e)||(e.key?`${e.tag}:${e.key}`:!1);s&&(e._d=s)},"tags:resolve":function(e){const n={};e.tags.forEach(u=>{const h=(u.key?`${u.tag}:${u.key}`:u._d)||u._p,g=n[h];if(g){let c=u==null?void 0:u.tagDuplicateStrategy;if(!c&&hA.includes(u.tag)&&(c="merge"),c==="merge"){const I=g.props;["class","style"].forEach(M=>{I[M]&&(u.props[M]?(M==="style"&&!I[M].endsWith(";")&&(I[M]+=";"),u.props[M]=`${I[M]} ${u.props[M]}`):u.props[M]=I[M])}),n[h].props={...I,...u.props};return}else if(u._e===g._e){g._duped=g._duped||[],u._d=`${g._d}:${g._duped.length+1}`,g._duped.push(u);return}else if(bf(u)>bf(g))return}const m=Object.keys(u.props).length+(u.innerHTML?1:0)+(u.textContent?1:0);if(Wd.includes(u.tag)&&m===0){delete n[h];return}n[h]=u});const s=[];Object.values(n).forEach(u=>{const h=u._duped;delete u._duped,s.push(u),h&&s.push(...h)}),e.tags=s,e.tags=e.tags.filter(u=>!(u.tag==="meta"&&(u.props.name||u.props.property)&&!u.props.content))}}},fA={mode:"server",hooks:{"tags:resolve":function(e){const n={};e.tags.filter(s=>["titleTemplate","templateParams","title"].includes(s.tag)&&s._m==="server").forEach(s=>{n[s.tag]=s.tag.startsWith("title")?s.textContent:s.props}),Object.keys(n).length&&e.tags.push({tag:"script",innerHTML:JSON.stringify(n),props:{id:"unhead:payload",type:"application/json"}})}}},pA=["script","link","bodyAttrs"],mA=e=>({hooks:{"tags:resolve":function(n){for(const s of n.tags.filter(u=>pA.includes(u.tag)))Object.entries(s.props).forEach(([u,h])=>{u.startsWith("on")&&typeof h=="function"&&(e.ssr&&vv.includes(u)?s.props[u]=`this.dataset.${u}fired = true`:delete s.props[u],s._eventHandlers=s._eventHandlers||{},s._eventHandlers[u]=h)}),e.ssr&&s._eventHandlers&&(s.props.src||s.props.href)&&(s.key=s.key||ny(s.props.src||s.props.href))},"dom:renderTag":function({$el:n,tag:s}){var u,h;for(const g of Object.keys((n==null?void 0:n.dataset)||{}).filter(m=>vv.some(c=>`${c}fired`===m))){const m=g.replace("fired","");(h=(u=s._eventHandlers)==null?void 0:u[m])==null||h.call(n,new Event(m.replace("on","")))}}}}),gA=["link","style","script","noscript"],yA={hooks:{"tag:normalise":({tag:e})=>{e.key&&gA.includes(e.tag)&&(e.props["data-hid"]=e._h=ny(e.key))}}},_A={hooks:{"tags:resolve":e=>{const n=s=>{var u;return(u=e.tags.find(h=>h._d===s))==null?void 0:u._p};for(const{prefix:s,offset:u}of lA)for(const h of e.tags.filter(g=>typeof g.tagPriority=="string"&&g.tagPriority.startsWith(s))){const g=n(h.tagPriority.replace(s,""));typeof g<"u"&&(h._p=g+u)}e.tags.sort((s,u)=>s._p-u._p).sort((s,u)=>bf(s)-bf(u))}}},vA={meta:"content",link:"href",htmlAttrs:"lang"},xA=e=>({hooks:{"tags:resolve":n=>{var c;const{tags:s}=n,u=(c=s.find(I=>I.tag==="title"))==null?void 0:c.textContent,h=s.findIndex(I=>I.tag==="templateParams"),g=h!==-1?s[h].props:{},m=g.separator||"|";delete g.separator,g.pageTitle=Kd(g.pageTitle||u||"",g,m);for(const I of s.filter(M=>M.processTemplateParams!==!1)){const M=vA[I.tag];M&&typeof I.props[M]=="string"?I.props[M]=Kd(I.props[M],g,m):(I.processTemplateParams===!0||["titleTemplate","title"].includes(I.tag))&&["innerHTML","textContent"].forEach(k=>{typeof I[k]=="string"&&(I[k]=Kd(I[k],g,m))})}e._templateParams=g,e._separator=m,n.tags=s.filter(I=>I.tag!=="templateParams")}}}),bA={hooks:{"tags:resolve":e=>{const{tags:n}=e;let s=n.findIndex(h=>h.tag==="titleTemplate");const u=n.findIndex(h=>h.tag==="title");if(u!==-1&&s!==-1){const h=gv(n[s].textContent,n[u].textContent);h!==null?n[u].textContent=h||n[u].textContent:delete n[u]}else if(s!==-1){const h=gv(n[s].textContent);h!==null&&(n[s].textContent=h,n[s].tag="title",s=-1)}s!==-1&&delete n[s],e.tags=n.filter(Boolean)}}},wA={hooks:{"tags:afterResolve":function(e){for(const n of e.tags)typeof n.innerHTML=="string"&&(n.innerHTML&&["application/ld+json","application/json"].includes(n.props.type)?n.innerHTML=n.innerHTML.replace(/</g,"\\u003C"):n.innerHTML=n.innerHTML.replace(new RegExp(`</${n.tag}`,"g"),`<\\/${n.tag}`))}}};let s1;function EA(e={}){const n=SA(e);return n.use(uA()),s1=n}function xv(e,n){return!e||e==="server"&&n||e==="client"&&!n}function SA(e={}){const n=qb();n.addHooks(e.hooks||{}),e.document=e.document||(rA?document:void 0);const s=!e.document,u=()=>{c.dirty=!0,n.callHook("entries:updated",c)};let h=0,g=[];const m=[],c={plugins:m,dirty:!1,resolvedOptions:e,hooks:n,headEntries(){return g},use(I){const M=typeof I=="function"?I(c):I;(!M.key||!m.some(k=>k.key===M.key))&&(m.push(M),xv(M.mode,s)&&n.addHooks(M.hooks||{}))},push(I,M){M==null||delete M.head;const k={_i:h++,input:I,...M};return xv(k.mode,s)&&(g.push(k),u()),{dispose(){g=g.filter(C=>C._i!==k._i),n.callHook("entries:updated",c),u()},patch(C){g=g.map(L=>(L._i===k._i&&(L.input=k.input=C),L)),u()}}},async resolveTags(){const I={tags:[],entries:[...g]};await n.callHook("entries:resolve",I);for(const M of I.entries){const k=M.resolvedInput||M.input;if(M.resolvedInput=await(M.transform?M.transform(k):k),M.resolvedInput)for(const C of await aA(M)){const L={tag:C,entry:M,resolvedOptions:c.resolvedOptions};await n.callHook("tag:normalise",L),I.tags.push(L.tag)}}return await n.callHook("tags:beforeResolve",I),await n.callHook("tags:resolve",I),await n.callHook("tags:afterResolve",I),I.tags},ssr:s};return[dA,fA,mA,yA,_A,xA,bA,wA,...(e==null?void 0:e.plugins)||[]].forEach(I=>c.use(I)),c.hooks.callHook("init",c),c}function IA(){return s1}const TA=kb.startsWith("3");function CA(e){return typeof e=="function"?e():ni(e)}function wf(e,n=""){if(e instanceof Promise)return e;const s=CA(e);return!e||!s?s:Array.isArray(s)?s.map(u=>wf(u,n)):typeof s=="object"?Object.fromEntries(Object.entries(s).map(([u,h])=>u==="titleTemplate"||u.startsWith("on")?[u,ni(h)]:[u,wf(h,u)])):s}const AA={hooks:{"entries:resolve":function(e){for(const n of e.entries)n.resolvedInput=wf(n.input)}}},a1="usehead";function kA(e){return{install(s){TA&&(s.config.globalProperties.$unhead=e,s.config.globalProperties.$head=e,s.provide(a1,e))}}.install}function MA(e={}){e.domDelayFn=e.domDelayFn||(s=>qr(()=>setTimeout(()=>s(),0)));const n=EA(e);return n.use(AA),n.install=kA(n),n}const sg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ag="__unhead_injection_handler__";function LA(e){sg[ag]=e}function PA(){if(ag in sg)return sg[ag]();const e=Zr(a1);return e||IA()}function zA(e,n={}){const s=n.head||PA();if(s)return s.ssr?s.push(e,n):DA(s,e,n)}function DA(e,n,s={}){const u=kt(!1),h=kt({});Vn(()=>{h.value=u.value?{}:wf(n)});const g=e.push(h.value,s);return Zi(h,c=>{g.patch(c)}),la()&&(Bf(()=>{g.dispose()}),gb(()=>{u.value=!0}),mb(()=>{u.value=!1})),g}let Xd,Jd;function RA(){return Xd=$fetch(Qg(`builds/meta/${fc().app.buildId}.json`),{responseType:"json"}),Xd.then(e=>{Jd=zC(e.matcher)}).catch(e=>{console.error("[nuxt] Error fetching app manifest.",e)}),Xd}function Uf(){return Xd||RA()}async function oy(e){if(await Uf(),!Jd)return console.error("[nuxt] Error creating app manifest matcher.",Jd),{};try{return jf({},...Jd.matchAll(e).reverse())}catch(n){return console.error("[nuxt] Error matching route rules.",n),{}}}async function bv(e,n={}){const s=await BA(e,n),u=Yi(),h=u._payloadCache=u._payloadCache||{};return s in h||(h[s]=c1(e).then(g=>g?l1(s).then(m=>m||(delete h[s],null)):(h[s]=null,null))),h[s]}const OA="_payload.json";async function BA(e,n={}){const s=new URL(e,"http://localhost");if(s.host!=="localhost"||ca(s.pathname,{acceptRelative:!0}))throw new Error("Payload URL must not include hostname: "+e);const u=fc(),h=n.hash||(n.fresh?Date.now():u.app.buildId),g=u.app.cdnURL,m=g&&await c1(e)?g:u.app.baseURL;return ph(m,s.pathname,OA+(h?`?${h}`:""))}async function l1(e){const n=fetch(e).then(s=>s.text().then(u1));try{return await n}catch(s){console.warn("[nuxt] Cannot load payload ",e,s)}return null}async function c1(e=ty().path){if(e=$f(e),(await Uf()).prerendered.includes(e))return!0;const s=await oy(e);return!!s.prerender&&!s.redirect}let Vd=null;async function FA(){if(Vd)return Vd;const e=document.getElementById("__NUXT_DATA__");if(!e)return{};const n=await u1(e.textContent||""),s=e.dataset.src?await l1(e.dataset.src):void 0;return Vd={...n,...s,...window.__NUXT__},Vd}async function u1(e){return await JC(e,Yi()._payloadRevivers)}function VA(e,n){Yi()._payloadRevivers[e]=n}const wv={NuxtError:e=>ry(e),EmptyShallowRef:e=>uc(e==="_"?void 0:e==="0n"?BigInt(0):gf(e)),EmptyRef:e=>kt(e==="_"?void 0:e==="0n"?BigInt(0):gf(e)),ShallowRef:e=>uc(e),ShallowReactive:e=>ec(e),Ref:e=>kt(e),Reactive:e=>Bo(e)},NA=_o({name:"nuxt:revive-payload:client",order:-30,async setup(e){let n,s;for(const u in wv)VA(u,wv[u]);Object.assign(e.payload,([n,s]=Hb(()=>e.runWithContext(FA)),n=await n,s(),n)),window.__NUXT__=e.payload}}),$A=[],jA=_o({name:"nuxt:head",enforce:"pre",setup(e){const n=MA({plugins:$A});LA(()=>Yi().vueApp._context.provides.usehead),e.vueApp.use(n);{let s=!0;const u=async()=>{s=!1,await o1(n)};n.hooks.hook("dom:beforeRender",h=>{h.shouldRender=!s}),e.hooks.hook("page:start",()=>{s=!0}),e.hooks.hook("page:finish",()=>{e.isHydrating||u()}),e.hooks.hook("app:error",u),e.hooks.hook("app:suspense:resolve",u)}}}),UA=async e=>{let n,s;const u=([n,s]=Hb(()=>oy(e.path)),n=await n,s(),n);if(u.redirect)return ca(u.redirect,{acceptRelative:!0})?(window.location.href=u.redirect,!1):u.redirect},qA=[UA];function Im(e){typeof e=="object"&&(e=Nb({pathname:e.path||"",search:Ob(e.query||{}),hash:e.hash||""}));const n=new URL(e.toString(),window.location.href);return{path:n.pathname,fullPath:e,query:Xg(n.search),hash:n.hash,params:{},name:void 0,matched:[],redirectedFrom:void 0,meta:{},href:e}}const HA=_o({name:"nuxt:router",enforce:"pre",setup(e){const n=UT(window.location.pathname,fc().app.baseURL)+window.location.search+window.location.hash,s=[],u={"navigate:before":[],"resolve:before":[],"navigate:after":[],error:[]},h=(C,L)=>(u[C].push(L),()=>u[C].splice(u[C].indexOf(L),1)),g=fc().app.baseURL,m=Bo(Im(n));async function c(C,L){try{const q=Im(C);for(const X of u["navigate:before"]){const W=await X(q,m);if(W===!1||W instanceof Error)return;if(typeof W=="string"&&W.length)return c(W,!0)}for(const X of u["resolve:before"])await X(q,m);Object.assign(m,q),window.history[L?"replaceState":"pushState"]({},"",ph(g,q.fullPath)),e.isHydrating||await e.runWithContext(UC);for(const X of u["navigate:after"])await X(q,m)}catch(q){for(const X of u.error)await X(q)}}const M={currentRoute:Ve(()=>m),isReady:()=>Promise.resolve(),options:{},install:()=>Promise.resolve(),push:C=>c(C,!1),replace:C=>c(C,!0),back:()=>window.history.go(-1),go:C=>window.history.go(C),forward:()=>window.history.go(1),beforeResolve:C=>h("resolve:before",C),beforeEach:C=>h("navigate:before",C),afterEach:C=>h("navigate:after",C),onError:C=>h("error",C),resolve:Im,addRoute:(C,L)=>{s.push(L)},getRoutes:()=>s,hasRoute:C=>s.some(L=>L.name===C),removeRoute:C=>{const L=s.findIndex(q=>q.name===C);L!==-1&&s.splice(L,1)}};e.vueApp.component("RouterLink",Ri({functional:!0,props:{to:{type:String,required:!0},custom:Boolean,replace:Boolean,activeClass:String,exactActiveClass:String,ariaCurrentValue:String},setup:(C,{slots:L})=>{const q=()=>c(C.to,C.replace);return()=>{var W;const X=M.resolve(C.to);return C.custom?(W=L.default)==null?void 0:W.call(L,{href:C.to,navigate:q,route:X}):Nn("a",{href:C.to,onClick:ae=>(ae.preventDefault(),q())},L)}}})),window.addEventListener("popstate",C=>{const L=C.target.location;M.replace(L.href.replace(L.origin,""))}),e._route=m,e._middleware=e._middleware||{global:[],named:{}};const k=e.payload.state._layout;return e.hooks.hookOnce("app:created",async()=>{M.beforeEach(async(C,L)=>{C.meta=Bo(C.meta||{}),e.isHydrating&&k&&!cc(C.meta.layout)&&(C.meta.layout=k),e._processingMiddleware=!0;{const q=new Set([...qA,...e._middleware.global]);{const X=await e.runWithContext(()=>oy(C.path));if(X.appMiddleware)for(const W in X.appMiddleware){const ae=e._middleware.named[W];if(!ae)return;X.appMiddleware[W]?q.add(ae):q.delete(ae)}}for(const X of q){const W=await e.runWithContext(()=>X(C,L));if(W!==!0&&(W||W===!1))return W}}}),M.afterEach(()=>{delete e._processingMiddleware}),await M.replace(n),HT(m.fullPath,n)||await e.runWithContext(()=>e1(m.fullPath))}),{provide:{route:m,router:M}}}}),lg=globalThis.requestIdleCallback||(e=>{const n=Date.now(),s={didTimeout:!1,timeRemaining:()=>Math.max(0,50-(Date.now()-n))};return setTimeout(()=>{e(s)},1)}),GA=globalThis.cancelIdleCallback||(e=>{clearTimeout(e)}),sy=e=>{const n=Yi();n.isHydrating?n.hooks.hookOnce("app:suspense:resolve",()=>{lg(()=>e())}):lg(()=>e())},ZA=_o({name:"nuxt:payload",setup(e){Vo().beforeResolve(async(n,s)=>{if(n.path===s.path)return;const u=await bv(n.path);u&&Object.assign(e.static.data,u.data)}),sy(()=>{var n;e.hooks.hook("link:prefetch",async s=>{const{hostname:u}=new URL(s,window.location.href);u===window.location.hostname&&await bv(s)}),((n=navigator.connection)==null?void 0:n.effectiveType)!=="slow-2g"&&setTimeout(Uf,1e3)})}}),WA=_o(e=>{let n;async function s(){const u=await Uf();n&&clearTimeout(n),n=setTimeout(s,cv);try{const h=await $fetch(Qg("builds/latest.json")+`?${Date.now()}`);h.id!==u.id&&e.hooks.callHook("app:manifest:update",h)}catch{}}sy(()=>{n=setTimeout(s,cv)})}),KA="modulepreload",XA=function(e,n){return e[0]==="."?new URL(e,n).href:e},Ev={},JA=function(n,s,u){let h=Promise.resolve();if(s&&s.length>0){const g=document.getElementsByTagName("link"),m=document.querySelector("meta[property=csp-nonce]"),c=(m==null?void 0:m.nonce)||(m==null?void 0:m.getAttribute("nonce"));h=Promise.all(s.map(I=>{if(I=XA(I,u),I in Ev)return;Ev[I]=!0;const M=I.endsWith(".css"),k=M?'[rel="stylesheet"]':"";if(!!u)for(let q=g.length-1;q>=0;q--){const X=g[q];if(X.href===I&&(!M||X.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${I}"]${k}`))return;const L=document.createElement("link");if(L.rel=M?"stylesheet":KA,M||(L.as="script",L.crossOrigin=""),L.href=I,c&&L.setAttribute("nonce",c),document.head.appendChild(L),M)return new Promise((q,X)=>{L.addEventListener("load",q),L.addEventListener("error",()=>X(new Error(`Unable to preload CSS for ${I}`)))})}))}return h.then(()=>n()).catch(g=>{const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=g,window.dispatchEvent(m),!m.defaultPrevented)throw g})},Ef=(...e)=>JA(...e).catch(n=>{const s=new Event("nuxt.preloadError");throw s.payload=n,window.dispatchEvent(s),n}),YA=cf(()=>Ef(()=>Promise.resolve().then(()=>oP),void 0,import.meta.url).then(e=>e.default||e.default||e)),QA=cf(()=>Ef(()=>import("./YvfZNES3.js"),__vite__mapDeps([0,1]),import.meta.url).then(e=>e.default||e.default||e)),ek=[["Icon",YA],["IconCSS",QA]],tk=_o({name:"nuxt:global-components",setup(e){for(const[n,s]of ek)e.vueApp.component(n,s),e.vueApp.component("Lazy"+n,s)}});function cg(e){return zg()?(Ix(e),!0):!1}function Sf(e){return typeof e=="function"?e():ni(e)}const ug=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Sv=()=>+Date.now(),hg=()=>{};function ik(e,n){function s(...u){return new Promise((h,g)=>{Promise.resolve(e(()=>n.apply(this,u),{fn:n,thisArg:this,args:u})).then(h).catch(g)})}return s}function rk(e,n={}){let s,u,h=hg;const g=c=>{clearTimeout(c),h(),h=hg};return c=>{const I=Sf(e),M=Sf(n.maxWait);return s&&g(s),I<=0||M!==void 0&&M<=0?(u&&(g(u),u=null),Promise.resolve(c())):new Promise((k,C)=>{h=n.rejectOnCancel?C:k,M&&!u&&(u=setTimeout(()=>{s&&g(s),u=null,k(c())},M)),s=setTimeout(()=>{u&&g(u),u=null,k(c())},I)})}}function h1(e,n=200,s={}){return ik(rk(n,s),e)}function nk(e,n=1e3,s={}){const{immediate:u=!0,immediateCallback:h=!1}=s;let g=null;const m=kt(!1);function c(){g&&(clearInterval(g),g=null)}function I(){m.value=!1,c()}function M(){const k=Sf(n);k<=0||(m.value=!0,h&&e(),c(),g=setInterval(e,k))}if(u&&ug&&M(),fr(n)||typeof n=="function"){const k=Zi(n,()=>{m.value&&ug&&M()});cg(k)}return cg(I),{isActive:m,pause:I,resume:M}}function ok(e,n,s){let u;fr(s)?u={evaluating:s}:u=s||{};const{lazy:h=!1,evaluating:g=void 0,shallow:m=!0,onError:c=hg}=u,I=kt(!h),M=m?uc(n):kt(n);let k=0;return Vn(async C=>{if(!I.value)return;k++;const L=k;let q=!1;g&&Promise.resolve().then(()=>{g.value=!0});try{const X=await e(W=>{C(()=>{g&&(g.value=!1),q||W()})});L===k&&(M.value=X)}catch(X){c(X)}finally{g&&L===k&&(g.value=!1),q=!0}}),h?Ve(()=>(I.value=!0,M.value)):M}function Iv(e){var n;const s=Sf(e);return(n=s==null?void 0:s.$el)!=null?n:s}const sk=ug?window:void 0;function ak(e,n={}){const{immediate:s=!0,fpsLimit:u=void 0,window:h=sk}=n,g=kt(!1),m=u?1e3/u:null;let c=0,I=null;function M(L){if(!g.value||!h)return;c||(c=L);const q=L-c;if(m&&q<m){I=h.requestAnimationFrame(M);return}c=L,e({delta:q,timestamp:L}),I=h.requestAnimationFrame(M)}function k(){!g.value&&h&&(g.value=!0,c=0,I=h.requestAnimationFrame(M))}function C(){g.value=!1,I!=null&&h&&(h.cancelAnimationFrame(I),I=null)}return s&&k(),cg(C),{isActive:Vg(g),pause:C,resume:k}}function lk(e={}){const{controls:n=!1,offset:s=0,immediate:u=!0,interval:h="requestAnimationFrame",callback:g}=e,m=kt(Sv()+s),c=()=>m.value=Sv()+s,I=g?()=>{c(),g(m.value)}:c,M=h==="requestAnimationFrame"?ak(I,{immediate:u}):nk(I,h,{immediate:u});return n?{timestamp:m,...M}:m}const ck=Symbol("nuxt-ui.slideover"),uk=_o(e=>{const n=uc({component:"div",props:{}});e.vueApp.provide(ck,n)}),hk=Symbol("nuxt-ui.modal"),dk=_o(e=>{const n=uc({component:"div",props:{}});e.vueApp.provide(hk,n)}),fk={ui:{primary:"red",gray:"neutral",icons:{dynamic:!0},notifications:{position:"top-0 bottom-auto"}}},pk={nuxt:{},ui:{primary:"green",gray:"cool",colors:["red","orange","amber","yellow","lime","green","emerald","teal","cyan","sky","blue","indigo","violet","purple","fuchsia","pink","rose","primary"],strategy:"merge"}},Di=DC(fk,pk);function qf(){const e=Yi();return e._appConfig||(e._appConfig=Bo(Di)),e._appConfig}const ay="-";function mk(e){const n=yk(e),{conflictingClassGroups:s,conflictingClassGroupModifiers:u}=e;function h(m){const c=m.split(ay);return c[0]===""&&c.length!==1&&c.shift(),d1(c,n)||gk(m)}function g(m,c){const I=s[m]||[];return c&&u[m]?[...I,...u[m]]:I}return{getClassGroupId:h,getConflictingClassGroupIds:g}}function d1(e,n){var m;if(e.length===0)return n.classGroupId;const s=e[0],u=n.nextPart.get(s),h=u?d1(e.slice(1),u):void 0;if(h)return h;if(n.validators.length===0)return;const g=e.join(ay);return(m=n.validators.find(({validator:c})=>c(g)))==null?void 0:m.classGroupId}const Tv=/^\[(.+)\]$/;function gk(e){if(Tv.test(e)){const n=Tv.exec(e)[1],s=n==null?void 0:n.substring(0,n.indexOf(":"));if(s)return"arbitrary.."+s}}function yk(e){const{theme:n,prefix:s}=e,u={nextPart:new Map,validators:[]};return vk(Object.entries(e.classGroups),s).forEach(([g,m])=>{dg(m,u,g,n)}),u}function dg(e,n,s,u){e.forEach(h=>{if(typeof h=="string"){const g=h===""?n:Cv(n,h);g.classGroupId=s;return}if(typeof h=="function"){if(_k(h)){dg(h(u),n,s,u);return}n.validators.push({validator:h,classGroupId:s});return}Object.entries(h).forEach(([g,m])=>{dg(m,Cv(n,g),s,u)})})}function Cv(e,n){let s=e;return n.split(ay).forEach(u=>{s.nextPart.has(u)||s.nextPart.set(u,{nextPart:new Map,validators:[]}),s=s.nextPart.get(u)}),s}function _k(e){return e.isThemeGetter}function vk(e,n){return n?e.map(([s,u])=>{const h=u.map(g=>typeof g=="string"?n+g:typeof g=="object"?Object.fromEntries(Object.entries(g).map(([m,c])=>[n+m,c])):g);return[s,h]}):e}function xk(e){if(e<1)return{get:()=>{},set:()=>{}};let n=0,s=new Map,u=new Map;function h(g,m){s.set(g,m),n++,n>e&&(n=0,u=s,s=new Map)}return{get(g){let m=s.get(g);if(m!==void 0)return m;if((m=u.get(g))!==void 0)return h(g,m),m},set(g,m){s.has(g)?s.set(g,m):h(g,m)}}}const f1="!";function bk(e){const n=e.separator,s=n.length===1,u=n[0],h=n.length;return function(m){const c=[];let I=0,M=0,k;for(let W=0;W<m.length;W++){let ae=m[W];if(I===0){if(ae===u&&(s||m.slice(W,W+h)===n)){c.push(m.slice(M,W)),M=W+h;continue}if(ae==="/"){k=W;continue}}ae==="["?I++:ae==="]"&&I--}const C=c.length===0?m:m.substring(M),L=C.startsWith(f1),q=L?C.substring(1):C,X=k&&k>M?k-M:void 0;return{modifiers:c,hasImportantModifier:L,baseClassName:q,maybePostfixModifierPosition:X}}}function wk(e){if(e.length<=1)return e;const n=[];let s=[];return e.forEach(u=>{u[0]==="["?(n.push(...s.sort(),u),s=[]):s.push(u)}),n.push(...s.sort()),n}function Ek(e){return{cache:xk(e.cacheSize),splitModifiers:bk(e),...mk(e)}}const Sk=/\s+/;function Ik(e,n){const{splitModifiers:s,getClassGroupId:u,getConflictingClassGroupIds:h}=n,g=new Set;return e.trim().split(Sk).map(m=>{const{modifiers:c,hasImportantModifier:I,baseClassName:M,maybePostfixModifierPosition:k}=s(m);let C=u(k?M.substring(0,k):M),L=!!k;if(!C){if(!k)return{isTailwindClass:!1,originalClassName:m};if(C=u(M),!C)return{isTailwindClass:!1,originalClassName:m};L=!1}const q=wk(c).join(":");return{isTailwindClass:!0,modifierId:I?q+f1:q,classGroupId:C,originalClassName:m,hasPostfixModifier:L}}).reverse().filter(m=>{if(!m.isTailwindClass)return!0;const{modifierId:c,classGroupId:I,hasPostfixModifier:M}=m,k=c+I;return g.has(k)?!1:(g.add(k),h(I,M).forEach(C=>g.add(c+C)),!0)}).reverse().map(m=>m.originalClassName).join(" ")}function tr(){let e=0,n,s,u="";for(;e<arguments.length;)(n=arguments[e++])&&(s=p1(n))&&(u&&(u+=" "),u+=s);return u}function p1(e){if(typeof e=="string")return e;let n,s="";for(let u=0;u<e.length;u++)e[u]&&(n=p1(e[u]))&&(s&&(s+=" "),s+=n);return s}function fg(e,...n){let s,u,h,g=m;function m(I){const M=n.reduce((k,C)=>C(k),e());return s=Ek(M),u=s.cache.get,h=s.cache.set,g=c,c(I)}function c(I){const M=u(I);if(M)return M;const k=Ik(I,s);return h(I,k),k}return function(){return g(tr.apply(null,arguments))}}function Hi(e){const n=s=>s[e]||[];return n.isThemeGetter=!0,n}const m1=/^\[(?:([a-z-]+):)?(.+)\]$/i,Tk=/^\d+\/\d+$/,Ck=new Set(["px","full","screen"]),Ak=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,kk=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Mk=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Lk=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Pk=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/;function os(e){return Ga(e)||Ck.has(e)||Tk.test(e)}function Gs(e){return xc(e,"length",Nk)}function Ga(e){return!!e&&!Number.isNaN(Number(e))}function Nd(e){return xc(e,"number",Ga)}function zu(e){return!!e&&Number.isInteger(Number(e))}function zk(e){return e.endsWith("%")&&Ga(e.slice(0,-1))}function Qt(e){return m1.test(e)}function Zs(e){return Ak.test(e)}const Dk=new Set(["length","size","percentage"]);function Rk(e){return xc(e,Dk,g1)}function Ok(e){return xc(e,"position",g1)}const Bk=new Set(["image","url"]);function Fk(e){return xc(e,Bk,jk)}function Vk(e){return xc(e,"",$k)}function Du(){return!0}function xc(e,n,s){const u=m1.exec(e);return u?u[1]?typeof n=="string"?u[1]===n:n.has(u[1]):s(u[2]):!1}function Nk(e){return kk.test(e)&&!Mk.test(e)}function g1(){return!1}function $k(e){return Lk.test(e)}function jk(e){return Pk.test(e)}function pg(){const e=Hi("colors"),n=Hi("spacing"),s=Hi("blur"),u=Hi("brightness"),h=Hi("borderColor"),g=Hi("borderRadius"),m=Hi("borderSpacing"),c=Hi("borderWidth"),I=Hi("contrast"),M=Hi("grayscale"),k=Hi("hueRotate"),C=Hi("invert"),L=Hi("gap"),q=Hi("gradientColorStops"),X=Hi("gradientColorStopPositions"),W=Hi("inset"),ae=Hi("margin"),Ie=Hi("opacity"),ee=Hi("padding"),H=Hi("saturate"),ce=Hi("scale"),ne=Hi("sepia"),oe=Hi("skew"),Ae=Hi("space"),be=Hi("translate"),Le=()=>["auto","contain","none"],me=()=>["auto","hidden","clip","visible","scroll"],ke=()=>["auto",Qt,n],Me=()=>[Qt,n],Oe=()=>["",os,Gs],Ge=()=>["auto",Ga,Qt],rt=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],Ke=()=>["solid","dashed","dotted","double","none"],dt=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],nt=()=>["start","end","center","between","around","evenly","stretch"],ti=()=>["","0",Qt],Ut=()=>["auto","avoid","all","avoid-page","page","left","right","column"],Nt=()=>[Ga,Nd],jt=()=>[Ga,Qt];return{cacheSize:500,separator:":",theme:{colors:[Du],spacing:[os,Gs],blur:["none","",Zs,Qt],brightness:Nt(),borderColor:[e],borderRadius:["none","","full",Zs,Qt],borderSpacing:Me(),borderWidth:Oe(),contrast:Nt(),grayscale:ti(),hueRotate:jt(),invert:ti(),gap:Me(),gradientColorStops:[e],gradientColorStopPositions:[zk,Gs],inset:ke(),margin:ke(),opacity:Nt(),padding:Me(),saturate:Nt(),scale:Nt(),sepia:ti(),skew:jt(),space:Me(),translate:Me()},classGroups:{aspect:[{aspect:["auto","square","video",Qt]}],container:["container"],columns:[{columns:[Zs]}],"break-after":[{"break-after":Ut()}],"break-before":[{"break-before":Ut()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...rt(),Qt]}],overflow:[{overflow:me()}],"overflow-x":[{"overflow-x":me()}],"overflow-y":[{"overflow-y":me()}],overscroll:[{overscroll:Le()}],"overscroll-x":[{"overscroll-x":Le()}],"overscroll-y":[{"overscroll-y":Le()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[W]}],"inset-x":[{"inset-x":[W]}],"inset-y":[{"inset-y":[W]}],start:[{start:[W]}],end:[{end:[W]}],top:[{top:[W]}],right:[{right:[W]}],bottom:[{bottom:[W]}],left:[{left:[W]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",zu,Qt]}],basis:[{basis:ke()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Qt]}],grow:[{grow:ti()}],shrink:[{shrink:ti()}],order:[{order:["first","last","none",zu,Qt]}],"grid-cols":[{"grid-cols":[Du]}],"col-start-end":[{col:["auto",{span:["full",zu,Qt]},Qt]}],"col-start":[{"col-start":Ge()}],"col-end":[{"col-end":Ge()}],"grid-rows":[{"grid-rows":[Du]}],"row-start-end":[{row:["auto",{span:[zu,Qt]},Qt]}],"row-start":[{"row-start":Ge()}],"row-end":[{"row-end":Ge()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Qt]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Qt]}],gap:[{gap:[L]}],"gap-x":[{"gap-x":[L]}],"gap-y":[{"gap-y":[L]}],"justify-content":[{justify:["normal",...nt()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...nt(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...nt(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[ee]}],px:[{px:[ee]}],py:[{py:[ee]}],ps:[{ps:[ee]}],pe:[{pe:[ee]}],pt:[{pt:[ee]}],pr:[{pr:[ee]}],pb:[{pb:[ee]}],pl:[{pl:[ee]}],m:[{m:[ae]}],mx:[{mx:[ae]}],my:[{my:[ae]}],ms:[{ms:[ae]}],me:[{me:[ae]}],mt:[{mt:[ae]}],mr:[{mr:[ae]}],mb:[{mb:[ae]}],ml:[{ml:[ae]}],"space-x":[{"space-x":[Ae]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[Ae]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Qt,n]}],"min-w":[{"min-w":[Qt,n,"min","max","fit"]}],"max-w":[{"max-w":[Qt,n,"none","full","min","max","fit","prose",{screen:[Zs]},Zs]}],h:[{h:[Qt,n,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Qt,n,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Qt,n,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Qt,n,"auto","min","max","fit"]}],"font-size":[{text:["base",Zs,Gs]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Nd]}],"font-family":[{font:[Du]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Qt]}],"line-clamp":[{"line-clamp":["none",Ga,Nd]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",os,Qt]}],"list-image":[{"list-image":["none",Qt]}],"list-style-type":[{list:["none","disc","decimal",Qt]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[Ie]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[Ie]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Ke(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",os,Gs]}],"underline-offset":[{"underline-offset":["auto",os,Qt]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:Me()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Qt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Qt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[Ie]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...rt(),Ok]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Rk]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Fk]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[X]}],"gradient-via-pos":[{via:[X]}],"gradient-to-pos":[{to:[X]}],"gradient-from":[{from:[q]}],"gradient-via":[{via:[q]}],"gradient-to":[{to:[q]}],rounded:[{rounded:[g]}],"rounded-s":[{"rounded-s":[g]}],"rounded-e":[{"rounded-e":[g]}],"rounded-t":[{"rounded-t":[g]}],"rounded-r":[{"rounded-r":[g]}],"rounded-b":[{"rounded-b":[g]}],"rounded-l":[{"rounded-l":[g]}],"rounded-ss":[{"rounded-ss":[g]}],"rounded-se":[{"rounded-se":[g]}],"rounded-ee":[{"rounded-ee":[g]}],"rounded-es":[{"rounded-es":[g]}],"rounded-tl":[{"rounded-tl":[g]}],"rounded-tr":[{"rounded-tr":[g]}],"rounded-br":[{"rounded-br":[g]}],"rounded-bl":[{"rounded-bl":[g]}],"border-w":[{border:[c]}],"border-w-x":[{"border-x":[c]}],"border-w-y":[{"border-y":[c]}],"border-w-s":[{"border-s":[c]}],"border-w-e":[{"border-e":[c]}],"border-w-t":[{"border-t":[c]}],"border-w-r":[{"border-r":[c]}],"border-w-b":[{"border-b":[c]}],"border-w-l":[{"border-l":[c]}],"border-opacity":[{"border-opacity":[Ie]}],"border-style":[{border:[...Ke(),"hidden"]}],"divide-x":[{"divide-x":[c]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[c]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[Ie]}],"divide-style":[{divide:Ke()}],"border-color":[{border:[h]}],"border-color-x":[{"border-x":[h]}],"border-color-y":[{"border-y":[h]}],"border-color-t":[{"border-t":[h]}],"border-color-r":[{"border-r":[h]}],"border-color-b":[{"border-b":[h]}],"border-color-l":[{"border-l":[h]}],"divide-color":[{divide:[h]}],"outline-style":[{outline:["",...Ke()]}],"outline-offset":[{"outline-offset":[os,Qt]}],"outline-w":[{outline:[os,Gs]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:Oe()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[Ie]}],"ring-offset-w":[{"ring-offset":[os,Gs]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Zs,Vk]}],"shadow-color":[{shadow:[Du]}],opacity:[{opacity:[Ie]}],"mix-blend":[{"mix-blend":[...dt(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":dt()}],filter:[{filter:["","none"]}],blur:[{blur:[s]}],brightness:[{brightness:[u]}],contrast:[{contrast:[I]}],"drop-shadow":[{"drop-shadow":["","none",Zs,Qt]}],grayscale:[{grayscale:[M]}],"hue-rotate":[{"hue-rotate":[k]}],invert:[{invert:[C]}],saturate:[{saturate:[H]}],sepia:[{sepia:[ne]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[s]}],"backdrop-brightness":[{"backdrop-brightness":[u]}],"backdrop-contrast":[{"backdrop-contrast":[I]}],"backdrop-grayscale":[{"backdrop-grayscale":[M]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[k]}],"backdrop-invert":[{"backdrop-invert":[C]}],"backdrop-opacity":[{"backdrop-opacity":[Ie]}],"backdrop-saturate":[{"backdrop-saturate":[H]}],"backdrop-sepia":[{"backdrop-sepia":[ne]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[m]}],"border-spacing-x":[{"border-spacing-x":[m]}],"border-spacing-y":[{"border-spacing-y":[m]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Qt]}],duration:[{duration:jt()}],ease:[{ease:["linear","in","out","in-out",Qt]}],delay:[{delay:jt()}],animate:[{animate:["none","spin","ping","pulse","bounce",Qt]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[ce]}],"scale-x":[{"scale-x":[ce]}],"scale-y":[{"scale-y":[ce]}],rotate:[{rotate:[zu,Qt]}],"translate-x":[{"translate-x":[be]}],"translate-y":[{"translate-y":[be]}],"skew-x":[{"skew-x":[oe]}],"skew-y":[{"skew-y":[oe]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Qt]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Qt]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":Me()}],"scroll-mx":[{"scroll-mx":Me()}],"scroll-my":[{"scroll-my":Me()}],"scroll-ms":[{"scroll-ms":Me()}],"scroll-me":[{"scroll-me":Me()}],"scroll-mt":[{"scroll-mt":Me()}],"scroll-mr":[{"scroll-mr":Me()}],"scroll-mb":[{"scroll-mb":Me()}],"scroll-ml":[{"scroll-ml":Me()}],"scroll-p":[{"scroll-p":Me()}],"scroll-px":[{"scroll-px":Me()}],"scroll-py":[{"scroll-py":Me()}],"scroll-ps":[{"scroll-ps":Me()}],"scroll-pe":[{"scroll-pe":Me()}],"scroll-pt":[{"scroll-pt":Me()}],"scroll-pr":[{"scroll-pr":Me()}],"scroll-pb":[{"scroll-pb":Me()}],"scroll-pl":[{"scroll-pl":Me()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Qt]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[os,Gs,Nd]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}function Uk(e,{cacheSize:n,prefix:s,separator:u,extend:h={},override:g={}}){Yd(e,"cacheSize",n),Yd(e,"prefix",s),Yd(e,"separator",u);for(const m in g)qk(e[m],g[m]);for(const m in h)Hk(e[m],h[m]);return e}function Yd(e,n,s){s!==void 0&&(e[n]=s)}function qk(e,n){if(n)for(const s in n)Yd(e,s,n[s])}function Hk(e,n){if(n)for(const s in n){const u=n[s];u!==void 0&&(e[s]=(e[s]||[]).concat(u))}}function Gk(e,...n){return typeof e=="function"?fg(pg,e,...n):fg(()=>Uk(pg(),e),...n)}const fs=fg(pg);function Zk(e,n){const s={...e};for(const u of n)delete s[u];return s}function y1(e,n,s){typeof n=="string"&&(n=n.split(".").map(h=>{const g=Number(h);return isNaN(g)?h:g}));let u=e;for(const h of n){if(u==null)return s;u=u[h]}return u!==void 0?u:s}const ly={to:{type:[String,Object],default:void 0,required:!1},href:{type:[String,Object],default:void 0,required:!1},target:{type:String,default:void 0,required:!1},rel:{type:String,default:void 0,required:!1},noRel:{type:Boolean,default:void 0,required:!1},prefetch:{type:Boolean,default:void 0,required:!1},noPrefetch:{type:Boolean,default:void 0,required:!1},activeClass:{type:String,default:void 0,required:!1},exactActiveClass:{type:String,default:void 0,required:!1},prefetchedClass:{type:String,default:void 0,required:!1},replace:{type:Boolean,default:void 0,required:!1},ariaCurrentValue:{type:String,default:void 0,required:!1},external:{type:Boolean,default:void 0,required:!1}},Wk=e=>Object.keys(ly).reduce((s,u)=>(e[u]!==void 0&&(s[u]=e[u]),s),{}),Kk=Gk({extend:{classGroups:{icons:[e=>/^i-/.test(e)]}}}),Xk=ey((e,n,s,u)=>{if(u==="default"||u.startsWith("default.")||u==="popper"||u.startsWith("popper.")||u.endsWith("avatar")&&n==="size"||u.endsWith("chip")&&n==="size"||u.endsWith("badge")&&n==="size"||n==="color"||n==="variant")return!1;if(typeof e[n]=="string"&&typeof s=="string"&&e[n]&&s)return e[n]=Kk(e[n],s),!0});function ys(e,...n){return e==="override"?jf({},...n):Xk({},...n)}function Av(e){const n=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(n,function(u,h,g,m){return h+h+g+g+m+m});const s=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return s?`${parseInt(s[1],16)} ${parseInt(s[2],16)} ${parseInt(s[3],16)}`:null}function Jk(e){const n=parseFloat(e);return isNaN(n)?e:n}const Yk="inherit",Qk="currentColor",eM="transparent",tM="#000",iM="#fff",rM={50:"#f8fafc",100:"#f1f5f9",200:"#e2e8f0",300:"#cbd5e1",400:"#94a3b8",500:"#64748b",600:"#475569",700:"#334155",800:"#1e293b",900:"#0f172a",950:"#020617"},nM={50:"rgb(var(--color-gray-50) / <alpha-value>)",100:"rgb(var(--color-gray-100) / <alpha-value>)",200:"rgb(var(--color-gray-200) / <alpha-value>)",300:"rgb(var(--color-gray-300) / <alpha-value>)",400:"rgb(var(--color-gray-400) / <alpha-value>)",500:"rgb(var(--color-gray-500) / <alpha-value>)",600:"rgb(var(--color-gray-600) / <alpha-value>)",700:"rgb(var(--color-gray-700) / <alpha-value>)",800:"rgb(var(--color-gray-800) / <alpha-value>)",900:"rgb(var(--color-gray-900) / <alpha-value>)",950:"rgb(var(--color-gray-950) / <alpha-value>)"},oM={50:"#fafafa",100:"#f4f4f5",200:"#e4e4e7",300:"#d4d4d8",400:"#a1a1aa",500:"#71717a",600:"#52525b",700:"#3f3f46",800:"#27272a",900:"#18181b",950:"#09090b"},sM={50:"#fafafa",100:"#f5f5f5",200:"#e5e5e5",300:"#d4d4d4",400:"#a3a3a3",500:"#737373",600:"#525252",700:"#404040",800:"#262626",900:"#171717",950:"#0a0a0a"},aM={50:"#fafaf9",100:"#f5f5f4",200:"#e7e5e4",300:"#d6d3d1",400:"#a8a29e",500:"#78716c",600:"#57534e",700:"#44403c",800:"#292524",900:"#1c1917",950:"#0c0a09"},lM={50:"#fef2f2",100:"#fee2e2",200:"#fecaca",300:"#fca5a5",400:"#f87171",500:"#ef4444",600:"#dc2626",700:"#b91c1c",800:"#991b1b",900:"#7f1d1d",950:"#450a0a"},cM={50:"#fff7ed",100:"#ffedd5",200:"#fed7aa",300:"#fdba74",400:"#fb923c",500:"#f97316",600:"#ea580c",700:"#c2410c",800:"#9a3412",900:"#7c2d12",950:"#431407"},uM={50:"#fffbeb",100:"#fef3c7",200:"#fde68a",300:"#fcd34d",400:"#fbbf24",500:"#f59e0b",600:"#d97706",700:"#b45309",800:"#92400e",900:"#78350f",950:"#451a03"},hM={50:"#fefce8",100:"#fef9c3",200:"#fef08a",300:"#fde047",400:"#facc15",500:"#eab308",600:"#ca8a04",700:"#a16207",800:"#854d0e",900:"#713f12",950:"#422006"},dM={50:"#f7fee7",100:"#ecfccb",200:"#d9f99d",300:"#bef264",400:"#a3e635",500:"#84cc16",600:"#65a30d",700:"#4d7c0f",800:"#3f6212",900:"#365314",950:"#1a2e05"},fM={50:"#f0fdf4",100:"#dcfce7",200:"#bbf7d0",300:"#86efac",400:"#4ade80",500:"#22c55e",600:"#16a34a",700:"#15803d",800:"#166534",900:"#14532d",950:"#052e16"},pM={50:"#ecfdf5",100:"#d1fae5",200:"#a7f3d0",300:"#6ee7b7",400:"#34d399",500:"#10b981",600:"#059669",700:"#047857",800:"#065f46",900:"#064e3b",950:"#022c22"},mM={50:"#f0fdfa",100:"#ccfbf1",200:"#99f6e4",300:"#5eead4",400:"#2dd4bf",500:"#14b8a6",600:"#0d9488",700:"#0f766e",800:"#115e59",900:"#134e4a",950:"#042f2e"},gM={50:"#ecfeff",100:"#cffafe",200:"#a5f3fc",300:"#67e8f9",400:"#22d3ee",500:"#06b6d4",600:"#0891b2",700:"#0e7490",800:"#155e75",900:"#164e63",950:"#083344"},yM={50:"#f0f9ff",100:"#e0f2fe",200:"#bae6fd",300:"#7dd3fc",400:"#38bdf8",500:"#0ea5e9",600:"#0284c7",700:"#0369a1",800:"#075985",900:"#0c4a6e",950:"#082f49"},_M={50:"#eff6ff",100:"#dbeafe",200:"#bfdbfe",300:"#93c5fd",400:"#60a5fa",500:"#3b82f6",600:"#2563eb",700:"#1d4ed8",800:"#1e40af",900:"#1e3a8a",950:"#172554"},vM={50:"#eef2ff",100:"#e0e7ff",200:"#c7d2fe",300:"#a5b4fc",400:"#818cf8",500:"#6366f1",600:"#4f46e5",700:"#4338ca",800:"#3730a3",900:"#312e81",950:"#1e1b4b"},xM={50:"#f5f3ff",100:"#ede9fe",200:"#ddd6fe",300:"#c4b5fd",400:"#a78bfa",500:"#8b5cf6",600:"#7c3aed",700:"#6d28d9",800:"#5b21b6",900:"#4c1d95",950:"#2e1065"},bM={50:"#faf5ff",100:"#f3e8ff",200:"#e9d5ff",300:"#d8b4fe",400:"#c084fc",500:"#a855f7",600:"#9333ea",700:"#7e22ce",800:"#6b21a8",900:"#581c87",950:"#3b0764"},wM={50:"#fdf4ff",100:"#fae8ff",200:"#f5d0fe",300:"#f0abfc",400:"#e879f9",500:"#d946ef",600:"#c026d3",700:"#a21caf",800:"#86198f",900:"#701a75",950:"#4a044e"},EM={50:"#fdf2f8",100:"#fce7f3",200:"#fbcfe8",300:"#f9a8d4",400:"#f472b6",500:"#ec4899",600:"#db2777",700:"#be185d",800:"#9d174d",900:"#831843",950:"#500724"},SM={50:"#fff1f2",100:"#ffe4e6",200:"#fecdd3",300:"#fda4af",400:"#fb7185",500:"#f43f5e",600:"#e11d48",700:"#be123c",800:"#9f1239",900:"#881337",950:"#4c0519"},IM={50:"rgb(var(--color-primary-50) / <alpha-value>)",100:"rgb(var(--color-primary-100) / <alpha-value>)",200:"rgb(var(--color-primary-200) / <alpha-value>)",300:"rgb(var(--color-primary-300) / <alpha-value>)",400:"rgb(var(--color-primary-400) / <alpha-value>)",500:"rgb(var(--color-primary-500) / <alpha-value>)",600:"rgb(var(--color-primary-600) / <alpha-value>)",700:"rgb(var(--color-primary-700) / <alpha-value>)",800:"rgb(var(--color-primary-800) / <alpha-value>)",900:"rgb(var(--color-primary-900) / <alpha-value>)",950:"rgb(var(--color-primary-950) / <alpha-value>)",DEFAULT:"rgb(var(--color-primary-DEFAULT) / <alpha-value>)"},TM={50:"#f9fafb",100:"#f3f4f6",200:"#e5e7eb",300:"#d1d5db",400:"#9ca3af",500:"#6b7280",600:"#4b5563",700:"#374151",800:"#1f2937",900:"#111827",950:"#030712"},$d={inherit:Yk,current:Qk,transparent:eM,black:tM,white:iM,slate:rM,gray:nM,zinc:oM,neutral:sM,stone:aM,red:lM,orange:cM,amber:uM,yellow:hM,lime:dM,green:fM,emerald:pM,teal:mM,cyan:gM,sky:yM,blue:_M,indigo:vM,violet:xM,purple:bM,fuchsia:wM,pink:EM,rose:SM,primary:IM,cool:TM},CM=_o(()=>{const e=qf(),n=Yi(),s=Ve(()=>{const h=$d[e.ui.primary],g=$d[e.ui.gray];return h||console.warn(`[@nuxt/ui] Primary color '${e.ui.primary}' not found in Tailwind config`),g||console.warn(`[@nuxt/ui] Gray color '${e.ui.gray}' not found in Tailwind config`),`:root {
${Object.entries(h||$d.green).map(([m,c])=>`--color-primary-${m}: ${Av(c)};`).join(`
`)}
--color-primary-DEFAULT: var(--color-primary-500);

${Object.entries(g||$d.cool).map(([m,c])=>`--color-gray-${m}: ${Av(c)};`).join(`
`)}
}

.dark {
  --color-primary-DEFAULT: var(--color-primary-400);
}
`}),u={style:[{innerHTML:()=>s.value,tagPriority:-2,id:"nuxt-ui-colors"}]};if(n.isHydrating&&!n.payload.serverRendered){const h=document.createElement("style");h.innerHTML=s.value,h.setAttribute("data-nuxt-ui-colors",""),document.head.appendChild(h),u.script=[{innerHTML:"document.head.removeChild(document.querySelector('[data-nuxt-ui-colors]'))"}]}zA(u)}),AM="$s";function mh(...e){const n=typeof e[e.length-1]=="string"?e.pop():void 0;typeof e[0]!="string"&&e.unshift(n);const[s,u]=e;if(!s||typeof s!="string")throw new TypeError("[nuxt] [useState] key must be a string: "+s);if(u!==void 0&&typeof u!="function")throw new Error("[nuxt] [useState] init must be a function: "+u);const h=AM+s,g=Yi(),m=Qn(g.payload.state,h);if(m.value===void 0&&u){const c=u();if(fr(c))return g.payload.state[h]=c,c;m.value=c}return m}const kM="__NUXT_COLOR_MODE__",MM="nuxt-color-mode",ss=window[kM]||{},LM=_o(e=>{const n=mh("color-mode",()=>Bo({preference:ss.preference,value:ss.value,unknown:!1,forced:!1})).value;Vo().afterEach(h=>{const g=h.meta.colorMode;g&&g!=="system"?(n.value=g,n.forced=!0):(g==="system"&&console.warn("You cannot force the colorMode to system at the page level."),n.forced=!1,n.value=n.preference==="system"?ss.getColorScheme():n.preference)});let s;function u(){s||!window.matchMedia||(s=window.matchMedia("(prefers-color-scheme: dark)"),s.addEventListener("change",()=>{!n.forced&&n.preference==="system"&&(n.value=ss.getColorScheme())}))}Zi(()=>n.preference,h=>{var g;n.forced||(h==="system"?(n.value=ss.getColorScheme(),u()):n.value=h,(g=window.localStorage)==null||g.setItem(MM,h))},{immediate:!0}),Zi(()=>n.value,(h,g)=>{ss.removeColorScheme(g),ss.addColorScheme(h)}),n.preference==="system"&&u(),e.hook("app:mounted",()=>{n.unknown&&(n.preference=ss.preference,n.value=ss.value,n.unknown=!1)}),e.provide("colorMode",n)});function PM(e={}){const n=e.path||window.location.pathname;let s={};try{s=gf(sessionStorage.getItem("nuxt:reload")||"{}")}catch{}if(e.force||(s==null?void 0:s.path)!==n||(s==null?void 0:s.expires)<Date.now()){try{sessionStorage.setItem("nuxt:reload",JSON.stringify({path:n,expires:Date.now()+(e.ttl??1e4)}))}catch{}if(e.persistState)try{sessionStorage.setItem("nuxt:reload:state",JSON.stringify({state:Yi().payload.state}))}catch{}window.location.pathname!==n?window.location.href=n:window.location.reload()}}const zM=_o({name:"nuxt:chunk-reload",setup(e){const n=Vo(),s=fc(),u=new Set;n.beforeEach(()=>{u.clear()}),e.hook("app:chunkError",({error:g})=>{u.add(g)});function h(g){const c="href"in g&&g.href[0]==="#"?s.app.baseURL+g.href:ph(s.app.baseURL,g.fullPath);PM({path:c,persistState:!0})}e.hook("app:manifest:update",()=>{n.beforeResolve(h)}),n.onError((g,m)=>{u.has(g)&&h(m)})}}),DM=[NA,jA,HA,ZA,WA,tk,uk,dk,CM,LM,zM];async function _1(e,n=Vo()){const{path:s,matched:u}=n.resolve(e);if(!u.length||(n._routePreloaded||(n._routePreloaded=new Set),n._routePreloaded.has(s)))return;const h=n._preloadPromises=n._preloadPromises||[];if(h.length>4)return Promise.all(h).then(()=>_1(e,n));n._routePreloaded.add(s);const g=u.map(m=>{var c;return(c=m.components)==null?void 0:c.default}).filter(m=>typeof m=="function");for(const m of g){const c=Promise.resolve(m()).catch(()=>{}).finally(()=>h.splice(h.indexOf(c)));h.push(c)}await Promise.all(h)}const RM=(...e)=>e.find(n=>n!==void 0);function OM(e){const n=e.componentName||"NuxtLink";function s(h,g){if(!h||e.trailingSlash!=="append"&&e.trailingSlash!=="remove")return h;if(typeof h=="string")return kv(h,e.trailingSlash);const m="path"in h&&h.path!==void 0?h.path:g(h).path;return{...h,name:void 0,path:kv(m,e.trailingSlash)}}function u(h){const g=Vo(),m=fc(),c=Ve(()=>!!h.target&&h.target!=="_self"),I=Ve(()=>{const W=h.to||h.href||"";return typeof W=="string"&&ca(W,{acceptRelative:!0})}),M=Nm("RouterLink"),k=M&&typeof M!="string"?M.useLink:void 0,C=Ve(()=>{if(h.external)return!0;const W=h.to||h.href||"";return typeof W=="object"?!1:W===""||I.value}),L=Ve(()=>{const W=h.to||h.href||"";return C.value?W:s(W,g.resolve)}),q=C.value||k==null?void 0:k({...h,to:L}),X=Ve(()=>{var W;if(!L.value||I.value)return L.value;if(C.value){const ae=typeof L.value=="object"?Mv(L.value):L.value;return s(ae,g.resolve)}return typeof L.value=="object"?((W=g.resolve(L.value))==null?void 0:W.href)??null:s(ph(m.app.baseURL,L.value),g.resolve)});return{to:L,hasTarget:c,isAbsoluteUrl:I,isExternal:C,href:X,isActive:(q==null?void 0:q.isActive)??Ve(()=>L.value===g.currentRoute.value.path),isExactActive:(q==null?void 0:q.isExactActive)??Ve(()=>L.value===g.currentRoute.value.path),route:(q==null?void 0:q.route)??Ve(()=>g.resolve(L.value)),async navigate(){await e1(X.value,{replace:h.replace,external:C.value||c.value})}}}return Ri({name:n,props:{to:{type:[String,Object],default:void 0,required:!1},href:{type:[String,Object],default:void 0,required:!1},target:{type:String,default:void 0,required:!1},rel:{type:String,default:void 0,required:!1},noRel:{type:Boolean,default:void 0,required:!1},prefetch:{type:Boolean,default:void 0,required:!1},noPrefetch:{type:Boolean,default:void 0,required:!1},activeClass:{type:String,default:void 0,required:!1},exactActiveClass:{type:String,default:void 0,required:!1},prefetchedClass:{type:String,default:void 0,required:!1},replace:{type:Boolean,default:void 0,required:!1},ariaCurrentValue:{type:String,default:void 0,required:!1},external:{type:Boolean,default:void 0,required:!1},custom:{type:Boolean,default:void 0,required:!1}},useLink:u,setup(h,{slots:g}){const m=Vo(),{to:c,href:I,navigate:M,isExternal:k,hasTarget:C,isAbsoluteUrl:L}=u(h),q=kt(!1),X=kt(null),W=ae=>{var Ie;X.value=h.custom?(Ie=ae==null?void 0:ae.$el)==null?void 0:Ie.nextElementSibling:ae==null?void 0:ae.$el};if(h.prefetch!==!1&&h.noPrefetch!==!0&&h.target!=="_blank"&&!FM()){const Ie=Yi();let ee,H=null;Wr(()=>{const ce=BM();sy(()=>{ee=lg(()=>{var ne;(ne=X==null?void 0:X.value)!=null&&ne.tagName&&(H=ce.observe(X.value,async()=>{H==null||H(),H=null;const oe=typeof c.value=="string"?c.value:k.value?Mv(c.value):m.resolve(c.value).fullPath;await Promise.all([Ie.hooks.callHook("link:prefetch",oe).catch(()=>{}),!k.value&&!C.value&&_1(c.value,m).catch(()=>{})]),q.value=!0}))})})}),Bf(()=>{ee&&GA(ee),H==null||H(),H=null})}return()=>{var ee;if(!k.value&&!C.value){const H={ref:W,to:c.value,activeClass:h.activeClass||e.activeClass,exactActiveClass:h.exactActiveClass||e.exactActiveClass,replace:h.replace,ariaCurrentValue:h.ariaCurrentValue,custom:h.custom};return h.custom||(q.value&&(H.class=h.prefetchedClass||e.prefetchedClass),H.rel=h.rel||void 0),Nn(Nm("RouterLink"),H,g.default)}const ae=h.target||null,Ie=RM(h.noRel?"":h.rel,e.externalRelAttribute,L.value||C.value?"noopener noreferrer":"")||null;return h.custom?g.default?g.default({href:I.value,navigate:M,get route(){if(!I.value)return;const H=new URL(I.value,window.location.href);return{path:H.pathname,fullPath:H.pathname,get query(){return Xg(H.search)},hash:H.hash,params:{},name:void 0,matched:[],redirectedFrom:void 0,meta:{},href:I.value}},rel:Ie,target:ae,isExternal:k.value||C.value,isActive:!1,isExactActive:!1}):null:Nn("a",{ref:X,href:I.value||null,rel:Ie,target:ae},(ee=g.default)==null?void 0:ee.call(g))}}})}const v1=OM(xC);function kv(e,n){const s=n==="append"?_f:$f;return ca(e)&&!e.startsWith("http")?e:s(e,!0)}function BM(){const e=Yi();if(e._observer)return e._observer;let n=null;const s=new Map,u=(g,m)=>(n||(n=new IntersectionObserver(c=>{for(const I of c){const M=s.get(I.target);(I.isIntersecting||I.intersectionRatio>0)&&M&&M()}})),s.set(g,m),n.observe(g),()=>{s.delete(g),n.unobserve(g),s.size===0&&(n.disconnect(),n=null)});return e._observer={observe:u}}function FM(){const e=navigator.connection;return!!(e&&(e.saveData||/2g/.test(e.effectiveType)))}function Mv(e){return Jg(e.path||"",e.query||{})+(e.hash?"#"+e.hash:"")}const ra=(e,n,s,u,h=!1)=>{const g=QS(),m=qf(),c=Ve(()=>{var L;const M=dm(n),k=dm(s),C=dm(u);return ys((M==null?void 0:M.strategy)||((L=m.ui)==null?void 0:L.strategy),C?{wrapper:C}:{},M||{},h?y1(m.ui,e,{}):{},k||{})}),I=Ve(()=>Zk(g,["class"]));return{ui:c,attrs:I}};function Hf({ui:e,props:n}){const s=la();if(aa("ButtonGroupContextConsumer",!0),Zr("ButtonGroupContextConsumer",!1))return{size:Ve(()=>n.size),rounded:Ve(()=>e.value.rounded)};let h=s.parent,g;for(;h&&!g;){if(h.type.name==="ButtonGroup"){g=Zr(`group-${h.uid}`);break}h=h.parent}const m=Ve(()=>g==null?void 0:g.value.children.indexOf(s));return Wr(()=>{g==null||g.value.register(s)}),sa(()=>{g==null||g.value.unregister(s)}),{size:Ve(()=>(g==null?void 0:g.value.size)||n.size),rounded:Ve(()=>!g||m.value===-1?e.value.rounded:g.value.children.length===1?g.value.ui.rounded:m.value===0?g.value.rounded.start:m.value===g.value.children.length-1?g.value.rounded.end:"rounded-none")}}const VM={wrapper:"relative inline-flex items-center justify-center flex-shrink-0",background:"bg-gray-100 dark:bg-gray-800",rounded:"rounded-full",text:"font-medium leading-none text-gray-900 dark:text-white truncate",placeholder:"font-medium leading-none text-gray-500 dark:text-gray-400 truncate",size:{"3xs":"h-4 w-4 text-[8px]","2xs":"h-5 w-5 text-[10px]",xs:"h-6 w-6 text-xs",sm:"h-8 w-8 text-sm",md:"h-10 w-10 text-base",lg:"h-12 w-12 text-lg",xl:"h-14 w-14 text-xl","2xl":"h-16 w-16 text-2xl","3xl":"h-20 w-20 text-3xl"},chip:{base:"absolute rounded-full ring-1 ring-white dark:ring-gray-900 flex items-center justify-center text-white dark:text-gray-900 font-medium",background:"bg-{color}-500 dark:bg-{color}-400",position:{"top-right":"top-0 right-0","bottom-right":"bottom-0 right-0","top-left":"top-0 left-0","bottom-left":"bottom-0 left-0"},size:{"3xs":"h-[4px] min-w-[4px] text-[4px] p-px","2xs":"h-[5px] min-w-[5px] text-[5px] p-px",xs:"h-1.5 min-w-[0.375rem] text-[6px] p-px",sm:"h-2 min-w-[0.5rem] text-[7px] p-0.5",md:"h-2.5 min-w-[0.625rem] text-[8px] p-0.5",lg:"h-3 min-w-[0.75rem] text-[10px] p-0.5",xl:"h-3.5 min-w-[0.875rem] text-[11px] p-1","2xl":"h-4 min-w-[1rem] text-[12px] p-1","3xl":"h-5 min-w-[1.25rem] text-[14px] p-1"}},icon:{base:"text-gray-500 dark:text-gray-400 flex-shrink-0",size:{"3xs":"h-2 w-2","2xs":"h-2.5 w-2.5",xs:"h-3 w-3",sm:"h-4 w-4",md:"h-5 w-5",lg:"h-6 w-6",xl:"h-7 w-7","2xl":"h-8 w-8","3xl":"h-10 w-10"}},default:{size:"sm",icon:null,chipColor:null,chipPosition:"top-right"}},NM={base:"inline-flex items-center",rounded:"rounded-md",font:"font-medium",size:{xs:"text-xs px-1.5 py-0.5",sm:"text-xs px-2 py-1",md:"text-sm px-2 py-1",lg:"text-sm px-2.5 py-1.5"},color:{white:{solid:"ring-1 ring-inset ring-gray-300 dark:ring-gray-700 text-gray-900 dark:text-white bg-white dark:bg-gray-900"},gray:{solid:"ring-1 ring-inset ring-gray-300 dark:ring-gray-700 text-gray-700 dark:text-gray-200 bg-gray-50 dark:bg-gray-800"},black:{solid:"text-white dark:text-gray-900 bg-gray-900 dark:bg-white"}},variant:{solid:"bg-{color}-500 dark:bg-{color}-400 text-white dark:text-gray-900",outline:"text-{color}-500 dark:text-{color}-400 ring-1 ring-inset ring-{color}-500 dark:ring-{color}-400",soft:"bg-{color}-50 dark:bg-{color}-400 dark:bg-opacity-10 text-{color}-500 dark:text-{color}-400",subtle:"bg-{color}-50 dark:bg-{color}-400 dark:bg-opacity-10 text-{color}-500 dark:text-{color}-400 ring-1 ring-inset ring-{color}-500 dark:ring-{color}-400 ring-opacity-25 dark:ring-opacity-25"},default:{size:"sm",variant:"solid",color:"primary"}},$M={base:"focus:outline-none focus-visible:outline-0 disabled:cursor-not-allowed disabled:opacity-75 flex-shrink-0",font:"font-medium",rounded:"rounded-md",truncate:"text-left break-all line-clamp-1",block:"w-full flex justify-center items-center",inline:"inline-flex items-center",size:{"2xs":"text-xs",xs:"text-xs",sm:"text-sm",md:"text-sm",lg:"text-sm",xl:"text-base"},gap:{"2xs":"gap-x-1",xs:"gap-x-1.5",sm:"gap-x-1.5",md:"gap-x-2",lg:"gap-x-2.5",xl:"gap-x-2.5"},padding:{"2xs":"px-2 py-1",xs:"px-2.5 py-1.5",sm:"px-2.5 py-1.5",md:"px-3 py-2",lg:"px-3.5 py-2.5",xl:"px-3.5 py-2.5"},square:{"2xs":"p-1",xs:"p-1.5",sm:"p-1.5",md:"p-2",lg:"p-2.5",xl:"p-2.5"},color:{white:{solid:"shadow-sm ring-1 ring-inset ring-gray-300 dark:ring-gray-700 text-gray-900 dark:text-white bg-white hover:bg-gray-50 disabled:bg-white dark:bg-gray-900 dark:hover:bg-gray-800/50 dark:disabled:bg-gray-900 focus-visible:ring-2 focus-visible:ring-primary-500 dark:focus-visible:ring-primary-400",ghost:"text-gray-900 dark:text-white hover:bg-white dark:hover:bg-gray-900 focus-visible:ring-inset focus-visible:ring-2 focus-visible:ring-primary-500 dark:focus-visible:ring-primary-400"},gray:{solid:"shadow-sm ring-1 ring-inset ring-gray-300 dark:ring-gray-700 text-gray-700 dark:text-gray-200 bg-gray-50 hover:bg-gray-100 disabled:bg-gray-50 dark:bg-gray-800 dark:hover:bg-gray-700/50 dark:disabled:bg-gray-800 focus-visible:ring-2 focus-visible:ring-primary-500 dark:focus-visible:ring-primary-400",ghost:"text-gray-700 dark:text-gray-200 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-800 focus-visible:ring-inset focus-visible:ring-2 focus-visible:ring-primary-500 dark:focus-visible:ring-primary-400",link:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 underline-offset-4 hover:underline focus-visible:ring-inset focus-visible:ring-2 focus-visible:ring-primary-500 dark:focus-visible:ring-primary-400"},black:{solid:"shadow-sm text-white dark:text-gray-900 bg-gray-900 hover:bg-gray-800 disabled:bg-gray-900 dark:bg-white dark:hover:bg-gray-100 dark:disabled:bg-white focus-visible:ring-inset focus-visible:ring-2 focus-visible:ring-primary-500 dark:focus-visible:ring-primary-400",link:"text-gray-900 dark:text-white underline-offset-4 hover:underline focus-visible:ring-inset focus-visible:ring-2 focus-visible:ring-primary-500 dark:focus-visible:ring-primary-400"}},variant:{solid:"shadow-sm text-white dark:text-gray-900 bg-{color}-500 hover:bg-{color}-600 disabled:bg-{color}-500 dark:bg-{color}-400 dark:hover:bg-{color}-500 dark:disabled:bg-{color}-400 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-{color}-500 dark:focus-visible:outline-{color}-400",outline:"ring-1 ring-inset ring-current text-{color}-500 dark:text-{color}-400 hover:bg-{color}-50 disabled:bg-transparent dark:hover:bg-{color}-950 dark:disabled:bg-transparent focus-visible:ring-2 focus-visible:ring-{color}-500 dark:focus-visible:ring-{color}-400",soft:"text-{color}-500 dark:text-{color}-400 bg-{color}-50 hover:bg-{color}-100 disabled:bg-{color}-50 dark:bg-{color}-950 dark:hover:bg-{color}-900 dark:disabled:bg-{color}-950 focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-{color}-500 dark:focus-visible:ring-{color}-400",ghost:"text-{color}-500 dark:text-{color}-400 hover:bg-{color}-50 disabled:bg-transparent dark:hover:bg-{color}-950 dark:disabled:bg-transparent focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-{color}-500 dark:focus-visible:ring-{color}-400",link:"text-{color}-500 hover:text-{color}-600 disabled:text-{color}-500 dark:text-{color}-400 dark:hover:text-{color}-500 dark:disabled:text-{color}-400 underline-offset-4 hover:underline focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-{color}-500 dark:focus-visible:ring-{color}-400"},icon:{base:"flex-shrink-0",loading:"animate-spin",size:{"2xs":"h-4 w-4",xs:"h-4 w-4",sm:"h-5 w-5",md:"h-5 w-5",lg:"h-5 w-5",xl:"h-6 w-6"}},default:{size:"sm",variant:"solid",color:"primary",loadingIcon:"i-heroicons-arrow-path-20-solid"}},x1={base:"invisible before:visible before:block before:rotate-45 before:z-[-1] before:w-2 before:h-2",ring:"before:ring-1 before:ring-gray-200 dark:before:ring-gray-800",rounded:"before:rounded-sm",background:"before:bg-gray-200 dark:before:bg-gray-800",shadow:"before:shadow",placement:"group-data-[popper-placement*='right']:-left-1 group-data-[popper-placement*='left']:-right-1 group-data-[popper-placement*='top']:-bottom-1 group-data-[popper-placement*='bottom']:-top-1"},cy={wrapper:"relative",base:"relative block w-full disabled:cursor-not-allowed disabled:opacity-75 focus:outline-none border-0",form:"form-input",rounded:"rounded-md",placeholder:"placeholder-gray-400 dark:placeholder-gray-500",file:{base:"file:mr-1.5 file:font-medium file:text-gray-500 dark:file:text-gray-400 file:bg-transparent file:border-0 file:p-0 file:outline-none"},size:{"2xs":"text-xs",xs:"text-xs",sm:"text-sm",md:"text-sm",lg:"text-sm",xl:"text-base"},gap:{"2xs":"gap-x-1",xs:"gap-x-1.5",sm:"gap-x-1.5",md:"gap-x-2",lg:"gap-x-2.5",xl:"gap-x-2.5"},padding:{"2xs":"px-2 py-1",xs:"px-2.5 py-1.5",sm:"px-2.5 py-1.5",md:"px-3 py-2",lg:"px-3.5 py-2.5",xl:"px-3.5 py-2.5"},leading:{padding:{"2xs":"ps-7",xs:"ps-8",sm:"ps-9",md:"ps-10",lg:"ps-11",xl:"ps-12"}},trailing:{padding:{"2xs":"pe-7",xs:"pe-8",sm:"pe-9",md:"pe-10",lg:"pe-11",xl:"pe-12"}},color:{white:{outline:"shadow-sm bg-white dark:bg-gray-900 text-gray-900 dark:text-white ring-1 ring-inset ring-gray-300 dark:ring-gray-700 focus:ring-2 focus:ring-primary-500 dark:focus:ring-primary-400"},gray:{outline:"shadow-sm bg-gray-50 dark:bg-gray-800 text-gray-900 dark:text-white ring-1 ring-inset ring-gray-300 dark:ring-gray-700 focus:ring-2 focus:ring-primary-500 dark:focus:ring-primary-400"}},variant:{outline:"shadow-sm bg-transparent text-gray-900 dark:text-white ring-1 ring-inset ring-{color}-500 dark:ring-{color}-400 focus:ring-2 focus:ring-{color}-500 dark:focus:ring-{color}-400",none:"bg-transparent focus:ring-0 focus:shadow-none"},icon:{base:"flex-shrink-0 text-gray-400 dark:text-gray-500",color:"text-{color}-500 dark:text-{color}-400",loading:"animate-spin",size:{"2xs":"h-4 w-4",xs:"h-4 w-4",sm:"h-5 w-5",md:"h-5 w-5",lg:"h-5 w-5",xl:"h-6 w-6"},leading:{wrapper:"absolute inset-y-0 start-0 flex items-center",pointer:"pointer-events-none",padding:{"2xs":"px-2",xs:"px-2.5",sm:"px-2.5",md:"px-3",lg:"px-3.5",xl:"px-3.5"}},trailing:{wrapper:"absolute inset-y-0 end-0 flex items-center",pointer:"pointer-events-none",padding:{"2xs":"px-2",xs:"px-2.5",sm:"px-2.5",md:"px-3",lg:"px-3.5",xl:"px-3.5"}}},default:{size:"sm",color:"white",variant:"outline",loadingIcon:"i-heroicons-arrow-path-20-solid"}},Lv={container:"z-20 group",trigger:"flex items-center w-full",width:"w-full",height:"max-h-60",base:"relative focus:outline-none overflow-y-auto scroll-py-1",background:"bg-white dark:bg-gray-800",shadow:"shadow-lg",rounded:"rounded-md",padding:"p-1",ring:"ring-1 ring-gray-200 dark:ring-gray-700",empty:"text-sm text-gray-400 dark:text-gray-500 px-2 py-1.5",option:{base:"cursor-default select-none relative flex items-center justify-between gap-1",rounded:"rounded-md",padding:"px-1.5 py-1.5",size:"text-sm",color:"text-gray-900 dark:text-white",container:"flex items-center gap-1.5 min-w-0",active:"bg-gray-100 dark:bg-gray-900",inactive:"",selected:"pe-7",disabled:"cursor-not-allowed opacity-50",empty:"text-sm text-gray-400 dark:text-gray-500 px-2 py-1.5",icon:{base:"flex-shrink-0 h-5 w-5",active:"text-gray-900 dark:text-white",inactive:"text-gray-400 dark:text-gray-500"},selectedIcon:{wrapper:"absolute inset-y-0 end-0 flex items-center",padding:"pe-2",base:"h-5 w-5 text-gray-900 dark:text-white flex-shrink-0"},avatar:{base:"flex-shrink-0",size:"2xs"},chip:{base:"flex-shrink-0 w-2 h-2 mx-1 rounded-full"}},transition:{leaveActiveClass:"transition ease-in duration-100",leaveFromClass:"opacity-100",leaveToClass:"opacity-0"},popper:{placement:"bottom-end"},default:{selectedIcon:"i-heroicons-check-20-solid",trailingIcon:"i-heroicons-chevron-down-20-solid"},arrow:{...x1,ring:"before:ring-1 before:ring-gray-200 dark:before:ring-gray-700",background:"before:bg-white dark:before:bg-gray-700"}};({...cy});const jM={...cy,form:"form-select",placeholder:"text-gray-400 dark:text-gray-500",default:{size:"sm",color:"white",variant:"outline",loadingIcon:"i-heroicons-arrow-path-20-solid",trailingIcon:"i-heroicons-chevron-down-20-solid"}},UM={...Lv,select:"inline-flex items-center text-left cursor-default",input:"block w-[calc(100%+0.5rem)] focus:ring-transparent text-sm px-3 py-1.5 text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-800 border-0 border-b border-gray-200 dark:border-gray-700 sticky -top-1 -mt-1 mb-1 -mx-1 z-10 placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none",required:"absolute inset-0 w-px opacity-0 cursor-default",label:"block truncate",option:{...Lv.option,create:"block truncate"},transition:{leaveActiveClass:"transition ease-in duration-100",leaveFromClass:"opacity-100",leaveToClass:"opacity-0"},popper:{placement:"bottom-end"},default:{selectedIcon:"i-heroicons-check-20-solid",clearSearchOnClose:!1,showCreateOptionWhen:"empty"},arrow:{...x1,ring:"before:ring-1 before:ring-gray-200 dark:before:ring-gray-700",background:"before:bg-white dark:before:bg-gray-700"}},qM={wrapper:"w-full pointer-events-auto",container:"relative overflow-hidden",inner:"w-0 flex-1",title:"text-sm font-medium text-gray-900 dark:text-white",description:"mt-1 text-sm leading-4 text-gray-500 dark:text-gray-400",actions:"flex items-center gap-2 mt-3 flex-shrink-0",background:"bg-white dark:bg-gray-900",shadow:"shadow-lg",rounded:"rounded-lg",padding:"p-4",gap:"gap-3",ring:"ring-1 ring-gray-200 dark:ring-gray-800",icon:{base:"flex-shrink-0 w-5 h-5",color:"text-{color}-500 dark:text-{color}-400"},avatar:{base:"flex-shrink-0 self-center",size:"md"},progress:{base:"absolute bottom-0 end-0 start-0 h-1",background:"bg-{color}-500 dark:bg-{color}-400"},transition:{enterActiveClass:"transform ease-out duration-300 transition",enterFromClass:"translate-y-2 opacity-0 sm:translate-y-0 sm:translate-x-2",enterToClass:"translate-y-0 opacity-100 sm:translate-x-0",leaveActiveClass:"transition ease-in duration-100",leaveFromClass:"opacity-100",leaveToClass:"opacity-0"},default:{color:"primary",icon:null,timeout:5e3,closeButton:{icon:"i-heroicons-x-mark-20-solid",color:"gray",variant:"link",padded:!1},actionButton:{size:"xs",color:"white"}}},HM={wrapper:"fixed flex flex-col justify-end z-[55]",position:"bottom-0 end-0",width:"w-full sm:w-96",container:"px-4 sm:px-6 py-6 space-y-3 overflow-y-auto"},jn=(e,n)=>{const s=e.__vccOpts||e;for(const[u,h]of n)s[u]=h;return s},Ws=ys(Di.ui.strategy,Di.ui.badge,NM),GM=Ri({inheritAttrs:!1,props:{size:{type:String,default:()=>Ws.default.size,validator(e){return Object.keys(Ws.size).includes(e)}},color:{type:String,default:()=>Ws.default.color,validator(e){return[...Di.ui.colors,...Object.keys(Ws.color)].includes(e)}},variant:{type:String,default:()=>Ws.default.variant,validator(e){return[...Object.keys(Ws.variant),...Object.values(Ws.color).flatMap(n=>Object.keys(n))].includes(e)}},label:{type:[String,Number],default:null},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},setup(e){const{ui:n,attrs:s}=ra("badge",Qn(e,"ui"),Ws),{size:u,rounded:h}=Hf({ui:n,props:e}),g=Ve(()=>{var c,I;const m=((I=(c=n.value.color)==null?void 0:c[e.color])==null?void 0:I[e.variant])||n.value.variant[e.variant];return fs(tr(n.value.base,n.value.font,h.value,n.value.size[u.value],m==null?void 0:m.replaceAll("{color}",e.color)),e.class)});return{attrs:s,badgeClass:g}}});function ZM(e,n,s,u,h,g){return _t(),ri("span",br({class:e.badgeClass},e.attrs),[sr(e.$slots,"default",{},()=>[mo(Ur(e.label),1)])],16)}const b1=jn(GM,[["render",ZM]]),w1=Object.freeze({left:0,top:0,width:16,height:16}),E1=Object.freeze({rotate:0,vFlip:!1,hFlip:!1}),uy=Object.freeze({...w1,...E1});Object.freeze({...uy,body:"",hidden:!1});({...w1});const S1=Object.freeze({width:null,height:null}),I1=Object.freeze({...S1,...E1});function WM(e,n){const s={...e};for(const u in n){const h=n[u],g=typeof h;u in S1?(h===null||h&&(g==="string"||g==="number"))&&(s[u]=h):g===typeof s[u]&&(s[u]=u==="rotate"?h%4:h)}return s}const KM=/[\s,]+/;function XM(e,n){n.split(KM).forEach(s=>{switch(s.trim()){case"horizontal":e.hFlip=!0;break;case"vertical":e.vFlip=!0;break}})}function JM(e,n=0){const s=e.replace(/^-?[0-9.]*/,"");function u(h){for(;h<0;)h+=4;return h%4}if(s===""){const h=parseInt(e);return isNaN(h)?0:u(h)}else if(s!==e){let h=0;switch(s){case"%":h=25;break;case"deg":h=90}if(h){let g=parseFloat(e.slice(0,e.length-s.length));return isNaN(g)?0:(g=g/h,g%1===0?u(g):0)}}return n}const YM=/(-?[0-9.]*[0-9]+[0-9.]*)/g,QM=/^-?[0-9.]*[0-9]+[0-9.]*$/g;function Pv(e,n,s){if(n===1)return e;if(s=s||100,typeof e=="number")return Math.ceil(e*n*s)/s;if(typeof e!="string")return e;const u=e.split(YM);if(u===null||!u.length)return e;const h=[];let g=u.shift(),m=QM.test(g);for(;;){if(m){const c=parseFloat(g);isNaN(c)?h.push(g):h.push(Math.ceil(c*n*s)/s)}else h.push(g);if(g=u.shift(),g===void 0)return h.join("");m=!m}}function eL(e,n="defs"){let s="";const u=e.indexOf("<"+n);for(;u>=0;){const h=e.indexOf(">",u),g=e.indexOf("</"+n);if(h===-1||g===-1)break;const m=e.indexOf(">",g);if(m===-1)break;s+=e.slice(h+1,g).trim(),e=e.slice(0,u).trim()+e.slice(m+1)}return{defs:s,content:e}}function tL(e,n){return e?"<defs>"+e+"</defs>"+n:n}function iL(e,n,s){const u=eL(e);return tL(u.defs,n+u.content+s)}const rL=e=>e==="unset"||e==="undefined"||e==="none";function nL(e,n){const s={...uy,...e},u={...I1,...n},h={left:s.left,top:s.top,width:s.width,height:s.height};let g=s.body;[s,u].forEach(W=>{const ae=[],Ie=W.hFlip,ee=W.vFlip;let H=W.rotate;Ie?ee?H+=2:(ae.push("translate("+(h.width+h.left).toString()+" "+(0-h.top).toString()+")"),ae.push("scale(-1 1)"),h.top=h.left=0):ee&&(ae.push("translate("+(0-h.left).toString()+" "+(h.height+h.top).toString()+")"),ae.push("scale(1 -1)"),h.top=h.left=0);let ce;switch(H<0&&(H-=Math.floor(H/4)*4),H=H%4,H){case 1:ce=h.height/2+h.top,ae.unshift("rotate(90 "+ce.toString()+" "+ce.toString()+")");break;case 2:ae.unshift("rotate(180 "+(h.width/2+h.left).toString()+" "+(h.height/2+h.top).toString()+")");break;case 3:ce=h.width/2+h.left,ae.unshift("rotate(-90 "+ce.toString()+" "+ce.toString()+")");break}H%2===1&&(h.left!==h.top&&(ce=h.left,h.left=h.top,h.top=ce),h.width!==h.height&&(ce=h.width,h.width=h.height,h.height=ce)),ae.length&&(g=iL(g,'<g transform="'+ae.join(" ")+'">',"</g>"))});const m=u.width,c=u.height,I=h.width,M=h.height;let k,C;m===null?(C=c===null?"1em":c==="auto"?M:c,k=Pv(C,I/M)):(k=m==="auto"?I:m,C=c===null?Pv(k,M/I):c==="auto"?M:c);const L={},q=(W,ae)=>{rL(ae)||(L[W]=ae.toString())};q("width",k),q("height",C);const X=[h.left,h.top,I,M];return L.viewBox=X.join(" "),{attributes:L,viewBox:X,body:g}}const oL=/\sid="(\S+)"/g,sL="IconifyId"+Date.now().toString(16)+(Math.random()*16777216|0).toString(16);let aL=0;function lL(e,n=sL){const s=[];let u;for(;u=oL.exec(e);)s.push(u[1]);if(!s.length)return e;const h="suffix"+(Math.random()*16777216|Date.now()).toString(16);return s.forEach(g=>{const m=typeof n=="function"?n(g):n+(aL++).toString(),c=g.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");e=e.replace(new RegExp('([#;"])('+c+')([")]|\\.[a-z])',"g"),"$1"+m+h+"$3")}),e=e.replace(new RegExp(h,"g"),""),e}function cL(e,n){let s=e.indexOf("xlink:")===-1?"":' xmlns:xlink="http://www.w3.org/1999/xlink"';for(const u in n)s+=" "+u+'="'+n[u]+'"';return'<svg xmlns="http://www.w3.org/2000/svg"'+s+">"+e+"</svg>"}function uL(e){return e.replace(/"/g,"'").replace(/%/g,"%25").replace(/#/g,"%23").replace(/</g,"%3C").replace(/>/g,"%3E").replace(/\s+/g," ")}function hL(e){return"data:image/svg+xml,"+uL(e)}function dL(e){return'url("'+hL(e)+'")'}const zv={...I1,inline:!1},fL={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":!0,role:"img"},pL={display:"inline-block"},mg={backgroundColor:"currentColor"},T1={backgroundColor:"transparent"},Dv={Image:"var(--svg)",Repeat:"no-repeat",Size:"100% 100%"},Rv={webkitMask:mg,mask:mg,background:T1};for(const e in Rv){const n=Rv[e];for(const s in Dv)n[e+s]=Dv[s]}const Qd={};["horizontal","vertical"].forEach(e=>{const n=e.slice(0,1)+"Flip";Qd[e+"-flip"]=n,Qd[e.slice(0,1)+"-flip"]=n,Qd[e+"Flip"]=n});function Ov(e){return e+(e.match(/^[-0-9.]+$/)?"px":"")}const mL=(e,n)=>{const s=WM(zv,n),u={...fL},h=n.mode||"svg",g={},m=n.style,c=typeof m=="object"&&!(m instanceof Array)?m:{};for(let W in n){const ae=n[W];if(ae!==void 0)switch(W){case"icon":case"style":case"onLoad":case"mode":break;case"inline":case"hFlip":case"vFlip":s[W]=ae===!0||ae==="true"||ae===1;break;case"flip":typeof ae=="string"&&XM(s,ae);break;case"color":g.color=ae;break;case"rotate":typeof ae=="string"?s[W]=JM(ae):typeof ae=="number"&&(s[W]=ae);break;case"ariaHidden":case"aria-hidden":ae!==!0&&ae!=="true"&&delete u["aria-hidden"];break;default:{const Ie=Qd[W];Ie?(ae===!0||ae==="true"||ae===1)&&(s[Ie]=!0):zv[W]===void 0&&(u[W]=ae)}}}const I=nL(e,s),M=I.attributes;if(s.inline&&(g.verticalAlign="-0.125em"),h==="svg"){u.style={...g,...c},Object.assign(u,M);let W=0,ae=n.id;return typeof ae=="string"&&(ae=ae.replace(/-/g,"_")),u.innerHTML=lL(I.body,ae?()=>ae+"ID"+W++:"iconifyVue"),Nn("svg",u)}const{body:k,width:C,height:L}=e,q=h==="mask"||(h==="bg"?!1:k.indexOf("currentColor")!==-1),X=cL(k,{...M,width:C+"",height:L+""});return u.style={...g,"--svg":dL(X),width:Ov(M.width),height:Ov(M.height),...pL,...q?mg:T1,...c},Nn("span",u)},gL=Object.create(null),yL=Ri({inheritAttrs:!1,render(){const e=this.$attrs,n=e.icon,s=typeof n=="string"?gL[n]:typeof n=="object"?n:null;return s===null||typeof s!="object"||typeof s.body!="string"?this.$slots.default?this.$slots.default():null:mL({...uy,...s},e)}}),Xu=/^[a-z0-9]+(-[a-z0-9]+)*$/,Gf=(e,n,s,u="")=>{const h=e.split(":");if(e.slice(0,1)==="@"){if(h.length<2||h.length>3)return null;u=h.shift().slice(1)}if(h.length>3||!h.length)return null;if(h.length>1){const c=h.pop(),I=h.pop(),M={provider:h.length>0?h[0]:u,prefix:I,name:c};return n&&!ef(M)?null:M}const g=h[0],m=g.split("-");if(m.length>1){const c={provider:u,prefix:m.shift(),name:m.join("-")};return n&&!ef(c)?null:c}if(s&&u===""){const c={provider:u,prefix:"",name:g};return n&&!ef(c,s)?null:c}return null},ef=(e,n)=>e?!!((e.provider===""||e.provider.match(Xu))&&(n&&e.prefix===""||e.prefix.match(Xu))&&e.name.match(Xu)):!1,C1=Object.freeze({left:0,top:0,width:16,height:16}),If=Object.freeze({rotate:0,vFlip:!1,hFlip:!1}),hy=Object.freeze({...C1,...If}),gg=Object.freeze({...hy,body:"",hidden:!1});function _L(e,n){const s={};!e.hFlip!=!n.hFlip&&(s.hFlip=!0),!e.vFlip!=!n.vFlip&&(s.vFlip=!0);const u=((e.rotate||0)+(n.rotate||0))%4;return u&&(s.rotate=u),s}function Bv(e,n){const s=_L(e,n);for(const u in gg)u in If?u in e&&!(u in s)&&(s[u]=If[u]):u in n?s[u]=n[u]:u in e&&(s[u]=e[u]);return s}function vL(e,n){const s=e.icons,u=e.aliases||Object.create(null),h=Object.create(null);function g(m){if(s[m])return h[m]=[];if(!(m in h)){h[m]=null;const c=u[m]&&u[m].parent,I=c&&g(c);I&&(h[m]=[c].concat(I))}return h[m]}return Object.keys(s).concat(Object.keys(u)).forEach(g),h}function xL(e,n,s){const u=e.icons,h=e.aliases||Object.create(null);let g={};function m(c){g=Bv(u[c]||h[c],g)}return m(n),s.forEach(m),Bv(e,g)}function A1(e,n){const s=[];if(typeof e!="object"||typeof e.icons!="object")return s;e.not_found instanceof Array&&e.not_found.forEach(h=>{n(h,null),s.push(h)});const u=vL(e);for(const h in u){const g=u[h];g&&(n(h,xL(e,h,g)),s.push(h))}return s}const bL={provider:"",aliases:{},not_found:{},...C1};function Tm(e,n){for(const s in n)if(s in e&&typeof e[s]!=typeof n[s])return!1;return!0}function k1(e){if(typeof e!="object"||e===null)return null;const n=e;if(typeof n.prefix!="string"||!e.icons||typeof e.icons!="object"||!Tm(e,bL))return null;const s=n.icons;for(const h in s){const g=s[h];if(!h.match(Xu)||typeof g.body!="string"||!Tm(g,gg))return null}const u=n.aliases||Object.create(null);for(const h in u){const g=u[h],m=g.parent;if(!h.match(Xu)||typeof m!="string"||!s[m]&&!u[m]||!Tm(g,gg))return null}return n}const Fv=Object.create(null);function wL(e,n){return{provider:e,prefix:n,icons:Object.create(null),missing:new Set}}function Ja(e,n){const s=Fv[e]||(Fv[e]=Object.create(null));return s[n]||(s[n]=wL(e,n))}function dy(e,n){return k1(n)?A1(n,(s,u)=>{u?e.icons[s]=u:e.missing.add(s)}):[]}function EL(e,n,s){try{if(typeof s.body=="string")return e.icons[n]={...s},!0}catch{}return!1}let lh=!1;function M1(e){return typeof e=="boolean"&&(lh=e),lh}function SL(e){const n=typeof e=="string"?Gf(e,!0,lh):e;if(n){const s=Ja(n.provider,n.prefix),u=n.name;return s.icons[u]||(s.missing.has(u)?null:void 0)}}function IL(e,n){const s=Gf(e,!0,lh);if(!s)return!1;const u=Ja(s.provider,s.prefix);return EL(u,s.name,n)}function TL(e,n){if(typeof e!="object")return!1;if(typeof n!="string"&&(n=e.provider||""),lh&&!n&&!e.prefix){let h=!1;return k1(e)&&(e.prefix="",A1(e,(g,m)=>{m&&IL(g,m)&&(h=!0)})),h}const s=e.prefix;if(!ef({provider:n,prefix:s,name:"a"}))return!1;const u=Ja(n,s);return!!dy(u,e)}const CL=Object.freeze({width:null,height:null}),AL=Object.freeze({...CL,...If});""+Date.now().toString(16)+(Math.random()*16777216|0).toString(16);const yg=Object.create(null);function kL(e,n){yg[e]=n}function _g(e){return yg[e]||yg[""]}function fy(e){let n;if(typeof e.resources=="string")n=[e.resources];else if(n=e.resources,!(n instanceof Array)||!n.length)return null;return{resources:n,path:e.path||"/",maxURL:e.maxURL||500,rotate:e.rotate||750,timeout:e.timeout||5e3,random:e.random===!0,index:e.index||0,dataAfterTimeout:e.dataAfterTimeout!==!1}}const py=Object.create(null),Ru=["https://api.simplesvg.com","https://api.unisvg.com"],tf=[];for(;Ru.length>0;)Ru.length===1||Math.random()>.5?tf.push(Ru.shift()):tf.push(Ru.pop());py[""]=fy({resources:["https://api.iconify.design"].concat(tf)});function vg(e,n){const s=fy(n);return s===null?!1:(py[e]=s,!0)}function my(e){return py[e]}const ML=()=>{let e;try{if(e=fetch,typeof e=="function")return e}catch{}};let Vv=ML();function LL(e,n){const s=my(e);if(!s)return 0;let u;if(!s.maxURL)u=0;else{let h=0;s.resources.forEach(m=>{h=Math.max(h,m.length)});const g=n+".json?icons=";u=s.maxURL-h-s.path.length-g.length}return u}function PL(e){return e===404}const zL=(e,n,s)=>{const u=[],h=LL(e,n),g="icons";let m={type:g,provider:e,prefix:n,icons:[]},c=0;return s.forEach((I,M)=>{c+=I.length+1,c>=h&&M>0&&(u.push(m),m={type:g,provider:e,prefix:n,icons:[]},c=I.length),m.icons.push(I)}),u.push(m),u};function DL(e){if(typeof e=="string"){const n=my(e);if(n)return n.path}return"/"}const RL=(e,n,s)=>{if(!Vv){s("abort",424);return}let u=DL(n.provider);switch(n.type){case"icons":{const g=n.prefix,c=n.icons.join(","),I=new URLSearchParams({icons:c});u+=g+".json?"+I.toString();break}case"custom":{const g=n.uri;u+=g.slice(0,1)==="/"?g.slice(1):g;break}default:s("abort",400);return}let h=503;Vv(e+u).then(g=>{const m=g.status;if(m!==200){setTimeout(()=>{s(PL(m)?"abort":"next",m)});return}return h=501,g.json()}).then(g=>{if(typeof g!="object"||g===null){setTimeout(()=>{g===404?s("abort",g):s("next",h)});return}setTimeout(()=>{s("success",g)})}).catch(()=>{s("next",h)})},OL={prepare:zL,send:RL};function BL(e){const n={loaded:[],missing:[],pending:[]},s=Object.create(null);e.sort((h,g)=>h.provider!==g.provider?h.provider.localeCompare(g.provider):h.prefix!==g.prefix?h.prefix.localeCompare(g.prefix):h.name.localeCompare(g.name));let u={provider:"",prefix:"",name:""};return e.forEach(h=>{if(u.name===h.name&&u.prefix===h.prefix&&u.provider===h.provider)return;u=h;const g=h.provider,m=h.prefix,c=h.name,I=s[g]||(s[g]=Object.create(null)),M=I[m]||(I[m]=Ja(g,m));let k;c in M.icons?k=n.loaded:m===""||M.missing.has(c)?k=n.missing:k=n.pending;const C={provider:g,prefix:m,name:c};k.push(C)}),n}function L1(e,n){e.forEach(s=>{const u=s.loaderCallbacks;u&&(s.loaderCallbacks=u.filter(h=>h.id!==n))})}function FL(e){e.pendingCallbacksFlag||(e.pendingCallbacksFlag=!0,setTimeout(()=>{e.pendingCallbacksFlag=!1;const n=e.loaderCallbacks?e.loaderCallbacks.slice(0):[];if(!n.length)return;let s=!1;const u=e.provider,h=e.prefix;n.forEach(g=>{const m=g.icons,c=m.pending.length;m.pending=m.pending.filter(I=>{if(I.prefix!==h)return!0;const M=I.name;if(e.icons[M])m.loaded.push({provider:u,prefix:h,name:M});else if(e.missing.has(M))m.missing.push({provider:u,prefix:h,name:M});else return s=!0,!0;return!1}),m.pending.length!==c&&(s||L1([e],g.id),g.callback(m.loaded.slice(0),m.missing.slice(0),m.pending.slice(0),g.abort))})}))}let VL=0;function NL(e,n,s){const u=VL++,h=L1.bind(null,s,u);if(!n.pending.length)return h;const g={id:u,icons:n,callback:e,abort:h};return s.forEach(m=>{(m.loaderCallbacks||(m.loaderCallbacks=[])).push(g)}),h}function $L(e,n=!0,s=!1){const u=[];return e.forEach(h=>{const g=typeof h=="string"?Gf(h,n,s):h;g&&u.push(g)}),u}var jL={resources:[],index:0,timeout:2e3,rotate:750,random:!1,dataAfterTimeout:!1};function UL(e,n,s,u){const h=e.resources.length,g=e.random?Math.floor(Math.random()*h):e.index;let m;if(e.random){let oe=e.resources.slice(0);for(m=[];oe.length>1;){const Ae=Math.floor(Math.random()*oe.length);m.push(oe[Ae]),oe=oe.slice(0,Ae).concat(oe.slice(Ae+1))}m=m.concat(oe)}else m=e.resources.slice(g).concat(e.resources.slice(0,g));const c=Date.now();let I="pending",M=0,k,C=null,L=[],q=[];typeof u=="function"&&q.push(u);function X(){C&&(clearTimeout(C),C=null)}function W(){I==="pending"&&(I="aborted"),X(),L.forEach(oe=>{oe.status==="pending"&&(oe.status="aborted")}),L=[]}function ae(oe,Ae){Ae&&(q=[]),typeof oe=="function"&&q.push(oe)}function Ie(){return{startTime:c,payload:n,status:I,queriesSent:M,queriesPending:L.length,subscribe:ae,abort:W}}function ee(){I="failed",q.forEach(oe=>{oe(void 0,k)})}function H(){L.forEach(oe=>{oe.status==="pending"&&(oe.status="aborted")}),L=[]}function ce(oe,Ae,be){const Le=Ae!=="success";switch(L=L.filter(me=>me!==oe),I){case"pending":break;case"failed":if(Le||!e.dataAfterTimeout)return;break;default:return}if(Ae==="abort"){k=be,ee();return}if(Le){k=be,L.length||(m.length?ne():ee());return}if(X(),H(),!e.random){const me=e.resources.indexOf(oe.resource);me!==-1&&me!==e.index&&(e.index=me)}I="completed",q.forEach(me=>{me(be)})}function ne(){if(I!=="pending")return;X();const oe=m.shift();if(oe===void 0){if(L.length){C=setTimeout(()=>{X(),I==="pending"&&(H(),ee())},e.timeout);return}ee();return}const Ae={status:"pending",resource:oe,callback:(be,Le)=>{ce(Ae,be,Le)}};L.push(Ae),M++,C=setTimeout(ne,e.rotate),s(oe,n,Ae.callback)}return setTimeout(ne),Ie}function P1(e){const n={...jL,...e};let s=[];function u(){s=s.filter(c=>c().status==="pending")}function h(c,I,M){const k=UL(n,c,I,(C,L)=>{u(),M&&M(C,L)});return s.push(k),k}function g(c){return s.find(I=>c(I))||null}return{query:h,find:g,setIndex:c=>{n.index=c},getIndex:()=>n.index,cleanup:u}}function Nv(){}const Cm=Object.create(null);function qL(e){if(!Cm[e]){const n=my(e);if(!n)return;const s=P1(n),u={config:n,redundancy:s};Cm[e]=u}return Cm[e]}function HL(e,n,s){let u,h;if(typeof e=="string"){const g=_g(e);if(!g)return s(void 0,424),Nv;h=g.send;const m=qL(e);m&&(u=m.redundancy)}else{const g=fy(e);if(g){u=P1(g);const m=e.resources?e.resources[0]:"",c=_g(m);c&&(h=c.send)}}return!u||!h?(s(void 0,424),Nv):u.query(n,h,s)().abort}const $v="iconify2",ch="iconify",z1=ch+"-count",jv=ch+"-version",D1=36e5,GL=168,ZL=50;function xg(e,n){try{return e.getItem(n)}catch{}}function gy(e,n,s){try{return e.setItem(n,s),!0}catch{}}function Uv(e,n){try{e.removeItem(n)}catch{}}function bg(e,n){return gy(e,z1,n.toString())}function wg(e){return parseInt(xg(e,z1))||0}const Zf={local:!0,session:!0},R1={local:new Set,session:new Set};let yy=!1;function WL(e){yy=e}let jd=typeof window>"u"?{}:window;function O1(e){const n=e+"Storage";try{if(jd&&jd[n]&&typeof jd[n].length=="number")return jd[n]}catch{}Zf[e]=!1}function B1(e,n){const s=O1(e);if(!s)return;const u=xg(s,jv);if(u!==$v){if(u){const c=wg(s);for(let I=0;I<c;I++)Uv(s,ch+I.toString())}gy(s,jv,$v),bg(s,0);return}const h=Math.floor(Date.now()/D1)-GL,g=c=>{const I=ch+c.toString(),M=xg(s,I);if(typeof M=="string"){try{const k=JSON.parse(M);if(typeof k=="object"&&typeof k.cached=="number"&&k.cached>h&&typeof k.provider=="string"&&typeof k.data=="object"&&typeof k.data.prefix=="string"&&n(k,c))return!0}catch{}Uv(s,I)}};let m=wg(s);for(let c=m-1;c>=0;c--)g(c)||(c===m-1?(m--,bg(s,m)):R1[e].add(c))}function F1(){if(!yy){WL(!0);for(const e in Zf)B1(e,n=>{const s=n.data,u=n.provider,h=s.prefix,g=Ja(u,h);if(!dy(g,s).length)return!1;const m=s.lastModified||-1;return g.lastModifiedCached=g.lastModifiedCached?Math.min(g.lastModifiedCached,m):m,!0})}}function KL(e,n){const s=e.lastModifiedCached;if(s&&s>=n)return s===n;if(e.lastModifiedCached=n,s)for(const u in Zf)B1(u,h=>{const g=h.data;return h.provider!==e.provider||g.prefix!==e.prefix||g.lastModified===n});return!0}function XL(e,n){yy||F1();function s(u){let h;if(!Zf[u]||!(h=O1(u)))return;const g=R1[u];let m;if(g.size)g.delete(m=Array.from(g).shift());else if(m=wg(h),m>=ZL||!bg(h,m+1))return;const c={cached:Math.floor(Date.now()/D1),provider:e.provider,data:n};return gy(h,ch+m.toString(),JSON.stringify(c))}n.lastModified&&!KL(e,n.lastModified)||Object.keys(n.icons).length&&(n.not_found&&(n=Object.assign({},n),delete n.not_found),s("local")||s("session"))}function qv(){}function JL(e){e.iconsLoaderFlag||(e.iconsLoaderFlag=!0,setTimeout(()=>{e.iconsLoaderFlag=!1,FL(e)}))}function YL(e,n){e.iconsToLoad?e.iconsToLoad=e.iconsToLoad.concat(n).sort():e.iconsToLoad=n,e.iconsQueueFlag||(e.iconsQueueFlag=!0,setTimeout(()=>{e.iconsQueueFlag=!1;const{provider:s,prefix:u}=e,h=e.iconsToLoad;delete e.iconsToLoad;let g;if(!h||!(g=_g(s)))return;g.prepare(s,u,h).forEach(c=>{HL(s,c,I=>{if(typeof I!="object")c.icons.forEach(M=>{e.missing.add(M)});else try{const M=dy(e,I);if(!M.length)return;const k=e.pendingIcons;k&&M.forEach(C=>{k.delete(C)}),XL(e,I)}catch(M){console.error(M)}JL(e)})})}))}const QL=(e,n)=>{const s=$L(e,!0,M1()),u=BL(s);if(!u.pending.length){let I=!0;return n&&setTimeout(()=>{I&&n(u.loaded,u.missing,u.pending,qv)}),()=>{I=!1}}const h=Object.create(null),g=[];let m,c;return u.pending.forEach(I=>{const{provider:M,prefix:k}=I;if(k===c&&M===m)return;m=M,c=k,g.push(Ja(M,k));const C=h[M]||(h[M]=Object.create(null));C[k]||(C[k]=[])}),u.pending.forEach(I=>{const{provider:M,prefix:k,name:C}=I,L=Ja(M,k),q=L.pendingIcons||(L.pendingIcons=new Set);q.has(C)||(q.add(C),h[M][k].push(C))}),g.forEach(I=>{const{provider:M,prefix:k}=I;h[M][k].length&&YL(I,h[M][k])}),n?NL(n,u,g):qv},eP=e=>new Promise((n,s)=>{const u=typeof e=="string"?Gf(e,!0):e;if(!u){s(e);return}QL([u||e],h=>{if(h.length&&u){const g=SL(u);if(g){n({...hy,...g});return}}s(e)})});({...AL});const Hv={backgroundColor:"currentColor"},tP={backgroundColor:"transparent"},Gv={Image:"var(--svg)",Repeat:"no-repeat",Size:"100% 100%"},Zv={webkitMask:Hv,mask:Hv,background:tP};for(const e in Zv){const n=Zv[e];for(const s in Gv)n[e+s]=Gv[s]}const Am={};["horizontal","vertical"].forEach(e=>{const n=e.slice(0,1)+"Flip";Am[e+"-flip"]=n,Am[e.slice(0,1)+"-flip"]=n,Am[e+"Flip"]=n});M1(!0);kL("",OL);if(typeof document<"u"&&typeof window<"u"){F1();const e=window;if(e.IconifyPreload!==void 0){const n=e.IconifyPreload,s="Invalid IconifyPreload syntax.";typeof n=="object"&&n!==null&&(n instanceof Array?n:[n]).forEach(u=>{try{(typeof u!="object"||u===null||u instanceof Array||typeof u.icons!="object"||typeof u.prefix!="string"||!TL(u))&&console.error(s)}catch{console.error(s)}})}if(e.IconifyProviders!==void 0){const n=e.IconifyProviders;if(typeof n=="object"&&n!==null)for(let s in n){const u="IconifyProviders["+s+"] is invalid.";try{const h=n[s];if(typeof h!="object"||!h||h.resources===void 0)continue;vg(s,h)||console.error(u)}catch{console.error(u)}}}}({...hy});const iP=["fluent-emoji-high-contrast","material-symbols-light","cryptocurrency-color","icon-park-outline","icon-park-twotone","fluent-emoji-flat","emojione-monotone","streamline-emojis","heroicons-outline","simple-line-icons","material-symbols","flat-color-icons","icon-park-solid","pepicons-pencil","heroicons-solid","pepicons-print","cryptocurrency","pixelarticons","system-uicons","bitcoin-icons","devicon-plain","entypo-social","token-branded","grommet-icons","vscode-icons","pepicons-pop","svg-spinners","fluent-emoji","simple-icons","circle-flags","medical-icon","icomoon-free","majesticons","radix-icons","humbleicons","fa6-regular","emojione-v1","skill-icons","academicons","healthicons","fluent-mdl2","teenyicons","ant-design","gravity-ui","akar-icons","lets-icons","streamline","fa6-brands","file-icons","game-icons","foundation","fa-regular","mono-icons","hugeicons","iconamoon","zondicons","mdi-light","eos-icons","gridicons","icon-park","heroicons","fa6-solid","meteocons","arcticons","dashicons","fa-brands","websymbol","fontelico","mingcute","flowbite","marketeq","bytesize","guidance","openmoji","emojione","nonicons","brandico","flagpack","fa-solid","fontisto","si-glyph","pepicons","iconoir","tdesign","clarity","octicon","codicon","pajamas","formkit","line-md","twemoji","noto-v1","fxemoji","devicon","raphael","flat-ui","topcoat","feather","tabler","carbon","lucide","memory","mynaui","circum","fluent","nimbus","entypo","icons8","subway","vaadin","solar","basil","typcn","charm","prime","quill","logos","token","covid","maki","gala","mage","ooui","noto","unjs","flag","iwwa","zmdi","bpmn","mdi","ion","uil","bxs","cil","uiw","uim","uit","uis","jam","oui","bxl","cib","cbi","cif","gis","map","geo","fad","eva","wpf","whh","ic","ph","ri","bi","bx","gg","ci","ep","fe","mi","f7","ei","wi","la","fa","oi","et","el","ls","vs","il","ps"];function rP(e=""){let n,s="";if(e[0]==="@"&&e.includes(":")&&(s=e.split(":")[0].slice(1),e=e.split(":").slice(1).join(":")),e.startsWith("i-")){e=e.replace(/^i-/,"");for(const u of iP)if(e.startsWith(u)){n=u,e=e.slice(u.length+1);break}}else if(e.includes(":")){const[u,h]=e.split(":");n=u,e=h}return{provider:s,prefix:n||"",name:e||""}}const nP=Ri({__name:"Icon",props:{name:{type:String,required:!0},size:{type:String,default:""}},async setup(e){let n,s;const u=Yi(),h=qf(),g=e;Zi(()=>{var ae;return(ae=h.nuxtIcon)==null?void 0:ae.iconifyApiOptions},()=>{var ae,Ie,ee,H,ce,ne;if((Ie=(ae=h.nuxtIcon)==null?void 0:ae.iconifyApiOptions)!=null&&Ie.url){try{new URL(h.nuxtIcon.iconifyApiOptions.url)}catch{console.warn("Nuxt Icon: Invalid custom Iconify API URL");return}if((H=(ee=h.nuxtIcon)==null?void 0:ee.iconifyApiOptions)!=null&&H.publicApiFallback){vg("custom",{resources:[(ce=h.nuxtIcon)==null?void 0:ce.iconifyApiOptions.url],index:0});return}vg("",{resources:[(ne=h.nuxtIcon)==null?void 0:ne.iconifyApiOptions.url]})}},{immediate:!0});const m=mh("icons",()=>({})),c=kt(!1),I=Ve(()=>{var ae,Ie;return(Ie=(ae=h.nuxtIcon)==null?void 0:ae.aliases)!=null&&Ie[g.name]?h.nuxtIcon.aliases[g.name]:g.name}),M=Ve(()=>rP(I.value)),k=Ve(()=>[M.value.provider,M.value.prefix,M.value.name].filter(Boolean).join(":")),C=Ve(()=>{var ae;return(ae=m.value)==null?void 0:ae[k.value]}),L=Ve(()=>{var ae;return(ae=u.vueApp)==null?void 0:ae.component(I.value)}),q=Ve(()=>{var Ie,ee,H;if(!g.size&&typeof((Ie=h.nuxtIcon)==null?void 0:Ie.size)=="boolean"&&!((ee=h.nuxtIcon)!=null&&ee.size))return;const ae=g.size||((H=h.nuxtIcon)==null?void 0:H.size)||"1em";return String(Number(ae))===ae?`${ae}px`:ae}),X=Ve(()=>{var ae;return((ae=h==null?void 0:h.nuxtIcon)==null?void 0:ae.class)??"icon"});async function W(){var ae;L.value||(ae=m.value)!=null&&ae[k.value]||(c.value=!0,m.value[k.value]=await eP(M.value).catch(()=>{}),c.value=!1)}return Zi(I,W),!L.value&&([n,s]=tI(()=>W()),n=await n,s()),(ae,Ie)=>c.value?(_t(),ri("span",{key:0,class:Mt(X.value),style:ia({width:q.value,height:q.value})},null,6)):C.value?(_t(),li(ni(yL),{key:1,icon:C.value,class:Mt(X.value),width:q.value,height:q.value},null,8,["icon","class","width","height"])):L.value?(_t(),li(hs(L.value),{key:2,class:Mt(X.value),width:q.value,height:q.value},null,8,["class","width","height"])):(_t(),ri("span",{key:3,class:Mt(X.value),style:ia({fontSize:q.value,lineHeight:q.value,width:q.value,height:q.value})},[sr(ae.$slots,"default",{},()=>[mo(Ur(e.name),1)],!0)],6))}}),V1=jn(nP,[["__scopeId","data-v-e8d572f6"]]),oP=Object.freeze(Object.defineProperty({__proto__:null,default:V1},Symbol.toStringTag,{value:"Module"})),sP=Ri({props:{name:{type:String,required:!0},dynamic:{type:Boolean,default:!1}},setup(e){const n=qf();return{dynamic:Ve(()=>{var u,h;return e.dynamic||((h=(u=n.ui)==null?void 0:u.icons)==null?void 0:h.dynamic)})}}});function aP(e,n,s,u,h,g){const m=V1;return e.dynamic?(_t(),li(m,{key:0,name:e.name},null,8,["name"])):(_t(),ri("span",{key:1,class:Mt(e.name)},null,2))}const $o=jn(sP,[["render",aP]]),lP=Ri({inheritAttrs:!1,props:{...ly,as:{type:String,default:"button"},type:{type:String,default:"button"},disabled:{type:Boolean,default:null},active:{type:Boolean,default:void 0},exact:{type:Boolean,default:!1},exactQuery:{type:Boolean,default:!1},exactHash:{type:Boolean,default:!1},inactiveClass:{type:String,default:void 0}},setup(e){function n(s,u,{isActive:h,isExactActive:g}){return e.exactQuery&&!LC(s.query,u.query)||e.exactHash&&s.hash!==u.hash?e.inactiveClass:e.exact&&g||!e.exact&&h?e.activeClass:e.inactiveClass}return{resolveLinkClass:n}}}),cP=["href","aria-disabled","role","rel","target","onClick"];function uP(e,n,s,u,h,g){const m=v1;return e.to?(_t(),li(m,br({key:1},e.$props,{custom:""}),{default:xr(({route:c,href:I,target:M,rel:k,navigate:C,isActive:L,isExactActive:q,isExternal:X})=>[$i("a",br(e.$attrs,{href:e.disabled?void 0:I,"aria-disabled":e.disabled?"true":void 0,role:e.disabled?"link":void 0,rel:k,target:M,class:e.active!==void 0?e.active?e.activeClass:e.inactiveClass:e.resolveLinkClass(c,e.$route,{isActive:L,isExactActive:q}),onClick:W=>!X&&!e.disabled&&C(W)}),[sr(e.$slots,"default",Dm(ff({isActive:e.active!==void 0?e.active:e.exact?q:L})))],16,cP)]),_:3},16)):(_t(),li(hs(e.as),br({key:0,type:e.type,disabled:e.disabled},e.$attrs,{class:e.active?e.activeClass:e.inactiveClass}),{default:xr(()=>[sr(e.$slots,"default",Dm(ff({isActive:e.active})))]),_:3},16,["type","disabled","class"]))}const N1=jn(lP,[["render",uP]]),as=ys(Di.ui.strategy,Di.ui.button,$M),hP=Ri({components:{UIcon:$o,ULink:N1},inheritAttrs:!1,props:{...ly,type:{type:String,default:"button"},block:{type:Boolean,default:!1},label:{type:String,default:null},loading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},padded:{type:Boolean,default:!0},size:{type:String,default:()=>as.default.size,validator(e){return Object.keys(as.size).includes(e)}},color:{type:String,default:()=>as.default.color,validator(e){return[...Di.ui.colors,...Object.keys(as.color)].includes(e)}},variant:{type:String,default:()=>as.default.variant,validator(e){return[...Object.keys(as.variant),...Object.values(as.color).flatMap(n=>Object.keys(n))].includes(e)}},icon:{type:String,default:null},loadingIcon:{type:String,default:()=>as.default.loadingIcon},leadingIcon:{type:String,default:null},trailingIcon:{type:String,default:null},trailing:{type:Boolean,default:!1},leading:{type:Boolean,default:!1},square:{type:Boolean,default:!1},truncate:{type:Boolean,default:!1},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},setup(e,{slots:n}){const{ui:s,attrs:u}=ra("button",Qn(e,"ui"),as),{size:h,rounded:g}=Hf({ui:s,props:e}),m=Ve(()=>e.icon&&e.leading||e.icon&&!e.trailing||e.loading&&!e.trailing||e.leadingIcon),c=Ve(()=>e.icon&&e.trailing||e.loading&&e.trailing||e.trailingIcon),I=Ve(()=>e.square||!n.default&&!e.label),M=Ve(()=>{var ae,Ie;const W=((Ie=(ae=s.value.color)==null?void 0:ae[e.color])==null?void 0:Ie[e.variant])||s.value.variant[e.variant];return fs(tr(s.value.base,s.value.font,g.value,s.value.size[h.value],s.value.gap[h.value],e.padded&&s.value[I.value?"square":"padding"][h.value],W==null?void 0:W.replaceAll("{color}",e.color),e.block?s.value.block:s.value.inline),e.class)}),k=Ve(()=>e.loading?e.loadingIcon:e.leadingIcon||e.icon),C=Ve(()=>e.loading&&!m.value?e.loadingIcon:e.trailingIcon||e.icon),L=Ve(()=>tr(s.value.icon.base,s.value.icon.size[h.value],e.loading&&s.value.icon.loading)),q=Ve(()=>tr(s.value.icon.base,s.value.icon.size[h.value],e.loading&&!m.value&&s.value.icon.loading)),X=Ve(()=>Wk(e));return{ui:s,attrs:u,isLeading:m,isTrailing:c,isSquare:I,buttonClass:M,leadingIconName:k,trailingIconName:C,leadingIconClass:L,trailingIconClass:q,linkProps:X}}});function dP(e,n,s,u,h,g){const m=$o,c=N1;return _t(),li(c,br({type:e.type,disabled:e.disabled||e.loading,class:e.buttonClass},{...e.linkProps,...e.attrs}),{default:xr(()=>[sr(e.$slots,"leading",{disabled:e.disabled,loading:e.loading},()=>[e.isLeading&&e.leadingIconName?(_t(),li(m,{key:0,name:e.leadingIconName,class:Mt(e.leadingIconClass),"aria-hidden":"true"},null,8,["name","class"])):Li("",!0)]),sr(e.$slots,"default",{},()=>[e.label?(_t(),ri("span",{key:0,class:Mt([e.truncate?e.ui.truncate:""])},Ur(e.label),3)):Li("",!0)]),sr(e.$slots,"trailing",{disabled:e.disabled,loading:e.loading},()=>[e.isTrailing&&e.trailingIconName?(_t(),li(m,{key:0,name:e.trailingIconName,class:Mt(e.trailingIconClass),"aria-hidden":"true"},null,8,["name","class"])):Li("",!0)])]),_:3},16,["type","disabled","class"])}const Wf=jn(hP,[["render",dP]]),$1=()=>mh("color-mode").value,j1=e=>(Gx("data-v-82e603f3"),e=e(),Zx(),e),fP={class:"px-4 flex items-center border-b border-gray-200 dark:border-gray-800"},pP={class:"app-logo flex items-center"},mP=j1(()=>$i("h1",null,"japanmesh",-1)),gP=j1(()=>$i("div",{class:"grow"},null,-1)),yP=Ri({__name:"AppHeader",setup(e){const n=$1(),s=kt(""),u=Ve(()=>n.preference==="light"?"i-heroicons-sun":"i-heroicons-moon-16-solid");function h(){n.preference=n.preference==="light"?"dark":"light"}return Wr(()=>{fetch("https://api.github.com/repos/qazsato/japanmesh/releases/latest").then(m=>m.json()).then(m=>{s.value=m.tag_name})}),(g,m)=>{const c=v1,I=b1,M=Wf;return _t(),ri("header",fP,[$i("div",pP,[ei(c,{to:"/"},{default:xr(()=>[mP]),_:1}),ni(s)?(_t(),li(I,{key:0,label:ni(s),variant:"outline",color:"primary",size:"xs",class:"mx-2"},null,8,["label"])):Li("",!0)]),gP,ei(M,{icon:ni(u),size:"sm",color:"gray",square:"",variant:"ghost",onClick:h,class:"mx-1"},null,8,["icon"]),ei(M,{icon:"i-simple-icons-npm",size:"sm",color:"gray",square:"",variant:"ghost",to:"https://www.npmjs.com/package/japanmesh",target:"_blank",class:"mx-1"}),ei(M,{icon:"i-simple-icons-github",size:"sm",color:"gray",square:"",variant:"ghost",to:"https://github.com/qazsato/geo-docs",target:"_blank",class:"mx-1"})])}}}),_P=jn(yP,[["__scopeId","data-v-82e603f3"]]),U1=(e,n)=>{const s=Zr("form-events",void 0),u=Zr("form-group",void 0),h=Zr("form-inputs",void 0);u&&(e!=null&&e.id&&(u.inputId.value=e==null?void 0:e.id),h&&(h.value[u.name.value]=u.inputId.value));const g=kt(!1);function m(k,C){s&&s.emit({type:k,path:C})}function c(){m("blur",u==null?void 0:u.name.value),g.value=!0}function I(){m("change",u==null?void 0:u.name.value)}const M=h1(()=>{(g.value||u!=null&&u.eagerValidation.value)&&m("input",u==null?void 0:u.name.value)},300);return{inputId:Ve(()=>(e==null?void 0:e.id)??(u==null?void 0:u.inputId.value)),name:Ve(()=>(e==null?void 0:e.name)??(u==null?void 0:u.name.value)),size:Ve(()=>{var C;const k=n.size[u==null?void 0:u.size.value]?u==null?void 0:u.size.value:null;return(e==null?void 0:e.size)??k??((C=n==null?void 0:n.default)==null?void 0:C.size)}),color:Ve(()=>{var k;return(k=u==null?void 0:u.error)!=null&&k.value?"red":e==null?void 0:e.color}),emitFormBlur:c,emitFormInput:M,emitFormChange:I}},ls=ys(Di.ui.strategy,Di.ui.input,cy),vP=Ri({components:{UIcon:$o},inheritAttrs:!1,props:{modelValue:{type:[String,Number],default:""},type:{type:String,default:"text"},id:{type:String,default:null},name:{type:String,default:null},placeholder:{type:String,default:null},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},autofocus:{type:Boolean,default:!1},autofocusDelay:{type:Number,default:100},icon:{type:String,default:null},loadingIcon:{type:String,default:()=>ls.default.loadingIcon},leadingIcon:{type:String,default:null},trailingIcon:{type:String,default:null},trailing:{type:Boolean,default:!1},leading:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},padded:{type:Boolean,default:!0},size:{type:String,default:null,validator(e){return Object.keys(ls.size).includes(e)}},color:{type:String,default:()=>ls.default.color,validator(e){return[...Di.ui.colors,...Object.keys(ls.color)].includes(e)}},variant:{type:String,default:()=>ls.default.variant,validator(e){return[...Object.keys(ls.variant),...Object.values(ls.color).flatMap(n=>Object.keys(n))].includes(e)}},inputClass:{type:String,default:null},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})},modelModifiers:{type:Object,default:()=>({})}},emits:["update:modelValue","blur","change"],setup(e,{emit:n,slots:s}){const{ui:u,attrs:h}=ra("input",Qn(e,"ui"),ls,Qn(e,"class")),{size:g,rounded:m}=Hf({ui:u,props:e}),{emitFormBlur:c,emitFormInput:I,size:M,color:k,inputId:C,name:L}=U1(e,ls),q=Ve(()=>g.value||M.value),X=kt(jf({},e.modelModifiers,{trim:!1,lazy:!1,number:!1})),W=kt(null),ae=()=>{var Ge;e.autofocus&&((Ge=W.value)==null||Ge.focus())},Ie=Ge=>{X.value.trim&&(Ge=Ge.trim()),(X.value.number||e.type==="number")&&(Ge=Jk(Ge)),n("update:modelValue",Ge),I()},ee=Ge=>{X.value.lazy||Ie(Ge.target.value)},H=Ge=>{if(e.type==="file"){const rt=Ge.target.files;n("change",rt)}else{const rt=Ge.target.value;n("change",rt),X.value.lazy&&Ie(rt),X.value.trim&&(Ge.target.value=rt.trim())}},ce=Ge=>{c(),n("blur",Ge)};Wr(()=>{setTimeout(()=>{ae()},e.autofocusDelay)});const ne=Ve(()=>{var rt,Ke;const Ge=((Ke=(rt=u.value.color)==null?void 0:rt[k.value])==null?void 0:Ke[e.variant])||u.value.variant[e.variant];return fs(tr(u.value.base,u.value.form,m.value,u.value.placeholder,e.type==="file"&&u.value.file.base,u.value.size[q.value],e.padded?u.value.padding[q.value]:"p-0",Ge==null?void 0:Ge.replaceAll("{color}",k.value),(oe.value||s.leading)&&u.value.leading.padding[q.value],(Ae.value||s.trailing)&&u.value.trailing.padding[q.value]),e.inputClass)}),oe=Ve(()=>e.icon&&e.leading||e.icon&&!e.trailing||e.loading&&!e.trailing||e.leadingIcon),Ae=Ve(()=>e.icon&&e.trailing||e.loading&&e.trailing||e.trailingIcon),be=Ve(()=>e.loading?e.loadingIcon:e.leadingIcon||e.icon),Le=Ve(()=>e.loading&&!oe.value?e.loadingIcon:e.trailingIcon||e.icon),me=Ve(()=>tr(u.value.icon.leading.wrapper,u.value.icon.leading.pointer,u.value.icon.leading.padding[q.value])),ke=Ve(()=>tr(u.value.icon.base,k.value&&Di.ui.colors.includes(k.value)&&u.value.icon.color.replaceAll("{color}",k.value),u.value.icon.size[q.value],e.loading&&u.value.icon.loading)),Me=Ve(()=>tr(u.value.icon.trailing.wrapper,u.value.icon.trailing.pointer,u.value.icon.trailing.padding[q.value])),Oe=Ve(()=>tr(u.value.icon.base,k.value&&Di.ui.colors.includes(k.value)&&u.value.icon.color.replaceAll("{color}",k.value),u.value.icon.size[q.value],e.loading&&!oe.value&&u.value.icon.loading));return{ui:u,attrs:h,name:L,inputId:C,input:W,isLeading:oe,isTrailing:Ae,inputClass:ne,leadingIconName:be,leadingIconClass:ke,leadingWrapperIconClass:me,trailingIconName:Le,trailingIconClass:Oe,trailingWrapperIconClass:Me,onInput:ee,onChange:H,onBlur:ce}}}),xP=["id","name","value","type","required","placeholder","disabled"];function bP(e,n,s,u,h,g){const m=$o;return _t(),ri("div",{class:Mt(e.type==="hidden"?"hidden":e.ui.wrapper)},[$i("input",br({id:e.inputId,ref:"input",name:e.name,value:e.modelValue,type:e.type,required:e.required,placeholder:e.placeholder,disabled:e.disabled,class:e.inputClass},e.attrs,{onInput:n[0]||(n[0]=(...c)=>e.onInput&&e.onInput(...c)),onBlur:n[1]||(n[1]=(...c)=>e.onBlur&&e.onBlur(...c)),onChange:n[2]||(n[2]=(...c)=>e.onChange&&e.onChange(...c))}),null,16,xP),sr(e.$slots,"default"),e.isLeading&&e.leadingIconName||e.$slots.leading?(_t(),ri("span",{key:0,class:Mt(e.leadingWrapperIconClass)},[sr(e.$slots,"leading",{disabled:e.disabled,loading:e.loading},()=>[ei(m,{name:e.leadingIconName,class:Mt(e.leadingIconClass)},null,8,["name","class"])])],2)):Li("",!0),e.isTrailing&&e.trailingIconName||e.$slots.trailing?(_t(),ri("span",{key:1,class:Mt(e.trailingWrapperIconClass)},[sr(e.$slots,"trailing",{disabled:e.disabled,loading:e.loading},()=>[ei(m,{name:e.trailingIconName,class:Mt(e.trailingIconClass)},null,8,["name","class"])])],2)):Li("",!0)],2)}const wP=jn(vP,[["render",bP]]),ja=ys(Di.ui.strategy,Di.ui.avatar,VM),EP=Ri({components:{UIcon:$o},inheritAttrs:!1,props:{as:{type:[String,Object],default:"img"},src:{type:[String,Boolean],default:null},alt:{type:String,default:null},text:{type:String,default:null},icon:{type:String,default:()=>ja.default.icon},size:{type:String,default:()=>ja.default.size,validator(e){return Object.keys(ja.size).includes(e)}},chipColor:{type:String,default:()=>ja.default.chipColor,validator(e){return["gray",...Di.ui.colors].includes(e)}},chipPosition:{type:String,default:()=>ja.default.chipPosition,validator(e){return Object.keys(ja.chip.position).includes(e)}},chipText:{type:[String,Number],default:null},imgClass:{type:String,default:""},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},setup(e){const{ui:n,attrs:s}=ra("avatar",Qn(e,"ui"),ja),u=Ve(()=>typeof e.src=="boolean"?null:e.src),h=Ve(()=>(e.alt||"").split(" ").map(C=>C.charAt(0)).join("").substring(0,2)),g=Ve(()=>fs(tr(n.value.wrapper,(M.value||!u.value)&&n.value.background,n.value.rounded,n.value.size[e.size]),e.class)),m=Ve(()=>fs(tr(n.value.rounded,n.value.size[e.size]),e.imgClass)),c=Ve(()=>tr(n.value.icon.base,n.value.icon.size[e.size])),I=Ve(()=>tr(n.value.chip.base,n.value.chip.size[e.size],n.value.chip.position[e.chipPosition],n.value.chip.background.replaceAll("{color}",e.chipColor))),M=kt(!1);Zi(()=>e.src,()=>{M.value&&(M.value=!1)});function k(){M.value=!0}return{ui:n,attrs:s,wrapperClass:g,imgClass:m,iconClass:c,chipClass:I,url:u,placeholder:h,error:M,onError:k}}});function SP(e,n,s,u,h,g){const m=$o;return _t(),ri("span",{class:Mt(e.wrapperClass)},[e.url&&!e.error?(_t(),li(hs(e.as),br({key:0,class:e.imgClass,alt:e.alt,src:e.url},e.attrs,{onError:e.onError}),null,16,["class","alt","src","onError"])):e.text?(_t(),ri("span",{key:1,class:Mt(e.ui.text)},Ur(e.text),3)):e.icon?(_t(),li(m,{key:2,name:e.icon,class:Mt(e.iconClass)},null,8,["name","class"])):e.placeholder?(_t(),ri("span",{key:3,class:Mt(e.ui.placeholder)},Ur(e.placeholder),3)):Li("",!0),e.chipColor?(_t(),ri("span",{key:4,class:Mt(e.chipClass)},Ur(e.chipText),3)):Li("",!0),sr(e.$slots,"default")],2)}const Kf=jn(EP,[["render",SP]]),IP=Symbol.for("nuxt:client-only"),TP="data-n-ids",CP="-";function AP(e){var h,g,m,c,I,M;if(typeof e!="string")throw new TypeError("[nuxt] [useId] key must be a string.");e=`n${e.slice(1)}`;const n=Yi(),s=la();if(!s)throw new TypeError("[nuxt] `useId` must be called within a component setup function.");n._id||(n._id=0),s._nuxtIdIndex||(s._nuxtIdIndex={}),(h=s._nuxtIdIndex)[e]||(h[e]=0);const u=e+CP+s._nuxtIdIndex[e]++;if(n.payload.serverRendered&&n.isHydrating&&!Zr(IP,!1)){const k=((g=s.vnode.el)==null?void 0:g.nodeType)===8&&((c=(m=s.vnode.el)==null?void 0:m.nextElementSibling)!=null&&c.getAttribute)?(I=s.vnode.el)==null?void 0:I.nextElementSibling:s.vnode.el,C=JSON.parse(((M=k==null?void 0:k.getAttribute)==null?void 0:M.call(k,TP))||"{}");if(C[u])return C[u]}return e+"_"+n._id++}function Ou(e,n,s){let u=s.initialDeps??[],h;return()=>{var g,m,c,I;let M;s.key&&((g=s.debug)!=null&&g.call(s))&&(M=Date.now());const k=e();if(!(k.length!==u.length||k.some((q,X)=>u[X]!==q)))return h;u=k;let L;if(s.key&&((m=s.debug)!=null&&m.call(s))&&(L=Date.now()),h=n(...k),s.key&&((c=s.debug)!=null&&c.call(s))){const q=Math.round((Date.now()-M)*100)/100,X=Math.round((Date.now()-L)*100)/100,W=X/16,ae=(Ie,ee)=>{for(Ie=String(Ie);Ie.length<ee;)Ie=" "+Ie;return Ie};console.info(`%c⏱ ${ae(X,5)} /${ae(q,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*W,120))}deg 100% 31%);`,s==null?void 0:s.key)}return(I=s==null?void 0:s.onChange)==null||I.call(s,h),h}}function km(e,n){if(e===void 0)throw new Error("Unexpected undefined");return e}const kP=(e,n)=>Math.abs(e-n)<1,MP=(e,n,s)=>{let u;return function(...h){e.clearTimeout(u),u=e.setTimeout(()=>n.apply(this,h),s)}},LP=e=>e,PP=e=>{const n=Math.max(e.startIndex-e.overscan,0),s=Math.min(e.endIndex+e.overscan,e.count-1),u=[];for(let h=n;h<=s;h++)u.push(h);return u},zP=(e,n)=>{const s=e.scrollElement;if(!s)return;const u=e.targetWindow;if(!u)return;const h=m=>{const{width:c,height:I}=m;n({width:Math.round(c),height:Math.round(I)})};if(h(s.getBoundingClientRect()),!u.ResizeObserver)return()=>{};const g=new u.ResizeObserver(m=>{const c=m[0];if(c!=null&&c.borderBoxSize){const I=c.borderBoxSize[0];if(I){h({width:I.inlineSize,height:I.blockSize});return}}h(s.getBoundingClientRect())});return g.observe(s,{box:"border-box"}),()=>{g.unobserve(s)}},Wv={passive:!0},DP=typeof window>"u"?!0:"onscrollend"in window,RP=(e,n)=>{const s=e.scrollElement;if(!s)return;const u=e.targetWindow;if(!u)return;let h=0;const g=DP?()=>{}:MP(u,()=>{n(h,!1)},e.options.isScrollingResetDelay),m=M=>()=>{h=s[e.options.horizontal?"scrollLeft":"scrollTop"],g(),n(h,M)},c=m(!0),I=m(!1);return I(),s.addEventListener("scroll",c,Wv),s.addEventListener("scrollend",I,Wv),()=>{s.removeEventListener("scroll",c),s.removeEventListener("scrollend",I)}},OP=(e,n,s)=>{if(n!=null&&n.borderBoxSize){const u=n.borderBoxSize[0];if(u)return Math.round(u[s.options.horizontal?"inlineSize":"blockSize"])}return Math.round(e.getBoundingClientRect()[s.options.horizontal?"width":"height"])},BP=(e,{adjustments:n=0,behavior:s},u)=>{var h,g;const m=e+n;(g=(h=u.scrollElement)==null?void 0:h.scrollTo)==null||g.call(h,{[u.options.horizontal?"left":"top"]:m,behavior:s})};class FP{constructor(n){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollDirection=null,this.scrollAdjustments=0,this.measureElementCache=new Map,this.observer=(()=>{let s=null;const u=()=>s||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:s=new this.targetWindow.ResizeObserver(h=>{h.forEach(g=>{this._measureElement(g.target,g)})}));return{disconnect:()=>{var h;return(h=u())==null?void 0:h.disconnect()},observe:h=>{var g;return(g=u())==null?void 0:g.observe(h,{box:"border-box"})},unobserve:h=>{var g;return(g=u())==null?void 0:g.unobserve(h)}}})(),this.range=null,this.setOptions=s=>{Object.entries(s).forEach(([u,h])=>{typeof h>"u"&&delete s[u]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:LP,rangeExtractor:PP,onChange:()=>{},measureElement:OP,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,...s}},this.notify=(s,u)=>{var h,g;const{startIndex:m,endIndex:c}=this.range??{startIndex:void 0,endIndex:void 0},I=this.calculateRange();(s||m!==(I==null?void 0:I.startIndex)||c!==(I==null?void 0:I.endIndex))&&((g=(h=this.options).onChange)==null||g.call(h,this,u))},this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(s=>s()),this.unsubs=[],this.scrollElement=null},this._didMount=()=>(this.measureElementCache.forEach(this.observer.observe),()=>{this.observer.disconnect(),this.cleanup()}),this._willUpdate=()=>{var s;const u=this.options.getScrollElement();this.scrollElement!==u&&(this.cleanup(),this.scrollElement=u,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((s=this.scrollElement)==null?void 0:s.window)??null,this._scrollToOffset(this.scrollOffset,{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,h=>{this.scrollRect=h,this.notify(!1,!1)})),this.unsubs.push(this.options.observeElementOffset(this,(h,g)=>{this.scrollAdjustments=0,this.scrollDirection=g?this.scrollOffset<h?"forward":"backward":null,this.scrollOffset=h;const m=this.isScrolling;this.isScrolling=g,this.notify(m!==g,g)})))},this.getSize=()=>this.scrollRect[this.options.horizontal?"width":"height"],this.getMeasurementOptions=Ou(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey],(s,u,h,g)=>(this.pendingMeasuredCacheIndexes=[],{count:s,paddingStart:u,scrollMargin:h,getItemKey:g}),{key:!1}),this.getFurthestMeasurement=(s,u)=>{const h=new Map,g=new Map;for(let m=u-1;m>=0;m--){const c=s[m];if(h.has(c.lane))continue;const I=g.get(c.lane);if(I==null||c.end>I.end?g.set(c.lane,c):c.end<I.end&&h.set(c.lane,!0),h.size===this.options.lanes)break}return g.size===this.options.lanes?Array.from(g.values()).sort((m,c)=>m.end===c.end?m.index-c.index:m.end-c.end)[0]:void 0},this.getMeasurements=Ou(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:s,paddingStart:u,scrollMargin:h,getItemKey:g},m)=>{const c=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const I=this.measurementsCache.slice(0,c);for(let M=c;M<s;M++){const k=g(M),C=this.options.lanes===1?I[M-1]:this.getFurthestMeasurement(I,M),L=C?C.end+this.options.gap:u+h,q=m.get(k),X=typeof q=="number"?q:this.options.estimateSize(M),W=L+X,ae=C?C.lane:M%this.options.lanes;I[M]={index:M,start:L,size:X,end:W,key:k,lane:ae}}return this.measurementsCache=I,I},{key:!1,debug:()=>this.options.debug}),this.calculateRange=Ou(()=>[this.getMeasurements(),this.getSize(),this.scrollOffset],(s,u,h)=>this.range=s.length>0&&u>0?VP({measurements:s,outerSize:u,scrollOffset:h}):null,{key:!1,debug:()=>this.options.debug}),this.getIndexes=Ou(()=>[this.options.rangeExtractor,this.calculateRange(),this.options.overscan,this.options.count],(s,u,h,g)=>u===null?[]:s({startIndex:u.startIndex,endIndex:u.endIndex,overscan:h,count:g}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=s=>{const u=this.options.indexAttribute,h=s.getAttribute(u);return h?parseInt(h,10):(console.warn(`Missing attribute name '${u}={index}' on measured element.`),-1)},this._measureElement=(s,u)=>{const h=this.measurementsCache[this.indexFromElement(s)];if(!h||!s.isConnected){this.measureElementCache.forEach((c,I)=>{c===s&&(this.observer.unobserve(s),this.measureElementCache.delete(I))});return}const g=this.measureElementCache.get(h.key);g!==s&&(g&&this.observer.unobserve(g),this.observer.observe(s),this.measureElementCache.set(h.key,s));const m=this.options.measureElement(s,u,this);this.resizeItem(h,m)},this.resizeItem=(s,u)=>{const h=this.itemSizeCache.get(s.key)??s.size,g=u-h;g!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(s,g,this):s.start<this.scrollOffset+this.scrollAdjustments)&&this._scrollToOffset(this.scrollOffset,{adjustments:this.scrollAdjustments+=g,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(s.index),this.itemSizeCache=new Map(this.itemSizeCache.set(s.key,u)),this.notify(!0,!1))},this.measureElement=s=>{s&&this._measureElement(s,void 0)},this.getVirtualItems=Ou(()=>[this.getIndexes(),this.getMeasurements()],(s,u)=>{const h=[];for(let g=0,m=s.length;g<m;g++){const c=s[g],I=u[c];h.push(I)}return h},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=s=>{const u=this.getMeasurements();return km(u[q1(0,u.length-1,h=>km(u[h]).start,s)])},this.getOffsetForAlignment=(s,u)=>{const h=this.getSize();u==="auto"&&(s<=this.scrollOffset?u="start":s>=this.scrollOffset+h?u="end":u="start"),u==="start"?s=s:u==="end"?s=s-h:u==="center"&&(s=s-h/2);const g=this.options.horizontal?"scrollWidth":"scrollHeight",c=(this.scrollElement?"document"in this.scrollElement?this.scrollElement.document.documentElement[g]:this.scrollElement[g]:0)-this.getSize();return Math.max(Math.min(c,s),0)},this.getOffsetForIndex=(s,u="auto")=>{s=Math.max(0,Math.min(s,this.options.count-1));const h=km(this.getMeasurements()[s]);if(u==="auto")if(h.end>=this.scrollOffset+this.getSize()-this.options.scrollPaddingEnd)u="end";else if(h.start<=this.scrollOffset+this.options.scrollPaddingStart)u="start";else return[this.scrollOffset,u];const g=u==="end"?h.end+this.options.scrollPaddingEnd:h.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(g,u),u]},this.isDynamicMode=()=>this.measureElementCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&this.targetWindow&&(this.targetWindow.clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(s,{align:u="start",behavior:h}={})=>{this.cancelScrollToIndex(),h==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(s,u),{adjustments:void 0,behavior:h})},this.scrollToIndex=(s,{align:u="auto",behavior:h}={})=>{s=Math.max(0,Math.min(s,this.options.count-1)),this.cancelScrollToIndex(),h==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const[g,m]=this.getOffsetForIndex(s,u);this._scrollToOffset(g,{adjustments:void 0,behavior:h}),h!=="smooth"&&this.isDynamicMode()&&this.targetWindow&&(this.scrollToIndexTimeoutId=this.targetWindow.setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.measureElementCache.has(this.options.getItemKey(s))){const[I]=this.getOffsetForIndex(s,m);kP(I,this.scrollOffset)||this.scrollToIndex(s,{align:m,behavior:h})}else this.scrollToIndex(s,{align:m,behavior:h})}))},this.scrollBy=(s,{behavior:u}={})=>{this.cancelScrollToIndex(),u==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.scrollOffset+s,{adjustments:void 0,behavior:u})},this.getTotalSize=()=>{var s;const u=this.getMeasurements();let h;return u.length===0?h=this.options.paddingStart:h=this.options.lanes===1?((s=u[u.length-1])==null?void 0:s.end)??0:Math.max(...u.slice(-this.options.lanes).map(g=>g.end)),h-this.options.scrollMargin+this.options.paddingEnd},this._scrollToOffset=(s,{adjustments:u,behavior:h})=>{this.options.scrollToFn(s,{behavior:h,adjustments:u},this)},this.measure=()=>{var s,u;this.itemSizeCache=new Map,(u=(s=this.options).onChange)==null||u.call(s,this,!1)},this.setOptions(n),this.scrollRect=this.options.initialRect,this.scrollOffset=typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset,this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(s=>{this.itemSizeCache.set(s.key,s.size)}),this.notify(!1,!1)}}const q1=(e,n,s,u)=>{for(;e<=n;){const h=(e+n)/2|0,g=s(h);if(g<u)e=h+1;else if(g>u)n=h-1;else return h}return e>0?e-1:0};function VP({measurements:e,outerSize:n,scrollOffset:s}){const u=e.length-1,g=q1(0,u,c=>e[c].start,s);let m=g;for(;m<u&&e[m].end<s+n;)m++;return{startIndex:g,endIndex:m}}function NP(e){const n=new FP(ni(e)),s=uc(n),u=n._didMount();return Zi(()=>ni(e).getScrollElement(),h=>{h&&n._willUpdate()},{immediate:!0}),Zi(()=>ni(e),h=>{n.setOptions({...h,onChange:(g,m)=>{var c;S0(s),(c=h.onChange)==null||c.call(h,g,m)}}),n._willUpdate(),S0(s)},{immediate:!0}),Ix(u),s}function $P(e){return NP(Ve(()=>({observeElementRect:zP,observeElementOffset:RP,scrollToFn:BP,...ni(e)})))}function H1(e,n,s){let u=kt(s==null?void 0:s.value),h=Ve(()=>e.value!==void 0);return[Ve(()=>h.value?e.value:u.value),function(g){return h.value||(u.value=g),n==null?void 0:n(g)}]}function jP(e){typeof queueMicrotask=="function"?queueMicrotask(e):Promise.resolve().then(e).catch(n=>setTimeout(()=>{throw n}))}function Tf(){let e=[],n={addEventListener(s,u,h,g){return s.addEventListener(u,h,g),n.add(()=>s.removeEventListener(u,h,g))},requestAnimationFrame(...s){let u=requestAnimationFrame(...s);n.add(()=>cancelAnimationFrame(u))},nextFrame(...s){n.requestAnimationFrame(()=>{n.requestAnimationFrame(...s)})},setTimeout(...s){let u=setTimeout(...s);n.add(()=>clearTimeout(u))},microTask(...s){let u={current:!0};return jP(()=>{u.current&&s[0]()}),n.add(()=>{u.current=!1})},style(s,u,h){let g=s.style.getPropertyValue(u);return Object.assign(s.style,{[u]:h}),this.add(()=>{Object.assign(s.style,{[u]:g})})},group(s){let u=Tf();return s(u),this.add(()=>u.dispose())},add(s){return e.push(s),()=>{let u=e.indexOf(s);if(u>=0)for(let h of e.splice(u,1))h()}},dispose(){for(let s of e.splice(0))s()}};return n}function UP(){let e=Tf();return sa(()=>e.dispose()),e}function qP(){let e=UP();return n=>{e.dispose(),e.nextFrame(n)}}let G1=Symbol("headlessui.useid"),HP=0;function tl(){return Zr(G1,()=>`${++HP}`)()}function GP(e){aa(G1,e)}function Xt(e){var n;if(e==null||e.value==null)return null;let s=(n=e.value.$el)!=null?n:e.value;return s instanceof Node?s:null}function Gr(e,n,...s){if(e in n){let h=n[e];return typeof h=="function"?h(...s):h}let u=new Error(`Tried to handle "${e}" but there is no handler defined. Only defined handlers are: ${Object.keys(n).map(h=>`"${h}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(u,Gr),u}var ZP=Object.defineProperty,WP=(e,n,s)=>n in e?ZP(e,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[n]=s,Kv=(e,n,s)=>(WP(e,typeof n!="symbol"?n+"":n,s),s);let KP=class{constructor(){Kv(this,"current",this.detect()),Kv(this,"currentId",0)}set(n){this.current!==n&&(this.currentId=0,this.current=n)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window>"u"||typeof document>"u"?"server":"client"}},_y=new KP;function vy(e){if(_y.isServer)return null;if(e instanceof Node)return e.ownerDocument;if(e!=null&&e.hasOwnProperty("value")){let n=Xt(e);if(n)return n.ownerDocument}return document}let Xv=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(e=>`${e}:not([tabindex='-1'])`).join(",");var XP=(e=>(e[e.First=1]="First",e[e.Previous=2]="Previous",e[e.Next=4]="Next",e[e.Last=8]="Last",e[e.WrapAround=16]="WrapAround",e[e.NoScroll=32]="NoScroll",e))(XP||{}),JP=(e=>(e[e.Error=0]="Error",e[e.Overflow=1]="Overflow",e[e.Success=2]="Success",e[e.Underflow=3]="Underflow",e))(JP||{}),YP=(e=>(e[e.Previous=-1]="Previous",e[e.Next=1]="Next",e))(YP||{}),xy=(e=>(e[e.Strict=0]="Strict",e[e.Loose=1]="Loose",e))(xy||{});function Z1(e,n=0){var s;return e===((s=vy(e))==null?void 0:s.body)?!1:Gr(n,{0(){return e.matches(Xv)},1(){let u=e;for(;u!==null;){if(u.matches(Xv))return!0;u=u.parentElement}return!1}})}var QP=(e=>(e[e.Keyboard=0]="Keyboard",e[e.Mouse=1]="Mouse",e))(QP||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",e=>{e.metaKey||e.altKey||e.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",e=>{e.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:e.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));function W1(e,n=s=>s){return e.slice().sort((s,u)=>{let h=n(s),g=n(u);if(h===null||g===null)return 0;let m=h.compareDocumentPosition(g);return m&Node.DOCUMENT_POSITION_FOLLOWING?-1:m&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function ez(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function tz(){return/Android/gi.test(window.navigator.userAgent)}function K1(){return ez()||tz()}function Ud(e,n,s){_y.isServer||Vn(u=>{document.addEventListener(e,n,s),u(()=>document.removeEventListener(e,n,s))})}function iz(e,n,s){_y.isServer||Vn(u=>{window.addEventListener(e,n,s),u(()=>window.removeEventListener(e,n,s))})}function X1(e,n,s=Ve(()=>!0)){function u(g,m){if(!s.value||g.defaultPrevented)return;let c=m(g);if(c===null||!c.getRootNode().contains(c))return;let I=function M(k){return typeof k=="function"?M(k()):Array.isArray(k)||k instanceof Set?k:[k]}(e);for(let M of I){if(M===null)continue;let k=M instanceof HTMLElement?M:Xt(M);if(k!=null&&k.contains(c)||g.composed&&g.composedPath().includes(k))return}return!Z1(c,xy.Loose)&&c.tabIndex!==-1&&g.preventDefault(),n(g,c)}let h=kt(null);Ud("pointerdown",g=>{var m,c;s.value&&(h.value=((c=(m=g.composedPath)==null?void 0:m.call(g))==null?void 0:c[0])||g.target)},!0),Ud("mousedown",g=>{var m,c;s.value&&(h.value=((c=(m=g.composedPath)==null?void 0:m.call(g))==null?void 0:c[0])||g.target)},!0),Ud("click",g=>{K1()||h.value&&(u(g,()=>h.value),h.value=null)},!0),Ud("touchend",g=>u(g,()=>g.target instanceof HTMLElement?g.target:null),!0),iz("blur",g=>u(g,()=>window.document.activeElement instanceof HTMLIFrameElement?window.document.activeElement:null),!0)}function Jv(e,n){if(e)return e;let s=n??"button";if(typeof s=="string"&&s.toLowerCase()==="button")return"button"}function J1(e,n){let s=kt(Jv(e.value.type,e.value.as));return Wr(()=>{s.value=Jv(e.value.type,e.value.as)}),Vn(()=>{var u;s.value||Xt(n)&&Xt(n)instanceof HTMLButtonElement&&!((u=Xt(n))!=null&&u.hasAttribute("type"))&&(s.value="button")}),s}function Yv(e){return[e.screenX,e.screenY]}function Y1(){let e=kt([-1,-1]);return{wasMoved(n){let s=Yv(n);return e.value[0]===s[0]&&e.value[1]===s[1]?!1:(e.value=s,!0)},update(n){e.value=Yv(n)}}}function rz({container:e,accept:n,walk:s,enabled:u}){Vn(()=>{let h=e.value;if(!h||u!==void 0&&!u.value)return;let g=vy(e);if(!g)return;let m=Object.assign(I=>n(I),{acceptNode:n}),c=g.createTreeWalker(h,NodeFilter.SHOW_ELEMENT,m,!1);for(;c.nextNode();)s(c.currentNode)})}var Ya=(e=>(e[e.None=0]="None",e[e.RenderStrategy=1]="RenderStrategy",e[e.Static=2]="Static",e))(Ya||{}),nz=(e=>(e[e.Unmount=0]="Unmount",e[e.Hidden=1]="Hidden",e))(nz||{});function jo({visible:e=!0,features:n=0,ourProps:s,theirProps:u,...h}){var g;let m=ew(u,s),c=Object.assign(h,{props:m});if(e||n&2&&m.static)return Mm(c);if(n&1){let I=(g=m.unmount)==null||g?0:1;return Gr(I,{0(){return null},1(){return Mm({...h,props:{...m,hidden:!0,style:{display:"none"}}})}})}return Mm(c)}function Mm({props:e,attrs:n,slots:s,slot:u,name:h}){var g,m;let{as:c,...I}=gh(e,["unmount","static"]),M=(g=s.default)==null?void 0:g.call(s,u),k={};if(u){let C=!1,L=[];for(let[q,X]of Object.entries(u))typeof X=="boolean"&&(C=!0),X===!0&&L.push(q);C&&(k["data-headlessui-state"]=L.join(" "))}if(c==="template"){if(M=Q1(M??[]),Object.keys(I).length>0||Object.keys(n).length>0){let[C,...L]=M??[];if(!oz(C)||L.length>0)throw new Error(['Passing props on "template"!',"",`The current component <${h} /> is rendering a "template".`,"However we need to passthrough the following props:",Object.keys(I).concat(Object.keys(n)).map(W=>W.trim()).filter((W,ae,Ie)=>Ie.indexOf(W)===ae).sort((W,ae)=>W.localeCompare(ae)).map(W=>`  - ${W}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "template".',"Render a single element as the child so that we can forward the props onto that element."].map(W=>`  - ${W}`).join(`
`)].join(`
`));let q=ew((m=C.props)!=null?m:{},I,k),X=Fo(C,q,!0);for(let W in q)W.startsWith("on")&&(X.props||(X.props={}),X.props[W]=q[W]);return X}return Array.isArray(M)&&M.length===1?M[0]:M}return Nn(c,Object.assign({},I,k),{default:()=>M})}function Q1(e){return e.flatMap(n=>n.type===ar?Q1(n.children):[n])}function ew(...e){if(e.length===0)return{};if(e.length===1)return e[0];let n={},s={};for(let u of e)for(let h in u)h.startsWith("on")&&typeof u[h]=="function"?(s[h]!=null||(s[h]=[]),s[h].push(u[h])):n[h]=u[h];if(n.disabled||n["aria-disabled"])return Object.assign(n,Object.fromEntries(Object.keys(s).map(u=>[u,void 0])));for(let u in s)Object.assign(n,{[u](h,...g){let m=s[u];for(let c of m){if(h instanceof Event&&h.defaultPrevented)return;c(h,...g)}}});return n}function tw(e){let n=Object.assign({},e);for(let s in n)n[s]===void 0&&delete n[s];return n}function gh(e,n=[]){let s=Object.assign({},e);for(let u of n)u in s&&delete s[u];return s}function oz(e){return e==null?!1:typeof e.type=="string"||typeof e.type=="object"||typeof e.type=="function"}var by=(e=>(e[e.None=1]="None",e[e.Focusable=2]="Focusable",e[e.Hidden=4]="Hidden",e))(by||{});let iw=Ri({name:"Hidden",props:{as:{type:[Object,String],default:"div"},features:{type:Number,default:1}},setup(e,{slots:n,attrs:s}){return()=>{var u;let{features:h,...g}=e,m={"aria-hidden":(h&2)===2?!0:(u=g["aria-hidden"])!=null?u:void 0,hidden:(h&4)===4?!0:void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...(h&4)===4&&(h&2)!==2&&{display:"none"}}};return jo({ourProps:m,theirProps:g,slot:{},attrs:s,slots:n,name:"Hidden"})}}}),rw=Symbol("Context");var ps=(e=>(e[e.Open=1]="Open",e[e.Closed=2]="Closed",e[e.Closing=4]="Closing",e[e.Opening=8]="Opening",e))(ps||{});function nw(){return Zr(rw,null)}function ow(e){aa(rw,e)}var bi=(e=>(e.Space=" ",e.Enter="Enter",e.Escape="Escape",e.Backspace="Backspace",e.Delete="Delete",e.ArrowLeft="ArrowLeft",e.ArrowUp="ArrowUp",e.ArrowRight="ArrowRight",e.ArrowDown="ArrowDown",e.Home="Home",e.End="End",e.PageUp="PageUp",e.PageDown="PageDown",e.Tab="Tab",e))(bi||{}),sw=(e=>(e[e.Left=0]="Left",e[e.Right=2]="Right",e))(sw||{});function sz(e){function n(){document.readyState!=="loading"&&(e(),document.removeEventListener("DOMContentLoaded",n))}typeof window<"u"&&typeof document<"u"&&(document.addEventListener("DOMContentLoaded",n),n())}let Ha=[];sz(()=>{function e(n){n.target instanceof HTMLElement&&n.target!==document.body&&Ha[0]!==n.target&&(Ha.unshift(n.target),Ha=Ha.filter(s=>s!=null&&s.isConnected),Ha.splice(10))}window.addEventListener("click",e,{capture:!0}),window.addEventListener("mousedown",e,{capture:!0}),window.addEventListener("focus",e,{capture:!0}),document.body.addEventListener("click",e,{capture:!0}),document.body.addEventListener("mousedown",e,{capture:!0}),document.body.addEventListener("focus",e,{capture:!0})});function az(e){throw new Error("Unexpected object: "+e)}var _i=(e=>(e[e.First=0]="First",e[e.Previous=1]="Previous",e[e.Next=2]="Next",e[e.Last=3]="Last",e[e.Specific=4]="Specific",e[e.Nothing=5]="Nothing",e))(_i||{});function Eg(e,n){let s=n.resolveItems();if(s.length<=0)return null;let u=n.resolveActiveIndex(),h=u??-1;switch(e.focus){case 0:{for(let g=0;g<s.length;++g)if(!n.resolveDisabled(s[g],g,s))return g;return u}case 1:{h===-1&&(h=s.length);for(let g=h-1;g>=0;--g)if(!n.resolveDisabled(s[g],g,s))return g;return u}case 2:{for(let g=h+1;g<s.length;++g)if(!n.resolveDisabled(s[g],g,s))return g;return u}case 3:{for(let g=s.length-1;g>=0;--g)if(!n.resolveDisabled(s[g],g,s))return g;return u}case 4:{for(let g=0;g<s.length;++g)if(n.resolveId(s[g],g,s)===e.id)return g;return u}case 5:return null;default:az(e)}}function wy(e={},n=null,s=[]){for(let[u,h]of Object.entries(e))lw(s,aw(n,u),h);return s}function aw(e,n){return e?e+"["+n+"]":n}function lw(e,n,s){if(Array.isArray(s))for(let[u,h]of s.entries())lw(e,aw(n,u.toString()),h);else s instanceof Date?e.push([n,s.toISOString()]):typeof s=="boolean"?e.push([n,s?"1":"0"]):typeof s=="string"?e.push([n,s]):typeof s=="number"?e.push([n,`${s}`]):s==null?e.push([n,""]):wy(s,n,e)}var lz={};function cz(e,n){return e===n}var uz=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(uz||{}),hz=(e=>(e[e.Single=0]="Single",e[e.Multi=1]="Multi",e))(hz||{}),dz=(e=>(e[e.Pointer=0]="Pointer",e[e.Focus=1]="Focus",e[e.Other=2]="Other",e))(dz||{});let cw=Symbol("ComboboxContext");function bc(e){let n=Zr(cw,null);if(n===null){let s=new Error(`<${e} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(s,bc),s}return n}let uw=Symbol("VirtualContext"),fz=Ri({name:"VirtualProvider",setup(e,{slots:n}){let s=bc("VirtualProvider"),u=Ve(()=>{let c=Xt(s.optionsRef);if(!c)return{start:0,end:0};let I=window.getComputedStyle(c);return{start:parseFloat(I.paddingBlockStart||I.paddingTop),end:parseFloat(I.paddingBlockEnd||I.paddingBottom)}}),h=$P(Ve(()=>({scrollPaddingStart:u.value.start,scrollPaddingEnd:u.value.end,count:s.virtual.value.options.length,estimateSize(){return 40},getScrollElement(){return Xt(s.optionsRef)},overscan:12}))),g=Ve(()=>{var c;return(c=s.virtual.value)==null?void 0:c.options}),m=kt(0);return Zi([g],()=>{m.value+=1}),aa(uw,s.virtual.value?h:null),()=>[Nn("div",{style:{position:"relative",width:"100%",height:`${h.value.getTotalSize()}px`},ref:c=>{if(c){if(typeof process<"u"&&lz.JEST_WORKER_ID!==void 0||s.activationTrigger.value===0)return;s.activeOptionIndex.value!==null&&s.virtual.value.options.length>s.activeOptionIndex.value&&h.value.scrollToIndex(s.activeOptionIndex.value)}}},h.value.getVirtualItems().map(c=>Fo(n.default({option:s.virtual.value.options[c.index],open:s.comboboxState.value===0})[0],{key:`${m.value}-${c.index}`,"data-index":c.index,"aria-setsize":s.virtual.value.options.length,"aria-posinset":c.index+1,style:{position:"absolute",top:0,left:0,transform:`translateY(${c.start}px)`,overflowAnchor:"none"}})))]}}),pz=Ri({name:"Combobox",emits:{"update:modelValue":e=>!0},props:{as:{type:[Object,String],default:"template"},disabled:{type:[Boolean],default:!1},by:{type:[String,Function],nullable:!0,default:null},modelValue:{type:[Object,String,Number,Boolean],default:void 0},defaultValue:{type:[Object,String,Number,Boolean],default:void 0},form:{type:String,optional:!0},name:{type:String,optional:!0},nullable:{type:Boolean,default:!1},multiple:{type:[Boolean],default:!1},immediate:{type:[Boolean],default:!1},virtual:{type:Object,default:null}},inheritAttrs:!1,setup(e,{slots:n,attrs:s,emit:u}){let h=kt(1),g=kt(null),m=kt(null),c=kt(null),I=kt(null),M=kt({static:!1,hold:!1}),k=kt([]),C=kt(null),L=kt(2),q=kt(!1);function X(me=ke=>ke){let ke=C.value!==null?k.value[C.value]:null,Me=me(k.value.slice()),Oe=Me.length>0&&Me[0].dataRef.order.value!==null?Me.sort((rt,Ke)=>rt.dataRef.order.value-Ke.dataRef.order.value):W1(Me,rt=>Xt(rt.dataRef.domRef)),Ge=ke?Oe.indexOf(ke):null;return Ge===-1&&(Ge=null),{options:Oe,activeOptionIndex:Ge}}let W=Ve(()=>e.multiple?1:0),ae=Ve(()=>e.nullable),[Ie,ee]=H1(Ve(()=>e.modelValue),me=>u("update:modelValue",me),Ve(()=>e.defaultValue)),H=Ve(()=>Ie.value===void 0?Gr(W.value,{1:[],0:void 0}):Ie.value),ce=null,ne=null;function oe(me){return Gr(W.value,{0(){return ee==null?void 0:ee(me)},1:()=>{let ke=Vt(be.value.value).slice(),Me=Vt(me),Oe=ke.findIndex(Ge=>be.compare(Me,Vt(Ge)));return Oe===-1?ke.push(Me):ke.splice(Oe,1),ee==null?void 0:ee(ke)}})}let Ae=Ve(()=>{});Zi([Ae],([me],[ke])=>{if(be.virtual.value&&me&&ke&&C.value!==null){let Me=me.indexOf(ke[C.value]);Me!==-1?C.value=Me:C.value=null}});let be={comboboxState:h,value:H,mode:W,compare(me,ke){if(typeof e.by=="string"){let Me=e.by;return(me==null?void 0:me[Me])===(ke==null?void 0:ke[Me])}return e.by===null?cz(me,ke):e.by(me,ke)},calculateIndex(me){return be.virtual.value?e.by===null?be.virtual.value.options.indexOf(me):be.virtual.value.options.findIndex(ke=>be.compare(ke,me)):k.value.findIndex(ke=>be.compare(ke.dataRef.value,me))},defaultValue:Ve(()=>e.defaultValue),nullable:ae,immediate:Ve(()=>!1),virtual:Ve(()=>null),inputRef:m,labelRef:g,buttonRef:c,optionsRef:I,disabled:Ve(()=>e.disabled),options:k,change(me){ee(me)},activeOptionIndex:Ve(()=>{if(q.value&&C.value===null&&(be.virtual.value?be.virtual.value.options.length>0:k.value.length>0)){if(be.virtual.value){let ke=be.virtual.value.options.findIndex(Me=>{var Oe;return!((Oe=be.virtual.value)!=null&&Oe.disabled(Me))});if(ke!==-1)return ke}let me=k.value.findIndex(ke=>!ke.dataRef.disabled);if(me!==-1)return me}return C.value}),activationTrigger:L,optionsPropsRef:M,closeCombobox(){q.value=!1,!e.disabled&&h.value!==1&&(h.value=1,C.value=null)},openCombobox(){if(q.value=!0,!e.disabled&&h.value!==0){if(be.value.value){let me=be.calculateIndex(be.value.value);me!==-1&&(C.value=me)}h.value=0}},setActivationTrigger(me){L.value=me},goToOption(me,ke,Me){q.value=!1,ce!==null&&cancelAnimationFrame(ce),ce=requestAnimationFrame(()=>{if(e.disabled||I.value&&!M.value.static&&h.value===1)return;if(be.virtual.value){C.value=me===_i.Specific?ke:Eg({focus:me},{resolveItems:()=>be.virtual.value.options,resolveActiveIndex:()=>{var rt,Ke;return(Ke=(rt=be.activeOptionIndex.value)!=null?rt:be.virtual.value.options.findIndex(dt=>{var nt;return!((nt=be.virtual.value)!=null&&nt.disabled(dt))}))!=null?Ke:null},resolveDisabled:rt=>be.virtual.value.disabled(rt),resolveId(){throw new Error("Function not implemented.")}}),L.value=Me??2;return}let Oe=X();if(Oe.activeOptionIndex===null){let rt=Oe.options.findIndex(Ke=>!Ke.dataRef.disabled);rt!==-1&&(Oe.activeOptionIndex=rt)}let Ge=me===_i.Specific?ke:Eg({focus:me},{resolveItems:()=>Oe.options,resolveActiveIndex:()=>Oe.activeOptionIndex,resolveId:rt=>rt.id,resolveDisabled:rt=>rt.dataRef.disabled});C.value=Ge,L.value=Me??2,k.value=Oe.options})},selectOption(me){let ke=k.value.find(Oe=>Oe.id===me);if(!ke)return;let{dataRef:Me}=ke;oe(Me.value)},selectActiveOption(){if(be.activeOptionIndex.value!==null){if(be.virtual.value)oe(be.virtual.value.options[be.activeOptionIndex.value]);else{let{dataRef:me}=k.value[be.activeOptionIndex.value];oe(me.value)}be.goToOption(_i.Specific,be.activeOptionIndex.value)}},registerOption(me,ke){let Me=Bo({id:me,dataRef:ke});if(be.virtual.value){k.value.push(Me);return}ne&&cancelAnimationFrame(ne);let Oe=X(Ge=>(Ge.push(Me),Ge));C.value===null&&be.isSelected(ke.value.value)&&(Oe.activeOptionIndex=Oe.options.indexOf(Me)),k.value=Oe.options,C.value=Oe.activeOptionIndex,L.value=2,Oe.options.some(Ge=>!Xt(Ge.dataRef.domRef))&&(ne=requestAnimationFrame(()=>{let Ge=X();k.value=Ge.options,C.value=Ge.activeOptionIndex}))},unregisterOption(me,ke){if(ce!==null&&cancelAnimationFrame(ce),ke&&(q.value=!0),be.virtual.value){k.value=k.value.filter(Oe=>Oe.id!==me);return}let Me=X(Oe=>{let Ge=Oe.findIndex(rt=>rt.id===me);return Ge!==-1&&Oe.splice(Ge,1),Oe});k.value=Me.options,C.value=Me.activeOptionIndex,L.value=2},isSelected(me){return Gr(W.value,{0:()=>be.compare(Vt(be.value.value),Vt(me)),1:()=>Vt(be.value.value).some(ke=>be.compare(Vt(ke),Vt(me)))})},isActive(me){return C.value===be.calculateIndex(me)}};X1([m,c,I],()=>be.closeCombobox(),Ve(()=>h.value===0)),aa(cw,be),ow(Ve(()=>Gr(h.value,{0:ps.Open,1:ps.Closed})));let Le=Ve(()=>{var me;return(me=Xt(m))==null?void 0:me.closest("form")});return Wr(()=>{Zi([Le],()=>{if(!Le.value||e.defaultValue===void 0)return;function me(){be.change(e.defaultValue)}return Le.value.addEventListener("reset",me),()=>{var ke;(ke=Le.value)==null||ke.removeEventListener("reset",me)}},{immediate:!0})}),()=>{var me,ke,Me;let{name:Oe,disabled:Ge,form:rt,...Ke}=e,dt={open:h.value===0,disabled:Ge,activeIndex:be.activeOptionIndex.value,activeOption:be.activeOptionIndex.value===null?null:be.virtual.value?be.virtual.value.options[(me=be.activeOptionIndex.value)!=null?me:0]:(Me=(ke=be.options.value[be.activeOptionIndex.value])==null?void 0:ke.dataRef.value)!=null?Me:null,value:H.value};return Nn(ar,[...Oe!=null&&H.value!=null?wy({[Oe]:H.value}).map(([nt,ti])=>Nn(iw,tw({features:by.Hidden,key:nt,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:rt,disabled:Ge,name:nt,value:ti}))):[],jo({theirProps:{...s,...gh(Ke,["by","defaultValue","immediate","modelValue","multiple","nullable","onUpdate:modelValue","virtual"])},ourProps:{},slot:dt,slots:n,attrs:s,name:"Combobox"})])}}}),mz=Ri({name:"ComboboxButton",props:{as:{type:[Object,String],default:"button"},id:{type:String,default:null}},setup(e,{attrs:n,slots:s,expose:u}){var h;let g=(h=e.id)!=null?h:`headlessui-combobox-button-${tl()}`,m=bc("ComboboxButton");u({el:m.buttonRef,$el:m.buttonRef});function c(k){m.disabled.value||(m.comboboxState.value===0?m.closeCombobox():(k.preventDefault(),m.openCombobox()),qr(()=>{var C;return(C=Xt(m.inputRef))==null?void 0:C.focus({preventScroll:!0})}))}function I(k){switch(k.key){case bi.ArrowDown:k.preventDefault(),k.stopPropagation(),m.comboboxState.value===1&&m.openCombobox(),qr(()=>{var C;return(C=m.inputRef.value)==null?void 0:C.focus({preventScroll:!0})});return;case bi.ArrowUp:k.preventDefault(),k.stopPropagation(),m.comboboxState.value===1&&(m.openCombobox(),qr(()=>{m.value.value||m.goToOption(_i.Last)})),qr(()=>{var C;return(C=m.inputRef.value)==null?void 0:C.focus({preventScroll:!0})});return;case bi.Escape:if(m.comboboxState.value!==0)return;k.preventDefault(),m.optionsRef.value&&!m.optionsPropsRef.value.static&&k.stopPropagation(),m.closeCombobox(),qr(()=>{var C;return(C=m.inputRef.value)==null?void 0:C.focus({preventScroll:!0})});return}}let M=J1(Ve(()=>({as:e.as,type:n.type})),m.buttonRef);return()=>{var k,C;let L={open:m.comboboxState.value===0,disabled:m.disabled.value,value:m.value.value},{...q}=e,X={ref:m.buttonRef,id:g,type:M.value,tabindex:"-1","aria-haspopup":"listbox","aria-controls":(k=Xt(m.optionsRef))==null?void 0:k.id,"aria-expanded":m.comboboxState.value===0,"aria-labelledby":m.labelRef.value?[(C=Xt(m.labelRef))==null?void 0:C.id,g].join(" "):void 0,disabled:m.disabled.value===!0?!0:void 0,onKeydown:I,onClick:c};return jo({ourProps:X,theirProps:q,slot:L,attrs:n,slots:s,name:"ComboboxButton"})}}}),gz=Ri({name:"ComboboxInput",props:{as:{type:[Object,String],default:"input"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},displayValue:{type:Function},defaultValue:{type:String,default:void 0},id:{type:String,default:null}},emits:{change:e=>!0},setup(e,{emit:n,attrs:s,slots:u,expose:h}){var g;let m=(g=e.id)!=null?g:`headlessui-combobox-input-${tl()}`,c=bc("ComboboxInput"),I=Ve(()=>vy(Xt(c.inputRef))),M={value:!1};h({el:c.inputRef,$el:c.inputRef});function k(){c.change(null);let ne=Xt(c.optionsRef);ne&&(ne.scrollTop=0),c.goToOption(_i.Nothing)}let C=Ve(()=>{var ne;let oe=c.value.value;return Xt(c.inputRef)?typeof e.displayValue<"u"&&oe!==void 0?(ne=e.displayValue(oe))!=null?ne:"":typeof oe=="string"?oe:"":""});Wr(()=>{Zi([C,c.comboboxState,I],([ne,oe],[Ae,be])=>{if(M.value)return;let Le=Xt(c.inputRef);Le&&((be===0&&oe===1||ne!==Ae)&&(Le.value=ne),requestAnimationFrame(()=>{var me;if(M.value||!Le||((me=I.value)==null?void 0:me.activeElement)!==Le)return;let{selectionStart:ke,selectionEnd:Me}=Le;Math.abs((Me??0)-(ke??0))===0&&ke===0&&Le.setSelectionRange(Le.value.length,Le.value.length)}))},{immediate:!0}),Zi([c.comboboxState],([ne],[oe])=>{if(ne===0&&oe===1){if(M.value)return;let Ae=Xt(c.inputRef);if(!Ae)return;let be=Ae.value,{selectionStart:Le,selectionEnd:me,selectionDirection:ke}=Ae;Ae.value="",Ae.value=be,ke!==null?Ae.setSelectionRange(Le,me,ke):Ae.setSelectionRange(Le,me)}})});let L=kt(!1);function q(){L.value=!0}function X(){Tf().nextFrame(()=>{L.value=!1})}let W=qP();function ae(ne){switch(M.value=!0,W(()=>{M.value=!1}),ne.key){case bi.Enter:if(M.value=!1,c.comboboxState.value!==0||L.value)return;if(ne.preventDefault(),ne.stopPropagation(),c.activeOptionIndex.value===null){c.closeCombobox();return}c.selectActiveOption(),c.mode.value===0&&c.closeCombobox();break;case bi.ArrowDown:return M.value=!1,ne.preventDefault(),ne.stopPropagation(),Gr(c.comboboxState.value,{0:()=>c.goToOption(_i.Next),1:()=>c.openCombobox()});case bi.ArrowUp:return M.value=!1,ne.preventDefault(),ne.stopPropagation(),Gr(c.comboboxState.value,{0:()=>c.goToOption(_i.Previous),1:()=>{c.openCombobox(),qr(()=>{c.value.value||c.goToOption(_i.Last)})}});case bi.Home:if(ne.shiftKey)break;return M.value=!1,ne.preventDefault(),ne.stopPropagation(),c.goToOption(_i.First);case bi.PageUp:return M.value=!1,ne.preventDefault(),ne.stopPropagation(),c.goToOption(_i.First);case bi.End:if(ne.shiftKey)break;return M.value=!1,ne.preventDefault(),ne.stopPropagation(),c.goToOption(_i.Last);case bi.PageDown:return M.value=!1,ne.preventDefault(),ne.stopPropagation(),c.goToOption(_i.Last);case bi.Escape:if(M.value=!1,c.comboboxState.value!==0)return;ne.preventDefault(),c.optionsRef.value&&!c.optionsPropsRef.value.static&&ne.stopPropagation(),c.nullable.value&&c.mode.value===0&&c.value.value===null&&k(),c.closeCombobox();break;case bi.Tab:if(M.value=!1,c.comboboxState.value!==0)return;c.mode.value===0&&c.activationTrigger.value!==1&&c.selectActiveOption(),c.closeCombobox();break}}function Ie(ne){n("change",ne),c.nullable.value&&c.mode.value===0&&ne.target.value===""&&k(),c.openCombobox()}function ee(ne){var oe,Ae,be;let Le=(oe=ne.relatedTarget)!=null?oe:Ha.find(me=>me!==ne.currentTarget);if(M.value=!1,!((Ae=Xt(c.optionsRef))!=null&&Ae.contains(Le))&&!((be=Xt(c.buttonRef))!=null&&be.contains(Le))&&c.comboboxState.value===0)return ne.preventDefault(),c.mode.value===0&&(c.nullable.value&&c.value.value===null?k():c.activationTrigger.value!==1&&c.selectActiveOption()),c.closeCombobox()}function H(ne){var oe,Ae,be;let Le=(oe=ne.relatedTarget)!=null?oe:Ha.find(me=>me!==ne.currentTarget);(Ae=Xt(c.buttonRef))!=null&&Ae.contains(Le)||(be=Xt(c.optionsRef))!=null&&be.contains(Le)||c.disabled.value||c.immediate.value&&c.comboboxState.value!==0&&(c.openCombobox(),Tf().nextFrame(()=>{c.setActivationTrigger(1)}))}let ce=Ve(()=>{var ne,oe,Ae,be;return(be=(Ae=(oe=e.defaultValue)!=null?oe:c.defaultValue.value!==void 0?(ne=e.displayValue)==null?void 0:ne.call(e,c.defaultValue.value):null)!=null?Ae:c.defaultValue.value)!=null?be:""});return()=>{var ne,oe,Ae,be,Le,me,ke;let Me={open:c.comboboxState.value===0},{displayValue:Oe,onChange:Ge,...rt}=e,Ke={"aria-controls":(ne=c.optionsRef.value)==null?void 0:ne.id,"aria-expanded":c.comboboxState.value===0,"aria-activedescendant":c.activeOptionIndex.value===null?void 0:c.virtual.value?(oe=c.options.value.find(dt=>!c.virtual.value.disabled(dt.dataRef.value)&&c.compare(dt.dataRef.value,c.virtual.value.options[c.activeOptionIndex.value])))==null?void 0:oe.id:(Ae=c.options.value[c.activeOptionIndex.value])==null?void 0:Ae.id,"aria-labelledby":(me=(be=Xt(c.labelRef))==null?void 0:be.id)!=null?me:(Le=Xt(c.buttonRef))==null?void 0:Le.id,"aria-autocomplete":"list",id:m,onCompositionstart:q,onCompositionend:X,onKeydown:ae,onInput:Ie,onFocus:H,onBlur:ee,role:"combobox",type:(ke=s.type)!=null?ke:"text",tabIndex:0,ref:c.inputRef,defaultValue:ce.value,disabled:c.disabled.value===!0?!0:void 0};return jo({ourProps:Ke,theirProps:rt,slot:Me,attrs:s,slots:u,features:Ya.RenderStrategy|Ya.Static,name:"ComboboxInput"})}}}),yz=Ri({name:"ComboboxOptions",props:{as:{type:[Object,String],default:"ul"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},hold:{type:[Boolean],default:!1}},setup(e,{attrs:n,slots:s,expose:u}){let h=bc("ComboboxOptions"),g=`headlessui-combobox-options-${tl()}`;u({el:h.optionsRef,$el:h.optionsRef}),Vn(()=>{h.optionsPropsRef.value.static=e.static}),Vn(()=>{h.optionsPropsRef.value.hold=e.hold});let m=nw(),c=Ve(()=>m!==null?(m.value&ps.Open)===ps.Open:h.comboboxState.value===0);rz({container:Ve(()=>Xt(h.optionsRef)),enabled:Ve(()=>h.comboboxState.value===0),accept(M){return M.getAttribute("role")==="option"?NodeFilter.FILTER_REJECT:M.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(M){M.setAttribute("role","none")}});function I(M){M.preventDefault()}return()=>{var M,k,C;let L={open:h.comboboxState.value===0},q={"aria-labelledby":(C=(M=Xt(h.labelRef))==null?void 0:M.id)!=null?C:(k=Xt(h.buttonRef))==null?void 0:k.id,id:g,ref:h.optionsRef,role:"listbox","aria-multiselectable":h.mode.value===1?!0:void 0,onMousedown:I},X=gh(e,["hold"]);return jo({ourProps:q,theirProps:X,slot:L,attrs:n,slots:h.virtual.value&&h.comboboxState.value===0?{...s,default:()=>[Nn(fz,{},s.default)]}:s,features:Ya.RenderStrategy|Ya.Static,visible:c.value,name:"ComboboxOptions"})}}}),_z=Ri({name:"ComboboxOption",props:{as:{type:[Object,String],default:"li"},value:{type:[Object,String,Number,Boolean]},disabled:{type:Boolean,default:!1},order:{type:[Number],default:null}},setup(e,{slots:n,attrs:s,expose:u}){let h=bc("ComboboxOption"),g=`headlessui-combobox-option-${tl()}`,m=kt(null),c=Ve(()=>e.disabled);u({el:m,$el:m});let I=Ve(()=>{var ee;return h.virtual.value?h.activeOptionIndex.value===h.calculateIndex(e.value):h.activeOptionIndex.value===null?!1:((ee=h.options.value[h.activeOptionIndex.value])==null?void 0:ee.id)===g}),M=Ve(()=>h.isSelected(e.value)),k=Zr(uw,null),C=Ve(()=>({disabled:e.disabled,value:e.value,domRef:m,order:Ve(()=>e.order)}));Wr(()=>h.registerOption(g,C)),sa(()=>h.unregisterOption(g,I.value)),Vn(()=>{let ee=Xt(m);ee&&(k==null||k.value.measureElement(ee))}),Vn(()=>{h.comboboxState.value===0&&I.value&&(h.virtual.value||h.activationTrigger.value!==0&&qr(()=>{var ee,H;return(H=(ee=Xt(m))==null?void 0:ee.scrollIntoView)==null?void 0:H.call(ee,{block:"nearest"})}))});function L(ee){ee.preventDefault(),ee.button===sw.Left&&(c.value||(h.selectOption(g),K1()||requestAnimationFrame(()=>{var H;return(H=Xt(h.inputRef))==null?void 0:H.focus({preventScroll:!0})}),h.mode.value===0&&h.closeCombobox()))}function q(){var ee;if(e.disabled||(ee=h.virtual.value)!=null&&ee.disabled(e.value))return h.goToOption(_i.Nothing);let H=h.calculateIndex(e.value);h.goToOption(_i.Specific,H)}let X=Y1();function W(ee){X.update(ee)}function ae(ee){var H;if(!X.wasMoved(ee)||e.disabled||(H=h.virtual.value)!=null&&H.disabled(e.value)||I.value)return;let ce=h.calculateIndex(e.value);h.goToOption(_i.Specific,ce,0)}function Ie(ee){var H;X.wasMoved(ee)&&(e.disabled||(H=h.virtual.value)!=null&&H.disabled(e.value)||I.value&&(h.optionsPropsRef.value.hold||h.goToOption(_i.Nothing)))}return()=>{let{disabled:ee}=e,H={active:I.value,selected:M.value,disabled:ee},ce={id:g,ref:m,role:"option",tabIndex:ee===!0?void 0:-1,"aria-disabled":ee===!0?!0:void 0,"aria-selected":M.value,disabled:void 0,onMousedown:L,onFocus:q,onPointerenter:W,onMouseenter:W,onPointermove:ae,onMousemove:ae,onPointerleave:Ie,onMouseleave:Ie},ne=gh(e,["order","value"]);return jo({ourProps:ce,theirProps:ne,slot:H,attrs:s,slots:n,name:"ComboboxOption"})}}}),Qv=/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g;function ex(e){var n,s;let u=(n=e.innerText)!=null?n:"",h=e.cloneNode(!0);if(!(h instanceof HTMLElement))return u;let g=!1;for(let c of h.querySelectorAll('[hidden],[aria-hidden],[role="img"]'))c.remove(),g=!0;let m=g?(s=h.innerText)!=null?s:"":u;return Qv.test(m)&&(m=m.replace(Qv,"")),m}function vz(e){let n=e.getAttribute("aria-label");if(typeof n=="string")return n.trim();let s=e.getAttribute("aria-labelledby");if(s){let u=s.split(" ").map(h=>{let g=document.getElementById(h);if(g){let m=g.getAttribute("aria-label");return typeof m=="string"?m.trim():ex(g).trim()}return null}).filter(Boolean);if(u.length>0)return u.join(", ")}return ex(e).trim()}function xz(e){let n=kt(""),s=kt("");return()=>{let u=Xt(e);if(!u)return"";let h=u.innerText;if(n.value===h)return s.value;let g=vz(u).trim().toLowerCase();return n.value=h,s.value=g,g}}function bz(e,n){return e===n}var wz=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(wz||{}),Ez=(e=>(e[e.Single=0]="Single",e[e.Multi=1]="Multi",e))(Ez||{}),Sz=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(Sz||{});function Iz(e){requestAnimationFrame(()=>requestAnimationFrame(e))}let hw=Symbol("ListboxContext");function Xf(e){let n=Zr(hw,null);if(n===null){let s=new Error(`<${e} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(s,Xf),s}return n}let Tz=Ri({name:"Listbox",emits:{"update:modelValue":e=>!0},props:{as:{type:[Object,String],default:"template"},disabled:{type:[Boolean],default:!1},by:{type:[String,Function],default:()=>bz},horizontal:{type:[Boolean],default:!1},modelValue:{type:[Object,String,Number,Boolean],default:void 0},defaultValue:{type:[Object,String,Number,Boolean],default:void 0},form:{type:String,optional:!0},name:{type:String,optional:!0},multiple:{type:[Boolean],default:!1}},inheritAttrs:!1,setup(e,{slots:n,attrs:s,emit:u}){let h=kt(1),g=kt(null),m=kt(null),c=kt(null),I=kt([]),M=kt(""),k=kt(null),C=kt(1);function L(H=ce=>ce){let ce=k.value!==null?I.value[k.value]:null,ne=W1(H(I.value.slice()),Ae=>Xt(Ae.dataRef.domRef)),oe=ce?ne.indexOf(ce):null;return oe===-1&&(oe=null),{options:ne,activeOptionIndex:oe}}let q=Ve(()=>e.multiple?1:0),[X,W]=H1(Ve(()=>e.modelValue),H=>u("update:modelValue",H),Ve(()=>e.defaultValue)),ae=Ve(()=>X.value===void 0?Gr(q.value,{1:[],0:void 0}):X.value),Ie={listboxState:h,value:ae,mode:q,compare(H,ce){if(typeof e.by=="string"){let ne=e.by;return(H==null?void 0:H[ne])===(ce==null?void 0:ce[ne])}return e.by(H,ce)},orientation:Ve(()=>e.horizontal?"horizontal":"vertical"),labelRef:g,buttonRef:m,optionsRef:c,disabled:Ve(()=>e.disabled),options:I,searchQuery:M,activeOptionIndex:k,activationTrigger:C,closeListbox(){e.disabled||h.value!==1&&(h.value=1,k.value=null)},openListbox(){e.disabled||h.value!==0&&(h.value=0)},goToOption(H,ce,ne){if(e.disabled||h.value===1)return;let oe=L(),Ae=Eg(H===_i.Specific?{focus:_i.Specific,id:ce}:{focus:H},{resolveItems:()=>oe.options,resolveActiveIndex:()=>oe.activeOptionIndex,resolveId:be=>be.id,resolveDisabled:be=>be.dataRef.disabled});M.value="",k.value=Ae,C.value=ne??1,I.value=oe.options},search(H){if(e.disabled||h.value===1)return;let ce=M.value!==""?0:1;M.value+=H.toLowerCase();let ne=(k.value!==null?I.value.slice(k.value+ce).concat(I.value.slice(0,k.value+ce)):I.value).find(Ae=>Ae.dataRef.textValue.startsWith(M.value)&&!Ae.dataRef.disabled),oe=ne?I.value.indexOf(ne):-1;oe===-1||oe===k.value||(k.value=oe,C.value=1)},clearSearch(){e.disabled||h.value!==1&&M.value!==""&&(M.value="")},registerOption(H,ce){let ne=L(oe=>[...oe,{id:H,dataRef:ce}]);I.value=ne.options,k.value=ne.activeOptionIndex},unregisterOption(H){let ce=L(ne=>{let oe=ne.findIndex(Ae=>Ae.id===H);return oe!==-1&&ne.splice(oe,1),ne});I.value=ce.options,k.value=ce.activeOptionIndex,C.value=1},theirOnChange(H){e.disabled||W(H)},select(H){e.disabled||W(Gr(q.value,{0:()=>H,1:()=>{let ce=Vt(Ie.value.value).slice(),ne=Vt(H),oe=ce.findIndex(Ae=>Ie.compare(ne,Vt(Ae)));return oe===-1?ce.push(ne):ce.splice(oe,1),ce}}))}};X1([m,c],(H,ce)=>{var ne;Ie.closeListbox(),Z1(ce,xy.Loose)||(H.preventDefault(),(ne=Xt(m))==null||ne.focus())},Ve(()=>h.value===0)),aa(hw,Ie),ow(Ve(()=>Gr(h.value,{0:ps.Open,1:ps.Closed})));let ee=Ve(()=>{var H;return(H=Xt(m))==null?void 0:H.closest("form")});return Wr(()=>{Zi([ee],()=>{if(!ee.value||e.defaultValue===void 0)return;function H(){Ie.theirOnChange(e.defaultValue)}return ee.value.addEventListener("reset",H),()=>{var ce;(ce=ee.value)==null||ce.removeEventListener("reset",H)}},{immediate:!0})}),()=>{let{name:H,modelValue:ce,disabled:ne,form:oe,...Ae}=e,be={open:h.value===0,disabled:ne,value:ae.value};return Nn(ar,[...H!=null&&ae.value!=null?wy({[H]:ae.value}).map(([Le,me])=>Nn(iw,tw({features:by.Hidden,key:Le,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:oe,disabled:ne,name:Le,value:me}))):[],jo({ourProps:{},theirProps:{...s,...gh(Ae,["defaultValue","onUpdate:modelValue","horizontal","multiple","by"])},slot:be,slots:n,attrs:s,name:"Listbox"})])}}}),Cz=Ri({name:"ListboxButton",props:{as:{type:[Object,String],default:"button"},id:{type:String,default:null}},setup(e,{attrs:n,slots:s,expose:u}){var h;let g=(h=e.id)!=null?h:`headlessui-listbox-button-${tl()}`,m=Xf("ListboxButton");u({el:m.buttonRef,$el:m.buttonRef});function c(C){switch(C.key){case bi.Space:case bi.Enter:case bi.ArrowDown:C.preventDefault(),m.openListbox(),qr(()=>{var L;(L=Xt(m.optionsRef))==null||L.focus({preventScroll:!0}),m.value.value||m.goToOption(_i.First)});break;case bi.ArrowUp:C.preventDefault(),m.openListbox(),qr(()=>{var L;(L=Xt(m.optionsRef))==null||L.focus({preventScroll:!0}),m.value.value||m.goToOption(_i.Last)});break}}function I(C){switch(C.key){case bi.Space:C.preventDefault();break}}function M(C){m.disabled.value||(m.listboxState.value===0?(m.closeListbox(),qr(()=>{var L;return(L=Xt(m.buttonRef))==null?void 0:L.focus({preventScroll:!0})})):(C.preventDefault(),m.openListbox(),Iz(()=>{var L;return(L=Xt(m.optionsRef))==null?void 0:L.focus({preventScroll:!0})})))}let k=J1(Ve(()=>({as:e.as,type:n.type})),m.buttonRef);return()=>{var C,L;let q={open:m.listboxState.value===0,disabled:m.disabled.value,value:m.value.value},{...X}=e,W={ref:m.buttonRef,id:g,type:k.value,"aria-haspopup":"listbox","aria-controls":(C=Xt(m.optionsRef))==null?void 0:C.id,"aria-expanded":m.listboxState.value===0,"aria-labelledby":m.labelRef.value?[(L=Xt(m.labelRef))==null?void 0:L.id,g].join(" "):void 0,disabled:m.disabled.value===!0?!0:void 0,onKeydown:c,onKeyup:I,onClick:M};return jo({ourProps:W,theirProps:X,slot:q,attrs:n,slots:s,name:"ListboxButton"})}}}),Az=Ri({name:"ListboxOptions",props:{as:{type:[Object,String],default:"ul"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:null}},setup(e,{attrs:n,slots:s,expose:u}){var h;let g=(h=e.id)!=null?h:`headlessui-listbox-options-${tl()}`,m=Xf("ListboxOptions"),c=kt(null);u({el:m.optionsRef,$el:m.optionsRef});function I(C){switch(c.value&&clearTimeout(c.value),C.key){case bi.Space:if(m.searchQuery.value!=="")return C.preventDefault(),C.stopPropagation(),m.search(C.key);case bi.Enter:if(C.preventDefault(),C.stopPropagation(),m.activeOptionIndex.value!==null){let L=m.options.value[m.activeOptionIndex.value];m.select(L.dataRef.value)}m.mode.value===0&&(m.closeListbox(),qr(()=>{var L;return(L=Xt(m.buttonRef))==null?void 0:L.focus({preventScroll:!0})}));break;case Gr(m.orientation.value,{vertical:bi.ArrowDown,horizontal:bi.ArrowRight}):return C.preventDefault(),C.stopPropagation(),m.goToOption(_i.Next);case Gr(m.orientation.value,{vertical:bi.ArrowUp,horizontal:bi.ArrowLeft}):return C.preventDefault(),C.stopPropagation(),m.goToOption(_i.Previous);case bi.Home:case bi.PageUp:return C.preventDefault(),C.stopPropagation(),m.goToOption(_i.First);case bi.End:case bi.PageDown:return C.preventDefault(),C.stopPropagation(),m.goToOption(_i.Last);case bi.Escape:C.preventDefault(),C.stopPropagation(),m.closeListbox(),qr(()=>{var L;return(L=Xt(m.buttonRef))==null?void 0:L.focus({preventScroll:!0})});break;case bi.Tab:C.preventDefault(),C.stopPropagation();break;default:C.key.length===1&&(m.search(C.key),c.value=setTimeout(()=>m.clearSearch(),350));break}}let M=nw(),k=Ve(()=>M!==null?(M.value&ps.Open)===ps.Open:m.listboxState.value===0);return()=>{var C,L;let q={open:m.listboxState.value===0},{...X}=e,W={"aria-activedescendant":m.activeOptionIndex.value===null||(C=m.options.value[m.activeOptionIndex.value])==null?void 0:C.id,"aria-multiselectable":m.mode.value===1?!0:void 0,"aria-labelledby":(L=Xt(m.buttonRef))==null?void 0:L.id,"aria-orientation":m.orientation.value,id:g,onKeydown:I,role:"listbox",tabIndex:0,ref:m.optionsRef};return jo({ourProps:W,theirProps:X,slot:q,attrs:n,slots:s,features:Ya.RenderStrategy|Ya.Static,visible:k.value,name:"ListboxOptions"})}}}),kz=Ri({name:"ListboxOption",props:{as:{type:[Object,String],default:"li"},value:{type:[Object,String,Number,Boolean]},disabled:{type:Boolean,default:!1},id:{type:String,default:null}},setup(e,{slots:n,attrs:s,expose:u}){var h;let g=(h=e.id)!=null?h:`headlessui-listbox-option-${tl()}`,m=Xf("ListboxOption"),c=kt(null);u({el:c,$el:c});let I=Ve(()=>m.activeOptionIndex.value!==null?m.options.value[m.activeOptionIndex.value].id===g:!1),M=Ve(()=>Gr(m.mode.value,{0:()=>m.compare(Vt(m.value.value),Vt(e.value)),1:()=>Vt(m.value.value).some(H=>m.compare(Vt(H),Vt(e.value)))})),k=Ve(()=>Gr(m.mode.value,{1:()=>{var H;let ce=Vt(m.value.value);return((H=m.options.value.find(ne=>ce.some(oe=>m.compare(Vt(oe),Vt(ne.dataRef.value)))))==null?void 0:H.id)===g},0:()=>M.value})),C=xz(c),L=Ve(()=>({disabled:e.disabled,value:e.value,get textValue(){return C()},domRef:c}));Wr(()=>m.registerOption(g,L)),sa(()=>m.unregisterOption(g)),Wr(()=>{Zi([m.listboxState,M],()=>{m.listboxState.value===0&&M.value&&Gr(m.mode.value,{1:()=>{k.value&&m.goToOption(_i.Specific,g)},0:()=>{m.goToOption(_i.Specific,g)}})},{immediate:!0})}),Vn(()=>{m.listboxState.value===0&&I.value&&m.activationTrigger.value!==0&&qr(()=>{var H,ce;return(ce=(H=Xt(c))==null?void 0:H.scrollIntoView)==null?void 0:ce.call(H,{block:"nearest"})})});function q(H){if(e.disabled)return H.preventDefault();m.select(e.value),m.mode.value===0&&(m.closeListbox(),qr(()=>{var ce;return(ce=Xt(m.buttonRef))==null?void 0:ce.focus({preventScroll:!0})}))}function X(){if(e.disabled)return m.goToOption(_i.Nothing);m.goToOption(_i.Specific,g)}let W=Y1();function ae(H){W.update(H)}function Ie(H){W.wasMoved(H)&&(e.disabled||I.value||m.goToOption(_i.Specific,g,0))}function ee(H){W.wasMoved(H)&&(e.disabled||I.value&&m.goToOption(_i.Nothing))}return()=>{let{disabled:H}=e,ce={active:I.value,selected:M.value,disabled:H},{value:ne,disabled:oe,...Ae}=e,be={id:g,ref:c,role:"option",tabIndex:H===!0?void 0:-1,"aria-disabled":H===!0?!0:void 0,"aria-selected":M.value,disabled:void 0,onClick:q,onFocus:X,onPointerenter:ae,onMouseenter:ae,onPointermove:Ie,onMousemove:Ie,onPointerleave:ee,onMouseleave:ee};return jo({ourProps:be,theirProps:Ae,slot:ce,attrs:s,slots:n,name:"ListboxOption"})}}});function $n(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var n=e.ownerDocument;return n&&n.defaultView||window}return e}function Qa(e){var n=$n(e).Element;return e instanceof n||e instanceof Element}function to(e){var n=$n(e).HTMLElement;return e instanceof n||e instanceof HTMLElement}function Ey(e){if(typeof ShadowRoot>"u")return!1;var n=$n(e).ShadowRoot;return e instanceof n||e instanceof ShadowRoot}var Ka=Math.max,Cf=Math.min,pc=Math.round;function Sg(){var e=navigator.userAgentData;return e!=null&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(n){return n.brand+"/"+n.version}).join(" "):navigator.userAgent}function dw(){return!/^((?!chrome|android).)*safari/i.test(Sg())}function mc(e,n,s){n===void 0&&(n=!1),s===void 0&&(s=!1);var u=e.getBoundingClientRect(),h=1,g=1;n&&to(e)&&(h=e.offsetWidth>0&&pc(u.width)/e.offsetWidth||1,g=e.offsetHeight>0&&pc(u.height)/e.offsetHeight||1);var m=Qa(e)?$n(e):window,c=m.visualViewport,I=!dw()&&s,M=(u.left+(I&&c?c.offsetLeft:0))/h,k=(u.top+(I&&c?c.offsetTop:0))/g,C=u.width/h,L=u.height/g;return{width:C,height:L,top:k,right:M+C,bottom:k+L,left:M,x:M,y:k}}function Sy(e){var n=$n(e),s=n.pageXOffset,u=n.pageYOffset;return{scrollLeft:s,scrollTop:u}}function Mz(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function Lz(e){return e===$n(e)||!to(e)?Sy(e):Mz(e)}function No(e){return e?(e.nodeName||"").toLowerCase():null}function ua(e){return((Qa(e)?e.ownerDocument:e.document)||window.document).documentElement}function Iy(e){return mc(ua(e)).left+Sy(e).scrollLeft}function ms(e){return $n(e).getComputedStyle(e)}function Ty(e){var n=ms(e),s=n.overflow,u=n.overflowX,h=n.overflowY;return/auto|scroll|overlay|hidden/.test(s+h+u)}function Pz(e){var n=e.getBoundingClientRect(),s=pc(n.width)/e.offsetWidth||1,u=pc(n.height)/e.offsetHeight||1;return s!==1||u!==1}function zz(e,n,s){s===void 0&&(s=!1);var u=to(n),h=to(n)&&Pz(n),g=ua(n),m=mc(e,h,s),c={scrollLeft:0,scrollTop:0},I={x:0,y:0};return(u||!u&&!s)&&((No(n)!=="body"||Ty(g))&&(c=Lz(n)),to(n)?(I=mc(n,!0),I.x+=n.clientLeft,I.y+=n.clientTop):g&&(I.x=Iy(g))),{x:m.left+c.scrollLeft-I.x,y:m.top+c.scrollTop-I.y,width:m.width,height:m.height}}function Cy(e){var n=mc(e),s=e.offsetWidth,u=e.offsetHeight;return Math.abs(n.width-s)<=1&&(s=n.width),Math.abs(n.height-u)<=1&&(u=n.height),{x:e.offsetLeft,y:e.offsetTop,width:s,height:u}}function Jf(e){return No(e)==="html"?e:e.assignedSlot||e.parentNode||(Ey(e)?e.host:null)||ua(e)}function fw(e){return["html","body","#document"].indexOf(No(e))>=0?e.ownerDocument.body:to(e)&&Ty(e)?e:fw(Jf(e))}function Ju(e,n){var s;n===void 0&&(n=[]);var u=fw(e),h=u===((s=e.ownerDocument)==null?void 0:s.body),g=$n(u),m=h?[g].concat(g.visualViewport||[],Ty(u)?u:[]):u,c=n.concat(m);return h?c:c.concat(Ju(Jf(m)))}function Dz(e){return["table","td","th"].indexOf(No(e))>=0}function tx(e){return!to(e)||ms(e).position==="fixed"?null:e.offsetParent}function Rz(e){var n=/firefox/i.test(Sg()),s=/Trident/i.test(Sg());if(s&&to(e)){var u=ms(e);if(u.position==="fixed")return null}var h=Jf(e);for(Ey(h)&&(h=h.host);to(h)&&["html","body"].indexOf(No(h))<0;){var g=ms(h);if(g.transform!=="none"||g.perspective!=="none"||g.contain==="paint"||["transform","perspective"].indexOf(g.willChange)!==-1||n&&g.willChange==="filter"||n&&g.filter&&g.filter!=="none")return h;h=h.parentNode}return null}function yh(e){for(var n=$n(e),s=tx(e);s&&Dz(s)&&ms(s).position==="static";)s=tx(s);return s&&(No(s)==="html"||No(s)==="body"&&ms(s).position==="static")?n:s||Rz(e)||n}var Bn="top",go="bottom",yo="right",Fn="left",Ay="auto",_h=[Bn,go,yo,Fn],gc="start",uh="end",Oz="clippingParents",pw="viewport",Bu="popper",Bz="reference",ix=_h.reduce(function(e,n){return e.concat([n+"-"+gc,n+"-"+uh])},[]),mw=[].concat(_h,[Ay]).reduce(function(e,n){return e.concat([n,n+"-"+gc,n+"-"+uh])},[]),Fz="beforeRead",Vz="read",Nz="afterRead",$z="beforeMain",jz="main",Uz="afterMain",qz="beforeWrite",Hz="write",Gz="afterWrite",Zz=[Fz,Vz,Nz,$z,jz,Uz,qz,Hz,Gz];function Wz(e){var n=new Map,s=new Set,u=[];e.forEach(function(g){n.set(g.name,g)});function h(g){s.add(g.name);var m=[].concat(g.requires||[],g.requiresIfExists||[]);m.forEach(function(c){if(!s.has(c)){var I=n.get(c);I&&h(I)}}),u.push(g)}return e.forEach(function(g){s.has(g.name)||h(g)}),u}function Kz(e){var n=Wz(e);return Zz.reduce(function(s,u){return s.concat(n.filter(function(h){return h.phase===u}))},[])}function Xz(e){var n;return function(){return n||(n=new Promise(function(s){Promise.resolve().then(function(){n=void 0,s(e())})})),n}}function Jz(e){var n=e.reduce(function(s,u){var h=s[u.name];return s[u.name]=h?Object.assign({},h,u,{options:Object.assign({},h.options,u.options),data:Object.assign({},h.data,u.data)}):u,s},{});return Object.keys(n).map(function(s){return n[s]})}function Yz(e,n){var s=$n(e),u=ua(e),h=s.visualViewport,g=u.clientWidth,m=u.clientHeight,c=0,I=0;if(h){g=h.width,m=h.height;var M=dw();(M||!M&&n==="fixed")&&(c=h.offsetLeft,I=h.offsetTop)}return{width:g,height:m,x:c+Iy(e),y:I}}function Qz(e){var n,s=ua(e),u=Sy(e),h=(n=e.ownerDocument)==null?void 0:n.body,g=Ka(s.scrollWidth,s.clientWidth,h?h.scrollWidth:0,h?h.clientWidth:0),m=Ka(s.scrollHeight,s.clientHeight,h?h.scrollHeight:0,h?h.clientHeight:0),c=-u.scrollLeft+Iy(e),I=-u.scrollTop;return ms(h||s).direction==="rtl"&&(c+=Ka(s.clientWidth,h?h.clientWidth:0)-g),{width:g,height:m,x:c,y:I}}function gw(e,n){var s=n.getRootNode&&n.getRootNode();if(e.contains(n))return!0;if(s&&Ey(s)){var u=n;do{if(u&&e.isSameNode(u))return!0;u=u.parentNode||u.host}while(u)}return!1}function Ig(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function e5(e,n){var s=mc(e,!1,n==="fixed");return s.top=s.top+e.clientTop,s.left=s.left+e.clientLeft,s.bottom=s.top+e.clientHeight,s.right=s.left+e.clientWidth,s.width=e.clientWidth,s.height=e.clientHeight,s.x=s.left,s.y=s.top,s}function rx(e,n,s){return n===pw?Ig(Yz(e,s)):Qa(n)?e5(n,s):Ig(Qz(ua(e)))}function t5(e){var n=Ju(Jf(e)),s=["absolute","fixed"].indexOf(ms(e).position)>=0,u=s&&to(e)?yh(e):e;return Qa(u)?n.filter(function(h){return Qa(h)&&gw(h,u)&&No(h)!=="body"}):[]}function i5(e,n,s,u){var h=n==="clippingParents"?t5(e):[].concat(n),g=[].concat(h,[s]),m=g[0],c=g.reduce(function(I,M){var k=rx(e,M,u);return I.top=Ka(k.top,I.top),I.right=Cf(k.right,I.right),I.bottom=Cf(k.bottom,I.bottom),I.left=Ka(k.left,I.left),I},rx(e,m,u));return c.width=c.right-c.left,c.height=c.bottom-c.top,c.x=c.left,c.y=c.top,c}function Ro(e){return e.split("-")[0]}function yc(e){return e.split("-")[1]}function ky(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function yw(e){var n=e.reference,s=e.element,u=e.placement,h=u?Ro(u):null,g=u?yc(u):null,m=n.x+n.width/2-s.width/2,c=n.y+n.height/2-s.height/2,I;switch(h){case Bn:I={x:m,y:n.y-s.height};break;case go:I={x:m,y:n.y+n.height};break;case yo:I={x:n.x+n.width,y:c};break;case Fn:I={x:n.x-s.width,y:c};break;default:I={x:n.x,y:n.y}}var M=h?ky(h):null;if(M!=null){var k=M==="y"?"height":"width";switch(g){case gc:I[M]=I[M]-(n[k]/2-s[k]/2);break;case uh:I[M]=I[M]+(n[k]/2-s[k]/2);break}}return I}function _w(){return{top:0,right:0,bottom:0,left:0}}function vw(e){return Object.assign({},_w(),e)}function xw(e,n){return n.reduce(function(s,u){return s[u]=e,s},{})}function My(e,n){n===void 0&&(n={});var s=n,u=s.placement,h=u===void 0?e.placement:u,g=s.strategy,m=g===void 0?e.strategy:g,c=s.boundary,I=c===void 0?Oz:c,M=s.rootBoundary,k=M===void 0?pw:M,C=s.elementContext,L=C===void 0?Bu:C,q=s.altBoundary,X=q===void 0?!1:q,W=s.padding,ae=W===void 0?0:W,Ie=vw(typeof ae!="number"?ae:xw(ae,_h)),ee=L===Bu?Bz:Bu,H=e.rects.popper,ce=e.elements[X?ee:L],ne=i5(Qa(ce)?ce:ce.contextElement||ua(e.elements.popper),I,k,m),oe=mc(e.elements.reference),Ae=yw({reference:oe,element:H,strategy:"absolute",placement:h}),be=Ig(Object.assign({},H,Ae)),Le=L===Bu?be:oe,me={top:ne.top-Le.top+Ie.top,bottom:Le.bottom-ne.bottom+Ie.bottom,left:ne.left-Le.left+Ie.left,right:Le.right-ne.right+Ie.right},ke=e.modifiersData.offset;if(L===Bu&&ke){var Me=ke[h];Object.keys(me).forEach(function(Oe){var Ge=[yo,go].indexOf(Oe)>=0?1:-1,rt=[Bn,go].indexOf(Oe)>=0?"y":"x";me[Oe]+=Me[rt]*Ge})}return me}var nx={placement:"bottom",modifiers:[],strategy:"absolute"};function ox(){for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];return!n.some(function(u){return!(u&&typeof u.getBoundingClientRect=="function")})}function r5(e){e===void 0&&(e={});var n=e,s=n.defaultModifiers,u=s===void 0?[]:s,h=n.defaultOptions,g=h===void 0?nx:h;return function(c,I,M){M===void 0&&(M=g);var k={placement:"bottom",orderedModifiers:[],options:Object.assign({},nx,g),modifiersData:{},elements:{reference:c,popper:I},attributes:{},styles:{}},C=[],L=!1,q={state:k,setOptions:function(Ie){var ee=typeof Ie=="function"?Ie(k.options):Ie;W(),k.options=Object.assign({},g,k.options,ee),k.scrollParents={reference:Qa(c)?Ju(c):c.contextElement?Ju(c.contextElement):[],popper:Ju(I)};var H=Kz(Jz([].concat(u,k.options.modifiers)));return k.orderedModifiers=H.filter(function(ce){return ce.enabled}),X(),q.update()},forceUpdate:function(){if(!L){var Ie=k.elements,ee=Ie.reference,H=Ie.popper;if(ox(ee,H)){k.rects={reference:zz(ee,yh(H),k.options.strategy==="fixed"),popper:Cy(H)},k.reset=!1,k.placement=k.options.placement,k.orderedModifiers.forEach(function(me){return k.modifiersData[me.name]=Object.assign({},me.data)});for(var ce=0;ce<k.orderedModifiers.length;ce++){if(k.reset===!0){k.reset=!1,ce=-1;continue}var ne=k.orderedModifiers[ce],oe=ne.fn,Ae=ne.options,be=Ae===void 0?{}:Ae,Le=ne.name;typeof oe=="function"&&(k=oe({state:k,options:be,name:Le,instance:q})||k)}}}},update:Xz(function(){return new Promise(function(ae){q.forceUpdate(),ae(k)})}),destroy:function(){W(),L=!0}};if(!ox(c,I))return q;q.setOptions(M).then(function(ae){!L&&M.onFirstUpdate&&M.onFirstUpdate(ae)});function X(){k.orderedModifiers.forEach(function(ae){var Ie=ae.name,ee=ae.options,H=ee===void 0?{}:ee,ce=ae.effect;if(typeof ce=="function"){var ne=ce({state:k,name:Ie,instance:q,options:H}),oe=function(){};C.push(ne||oe)}})}function W(){C.forEach(function(ae){return ae()}),C=[]}return q}}var qd={passive:!0};function n5(e){var n=e.state,s=e.instance,u=e.options,h=u.scroll,g=h===void 0?!0:h,m=u.resize,c=m===void 0?!0:m,I=$n(n.elements.popper),M=[].concat(n.scrollParents.reference,n.scrollParents.popper);return g&&M.forEach(function(k){k.addEventListener("scroll",s.update,qd)}),c&&I.addEventListener("resize",s.update,qd),function(){g&&M.forEach(function(k){k.removeEventListener("scroll",s.update,qd)}),c&&I.removeEventListener("resize",s.update,qd)}}const bw={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:n5,data:{}};function o5(e){var n=e.state,s=e.name;n.modifiersData[s]=yw({reference:n.rects.reference,element:n.rects.popper,strategy:"absolute",placement:n.placement})}const s5={name:"popperOffsets",enabled:!0,phase:"read",fn:o5,data:{}};var a5={top:"auto",right:"auto",bottom:"auto",left:"auto"};function l5(e,n){var s=e.x,u=e.y,h=n.devicePixelRatio||1;return{x:pc(s*h)/h||0,y:pc(u*h)/h||0}}function sx(e){var n,s=e.popper,u=e.popperRect,h=e.placement,g=e.variation,m=e.offsets,c=e.position,I=e.gpuAcceleration,M=e.adaptive,k=e.roundOffsets,C=e.isFixed,L=m.x,q=L===void 0?0:L,X=m.y,W=X===void 0?0:X,ae=typeof k=="function"?k({x:q,y:W}):{x:q,y:W};q=ae.x,W=ae.y;var Ie=m.hasOwnProperty("x"),ee=m.hasOwnProperty("y"),H=Fn,ce=Bn,ne=window;if(M){var oe=yh(s),Ae="clientHeight",be="clientWidth";if(oe===$n(s)&&(oe=ua(s),ms(oe).position!=="static"&&c==="absolute"&&(Ae="scrollHeight",be="scrollWidth")),oe=oe,h===Bn||(h===Fn||h===yo)&&g===uh){ce=go;var Le=C&&oe===ne&&ne.visualViewport?ne.visualViewport.height:oe[Ae];W-=Le-u.height,W*=I?1:-1}if(h===Fn||(h===Bn||h===go)&&g===uh){H=yo;var me=C&&oe===ne&&ne.visualViewport?ne.visualViewport.width:oe[be];q-=me-u.width,q*=I?1:-1}}var ke=Object.assign({position:c},M&&a5),Me=k===!0?l5({x:q,y:W},$n(s)):{x:q,y:W};if(q=Me.x,W=Me.y,I){var Oe;return Object.assign({},ke,(Oe={},Oe[ce]=ee?"0":"",Oe[H]=Ie?"0":"",Oe.transform=(ne.devicePixelRatio||1)<=1?"translate("+q+"px, "+W+"px)":"translate3d("+q+"px, "+W+"px, 0)",Oe))}return Object.assign({},ke,(n={},n[ce]=ee?W+"px":"",n[H]=Ie?q+"px":"",n.transform="",n))}function c5(e){var n=e.state,s=e.options,u=s.gpuAcceleration,h=u===void 0?!0:u,g=s.adaptive,m=g===void 0?!0:g,c=s.roundOffsets,I=c===void 0?!0:c,M={placement:Ro(n.placement),variation:yc(n.placement),popper:n.elements.popper,popperRect:n.rects.popper,gpuAcceleration:h,isFixed:n.options.strategy==="fixed"};n.modifiersData.popperOffsets!=null&&(n.styles.popper=Object.assign({},n.styles.popper,sx(Object.assign({},M,{offsets:n.modifiersData.popperOffsets,position:n.options.strategy,adaptive:m,roundOffsets:I})))),n.modifiersData.arrow!=null&&(n.styles.arrow=Object.assign({},n.styles.arrow,sx(Object.assign({},M,{offsets:n.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:I})))),n.attributes.popper=Object.assign({},n.attributes.popper,{"data-popper-placement":n.placement})}const ww={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:c5,data:{}};function u5(e){var n=e.state;Object.keys(n.elements).forEach(function(s){var u=n.styles[s]||{},h=n.attributes[s]||{},g=n.elements[s];!to(g)||!No(g)||(Object.assign(g.style,u),Object.keys(h).forEach(function(m){var c=h[m];c===!1?g.removeAttribute(m):g.setAttribute(m,c===!0?"":c)}))})}function h5(e){var n=e.state,s={popper:{position:n.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(n.elements.popper.style,s.popper),n.styles=s,n.elements.arrow&&Object.assign(n.elements.arrow.style,s.arrow),function(){Object.keys(n.elements).forEach(function(u){var h=n.elements[u],g=n.attributes[u]||{},m=Object.keys(n.styles.hasOwnProperty(u)?n.styles[u]:s[u]),c=m.reduce(function(I,M){return I[M]="",I},{});!to(h)||!No(h)||(Object.assign(h.style,c),Object.keys(g).forEach(function(I){h.removeAttribute(I)}))})}}const d5={name:"applyStyles",enabled:!0,phase:"write",fn:u5,effect:h5,requires:["computeStyles"]};var f5=[bw,s5,ww,d5],p5={left:"right",right:"left",bottom:"top",top:"bottom"};function rf(e){return e.replace(/left|right|bottom|top/g,function(n){return p5[n]})}var m5={start:"end",end:"start"};function ax(e){return e.replace(/start|end/g,function(n){return m5[n]})}function g5(e,n){n===void 0&&(n={});var s=n,u=s.placement,h=s.boundary,g=s.rootBoundary,m=s.padding,c=s.flipVariations,I=s.allowedAutoPlacements,M=I===void 0?mw:I,k=yc(u),C=k?c?ix:ix.filter(function(X){return yc(X)===k}):_h,L=C.filter(function(X){return M.indexOf(X)>=0});L.length===0&&(L=C);var q=L.reduce(function(X,W){return X[W]=My(e,{placement:W,boundary:h,rootBoundary:g,padding:m})[Ro(W)],X},{});return Object.keys(q).sort(function(X,W){return q[X]-q[W]})}function y5(e){if(Ro(e)===Ay)return[];var n=rf(e);return[ax(e),n,ax(n)]}function _5(e){var n=e.state,s=e.options,u=e.name;if(!n.modifiersData[u]._skip){for(var h=s.mainAxis,g=h===void 0?!0:h,m=s.altAxis,c=m===void 0?!0:m,I=s.fallbackPlacements,M=s.padding,k=s.boundary,C=s.rootBoundary,L=s.altBoundary,q=s.flipVariations,X=q===void 0?!0:q,W=s.allowedAutoPlacements,ae=n.options.placement,Ie=Ro(ae),ee=Ie===ae,H=I||(ee||!X?[rf(ae)]:y5(ae)),ce=[ae].concat(H).reduce(function(Qi,Oi){return Qi.concat(Ro(Oi)===Ay?g5(n,{placement:Oi,boundary:k,rootBoundary:C,padding:M,flipVariations:X,allowedAutoPlacements:W}):Oi)},[]),ne=n.rects.reference,oe=n.rects.popper,Ae=new Map,be=!0,Le=ce[0],me=0;me<ce.length;me++){var ke=ce[me],Me=Ro(ke),Oe=yc(ke)===gc,Ge=[Bn,go].indexOf(Me)>=0,rt=Ge?"width":"height",Ke=My(n,{placement:ke,boundary:k,rootBoundary:C,altBoundary:L,padding:M}),dt=Ge?Oe?yo:Fn:Oe?go:Bn;ne[rt]>oe[rt]&&(dt=rf(dt));var nt=rf(dt),ti=[];if(g&&ti.push(Ke[Me]<=0),c&&ti.push(Ke[dt]<=0,Ke[nt]<=0),ti.every(function(Qi){return Qi})){Le=ke,be=!1;break}Ae.set(ke,ti)}if(be)for(var Ut=X?3:1,Nt=function(Oi){var fi=ce.find(function(Pi){var Bi=Ae.get(Pi);if(Bi)return Bi.slice(0,Oi).every(function(Br){return Br})});if(fi)return Le=fi,"break"},jt=Ut;jt>0;jt--){var Si=Nt(jt);if(Si==="break")break}n.placement!==Le&&(n.modifiersData[u]._skip=!0,n.placement=Le,n.reset=!0)}}const v5={name:"flip",enabled:!0,phase:"main",fn:_5,requiresIfExists:["offset"],data:{_skip:!1}};function x5(e,n,s){var u=Ro(e),h=[Fn,Bn].indexOf(u)>=0?-1:1,g=typeof s=="function"?s(Object.assign({},n,{placement:e})):s,m=g[0],c=g[1];return m=m||0,c=(c||0)*h,[Fn,yo].indexOf(u)>=0?{x:c,y:m}:{x:m,y:c}}function b5(e){var n=e.state,s=e.options,u=e.name,h=s.offset,g=h===void 0?[0,0]:h,m=mw.reduce(function(k,C){return k[C]=x5(C,n.rects,g),k},{}),c=m[n.placement],I=c.x,M=c.y;n.modifiersData.popperOffsets!=null&&(n.modifiersData.popperOffsets.x+=I,n.modifiersData.popperOffsets.y+=M),n.modifiersData[u]=m}const w5={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:b5};function E5(e){return e==="x"?"y":"x"}function Yu(e,n,s){return Ka(e,Cf(n,s))}function S5(e,n,s){var u=Yu(e,n,s);return u>s?s:u}function I5(e){var n=e.state,s=e.options,u=e.name,h=s.mainAxis,g=h===void 0?!0:h,m=s.altAxis,c=m===void 0?!1:m,I=s.boundary,M=s.rootBoundary,k=s.altBoundary,C=s.padding,L=s.tether,q=L===void 0?!0:L,X=s.tetherOffset,W=X===void 0?0:X,ae=My(n,{boundary:I,rootBoundary:M,padding:C,altBoundary:k}),Ie=Ro(n.placement),ee=yc(n.placement),H=!ee,ce=ky(Ie),ne=E5(ce),oe=n.modifiersData.popperOffsets,Ae=n.rects.reference,be=n.rects.popper,Le=typeof W=="function"?W(Object.assign({},n.rects,{placement:n.placement})):W,me=typeof Le=="number"?{mainAxis:Le,altAxis:Le}:Object.assign({mainAxis:0,altAxis:0},Le),ke=n.modifiersData.offset?n.modifiersData.offset[n.placement]:null,Me={x:0,y:0};if(oe){if(g){var Oe,Ge=ce==="y"?Bn:Fn,rt=ce==="y"?go:yo,Ke=ce==="y"?"height":"width",dt=oe[ce],nt=dt+ae[Ge],ti=dt-ae[rt],Ut=q?-be[Ke]/2:0,Nt=ee===gc?Ae[Ke]:be[Ke],jt=ee===gc?-be[Ke]:-Ae[Ke],Si=n.elements.arrow,Qi=q&&Si?Cy(Si):{width:0,height:0},Oi=n.modifiersData["arrow#persistent"]?n.modifiersData["arrow#persistent"].padding:_w(),fi=Oi[Ge],Pi=Oi[rt],Bi=Yu(0,Ae[Ke],Qi[Ke]),Br=H?Ae[Ke]/2-Ut-Bi-fi-me.mainAxis:Nt-Bi-fi-me.mainAxis,pr=H?-Ae[Ke]/2+Ut+Bi+Pi+me.mainAxis:jt+Bi+Pi+me.mainAxis,Fr=n.elements.arrow&&yh(n.elements.arrow),lr=Fr?ce==="y"?Fr.clientTop||0:Fr.clientLeft||0:0,he=(Oe=ke==null?void 0:ke[ce])!=null?Oe:0,ye=dt+Br-he-lr,Be=dt+pr-he,le=Yu(q?Cf(nt,ye):nt,dt,q?Ka(ti,Be):ti);oe[ce]=le,Me[ce]=le-dt}if(c){var He,tt=ce==="x"?Bn:Fn,Ze=ce==="x"?go:yo,je=oe[ne],Qe=ne==="y"?"height":"width",We=je+ae[tt],pt=je-ae[Ze],It=[Bn,Fn].indexOf(Ie)!==-1,xt=(He=ke==null?void 0:ke[ne])!=null?He:0,Lt=It?We:je-Ae[Qe]-be[Qe]-xt+me.altAxis,Ht=It?je+Ae[Qe]+be[Qe]-xt-me.altAxis:pt,$e=q&&It?S5(Lt,je,Ht):Yu(q?Lt:We,je,q?Ht:pt);oe[ne]=$e,Me[ne]=$e-je}n.modifiersData[u]=Me}}const T5={name:"preventOverflow",enabled:!0,phase:"main",fn:I5,requiresIfExists:["offset"]};var C5=function(n,s){return n=typeof n=="function"?n(Object.assign({},s.rects,{placement:s.placement})):n,vw(typeof n!="number"?n:xw(n,_h))};function A5(e){var n,s=e.state,u=e.name,h=e.options,g=s.elements.arrow,m=s.modifiersData.popperOffsets,c=Ro(s.placement),I=ky(c),M=[Fn,yo].indexOf(c)>=0,k=M?"height":"width";if(!(!g||!m)){var C=C5(h.padding,s),L=Cy(g),q=I==="y"?Bn:Fn,X=I==="y"?go:yo,W=s.rects.reference[k]+s.rects.reference[I]-m[I]-s.rects.popper[k],ae=m[I]-s.rects.reference[I],Ie=yh(g),ee=Ie?I==="y"?Ie.clientHeight||0:Ie.clientWidth||0:0,H=W/2-ae/2,ce=C[q],ne=ee-L[k]-C[X],oe=ee/2-L[k]/2+H,Ae=Yu(ce,oe,ne),be=I;s.modifiersData[u]=(n={},n[be]=Ae,n.centerOffset=Ae-oe,n)}}function k5(e){var n=e.state,s=e.options,u=s.element,h=u===void 0?"[data-popper-arrow]":u;h!=null&&(typeof h=="string"&&(h=n.elements.popper.querySelector(h),!h)||gw(n.elements.popper,h)&&(n.elements.arrow=h))}const M5={name:"arrow",enabled:!0,phase:"main",fn:A5,effect:k5,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]},L5=r5({defaultModifiers:[...f5,w5,v5,T5,ww,bw,M5]});function P5({locked:e=!1,overflowPadding:n=8,offsetDistance:s=8,offsetSkid:u=0,gpuAcceleration:h=!0,adaptive:g=!0,scroll:m=!0,resize:c=!0,arrow:I=!1,placement:M,strategy:k},C){const L=kt(null),q=kt(null),X=kt(null);return Wr(()=>{Vn(W=>{if(!q.value||!L.value&&!(C!=null&&C.value))return;const ae=Iv(q),Ie=Iv(L);if(!(ae instanceof HTMLElement)||!Ie)return;const ee={modifiers:[{name:"flip",enabled:!e},{name:"preventOverflow",options:{padding:n}},{name:"offset",options:{offset:[u,s]}},{name:"computeStyles",options:{adaptive:g,gpuAcceleration:h}},{name:"eventListeners",options:{scroll:m,resize:c}},{name:"arrow",enabled:I}]};M&&(ee.placement=M),k&&(ee.strategy=k),X.value=L5(Ie,ae,ee),W(X.value.destroy)})}),[L,q,X]}const Mo=ys(Di.ui.strategy,Di.ui.select,jM),Hd=ys(Di.ui.strategy,Di.ui.selectMenu,UM),z5=Ri({components:{HCombobox:pz,HComboboxButton:mz,HComboboxOptions:yz,HComboboxOption:_z,HComboboxInput:gz,HListbox:Tz,HListboxButton:Cz,HListboxOptions:Az,HListboxOption:kz,UIcon:$o,UAvatar:Kf},inheritAttrs:!1,props:{modelValue:{type:[String,Number,Object,Array,Boolean],default:""},query:{type:String,default:null},by:{type:String,default:void 0},options:{type:Array,default:()=>[]},id:{type:String,default:null},name:{type:String,default:null},required:{type:Boolean,default:!1},icon:{type:String,default:null},loadingIcon:{type:String,default:()=>Mo.default.loadingIcon},leadingIcon:{type:String,default:null},trailingIcon:{type:String,default:()=>Mo.default.trailingIcon},trailing:{type:Boolean,default:!1},leading:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},selectedIcon:{type:String,default:()=>Hd.default.selectedIcon},disabled:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},searchable:{type:[Boolean,Function],default:!1},searchablePlaceholder:{type:String,default:"Search..."},searchableLazy:{type:Boolean,default:!1},clearSearchOnClose:{type:Boolean,default:()=>Hd.default.clearSearchOnClose},debounce:{type:Number,default:200},creatable:{type:Boolean,default:!1},showCreateOptionWhen:{type:String,default:()=>Hd.default.showCreateOptionWhen},placeholder:{type:String,default:null},padded:{type:Boolean,default:!0},size:{type:String,default:null,validator(e){return Object.keys(Mo.size).includes(e)}},color:{type:String,default:()=>Mo.default.color,validator(e){return[...Di.ui.colors,...Object.keys(Mo.color)].includes(e)}},variant:{type:String,default:()=>Mo.default.variant,validator(e){return[...Object.keys(Mo.variant),...Object.values(Mo.color).flatMap(n=>Object.keys(n))].includes(e)}},optionAttribute:{type:String,default:"label"},valueAttribute:{type:String,default:null},searchAttributes:{type:Array,default:null},popper:{type:Object,default:()=>({})},selectClass:{type:String,default:null},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})},uiMenu:{type:Object,default:()=>({})}},emits:["update:modelValue","update:query","open","close","change"],setup(e,{emit:n,slots:s}){const{ui:u,attrs:h}=ra("select",Qn(e,"ui"),Mo,Qn(e,"class")),{ui:g}=ra("selectMenu",Qn(e,"uiMenu"),Hd),m=Ve(()=>jf({},e.popper,g.value.popper)),[c,I]=P5(m.value),{size:M,rounded:k}=Hf({ui:u,props:e}),{emitFormBlur:C,emitFormChange:L,inputId:q,color:X,size:W,name:ae}=U1(e,Mo),Ie=Ve(()=>M.value||W.value),ee=kt(""),H=Ve({get(){return e.query??ee.value},set(Ut){ee.value=Ut,n("update:query",Ut)}}),ce=Ve(()=>{if(e.multiple)return Array.isArray(e.modelValue)&&e.modelValue.length?`${e.modelValue.length} selected`:null;if(e.modelValue!==void 0&&e.modelValue!==null)if(e.valueAttribute){const Ut=e.options.find(Nt=>Nt[e.valueAttribute]===e.modelValue);return Ut?Ut[e.optionAttribute]:null}else return["string","number"].includes(typeof e.modelValue)?e.modelValue:e.modelValue[e.optionAttribute];return null}),ne=Ve(()=>{var Nt,jt;const Ut=((jt=(Nt=u.value.color)==null?void 0:Nt[X.value])==null?void 0:jt[e.variant])||u.value.variant[e.variant];return fs(tr(u.value.base,g.value.select,k.value,u.value.size[Ie.value],u.value.gap[Ie.value],e.padded?u.value.padding[Ie.value]:"p-0",Ut==null?void 0:Ut.replaceAll("{color}",X.value),(oe.value||s.leading)&&u.value.leading.padding[Ie.value],(Ae.value||s.trailing)&&u.value.trailing.padding[Ie.value]),e.placeholder&&!e.modelValue&&u.value.placeholder,e.selectClass)}),oe=Ve(()=>e.icon&&e.leading||e.icon&&!e.trailing||e.loading&&!e.trailing||e.leadingIcon),Ae=Ve(()=>e.icon&&e.trailing||e.loading&&e.trailing||e.trailingIcon),be=Ve(()=>e.loading?e.loadingIcon:e.leadingIcon||e.icon),Le=Ve(()=>e.loading&&!oe.value?e.loadingIcon:e.trailingIcon||e.icon),me=Ve(()=>tr(u.value.icon.leading.wrapper,u.value.icon.leading.pointer,u.value.icon.leading.padding[Ie.value])),ke=Ve(()=>tr(u.value.icon.base,X.value&&Di.ui.colors.includes(X.value)&&u.value.icon.color.replaceAll("{color}",X.value),u.value.icon.size[Ie.value],e.loading&&u.value.icon.loading)),Me=Ve(()=>tr(u.value.icon.trailing.wrapper,u.value.icon.trailing.pointer,u.value.icon.trailing.padding[Ie.value])),Oe=Ve(()=>tr(u.value.icon.base,X.value&&Di.ui.colors.includes(X.value)&&u.value.icon.color.replaceAll("{color}",X.value),u.value.icon.size[Ie.value],e.loading&&!oe.value&&u.value.icon.loading)),Ge=typeof e.searchable=="function"?h1(e.searchable,e.debounce):void 0,rt=ok(async()=>e.searchable&&Ge?await Ge(H.value):H.value===""?e.options:e.options.filter(Ut=>{var Nt;return((Nt=e.searchAttributes)!=null&&Nt.length?e.searchAttributes:[e.optionAttribute]).some(jt=>{if(["string","number"].includes(typeof Ut))return String(Ut).search(new RegExp(H.value,"i"))!==-1;const Si=y1(Ut,jt);return Si!=null&&String(Si).search(new RegExp(H.value,"i"))!==-1})}),[],{lazy:e.searchableLazy}),Ke=Ve(()=>H.value===""||e.showCreateOptionWhen==="empty"&&rt.value.length||e.showCreateOptionWhen==="always"&&rt.value.find(Nt=>["string","number"].includes(typeof Nt)?Nt===H.value:Nt[e.optionAttribute]===H.value)?null:["string","number"].includes(typeof e.modelValue)?H.value:{[e.optionAttribute]:H.value});function dt(){e.clearSearchOnClose&&(H.value="")}Zi(I,Ut=>{Ut?n("open"):(dt(),n("close"),C())});function nt(Ut){n("update:modelValue",Ut),n("change",Ut),L()}function ti(Ut){H.value=Ut.target.value}return GP(()=>AP("$YMH7mn4R4k")),{ui:u,uiMenu:g,attrs:h,name:ae,inputId:q,popper:m,trigger:c,container:I,label:ce,isLeading:oe,isTrailing:Ae,selectClass:ne,leadingIconName:be,leadingIconClass:ke,leadingWrapperIconClass:me,trailingIconName:Le,trailingIconClass:Oe,trailingWrapperIconClass:Me,filteredOptions:rt,createOption:Ke,query:H,onUpdate:nt,onQueryChange:ti}}}),D5=["value","required"],R5=["id","disabled"],O5={class:"truncate"};function B5(e,n,s,u,h,g){const m=$o,c=Nm("HComboboxInput"),I=Kf;return _t(),li(hs(e.searchable?"HCombobox":"HListbox"),{by:e.by,name:e.name,"model-value":e.modelValue,multiple:e.multiple,disabled:e.disabled,as:"div",class:Mt(e.ui.wrapper),"onUpdate:modelValue":e.onUpdate},{default:xr(({open:M})=>[e.required?(_t(),ri("input",{key:0,value:e.modelValue,required:e.required,class:Mt(e.uiMenu.required),tabindex:"-1","aria-hidden":"true"},null,10,D5)):Li("",!0),(_t(),li(hs(e.searchable?"HComboboxButton":"HListboxButton"),{ref:"trigger",as:"div",role:"button",class:Mt(e.uiMenu.trigger)},{default:xr(()=>[sr(e.$slots,"default",{open:M,disabled:e.disabled,loading:e.loading},()=>[$i("button",br({id:e.inputId,class:e.selectClass,disabled:e.disabled,type:"button"},e.attrs),[e.isLeading&&e.leadingIconName||e.$slots.leading?(_t(),ri("span",{key:0,class:Mt(e.leadingWrapperIconClass)},[sr(e.$slots,"leading",{disabled:e.disabled,loading:e.loading},()=>[ei(m,{name:e.leadingIconName,class:Mt(e.leadingIconClass)},null,8,["name","class"])])],2)):Li("",!0),sr(e.$slots,"label",{},()=>[e.label?(_t(),ri("span",{key:0,class:Mt(e.uiMenu.label)},Ur(e.label),3)):(_t(),ri("span",{key:1,class:Mt(e.uiMenu.label)},Ur(e.placeholder||" "),3))]),e.isTrailing&&e.trailingIconName||e.$slots.trailing?(_t(),ri("span",{key:1,class:Mt(e.trailingWrapperIconClass)},[sr(e.$slots,"trailing",{disabled:e.disabled,loading:e.loading},()=>[ei(m,{name:e.trailingIconName,class:Mt(e.trailingIconClass),"aria-hidden":"true"},null,8,["name","class"])])],2)):Li("",!0)],16,R5)])]),_:2},1032,["class"])),M?(_t(),ri("div",{key:1,ref:"container",class:Mt([e.uiMenu.container,e.uiMenu.width])},[ei(Nf,br({appear:""},e.uiMenu.transition),{default:xr(()=>[$i("div",null,[e.popper.arrow?(_t(),ri("div",{key:0,"data-popper-arrow":"",class:Mt(Object.values(e.uiMenu.arrow))},null,2)):Li("",!0),(_t(),li(hs(e.searchable?"HComboboxOptions":"HListboxOptions"),{static:"",class:Mt([e.uiMenu.base,e.uiMenu.ring,e.uiMenu.rounded,e.uiMenu.shadow,e.uiMenu.background,e.uiMenu.padding,e.uiMenu.height])},{default:xr(()=>{var k,C;return[e.searchable?(_t(),li(c,{key:0,"display-value":()=>e.query,name:"q",placeholder:e.searchablePlaceholder,autofocus:"",autocomplete:"off",class:Mt(e.uiMenu.input),onChange:e.onQueryChange},null,8,["display-value","placeholder","class","onChange"])):Li("",!0),(_t(!0),ri(ar,null,oh(e.filteredOptions,(L,q)=>(_t(),li(hs(e.searchable?"HComboboxOption":"HListboxOption"),{key:q,as:"template",value:e.valueAttribute?L[e.valueAttribute]:L,disabled:L.disabled},{default:xr(({active:X,selected:W,disabled:ae})=>[$i("li",{class:Mt([e.uiMenu.option.base,e.uiMenu.option.rounded,e.uiMenu.option.padding,e.uiMenu.option.size,e.uiMenu.option.color,X?e.uiMenu.option.active:e.uiMenu.option.inactive,W&&e.uiMenu.option.selected,ae&&e.uiMenu.option.disabled])},[$i("div",{class:Mt(e.uiMenu.option.container)},[sr(e.$slots,"option",{option:L,active:X,selected:W},()=>[L.icon?(_t(),li(m,{key:0,name:L.icon,class:Mt([e.uiMenu.option.icon.base,X?e.uiMenu.option.icon.active:e.uiMenu.option.icon.inactive,L.iconClass]),"aria-hidden":"true"},null,8,["name","class"])):L.avatar?(_t(),li(I,br({key:1,ref_for:!0},{size:e.uiMenu.option.avatar.size,...L.avatar},{class:e.uiMenu.option.avatar.base,"aria-hidden":"true"}),null,16,["class"])):L.chip?(_t(),ri("span",{key:2,class:Mt(e.uiMenu.option.chip.base),style:ia({background:`#${L.chip}`})},null,6)):Li("",!0),$i("span",O5,Ur(["string","number"].includes(typeof L)?L:L[e.optionAttribute]),1)])],2),W?(_t(),ri("span",{key:0,class:Mt([e.uiMenu.option.selectedIcon.wrapper,e.uiMenu.option.selectedIcon.padding])},[ei(m,{name:e.selectedIcon,class:Mt(e.uiMenu.option.selectedIcon.base),"aria-hidden":"true"},null,8,["name","class"])],2)):Li("",!0)],2)]),_:2},1032,["value","disabled"]))),128)),e.creatable&&e.createOption?(_t(),li(hs(e.searchable?"HComboboxOption":"HListboxOption"),{key:1,value:e.createOption,as:"template"},{default:xr(({active:L,selected:q})=>[$i("li",{class:Mt([e.uiMenu.option.base,e.uiMenu.option.rounded,e.uiMenu.option.padding,e.uiMenu.option.size,e.uiMenu.option.color,L?e.uiMenu.option.active:e.uiMenu.option.inactive])},[$i("div",{class:Mt(e.uiMenu.option.container)},[sr(e.$slots,"option-create",{option:e.createOption,active:L,selected:q},()=>[$i("span",{class:Mt(e.uiMenu.option.create)},'Create "'+Ur(e.createOption[e.optionAttribute])+'"',3)])],2)],2)]),_:3},8,["value"])):e.searchable&&e.query&&!((k=e.filteredOptions)!=null&&k.length)?(_t(),ri("p",{key:2,class:Mt(e.uiMenu.option.empty)},[sr(e.$slots,"option-empty",{query:e.query},()=>[mo(' No results for "'+Ur(e.query)+'". ',1)])],2)):(C=e.filteredOptions)!=null&&C.length?Li("",!0):(_t(),ri("p",{key:3,class:Mt(e.uiMenu.empty)},[sr(e.$slots,"empty",{query:e.query},()=>[mo(" No options. ")])],2))]}),_:3},8,["class"]))])]),_:3},16)],2)):Li("",!0)]),_:3},8,["by","name","model-value","multiple","disabled","class","onUpdate:modelValue"])}const F5=jn(z5,[["render",B5]]);function Ew(){const e=mh("notifications",()=>[]);function n(g){const m={id:new Date().getTime().toString(),...g};return e.value.findIndex(I=>I.id===m.id)===-1&&e.value.push(m),m}function s(g){e.value=e.value.filter(m=>m.id!==g)}function u(g,m){const c=e.value.findIndex(I=>I.id===g);if(c!==-1){const I=e.value[c];e.value.splice(c,1,{...I,...m})}}function h(){e.value=[]}return{add:n,remove:s,update:u,clear:h}}var V5=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function N5(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Sw={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v4.4.1/LICENSE.txt
 */(function(e,n){(function(s,u){e.exports=u()})(V5,function(){var s={},u={};function h(m,c,I){if(u[m]=I,m==="index"){var M="var sharedModule = {}; ("+u.shared+")(sharedModule); ("+u.worker+")(sharedModule);",k={};return u.shared(k),u.index(s,k),typeof window<"u"&&s.setWorkerUrl(window.URL.createObjectURL(new Blob([M],{type:"text/javascript"}))),s}}h("shared",["exports"],function(m){function c(r,t,o,l){return new(o||(o=Promise))(function(f,y){function x(A){try{E(l.next(A))}catch(P){y(P)}}function b(A){try{E(l.throw(A))}catch(P){y(P)}}function E(A){var P;A.done?f(A.value):(P=A.value,P instanceof o?P:new o(function(D){D(P)})).then(x,b)}E((l=l.apply(r,t||[])).next())})}function I(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}typeof SuppressedError=="function"&&SuppressedError;var M=k;function k(r,t){this.x=r,this.y=t}k.prototype={clone:function(){return new k(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,t){return this.clone()._rotateAround(r,t)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var t=r.x-this.x,o=r.y-this.y;return t*t+o*o},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,t){return Math.atan2(this.x*t-this.y*r,this.x*r+this.y*t)},_matMult:function(r){var t=r[2]*this.x+r[3]*this.y;return this.x=r[0]*this.x+r[1]*this.y,this.y=t,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var t=Math.cos(r),o=Math.sin(r),l=o*this.x+t*this.y;return this.x=t*this.x-o*this.y,this.y=l,this},_rotateAround:function(r,t){var o=Math.cos(r),l=Math.sin(r),f=t.y+l*(this.x-t.x)+o*(this.y-t.y);return this.x=t.x+o*(this.x-t.x)-l*(this.y-t.y),this.y=f,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},k.convert=function(r){return r instanceof k?r:Array.isArray(r)?new k(r[0],r[1]):r};var C=I(M),L=q;function q(r,t,o,l){this.cx=3*r,this.bx=3*(o-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(l-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=t,this.p2x=o,this.p2y=l}q.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,t){if(t===void 0&&(t=1e-6),r<0)return 0;if(r>1)return 1;for(var o=r,l=0;l<8;l++){var f=this.sampleCurveX(o)-r;if(Math.abs(f)<t)return o;var y=this.sampleCurveDerivativeX(o);if(Math.abs(y)<1e-6)break;o-=f/y}var x=0,b=1;for(o=r,l=0;l<20&&(f=this.sampleCurveX(o),!(Math.abs(f-r)<t));l++)r>f?x=o:b=o,o=.5*(b-x)+x;return o},solve:function(r,t){return this.sampleCurveY(this.solveCurveX(r,t))}};var X=I(L);let W,ae;function Ie(){return W==null&&(W=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),W}function ee(){if(ae==null&&(ae=!1,Ie())){const t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let l=0;l<5*5;l++){const f=4*l;t.fillStyle=`rgb(${f},${f+1},${f+2})`,t.fillRect(l%5,Math.floor(l/5),1,1)}const o=t.getImageData(0,0,5,5).data;for(let l=0;l<5*5*4;l++)if(l%4!=3&&o[l]!==l){ae=!0;break}}}return ae||!1}function H(r,t,o,l){const f=new X(r,t,o,l);return y=>f.solve(y)}const ce=H(.25,.1,.25,1);function ne(r,t,o){return Math.min(o,Math.max(t,r))}function oe(r,t,o){const l=o-t,f=((r-t)%l+l)%l+t;return f===t?o:f}function Ae(r,...t){for(const o of t)for(const l in o)r[l]=o[l];return r}let be=1;function Le(r,t,o){const l={};for(const f in r)l[f]=t.call(this,r[f],f,r);return l}function me(r,t,o){const l={};for(const f in r)t.call(this,r[f],f,r)&&(l[f]=r[f]);return l}function ke(r){return Array.isArray(r)?r.map(ke):typeof r=="object"&&r?Le(r,ke):r}const Me={};function Oe(r){Me[r]||(typeof console<"u"&&console.warn(r),Me[r]=!0)}function Ge(r,t,o){return(o.y-r.y)*(t.x-r.x)>(t.y-r.y)*(o.x-r.x)}function rt(r){return typeof WorkerGlobalScope<"u"&&r!==void 0&&r instanceof WorkerGlobalScope}let Ke=null;function dt(r){return typeof ImageBitmap<"u"&&r instanceof ImageBitmap}const nt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function ti(r,t,o,l,f){return c(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const y=new VideoFrame(r,{timestamp:0});try{const x=y==null?void 0:y.format;if(!x||!x.startsWith("BGR")&&!x.startsWith("RGB"))throw new Error(`Unrecognized format ${x}`);const b=x.startsWith("BGR"),E=new Uint8ClampedArray(l*f*4);if(yield y.copyTo(E,function(A,P,D,B,V){const j=4*Math.max(-P,0),Z=(Math.max(0,D)-D)*B*4+j,Y=4*B,se=Math.max(0,P),Ee=Math.max(0,D);return{rect:{x:se,y:Ee,width:Math.min(A.width,P+B)-se,height:Math.min(A.height,D+V)-Ee},layout:[{offset:Z,stride:Y}]}}(r,t,o,l,f)),b)for(let A=0;A<E.length;A+=4){const P=E[A];E[A]=E[A+2],E[A+2]=P}return E}finally{y.close()}})}let Ut,Nt;const jt="AbortError";function Si(){return new Error(jt)}const Qi={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Oi(r){return Qi.REGISTERED_PROTOCOLS[r.substring(0,r.indexOf("://"))]}const fi="global-dispatcher";class Pi extends Error{constructor(t,o,l,f){super(`AJAXError: ${o} (${t}): ${l}`),this.status=t,this.statusText=o,this.url=l,this.body=f}}const Bi=()=>rt(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Br=function(r,t){if(/:\/\//.test(r.url)&&!/^https?:|^file:/.test(r.url)){const l=Oi(r.url);if(l)return l(r,t);if(rt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:r,targetMapId:fi},t)}if(!(/^file:/.test(o=r.url)||/^file:/.test(Bi())&&!/^\w+:/.test(o))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(l,f){return c(this,void 0,void 0,function*(){const y=new Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,cache:l.cache,referrer:Bi(),signal:f.signal});l.type!=="json"||y.headers.has("Accept")||y.headers.set("Accept","application/json");const x=yield fetch(y);if(!x.ok){const A=yield x.blob();throw new Pi(x.status,x.statusText,l.url,A)}let b;b=l.type==="arrayBuffer"||l.type==="image"?x.arrayBuffer():l.type==="json"?x.json():x.text();const E=yield b;if(f.signal.aborted)throw Si();return{data:E,cacheControl:x.headers.get("Cache-Control"),expires:x.headers.get("Expires")}})}(r,t);if(rt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:r,mustQueue:!0,targetMapId:fi},t)}var o;return function(l,f){return new Promise((y,x)=>{var b;const E=new XMLHttpRequest;E.open(l.method||"GET",l.url,!0),l.type!=="arrayBuffer"&&l.type!=="image"||(E.responseType="arraybuffer");for(const A in l.headers)E.setRequestHeader(A,l.headers[A]);l.type==="json"&&(E.responseType="text",!((b=l.headers)===null||b===void 0)&&b.Accept||E.setRequestHeader("Accept","application/json")),E.withCredentials=l.credentials==="include",E.onerror=()=>{x(new Error(E.statusText))},E.onload=()=>{if(!f.signal.aborted)if((E.status>=200&&E.status<300||E.status===0)&&E.response!==null){let A=E.response;if(l.type==="json")try{A=JSON.parse(E.response)}catch(P){return void x(P)}y({data:A,cacheControl:E.getResponseHeader("Cache-Control"),expires:E.getResponseHeader("Expires")})}else{const A=new Blob([E.response],{type:E.getResponseHeader("Content-Type")});x(new Pi(E.status,E.statusText,l.url,A))}},f.signal.addEventListener("abort",()=>{E.abort(),x(Si())}),E.send(l.body)})}(r,t)};function pr(r){if(!r||r.indexOf("://")<=0||r.indexOf("data:image/")===0||r.indexOf("blob:")===0)return!0;const t=new URL(r),o=window.location;return t.protocol===o.protocol&&t.host===o.host}function Fr(r,t,o){o[r]&&o[r].indexOf(t)!==-1||(o[r]=o[r]||[],o[r].push(t))}function lr(r,t,o){if(o&&o[r]){const l=o[r].indexOf(t);l!==-1&&o[r].splice(l,1)}}class he{constructor(t,o={}){Ae(this,o),this.type=t}}class ye extends he{constructor(t,o={}){super("error",Ae({error:t},o))}}class Be{on(t,o){return this._listeners=this._listeners||{},Fr(t,o,this._listeners),this}off(t,o){return lr(t,o,this._listeners),lr(t,o,this._oneTimeListeners),this}once(t,o){return o?(this._oneTimeListeners=this._oneTimeListeners||{},Fr(t,o,this._oneTimeListeners),this):new Promise(l=>this.once(t,l))}fire(t,o){typeof t=="string"&&(t=new he(t,o||{}));const l=t.type;if(this.listens(l)){t.target=this;const f=this._listeners&&this._listeners[l]?this._listeners[l].slice():[];for(const b of f)b.call(this,t);const y=this._oneTimeListeners&&this._oneTimeListeners[l]?this._oneTimeListeners[l].slice():[];for(const b of y)lr(l,b,this._oneTimeListeners),b.call(this,t);const x=this._eventedParent;x&&(Ae(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),x.fire(t))}else t instanceof ye&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,o){return this._eventedParent=t,this._eventedParentData=o,this}}var le={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const He=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function tt(r,t){const o={};for(const l in r)l!=="ref"&&(o[l]=r[l]);return He.forEach(l=>{l in t&&(o[l]=t[l])}),o}function Ze(r,t){if(Array.isArray(r)){if(!Array.isArray(t)||r.length!==t.length)return!1;for(let o=0;o<r.length;o++)if(!Ze(r[o],t[o]))return!1;return!0}if(typeof r=="object"&&r!==null&&t!==null){if(typeof t!="object"||Object.keys(r).length!==Object.keys(t).length)return!1;for(const o in r)if(!Ze(r[o],t[o]))return!1;return!0}return r===t}function je(r,t){r.push(t)}function Qe(r,t,o){je(o,{command:"addSource",args:[r,t[r]]})}function We(r,t,o){je(t,{command:"removeSource",args:[r]}),o[r]=!0}function pt(r,t,o,l){We(r,o,l),Qe(r,t,o)}function It(r,t,o){let l;for(l in r[o])if(Object.prototype.hasOwnProperty.call(r[o],l)&&l!=="data"&&!Ze(r[o][l],t[o][l]))return!1;for(l in t[o])if(Object.prototype.hasOwnProperty.call(t[o],l)&&l!=="data"&&!Ze(r[o][l],t[o][l]))return!1;return!0}function xt(r,t,o,l,f,y){r=r||{},t=t||{};for(const x in r)Object.prototype.hasOwnProperty.call(r,x)&&(Ze(r[x],t[x])||o.push({command:y,args:[l,x,t[x],f]}));for(const x in t)Object.prototype.hasOwnProperty.call(t,x)&&!Object.prototype.hasOwnProperty.call(r,x)&&(Ze(r[x],t[x])||o.push({command:y,args:[l,x,t[x],f]}))}function Lt(r){return r.id}function Ht(r,t){return r[t.id]=t,r}class $e{constructor(t,o,l,f){this.message=(t?`${t}: `:"")+l,f&&(this.identifier=f),o!=null&&o.__line__&&(this.line=o.__line__)}}function Gt(r,...t){for(const o of t)for(const l in o)r[l]=o[l];return r}class ai extends Error{constructor(t,o){super(o),this.message=o,this.key=t}}class mr{constructor(t,o=[]){this.parent=t,this.bindings={};for(const[l,f]of o)this.bindings[l]=f}concat(t){return new mr(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const Kr={kind:"null"},Ye={kind:"number"},Bt={kind:"string"},Dt={kind:"boolean"},pi={kind:"color"},Ii={kind:"object"},Ft={kind:"value"},io={kind:"collator"},ro={kind:"formatted"},gr={kind:"padding"},Q={kind:"resolvedImage"},F={kind:"variableAnchorOffsetCollection"};function N(r,t){return{kind:"array",itemType:r,N:t}}function U(r){if(r.kind==="array"){const t=U(r.itemType);return typeof r.N=="number"?`array<${t}, ${r.N}>`:r.itemType.kind==="value"?"array":`array<${t}>`}return r.kind}const ie=[Kr,Ye,Bt,Dt,pi,ro,Ii,N(Ft),gr,Q,F];function pe(r,t){if(t.kind==="error")return null;if(r.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!pe(r.itemType,t.itemType))&&(typeof r.N!="number"||r.N===t.N))return null}else{if(r.kind===t.kind)return null;if(r.kind==="value"){for(const o of ie)if(!pe(o,t))return null}}return`Expected ${U(r)} but found ${U(t)} instead.`}function _e(r,t){return t.some(o=>o.kind===r.kind)}function we(r,t){return t.some(o=>o==="null"?r===null:o==="array"?Array.isArray(r):o==="object"?r&&!Array.isArray(r)&&typeof r=="object":o===typeof r)}function de(r,t){return r.kind==="array"&&t.kind==="array"?r.itemType.kind===t.itemType.kind&&typeof r.N=="number":r.kind===t.kind}const Ce=.96422,Ue=.82521,Re=4/29,De=6/29,Tt=3*De*De,St=De*De*De,Jt=Math.PI/180,Rt=180/Math.PI;function ii(r){return(r%=360)<0&&(r+=360),r}function mi([r,t,o,l]){let f,y;const x=rr((.2225045*(r=Ti(r))+.7168786*(t=Ti(t))+.0606169*(o=Ti(o)))/1);r===t&&t===o?f=y=x:(f=rr((.4360747*r+.3850649*t+.1430804*o)/Ce),y=rr((.0139322*r+.0971045*t+.7141733*o)/Ue));const b=116*x-16;return[b<0?0:b,500*(f-x),200*(x-y),l]}function Ti(r){return r<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function rr(r){return r>St?Math.pow(r,1/3):r/Tt+Re}function Zt([r,t,o,l]){let f=(r+16)/116,y=isNaN(t)?f:f+t/500,x=isNaN(o)?f:f-o/200;return f=1*cr(f),y=Ce*cr(y),x=Ue*cr(x),[Fi(3.1338561*y-1.6168667*f-.4906146*x),Fi(-.9787684*y+1.9161415*f+.033454*x),Fi(.0719453*y-.2289914*f+1.4052427*x),l]}function Fi(r){return(r=r<=.00304?12.92*r:1.055*Math.pow(r,1/2.4)-.055)<0?0:r>1?1:r}function cr(r){return r>De?r*r*r:Tt*(r-Re)}function Xr(r){return parseInt(r.padEnd(2,r),16)/255}function cn(r,t){return ur(t?r/100:r,0,1)}function ur(r,t,o){return Math.min(Math.max(t,r),o)}function _s(r){return!r.some(Number.isNaN)}const Yf={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class di{constructor(t,o,l,f=1,y=!0){this.r=t,this.g=o,this.b=l,this.a=f,y||(this.r*=f,this.g*=f,this.b*=f,f||this.overwriteGetter("rgb",[t,o,l,f]))}static parse(t){if(t instanceof di)return t;if(typeof t!="string")return;const o=function(l){if((l=l.toLowerCase().trim())==="transparent")return[0,0,0,0];const f=Yf[l];if(f){const[x,b,E]=f;return[x/255,b/255,E/255,1]}if(l.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(l)){const x=l.length<6?1:2;let b=1;return[Xr(l.slice(b,b+=x)),Xr(l.slice(b,b+=x)),Xr(l.slice(b,b+=x)),Xr(l.slice(b,b+x)||"ff")]}if(l.startsWith("rgb")){const x=l.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(x){const[b,E,A,P,D,B,V,j,Z,Y,se,Ee]=x,fe=[P||" ",V||" ",Y].join("");if(fe==="  "||fe==="  /"||fe===",,"||fe===",,,"){const xe=[A,B,Z].join(""),ze=xe==="%%%"?100:xe===""?255:0;if(ze){const qe=[ur(+E/ze,0,1),ur(+D/ze,0,1),ur(+j/ze,0,1),se?cn(+se,Ee):1];if(_s(qe))return qe}}return}}const y=l.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(y){const[x,b,E,A,P,D,B,V,j]=y,Z=[E||" ",P||" ",B].join("");if(Z==="  "||Z==="  /"||Z===",,"||Z===",,,"){const Y=[+b,ur(+A,0,100),ur(+D,0,100),V?cn(+V,j):1];if(_s(Y))return function([se,Ee,fe,xe]){function ze(qe){const st=(qe+se/30)%12,Ct=Ee*Math.min(fe,1-fe);return fe-Ct*Math.max(-1,Math.min(st-3,9-st,1))}return se=ii(se),Ee/=100,fe/=100,[ze(0),ze(8),ze(4),xe]}(Y)}}}(t);return o?new di(...o,!1):void 0}get rgb(){const{r:t,g:o,b:l,a:f}=this,y=f||1/0;return this.overwriteGetter("rgb",[t/y,o/y,l/y,f])}get hcl(){return this.overwriteGetter("hcl",function(t){const[o,l,f,y]=mi(t),x=Math.sqrt(l*l+f*f);return[Math.round(1e4*x)?ii(Math.atan2(f,l)*Rt):NaN,x,o,y]}(this.rgb))}get lab(){return this.overwriteGetter("lab",mi(this.rgb))}overwriteGetter(t,o){return Object.defineProperty(this,t,{value:o}),o}toString(){const[t,o,l,f]=this.rgb;return`rgba(${[t,o,l].map(y=>Math.round(255*y)).join(",")},${f})`}}di.black=new di(0,0,0,1),di.white=new di(1,1,1,1),di.transparent=new di(0,0,0,0),di.red=new di(1,0,0,1);class wc{constructor(t,o,l){this.sensitivity=t?o?"variant":"case":o?"accent":"base",this.locale=l,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,o){return this.collator.compare(t,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Ec{constructor(t,o,l,f,y){this.text=t,this.image=o,this.scale=l,this.fontStack=f,this.textColor=y}}class un{constructor(t){this.sections=t}static fromString(t){return new un([new Ec(t,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof un?t:un.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}}class Jr{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Jr)return t;if(typeof t=="number")return new Jr([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const o of t)if(typeof o!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new Jr(t)}}toString(){return JSON.stringify(this.values)}}const ha=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Yr{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Yr)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let o=0;o<t.length;o+=2){const l=t[o],f=t[o+1];if(typeof l!="string"||!ha.has(l)||!Array.isArray(f)||f.length!==2||typeof f[0]!="number"||typeof f[1]!="number")return}return new Yr(t)}}toString(){return JSON.stringify(this.values)}}class _n{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new _n({name:t,available:!1}):null}}function xh(r,t,o,l){return typeof r=="number"&&r>=0&&r<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof o=="number"&&o>=0&&o<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:`Invalid rgba value [${[r,t,o,l].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof l=="number"?[r,t,o,l]:[r,t,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function no(r){if(r===null||typeof r=="string"||typeof r=="boolean"||typeof r=="number"||r instanceof di||r instanceof wc||r instanceof un||r instanceof Jr||r instanceof Yr||r instanceof _n)return!0;if(Array.isArray(r)){for(const t of r)if(!no(t))return!1;return!0}if(typeof r=="object"){for(const t in r)if(!no(r[t]))return!1;return!0}return!1}function nr(r){if(r===null)return Kr;if(typeof r=="string")return Bt;if(typeof r=="boolean")return Dt;if(typeof r=="number")return Ye;if(r instanceof di)return pi;if(r instanceof wc)return io;if(r instanceof un)return ro;if(r instanceof Jr)return gr;if(r instanceof Yr)return F;if(r instanceof _n)return Q;if(Array.isArray(r)){const t=r.length;let o;for(const l of r){const f=nr(l);if(o){if(o===f)continue;o=Ft;break}o=f}return N(o||Ft,t)}return Ii}function da(r){const t=typeof r;return r===null?"":t==="string"||t==="number"||t==="boolean"?String(r):r instanceof di||r instanceof un||r instanceof Jr||r instanceof Yr||r instanceof _n?r.toString():JSON.stringify(r)}class Uo{constructor(t,o){this.type=t,this.value=o}static parse(t,o){if(t.length!==2)return o.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!no(t[1]))return o.error("invalid value");const l=t[1];let f=nr(l);const y=o.expectedType;return f.kind!=="array"||f.N!==0||!y||y.kind!=="array"||typeof y.N=="number"&&y.N!==0||(f=y),new Uo(f,l)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Wi{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const qo={string:Bt,number:Ye,boolean:Dt,object:Ii};class Sn{constructor(t,o){this.type=t,this.args=o}static parse(t,o){if(t.length<2)return o.error("Expected at least one argument.");let l,f=1;const y=t[0];if(y==="array"){let b,E;if(t.length>2){const A=t[1];if(typeof A!="string"||!(A in qo)||A==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);b=qo[A],f++}else b=Ft;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return o.error('The length argument to "array" must be a positive integer literal',2);E=t[2],f++}l=N(b,E)}else{if(!qo[y])throw new Error(`Types doesn't contain name = ${y}`);l=qo[y]}const x=[];for(;f<t.length;f++){const b=o.parse(t[f],f,Ft);if(!b)return null;x.push(b)}return new Sn(l,x)}evaluate(t){for(let o=0;o<this.args.length;o++){const l=this.args[o].evaluate(t);if(!pe(this.type,nr(l)))return l;if(o===this.args.length-1)throw new Wi(`Expected value to be of type ${U(this.type)}, but found ${U(nr(l))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const il={"to-boolean":Dt,"to-color":pi,"to-number":Ye,"to-string":Bt};class Un{constructor(t,o){this.type=t,this.args=o}static parse(t,o){if(t.length<2)return o.error("Expected at least one argument.");const l=t[0];if(!il[l])throw new Error(`Can't parse ${l} as it is not part of the known types`);if((l==="to-boolean"||l==="to-string")&&t.length!==2)return o.error("Expected one argument.");const f=il[l],y=[];for(let x=1;x<t.length;x++){const b=o.parse(t[x],x,Ft);if(!b)return null;y.push(b)}return new Un(f,y)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let o,l;for(const f of this.args){if(o=f.evaluate(t),l=null,o instanceof di)return o;if(typeof o=="string"){const y=t.parseColor(o);if(y)return y}else if(Array.isArray(o)&&(l=o.length<3||o.length>4?`Invalid rbga value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:xh(o[0],o[1],o[2],o[3]),!l))return new di(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new Wi(l||`Could not parse color from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"padding":{let o;for(const l of this.args){o=l.evaluate(t);const f=Jr.parse(o);if(f)return f}throw new Wi(`Could not parse padding from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"variableAnchorOffsetCollection":{let o;for(const l of this.args){o=l.evaluate(t);const f=Yr.parse(o);if(f)return f}throw new Wi(`Could not parse variableAnchorOffsetCollection from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"number":{let o=null;for(const l of this.args){if(o=l.evaluate(t),o===null)return 0;const f=Number(o);if(!isNaN(f))return f}throw new Wi(`Could not convert ${JSON.stringify(o)} to number.`)}case"formatted":return un.fromString(da(this.args[0].evaluate(t)));case"resolvedImage":return _n.fromString(da(this.args[0].evaluate(t)));default:return da(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const Sc=["Unknown","Point","LineString","Polygon"];class vs{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Sc[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let o=this._parseColorCache[t];return o||(o=this._parseColorCache[t]=di.parse(t)),o}}class ci{constructor(t,o,l=[],f,y=new mr,x=[]){this.registry=t,this.path=l,this.key=l.map(b=>`[${b}]`).join(""),this.scope=y,this.errors=x,this.expectedType=f,this._isConstant=o}parse(t,o,l,f,y={}){return o?this.concat(o,l,f)._parse(t,y):this._parse(t,y)}_parse(t,o){function l(f,y,x){return x==="assert"?new Sn(y,[f]):x==="coerce"?new Un(y,[f]):f}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const f=t[0];if(typeof f!="string")return this.error(`Expression name must be a string, but found ${typeof f} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const y=this.registry[f];if(y){let x=y.parse(t,this);if(!x)return null;if(this.expectedType){const b=this.expectedType,E=x.type;if(b.kind!=="string"&&b.kind!=="number"&&b.kind!=="boolean"&&b.kind!=="object"&&b.kind!=="array"||E.kind!=="value")if(b.kind!=="color"&&b.kind!=="formatted"&&b.kind!=="resolvedImage"||E.kind!=="value"&&E.kind!=="string")if(b.kind!=="padding"||E.kind!=="value"&&E.kind!=="number"&&E.kind!=="array")if(b.kind!=="variableAnchorOffsetCollection"||E.kind!=="value"&&E.kind!=="array"){if(this.checkSubtype(b,E))return null}else x=l(x,b,o.typeAnnotation||"coerce");else x=l(x,b,o.typeAnnotation||"coerce");else x=l(x,b,o.typeAnnotation||"coerce");else x=l(x,b,o.typeAnnotation||"assert")}if(!(x instanceof Uo)&&x.type.kind!=="resolvedImage"&&this._isConstant(x)){const b=new vs;try{x=new Uo(x.type,x.evaluate(b))}catch(E){return this.error(E.message),null}}return x}return this.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,o,l){const f=typeof t=="number"?this.path.concat(t):this.path,y=l?this.scope.concat(l):this.scope;return new ci(this.registry,this._isConstant,f,o||null,y,this.errors)}error(t,...o){const l=`${this.key}${o.map(f=>`[${f}]`).join("")}`;this.errors.push(new ai(l,t))}checkSubtype(t,o){const l=pe(t,o);return l&&this.error(l),l}}class rl{constructor(t,o){this.type=o.type,this.bindings=[].concat(t),this.result=o}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const o of this.bindings)t(o[1]);t(this.result)}static parse(t,o){if(t.length<4)return o.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const l=[];for(let y=1;y<t.length-1;y+=2){const x=t[y];if(typeof x!="string")return o.error(`Expected string, but found ${typeof x} instead.`,y);if(/[^a-zA-Z0-9_]/.test(x))return o.error("Variable names must contain only alphanumeric characters or '_'.",y);const b=o.parse(t[y+1],y+1);if(!b)return null;l.push([x,b])}const f=o.parse(t[t.length-1],t.length-1,o.expectedType,l);return f?new rl(l,f):null}outputDefined(){return this.result.outputDefined()}}class xs{constructor(t,o){this.type=o.type,this.name=t,this.boundExpression=o}static parse(t,o){if(t.length!==2||typeof t[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");const l=t[1];return o.scope.has(l)?new xs(l,o.scope.get(l)):o.error(`Unknown variable "${l}". Make sure "${l}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class Ic{constructor(t,o,l){this.type=t,this.index=o,this.input=l}static parse(t,o){if(t.length!==3)return o.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const l=o.parse(t[1],1,Ye),f=o.parse(t[2],2,N(o.expectedType||Ft));return l&&f?new Ic(f.type.itemType,l,f):null}evaluate(t){const o=this.index.evaluate(t),l=this.input.evaluate(t);if(o<0)throw new Wi(`Array index out of bounds: ${o} < 0.`);if(o>=l.length)throw new Wi(`Array index out of bounds: ${o} > ${l.length-1}.`);if(o!==Math.floor(o))throw new Wi(`Array index must be an integer, but found ${o} instead.`);return l[o]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class nl{constructor(t,o){this.type=Dt,this.needle=t,this.haystack=o}static parse(t,o){if(t.length!==3)return o.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const l=o.parse(t[1],1,Ft),f=o.parse(t[2],2,Ft);return l&&f?_e(l.type,[Dt,Bt,Ye,Kr,Ft])?new nl(l,f):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${U(l.type)} instead`):null}evaluate(t){const o=this.needle.evaluate(t),l=this.haystack.evaluate(t);if(!l)return!1;if(!we(o,["boolean","string","number","null"]))throw new Wi(`Expected first argument to be of type boolean, string, number or null, but found ${U(nr(o))} instead.`);if(!we(l,["string","array"]))throw new Wi(`Expected second argument to be of type array or string, but found ${U(nr(l))} instead.`);return l.indexOf(o)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class fa{constructor(t,o,l){this.type=Ye,this.needle=t,this.haystack=o,this.fromIndex=l}static parse(t,o){if(t.length<=2||t.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const l=o.parse(t[1],1,Ft),f=o.parse(t[2],2,Ft);if(!l||!f)return null;if(!_e(l.type,[Dt,Bt,Ye,Kr,Ft]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${U(l.type)} instead`);if(t.length===4){const y=o.parse(t[3],3,Ye);return y?new fa(l,f,y):null}return new fa(l,f)}evaluate(t){const o=this.needle.evaluate(t),l=this.haystack.evaluate(t);if(!we(o,["boolean","string","number","null"]))throw new Wi(`Expected first argument to be of type boolean, string, number or null, but found ${U(nr(o))} instead.`);if(!we(l,["string","array"]))throw new Wi(`Expected second argument to be of type array or string, but found ${U(nr(l))} instead.`);if(this.fromIndex){const f=this.fromIndex.evaluate(t);return l.indexOf(o,f)}return l.indexOf(o)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class Tc{constructor(t,o,l,f,y,x){this.inputType=t,this.type=o,this.input=l,this.cases=f,this.outputs=y,this.otherwise=x}static parse(t,o){if(t.length<5)return o.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return o.error("Expected an even number of arguments.");let l,f;o.expectedType&&o.expectedType.kind!=="value"&&(f=o.expectedType);const y={},x=[];for(let A=2;A<t.length-1;A+=2){let P=t[A];const D=t[A+1];Array.isArray(P)||(P=[P]);const B=o.concat(A);if(P.length===0)return B.error("Expected at least one branch label.");for(const j of P){if(typeof j!="number"&&typeof j!="string")return B.error("Branch labels must be numbers or strings.");if(typeof j=="number"&&Math.abs(j)>Number.MAX_SAFE_INTEGER)return B.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof j=="number"&&Math.floor(j)!==j)return B.error("Numeric branch labels must be integer values.");if(l){if(B.checkSubtype(l,nr(j)))return null}else l=nr(j);if(y[String(j)]!==void 0)return B.error("Branch labels must be unique.");y[String(j)]=x.length}const V=o.parse(D,A,f);if(!V)return null;f=f||V.type,x.push(V)}const b=o.parse(t[1],1,Ft);if(!b)return null;const E=o.parse(t[t.length-1],t.length-1,f);return E?b.type.kind!=="value"&&o.concat(1).checkSubtype(l,b.type)?null:new Tc(l,f,b,y,x,E):null}evaluate(t){const o=this.input.evaluate(t);return(nr(o)===this.inputType&&this.outputs[this.cases[o]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}}class ol{constructor(t,o,l){this.type=t,this.branches=o,this.otherwise=l}static parse(t,o){if(t.length<4)return o.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return o.error("Expected an odd number of arguments.");let l;o.expectedType&&o.expectedType.kind!=="value"&&(l=o.expectedType);const f=[];for(let x=1;x<t.length-1;x+=2){const b=o.parse(t[x],x,Dt);if(!b)return null;const E=o.parse(t[x+1],x+1,l);if(!E)return null;f.push([b,E]),l=l||E.type}const y=o.parse(t[t.length-1],t.length-1,l);if(!y)return null;if(!l)throw new Error("Can't infer output type");return new ol(l,f,y)}evaluate(t){for(const[o,l]of this.branches)if(o.evaluate(t))return l.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[o,l]of this.branches)t(o),t(l);t(this.otherwise)}outputDefined(){return this.branches.every(([t,o])=>o.outputDefined())&&this.otherwise.outputDefined()}}class pa{constructor(t,o,l,f){this.type=t,this.input=o,this.beginIndex=l,this.endIndex=f}static parse(t,o){if(t.length<=2||t.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const l=o.parse(t[1],1,Ft),f=o.parse(t[2],2,Ye);if(!l||!f)return null;if(!_e(l.type,[N(Ft),Bt,Ft]))return o.error(`Expected first argument to be of type array or string, but found ${U(l.type)} instead`);if(t.length===4){const y=o.parse(t[3],3,Ye);return y?new pa(l.type,l,f,y):null}return new pa(l.type,l,f)}evaluate(t){const o=this.input.evaluate(t),l=this.beginIndex.evaluate(t);if(!we(o,["string","array"]))throw new Wi(`Expected first argument to be of type array or string, but found ${U(nr(o))} instead.`);if(this.endIndex){const f=this.endIndex.evaluate(t);return o.slice(l,f)}return o.slice(l)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function sl(r,t){const o=r.length-1;let l,f,y=0,x=o,b=0;for(;y<=x;)if(b=Math.floor((y+x)/2),l=r[b],f=r[b+1],l<=t){if(b===o||t<f)return b;y=b+1}else{if(!(l>t))throw new Wi("Input is not a number.");x=b-1}return 0}class ma{constructor(t,o,l){this.type=t,this.input=o,this.labels=[],this.outputs=[];for(const[f,y]of l)this.labels.push(f),this.outputs.push(y)}static parse(t,o){if(t.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return o.error("Expected an even number of arguments.");const l=o.parse(t[1],1,Ye);if(!l)return null;const f=[];let y=null;o.expectedType&&o.expectedType.kind!=="value"&&(y=o.expectedType);for(let x=1;x<t.length;x+=2){const b=x===1?-1/0:t[x],E=t[x+1],A=x,P=x+1;if(typeof b!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',A);if(f.length&&f[f.length-1][0]>=b)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',A);const D=o.parse(E,P,y);if(!D)return null;y=y||D.type,f.push([b,D])}return new ma(y,l,f)}evaluate(t){const o=this.labels,l=this.outputs;if(o.length===1)return l[0].evaluate(t);const f=this.input.evaluate(t);if(f<=o[0])return l[0].evaluate(t);const y=o.length;return f>=o[y-1]?l[y-1].evaluate(t):l[sl(o,f)].evaluate(t)}eachChild(t){t(this.input);for(const o of this.outputs)t(o)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function Qf(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var ep=Cc;function Cc(r,t,o,l){this.cx=3*r,this.bx=3*(o-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(l-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=t,this.p2x=o,this.p2y=l}Cc.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,t){if(t===void 0&&(t=1e-6),r<0)return 0;if(r>1)return 1;for(var o=r,l=0;l<8;l++){var f=this.sampleCurveX(o)-r;if(Math.abs(f)<t)return o;var y=this.sampleCurveDerivativeX(o);if(Math.abs(y)<1e-6)break;o-=f/y}var x=0,b=1;for(o=r,l=0;l<20&&(f=this.sampleCurveX(o),!(Math.abs(f-r)<t));l++)r>f?x=o:b=o,o=.5*(b-x)+x;return o},solve:function(r,t){return this.sampleCurveY(this.solveCurveX(r,t))}};var bh=Qf(ep);function Ho(r,t,o){return r+o*(t-r)}function al(r,t,o){return r.map((l,f)=>Ho(l,t[f],o))}const Vr={number:Ho,color:function(r,t,o,l="rgb"){switch(l){case"rgb":{const[f,y,x,b]=al(r.rgb,t.rgb,o);return new di(f,y,x,b,!1)}case"hcl":{const[f,y,x,b]=r.hcl,[E,A,P,D]=t.hcl;let B,V;if(isNaN(f)||isNaN(E))isNaN(f)?isNaN(E)?B=NaN:(B=E,x!==1&&x!==0||(V=A)):(B=f,P!==1&&P!==0||(V=y));else{let Ee=E-f;E>f&&Ee>180?Ee-=360:E<f&&f-E>180&&(Ee+=360),B=f+o*Ee}const[j,Z,Y,se]=function([Ee,fe,xe,ze]){return Ee=isNaN(Ee)?0:Ee*Jt,Zt([xe,Math.cos(Ee)*fe,Math.sin(Ee)*fe,ze])}([B,V??Ho(y,A,o),Ho(x,P,o),Ho(b,D,o)]);return new di(j,Z,Y,se,!1)}case"lab":{const[f,y,x,b]=Zt(al(r.lab,t.lab,o));return new di(f,y,x,b,!1)}}},array:al,padding:function(r,t,o){return new Jr(al(r.values,t.values,o))},variableAnchorOffsetCollection:function(r,t,o){const l=r.values,f=t.values;if(l.length!==f.length)throw new Wi(`Cannot interpolate values of different length. from: ${r.toString()}, to: ${t.toString()}`);const y=[];for(let x=0;x<l.length;x+=2){if(l[x]!==f[x])throw new Wi(`Cannot interpolate values containing mismatched anchors. from[${x}]: ${l[x]}, to[${x}]: ${f[x]}`);y.push(l[x]);const[b,E]=l[x+1],[A,P]=f[x+1];y.push([Ho(b,A,o),Ho(E,P,o)])}return new Yr(y)}};class hn{constructor(t,o,l,f,y){this.type=t,this.operator=o,this.interpolation=l,this.input=f,this.labels=[],this.outputs=[];for(const[x,b]of y)this.labels.push(x),this.outputs.push(b)}static interpolationFactor(t,o,l,f){let y=0;if(t.name==="exponential")y=Ac(o,t.base,l,f);else if(t.name==="linear")y=Ac(o,1,l,f);else if(t.name==="cubic-bezier"){const x=t.controlPoints;y=new bh(x[0],x[1],x[2],x[3]).solve(Ac(o,1,l,f))}return y}static parse(t,o){let[l,f,y,...x]=t;if(!Array.isArray(f)||f.length===0)return o.error("Expected an interpolation type expression.",1);if(f[0]==="linear")f={name:"linear"};else if(f[0]==="exponential"){const A=f[1];if(typeof A!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);f={name:"exponential",base:A}}else{if(f[0]!=="cubic-bezier")return o.error(`Unknown interpolation type ${String(f[0])}`,1,0);{const A=f.slice(1);if(A.length!==4||A.some(P=>typeof P!="number"||P<0||P>1))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);f={name:"cubic-bezier",controlPoints:A}}}if(t.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(y=o.parse(y,2,Ye),!y)return null;const b=[];let E=null;l==="interpolate-hcl"||l==="interpolate-lab"?E=pi:o.expectedType&&o.expectedType.kind!=="value"&&(E=o.expectedType);for(let A=0;A<x.length;A+=2){const P=x[A],D=x[A+1],B=A+3,V=A+4;if(typeof P!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',B);if(b.length&&b[b.length-1][0]>=P)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',B);const j=o.parse(D,V,E);if(!j)return null;E=E||j.type,b.push([P,j])}return de(E,Ye)||de(E,pi)||de(E,gr)||de(E,F)||de(E,N(Ye))?new hn(E,l,f,y,b):o.error(`Type ${U(E)} is not interpolatable.`)}evaluate(t){const o=this.labels,l=this.outputs;if(o.length===1)return l[0].evaluate(t);const f=this.input.evaluate(t);if(f<=o[0])return l[0].evaluate(t);const y=o.length;if(f>=o[y-1])return l[y-1].evaluate(t);const x=sl(o,f),b=hn.interpolationFactor(this.interpolation,f,o[x],o[x+1]),E=l[x].evaluate(t),A=l[x+1].evaluate(t);switch(this.operator){case"interpolate":return Vr[this.type.kind](E,A,b);case"interpolate-hcl":return Vr.color(E,A,b,"hcl");case"interpolate-lab":return Vr.color(E,A,b,"lab")}}eachChild(t){t(this.input);for(const o of this.outputs)t(o)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function Ac(r,t,o,l){const f=l-o,y=r-o;return f===0?0:t===1?y/f:(Math.pow(t,y)-1)/(Math.pow(t,f)-1)}class ll{constructor(t,o){this.type=t,this.args=o}static parse(t,o){if(t.length<2)return o.error("Expectected at least one argument.");let l=null;const f=o.expectedType;f&&f.kind!=="value"&&(l=f);const y=[];for(const b of t.slice(1)){const E=o.parse(b,1+y.length,l,void 0,{typeAnnotation:"omit"});if(!E)return null;l=l||E.type,y.push(E)}if(!l)throw new Error("No output type");const x=f&&y.some(b=>pe(f,b.type));return new ll(x?Ft:l,y)}evaluate(t){let o,l=null,f=0;for(const y of this.args)if(f++,l=y.evaluate(t),l&&l instanceof _n&&!l.available&&(o||(o=l.name),l=null,f===this.args.length&&(l=o)),l!==null)break;return l}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}function kc(r,t){return r==="=="||r==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function Mc(r,t,o,l){return l.compare(t,o)===0}function bs(r,t,o){const l=r!=="=="&&r!=="!=";return class Iw{constructor(y,x,b){this.type=Dt,this.lhs=y,this.rhs=x,this.collator=b,this.hasUntypedArgument=y.type.kind==="value"||x.type.kind==="value"}static parse(y,x){if(y.length!==3&&y.length!==4)return x.error("Expected two or three arguments.");const b=y[0];let E=x.parse(y[1],1,Ft);if(!E)return null;if(!kc(b,E.type))return x.concat(1).error(`"${b}" comparisons are not supported for type '${U(E.type)}'.`);let A=x.parse(y[2],2,Ft);if(!A)return null;if(!kc(b,A.type))return x.concat(2).error(`"${b}" comparisons are not supported for type '${U(A.type)}'.`);if(E.type.kind!==A.type.kind&&E.type.kind!=="value"&&A.type.kind!=="value")return x.error(`Cannot compare types '${U(E.type)}' and '${U(A.type)}'.`);l&&(E.type.kind==="value"&&A.type.kind!=="value"?E=new Sn(A.type,[E]):E.type.kind!=="value"&&A.type.kind==="value"&&(A=new Sn(E.type,[A])));let P=null;if(y.length===4){if(E.type.kind!=="string"&&A.type.kind!=="string"&&E.type.kind!=="value"&&A.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(P=x.parse(y[3],3,io),!P)return null}return new Iw(E,A,P)}evaluate(y){const x=this.lhs.evaluate(y),b=this.rhs.evaluate(y);if(l&&this.hasUntypedArgument){const E=nr(x),A=nr(b);if(E.kind!==A.kind||E.kind!=="string"&&E.kind!=="number")throw new Wi(`Expected arguments for "${r}" to be (string, string) or (number, number), but found (${E.kind}, ${A.kind}) instead.`)}if(this.collator&&!l&&this.hasUntypedArgument){const E=nr(x),A=nr(b);if(E.kind!=="string"||A.kind!=="string")return t(y,x,b)}return this.collator?o(y,x,b,this.collator.evaluate(y)):t(y,x,b)}eachChild(y){y(this.lhs),y(this.rhs),this.collator&&y(this.collator)}outputDefined(){return!0}}}const tp=bs("==",function(r,t,o){return t===o},Mc),wh=bs("!=",function(r,t,o){return t!==o},function(r,t,o,l){return!Mc(0,t,o,l)}),Eh=bs("<",function(r,t,o){return t<o},function(r,t,o,l){return l.compare(t,o)<0}),ip=bs(">",function(r,t,o){return t>o},function(r,t,o,l){return l.compare(t,o)>0}),rp=bs("<=",function(r,t,o){return t<=o},function(r,t,o,l){return l.compare(t,o)<=0}),np=bs(">=",function(r,t,o){return t>=o},function(r,t,o,l){return l.compare(t,o)>=0});class cl{constructor(t,o,l){this.type=io,this.locale=l,this.caseSensitive=t,this.diacriticSensitive=o}static parse(t,o){if(t.length!==2)return o.error("Expected one argument.");const l=t[1];if(typeof l!="object"||Array.isArray(l))return o.error("Collator options argument must be an object.");const f=o.parse(l["case-sensitive"]!==void 0&&l["case-sensitive"],1,Dt);if(!f)return null;const y=o.parse(l["diacritic-sensitive"]!==void 0&&l["diacritic-sensitive"],1,Dt);if(!y)return null;let x=null;return l.locale&&(x=o.parse(l.locale,1,Bt),!x)?null:new cl(f,y,x)}evaluate(t){return new wc(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class Lc{constructor(t,o,l,f,y){this.type=Bt,this.number=t,this.locale=o,this.currency=l,this.minFractionDigits=f,this.maxFractionDigits=y}static parse(t,o){if(t.length!==3)return o.error("Expected two arguments.");const l=o.parse(t[1],1,Ye);if(!l)return null;const f=t[2];if(typeof f!="object"||Array.isArray(f))return o.error("NumberFormat options argument must be an object.");let y=null;if(f.locale&&(y=o.parse(f.locale,1,Bt),!y))return null;let x=null;if(f.currency&&(x=o.parse(f.currency,1,Bt),!x))return null;let b=null;if(f["min-fraction-digits"]&&(b=o.parse(f["min-fraction-digits"],1,Ye),!b))return null;let E=null;return f["max-fraction-digits"]&&(E=o.parse(f["max-fraction-digits"],1,Ye),!E)?null:new Lc(l,y,x,b,E)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class ul{constructor(t){this.type=ro,this.sections=t}static parse(t,o){if(t.length<2)return o.error("Expected at least one argument.");const l=t[1];if(!Array.isArray(l)&&typeof l=="object")return o.error("First argument must be an image or text section.");const f=[];let y=!1;for(let x=1;x<=t.length-1;++x){const b=t[x];if(y&&typeof b=="object"&&!Array.isArray(b)){y=!1;let E=null;if(b["font-scale"]&&(E=o.parse(b["font-scale"],1,Ye),!E))return null;let A=null;if(b["text-font"]&&(A=o.parse(b["text-font"],1,N(Bt)),!A))return null;let P=null;if(b["text-color"]&&(P=o.parse(b["text-color"],1,pi),!P))return null;const D=f[f.length-1];D.scale=E,D.font=A,D.textColor=P}else{const E=o.parse(t[x],1,Ft);if(!E)return null;const A=E.type.kind;if(A!=="string"&&A!=="value"&&A!=="null"&&A!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");y=!0,f.push({content:E,scale:null,font:null,textColor:null})}}return new ul(f)}evaluate(t){return new un(this.sections.map(o=>{const l=o.content.evaluate(t);return nr(l)===Q?new Ec("",l,null,null,null):new Ec(da(l),null,o.scale?o.scale.evaluate(t):null,o.font?o.font.evaluate(t).join(","):null,o.textColor?o.textColor.evaluate(t):null)}))}eachChild(t){for(const o of this.sections)t(o.content),o.scale&&t(o.scale),o.font&&t(o.font),o.textColor&&t(o.textColor)}outputDefined(){return!1}}class Pc{constructor(t){this.type=Q,this.input=t}static parse(t,o){if(t.length!==2)return o.error("Expected two arguments.");const l=o.parse(t[1],1,Bt);return l?new Pc(l):o.error("No image name provided.")}evaluate(t){const o=this.input.evaluate(t),l=_n.fromString(o);return l&&t.availableImages&&(l.available=t.availableImages.indexOf(o)>-1),l}eachChild(t){t(this.input)}outputDefined(){return!1}}class ga{constructor(t){this.type=Ye,this.input=t}static parse(t,o){if(t.length!==2)return o.error(`Expected 1 argument, but found ${t.length-1} instead.`);const l=o.parse(t[1],1);return l?l.type.kind!=="array"&&l.type.kind!=="string"&&l.type.kind!=="value"?o.error(`Expected argument of type string or array, but found ${U(l.type)} instead.`):new ga(l):null}evaluate(t){const o=this.input.evaluate(t);if(typeof o=="string"||Array.isArray(o))return o.length;throw new Wi(`Expected value to be of type string or array, but found ${U(nr(o))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const dn=8192;function ui(r,t){const o=(180+r[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r[1]*Math.PI/360)))/360,f=Math.pow(2,t.z);return[Math.round(o*f*dn),Math.round(l*f*dn)]}function zc(r,t){const o=Math.pow(2,t.z);return[(f=(r[0]/dn+t.x)/o,360*f-180),(l=(r[1]/dn+t.y)/o,360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90)];var l,f}function ya(r,t){r[0]=Math.min(r[0],t[0]),r[1]=Math.min(r[1],t[1]),r[2]=Math.max(r[2],t[0]),r[3]=Math.max(r[3],t[1])}function _a(r,t){return!(r[0]<=t[0]||r[2]>=t[2]||r[1]<=t[1]||r[3]>=t[3])}function op(r,t,o){const l=r[0]-t[0],f=r[1]-t[1],y=r[0]-o[0],x=r[1]-o[1];return l*x-y*f==0&&l*y<=0&&f*x<=0}function hl(r,t,o,l){return(f=[l[0]-o[0],l[1]-o[1]])[0]*(y=[t[0]-r[0],t[1]-r[1]])[1]-f[1]*y[0]!=0&&!(!Ih(r,t,o,l)||!Ih(o,l,r,t));var f,y}function sp(r,t,o){for(const l of o)for(let f=0;f<l.length-1;++f)if(hl(r,t,l[f],l[f+1]))return!0;return!1}function ws(r,t,o=!1){let l=!1;for(const b of t)for(let E=0;E<b.length-1;E++){if(op(r,b[E],b[E+1]))return o;(y=b[E])[1]>(f=r)[1]!=(x=b[E+1])[1]>f[1]&&f[0]<(x[0]-y[0])*(f[1]-y[1])/(x[1]-y[1])+y[0]&&(l=!l)}var f,y,x;return l}function ap(r,t){for(const o of t)if(ws(r,o))return!0;return!1}function Sh(r,t){for(const o of r)if(!ws(o,t))return!1;for(let o=0;o<r.length-1;++o)if(sp(r[o],r[o+1],t))return!1;return!0}function lp(r,t){for(const o of t)if(Sh(r,o))return!0;return!1}function Ih(r,t,o,l){const f=l[0]-o[0],y=l[1]-o[1],x=(r[0]-o[0])*y-f*(r[1]-o[1]),b=(t[0]-o[0])*y-f*(t[1]-o[1]);return x>0&&b<0||x<0&&b>0}function Dc(r,t,o){const l=[];for(let f=0;f<r.length;f++){const y=[];for(let x=0;x<r[f].length;x++){const b=ui(r[f][x],o);ya(t,b),y.push(b)}l.push(y)}return l}function Th(r,t,o){const l=[];for(let f=0;f<r.length;f++){const y=Dc(r[f],t,o);l.push(y)}return l}function Ch(r,t,o,l){if(r[0]<o[0]||r[0]>o[2]){const f=.5*l;let y=r[0]-o[0]>f?-l:o[0]-r[0]>f?l:0;y===0&&(y=r[0]-o[2]>f?-l:o[2]-r[0]>f?l:0),r[0]+=y}ya(t,r)}function Ah(r,t,o,l){const f=Math.pow(2,l.z)*dn,y=[l.x*dn,l.y*dn],x=[];for(const b of r)for(const E of b){const A=[E.x+y[0],E.y+y[1]];Ch(A,t,o,f),x.push(A)}return x}function kh(r,t,o,l){const f=Math.pow(2,l.z)*dn,y=[l.x*dn,l.y*dn],x=[];for(const E of r){const A=[];for(const P of E){const D=[P.x+y[0],P.y+y[1]];ya(t,D),A.push(D)}x.push(A)}if(t[2]-t[0]<=f/2){(b=t)[0]=b[1]=1/0,b[2]=b[3]=-1/0;for(const E of x)for(const A of E)Ch(A,t,o,f)}var b;return x}class Go{constructor(t,o){this.type=Dt,this.geojson=t,this.geometries=o}static parse(t,o){if(t.length!==2)return o.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(no(t[1])){const l=t[1];if(l.type==="FeatureCollection"){const f=[];for(const y of l.features){const{type:x,coordinates:b}=y.geometry;x==="Polygon"&&f.push(b),x==="MultiPolygon"&&f.push(...b)}if(f.length)return new Go(l,{type:"MultiPolygon",coordinates:f})}else if(l.type==="Feature"){const f=l.geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new Go(l,l.geometry)}else if(l.type==="Polygon"||l.type==="MultiPolygon")return new Go(l,l)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(o,l){const f=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],x=o.canonicalID();if(l.type==="Polygon"){const b=Dc(l.coordinates,y,x),E=Ah(o.geometry(),f,y,x);if(!_a(f,y))return!1;for(const A of E)if(!ws(A,b))return!1}if(l.type==="MultiPolygon"){const b=Th(l.coordinates,y,x),E=Ah(o.geometry(),f,y,x);if(!_a(f,y))return!1;for(const A of E)if(!ap(A,b))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(o,l){const f=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],x=o.canonicalID();if(l.type==="Polygon"){const b=Dc(l.coordinates,y,x),E=kh(o.geometry(),f,y,x);if(!_a(f,y))return!1;for(const A of E)if(!Sh(A,b))return!1}if(l.type==="MultiPolygon"){const b=Th(l.coordinates,y,x),E=kh(o.geometry(),f,y,x);if(!_a(f,y))return!1;for(const A of E)if(!lp(A,b))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Mh=class{constructor(r=[],t=cp){if(this.data=r,this.length=this.data.length,this.compare=t,this.length>0)for(let o=(this.length>>1)-1;o>=0;o--)this._down(o)}push(r){this.data.push(r),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const r=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),r}peek(){return this.data[0]}_up(r){const{data:t,compare:o}=this,l=t[r];for(;r>0;){const f=r-1>>1,y=t[f];if(o(l,y)>=0)break;t[r]=y,r=f}t[r]=l}_down(r){const{data:t,compare:o}=this,l=this.length>>1,f=t[r];for(;r<l;){let y=1+(r<<1),x=t[y];const b=y+1;if(b<this.length&&o(t[b],x)<0&&(y=b,x=t[b]),o(x,f)>=0)break;t[r]=x,r=y}t[r]=f}};function cp(r,t){return r<t?-1:r>t?1:0}function up(r,t,o,l,f){Lh(r,t,o,l||r.length-1,f||hp)}function Lh(r,t,o,l,f){for(;l>o;){if(l-o>600){var y=l-o+1,x=t-o+1,b=Math.log(y),E=.5*Math.exp(2*b/3),A=.5*Math.sqrt(b*E*(y-E)/y)*(x-y/2<0?-1:1);Lh(r,t,Math.max(o,Math.floor(t-x*E/y+A)),Math.min(l,Math.floor(t+(y-x)*E/y+A)),f)}var P=r[t],D=o,B=l;for(va(r,o,t),f(r[l],P)>0&&va(r,o,l);D<B;){for(va(r,D,B),D++,B--;f(r[D],P)<0;)D++;for(;f(r[B],P)>0;)B--}f(r[o],P)===0?va(r,o,B):va(r,++B,l),B<=t&&(o=B+1),t<=B&&(l=B-1)}}function va(r,t,o){var l=r[t];r[t]=r[o],r[o]=l}function hp(r,t){return r<t?-1:r>t?1:0}function dl(r,t){if(r.length<=1)return[r];const o=[];let l,f;for(const y of r){const x=fp(y);x!==0&&(y.area=Math.abs(x),f===void 0&&(f=x<0),f===x<0?(l&&o.push(l),l=[y]):l.push(y))}if(l&&o.push(l),t>1)for(let y=0;y<o.length;y++)o[y].length<=t||(up(o[y],t,1,o[y].length-1,dp),o[y]=o[y].slice(0,t));return o}function dp(r,t){return t.area-r.area}function fp(r){let t=0;for(let o,l,f=0,y=r.length,x=y-1;f<y;x=f++)o=r[f],l=r[x],t+=(l.x-o.x)*(o.y+l.y);return t}const Ph=1/298.257223563,zh=Ph*(2-Ph),Dh=Math.PI/180;class Rc{constructor(t){const o=6378.137*Dh*1e3,l=Math.cos(t*Dh),f=1/(1-zh*(1-l*l)),y=Math.sqrt(f);this.kx=o*y*l,this.ky=o*y*f*(1-zh)}distance(t,o){const l=this.wrap(t[0]-o[0])*this.kx,f=(t[1]-o[1])*this.ky;return Math.sqrt(l*l+f*f)}pointOnLine(t,o){let l,f,y,x,b=1/0;for(let E=0;E<t.length-1;E++){let A=t[E][0],P=t[E][1],D=this.wrap(t[E+1][0]-A)*this.kx,B=(t[E+1][1]-P)*this.ky,V=0;D===0&&B===0||(V=(this.wrap(o[0]-A)*this.kx*D+(o[1]-P)*this.ky*B)/(D*D+B*B),V>1?(A=t[E+1][0],P=t[E+1][1]):V>0&&(A+=D/this.kx*V,P+=B/this.ky*V)),D=this.wrap(o[0]-A)*this.kx,B=(o[1]-P)*this.ky;const j=D*D+B*B;j<b&&(b=j,l=A,f=P,y=E,x=V)}return{point:[l,f],index:y,t:Math.max(0,Math.min(1,x))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function Rh(r,t){return t[0]-r[0]}function Es(r){return r[1]-r[0]+1}function oo(r,t){return r[1]>=r[0]&&r[1]<t}function Oc(r,t){if(r[0]>r[1])return[null,null];const o=Es(r);if(t){if(o===2)return[r,null];const f=Math.floor(o/2);return[[r[0],r[0]+f],[r[0]+f,r[1]]]}if(o===1)return[r,null];const l=Math.floor(o/2)-1;return[[r[0],r[0]+l],[r[0]+l+1,r[1]]]}function Bc(r,t){if(!oo(t,r.length))return[1/0,1/0,-1/0,-1/0];const o=[1/0,1/0,-1/0,-1/0];for(let l=t[0];l<=t[1];++l)ya(o,r[l]);return o}function Fc(r){const t=[1/0,1/0,-1/0,-1/0];for(const o of r)for(const l of o)ya(t,l);return t}function Ki(r){return r[0]!==-1/0&&r[1]!==-1/0&&r[2]!==1/0&&r[3]!==1/0}function Vc(r,t,o){if(!Ki(r)||!Ki(t))return NaN;let l=0,f=0;return r[2]<t[0]&&(l=t[0]-r[2]),r[0]>t[2]&&(l=r[0]-t[2]),r[1]>t[3]&&(f=r[1]-t[3]),r[3]<t[1]&&(f=t[1]-r[3]),o.distance([0,0],[l,f])}function Kt(r,t,o){const l=o.pointOnLine(t,r);return o.distance(r,l.point)}function xa(r,t,o,l,f){const y=Math.min(Kt(r,[o,l],f),Kt(t,[o,l],f)),x=Math.min(Kt(o,[r,t],f),Kt(l,[r,t],f));return Math.min(y,x)}function Vi(r,t,o,l,f){if(!oo(t,r.length)||!oo(l,o.length))return 1/0;let y=1/0;for(let x=t[0];x<t[1];++x){const b=r[x],E=r[x+1];for(let A=l[0];A<l[1];++A){const P=o[A],D=o[A+1];if(hl(b,E,P,D))return 0;y=Math.min(y,xa(b,E,P,D,f))}}return y}function zi(r,t,o,l,f){if(!oo(t,r.length)||!oo(l,o.length))return NaN;let y=1/0;for(let x=t[0];x<=t[1];++x)for(let b=l[0];b<=l[1];++b)if(y=Math.min(y,f.distance(r[x],o[b])),y===0)return y;return y}function fl(r,t,o){if(ws(r,t,!0))return 0;let l=1/0;for(const f of t){const y=f[0],x=f[f.length-1];if(y!==x&&(l=Math.min(l,Kt(r,[x,y],o)),l===0))return l;const b=o.pointOnLine(f,r);if(l=Math.min(l,o.distance(r,b.point)),l===0)return l}return l}function Oh(r,t,o,l){if(!oo(t,r.length))return NaN;for(let y=t[0];y<=t[1];++y)if(ws(r[y],o,!0))return 0;let f=1/0;for(let y=t[0];y<t[1];++y){const x=r[y],b=r[y+1];for(const E of o)for(let A=0,P=E.length,D=P-1;A<P;D=A++){const B=E[D],V=E[A];if(hl(x,b,B,V))return 0;f=Math.min(f,xa(x,b,B,V,l))}}return f}function Nc(r,t){for(const o of r)for(const l of o)if(ws(l,t,!0))return!0;return!1}function pp(r,t,o,l=1/0){const f=Fc(r),y=Fc(t);if(l!==1/0&&Vc(f,y,o)>=l)return l;if(_a(f,y)){if(Nc(r,t))return 0}else if(Nc(t,r))return 0;let x=1/0;for(const b of r)for(let E=0,A=b.length,P=A-1;E<A;P=E++){const D=b[P],B=b[E];for(const V of t)for(let j=0,Z=V.length,Y=Z-1;j<Z;Y=j++){const se=V[Y],Ee=V[j];if(hl(D,B,se,Ee))return 0;x=Math.min(x,xa(D,B,se,Ee,o))}}return x}function Bh(r,t,o,l,f,y){if(!y)return;const x=Vc(Bc(l,y),f,o);x<t&&r.push([x,y,[0,0]])}function pl(r,t,o,l,f,y,x){if(!y||!x)return;const b=Vc(Bc(l,y),Bc(f,x),o);b<t&&r.push([b,y,x])}function ml(r,t,o,l,f=1/0){let y=Math.min(l.distance(r[0],o[0][0]),f);if(y===0)return y;const x=new Mh([[0,[0,r.length-1],[0,0]]],Rh),b=Fc(o);for(;x.length>0;){const E=x.pop();if(E[0]>=y)continue;const A=E[1],P=t?50:100;if(Es(A)<=P){if(!oo(A,r.length))return NaN;if(t){const D=Oh(r,A,o,l);if(isNaN(D)||D===0)return D;y=Math.min(y,D)}else for(let D=A[0];D<=A[1];++D){const B=fl(r[D],o,l);if(y=Math.min(y,B),y===0)return 0}}else{const D=Oc(A,t);Bh(x,y,l,r,b,D[0]),Bh(x,y,l,r,b,D[1])}}return y}function ba(r,t,o,l,f,y=1/0){let x=Math.min(y,f.distance(r[0],o[0]));if(x===0)return x;const b=new Mh([[0,[0,r.length-1],[0,o.length-1]]],Rh);for(;b.length>0;){const E=b.pop();if(E[0]>=x)continue;const A=E[1],P=E[2],D=t?50:100,B=l?50:100;if(Es(A)<=D&&Es(P)<=B){if(!oo(A,r.length)&&oo(P,o.length))return NaN;let V;if(t&&l)V=Vi(r,A,o,P,f),x=Math.min(x,V);else if(t&&!l){const j=r.slice(A[0],A[1]+1);for(let Z=P[0];Z<=P[1];++Z)if(V=Kt(o[Z],j,f),x=Math.min(x,V),x===0)return x}else if(!t&&l){const j=o.slice(P[0],P[1]+1);for(let Z=A[0];Z<=A[1];++Z)if(V=Kt(r[Z],j,f),x=Math.min(x,V),x===0)return x}else V=zi(r,A,o,P,f),x=Math.min(x,V)}else{const V=Oc(A,t),j=Oc(P,l);pl(b,x,f,r,o,V[0],j[0]),pl(b,x,f,r,o,V[0],j[1]),pl(b,x,f,r,o,V[1],j[0]),pl(b,x,f,r,o,V[1],j[1])}}return x}function gl(r){return r.type==="MultiPolygon"?r.coordinates.map(t=>({type:"Polygon",coordinates:t})):r.type==="MultiLineString"?r.coordinates.map(t=>({type:"LineString",coordinates:t})):r.type==="MultiPoint"?r.coordinates.map(t=>({type:"Point",coordinates:t})):[r]}class vo{constructor(t,o){this.type=Ye,this.geojson=t,this.geometries=o}static parse(t,o){if(t.length!==2)return o.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(no(t[1])){const l=t[1];if(l.type==="FeatureCollection")return new vo(l,l.features.map(f=>gl(f.geometry)).flat());if(l.type==="Feature")return new vo(l,gl(l.geometry));if("type"in l&&"coordinates"in l)return new vo(l,gl(l))}return o.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(o,l){const f=o.geometry(),y=f.flat().map(E=>zc([E.x,E.y],o.canonical));if(f.length===0)return NaN;const x=new Rc(y[0][1]);let b=1/0;for(const E of l){switch(E.type){case"Point":b=Math.min(b,ba(y,!1,[E.coordinates],!1,x,b));break;case"LineString":b=Math.min(b,ba(y,!1,E.coordinates,!0,x,b));break;case"Polygon":b=Math.min(b,ml(y,!1,E.coordinates,x,b))}if(b===0)return b}return b}(t,this.geometries);if(t.geometryType()==="LineString")return function(o,l){const f=o.geometry(),y=f.flat().map(E=>zc([E.x,E.y],o.canonical));if(f.length===0)return NaN;const x=new Rc(y[0][1]);let b=1/0;for(const E of l){switch(E.type){case"Point":b=Math.min(b,ba(y,!0,[E.coordinates],!1,x,b));break;case"LineString":b=Math.min(b,ba(y,!0,E.coordinates,!0,x,b));break;case"Polygon":b=Math.min(b,ml(y,!0,E.coordinates,x,b))}if(b===0)return b}return b}(t,this.geometries);if(t.geometryType()==="Polygon")return function(o,l){const f=o.geometry();if(f.length===0||f[0].length===0)return NaN;const y=dl(f,0).map(E=>E.map(A=>A.map(P=>zc([P.x,P.y],o.canonical)))),x=new Rc(y[0][0][0][1]);let b=1/0;for(const E of l)for(const A of y){switch(E.type){case"Point":b=Math.min(b,ml([E.coordinates],!1,A,x,b));break;case"LineString":b=Math.min(b,ml(E.coordinates,!0,A,x,b));break;case"Polygon":b=Math.min(b,pp(A,E.coordinates,x,b))}if(b===0)return b}return b}(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const Zo={"==":tp,"!=":wh,">":ip,"<":Eh,">=":np,"<=":rp,array:Sn,at:Ic,boolean:Sn,case:ol,coalesce:ll,collator:cl,format:ul,image:Pc,in:nl,"index-of":fa,interpolate:hn,"interpolate-hcl":hn,"interpolate-lab":hn,length:ga,let:rl,literal:Uo,match:Tc,number:Sn,"number-format":Lc,object:Sn,slice:pa,step:ma,string:Sn,"to-boolean":Un,"to-color":Un,"to-number":Un,"to-string":Un,var:xs,within:Go,distance:vo};class Qr{constructor(t,o,l,f){this.name=t,this.type=o,this._evaluate=l,this.args=f}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,o){const l=t[0],f=Qr.definitions[l];if(!f)return o.error(`Unknown expression "${l}". If you wanted a literal array, use ["literal", [...]].`,0);const y=Array.isArray(f)?f[0]:f.type,x=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,b=x.filter(([A])=>!Array.isArray(A)||A.length===t.length-1);let E=null;for(const[A,P]of b){E=new ci(o.registry,yl,o.path,null,o.scope);const D=[];let B=!1;for(let V=1;V<t.length;V++){const j=t[V],Z=Array.isArray(A)?A[V-1]:A.type,Y=E.parse(j,1+D.length,Z);if(!Y){B=!0;break}D.push(Y)}if(!B)if(Array.isArray(A)&&A.length!==D.length)E.error(`Expected ${A.length} arguments, but found ${D.length} instead.`);else{for(let V=0;V<D.length;V++){const j=Array.isArray(A)?A[V]:A.type,Z=D[V];E.concat(V+1).checkSubtype(j,Z.type)}if(E.errors.length===0)return new Qr(l,y,P,D)}}if(b.length===1)o.errors.push(...E.errors);else{const A=(b.length?b:x).map(([D])=>{return B=D,Array.isArray(B)?`(${B.map(U).join(", ")})`:`(${U(B.type)}...)`;var B}).join(" | "),P=[];for(let D=1;D<t.length;D++){const B=o.parse(t[D],1+P.length);if(!B)return null;P.push(U(B.type))}o.error(`Expected arguments of type ${A}, but found (${P.join(", ")}) instead.`)}return null}static register(t,o){Qr.definitions=o;for(const l in o)t[l]=Qr}}function Fh(r,[t,o,l,f]){t=t.evaluate(r),o=o.evaluate(r),l=l.evaluate(r);const y=f?f.evaluate(r):1,x=xh(t,o,l,y);if(x)throw new Wi(x);return new di(t/255,o/255,l/255,y,!1)}function Vh(r,t){return r in t}function $c(r,t){const o=t[r];return o===void 0?null:o}function Wo(r){return{type:r}}function yl(r){if(r instanceof xs)return yl(r.boundExpression);if(r instanceof Qr&&r.name==="error"||r instanceof cl||r instanceof Go||r instanceof vo)return!1;const t=r instanceof Un||r instanceof Sn;let o=!0;return r.eachChild(l=>{o=t?o&&yl(l):o&&l instanceof Uo}),!!o&&_l(r)&&vl(r,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function _l(r){if(r instanceof Qr&&(r.name==="get"&&r.args.length===1||r.name==="feature-state"||r.name==="has"&&r.args.length===1||r.name==="properties"||r.name==="geometry-type"||r.name==="id"||/^filter-/.test(r.name))||r instanceof Go||r instanceof vo)return!1;let t=!0;return r.eachChild(o=>{t&&!_l(o)&&(t=!1)}),t}function wa(r){if(r instanceof Qr&&r.name==="feature-state")return!1;let t=!0;return r.eachChild(o=>{t&&!wa(o)&&(t=!1)}),t}function vl(r,t){if(r instanceof Qr&&t.indexOf(r.name)>=0)return!1;let o=!0;return r.eachChild(l=>{o&&!vl(l,t)&&(o=!1)}),o}function jc(r){return{result:"success",value:r}}function Ko(r){return{result:"error",value:r}}function so(r){return r["property-type"]==="data-driven"||r["property-type"]==="cross-faded-data-driven"}function Nh(r){return!!r.expression&&r.expression.parameters.indexOf("zoom")>-1}function xl(r){return!!r.expression&&r.expression.interpolated}function oi(r){return r instanceof Number?"number":r instanceof String?"string":r instanceof Boolean?"boolean":Array.isArray(r)?"array":r===null?"null":typeof r}function Ss(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)}function bl(r){return r}function Ea(r,t){const o=t.type==="color",l=r.stops&&typeof r.stops[0][0]=="object",f=l||!(l||r.property!==void 0),y=r.type||(xl(t)?"exponential":"interval");if(o||t.type==="padding"){const P=o?di.parse:Jr.parse;(r=Gt({},r)).stops&&(r.stops=r.stops.map(D=>[D[0],P(D[1])])),r.default=P(r.default?r.default:t.default)}if(r.colorSpace&&(x=r.colorSpace)!=="rgb"&&x!=="hcl"&&x!=="lab")throw new Error(`Unknown color space: "${r.colorSpace}"`);var x;let b,E,A;if(y==="exponential")b=qc;else if(y==="interval")b=$h;else if(y==="categorical"){b=Uc,E=Object.create(null);for(const P of r.stops)E[P[0]]=P[1];A=typeof r.stops[0][0]}else{if(y!=="identity")throw new Error(`Unknown function type "${y}"`);b=wl}if(l){const P={},D=[];for(let j=0;j<r.stops.length;j++){const Z=r.stops[j],Y=Z[0].zoom;P[Y]===void 0&&(P[Y]={zoom:Y,type:r.type,property:r.property,default:r.default,stops:[]},D.push(Y)),P[Y].stops.push([Z[0].value,Z[1]])}const B=[];for(const j of D)B.push([P[j].zoom,Ea(P[j],t)]);const V={name:"linear"};return{kind:"composite",interpolationType:V,interpolationFactor:hn.interpolationFactor.bind(void 0,V),zoomStops:B.map(j=>j[0]),evaluate:({zoom:j},Z)=>qc({stops:B,base:r.base},t,j).evaluate(j,Z)}}if(f){const P=y==="exponential"?{name:"exponential",base:r.base!==void 0?r.base:1}:null;return{kind:"camera",interpolationType:P,interpolationFactor:hn.interpolationFactor.bind(void 0,P),zoomStops:r.stops.map(D=>D[0]),evaluate:({zoom:D})=>b(r,t,D,E,A)}}return{kind:"source",evaluate(P,D){const B=D&&D.properties?D.properties[r.property]:void 0;return B===void 0?Is(r.default,t.default):b(r,t,B,E,A)}}}function Is(r,t,o){return r!==void 0?r:t!==void 0?t:o!==void 0?o:void 0}function Uc(r,t,o,l,f){return Is(typeof o===f?l[o]:void 0,r.default,t.default)}function $h(r,t,o){if(oi(o)!=="number")return Is(r.default,t.default);const l=r.stops.length;if(l===1||o<=r.stops[0][0])return r.stops[0][1];if(o>=r.stops[l-1][0])return r.stops[l-1][1];const f=sl(r.stops.map(y=>y[0]),o);return r.stops[f][1]}function qc(r,t,o){const l=r.base!==void 0?r.base:1;if(oi(o)!=="number")return Is(r.default,t.default);const f=r.stops.length;if(f===1||o<=r.stops[0][0])return r.stops[0][1];if(o>=r.stops[f-1][0])return r.stops[f-1][1];const y=sl(r.stops.map(P=>P[0]),o),x=function(P,D,B,V){const j=V-B,Z=P-B;return j===0?0:D===1?Z/j:(Math.pow(D,Z)-1)/(Math.pow(D,j)-1)}(o,l,r.stops[y][0],r.stops[y+1][0]),b=r.stops[y][1],E=r.stops[y+1][1],A=Vr[t.type]||bl;return typeof b.evaluate=="function"?{evaluate(...P){const D=b.evaluate.apply(void 0,P),B=E.evaluate.apply(void 0,P);if(D!==void 0&&B!==void 0)return A(D,B,x,r.colorSpace)}}:A(b,E,x,r.colorSpace)}function wl(r,t,o){switch(t.type){case"color":o=di.parse(o);break;case"formatted":o=un.fromString(o.toString());break;case"resolvedImage":o=_n.fromString(o.toString());break;case"padding":o=Jr.parse(o);break;default:oi(o)===t.type||t.type==="enum"&&t.values[o]||(o=void 0)}return Is(o,r.default,t.default)}Qr.register(Zo,{error:[{kind:"error"},[Bt],(r,[t])=>{throw new Wi(t.evaluate(r))}],typeof:[Bt,[Ft],(r,[t])=>U(nr(t.evaluate(r)))],"to-rgba":[N(Ye,4),[pi],(r,[t])=>{const[o,l,f,y]=t.evaluate(r).rgb;return[255*o,255*l,255*f,y]}],rgb:[pi,[Ye,Ye,Ye],Fh],rgba:[pi,[Ye,Ye,Ye,Ye],Fh],has:{type:Dt,overloads:[[[Bt],(r,[t])=>Vh(t.evaluate(r),r.properties())],[[Bt,Ii],(r,[t,o])=>Vh(t.evaluate(r),o.evaluate(r))]]},get:{type:Ft,overloads:[[[Bt],(r,[t])=>$c(t.evaluate(r),r.properties())],[[Bt,Ii],(r,[t,o])=>$c(t.evaluate(r),o.evaluate(r))]]},"feature-state":[Ft,[Bt],(r,[t])=>$c(t.evaluate(r),r.featureState||{})],properties:[Ii,[],r=>r.properties()],"geometry-type":[Bt,[],r=>r.geometryType()],id:[Ft,[],r=>r.id()],zoom:[Ye,[],r=>r.globals.zoom],"heatmap-density":[Ye,[],r=>r.globals.heatmapDensity||0],"line-progress":[Ye,[],r=>r.globals.lineProgress||0],accumulated:[Ft,[],r=>r.globals.accumulated===void 0?null:r.globals.accumulated],"+":[Ye,Wo(Ye),(r,t)=>{let o=0;for(const l of t)o+=l.evaluate(r);return o}],"*":[Ye,Wo(Ye),(r,t)=>{let o=1;for(const l of t)o*=l.evaluate(r);return o}],"-":{type:Ye,overloads:[[[Ye,Ye],(r,[t,o])=>t.evaluate(r)-o.evaluate(r)],[[Ye],(r,[t])=>-t.evaluate(r)]]},"/":[Ye,[Ye,Ye],(r,[t,o])=>t.evaluate(r)/o.evaluate(r)],"%":[Ye,[Ye,Ye],(r,[t,o])=>t.evaluate(r)%o.evaluate(r)],ln2:[Ye,[],()=>Math.LN2],pi:[Ye,[],()=>Math.PI],e:[Ye,[],()=>Math.E],"^":[Ye,[Ye,Ye],(r,[t,o])=>Math.pow(t.evaluate(r),o.evaluate(r))],sqrt:[Ye,[Ye],(r,[t])=>Math.sqrt(t.evaluate(r))],log10:[Ye,[Ye],(r,[t])=>Math.log(t.evaluate(r))/Math.LN10],ln:[Ye,[Ye],(r,[t])=>Math.log(t.evaluate(r))],log2:[Ye,[Ye],(r,[t])=>Math.log(t.evaluate(r))/Math.LN2],sin:[Ye,[Ye],(r,[t])=>Math.sin(t.evaluate(r))],cos:[Ye,[Ye],(r,[t])=>Math.cos(t.evaluate(r))],tan:[Ye,[Ye],(r,[t])=>Math.tan(t.evaluate(r))],asin:[Ye,[Ye],(r,[t])=>Math.asin(t.evaluate(r))],acos:[Ye,[Ye],(r,[t])=>Math.acos(t.evaluate(r))],atan:[Ye,[Ye],(r,[t])=>Math.atan(t.evaluate(r))],min:[Ye,Wo(Ye),(r,t)=>Math.min(...t.map(o=>o.evaluate(r)))],max:[Ye,Wo(Ye),(r,t)=>Math.max(...t.map(o=>o.evaluate(r)))],abs:[Ye,[Ye],(r,[t])=>Math.abs(t.evaluate(r))],round:[Ye,[Ye],(r,[t])=>{const o=t.evaluate(r);return o<0?-Math.round(-o):Math.round(o)}],floor:[Ye,[Ye],(r,[t])=>Math.floor(t.evaluate(r))],ceil:[Ye,[Ye],(r,[t])=>Math.ceil(t.evaluate(r))],"filter-==":[Dt,[Bt,Ft],(r,[t,o])=>r.properties()[t.value]===o.value],"filter-id-==":[Dt,[Ft],(r,[t])=>r.id()===t.value],"filter-type-==":[Dt,[Bt],(r,[t])=>r.geometryType()===t.value],"filter-<":[Dt,[Bt,Ft],(r,[t,o])=>{const l=r.properties()[t.value],f=o.value;return typeof l==typeof f&&l<f}],"filter-id-<":[Dt,[Ft],(r,[t])=>{const o=r.id(),l=t.value;return typeof o==typeof l&&o<l}],"filter->":[Dt,[Bt,Ft],(r,[t,o])=>{const l=r.properties()[t.value],f=o.value;return typeof l==typeof f&&l>f}],"filter-id->":[Dt,[Ft],(r,[t])=>{const o=r.id(),l=t.value;return typeof o==typeof l&&o>l}],"filter-<=":[Dt,[Bt,Ft],(r,[t,o])=>{const l=r.properties()[t.value],f=o.value;return typeof l==typeof f&&l<=f}],"filter-id-<=":[Dt,[Ft],(r,[t])=>{const o=r.id(),l=t.value;return typeof o==typeof l&&o<=l}],"filter->=":[Dt,[Bt,Ft],(r,[t,o])=>{const l=r.properties()[t.value],f=o.value;return typeof l==typeof f&&l>=f}],"filter-id->=":[Dt,[Ft],(r,[t])=>{const o=r.id(),l=t.value;return typeof o==typeof l&&o>=l}],"filter-has":[Dt,[Ft],(r,[t])=>t.value in r.properties()],"filter-has-id":[Dt,[],r=>r.id()!==null&&r.id()!==void 0],"filter-type-in":[Dt,[N(Bt)],(r,[t])=>t.value.indexOf(r.geometryType())>=0],"filter-id-in":[Dt,[N(Ft)],(r,[t])=>t.value.indexOf(r.id())>=0],"filter-in-small":[Dt,[Bt,N(Ft)],(r,[t,o])=>o.value.indexOf(r.properties()[t.value])>=0],"filter-in-large":[Dt,[Bt,N(Ft)],(r,[t,o])=>function(l,f,y,x){for(;y<=x;){const b=y+x>>1;if(f[b]===l)return!0;f[b]>l?x=b-1:y=b+1}return!1}(r.properties()[t.value],o.value,0,o.value.length-1)],all:{type:Dt,overloads:[[[Dt,Dt],(r,[t,o])=>t.evaluate(r)&&o.evaluate(r)],[Wo(Dt),(r,t)=>{for(const o of t)if(!o.evaluate(r))return!1;return!0}]]},any:{type:Dt,overloads:[[[Dt,Dt],(r,[t,o])=>t.evaluate(r)||o.evaluate(r)],[Wo(Dt),(r,t)=>{for(const o of t)if(o.evaluate(r))return!0;return!1}]]},"!":[Dt,[Dt],(r,[t])=>!t.evaluate(r)],"is-supported-script":[Dt,[Bt],(r,[t])=>{const o=r.globals&&r.globals.isSupportedScript;return!o||o(t.evaluate(r))}],upcase:[Bt,[Bt],(r,[t])=>t.evaluate(r).toUpperCase()],downcase:[Bt,[Bt],(r,[t])=>t.evaluate(r).toLowerCase()],concat:[Bt,Wo(Ft),(r,t)=>t.map(o=>da(o.evaluate(r))).join("")],"resolved-locale":[Bt,[io],(r,[t])=>t.evaluate(r).resolvedLocale()]});class Hc{constructor(t,o){var l;this.expression=t,this._warningHistory={},this._evaluator=new vs,this._defaultValue=o?(l=o).type==="color"&&Ss(l.default)?new di(0,0,0,0):l.type==="color"?di.parse(l.default)||null:l.type==="padding"?Jr.parse(l.default)||null:l.type==="variableAnchorOffsetCollection"?Yr.parse(l.default)||null:l.default===void 0?null:l.default:null,this._enumValues=o&&o.type==="enum"?o.values:null}evaluateWithoutErrorHandling(t,o,l,f,y,x){return this._evaluator.globals=t,this._evaluator.feature=o,this._evaluator.featureState=l,this._evaluator.canonical=f,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=x,this.expression.evaluate(this._evaluator)}evaluate(t,o,l,f,y,x){this._evaluator.globals=t,this._evaluator.feature=o||null,this._evaluator.featureState=l||null,this._evaluator.canonical=f,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=x||null;try{const b=this.expression.evaluate(this._evaluator);if(b==null||typeof b=="number"&&b!=b)return this._defaultValue;if(this._enumValues&&!(b in this._enumValues))throw new Wi(`Expected value to be one of ${Object.keys(this._enumValues).map(E=>JSON.stringify(E)).join(", ")}, but found ${JSON.stringify(b)} instead.`);return b}catch(b){return this._warningHistory[b.message]||(this._warningHistory[b.message]=!0,typeof console<"u"&&console.warn(b.message)),this._defaultValue}}}function El(r){return Array.isArray(r)&&r.length>0&&typeof r[0]=="string"&&r[0]in Zo}function Sl(r,t){const o=new ci(Zo,yl,[],t?function(f){const y={color:pi,string:Bt,number:Ye,enum:Bt,boolean:Dt,formatted:ro,padding:gr,resolvedImage:Q,variableAnchorOffsetCollection:F};return f.type==="array"?N(y[f.value]||Ft,f.length):y[f.type]}(t):void 0),l=o.parse(r,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?jc(new Hc(l,t)):Ko(o.errors)}class Gc{constructor(t,o){this.kind=t,this._styleExpression=o,this.isStateDependent=t!=="constant"&&!wa(o.expression)}evaluateWithoutErrorHandling(t,o,l,f,y,x){return this._styleExpression.evaluateWithoutErrorHandling(t,o,l,f,y,x)}evaluate(t,o,l,f,y,x){return this._styleExpression.evaluate(t,o,l,f,y,x)}}class Zc{constructor(t,o,l,f){this.kind=t,this.zoomStops=l,this._styleExpression=o,this.isStateDependent=t!=="camera"&&!wa(o.expression),this.interpolationType=f}evaluateWithoutErrorHandling(t,o,l,f,y,x){return this._styleExpression.evaluateWithoutErrorHandling(t,o,l,f,y,x)}evaluate(t,o,l,f,y,x){return this._styleExpression.evaluate(t,o,l,f,y,x)}interpolationFactor(t,o,l){return this.interpolationType?hn.interpolationFactor(this.interpolationType,t,o,l):0}}function Sa(r,t){const o=Sl(r,t);if(o.result==="error")return o;const l=o.value.expression,f=_l(l);if(!f&&!so(t))return Ko([new ai("","data expressions not supported")]);const y=vl(l,["zoom"]);if(!y&&!Nh(t))return Ko([new ai("","zoom expressions not supported")]);const x=Cr(l);return x||y?x instanceof ai?Ko([x]):x instanceof hn&&!xl(t)?Ko([new ai("",'"interpolate" expressions cannot be used with this property')]):jc(x?new Zc(f?"camera":"composite",o.value,x.labels,x instanceof hn?x.interpolation:void 0):new Gc(f?"constant":"source",o.value)):Ko([new ai("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Xo{constructor(t,o){this._parameters=t,this._specification=o,Gt(this,Ea(this._parameters,this._specification))}static deserialize(t){return new Xo(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function Cr(r){let t=null;if(r instanceof rl)t=Cr(r.result);else if(r instanceof ll){for(const o of r.args)if(t=Cr(o),t)break}else(r instanceof ma||r instanceof hn)&&r.input instanceof Qr&&r.input.name==="zoom"&&(t=r);return t instanceof ai||r.eachChild(o=>{const l=Cr(o);l instanceof ai?t=l:!t&&l?t=new ai("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&l&&t!==l&&(t=new ai("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function Jo(r){if(r===!0||r===!1)return!0;if(!Array.isArray(r)||r.length===0)return!1;switch(r[0]){case"has":return r.length>=2&&r[1]!=="$id"&&r[1]!=="$type";case"in":return r.length>=3&&(typeof r[1]!="string"||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return r.length!==3||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(const t of r.slice(1))if(!Jo(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const jh={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Wc(r){if(r==null)return{filter:()=>!0,needGeometry:!1};Jo(r)||(r=Ia(r));const t=Sl(r,jh);if(t.result==="error")throw new Error(t.value.map(o=>`${o.key}: ${o.message}`).join(", "));return{filter:(o,l,f)=>t.value.evaluate(o,l,{},f),needGeometry:Ts(r)}}function mp(r,t){return r<t?-1:r>t?1:0}function Ts(r){if(!Array.isArray(r))return!1;if(r[0]==="within"||r[0]==="distance")return!0;for(let t=1;t<r.length;t++)if(Ts(r[t]))return!0;return!1}function Ia(r){if(!r)return!0;const t=r[0];return r.length<=1?t!=="any":t==="=="?Ta(r[1],r[2],"=="):t==="!="?Tl(Ta(r[1],r[2],"==")):t==="<"||t===">"||t==="<="||t===">="?Ta(r[1],r[2],t):t==="any"?(o=r.slice(1),["any"].concat(o.map(Ia))):t==="all"?["all"].concat(r.slice(1).map(Ia)):t==="none"?["all"].concat(r.slice(1).map(Ia).map(Tl)):t==="in"?Uh(r[1],r.slice(2)):t==="!in"?Tl(Uh(r[1],r.slice(2))):t==="has"?Il(r[1]):t!=="!has"||Tl(Il(r[1]));var o}function Ta(r,t,o){switch(r){case"$type":return[`filter-type-${o}`,t];case"$id":return[`filter-id-${o}`,t];default:return[`filter-${o}`,r,t]}}function Uh(r,t){if(t.length===0)return!1;switch(r){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(o=>typeof o!=typeof t[0])?["filter-in-large",r,["literal",t.sort(mp)]]:["filter-in-small",r,["literal",t]]}}function Il(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function Tl(r){return["!",r]}function Yo(r){const t=typeof r;if(t==="number"||t==="boolean"||t==="string"||r==null)return JSON.stringify(r);if(Array.isArray(r)){let f="[";for(const y of r)f+=`${Yo(y)},`;return`${f}]`}const o=Object.keys(r).sort();let l="{";for(let f=0;f<o.length;f++)l+=`${JSON.stringify(o[f])}:${Yo(r[o[f]])},`;return`${l}}`}function gp(r){let t="";for(const o of He)t+=`/${Yo(r[o])}`;return t}function Cl(r){const t=r.value;return t?[new $e(r.key,t,"constants have been deprecated as of v8")]:[]}function Ui(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function ao(r){if(Array.isArray(r))return r.map(ao);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){const t={};for(const o in r)t[o]=ao(r[o]);return t}return Ui(r)}function fn(r){const t=r.key,o=r.value,l=r.valueSpec||{},f=r.objectElementValidators||{},y=r.style,x=r.styleSpec,b=r.validateSpec;let E=[];const A=oi(o);if(A!=="object")return[new $e(t,o,`object expected, ${A} found`)];for(const P in o){const D=P.split(".")[0],B=l[D]||l["*"];let V;if(f[D])V=f[D];else if(l[D])V=b;else if(f["*"])V=f["*"];else{if(!l["*"]){E.push(new $e(t,o[P],`unknown property "${P}"`));continue}V=b}E=E.concat(V({key:(t&&`${t}.`)+P,value:o[P],valueSpec:B,style:y,styleSpec:x,object:o,objectKey:P,validateSpec:b},o))}for(const P in l)f[P]||l[P].required&&l[P].default===void 0&&o[P]===void 0&&E.push(new $e(t,o,`missing required property "${P}"`));return E}function Al(r){const t=r.value,o=r.valueSpec,l=r.style,f=r.styleSpec,y=r.key,x=r.arrayElementValidator||r.validateSpec;if(oi(t)!=="array")return[new $e(y,t,`array expected, ${oi(t)} found`)];if(o.length&&t.length!==o.length)return[new $e(y,t,`array length ${o.length} expected, length ${t.length} found`)];if(o["min-length"]&&t.length<o["min-length"])return[new $e(y,t,`array length at least ${o["min-length"]} expected, length ${t.length} found`)];let b={type:o.value,values:o.values};f.$version<7&&(b.function=o.function),oi(o.value)==="object"&&(b=o.value);let E=[];for(let A=0;A<t.length;A++)E=E.concat(x({array:t,arrayIndex:A,value:t[A],valueSpec:b,validateSpec:r.validateSpec,style:l,styleSpec:f,key:`${y}[${A}]`}));return E}function Kc(r){const t=r.key,o=r.value,l=r.valueSpec;let f=oi(o);return f==="number"&&o!=o&&(f="NaN"),f!=="number"?[new $e(t,o,`number expected, ${f} found`)]:"minimum"in l&&o<l.minimum?[new $e(t,o,`${o} is less than the minimum value ${l.minimum}`)]:"maximum"in l&&o>l.maximum?[new $e(t,o,`${o} is greater than the maximum value ${l.maximum}`)]:[]}function kl(r){const t=r.valueSpec,o=Ui(r.value.type);let l,f,y,x={};const b=o!=="categorical"&&r.value.property===void 0,E=!b,A=oi(r.value.stops)==="array"&&oi(r.value.stops[0])==="array"&&oi(r.value.stops[0][0])==="object",P=fn({key:r.key,value:r.value,valueSpec:r.styleSpec.function,validateSpec:r.validateSpec,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{stops:function(V){if(o==="identity")return[new $e(V.key,V.value,'identity function may not have a "stops" property')];let j=[];const Z=V.value;return j=j.concat(Al({key:V.key,value:Z,valueSpec:V.valueSpec,validateSpec:V.validateSpec,style:V.style,styleSpec:V.styleSpec,arrayElementValidator:D})),oi(Z)==="array"&&Z.length===0&&j.push(new $e(V.key,Z,"array must have at least one stop")),j},default:function(V){return V.validateSpec({key:V.key,value:V.value,valueSpec:t,validateSpec:V.validateSpec,style:V.style,styleSpec:V.styleSpec})}}});return o==="identity"&&b&&P.push(new $e(r.key,r.value,'missing required property "property"')),o==="identity"||r.value.stops||P.push(new $e(r.key,r.value,'missing required property "stops"')),o==="exponential"&&r.valueSpec.expression&&!xl(r.valueSpec)&&P.push(new $e(r.key,r.value,"exponential functions not supported")),r.styleSpec.$version>=8&&(E&&!so(r.valueSpec)?P.push(new $e(r.key,r.value,"property functions not supported")):b&&!Nh(r.valueSpec)&&P.push(new $e(r.key,r.value,"zoom functions not supported"))),o!=="categorical"&&!A||r.value.property!==void 0||P.push(new $e(r.key,r.value,'"property" property is required')),P;function D(V){let j=[];const Z=V.value,Y=V.key;if(oi(Z)!=="array")return[new $e(Y,Z,`array expected, ${oi(Z)} found`)];if(Z.length!==2)return[new $e(Y,Z,`array length 2 expected, length ${Z.length} found`)];if(A){if(oi(Z[0])!=="object")return[new $e(Y,Z,`object expected, ${oi(Z[0])} found`)];if(Z[0].zoom===void 0)return[new $e(Y,Z,"object stop key must have zoom")];if(Z[0].value===void 0)return[new $e(Y,Z,"object stop key must have value")];if(y&&y>Ui(Z[0].zoom))return[new $e(Y,Z[0].zoom,"stop zoom values must appear in ascending order")];Ui(Z[0].zoom)!==y&&(y=Ui(Z[0].zoom),f=void 0,x={}),j=j.concat(fn({key:`${Y}[0]`,value:Z[0],valueSpec:{zoom:{}},validateSpec:V.validateSpec,style:V.style,styleSpec:V.styleSpec,objectElementValidators:{zoom:Kc,value:B}}))}else j=j.concat(B({key:`${Y}[0]`,value:Z[0],valueSpec:{},validateSpec:V.validateSpec,style:V.style,styleSpec:V.styleSpec},Z));return El(ao(Z[1]))?j.concat([new $e(`${Y}[1]`,Z[1],"expressions are not allowed in function stops.")]):j.concat(V.validateSpec({key:`${Y}[1]`,value:Z[1],valueSpec:t,validateSpec:V.validateSpec,style:V.style,styleSpec:V.styleSpec}))}function B(V,j){const Z=oi(V.value),Y=Ui(V.value),se=V.value!==null?V.value:j;if(l){if(Z!==l)return[new $e(V.key,se,`${Z} stop domain type must match previous stop domain type ${l}`)]}else l=Z;if(Z!=="number"&&Z!=="string"&&Z!=="boolean")return[new $e(V.key,se,"stop domain value must be a number, string, or boolean")];if(Z!=="number"&&o!=="categorical"){let Ee=`number expected, ${Z} found`;return so(t)&&o===void 0&&(Ee+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new $e(V.key,se,Ee)]}return o!=="categorical"||Z!=="number"||isFinite(Y)&&Math.floor(Y)===Y?o!=="categorical"&&Z==="number"&&f!==void 0&&Y<f?[new $e(V.key,se,"stop domain values must appear in ascending order")]:(f=Y,o==="categorical"&&Y in x?[new $e(V.key,se,"stop domain values must be unique")]:(x[Y]=!0,[])):[new $e(V.key,se,`integer expected, found ${Y}`)]}}function lo(r){const t=(r.expressionContext==="property"?Sa:Sl)(ao(r.value),r.valueSpec);if(t.result==="error")return t.value.map(l=>new $e(`${r.key}${l.key}`,r.value,l.message));const o=t.value.expression||t.value._styleExpression.expression;if(r.expressionContext==="property"&&r.propertyKey==="text-font"&&!o.outputDefined())return[new $e(r.key,r.value,`Invalid data expression for "${r.propertyKey}". Output values must be contained as literals within the expression.`)];if(r.expressionContext==="property"&&r.propertyType==="layout"&&!wa(o))return[new $e(r.key,r.value,'"feature-state" data expressions are not supported with layout properties.')];if(r.expressionContext==="filter"&&!wa(o))return[new $e(r.key,r.value,'"feature-state" data expressions are not supported with filters.')];if(r.expressionContext&&r.expressionContext.indexOf("cluster")===0){if(!vl(o,["zoom","feature-state"]))return[new $e(r.key,r.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(r.expressionContext==="cluster-initial"&&!_l(o))return[new $e(r.key,r.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Cs(r){const t=r.key,o=r.value,l=r.valueSpec,f=[];return Array.isArray(l.values)?l.values.indexOf(Ui(o))===-1&&f.push(new $e(t,o,`expected one of [${l.values.join(", ")}], ${JSON.stringify(o)} found`)):Object.keys(l.values).indexOf(Ui(o))===-1&&f.push(new $e(t,o,`expected one of [${Object.keys(l.values).join(", ")}], ${JSON.stringify(o)} found`)),f}function Ml(r){return Jo(ao(r.value))?lo(Gt({},r,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Xc(r)}function Xc(r){const t=r.value,o=r.key;if(oi(t)!=="array")return[new $e(o,t,`array expected, ${oi(t)} found`)];const l=r.styleSpec;let f,y=[];if(t.length<1)return[new $e(o,t,"filter array must have at least 1 element")];switch(y=y.concat(Cs({key:`${o}[0]`,value:t[0],valueSpec:l.filter_operator,style:r.style,styleSpec:r.styleSpec})),Ui(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&Ui(t[1])==="$type"&&y.push(new $e(o,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&y.push(new $e(o,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(f=oi(t[1]),f!=="string"&&y.push(new $e(`${o}[1]`,t[1],`string expected, ${f} found`)));for(let x=2;x<t.length;x++)f=oi(t[x]),Ui(t[1])==="$type"?y=y.concat(Cs({key:`${o}[${x}]`,value:t[x],valueSpec:l.geometry_type,style:r.style,styleSpec:r.styleSpec})):f!=="string"&&f!=="number"&&f!=="boolean"&&y.push(new $e(`${o}[${x}]`,t[x],`string, number, or boolean expected, ${f} found`));break;case"any":case"all":case"none":for(let x=1;x<t.length;x++)y=y.concat(Xc({key:`${o}[${x}]`,value:t[x],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":f=oi(t[1]),t.length!==2?y.push(new $e(o,t,`filter array for "${t[0]}" operator must have 2 elements`)):f!=="string"&&y.push(new $e(`${o}[1]`,t[1],`string expected, ${f} found`))}return y}function Jc(r,t){const o=r.key,l=r.validateSpec,f=r.style,y=r.styleSpec,x=r.value,b=r.objectKey,E=y[`${t}_${r.layerType}`];if(!E)return[];const A=b.match(/^(.*)-transition$/);if(t==="paint"&&A&&E[A[1]]&&E[A[1]].transition)return l({key:o,value:x,valueSpec:y.transition,style:f,styleSpec:y});const P=r.valueSpec||E[b];if(!P)return[new $e(o,x,`unknown property "${b}"`)];let D;if(oi(x)==="string"&&so(P)&&!P.tokens&&(D=/^{([^}]+)}$/.exec(x)))return[new $e(o,x,`"${b}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(D[1])} }\`.`)];const B=[];return r.layerType==="symbol"&&(b==="text-field"&&f&&!f.glyphs&&B.push(new $e(o,x,'use of "text-field" requires a style "glyphs" property')),b==="text-font"&&Ss(ao(x))&&Ui(x.type)==="identity"&&B.push(new $e(o,x,'"text-font" does not support identity functions'))),B.concat(l({key:r.key,value:x,valueSpec:P,style:f,styleSpec:y,expressionContext:"property",propertyType:t,propertyKey:b}))}function Ll(r){return Jc(r,"paint")}function Yc(r){return Jc(r,"layout")}function qh(r){let t=[];const o=r.value,l=r.key,f=r.style,y=r.styleSpec;o.type||o.ref||t.push(new $e(l,o,'either "type" or "ref" is required'));let x=Ui(o.type);const b=Ui(o.ref);if(o.id){const E=Ui(o.id);for(let A=0;A<r.arrayIndex;A++){const P=f.layers[A];Ui(P.id)===E&&t.push(new $e(l,o.id,`duplicate layer id "${o.id}", previously used at line ${P.id.__line__}`))}}if("ref"in o){let E;["type","source","source-layer","filter","layout"].forEach(A=>{A in o&&t.push(new $e(l,o[A],`"${A}" is prohibited for ref layers`))}),f.layers.forEach(A=>{Ui(A.id)===b&&(E=A)}),E?E.ref?t.push(new $e(l,o.ref,"ref cannot reference another ref layer")):x=Ui(E.type):t.push(new $e(l,o.ref,`ref layer "${b}" not found`))}else if(x!=="background")if(o.source){const E=f.sources&&f.sources[o.source],A=E&&Ui(E.type);E?A==="vector"&&x==="raster"?t.push(new $e(l,o.source,`layer "${o.id}" requires a raster source`)):A!=="raster-dem"&&x==="hillshade"?t.push(new $e(l,o.source,`layer "${o.id}" requires a raster-dem source`)):A==="raster"&&x!=="raster"?t.push(new $e(l,o.source,`layer "${o.id}" requires a vector source`)):A!=="vector"||o["source-layer"]?A==="raster-dem"&&x!=="hillshade"?t.push(new $e(l,o.source,"raster-dem source can only be used with layer type 'hillshade'.")):x!=="line"||!o.paint||!o.paint["line-gradient"]||A==="geojson"&&E.lineMetrics||t.push(new $e(l,o,`layer "${o.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new $e(l,o,`layer "${o.id}" must specify a "source-layer"`)):t.push(new $e(l,o.source,`source "${o.source}" not found`))}else t.push(new $e(l,o,'missing required property "source"'));return t=t.concat(fn({key:l,value:o,valueSpec:y.layer,style:r.style,styleSpec:r.styleSpec,validateSpec:r.validateSpec,objectElementValidators:{"*":()=>[],type:()=>r.validateSpec({key:`${l}.type`,value:o.type,valueSpec:y.layer.type,style:r.style,styleSpec:r.styleSpec,validateSpec:r.validateSpec,object:o,objectKey:"type"}),filter:Ml,layout:E=>fn({layer:o,key:E.key,value:E.value,style:E.style,styleSpec:E.styleSpec,validateSpec:E.validateSpec,objectElementValidators:{"*":A=>Yc(Gt({layerType:x},A))}}),paint:E=>fn({layer:o,key:E.key,value:E.value,style:E.style,styleSpec:E.styleSpec,validateSpec:E.validateSpec,objectElementValidators:{"*":A=>Ll(Gt({layerType:x},A))}})}})),t}function xo(r){const t=r.value,o=r.key,l=oi(t);return l!=="string"?[new $e(o,t,`string expected, ${l} found`)]:[]}const Hh={promoteId:function({key:r,value:t}){if(oi(t)==="string")return xo({key:r,value:t});{const o=[];for(const l in t)o.push(...xo({key:`${r}.${l}`,value:t[l]}));return o}}};function Qc(r){const t=r.value,o=r.key,l=r.styleSpec,f=r.style,y=r.validateSpec;if(!t.type)return[new $e(o,t,'"type" is required')];const x=Ui(t.type);let b;switch(x){case"vector":case"raster":return b=fn({key:o,value:t,valueSpec:l[`source_${x.replace("-","_")}`],style:r.style,styleSpec:l,objectElementValidators:Hh,validateSpec:y}),b;case"raster-dem":return b=function(E){var A;const P=(A=E.sourceName)!==null&&A!==void 0?A:"",D=E.value,B=E.styleSpec,V=B.source_raster_dem,j=E.style;let Z=[];const Y=oi(D);if(D===void 0)return Z;if(Y!=="object")return Z.push(new $e("source_raster_dem",D,`object expected, ${Y} found`)),Z;const se=Ui(D.encoding)==="custom",Ee=["redFactor","greenFactor","blueFactor","baseShift"],fe=E.value.encoding?`"${E.value.encoding}"`:"Default";for(const xe in D)!se&&Ee.includes(xe)?Z.push(new $e(xe,D[xe],`In "${P}": "${xe}" is only valid when "encoding" is set to "custom". ${fe} encoding found`)):V[xe]?Z=Z.concat(E.validateSpec({key:xe,value:D[xe],valueSpec:V[xe],validateSpec:E.validateSpec,style:j,styleSpec:B})):Z.push(new $e(xe,D[xe],`unknown property "${xe}"`));return Z}({sourceName:o,value:t,style:r.style,styleSpec:l,validateSpec:y}),b;case"geojson":if(b=fn({key:o,value:t,valueSpec:l.source_geojson,style:f,styleSpec:l,validateSpec:y,objectElementValidators:Hh}),t.cluster)for(const E in t.clusterProperties){const[A,P]=t.clusterProperties[E],D=typeof A=="string"?[A,["accumulated"],["get",E]]:A;b.push(...lo({key:`${o}.${E}.map`,value:P,validateSpec:y,expressionContext:"cluster-map"})),b.push(...lo({key:`${o}.${E}.reduce`,value:D,validateSpec:y,expressionContext:"cluster-reduce"}))}return b;case"video":return fn({key:o,value:t,valueSpec:l.source_video,style:f,validateSpec:y,styleSpec:l});case"image":return fn({key:o,value:t,valueSpec:l.source_image,style:f,validateSpec:y,styleSpec:l});case"canvas":return[new $e(o,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Cs({key:`${o}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:f,validateSpec:y,styleSpec:l})}}function eu(r){const t=r.value,o=r.styleSpec,l=o.light,f=r.style;let y=[];const x=oi(t);if(t===void 0)return y;if(x!=="object")return y=y.concat([new $e("light",t,`object expected, ${x} found`)]),y;for(const b in t){const E=b.match(/^(.*)-transition$/);y=y.concat(E&&l[E[1]]&&l[E[1]].transition?r.validateSpec({key:b,value:t[b],valueSpec:o.transition,validateSpec:r.validateSpec,style:f,styleSpec:o}):l[b]?r.validateSpec({key:b,value:t[b],valueSpec:l[b],validateSpec:r.validateSpec,style:f,styleSpec:o}):[new $e(b,t[b],`unknown property "${b}"`)])}return y}function tu(r){const t=r.value,o=r.styleSpec,l=o.sky,f=r.style,y=oi(t);if(t===void 0)return[];if(y!=="object")return[new $e("sky",t,`object expected, ${y} found`)];let x=[];for(const b in t)x=x.concat(l[b]?r.validateSpec({key:b,value:t[b],valueSpec:l[b],style:f,styleSpec:o}):[new $e(b,t[b],`unknown property "${b}"`)]);return x}function Gh(r){const t=r.value,o=r.styleSpec,l=o.terrain,f=r.style;let y=[];const x=oi(t);if(t===void 0)return y;if(x!=="object")return y=y.concat([new $e("terrain",t,`object expected, ${x} found`)]),y;for(const b in t)y=y.concat(l[b]?r.validateSpec({key:b,value:t[b],valueSpec:l[b],validateSpec:r.validateSpec,style:f,styleSpec:o}):[new $e(b,t[b],`unknown property "${b}"`)]);return y}function Zh(r){let t=[];const o=r.value,l=r.key;if(Array.isArray(o)){const f=[],y=[];for(const x in o)o[x].id&&f.includes(o[x].id)&&t.push(new $e(l,o,`all the sprites' ids must be unique, but ${o[x].id} is duplicated`)),f.push(o[x].id),o[x].url&&y.includes(o[x].url)&&t.push(new $e(l,o,`all the sprites' URLs must be unique, but ${o[x].url} is duplicated`)),y.push(o[x].url),t=t.concat(fn({key:`${l}[${x}]`,value:o[x],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:r.validateSpec}));return t}return xo({key:l,value:o})}const iu={"*":()=>[],array:Al,boolean:function(r){const t=r.value,o=r.key,l=oi(t);return l!=="boolean"?[new $e(o,t,`boolean expected, ${l} found`)]:[]},number:Kc,color:function(r){const t=r.key,o=r.value,l=oi(o);return l!=="string"?[new $e(t,o,`color expected, ${l} found`)]:di.parse(String(o))?[]:[new $e(t,o,`color expected, "${o}" found`)]},constants:Cl,enum:Cs,filter:Ml,function:kl,layer:qh,object:fn,source:Qc,light:eu,sky:tu,terrain:Gh,projection:function(r){const t=r.value,o=r.styleSpec,l=o.projection,f=r.style,y=oi(t);if(t===void 0)return[];if(y!=="object")return[new $e("projection",t,`object expected, ${y} found`)];let x=[];for(const b in t)x=x.concat(l[b]?r.validateSpec({key:b,value:t[b],valueSpec:l[b],style:f,styleSpec:o}):[new $e(b,t[b],`unknown property "${b}"`)]);return x},string:xo,formatted:function(r){return xo(r).length===0?[]:lo(r)},resolvedImage:function(r){return xo(r).length===0?[]:lo(r)},padding:function(r){const t=r.key,o=r.value;if(oi(o)==="array"){if(o.length<1||o.length>4)return[new $e(t,o,`padding requires 1 to 4 values; ${o.length} values found`)];const l={type:"number"};let f=[];for(let y=0;y<o.length;y++)f=f.concat(r.validateSpec({key:`${t}[${y}]`,value:o[y],validateSpec:r.validateSpec,valueSpec:l}));return f}return Kc({key:t,value:o,valueSpec:{}})},variableAnchorOffsetCollection:function(r){const t=r.key,o=r.value,l=oi(o),f=r.styleSpec;if(l!=="array"||o.length<1||o.length%2!=0)return[new $e(t,o,"variableAnchorOffsetCollection requires a non-empty array of even length")];let y=[];for(let x=0;x<o.length;x+=2)y=y.concat(Cs({key:`${t}[${x}]`,value:o[x],valueSpec:f.layout_symbol["text-anchor"]})),y=y.concat(Al({key:`${t}[${x+1}]`,value:o[x+1],valueSpec:{length:2,value:"number"},validateSpec:r.validateSpec,style:r.style,styleSpec:f}));return y},sprite:Zh};function As(r){const t=r.value,o=r.valueSpec,l=r.styleSpec;return r.validateSpec=As,o.expression&&Ss(Ui(t))?kl(r):o.expression&&El(ao(t))?lo(r):o.type&&iu[o.type]?iu[o.type](r):fn(Gt({},r,{valueSpec:o.type?l[o.type]:o}))}function ru(r){const t=r.value,o=r.key,l=xo(r);return l.length||(t.indexOf("{fontstack}")===-1&&l.push(new $e(o,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&l.push(new $e(o,t,'"glyphs" url must include a "{range}" token'))),l}function vn(r,t=le){let o=[];return o=o.concat(As({key:"",value:r,valueSpec:t.$root,styleSpec:t,style:r,validateSpec:As,objectElementValidators:{glyphs:ru,"*":()=>[]}})),r.constants&&(o=o.concat(Cl({key:"constants",value:r.constants,style:r,styleSpec:t,validateSpec:As}))),Wh(o)}function pn(r){return function(t){return r({...t,validateSpec:As})}}function Wh(r){return[].concat(r).sort((t,o)=>t.line-o.line)}function xn(r){return function(...t){return Wh(r.apply(this,t))}}vn.source=xn(pn(Qc)),vn.sprite=xn(pn(Zh)),vn.glyphs=xn(pn(ru)),vn.light=xn(pn(eu)),vn.sky=xn(pn(tu)),vn.terrain=xn(pn(Gh)),vn.layer=xn(pn(qh)),vn.filter=xn(pn(Ml)),vn.paintProperty=xn(pn(Ll)),vn.layoutProperty=xn(pn(Yc));const Ca=vn,yp=Ca.light,Kh=Ca.paintProperty,Xh=Ca.layoutProperty;function nu(r,t){let o=!1;if(t&&t.length)for(const l of t)r.fire(new ye(new Error(l.message))),o=!0;return o}class Aa{constructor(t,o,l){const f=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const x=new Int32Array(this.arrayBuffer);t=x[0],this.d=(o=x[1])+2*(l=x[2]);for(let E=0;E<this.d*this.d;E++){const A=x[3+E],P=x[3+E+1];f.push(A===P?null:x.subarray(A,P))}const b=x[3+f.length+1];this.keys=x.subarray(x[3+f.length],b),this.bboxes=x.subarray(b),this.insert=this._insertReadonly}else{this.d=o+2*l;for(let x=0;x<this.d*this.d;x++)f.push([]);this.keys=[],this.bboxes=[]}this.n=o,this.extent=t,this.padding=l,this.scale=o/t,this.uid=0;const y=l/o*t;this.min=-y,this.max=t+y}insert(t,o,l,f,y){this._forEachCell(o,l,f,y,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(o),this.bboxes.push(l),this.bboxes.push(f),this.bboxes.push(y)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,o,l,f,y,x){this.cells[y].push(x)}query(t,o,l,f,y){const x=this.min,b=this.max;if(t<=x&&o<=x&&b<=l&&b<=f&&!y)return Array.prototype.slice.call(this.keys);{const E=[];return this._forEachCell(t,o,l,f,this._queryCell,E,{},y),E}}_queryCell(t,o,l,f,y,x,b,E){const A=this.cells[y];if(A!==null){const P=this.keys,D=this.bboxes;for(let B=0;B<A.length;B++){const V=A[B];if(b[V]===void 0){const j=4*V;(E?E(D[j+0],D[j+1],D[j+2],D[j+3]):t<=D[j+2]&&o<=D[j+3]&&l>=D[j+0]&&f>=D[j+1])?(b[V]=!0,x.push(P[V])):b[V]=!1}}}}_forEachCell(t,o,l,f,y,x,b,E){const A=this._convertToCellCoord(t),P=this._convertToCellCoord(o),D=this._convertToCellCoord(l),B=this._convertToCellCoord(f);for(let V=A;V<=D;V++)for(let j=P;j<=B;j++){const Z=this.d*j+V;if((!E||E(this._convertFromCellCoord(V),this._convertFromCellCoord(j),this._convertFromCellCoord(V+1),this._convertFromCellCoord(j+1)))&&y.call(this,t,o,l,f,Z,x,b,E))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,o=3+this.cells.length+1+1;let l=0;for(let x=0;x<this.cells.length;x++)l+=this.cells[x].length;const f=new Int32Array(o+l+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;let y=o;for(let x=0;x<t.length;x++){const b=t[x];f[3+x]=y,f.set(b,y),y+=b.length}return f[3+t.length]=y,f.set(this.keys,y),y+=this.keys.length,f[3+t.length+1]=y,f.set(this.bboxes,y),y+=this.bboxes.length,f.buffer}static serialize(t,o){const l=t.toArrayBuffer();return o&&o.push(l),{buffer:l}}static deserialize(t){return new Aa(t.buffer)}}const bo={};function mt(r,t,o={}){if(bo[r])throw new Error(`${r} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:r,writeable:!1}),bo[r]={klass:t,omit:o.omit||[],shallow:o.shallow||[]}}mt("Object",Object),mt("TransferableGridIndex",Aa),mt("Color",di),mt("Error",Error),mt("AJAXError",Pi),mt("ResolvedImage",_n),mt("StylePropertyFunction",Xo),mt("StyleExpression",Hc,{omit:["_evaluator"]}),mt("ZoomDependentExpression",Zc),mt("ZoomConstantExpression",Gc),mt("CompoundExpression",Qr,{omit:["_evaluate"]});for(const r in Zo)Zo[r]._classRegistryKey||mt(`Expression_${r}`,Zo[r]);function Jh(r){return r&&typeof ArrayBuffer<"u"&&(r instanceof ArrayBuffer||r.constructor&&r.constructor.name==="ArrayBuffer")}function ka(r,t){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||r instanceof Blob||r instanceof Error)return r;if(Jh(r)||dt(r))return t&&t.push(r),r;if(ArrayBuffer.isView(r)){const o=r;return t&&t.push(o.buffer),o}if(r instanceof ImageData)return t&&t.push(r.data.buffer),r;if(Array.isArray(r)){const o=[];for(const l of r)o.push(ka(l,t));return o}if(typeof r=="object"){const o=r.constructor,l=o._classRegistryKey;if(!l)throw new Error(`can't serialize object of unregistered class ${o.name}`);if(!bo[l])throw new Error(`${l} is not registered.`);const f=o.serialize?o.serialize(r,t):{};if(o.serialize){if(t&&f===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const y in r){if(!r.hasOwnProperty(y)||bo[l].omit.indexOf(y)>=0)continue;const x=r[y];f[y]=bo[l].shallow.indexOf(y)>=0?x:ka(x,t)}r instanceof Error&&(f.message=r.message)}if(f.$name)throw new Error("$name property is reserved for worker serialization logic.");return l!=="Object"&&(f.$name=l),f}throw new Error("can't serialize object of type "+typeof r)}function qn(r){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||r instanceof Blob||r instanceof Error||Jh(r)||dt(r)||ArrayBuffer.isView(r)||r instanceof ImageData)return r;if(Array.isArray(r))return r.map(qn);if(typeof r=="object"){const t=r.$name||"Object";if(!bo[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:o}=bo[t];if(!o)throw new Error(`can't deserialize unregistered class ${t}`);if(o.deserialize)return o.deserialize(r);const l=Object.create(o.prototype);for(const f of Object.keys(r)){if(f==="$name")continue;const y=r[f];l[f]=bo[t].shallow.indexOf(f)>=0?y:qn(y)}return l}throw new Error("can't deserialize object of type "+typeof r)}class Yh{constructor(){this.first=!0}update(t,o){const l=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=l,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=l,!0):(this.lastFloorZoom>l?(this.lastIntegerZoom=l+1,this.lastIntegerZoomTime=o):this.lastFloorZoom<l&&(this.lastIntegerZoom=l,this.lastIntegerZoomTime=o),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=l,!0))}}const ct={"Latin-1 Supplement":r=>r>=128&&r<=255,Arabic:r=>r>=1536&&r<=1791,"Arabic Supplement":r=>r>=1872&&r<=1919,"Arabic Extended-A":r=>r>=2208&&r<=2303,"Hangul Jamo":r=>r>=4352&&r<=4607,"Unified Canadian Aboriginal Syllabics":r=>r>=5120&&r<=5759,Khmer:r=>r>=6016&&r<=6143,"Unified Canadian Aboriginal Syllabics Extended":r=>r>=6320&&r<=6399,"General Punctuation":r=>r>=8192&&r<=8303,"Letterlike Symbols":r=>r>=8448&&r<=8527,"Number Forms":r=>r>=8528&&r<=8591,"Miscellaneous Technical":r=>r>=8960&&r<=9215,"Control Pictures":r=>r>=9216&&r<=9279,"Optical Character Recognition":r=>r>=9280&&r<=9311,"Enclosed Alphanumerics":r=>r>=9312&&r<=9471,"Geometric Shapes":r=>r>=9632&&r<=9727,"Miscellaneous Symbols":r=>r>=9728&&r<=9983,"Miscellaneous Symbols and Arrows":r=>r>=11008&&r<=11263,"CJK Radicals Supplement":r=>r>=11904&&r<=12031,"Kangxi Radicals":r=>r>=12032&&r<=12255,"Ideographic Description Characters":r=>r>=12272&&r<=12287,"CJK Symbols and Punctuation":r=>r>=12288&&r<=12351,Hiragana:r=>r>=12352&&r<=12447,Katakana:r=>r>=12448&&r<=12543,Bopomofo:r=>r>=12544&&r<=12591,"Hangul Compatibility Jamo":r=>r>=12592&&r<=12687,Kanbun:r=>r>=12688&&r<=12703,"Bopomofo Extended":r=>r>=12704&&r<=12735,"CJK Strokes":r=>r>=12736&&r<=12783,"Katakana Phonetic Extensions":r=>r>=12784&&r<=12799,"Enclosed CJK Letters and Months":r=>r>=12800&&r<=13055,"CJK Compatibility":r=>r>=13056&&r<=13311,"CJK Unified Ideographs Extension A":r=>r>=13312&&r<=19903,"Yijing Hexagram Symbols":r=>r>=19904&&r<=19967,"CJK Unified Ideographs":r=>r>=19968&&r<=40959,"Yi Syllables":r=>r>=40960&&r<=42127,"Yi Radicals":r=>r>=42128&&r<=42191,"Hangul Jamo Extended-A":r=>r>=43360&&r<=43391,"Hangul Syllables":r=>r>=44032&&r<=55215,"Hangul Jamo Extended-B":r=>r>=55216&&r<=55295,"Private Use Area":r=>r>=57344&&r<=63743,"CJK Compatibility Ideographs":r=>r>=63744&&r<=64255,"Arabic Presentation Forms-A":r=>r>=64336&&r<=65023,"Vertical Forms":r=>r>=65040&&r<=65055,"CJK Compatibility Forms":r=>r>=65072&&r<=65103,"Small Form Variants":r=>r>=65104&&r<=65135,"Arabic Presentation Forms-B":r=>r>=65136&&r<=65279,"Halfwidth and Fullwidth Forms":r=>r>=65280&&r<=65519};function ou(r){for(const t of r)if(su(t.charCodeAt(0)))return!0;return!1}function _p(r){for(const t of r)if(!Qh(t.charCodeAt(0)))return!1;return!0}function Qh(r){return!(ct.Arabic(r)||ct["Arabic Supplement"](r)||ct["Arabic Extended-A"](r)||ct["Arabic Presentation Forms-A"](r)||ct["Arabic Presentation Forms-B"](r))}function su(r){return!(r!==746&&r!==747&&(r<4352||!(ct["Bopomofo Extended"](r)||ct.Bopomofo(r)||ct["CJK Compatibility Forms"](r)&&!(r>=65097&&r<=65103)||ct["CJK Compatibility Ideographs"](r)||ct["CJK Compatibility"](r)||ct["CJK Radicals Supplement"](r)||ct["CJK Strokes"](r)||!(!ct["CJK Symbols and Punctuation"](r)||r>=12296&&r<=12305||r>=12308&&r<=12319||r===12336)||ct["CJK Unified Ideographs Extension A"](r)||ct["CJK Unified Ideographs"](r)||ct["Enclosed CJK Letters and Months"](r)||ct["Hangul Compatibility Jamo"](r)||ct["Hangul Jamo Extended-A"](r)||ct["Hangul Jamo Extended-B"](r)||ct["Hangul Jamo"](r)||ct["Hangul Syllables"](r)||ct.Hiragana(r)||ct["Ideographic Description Characters"](r)||ct.Kanbun(r)||ct["Kangxi Radicals"](r)||ct["Katakana Phonetic Extensions"](r)||ct.Katakana(r)&&r!==12540||!(!ct["Halfwidth and Fullwidth Forms"](r)||r===65288||r===65289||r===65293||r>=65306&&r<=65310||r===65339||r===65341||r===65343||r>=65371&&r<=65503||r===65507||r>=65512&&r<=65519)||!(!ct["Small Form Variants"](r)||r>=65112&&r<=65118||r>=65123&&r<=65126)||ct["Unified Canadian Aboriginal Syllabics"](r)||ct["Unified Canadian Aboriginal Syllabics Extended"](r)||ct["Vertical Forms"](r)||ct["Yijing Hexagram Symbols"](r)||ct["Yi Syllables"](r)||ct["Yi Radicals"](r))))}function ed(r){return!(su(r)||function(t){return!!(ct["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||ct["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||ct["Letterlike Symbols"](t)||ct["Number Forms"](t)||ct["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||ct["Control Pictures"](t)&&t!==9251||ct["Optical Character Recognition"](t)||ct["Enclosed Alphanumerics"](t)||ct["Geometric Shapes"](t)||ct["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||ct["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||ct["CJK Symbols and Punctuation"](t)||ct.Katakana(t)||ct["Private Use Area"](t)||ct["CJK Compatibility Forms"](t)||ct["Small Form Variants"](t)||ct["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(r))}function wo(r){return r>=1424&&r<=2303||ct["Arabic Presentation Forms-A"](r)||ct["Arabic Presentation Forms-B"](r)}function td(r,t){return!(!t&&wo(r)||r>=2304&&r<=3583||r>=3840&&r<=4255||ct.Khmer(r))}function au(r){for(const t of r)if(wo(t.charCodeAt(0)))return!0;return!1}const Eo=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(r){this.pluginStatus=r.pluginStatus,this.pluginURL=r.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(r){this.applyArabicShaping=r.applyArabicShaping,this.processBidirectionalText=r.processBidirectionalText,this.processStyledBidirectionalText=r.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class wi{constructor(t,o){this.zoom=t,o?(this.now=o.now,this.fadeDuration=o.fadeDuration,this.zoomHistory=o.zoomHistory,this.transition=o.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Yh,this.transition={})}isSupportedScript(t){return function(o,l){for(const f of o)if(!td(f.charCodeAt(0),l))return!1;return!0}(t,Eo.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,o=t-Math.floor(t),l=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:o+(1-o)*l}:{fromScale:.5,toScale:1,t:1-(1-l)*o}}}class Pl{constructor(t,o){this.property=t,this.value=o,this.expression=function(l,f){if(Ss(l))return new Xo(l,f);if(El(l)){const y=Sa(l,f);if(y.result==="error")throw new Error(y.value.map(x=>`${x.key}: ${x.message}`).join(", "));return y.value}{let y=l;return f.type==="color"&&typeof l=="string"?y=di.parse(l):f.type!=="padding"||typeof l!="number"&&!Array.isArray(l)?f.type==="variableAnchorOffsetCollection"&&Array.isArray(l)&&(y=Yr.parse(l)):y=Jr.parse(l),{kind:"constant",evaluate:()=>y}}}(o===void 0?t.specification.default:o,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,o,l){return this.property.possiblyEvaluate(this,t,o,l)}}class ks{constructor(t){this.property=t,this.value=new Pl(t,void 0)}transitioned(t,o){return new id(this.property,this.value,o,Ae({},t.transition,this.transition),t.now)}untransitioned(){return new id(this.property,this.value,null,{},0)}}class Ms{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return ke(this._values[t].value.value)}setValue(t,o){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new ks(this._values[t].property)),this._values[t].value=new Pl(this._values[t].property,o===null?void 0:ke(o))}getTransition(t){return ke(this._values[t].transition)}setTransition(t,o){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new ks(this._values[t].property)),this._values[t].transition=ke(o)||void 0}serialize(){const t={};for(const o of Object.keys(this._values)){const l=this.getValue(o);l!==void 0&&(t[o]=l);const f=this.getTransition(o);f!==void 0&&(t[`${o}-transition`]=f)}return t}transitioned(t,o){const l=new lu(this._properties);for(const f of Object.keys(this._values))l._values[f]=this._values[f].transitioned(t,o._values[f]);return l}untransitioned(){const t=new lu(this._properties);for(const o of Object.keys(this._values))t._values[o]=this._values[o].untransitioned();return t}}class id{constructor(t,o,l,f,y){this.property=t,this.value=o,this.begin=y+f.delay||0,this.end=this.begin+f.duration||0,t.specification.transition&&(f.delay||f.duration)&&(this.prior=l)}possiblyEvaluate(t,o,l){const f=t.now||0,y=this.value.possiblyEvaluate(t,o,l),x=this.prior;if(x){if(f>this.end)return this.prior=null,y;if(this.value.isDataDriven())return this.prior=null,y;if(f<this.begin)return x.possiblyEvaluate(t,o,l);{const b=(f-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(t,o,l),y,function(E){if(E<=0)return 0;if(E>=1)return 1;const A=E*E,P=A*E;return 4*(E<.5?P:3*(E-A)+P-.75)}(b))}}return y}}class lu{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,o,l){const f=new zl(this._properties);for(const y of Object.keys(this._values))f._values[y]=this._values[y].possiblyEvaluate(t,o,l);return f}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class Ma{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}hasValue(t){return this._values[t].value!==void 0}getValue(t){return ke(this._values[t].value)}setValue(t,o){this._values[t]=new Pl(this._values[t].property,o===null?void 0:ke(o))}serialize(){const t={};for(const o of Object.keys(this._values)){const l=this.getValue(o);l!==void 0&&(t[o]=l)}return t}possiblyEvaluate(t,o,l){const f=new zl(this._properties);for(const y of Object.keys(this._values))f._values[y]=this._values[y].possiblyEvaluate(t,o,l);return f}}class Hn{constructor(t,o,l){this.property=t,this.value=o,this.parameters=l}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,o,l,f){return this.property.evaluate(this.value,this.parameters,t,o,l,f)}}class zl{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class wt{constructor(t){this.specification=t}possiblyEvaluate(t,o){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(o)}interpolate(t,o,l){const f=Vr[this.specification.type];return f?f(t,o,l):t}}class At{constructor(t,o){this.specification=t,this.overrides=o}possiblyEvaluate(t,o,l,f){return new Hn(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(o,null,{},l,f)}:t.expression,o)}interpolate(t,o,l){if(t.value.kind!=="constant"||o.value.kind!=="constant")return t;if(t.value.value===void 0||o.value.value===void 0)return new Hn(this,{kind:"constant",value:void 0},t.parameters);const f=Vr[this.specification.type];if(f){const y=f(t.value.value,o.value.value,l);return new Hn(this,{kind:"constant",value:y},t.parameters)}return t}evaluate(t,o,l,f,y,x){return t.kind==="constant"?t.value:t.evaluate(o,l,f,y,x)}}class _ extends At{possiblyEvaluate(t,o,l,f){if(t.value===void 0)return new Hn(this,{kind:"constant",value:void 0},o);if(t.expression.kind==="constant"){const y=t.expression.evaluate(o,null,{},l,f),x=t.property.specification.type==="resolvedImage"&&typeof y!="string"?y.name:y,b=this._calculate(x,x,x,o);return new Hn(this,{kind:"constant",value:b},o)}if(t.expression.kind==="camera"){const y=this._calculate(t.expression.evaluate({zoom:o.zoom-1}),t.expression.evaluate({zoom:o.zoom}),t.expression.evaluate({zoom:o.zoom+1}),o);return new Hn(this,{kind:"constant",value:y},o)}return new Hn(this,t.expression,o)}evaluate(t,o,l,f,y,x){if(t.kind==="source"){const b=t.evaluate(o,l,f,y,x);return this._calculate(b,b,b,o)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(o.zoom)-1},l,f),t.evaluate({zoom:Math.floor(o.zoom)},l,f),t.evaluate({zoom:Math.floor(o.zoom)+1},l,f),o):t.value}_calculate(t,o,l,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:t,to:o}:{from:l,to:o}}interpolate(t){return t}}class i{constructor(t){this.specification=t}possiblyEvaluate(t,o,l,f){if(t.value!==void 0){if(t.expression.kind==="constant"){const y=t.expression.evaluate(o,null,{},l,f);return this._calculate(y,y,y,o)}return this._calculate(t.expression.evaluate(new wi(Math.floor(o.zoom-1),o)),t.expression.evaluate(new wi(Math.floor(o.zoom),o)),t.expression.evaluate(new wi(Math.floor(o.zoom+1),o)),o)}}_calculate(t,o,l,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:t,to:o}:{from:l,to:o}}interpolate(t){return t}}class a{constructor(t){this.specification=t}possiblyEvaluate(t,o,l,f){return!!t.expression.evaluate(o,null,{},l,f)}interpolate(){return!1}}class d{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const o in t){const l=t[o];l.specification.overridable&&this.overridableProperties.push(o);const f=this.defaultPropertyValues[o]=new Pl(l,void 0),y=this.defaultTransitionablePropertyValues[o]=new ks(l);this.defaultTransitioningPropertyValues[o]=y.untransitioned(),this.defaultPossiblyEvaluatedValues[o]=f.possiblyEvaluate({})}}}mt("DataDrivenProperty",At),mt("DataConstantProperty",wt),mt("CrossFadedDataDrivenProperty",_),mt("CrossFadedProperty",i),mt("ColorRampProperty",a);const p="-transition";class v extends Be{constructor(t,o){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),o.layout&&(this._unevaluatedLayout=new Ma(o.layout)),o.paint)){this._transitionablePaint=new Ms(o.paint);for(const l in t.paint)this.setPaintProperty(l,t.paint[l],{validate:!1});for(const l in t.layout)this.setLayoutProperty(l,t.layout[l],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new zl(o.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,o,l={}){o!=null&&this._validate(Xh,`layers.${this.id}.layout.${t}`,t,o,l)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,o):this.visibility=o)}getPaintProperty(t){return t.endsWith(p)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,o,l={}){if(o!=null&&this._validate(Kh,`layers.${this.id}.paint.${t}`,t,o,l))return!1;if(t.endsWith(p))return this._transitionablePaint.setTransition(t.slice(0,-11),o||void 0),!1;{const f=this._transitionablePaint._values[t],y=f.property.specification["property-type"]==="cross-faded-data-driven",x=f.value.isDataDriven(),b=f.value;this._transitionablePaint.setValue(t,o),this._handleSpecialPaintPropertyUpdate(t);const E=this._transitionablePaint._values[t].value;return E.isDataDriven()||x||y||this._handleOverridablePaintPropertyUpdate(t,b,E)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,o,l){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,o){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,o)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,o)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),me(t,(o,l)=>!(o===void 0||l==="layout"&&!Object.keys(o).length||l==="paint"&&!Object.keys(o).length))}_validate(t,o,l,f,y={}){return(!y||y.validate!==!1)&&nu(this,t.call(Ca,{key:o,layerType:this.type,objectKey:l,value:f,styleSpec:le,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const o=this.paint.get(t);if(o instanceof Hn&&so(o.property.specification)&&(o.value.kind==="source"||o.value.kind==="composite")&&o.value.isStateDependent)return!0}return!1}}const w={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class S{constructor(t,o){this._structArray=t,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class T{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,o){return t._trim(),o&&(t.isTransferred=!0,o.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const o=Object.create(this.prototype);return o.arrayBuffer=t.arrayBuffer,o.length=t.length,o.capacity=t.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function z(r,t=1){let o=0,l=0;return{members:r.map(f=>{const y=w[f.type].BYTES_PER_ELEMENT,x=o=O(o,Math.max(t,y)),b=f.components||1;return l=Math.max(l,y),o+=y*b,{name:f.name,type:f.type,components:b,offset:x}}),size:O(o,Math.max(l,t)),alignment:t}}function O(r,t){return Math.ceil(r/t)*t}class R extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o){const l=this.length;return this.resize(l+1),this.emplace(l,t,o)}emplace(t,o,l){const f=2*t;return this.int16[f+0]=o,this.int16[f+1]=l,t}}R.prototype.bytesPerElement=4,mt("StructArrayLayout2i4",R);class $ extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,l){const f=this.length;return this.resize(f+1),this.emplace(f,t,o,l)}emplace(t,o,l,f){const y=3*t;return this.int16[y+0]=o,this.int16[y+1]=l,this.int16[y+2]=f,t}}$.prototype.bytesPerElement=6,mt("StructArrayLayout3i6",$);class G extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,l,f){const y=this.length;return this.resize(y+1),this.emplace(y,t,o,l,f)}emplace(t,o,l,f,y){const x=4*t;return this.int16[x+0]=o,this.int16[x+1]=l,this.int16[x+2]=f,this.int16[x+3]=y,t}}G.prototype.bytesPerElement=8,mt("StructArrayLayout4i8",G);class K extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,l,f,y,x){const b=this.length;return this.resize(b+1),this.emplace(b,t,o,l,f,y,x)}emplace(t,o,l,f,y,x,b){const E=6*t;return this.int16[E+0]=o,this.int16[E+1]=l,this.int16[E+2]=f,this.int16[E+3]=y,this.int16[E+4]=x,this.int16[E+5]=b,t}}K.prototype.bytesPerElement=12,mt("StructArrayLayout2i4i12",K);class re extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,l,f,y,x){const b=this.length;return this.resize(b+1),this.emplace(b,t,o,l,f,y,x)}emplace(t,o,l,f,y,x,b){const E=4*t,A=8*t;return this.int16[E+0]=o,this.int16[E+1]=l,this.uint8[A+4]=f,this.uint8[A+5]=y,this.uint8[A+6]=x,this.uint8[A+7]=b,t}}re.prototype.bytesPerElement=8,mt("StructArrayLayout2i4ub8",re);class J extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o){const l=this.length;return this.resize(l+1),this.emplace(l,t,o)}emplace(t,o,l){const f=2*t;return this.float32[f+0]=o,this.float32[f+1]=l,t}}J.prototype.bytesPerElement=8,mt("StructArrayLayout2f8",J);class ue extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,l,f,y,x,b,E,A,P){const D=this.length;return this.resize(D+1),this.emplace(D,t,o,l,f,y,x,b,E,A,P)}emplace(t,o,l,f,y,x,b,E,A,P,D){const B=10*t;return this.uint16[B+0]=o,this.uint16[B+1]=l,this.uint16[B+2]=f,this.uint16[B+3]=y,this.uint16[B+4]=x,this.uint16[B+5]=b,this.uint16[B+6]=E,this.uint16[B+7]=A,this.uint16[B+8]=P,this.uint16[B+9]=D,t}}ue.prototype.bytesPerElement=20,mt("StructArrayLayout10ui20",ue);class ge extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,l,f,y,x,b,E,A,P,D,B){const V=this.length;return this.resize(V+1),this.emplace(V,t,o,l,f,y,x,b,E,A,P,D,B)}emplace(t,o,l,f,y,x,b,E,A,P,D,B,V){const j=12*t;return this.int16[j+0]=o,this.int16[j+1]=l,this.int16[j+2]=f,this.int16[j+3]=y,this.uint16[j+4]=x,this.uint16[j+5]=b,this.uint16[j+6]=E,this.uint16[j+7]=A,this.int16[j+8]=P,this.int16[j+9]=D,this.int16[j+10]=B,this.int16[j+11]=V,t}}ge.prototype.bytesPerElement=24,mt("StructArrayLayout4i4ui4i24",ge);class te extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,l){const f=this.length;return this.resize(f+1),this.emplace(f,t,o,l)}emplace(t,o,l,f){const y=3*t;return this.float32[y+0]=o,this.float32[y+1]=l,this.float32[y+2]=f,t}}te.prototype.bytesPerElement=12,mt("StructArrayLayout3f12",te);class ve extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.uint32[1*t+0]=o,t}}ve.prototype.bytesPerElement=4,mt("StructArrayLayout1ul4",ve);class Se extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,l,f,y,x,b,E,A){const P=this.length;return this.resize(P+1),this.emplace(P,t,o,l,f,y,x,b,E,A)}emplace(t,o,l,f,y,x,b,E,A,P){const D=10*t,B=5*t;return this.int16[D+0]=o,this.int16[D+1]=l,this.int16[D+2]=f,this.int16[D+3]=y,this.int16[D+4]=x,this.int16[D+5]=b,this.uint32[B+3]=E,this.uint16[D+8]=A,this.uint16[D+9]=P,t}}Se.prototype.bytesPerElement=20,mt("StructArrayLayout6i1ul2ui20",Se);class Pe extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,l,f,y,x){const b=this.length;return this.resize(b+1),this.emplace(b,t,o,l,f,y,x)}emplace(t,o,l,f,y,x,b){const E=6*t;return this.int16[E+0]=o,this.int16[E+1]=l,this.int16[E+2]=f,this.int16[E+3]=y,this.int16[E+4]=x,this.int16[E+5]=b,t}}Pe.prototype.bytesPerElement=12,mt("StructArrayLayout2i2i2i12",Pe);class Ne extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,l,f,y){const x=this.length;return this.resize(x+1),this.emplace(x,t,o,l,f,y)}emplace(t,o,l,f,y,x){const b=4*t,E=8*t;return this.float32[b+0]=o,this.float32[b+1]=l,this.float32[b+2]=f,this.int16[E+6]=y,this.int16[E+7]=x,t}}Ne.prototype.bytesPerElement=16,mt("StructArrayLayout2f1f2i16",Ne);class Xe extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,l,f,y,x){const b=this.length;return this.resize(b+1),this.emplace(b,t,o,l,f,y,x)}emplace(t,o,l,f,y,x,b){const E=16*t,A=4*t,P=8*t;return this.uint8[E+0]=o,this.uint8[E+1]=l,this.float32[A+1]=f,this.float32[A+2]=y,this.int16[P+6]=x,this.int16[P+7]=b,t}}Xe.prototype.bytesPerElement=16,mt("StructArrayLayout2ub2f2i16",Xe);class ut extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,l){const f=this.length;return this.resize(f+1),this.emplace(f,t,o,l)}emplace(t,o,l,f){const y=3*t;return this.uint16[y+0]=o,this.uint16[y+1]=l,this.uint16[y+2]=f,t}}ut.prototype.bytesPerElement=6,mt("StructArrayLayout3ui6",ut);class ht extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,l,f,y,x,b,E,A,P,D,B,V,j,Z,Y,se){const Ee=this.length;return this.resize(Ee+1),this.emplace(Ee,t,o,l,f,y,x,b,E,A,P,D,B,V,j,Z,Y,se)}emplace(t,o,l,f,y,x,b,E,A,P,D,B,V,j,Z,Y,se,Ee){const fe=24*t,xe=12*t,ze=48*t;return this.int16[fe+0]=o,this.int16[fe+1]=l,this.uint16[fe+2]=f,this.uint16[fe+3]=y,this.uint32[xe+2]=x,this.uint32[xe+3]=b,this.uint32[xe+4]=E,this.uint16[fe+10]=A,this.uint16[fe+11]=P,this.uint16[fe+12]=D,this.float32[xe+7]=B,this.float32[xe+8]=V,this.uint8[ze+36]=j,this.uint8[ze+37]=Z,this.uint8[ze+38]=Y,this.uint32[xe+10]=se,this.int16[fe+22]=Ee,t}}ht.prototype.bytesPerElement=48,mt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",ht);class Je extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,l,f,y,x,b,E,A,P,D,B,V,j,Z,Y,se,Ee,fe,xe,ze,qe,st,Ct,lt,ot,bt,gt){const ft=this.length;return this.resize(ft+1),this.emplace(ft,t,o,l,f,y,x,b,E,A,P,D,B,V,j,Z,Y,se,Ee,fe,xe,ze,qe,st,Ct,lt,ot,bt,gt)}emplace(t,o,l,f,y,x,b,E,A,P,D,B,V,j,Z,Y,se,Ee,fe,xe,ze,qe,st,Ct,lt,ot,bt,gt,ft){const Fe=32*t,Et=16*t;return this.int16[Fe+0]=o,this.int16[Fe+1]=l,this.int16[Fe+2]=f,this.int16[Fe+3]=y,this.int16[Fe+4]=x,this.int16[Fe+5]=b,this.int16[Fe+6]=E,this.int16[Fe+7]=A,this.uint16[Fe+8]=P,this.uint16[Fe+9]=D,this.uint16[Fe+10]=B,this.uint16[Fe+11]=V,this.uint16[Fe+12]=j,this.uint16[Fe+13]=Z,this.uint16[Fe+14]=Y,this.uint16[Fe+15]=se,this.uint16[Fe+16]=Ee,this.uint16[Fe+17]=fe,this.uint16[Fe+18]=xe,this.uint16[Fe+19]=ze,this.uint16[Fe+20]=qe,this.uint16[Fe+21]=st,this.uint16[Fe+22]=Ct,this.uint32[Et+12]=lt,this.float32[Et+13]=ot,this.float32[Et+14]=bt,this.uint16[Fe+30]=gt,this.uint16[Fe+31]=ft,t}}Je.prototype.bytesPerElement=64,mt("StructArrayLayout8i15ui1ul2f2ui64",Je);class et extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.float32[1*t+0]=o,t}}et.prototype.bytesPerElement=4,mt("StructArrayLayout1f4",et);class yt extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,l){const f=this.length;return this.resize(f+1),this.emplace(f,t,o,l)}emplace(t,o,l,f){const y=3*t;return this.uint16[6*t+0]=o,this.float32[y+1]=l,this.float32[y+2]=f,t}}yt.prototype.bytesPerElement=12,mt("StructArrayLayout1ui2f12",yt);class Ot extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,l){const f=this.length;return this.resize(f+1),this.emplace(f,t,o,l)}emplace(t,o,l,f){const y=4*t;return this.uint32[2*t+0]=o,this.uint16[y+2]=l,this.uint16[y+3]=f,t}}Ot.prototype.bytesPerElement=8,mt("StructArrayLayout1ul2ui8",Ot);class it extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o){const l=this.length;return this.resize(l+1),this.emplace(l,t,o)}emplace(t,o,l){const f=2*t;return this.uint16[f+0]=o,this.uint16[f+1]=l,t}}it.prototype.bytesPerElement=4,mt("StructArrayLayout2ui4",it);class at extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.uint16[1*t+0]=o,t}}at.prototype.bytesPerElement=2,mt("StructArrayLayout1ui2",at);class Pt extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,l,f){const y=this.length;return this.resize(y+1),this.emplace(y,t,o,l,f)}emplace(t,o,l,f,y){const x=4*t;return this.float32[x+0]=o,this.float32[x+1]=l,this.float32[x+2]=f,this.float32[x+3]=y,t}}Pt.prototype.bytesPerElement=16,mt("StructArrayLayout4f16",Pt);class Ci extends S{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new C(this.anchorPointX,this.anchorPointY)}}Ci.prototype.size=20;class Wt extends Se{get(t){return new Ci(this,t)}}mt("CollisionBoxArray",Wt);class Yt extends S{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Yt.prototype.size=48;class Ai extends ht{get(t){return new Yt(this,t)}}mt("PlacedSymbolArray",Ai);class Ar extends S{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Ar.prototype.size=64;class In extends Je{get(t){return new Ar(this,t)}}mt("SymbolInstanceArray",In);class ki extends et{getoffsetX(t){return this.float32[1*t+0]}}mt("GlyphOffsetArray",ki);class en extends ${getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}mt("SymbolLineVertexArray",en);class Nr extends S{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Nr.prototype.size=12;class kr extends yt{get(t){return new Nr(this,t)}}mt("TextAnchorOffsetArray",kr);class Mr extends S{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Mr.prototype.size=8;class Tn extends Ot{get(t){return new Mr(this,t)}}mt("FeatureIndexArray",Tn);class Qo extends R{}class Dl extends R{}class Ls extends R{}class es extends K{}class Rl extends re{}class cu extends J{}class Er extends ue{}class Cn extends ge{}class So extends te{}class Ps extends ve{}class Lr extends Pe{}class Pr extends Xe{}class yr extends ut{}class Ni extends it{}const zs=z([{name:"a_pos",components:2,type:"Int16"}],4),{members:uu}=zs;class hr{constructor(t=[]){this.segments=t}prepareSegment(t,o,l,f){let y=this.segments[this.segments.length-1];return t>hr.MAX_VERTEX_ARRAY_LENGTH&&Oe(`Max vertices per segment is ${hr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!y||y.vertexLength+t>hr.MAX_VERTEX_ARRAY_LENGTH||y.sortKey!==f)&&(y={vertexOffset:o.length,primitiveOffset:l.length,vertexLength:0,primitiveLength:0},f!==void 0&&(y.sortKey=f),this.segments.push(y)),y}get(){return this.segments}destroy(){for(const t of this.segments)for(const o in t.vaos)t.vaos[o].destroy()}static simpleSegment(t,o,l,f){return new hr([{vertexOffset:t,primitiveOffset:o,vertexLength:l,primitiveLength:f,vaos:{},sortKey:0}])}}function rd(r,t){return 256*(r=ne(Math.floor(r),0,255))+ne(Math.floor(t),0,255)}hr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,mt("SegmentVector",hr);const Ol=z([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Bl={exports:{}},Io={exports:{}};Io.exports=function(r,t){var o,l,f,y,x,b,E,A;for(l=r.length-(o=3&r.length),f=t,x=3432918353,b=461845907,A=0;A<l;)E=255&r.charCodeAt(A)|(255&r.charCodeAt(++A))<<8|(255&r.charCodeAt(++A))<<16|(255&r.charCodeAt(++A))<<24,++A,f=27492+(65535&(y=5*(65535&(f=(f^=E=(65535&(E=(E=(65535&E)*x+(((E>>>16)*x&65535)<<16)&4294967295)<<15|E>>>17))*b+(((E>>>16)*b&65535)<<16)&4294967295)<<13|f>>>19))+((5*(f>>>16)&65535)<<16)&4294967295))+((58964+(y>>>16)&65535)<<16);switch(E=0,o){case 3:E^=(255&r.charCodeAt(A+2))<<16;case 2:E^=(255&r.charCodeAt(A+1))<<8;case 1:f^=E=(65535&(E=(E=(65535&(E^=255&r.charCodeAt(A)))*x+(((E>>>16)*x&65535)<<16)&4294967295)<<15|E>>>17))*b+(((E>>>16)*b&65535)<<16)&4294967295}return f^=r.length,f=2246822507*(65535&(f^=f>>>16))+((2246822507*(f>>>16)&65535)<<16)&4294967295,f=3266489909*(65535&(f^=f>>>13))+((3266489909*(f>>>16)&65535)<<16)&4294967295,(f^=f>>>16)>>>0};var nd=Io.exports,hu={exports:{}};hu.exports=function(r,t){for(var o,l=r.length,f=t^l,y=0;l>=4;)o=1540483477*(65535&(o=255&r.charCodeAt(y)|(255&r.charCodeAt(++y))<<8|(255&r.charCodeAt(++y))<<16|(255&r.charCodeAt(++y))<<24))+((1540483477*(o>>>16)&65535)<<16),f=1540483477*(65535&f)+((1540483477*(f>>>16)&65535)<<16)^(o=1540483477*(65535&(o^=o>>>24))+((1540483477*(o>>>16)&65535)<<16)),l-=4,++y;switch(l){case 3:f^=(255&r.charCodeAt(y+2))<<16;case 2:f^=(255&r.charCodeAt(y+1))<<8;case 1:f=1540483477*(65535&(f^=255&r.charCodeAt(y)))+((1540483477*(f>>>16)&65535)<<16)}return f=1540483477*(65535&(f^=f>>>13))+((1540483477*(f>>>16)&65535)<<16),(f^=f>>>15)>>>0};var du=nd,fu=hu.exports;Bl.exports=du,Bl.exports.murmur3=du,Bl.exports.murmur2=fu;var Fl=I(Bl.exports);class Ds{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,o,l,f){this.ids.push(Py(t)),this.positions.push(o,l,f)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const o=Py(t);let l=0,f=this.ids.length-1;for(;l<f;){const x=l+f>>1;this.ids[x]>=o?f=x:l=x+1}const y=[];for(;this.ids[l]===o;)y.push({index:this.positions[3*l],start:this.positions[3*l+1],end:this.positions[3*l+2]}),l++;return y}static serialize(t,o){const l=new Float64Array(t.ids),f=new Uint32Array(t.positions);return vp(l,f,0,l.length-1),o&&o.push(l.buffer,f.buffer),{ids:l,positions:f}}static deserialize(t){const o=new Ds;return o.ids=t.ids,o.positions=t.positions,o.indexed=!0,o}}function Py(r){const t=+r;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:Fl(String(r))}function vp(r,t,o,l){for(;o<l;){const f=r[o+l>>1];let y=o-1,x=l+1;for(;;){do y++;while(r[y]<f);do x--;while(r[x]>f);if(y>=x)break;od(r,y,x),od(t,3*y,3*x),od(t,3*y+1,3*x+1),od(t,3*y+2,3*x+2)}x-o<l-x?(vp(r,t,o,x),o=x+1):(vp(r,t,x+1,l),l=x)}}function od(r,t,o){const l=r[t];r[t]=r[o],r[o]=l}mt("FeaturePositionMap",Ds);class La{constructor(t,o){this.gl=t.gl,this.location=o}}class sd extends La{constructor(t,o){super(t,o),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class zy extends La{constructor(t,o){super(t,o),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class Dy extends La{constructor(t,o){super(t,o),this.current=di.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const Hw=new Float32Array(16);function xp(r){return[rd(255*r.r,255*r.g),rd(255*r.b,255*r.a)]}class pu{constructor(t,o,l){this.value=t,this.uniformNames=o.map(f=>`u_${f}`),this.type=l}setUniform(t,o,l){t.set(l.constantOr(this.value))}getBinding(t,o,l){return this.type==="color"?new Dy(t,o):new sd(t,o)}}class Vl{constructor(t,o){this.uniformNames=o.map(l=>`u_${l}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,o){this.pixelRatioFrom=o.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=o.tlbr,this.patternTo=t.tlbr}setUniform(t,o,l,f){const y=f==="u_pattern_to"?this.patternTo:f==="u_pattern_from"?this.patternFrom:f==="u_pixel_ratio_to"?this.pixelRatioTo:f==="u_pixel_ratio_from"?this.pixelRatioFrom:null;y&&t.set(y)}getBinding(t,o,l){return l.substr(0,9)==="u_pattern"?new zy(t,o):new sd(t,o)}}class ts{constructor(t,o,l,f){this.expression=t,this.type=l,this.maxValue=0,this.paintVertexAttributes=o.map(y=>({name:`a_${y}`,type:"Float32",components:l==="color"?2:1,offset:0})),this.paintVertexArray=new f}populatePaintArray(t,o,l,f,y){const x=this.paintVertexArray.length,b=this.expression.evaluate(new wi(0),o,{},f,[],y);this.paintVertexArray.resize(t),this._setPaintValue(x,t,b)}updatePaintArray(t,o,l,f){const y=this.expression.evaluate({zoom:0},l,f);this._setPaintValue(t,o,y)}_setPaintValue(t,o,l){if(this.type==="color"){const f=xp(l);for(let y=t;y<o;y++)this.paintVertexArray.emplace(y,f[0],f[1])}else{for(let f=t;f<o;f++)this.paintVertexArray.emplace(f,l);this.maxValue=Math.max(this.maxValue,Math.abs(l))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class co{constructor(t,o,l,f,y,x){this.expression=t,this.uniformNames=o.map(b=>`u_${b}_t`),this.type=l,this.useIntegerZoom=f,this.zoom=y,this.maxValue=0,this.paintVertexAttributes=o.map(b=>({name:`a_${b}`,type:"Float32",components:l==="color"?4:2,offset:0})),this.paintVertexArray=new x}populatePaintArray(t,o,l,f,y){const x=this.expression.evaluate(new wi(this.zoom),o,{},f,[],y),b=this.expression.evaluate(new wi(this.zoom+1),o,{},f,[],y),E=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(E,t,x,b)}updatePaintArray(t,o,l,f){const y=this.expression.evaluate({zoom:this.zoom},l,f),x=this.expression.evaluate({zoom:this.zoom+1},l,f);this._setPaintValue(t,o,y,x)}_setPaintValue(t,o,l,f){if(this.type==="color"){const y=xp(l),x=xp(f);for(let b=t;b<o;b++)this.paintVertexArray.emplace(b,y[0],y[1],x[0],x[1])}else{for(let y=t;y<o;y++)this.paintVertexArray.emplace(y,l,f);this.maxValue=Math.max(this.maxValue,Math.abs(l),Math.abs(f))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,o){const l=this.useIntegerZoom?Math.floor(o.zoom):o.zoom,f=ne(this.expression.interpolationFactor(l,this.zoom,this.zoom+1),0,1);t.set(f)}getBinding(t,o,l){return new sd(t,o)}}class Rs{constructor(t,o,l,f,y,x){this.expression=t,this.type=o,this.useIntegerZoom=l,this.zoom=f,this.layerId=x,this.zoomInPaintVertexArray=new y,this.zoomOutPaintVertexArray=new y}populatePaintArray(t,o,l){const f=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(f,t,o.patterns&&o.patterns[this.layerId],l)}updatePaintArray(t,o,l,f,y){this._setPaintValues(t,o,l.patterns&&l.patterns[this.layerId],y)}_setPaintValues(t,o,l,f){if(!f||!l)return;const{min:y,mid:x,max:b}=l,E=f[y],A=f[x],P=f[b];if(E&&A&&P)for(let D=t;D<o;D++)this.zoomInPaintVertexArray.emplace(D,A.tl[0],A.tl[1],A.br[0],A.br[1],E.tl[0],E.tl[1],E.br[0],E.br[1],A.pixelRatio,E.pixelRatio),this.zoomOutPaintVertexArray.emplace(D,A.tl[0],A.tl[1],A.br[0],A.br[1],P.tl[0],P.tl[1],P.br[0],P.br[1],A.pixelRatio,P.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,Ol.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,Ol.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Ry{constructor(t,o,l){this.binders={},this._buffers=[];const f=[];for(const y in t.paint._values){if(!l(y))continue;const x=t.paint.get(y);if(!(x instanceof Hn&&so(x.property.specification)))continue;const b=Gw(y,t.type),E=x.value,A=x.property.specification.type,P=x.property.useIntegerZoom,D=x.property.specification["property-type"],B=D==="cross-faded"||D==="cross-faded-data-driven";if(E.kind==="constant")this.binders[y]=B?new Vl(E.value,b):new pu(E.value,b,A),f.push(`/u_${y}`);else if(E.kind==="source"||B){const V=Oy(y,A,"source");this.binders[y]=B?new Rs(E,A,P,o,V,t.id):new ts(E,b,A,V),f.push(`/a_${y}`)}else{const V=Oy(y,A,"composite");this.binders[y]=new co(E,b,A,P,o,V),f.push(`/z_${y}`)}}this.cacheKey=f.sort().join("")}getMaxValue(t){const o=this.binders[t];return o instanceof ts||o instanceof co?o.maxValue:0}populatePaintArrays(t,o,l,f,y){for(const x in this.binders){const b=this.binders[x];(b instanceof ts||b instanceof co||b instanceof Rs)&&b.populatePaintArray(t,o,l,f,y)}}setConstantPatternPositions(t,o){for(const l in this.binders){const f=this.binders[l];f instanceof Vl&&f.setConstantPatternPositions(t,o)}}updatePaintArrays(t,o,l,f,y){let x=!1;for(const b in t){const E=o.getPositions(b);for(const A of E){const P=l.feature(A.index);for(const D in this.binders){const B=this.binders[D];if((B instanceof ts||B instanceof co||B instanceof Rs)&&B.expression.isStateDependent===!0){const V=f.paint.get(D);B.expression=V.value,B.updatePaintArray(A.start,A.end,P,t[b],y),x=!0}}}}return x}defines(){const t=[];for(const o in this.binders){const l=this.binders[o];(l instanceof pu||l instanceof Vl)&&t.push(...l.uniformNames.map(f=>`#define HAS_UNIFORM_${f}`))}return t}getBinderAttributes(){const t=[];for(const o in this.binders){const l=this.binders[o];if(l instanceof ts||l instanceof co)for(let f=0;f<l.paintVertexAttributes.length;f++)t.push(l.paintVertexAttributes[f].name);else if(l instanceof Rs)for(let f=0;f<Ol.members.length;f++)t.push(Ol.members[f].name)}return t}getBinderUniforms(){const t=[];for(const o in this.binders){const l=this.binders[o];if(l instanceof pu||l instanceof Vl||l instanceof co)for(const f of l.uniformNames)t.push(f)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,o){const l=[];for(const f in this.binders){const y=this.binders[f];if(y instanceof pu||y instanceof Vl||y instanceof co){for(const x of y.uniformNames)if(o[x]){const b=y.getBinding(t,o[x],x);l.push({name:x,property:f,binding:b})}}}return l}setUniforms(t,o,l,f){for(const{name:y,property:x,binding:b}of o)this.binders[x].setUniform(b,f,l.get(x),y)}updatePaintBuffers(t){this._buffers=[];for(const o in this.binders){const l=this.binders[o];if(t&&l instanceof Rs){const f=t.fromScale===2?l.zoomInPaintVertexBuffer:l.zoomOutPaintVertexBuffer;f&&this._buffers.push(f)}else(l instanceof ts||l instanceof co)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer)}}upload(t){for(const o in this.binders){const l=this.binders[o];(l instanceof ts||l instanceof co||l instanceof Rs)&&l.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const o=this.binders[t];(o instanceof ts||o instanceof co||o instanceof Rs)&&o.destroy()}}}class Pa{constructor(t,o,l=()=>!0){this.programConfigurations={};for(const f of t)this.programConfigurations[f.id]=new Ry(f,o,l);this.needsUpload=!1,this._featureMap=new Ds,this._bufferOffset=0}populatePaintArrays(t,o,l,f,y,x){for(const b in this.programConfigurations)this.programConfigurations[b].populatePaintArrays(t,o,f,y,x);o.id!==void 0&&this._featureMap.add(o.id,l,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,o,l,f){for(const y of l)this.needsUpload=this.programConfigurations[y.id].updatePaintArrays(t,this._featureMap,o,y,f)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const o in this.programConfigurations)this.programConfigurations[o].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function Gw(r,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[r]||[r.replace(`${t}-`,"").replace(/-/g,"_")]}function Oy(r,t,o){const l={color:{source:J,composite:Pt},number:{source:et,composite:J}},f=function(y){return{"line-pattern":{source:Er,composite:Er},"fill-pattern":{source:Er,composite:Er},"fill-extrusion-pattern":{source:Er,composite:Er}}[y]}(r);return f&&f[o]||l[t][o]}mt("ConstantBinder",pu),mt("CrossFadedConstantBinder",Vl),mt("SourceExpressionBinder",ts),mt("CrossFadedCompositeBinder",Rs),mt("CompositeExpressionBinder",co),mt("ProgramConfiguration",Ry,{omit:["_buffers"]}),mt("ProgramConfigurationSet",Pa);const or=8192,bp=Math.pow(2,14)-1,By=-bp-1;function za(r){const t=or/r.extent,o=r.loadGeometry();for(let l=0;l<o.length;l++){const f=o[l];for(let y=0;y<f.length;y++){const x=f[y],b=Math.round(x.x*t),E=Math.round(x.y*t);x.x=ne(b,By,bp),x.y=ne(E,By,bp),(b<x.x||b>x.x+1||E<x.y||E>x.y+1)&&Oe("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return o}function Da(r,t){return{type:r.type,id:r.id,properties:r.properties,geometry:t?za(r):[]}}function ad(r,t,o,l,f){r.emplaceBack(2*t+(l+1)/2,2*o+(f+1)/2)}class wp{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Dl,this.indexArray=new yr,this.segments=new hr,this.programConfigurations=new Pa(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(t,o,l){const f=this.layers[0],y=[];let x=null,b=!1;f.type==="circle"&&(x=f.layout.get("circle-sort-key"),b=!x.isConstant());for(const{feature:E,id:A,index:P,sourceLayerIndex:D}of t){const B=this.layers[0]._featureFilter.needGeometry,V=Da(E,B);if(!this.layers[0]._featureFilter.filter(new wi(this.zoom),V,l))continue;const j=b?x.evaluate(V,{},l):void 0,Z={id:A,properties:E.properties,type:E.type,sourceLayerIndex:D,index:P,geometry:B?V.geometry:za(E),patterns:{},sortKey:j};y.push(Z)}b&&y.sort((E,A)=>E.sortKey-A.sortKey);for(const E of y){const{geometry:A,index:P,sourceLayerIndex:D}=E,B=t[P].feature;this.addFeature(E,A,P,l),o.featureIndex.insert(B,A,P,D,this.index)}}update(t,o,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,o,this.stateDependentLayers,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,uu),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,o,l,f){for(const y of o)for(const x of y){const b=x.x,E=x.y;if(b<0||b>=or||E<0||E>=or)continue;const A=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),P=A.vertexLength;ad(this.layoutVertexArray,b,E,-1,-1),ad(this.layoutVertexArray,b,E,1,-1),ad(this.layoutVertexArray,b,E,1,1),ad(this.layoutVertexArray,b,E,-1,1),this.indexArray.emplaceBack(P,P+1,P+2),this.indexArray.emplaceBack(P,P+3,P+2),A.vertexLength+=4,A.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,{},f)}}function Fy(r,t){for(let o=0;o<r.length;o++)if(Nl(t,r[o]))return!0;for(let o=0;o<t.length;o++)if(Nl(r,t[o]))return!0;return!!Ep(r,t)}function Zw(r,t,o){return!!Nl(r,t)||!!Sp(t,r,o)}function Vy(r,t){if(r.length===1)return $y(t,r[0]);for(let o=0;o<t.length;o++){const l=t[o];for(let f=0;f<l.length;f++)if(Nl(r,l[f]))return!0}for(let o=0;o<r.length;o++)if($y(t,r[o]))return!0;for(let o=0;o<t.length;o++)if(Ep(r,t[o]))return!0;return!1}function Ww(r,t,o){if(r.length>1){if(Ep(r,t))return!0;for(let l=0;l<t.length;l++)if(Sp(t[l],r,o))return!0}for(let l=0;l<r.length;l++)if(Sp(r[l],t,o))return!0;return!1}function Ep(r,t){if(r.length===0||t.length===0)return!1;for(let o=0;o<r.length-1;o++){const l=r[o],f=r[o+1];for(let y=0;y<t.length-1;y++)if(Kw(l,f,t[y],t[y+1]))return!0}return!1}function Kw(r,t,o,l){return Ge(r,o,l)!==Ge(t,o,l)&&Ge(r,t,o)!==Ge(r,t,l)}function Sp(r,t,o){const l=o*o;if(t.length===1)return r.distSqr(t[0])<l;for(let f=1;f<t.length;f++)if(Ny(r,t[f-1],t[f])<l)return!0;return!1}function Ny(r,t,o){const l=t.distSqr(o);if(l===0)return r.distSqr(t);const f=((r.x-t.x)*(o.x-t.x)+(r.y-t.y)*(o.y-t.y))/l;return r.distSqr(f<0?t:f>1?o:o.sub(t)._mult(f)._add(t))}function $y(r,t){let o,l,f,y=!1;for(let x=0;x<r.length;x++){o=r[x];for(let b=0,E=o.length-1;b<o.length;E=b++)l=o[b],f=o[E],l.y>t.y!=f.y>t.y&&t.x<(f.x-l.x)*(t.y-l.y)/(f.y-l.y)+l.x&&(y=!y)}return y}function Nl(r,t){let o=!1;for(let l=0,f=r.length-1;l<r.length;f=l++){const y=r[l],x=r[f];y.y>t.y!=x.y>t.y&&t.x<(x.x-y.x)*(t.y-y.y)/(x.y-y.y)+y.x&&(o=!o)}return o}function Xw(r,t,o){const l=o[0],f=o[2];if(r.x<l.x&&t.x<l.x||r.x>f.x&&t.x>f.x||r.y<l.y&&t.y<l.y||r.y>f.y&&t.y>f.y)return!1;const y=Ge(r,t,o[0]);return y!==Ge(r,t,o[1])||y!==Ge(r,t,o[2])||y!==Ge(r,t,o[3])}function mu(r,t,o){const l=t.paint.get(r).value;return l.kind==="constant"?l.value:o.programConfigurations.get(t.id).getMaxValue(r)}function ld(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function cd(r,t,o,l,f){if(!t[0]&&!t[1])return r;const y=C.convert(t)._mult(f);o==="viewport"&&y._rotate(-l);const x=[];for(let b=0;b<r.length;b++)x.push(r[b].sub(y));return x}let jy,Uy;mt("CircleBucket",wp,{omit:["layers"]});var Jw={get paint(){return Uy=Uy||new d({"circle-radius":new At(le.paint_circle["circle-radius"]),"circle-color":new At(le.paint_circle["circle-color"]),"circle-blur":new At(le.paint_circle["circle-blur"]),"circle-opacity":new At(le.paint_circle["circle-opacity"]),"circle-translate":new wt(le.paint_circle["circle-translate"]),"circle-translate-anchor":new wt(le.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new wt(le.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new wt(le.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new At(le.paint_circle["circle-stroke-width"]),"circle-stroke-color":new At(le.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new At(le.paint_circle["circle-stroke-opacity"])})},get layout(){return jy=jy||new d({"circle-sort-key":new At(le.layout_circle["circle-sort-key"])})}},tn=1e-6,$l=typeof Float32Array<"u"?Float32Array:Array;function Ip(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function qy(r,t,o){var l=t[0],f=t[1],y=t[2],x=t[3],b=t[4],E=t[5],A=t[6],P=t[7],D=t[8],B=t[9],V=t[10],j=t[11],Z=t[12],Y=t[13],se=t[14],Ee=t[15],fe=o[0],xe=o[1],ze=o[2],qe=o[3];return r[0]=fe*l+xe*b+ze*D+qe*Z,r[1]=fe*f+xe*E+ze*B+qe*Y,r[2]=fe*y+xe*A+ze*V+qe*se,r[3]=fe*x+xe*P+ze*j+qe*Ee,r[4]=(fe=o[4])*l+(xe=o[5])*b+(ze=o[6])*D+(qe=o[7])*Z,r[5]=fe*f+xe*E+ze*B+qe*Y,r[6]=fe*y+xe*A+ze*V+qe*se,r[7]=fe*x+xe*P+ze*j+qe*Ee,r[8]=(fe=o[8])*l+(xe=o[9])*b+(ze=o[10])*D+(qe=o[11])*Z,r[9]=fe*f+xe*E+ze*B+qe*Y,r[10]=fe*y+xe*A+ze*V+qe*se,r[11]=fe*x+xe*P+ze*j+qe*Ee,r[12]=(fe=o[12])*l+(xe=o[13])*b+(ze=o[14])*D+(qe=o[15])*Z,r[13]=fe*f+xe*E+ze*B+qe*Y,r[14]=fe*y+xe*A+ze*V+qe*se,r[15]=fe*x+xe*P+ze*j+qe*Ee,r}Math.hypot||(Math.hypot=function(){for(var r=0,t=arguments.length;t--;)r+=arguments[t]*arguments[t];return Math.sqrt(r)});var gu,Yw=qy;function ud(r,t,o){var l=t[0],f=t[1],y=t[2],x=t[3];return r[0]=o[0]*l+o[4]*f+o[8]*y+o[12]*x,r[1]=o[1]*l+o[5]*f+o[9]*y+o[13]*x,r[2]=o[2]*l+o[6]*f+o[10]*y+o[14]*x,r[3]=o[3]*l+o[7]*f+o[11]*y+o[15]*x,r}gu=new $l(4),$l!=Float32Array&&(gu[0]=0,gu[1]=0,gu[2]=0,gu[3]=0);class Qw extends v{constructor(t){super(t,Jw)}createBucket(t){return new wp(t)}queryRadius(t){const o=t;return mu("circle-radius",this,o)+mu("circle-stroke-width",this,o)+ld(this.paint.get("circle-translate"))}queryIntersectsFeature(t,o,l,f,y,x,b,E){const A=cd(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),x.angle,b),P=this.paint.get("circle-radius").evaluate(o,l)+this.paint.get("circle-stroke-width").evaluate(o,l),D=this.paint.get("circle-pitch-alignment")==="map",B=D?A:function(j,Z){return j.map(Y=>Hy(Y,Z))}(A,E),V=D?P*b:P;for(const j of f)for(const Z of j){const Y=D?Z:Hy(Z,E);let se=V;const Ee=ud([],[Z.x,Z.y,0,1],E);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?se*=Ee[3]/x.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(se*=x.cameraToCenterDistance/Ee[3]),Zw(B,Y,se))return!0}return!1}}function Hy(r,t){const o=ud([],[r.x,r.y,0,1],t);return new C(o[0]/o[3],o[1]/o[3])}class Gy extends wp{}let Zy;mt("HeatmapBucket",Gy,{omit:["layers"]});var e2={get paint(){return Zy=Zy||new d({"heatmap-radius":new At(le.paint_heatmap["heatmap-radius"]),"heatmap-weight":new At(le.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new wt(le.paint_heatmap["heatmap-intensity"]),"heatmap-color":new a(le.paint_heatmap["heatmap-color"]),"heatmap-opacity":new wt(le.paint_heatmap["heatmap-opacity"])})}};function Tp(r,{width:t,height:o},l,f){if(f){if(f instanceof Uint8ClampedArray)f=new Uint8Array(f.buffer);else if(f.length!==t*o*l)throw new RangeError(`mismatched image size. expected: ${f.length} but got: ${t*o*l}`)}else f=new Uint8Array(t*o*l);return r.width=t,r.height=o,r.data=f,r}function Wy(r,{width:t,height:o},l){if(t===r.width&&o===r.height)return;const f=Tp({},{width:t,height:o},l);Cp(r,f,{x:0,y:0},{x:0,y:0},{width:Math.min(r.width,t),height:Math.min(r.height,o)},l),r.width=t,r.height=o,r.data=f.data}function Cp(r,t,o,l,f,y){if(f.width===0||f.height===0)return t;if(f.width>r.width||f.height>r.height||o.x>r.width-f.width||o.y>r.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>t.width||f.height>t.height||l.x>t.width-f.width||l.y>t.height-f.height)throw new RangeError("out of range destination coordinates for image copy");const x=r.data,b=t.data;if(x===b)throw new Error("srcData equals dstData, so image is already copied");for(let E=0;E<f.height;E++){const A=((o.y+E)*r.width+o.x)*y,P=((l.y+E)*t.width+l.x)*y;for(let D=0;D<f.width*y;D++)b[P+D]=x[A+D]}return t}class yu{constructor(t,o){Tp(this,t,1,o)}resize(t){Wy(this,t,1)}clone(){return new yu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,o,l,f,y){Cp(t,o,l,f,y,1)}}class An{constructor(t,o){Tp(this,t,4,o)}resize(t){Wy(this,t,4)}replace(t,o){o?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new An({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,o,l,f,y){Cp(t,o,l,f,y,4)}}function Ky(r){const t={},o=r.resolution||256,l=r.clips?r.clips.length:1,f=r.image||new An({width:o,height:l});if(Math.log(o)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${o}`);const y=(x,b,E)=>{t[r.evaluationKey]=E;const A=r.expression.evaluate(t);f.data[x+b+0]=Math.floor(255*A.r/A.a),f.data[x+b+1]=Math.floor(255*A.g/A.a),f.data[x+b+2]=Math.floor(255*A.b/A.a),f.data[x+b+3]=Math.floor(255*A.a)};if(r.clips)for(let x=0,b=0;x<l;++x,b+=4*o)for(let E=0,A=0;E<o;E++,A+=4){const P=E/(o-1),{start:D,end:B}=r.clips[x];y(b,A,D*(1-P)+B*P)}else for(let x=0,b=0;x<o;x++,b+=4)y(0,b,x/(o-1));return f}mt("AlphaImage",yu),mt("RGBAImage",An);class t2 extends v{createBucket(t){return new Gy(t)}constructor(t){super(t,e2),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Ky({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Xy;var i2={get paint(){return Xy=Xy||new d({"hillshade-illumination-direction":new wt(le.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new wt(le.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new wt(le.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new wt(le.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new wt(le.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new wt(le.paint_hillshade["hillshade-accent-color"])})}};class r2 extends v{constructor(t){super(t,i2)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const n2=z([{name:"a_pos",components:2,type:"Int16"}],4),{members:o2}=n2;var Ap={exports:{}};function hd(r,t,o){o=o||2;var l,f,y,x,b,E,A,P=t&&t.length,D=P?t[0]*o:r.length,B=Jy(r,0,D,o,!0),V=[];if(!B||B.next===B.prev)return V;if(P&&(B=function(Z,Y,se,Ee){var fe,xe,ze,qe=[];for(fe=0,xe=Y.length;fe<xe;fe++)(ze=Jy(Z,Y[fe]*Ee,fe<xe-1?Y[fe+1]*Ee:Z.length,Ee,!1))===ze.next&&(ze.steiner=!0),qe.push(f2(ze));for(qe.sort(u2),fe=0;fe<qe.length;fe++)se=h2(qe[fe],se);return se}(r,t,B,o)),r.length>80*o){l=y=r[0],f=x=r[1];for(var j=o;j<D;j+=o)(b=r[j])<l&&(l=b),(E=r[j+1])<f&&(f=E),b>y&&(y=b),E>x&&(x=E);A=(A=Math.max(y-l,x-f))!==0?32767/A:0}return _u(B,V,o,l,f,A,0),V}function Jy(r,t,o,l,f){var y,x;if(f===Lp(r,t,o,l)>0)for(y=t;y<o;y+=l)x=e_(y,r[y],r[y+1],x);else for(y=o-l;y>=t;y-=l)x=e_(y,r[y],r[y+1],x);return x&&dd(x,x.next)&&(xu(x),x=x.next),x}function Ra(r,t){if(!r)return r;t||(t=r);var o,l=r;do if(o=!1,l.steiner||!dd(l,l.next)&&er(l.prev,l,l.next)!==0)l=l.next;else{if(xu(l),(l=t=l.prev)===l.next)break;o=!0}while(o||l!==t);return t}function _u(r,t,o,l,f,y,x){if(r){!x&&y&&function(P,D,B,V){var j=P;do j.z===0&&(j.z=kp(j.x,j.y,D,B,V)),j.prevZ=j.prev,j.nextZ=j.next,j=j.next;while(j!==P);j.prevZ.nextZ=null,j.prevZ=null,function(Z){var Y,se,Ee,fe,xe,ze,qe,st,Ct=1;do{for(se=Z,Z=null,xe=null,ze=0;se;){for(ze++,Ee=se,qe=0,Y=0;Y<Ct&&(qe++,Ee=Ee.nextZ);Y++);for(st=Ct;qe>0||st>0&&Ee;)qe!==0&&(st===0||!Ee||se.z<=Ee.z)?(fe=se,se=se.nextZ,qe--):(fe=Ee,Ee=Ee.nextZ,st--),xe?xe.nextZ=fe:Z=fe,fe.prevZ=xe,xe=fe;se=Ee}xe.nextZ=null,Ct*=2}while(ze>1)}(j)}(r,l,f,y);for(var b,E,A=r;r.prev!==r.next;)if(b=r.prev,E=r.next,y?a2(r,l,f,y):s2(r))t.push(b.i/o|0),t.push(r.i/o|0),t.push(E.i/o|0),xu(r),r=E.next,A=E.next;else if((r=E)===A){x?x===1?_u(r=l2(Ra(r),t,o),t,o,l,f,y,2):x===2&&c2(r,t,o,l,f,y):_u(Ra(r),t,o,l,f,y,1);break}}}function s2(r){var t=r.prev,o=r,l=r.next;if(er(t,o,l)>=0)return!1;for(var f=t.x,y=o.x,x=l.x,b=t.y,E=o.y,A=l.y,P=f<y?f<x?f:x:y<x?y:x,D=b<E?b<A?b:A:E<A?E:A,B=f>y?f>x?f:x:y>x?y:x,V=b>E?b>A?b:A:E>A?E:A,j=l.next;j!==t;){if(j.x>=P&&j.x<=B&&j.y>=D&&j.y<=V&&jl(f,b,y,E,x,A,j.x,j.y)&&er(j.prev,j,j.next)>=0)return!1;j=j.next}return!0}function a2(r,t,o,l){var f=r.prev,y=r,x=r.next;if(er(f,y,x)>=0)return!1;for(var b=f.x,E=y.x,A=x.x,P=f.y,D=y.y,B=x.y,V=b<E?b<A?b:A:E<A?E:A,j=P<D?P<B?P:B:D<B?D:B,Z=b>E?b>A?b:A:E>A?E:A,Y=P>D?P>B?P:B:D>B?D:B,se=kp(V,j,t,o,l),Ee=kp(Z,Y,t,o,l),fe=r.prevZ,xe=r.nextZ;fe&&fe.z>=se&&xe&&xe.z<=Ee;){if(fe.x>=V&&fe.x<=Z&&fe.y>=j&&fe.y<=Y&&fe!==f&&fe!==x&&jl(b,P,E,D,A,B,fe.x,fe.y)&&er(fe.prev,fe,fe.next)>=0||(fe=fe.prevZ,xe.x>=V&&xe.x<=Z&&xe.y>=j&&xe.y<=Y&&xe!==f&&xe!==x&&jl(b,P,E,D,A,B,xe.x,xe.y)&&er(xe.prev,xe,xe.next)>=0))return!1;xe=xe.nextZ}for(;fe&&fe.z>=se;){if(fe.x>=V&&fe.x<=Z&&fe.y>=j&&fe.y<=Y&&fe!==f&&fe!==x&&jl(b,P,E,D,A,B,fe.x,fe.y)&&er(fe.prev,fe,fe.next)>=0)return!1;fe=fe.prevZ}for(;xe&&xe.z<=Ee;){if(xe.x>=V&&xe.x<=Z&&xe.y>=j&&xe.y<=Y&&xe!==f&&xe!==x&&jl(b,P,E,D,A,B,xe.x,xe.y)&&er(xe.prev,xe,xe.next)>=0)return!1;xe=xe.nextZ}return!0}function l2(r,t,o){var l=r;do{var f=l.prev,y=l.next.next;!dd(f,y)&&Yy(f,l,l.next,y)&&vu(f,y)&&vu(y,f)&&(t.push(f.i/o|0),t.push(l.i/o|0),t.push(y.i/o|0),xu(l),xu(l.next),l=r=y),l=l.next}while(l!==r);return Ra(l)}function c2(r,t,o,l,f,y){var x=r;do{for(var b=x.next.next;b!==x.prev;){if(x.i!==b.i&&p2(x,b)){var E=Qy(x,b);return x=Ra(x,x.next),E=Ra(E,E.next),_u(x,t,o,l,f,y,0),void _u(E,t,o,l,f,y,0)}b=b.next}x=x.next}while(x!==r)}function u2(r,t){return r.x-t.x}function h2(r,t){var o=function(f,y){var x,b=y,E=f.x,A=f.y,P=-1/0;do{if(A<=b.y&&A>=b.next.y&&b.next.y!==b.y){var D=b.x+(A-b.y)*(b.next.x-b.x)/(b.next.y-b.y);if(D<=E&&D>P&&(P=D,x=b.x<b.next.x?b:b.next,D===E))return x}b=b.next}while(b!==y);if(!x)return null;var B,V=x,j=x.x,Z=x.y,Y=1/0;b=x;do E>=b.x&&b.x>=j&&E!==b.x&&jl(A<Z?E:P,A,j,Z,A<Z?P:E,A,b.x,b.y)&&(B=Math.abs(A-b.y)/(E-b.x),vu(b,f)&&(B<Y||B===Y&&(b.x>x.x||b.x===x.x&&d2(x,b)))&&(x=b,Y=B)),b=b.next;while(b!==V);return x}(r,t);if(!o)return t;var l=Qy(o,r);return Ra(l,l.next),Ra(o,o.next)}function d2(r,t){return er(r.prev,r,t.prev)<0&&er(t.next,r,r.next)<0}function kp(r,t,o,l,f){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-o)*f|0)|r<<8))|r<<4))|r<<2))|r<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-l)*f|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function f2(r){var t=r,o=r;do(t.x<o.x||t.x===o.x&&t.y<o.y)&&(o=t),t=t.next;while(t!==r);return o}function jl(r,t,o,l,f,y,x,b){return(f-x)*(t-b)>=(r-x)*(y-b)&&(r-x)*(l-b)>=(o-x)*(t-b)&&(o-x)*(y-b)>=(f-x)*(l-b)}function p2(r,t){return r.next.i!==t.i&&r.prev.i!==t.i&&!function(o,l){var f=o;do{if(f.i!==o.i&&f.next.i!==o.i&&f.i!==l.i&&f.next.i!==l.i&&Yy(f,f.next,o,l))return!0;f=f.next}while(f!==o);return!1}(r,t)&&(vu(r,t)&&vu(t,r)&&function(o,l){var f=o,y=!1,x=(o.x+l.x)/2,b=(o.y+l.y)/2;do f.y>b!=f.next.y>b&&f.next.y!==f.y&&x<(f.next.x-f.x)*(b-f.y)/(f.next.y-f.y)+f.x&&(y=!y),f=f.next;while(f!==o);return y}(r,t)&&(er(r.prev,r,t.prev)||er(r,t.prev,t))||dd(r,t)&&er(r.prev,r,r.next)>0&&er(t.prev,t,t.next)>0)}function er(r,t,o){return(t.y-r.y)*(o.x-t.x)-(t.x-r.x)*(o.y-t.y)}function dd(r,t){return r.x===t.x&&r.y===t.y}function Yy(r,t,o,l){var f=pd(er(r,t,o)),y=pd(er(r,t,l)),x=pd(er(o,l,r)),b=pd(er(o,l,t));return f!==y&&x!==b||!(f!==0||!fd(r,o,t))||!(y!==0||!fd(r,l,t))||!(x!==0||!fd(o,r,l))||!(b!==0||!fd(o,t,l))}function fd(r,t,o){return t.x<=Math.max(r.x,o.x)&&t.x>=Math.min(r.x,o.x)&&t.y<=Math.max(r.y,o.y)&&t.y>=Math.min(r.y,o.y)}function pd(r){return r>0?1:r<0?-1:0}function vu(r,t){return er(r.prev,r,r.next)<0?er(r,t,r.next)>=0&&er(r,r.prev,t)>=0:er(r,t,r.prev)<0||er(r,r.next,t)<0}function Qy(r,t){var o=new Mp(r.i,r.x,r.y),l=new Mp(t.i,t.x,t.y),f=r.next,y=t.prev;return r.next=t,t.prev=r,o.next=f,f.prev=o,l.next=o,o.prev=l,y.next=l,l.prev=y,l}function e_(r,t,o,l){var f=new Mp(r,t,o);return l?(f.next=l.next,f.prev=l,l.next.prev=f,l.next=f):(f.prev=f,f.next=f),f}function xu(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function Mp(r,t,o){this.i=r,this.x=t,this.y=o,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Lp(r,t,o,l){for(var f=0,y=t,x=o-l;y<o;y+=l)f+=(r[x]-r[y])*(r[y+1]+r[x+1]),x=y;return f}Ap.exports=hd,Ap.exports.default=hd,hd.deviation=function(r,t,o,l){var f=t&&t.length,y=Math.abs(Lp(r,0,f?t[0]*o:r.length,o));if(f)for(var x=0,b=t.length;x<b;x++)y-=Math.abs(Lp(r,t[x]*o,x<b-1?t[x+1]*o:r.length,o));var E=0;for(x=0;x<l.length;x+=3){var A=l[x]*o,P=l[x+1]*o,D=l[x+2]*o;E+=Math.abs((r[A]-r[D])*(r[P+1]-r[A+1])-(r[A]-r[P])*(r[D+1]-r[A+1]))}return y===0&&E===0?0:Math.abs((E-y)/y)},hd.flatten=function(r){for(var t=r[0][0].length,o={vertices:[],holes:[],dimensions:t},l=0,f=0;f<r.length;f++){for(var y=0;y<r[f].length;y++)for(var x=0;x<t;x++)o.vertices.push(r[f][y][x]);f>0&&o.holes.push(l+=r[f-1].length)}return o};var t_=I(Ap.exports);function Pp(r,t,o){const l=o.patternDependencies;let f=!1;for(const y of t){const x=y.paint.get(`${r}-pattern`);x.isConstant()||(f=!0);const b=x.constantOr(null);b&&(f=!0,l[b.to]=!0,l[b.from]=!0)}return f}function zp(r,t,o,l,f){const y=f.patternDependencies;for(const x of t){const b=x.paint.get(`${r}-pattern`).value;if(b.kind!=="constant"){let E=b.evaluate({zoom:l-1},o,{},f.availableImages),A=b.evaluate({zoom:l},o,{},f.availableImages),P=b.evaluate({zoom:l+1},o,{},f.availableImages);E=E&&E.name?E.name:E,A=A&&A.name?A.name:A,P=P&&P.name?P.name:P,y[E]=!0,y[A]=!0,y[P]=!0,o.patterns[x.id]={min:E,mid:A,max:P}}}return o}class Dp{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ls,this.indexArray=new yr,this.indexArray2=new Ni,this.programConfigurations=new Pa(t.layers,t.zoom),this.segments=new hr,this.segments2=new hr,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(t,o,l){this.hasPattern=Pp("fill",this.layers,o);const f=this.layers[0].layout.get("fill-sort-key"),y=!f.isConstant(),x=[];for(const{feature:b,id:E,index:A,sourceLayerIndex:P}of t){const D=this.layers[0]._featureFilter.needGeometry,B=Da(b,D);if(!this.layers[0]._featureFilter.filter(new wi(this.zoom),B,l))continue;const V=y?f.evaluate(B,{},l,o.availableImages):void 0,j={id:E,properties:b.properties,type:b.type,sourceLayerIndex:P,index:A,geometry:D?B.geometry:za(b),patterns:{},sortKey:V};x.push(j)}y&&x.sort((b,E)=>b.sortKey-E.sortKey);for(const b of x){const{geometry:E,index:A,sourceLayerIndex:P}=b;if(this.hasPattern){const D=zp("fill",this.layers,b,this.zoom,o);this.patternFeatures.push(D)}else this.addFeature(b,E,A,l,{});o.featureIndex.insert(t[A].feature,E,A,P,this.index)}}update(t,o,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,o,this.stateDependentLayers,l)}addFeatures(t,o,l){for(const f of this.patternFeatures)this.addFeature(f,f.geometry,f.index,o,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,o2),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,o,l,f,y){for(const x of dl(o,500)){let b=0;for(const V of x)b+=V.length;const E=this.segments.prepareSegment(b,this.layoutVertexArray,this.indexArray),A=E.vertexLength,P=[],D=[];for(const V of x){if(V.length===0)continue;V!==x[0]&&D.push(P.length/2);const j=this.segments2.prepareSegment(V.length,this.layoutVertexArray,this.indexArray2),Z=j.vertexLength;this.layoutVertexArray.emplaceBack(V[0].x,V[0].y),this.indexArray2.emplaceBack(Z+V.length-1,Z),P.push(V[0].x),P.push(V[0].y);for(let Y=1;Y<V.length;Y++)this.layoutVertexArray.emplaceBack(V[Y].x,V[Y].y),this.indexArray2.emplaceBack(Z+Y-1,Z+Y),P.push(V[Y].x),P.push(V[Y].y);j.vertexLength+=V.length,j.primitiveLength+=V.length}const B=t_(P,D);for(let V=0;V<B.length;V+=3)this.indexArray.emplaceBack(A+B[V],A+B[V+1],A+B[V+2]);E.vertexLength+=b,E.primitiveLength+=B.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,y,f)}}let i_,r_;mt("FillBucket",Dp,{omit:["layers","patternFeatures"]});var m2={get paint(){return r_=r_||new d({"fill-antialias":new wt(le.paint_fill["fill-antialias"]),"fill-opacity":new At(le.paint_fill["fill-opacity"]),"fill-color":new At(le.paint_fill["fill-color"]),"fill-outline-color":new At(le.paint_fill["fill-outline-color"]),"fill-translate":new wt(le.paint_fill["fill-translate"]),"fill-translate-anchor":new wt(le.paint_fill["fill-translate-anchor"]),"fill-pattern":new _(le.paint_fill["fill-pattern"])})},get layout(){return i_=i_||new d({"fill-sort-key":new At(le.layout_fill["fill-sort-key"])})}};class g2 extends v{constructor(t){super(t,m2)}recalculate(t,o){super.recalculate(t,o);const l=this.paint._values["fill-outline-color"];l.value.kind==="constant"&&l.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new Dp(t)}queryRadius(){return ld(this.paint.get("fill-translate"))}queryIntersectsFeature(t,o,l,f,y,x,b){return Vy(cd(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),x.angle,b),f)}isTileClipped(){return!0}}const y2=z([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),_2=z([{name:"a_centroid",components:2,type:"Int16"}],4),{members:v2}=y2;var Os={},x2=M,n_=Ul;function Ul(r,t,o,l,f){this.properties={},this.extent=o,this.type=0,this._pbf=r,this._geometry=-1,this._keys=l,this._values=f,r.readFields(b2,this,t)}function b2(r,t,o){r==1?t.id=o.readVarint():r==2?function(l,f){for(var y=l.readVarint()+l.pos;l.pos<y;){var x=f._keys[l.readVarint()],b=f._values[l.readVarint()];f.properties[x]=b}}(o,t):r==3?t.type=o.readVarint():r==4&&(t._geometry=o.pos)}function w2(r){for(var t,o,l=0,f=0,y=r.length,x=y-1;f<y;x=f++)l+=((o=r[x]).x-(t=r[f]).x)*(t.y+o.y);return l}Ul.types=["Unknown","Point","LineString","Polygon"],Ul.prototype.loadGeometry=function(){var r=this._pbf;r.pos=this._geometry;for(var t,o=r.readVarint()+r.pos,l=1,f=0,y=0,x=0,b=[];r.pos<o;){if(f<=0){var E=r.readVarint();l=7&E,f=E>>3}if(f--,l===1||l===2)y+=r.readSVarint(),x+=r.readSVarint(),l===1&&(t&&b.push(t),t=[]),t.push(new x2(y,x));else{if(l!==7)throw new Error("unknown command "+l);t&&t.push(t[0].clone())}}return t&&b.push(t),b},Ul.prototype.bbox=function(){var r=this._pbf;r.pos=this._geometry;for(var t=r.readVarint()+r.pos,o=1,l=0,f=0,y=0,x=1/0,b=-1/0,E=1/0,A=-1/0;r.pos<t;){if(l<=0){var P=r.readVarint();o=7&P,l=P>>3}if(l--,o===1||o===2)(f+=r.readSVarint())<x&&(x=f),f>b&&(b=f),(y+=r.readSVarint())<E&&(E=y),y>A&&(A=y);else if(o!==7)throw new Error("unknown command "+o)}return[x,E,b,A]},Ul.prototype.toGeoJSON=function(r,t,o){var l,f,y=this.extent*Math.pow(2,o),x=this.extent*r,b=this.extent*t,E=this.loadGeometry(),A=Ul.types[this.type];function P(V){for(var j=0;j<V.length;j++){var Z=V[j];V[j]=[360*(Z.x+x)/y-180,360/Math.PI*Math.atan(Math.exp((180-360*(Z.y+b)/y)*Math.PI/180))-90]}}switch(this.type){case 1:var D=[];for(l=0;l<E.length;l++)D[l]=E[l][0];P(E=D);break;case 2:for(l=0;l<E.length;l++)P(E[l]);break;case 3:for(E=function(V){var j=V.length;if(j<=1)return[V];for(var Z,Y,se=[],Ee=0;Ee<j;Ee++){var fe=w2(V[Ee]);fe!==0&&(Y===void 0&&(Y=fe<0),Y===fe<0?(Z&&se.push(Z),Z=[V[Ee]]):Z.push(V[Ee]))}return Z&&se.push(Z),se}(E),l=0;l<E.length;l++)for(f=0;f<E[l].length;f++)P(E[l][f])}E.length===1?E=E[0]:A="Multi"+A;var B={type:"Feature",geometry:{type:A,coordinates:E},properties:this.properties};return"id"in this&&(B.id=this.id),B};var E2=n_,o_=s_;function s_(r,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(S2,this,t),this.length=this._features.length}function S2(r,t,o){r===15?t.version=o.readVarint():r===1?t.name=o.readString():r===5?t.extent=o.readVarint():r===2?t._features.push(o.pos):r===3?t._keys.push(o.readString()):r===4&&t._values.push(function(l){for(var f=null,y=l.readVarint()+l.pos;l.pos<y;){var x=l.readVarint()>>3;f=x===1?l.readString():x===2?l.readFloat():x===3?l.readDouble():x===4?l.readVarint64():x===5?l.readVarint():x===6?l.readSVarint():x===7?l.readBoolean():null}return f}(o))}s_.prototype.feature=function(r){if(r<0||r>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[r];var t=this._pbf.readVarint()+this._pbf.pos;return new E2(this._pbf,t,this.extent,this._keys,this._values)};var I2=o_;function T2(r,t,o){if(r===3){var l=new I2(o,o.readVarint()+o.pos);l.length&&(t[l.name]=l)}}Os.VectorTile=function(r,t){this.layers=r.readFields(T2,{},t)},Os.VectorTileFeature=n_,Os.VectorTileLayer=o_;const C2=Os.VectorTileFeature.types,Rp=Math.pow(2,13);function bu(r,t,o,l,f,y,x,b){r.emplaceBack(t,o,2*Math.floor(l*Rp)+x,f*Rp*2,y*Rp*2,Math.round(b))}class Op{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new es,this.centroidVertexArray=new Qo,this.indexArray=new yr,this.programConfigurations=new Pa(t.layers,t.zoom),this.segments=new hr,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(t,o,l){this.features=[],this.hasPattern=Pp("fill-extrusion",this.layers,o);for(const{feature:f,id:y,index:x,sourceLayerIndex:b}of t){const E=this.layers[0]._featureFilter.needGeometry,A=Da(f,E);if(!this.layers[0]._featureFilter.filter(new wi(this.zoom),A,l))continue;const P={id:y,sourceLayerIndex:b,index:x,geometry:E?A.geometry:za(f),properties:f.properties,type:f.type,patterns:{}};this.hasPattern?this.features.push(zp("fill-extrusion",this.layers,P,this.zoom,o)):this.addFeature(P,P.geometry,x,l,{}),o.featureIndex.insert(f,P.geometry,x,b,this.index,!0)}}addFeatures(t,o,l){for(const f of this.features){const{geometry:y}=f;this.addFeature(f,y,f.index,o,l)}}update(t,o,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,o,this.stateDependentLayers,l)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,v2),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,_2.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,o,l,f,y){for(const x of dl(o,500)){const b={x:0,y:0,vertexCount:0};let E=0;for(const j of x)E+=j.length;let A=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const j of x){if(j.length===0||k2(j))continue;let Z=0;for(let Y=0;Y<j.length;Y++){const se=j[Y];if(Y>=1){const Ee=j[Y-1];if(!A2(se,Ee)){A.vertexLength+4>hr.MAX_VERTEX_ARRAY_LENGTH&&(A=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const fe=se.sub(Ee)._perp()._unit(),xe=Ee.dist(se);Z+xe>32768&&(Z=0),bu(this.layoutVertexArray,se.x,se.y,fe.x,fe.y,0,0,Z),bu(this.layoutVertexArray,se.x,se.y,fe.x,fe.y,0,1,Z),b.x+=2*se.x,b.y+=2*se.y,b.vertexCount+=2,Z+=xe,bu(this.layoutVertexArray,Ee.x,Ee.y,fe.x,fe.y,0,0,Z),bu(this.layoutVertexArray,Ee.x,Ee.y,fe.x,fe.y,0,1,Z),b.x+=2*Ee.x,b.y+=2*Ee.y,b.vertexCount+=2;const ze=A.vertexLength;this.indexArray.emplaceBack(ze,ze+2,ze+1),this.indexArray.emplaceBack(ze+1,ze+2,ze+3),A.vertexLength+=4,A.primitiveLength+=2}}}}if(A.vertexLength+E>hr.MAX_VERTEX_ARRAY_LENGTH&&(A=this.segments.prepareSegment(E,this.layoutVertexArray,this.indexArray)),C2[t.type]!=="Polygon")continue;const P=[],D=[],B=A.vertexLength;for(const j of x)if(j.length!==0){j!==x[0]&&D.push(P.length/2);for(let Z=0;Z<j.length;Z++){const Y=j[Z];bu(this.layoutVertexArray,Y.x,Y.y,0,0,1,1,0),b.x+=Y.x,b.y+=Y.y,b.vertexCount+=1,P.push(Y.x),P.push(Y.y)}}const V=t_(P,D);for(let j=0;j<V.length;j+=3)this.indexArray.emplaceBack(B+V[j],B+V[j+2],B+V[j+1]);A.primitiveLength+=V.length/3,A.vertexLength+=E;for(let j=0;j<b.vertexCount;j++){const Z=Math.floor(b.x/b.vertexCount),Y=Math.floor(b.y/b.vertexCount);this.centroidVertexArray.emplaceBack(Z,Y)}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,y,f)}}function A2(r,t){return r.x===t.x&&(r.x<0||r.x>or)||r.y===t.y&&(r.y<0||r.y>or)}function k2(r){return r.every(t=>t.x<0)||r.every(t=>t.x>or)||r.every(t=>t.y<0)||r.every(t=>t.y>or)}let a_;mt("FillExtrusionBucket",Op,{omit:["layers","features"]});var M2={get paint(){return a_=a_||new d({"fill-extrusion-opacity":new wt(le["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new At(le["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new wt(le["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new wt(le["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new _(le["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new At(le["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new At(le["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new wt(le["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class L2 extends v{constructor(t){super(t,M2)}createBucket(t){return new Op(t)}queryRadius(){return ld(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(t,o,l,f,y,x,b,E){const A=cd(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),x.angle,b),P=this.paint.get("fill-extrusion-height").evaluate(o,l),D=this.paint.get("fill-extrusion-base").evaluate(o,l),B=function(j,Z,Y,se){const Ee=[];for(const fe of j){const xe=[fe.x,fe.y,0,1];ud(xe,xe,Z),Ee.push(new C(xe[0]/xe[3],xe[1]/xe[3]))}return Ee}(A,E),V=function(j,Z,Y,se){const Ee=[],fe=[],xe=se[8]*Z,ze=se[9]*Z,qe=se[10]*Z,st=se[11]*Z,Ct=se[8]*Y,lt=se[9]*Y,ot=se[10]*Y,bt=se[11]*Y;for(const gt of j){const ft=[],Fe=[];for(const Et of gt){const vt=Et.x,zt=Et.y,xi=se[0]*vt+se[4]*zt+se[12],yi=se[1]*vt+se[5]*zt+se[13],_r=se[2]*vt+se[6]*zt+se[14],Gn=se[3]*vt+se[7]*zt+se[15],Dr=_r+qe,Xi=Gn+st,rn=xi+Ct,nn=yi+lt,on=_r+ot,Ji=Gn+bt,vr=new C((xi+xe)/Xi,(yi+ze)/Xi);vr.z=Dr/Xi,ft.push(vr);const $r=new C(rn/Ji,nn/Ji);$r.z=on/Ji,Fe.push($r)}Ee.push(ft),fe.push(Fe)}return[Ee,fe]}(f,D,P,E);return function(j,Z,Y){let se=1/0;Vy(Y,Z)&&(se=l_(Y,Z[0]));for(let Ee=0;Ee<Z.length;Ee++){const fe=Z[Ee],xe=j[Ee];for(let ze=0;ze<fe.length-1;ze++){const qe=fe[ze],st=[qe,fe[ze+1],xe[ze+1],xe[ze],qe];Fy(Y,st)&&(se=Math.min(se,l_(Y,st)))}}return se!==1/0&&se}(V[0],V[1],B)}}function wu(r,t){return r.x*t.x+r.y*t.y}function l_(r,t){if(r.length===1){let o=0;const l=t[o++];let f;for(;!f||l.equals(f);)if(f=t[o++],!f)return 1/0;for(;o<t.length;o++){const y=t[o],x=r[0],b=f.sub(l),E=y.sub(l),A=x.sub(l),P=wu(b,b),D=wu(b,E),B=wu(E,E),V=wu(A,b),j=wu(A,E),Z=P*B-D*D,Y=(B*V-D*j)/Z,se=(P*j-D*V)/Z,Ee=l.z*(1-Y-se)+f.z*Y+y.z*se;if(isFinite(Ee))return Ee}return 1/0}{let o=1/0;for(const l of t)o=Math.min(o,l.z);return o}}const P2=z([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:z2}=P2,D2=z([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:R2}=D2,O2=Os.VectorTileFeature.types,B2=Math.cos(Math.PI/180*37.5),c_=Math.pow(2,14)/.5;class Bp{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(o=>{this.gradients[o.id]={}}),this.layoutVertexArray=new Rl,this.layoutVertexArray2=new cu,this.indexArray=new yr,this.programConfigurations=new Pa(t.layers,t.zoom),this.segments=new hr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(t,o,l){this.hasPattern=Pp("line",this.layers,o);const f=this.layers[0].layout.get("line-sort-key"),y=!f.isConstant(),x=[];for(const{feature:b,id:E,index:A,sourceLayerIndex:P}of t){const D=this.layers[0]._featureFilter.needGeometry,B=Da(b,D);if(!this.layers[0]._featureFilter.filter(new wi(this.zoom),B,l))continue;const V=y?f.evaluate(B,{},l):void 0,j={id:E,properties:b.properties,type:b.type,sourceLayerIndex:P,index:A,geometry:D?B.geometry:za(b),patterns:{},sortKey:V};x.push(j)}y&&x.sort((b,E)=>b.sortKey-E.sortKey);for(const b of x){const{geometry:E,index:A,sourceLayerIndex:P}=b;if(this.hasPattern){const D=zp("line",this.layers,b,this.zoom,o);this.patternFeatures.push(D)}else this.addFeature(b,E,A,l,{});o.featureIndex.insert(t[A].feature,E,A,P,this.index)}}update(t,o,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,o,this.stateDependentLayers,l)}addFeatures(t,o,l){for(const f of this.patternFeatures)this.addFeature(f,f.geometry,f.index,o,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,R2)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,z2),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,o,l,f,y){const x=this.layers[0].layout,b=x.get("line-join").evaluate(t,{}),E=x.get("line-cap"),A=x.get("line-miter-limit"),P=x.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const D of o)this.addLine(D,t,b,E,A,P);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,y,f)}addLine(t,o,l,f,y,x){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let se=0;se<t.length-1;se++)this.totalDistance+=t[se].dist(t[se+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const b=O2[o.type]==="Polygon";let E=t.length;for(;E>=2&&t[E-1].equals(t[E-2]);)E--;let A=0;for(;A<E-1&&t[A].equals(t[A+1]);)A++;if(E<(b?3:2))return;l==="bevel"&&(y=1.05);const P=this.overscaling<=16?15*or/(512*this.overscaling):0,D=this.segments.prepareSegment(10*E,this.layoutVertexArray,this.indexArray);let B,V,j,Z,Y;this.e1=this.e2=-1,b&&(B=t[E-2],Y=t[A].sub(B)._unit()._perp());for(let se=A;se<E;se++){if(j=se===E-1?b?t[A+1]:void 0:t[se+1],j&&t[se].equals(j))continue;Y&&(Z=Y),B&&(V=B),B=t[se],Y=j?j.sub(B)._unit()._perp():Z,Z=Z||Y;let Ee=Z.add(Y);Ee.x===0&&Ee.y===0||Ee._unit();const fe=Z.x*Y.x+Z.y*Y.y,xe=Ee.x*Y.x+Ee.y*Y.y,ze=xe!==0?1/xe:1/0,qe=2*Math.sqrt(2-2*xe),st=xe<B2&&V&&j,Ct=Z.x*Y.y-Z.y*Y.x>0;if(st&&se>A){const bt=B.dist(V);if(bt>2*P){const gt=B.sub(B.sub(V)._mult(P/bt)._round());this.updateDistance(V,gt),this.addCurrentVertex(gt,Z,0,0,D),V=gt}}const lt=V&&j;let ot=lt?l:b?"butt":f;if(lt&&ot==="round"&&(ze<x?ot="miter":ze<=2&&(ot="fakeround")),ot==="miter"&&ze>y&&(ot="bevel"),ot==="bevel"&&(ze>2&&(ot="flipbevel"),ze<y&&(ot="miter")),V&&this.updateDistance(V,B),ot==="miter")Ee._mult(ze),this.addCurrentVertex(B,Ee,0,0,D);else if(ot==="flipbevel"){if(ze>100)Ee=Y.mult(-1);else{const bt=ze*Z.add(Y).mag()/Z.sub(Y).mag();Ee._perp()._mult(bt*(Ct?-1:1))}this.addCurrentVertex(B,Ee,0,0,D),this.addCurrentVertex(B,Ee.mult(-1),0,0,D)}else if(ot==="bevel"||ot==="fakeround"){const bt=-Math.sqrt(ze*ze-1),gt=Ct?bt:0,ft=Ct?0:bt;if(V&&this.addCurrentVertex(B,Z,gt,ft,D),ot==="fakeround"){const Fe=Math.round(180*qe/Math.PI/20);for(let Et=1;Et<Fe;Et++){let vt=Et/Fe;if(vt!==.5){const xi=vt-.5;vt+=vt*xi*(vt-1)*((1.0904+fe*(fe*(3.55645-1.43519*fe)-3.2452))*xi*xi+(.848013+fe*(.215638*fe-1.06021)))}const zt=Y.sub(Z)._mult(vt)._add(Z)._unit()._mult(Ct?-1:1);this.addHalfVertex(B,zt.x,zt.y,!1,Ct,0,D)}}j&&this.addCurrentVertex(B,Y,-gt,-ft,D)}else if(ot==="butt")this.addCurrentVertex(B,Ee,0,0,D);else if(ot==="square"){const bt=V?1:-1;this.addCurrentVertex(B,Ee,bt,bt,D)}else ot==="round"&&(V&&(this.addCurrentVertex(B,Z,0,0,D),this.addCurrentVertex(B,Z,1,1,D,!0)),j&&(this.addCurrentVertex(B,Y,-1,-1,D,!0),this.addCurrentVertex(B,Y,0,0,D)));if(st&&se<E-1){const bt=B.dist(j);if(bt>2*P){const gt=B.add(j.sub(B)._mult(P/bt)._round());this.updateDistance(B,gt),this.addCurrentVertex(gt,Y,0,0,D),B=gt}}}}addCurrentVertex(t,o,l,f,y,x=!1){const b=o.y*f-o.x,E=-o.y-o.x*f;this.addHalfVertex(t,o.x+o.y*l,o.y-o.x*l,x,!1,l,y),this.addHalfVertex(t,b,E,x,!0,-f,y),this.distance>c_/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,o,l,f,y,x))}addHalfVertex({x:t,y:o},l,f,y,x,b,E){const A=.5*(this.lineClips?this.scaledDistance*(c_-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(y?1:0),(o<<1)+(x?1:0),Math.round(63*l)+128,Math.round(63*f)+128,1+(b===0?0:b<0?-1:1)|(63&A)<<2,A>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const P=E.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,P),E.primitiveLength++),x?this.e2=P:this.e1=P}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,o){this.distance+=t.dist(o),this.updateScaledDistance()}}let u_,h_;mt("LineBucket",Bp,{omit:["layers","patternFeatures"]});var d_={get paint(){return h_=h_||new d({"line-opacity":new At(le.paint_line["line-opacity"]),"line-color":new At(le.paint_line["line-color"]),"line-translate":new wt(le.paint_line["line-translate"]),"line-translate-anchor":new wt(le.paint_line["line-translate-anchor"]),"line-width":new At(le.paint_line["line-width"]),"line-gap-width":new At(le.paint_line["line-gap-width"]),"line-offset":new At(le.paint_line["line-offset"]),"line-blur":new At(le.paint_line["line-blur"]),"line-dasharray":new i(le.paint_line["line-dasharray"]),"line-pattern":new _(le.paint_line["line-pattern"]),"line-gradient":new a(le.paint_line["line-gradient"])})},get layout(){return u_=u_||new d({"line-cap":new wt(le.layout_line["line-cap"]),"line-join":new At(le.layout_line["line-join"]),"line-miter-limit":new wt(le.layout_line["line-miter-limit"]),"line-round-limit":new wt(le.layout_line["line-round-limit"]),"line-sort-key":new At(le.layout_line["line-sort-key"])})}};class F2 extends At{possiblyEvaluate(t,o){return o=new wi(Math.floor(o.zoom),{now:o.now,fadeDuration:o.fadeDuration,zoomHistory:o.zoomHistory,transition:o.transition}),super.possiblyEvaluate(t,o)}evaluate(t,o,l,f){return o=Ae({},o,{zoom:Math.floor(o.zoom)}),super.evaluate(t,o,l,f)}}let md;class V2 extends v{constructor(t){super(t,d_),this.gradientVersion=0,md||(md=new F2(d_.paint.properties["line-width"].specification),md.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const o=this.gradientExpression();this.stepInterpolant=!!function(l){return l._styleExpression!==void 0}(o)&&o._styleExpression.expression instanceof ma,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,o){super.recalculate(t,o),this.paint._values["line-floorwidth"]=md.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new Bp(t)}queryRadius(t){const o=t,l=f_(mu("line-width",this,o),mu("line-gap-width",this,o)),f=mu("line-offset",this,o);return l/2+Math.abs(f)+ld(this.paint.get("line-translate"))}queryIntersectsFeature(t,o,l,f,y,x,b){const E=cd(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),x.angle,b),A=b/2*f_(this.paint.get("line-width").evaluate(o,l),this.paint.get("line-gap-width").evaluate(o,l)),P=this.paint.get("line-offset").evaluate(o,l);return P&&(f=function(D,B){const V=[];for(let j=0;j<D.length;j++){const Z=D[j],Y=[];for(let se=0;se<Z.length;se++){const Ee=Z[se-1],fe=Z[se],xe=Z[se+1],ze=se===0?new C(0,0):fe.sub(Ee)._unit()._perp(),qe=se===Z.length-1?new C(0,0):xe.sub(fe)._unit()._perp(),st=ze._add(qe)._unit(),Ct=st.x*qe.x+st.y*qe.y;Ct!==0&&st._mult(1/Ct),Y.push(st._mult(B)._add(fe))}V.push(Y)}return V}(f,P*b)),function(D,B,V){for(let j=0;j<B.length;j++){const Z=B[j];if(D.length>=3){for(let Y=0;Y<Z.length;Y++)if(Nl(D,Z[Y]))return!0}if(Ww(D,Z,V))return!0}return!1}(E,f,A)}isTileClipped(){return!0}}function f_(r,t){return t>0?t+2*r:r}const N2=z([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),$2=z([{name:"a_projected_pos",components:3,type:"Float32"}],4);z([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const j2=z([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);z([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const p_=z([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),U2=z([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function q2(r,t,o){return r.sections.forEach(l=>{l.text=function(f,y,x){const b=y.layout.get("text-transform").evaluate(x,{});return b==="uppercase"?f=f.toLocaleUpperCase():b==="lowercase"&&(f=f.toLocaleLowerCase()),Eo.applyArabicShaping&&(f=Eo.applyArabicShaping(f)),f}(l.text,t,o)}),r}z([{name:"triangle",components:3,type:"Uint16"}]),z([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),z([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),z([{type:"Float32",name:"offsetX"}]),z([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),z([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Eu={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var dr=24,m_=gi,g_=function(r,t,o,l,f){var y,x,b=8*f-l-1,E=(1<<b)-1,A=E>>1,P=-7,D=f-1,B=-1,V=r[t+D];for(D+=B,y=V&(1<<-P)-1,V>>=-P,P+=b;P>0;y=256*y+r[t+D],D+=B,P-=8);for(x=y&(1<<-P)-1,y>>=-P,P+=l;P>0;x=256*x+r[t+D],D+=B,P-=8);if(y===0)y=1-A;else{if(y===E)return x?NaN:1/0*(V?-1:1);x+=Math.pow(2,l),y-=A}return(V?-1:1)*x*Math.pow(2,y-l)},y_=function(r,t,o,l,f,y){var x,b,E,A=8*y-f-1,P=(1<<A)-1,D=P>>1,B=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,V=0,j=1,Z=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(b=isNaN(t)?1:0,x=P):(x=Math.floor(Math.log(t)/Math.LN2),t*(E=Math.pow(2,-x))<1&&(x--,E*=2),(t+=x+D>=1?B/E:B*Math.pow(2,1-D))*E>=2&&(x++,E/=2),x+D>=P?(b=0,x=P):x+D>=1?(b=(t*E-1)*Math.pow(2,f),x+=D):(b=t*Math.pow(2,D-1)*Math.pow(2,f),x=0));f>=8;r[o+V]=255&b,V+=j,b/=256,f-=8);for(x=x<<f|b,A+=f;A>0;r[o+V]=255&x,V+=j,x/=256,A-=8);r[o+V-j]|=128*Z};function gi(r){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(r)?r:new Uint8Array(r||0),this.pos=0,this.type=0,this.length=this.buf.length}gi.Varint=0,gi.Fixed64=1,gi.Bytes=2,gi.Fixed32=5;var Fp=4294967296,__=1/Fp,v_=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function is(r){return r.type===gi.Bytes?r.readVarint()+r.pos:r.pos+1}function ql(r,t,o){return o?4294967296*t+(r>>>0):4294967296*(t>>>0)+(r>>>0)}function x_(r,t,o){var l=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));o.realloc(l);for(var f=o.pos-1;f>=r;f--)o.buf[f+l]=o.buf[f]}function H2(r,t){for(var o=0;o<r.length;o++)t.writeVarint(r[o])}function G2(r,t){for(var o=0;o<r.length;o++)t.writeSVarint(r[o])}function Z2(r,t){for(var o=0;o<r.length;o++)t.writeFloat(r[o])}function W2(r,t){for(var o=0;o<r.length;o++)t.writeDouble(r[o])}function K2(r,t){for(var o=0;o<r.length;o++)t.writeBoolean(r[o])}function X2(r,t){for(var o=0;o<r.length;o++)t.writeFixed32(r[o])}function J2(r,t){for(var o=0;o<r.length;o++)t.writeSFixed32(r[o])}function Y2(r,t){for(var o=0;o<r.length;o++)t.writeFixed64(r[o])}function Q2(r,t){for(var o=0;o<r.length;o++)t.writeSFixed64(r[o])}function gd(r,t){return(r[t]|r[t+1]<<8|r[t+2]<<16)+16777216*r[t+3]}function Hl(r,t,o){r[o]=t,r[o+1]=t>>>8,r[o+2]=t>>>16,r[o+3]=t>>>24}function b_(r,t){return(r[t]|r[t+1]<<8|r[t+2]<<16)+(r[t+3]<<24)}gi.prototype={destroy:function(){this.buf=null},readFields:function(r,t,o){for(o=o||this.length;this.pos<o;){var l=this.readVarint(),f=l>>3,y=this.pos;this.type=7&l,r(f,t,this),this.pos===y&&this.skip(l)}return t},readMessage:function(r,t){return this.readFields(r,t,this.readVarint()+this.pos)},readFixed32:function(){var r=gd(this.buf,this.pos);return this.pos+=4,r},readSFixed32:function(){var r=b_(this.buf,this.pos);return this.pos+=4,r},readFixed64:function(){var r=gd(this.buf,this.pos)+gd(this.buf,this.pos+4)*Fp;return this.pos+=8,r},readSFixed64:function(){var r=gd(this.buf,this.pos)+b_(this.buf,this.pos+4)*Fp;return this.pos+=8,r},readFloat:function(){var r=g_(this.buf,this.pos,!0,23,4);return this.pos+=4,r},readDouble:function(){var r=g_(this.buf,this.pos,!0,52,8);return this.pos+=8,r},readVarint:function(r){var t,o,l=this.buf;return t=127&(o=l[this.pos++]),o<128?t:(t|=(127&(o=l[this.pos++]))<<7,o<128?t:(t|=(127&(o=l[this.pos++]))<<14,o<128?t:(t|=(127&(o=l[this.pos++]))<<21,o<128?t:function(f,y,x){var b,E,A=x.buf;if(b=(112&(E=A[x.pos++]))>>4,E<128||(b|=(127&(E=A[x.pos++]))<<3,E<128)||(b|=(127&(E=A[x.pos++]))<<10,E<128)||(b|=(127&(E=A[x.pos++]))<<17,E<128)||(b|=(127&(E=A[x.pos++]))<<24,E<128)||(b|=(1&(E=A[x.pos++]))<<31,E<128))return ql(f,b,y);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(o=l[this.pos]))<<28,r,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var r=this.readVarint();return r%2==1?(r+1)/-2:r/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var r=this.readVarint()+this.pos,t=this.pos;return this.pos=r,r-t>=12&&v_?function(o,l,f){return v_.decode(o.subarray(l,f))}(this.buf,t,r):function(o,l,f){for(var y="",x=l;x<f;){var b,E,A,P=o[x],D=null,B=P>239?4:P>223?3:P>191?2:1;if(x+B>f)break;B===1?P<128&&(D=P):B===2?(192&(b=o[x+1]))==128&&(D=(31&P)<<6|63&b)<=127&&(D=null):B===3?(E=o[x+2],(192&(b=o[x+1]))==128&&(192&E)==128&&((D=(15&P)<<12|(63&b)<<6|63&E)<=2047||D>=55296&&D<=57343)&&(D=null)):B===4&&(E=o[x+2],A=o[x+3],(192&(b=o[x+1]))==128&&(192&E)==128&&(192&A)==128&&((D=(15&P)<<18|(63&b)<<12|(63&E)<<6|63&A)<=65535||D>=1114112)&&(D=null)),D===null?(D=65533,B=1):D>65535&&(D-=65536,y+=String.fromCharCode(D>>>10&1023|55296),D=56320|1023&D),y+=String.fromCharCode(D),x+=B}return y}(this.buf,t,r)},readBytes:function(){var r=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,r);return this.pos=r,t},readPackedVarint:function(r,t){if(this.type!==gi.Bytes)return r.push(this.readVarint(t));var o=is(this);for(r=r||[];this.pos<o;)r.push(this.readVarint(t));return r},readPackedSVarint:function(r){if(this.type!==gi.Bytes)return r.push(this.readSVarint());var t=is(this);for(r=r||[];this.pos<t;)r.push(this.readSVarint());return r},readPackedBoolean:function(r){if(this.type!==gi.Bytes)return r.push(this.readBoolean());var t=is(this);for(r=r||[];this.pos<t;)r.push(this.readBoolean());return r},readPackedFloat:function(r){if(this.type!==gi.Bytes)return r.push(this.readFloat());var t=is(this);for(r=r||[];this.pos<t;)r.push(this.readFloat());return r},readPackedDouble:function(r){if(this.type!==gi.Bytes)return r.push(this.readDouble());var t=is(this);for(r=r||[];this.pos<t;)r.push(this.readDouble());return r},readPackedFixed32:function(r){if(this.type!==gi.Bytes)return r.push(this.readFixed32());var t=is(this);for(r=r||[];this.pos<t;)r.push(this.readFixed32());return r},readPackedSFixed32:function(r){if(this.type!==gi.Bytes)return r.push(this.readSFixed32());var t=is(this);for(r=r||[];this.pos<t;)r.push(this.readSFixed32());return r},readPackedFixed64:function(r){if(this.type!==gi.Bytes)return r.push(this.readFixed64());var t=is(this);for(r=r||[];this.pos<t;)r.push(this.readFixed64());return r},readPackedSFixed64:function(r){if(this.type!==gi.Bytes)return r.push(this.readSFixed64());var t=is(this);for(r=r||[];this.pos<t;)r.push(this.readSFixed64());return r},skip:function(r){var t=7&r;if(t===gi.Varint)for(;this.buf[this.pos++]>127;);else if(t===gi.Bytes)this.pos=this.readVarint()+this.pos;else if(t===gi.Fixed32)this.pos+=4;else{if(t!==gi.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(r,t){this.writeVarint(r<<3|t)},realloc:function(r){for(var t=this.length||16;t<this.pos+r;)t*=2;if(t!==this.length){var o=new Uint8Array(t);o.set(this.buf),this.buf=o,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(r){this.realloc(4),Hl(this.buf,r,this.pos),this.pos+=4},writeSFixed32:function(r){this.realloc(4),Hl(this.buf,r,this.pos),this.pos+=4},writeFixed64:function(r){this.realloc(8),Hl(this.buf,-1&r,this.pos),Hl(this.buf,Math.floor(r*__),this.pos+4),this.pos+=8},writeSFixed64:function(r){this.realloc(8),Hl(this.buf,-1&r,this.pos),Hl(this.buf,Math.floor(r*__),this.pos+4),this.pos+=8},writeVarint:function(r){(r=+r||0)>268435455||r<0?function(t,o){var l,f;if(t>=0?(l=t%4294967296|0,f=t/4294967296|0):(f=~(-t/4294967296),4294967295^(l=~(-t%4294967296))?l=l+1|0:(l=0,f=f+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");o.realloc(10),function(y,x,b){b.buf[b.pos++]=127&y|128,y>>>=7,b.buf[b.pos++]=127&y|128,y>>>=7,b.buf[b.pos++]=127&y|128,y>>>=7,b.buf[b.pos++]=127&y|128,b.buf[b.pos]=127&(y>>>=7)}(l,0,o),function(y,x){var b=(7&y)<<4;x.buf[x.pos++]|=b|((y>>>=3)?128:0),y&&(x.buf[x.pos++]=127&y|((y>>>=7)?128:0),y&&(x.buf[x.pos++]=127&y|((y>>>=7)?128:0),y&&(x.buf[x.pos++]=127&y|((y>>>=7)?128:0),y&&(x.buf[x.pos++]=127&y|((y>>>=7)?128:0),y&&(x.buf[x.pos++]=127&y)))))}(f,o)}(r,this):(this.realloc(4),this.buf[this.pos++]=127&r|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=r>>>7&127))))},writeSVarint:function(r){this.writeVarint(r<0?2*-r-1:2*r)},writeBoolean:function(r){this.writeVarint(!!r)},writeString:function(r){r=String(r),this.realloc(4*r.length),this.pos++;var t=this.pos;this.pos=function(l,f,y){for(var x,b,E=0;E<f.length;E++){if((x=f.charCodeAt(E))>55295&&x<57344){if(!b){x>56319||E+1===f.length?(l[y++]=239,l[y++]=191,l[y++]=189):b=x;continue}if(x<56320){l[y++]=239,l[y++]=191,l[y++]=189,b=x;continue}x=b-55296<<10|x-56320|65536,b=null}else b&&(l[y++]=239,l[y++]=191,l[y++]=189,b=null);x<128?l[y++]=x:(x<2048?l[y++]=x>>6|192:(x<65536?l[y++]=x>>12|224:(l[y++]=x>>18|240,l[y++]=x>>12&63|128),l[y++]=x>>6&63|128),l[y++]=63&x|128)}return y}(this.buf,r,this.pos);var o=this.pos-t;o>=128&&x_(t,o,this),this.pos=t-1,this.writeVarint(o),this.pos+=o},writeFloat:function(r){this.realloc(4),y_(this.buf,r,this.pos,!0,23,4),this.pos+=4},writeDouble:function(r){this.realloc(8),y_(this.buf,r,this.pos,!0,52,8),this.pos+=8},writeBytes:function(r){var t=r.length;this.writeVarint(t),this.realloc(t);for(var o=0;o<t;o++)this.buf[this.pos++]=r[o]},writeRawMessage:function(r,t){this.pos++;var o=this.pos;r(t,this);var l=this.pos-o;l>=128&&x_(o,l,this),this.pos=o-1,this.writeVarint(l),this.pos+=l},writeMessage:function(r,t,o){this.writeTag(r,gi.Bytes),this.writeRawMessage(t,o)},writePackedVarint:function(r,t){t.length&&this.writeMessage(r,H2,t)},writePackedSVarint:function(r,t){t.length&&this.writeMessage(r,G2,t)},writePackedBoolean:function(r,t){t.length&&this.writeMessage(r,K2,t)},writePackedFloat:function(r,t){t.length&&this.writeMessage(r,Z2,t)},writePackedDouble:function(r,t){t.length&&this.writeMessage(r,W2,t)},writePackedFixed32:function(r,t){t.length&&this.writeMessage(r,X2,t)},writePackedSFixed32:function(r,t){t.length&&this.writeMessage(r,J2,t)},writePackedFixed64:function(r,t){t.length&&this.writeMessage(r,Y2,t)},writePackedSFixed64:function(r,t){t.length&&this.writeMessage(r,Q2,t)},writeBytesField:function(r,t){this.writeTag(r,gi.Bytes),this.writeBytes(t)},writeFixed32Field:function(r,t){this.writeTag(r,gi.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(r,t){this.writeTag(r,gi.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(r,t){this.writeTag(r,gi.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(r,t){this.writeTag(r,gi.Fixed64),this.writeSFixed64(t)},writeVarintField:function(r,t){this.writeTag(r,gi.Varint),this.writeVarint(t)},writeSVarintField:function(r,t){this.writeTag(r,gi.Varint),this.writeSVarint(t)},writeStringField:function(r,t){this.writeTag(r,gi.Bytes),this.writeString(t)},writeFloatField:function(r,t){this.writeTag(r,gi.Fixed32),this.writeFloat(t)},writeDoubleField:function(r,t){this.writeTag(r,gi.Fixed64),this.writeDouble(t)},writeBooleanField:function(r,t){this.writeVarintField(r,!!t)}};var Vp=I(m_);const Np=3;function eE(r,t,o){r===1&&o.readMessage(tE,t)}function tE(r,t,o){if(r===3){const{id:l,bitmap:f,width:y,height:x,left:b,top:E,advance:A}=o.readMessage(iE,{});t.push({id:l,bitmap:new yu({width:y+2*Np,height:x+2*Np},f),metrics:{width:y,height:x,left:b,top:E,advance:A}})}}function iE(r,t,o){r===1?t.id=o.readVarint():r===2?t.bitmap=o.readBytes():r===3?t.width=o.readVarint():r===4?t.height=o.readVarint():r===5?t.left=o.readSVarint():r===6?t.top=o.readSVarint():r===7&&(t.advance=o.readVarint())}const w_=Np;function E_(r){let t=0,o=0;for(const x of r)t+=x.w*x.h,o=Math.max(o,x.w);r.sort((x,b)=>b.h-x.h);const l=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),o),h:1/0}];let f=0,y=0;for(const x of r)for(let b=l.length-1;b>=0;b--){const E=l[b];if(!(x.w>E.w||x.h>E.h)){if(x.x=E.x,x.y=E.y,y=Math.max(y,x.y+x.h),f=Math.max(f,x.x+x.w),x.w===E.w&&x.h===E.h){const A=l.pop();b<l.length&&(l[b]=A)}else x.h===E.h?(E.x+=x.w,E.w-=x.w):x.w===E.w?(E.y+=x.h,E.h-=x.h):(l.push({x:E.x+x.w,y:E.y,w:E.w-x.w,h:x.h}),E.y+=x.h,E.h-=x.h);break}}return{w:f,h:y,fill:t/(f*y)||0}}const mn=1;class $p{constructor(t,{pixelRatio:o,version:l,stretchX:f,stretchY:y,content:x,textFitWidth:b,textFitHeight:E}){this.paddedRect=t,this.pixelRatio=o,this.stretchX=f,this.stretchY=y,this.content=x,this.version=l,this.textFitWidth=b,this.textFitHeight=E}get tl(){return[this.paddedRect.x+mn,this.paddedRect.y+mn]}get br(){return[this.paddedRect.x+this.paddedRect.w-mn,this.paddedRect.y+this.paddedRect.h-mn]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*mn)/this.pixelRatio,(this.paddedRect.h-2*mn)/this.pixelRatio]}}class S_{constructor(t,o){const l={},f={};this.haveRenderCallbacks=[];const y=[];this.addImages(t,l,y),this.addImages(o,f,y);const{w:x,h:b}=E_(y),E=new An({width:x||1,height:b||1});for(const A in t){const P=t[A],D=l[A].paddedRect;An.copy(P.data,E,{x:0,y:0},{x:D.x+mn,y:D.y+mn},P.data)}for(const A in o){const P=o[A],D=f[A].paddedRect,B=D.x+mn,V=D.y+mn,j=P.data.width,Z=P.data.height;An.copy(P.data,E,{x:0,y:0},{x:B,y:V},P.data),An.copy(P.data,E,{x:0,y:Z-1},{x:B,y:V-1},{width:j,height:1}),An.copy(P.data,E,{x:0,y:0},{x:B,y:V+Z},{width:j,height:1}),An.copy(P.data,E,{x:j-1,y:0},{x:B-1,y:V},{width:1,height:Z}),An.copy(P.data,E,{x:0,y:0},{x:B+j,y:V},{width:1,height:Z})}this.image=E,this.iconPositions=l,this.patternPositions=f}addImages(t,o,l){for(const f in t){const y=t[f],x={x:0,y:0,w:y.data.width+2*mn,h:y.data.height+2*mn};l.push(x),o[f]=new $p(x,y),y.hasRenderCallback&&this.haveRenderCallbacks.push(f)}}patchUpdatedImages(t,o){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const l in t.updatedImages)this.patchUpdatedImage(this.iconPositions[l],t.getImage(l),o),this.patchUpdatedImage(this.patternPositions[l],t.getImage(l),o)}patchUpdatedImage(t,o,l){if(!t||!o||t.version===o.version)return;t.version=o.version;const[f,y]=t.tl;l.update(o.data,void 0,{x:f,y})}}var Bs;mt("ImagePosition",$p),mt("ImageAtlas",S_),m.ah=void 0,(Bs=m.ah||(m.ah={}))[Bs.none=0]="none",Bs[Bs.horizontal=1]="horizontal",Bs[Bs.vertical=2]="vertical",Bs[Bs.horizontalOnly=3]="horizontalOnly";const Su=-17;class Iu{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,o){const l=new Iu;return l.scale=t||1,l.fontStack=o,l}static forImage(t){const o=new Iu;return o.imageName=t,o}}class Gl{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,o){const l=new Gl;for(let f=0;f<t.sections.length;f++){const y=t.sections[f];y.image?l.addImageSection(y):l.addTextSection(y,o)}return l}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let o="";for(let l=0;l<t.length;l++){const f=t.charCodeAt(l+1)||null,y=t.charCodeAt(l-1)||null;o+=f&&ed(f)&&!Eu[t[l+1]]||y&&ed(y)&&!Eu[t[l-1]]||!Eu[t[l]]?t[l]:Eu[t[l]]}return o}(this.text)}trim(){let t=0;for(let l=0;l<this.text.length&&_d[this.text.charCodeAt(l)];l++)t++;let o=this.text.length;for(let l=this.text.length-1;l>=0&&l>=t&&_d[this.text.charCodeAt(l)];l--)o--;this.text=this.text.substring(t,o),this.sectionIndex=this.sectionIndex.slice(t,o)}substring(t,o){const l=new Gl;return l.text=this.text.substring(t,o),l.sectionIndex=this.sectionIndex.slice(t,o),l.sections=this.sections,l}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,o)=>Math.max(t,this.sections[o].scale),0)}addTextSection(t,o){this.text+=t.text,this.sections.push(Iu.forText(t.scale,t.fontStack||o));const l=this.sections.length-1;for(let f=0;f<t.text.length;++f)this.sectionIndex.push(l)}addImageSection(t){const o=t.image?t.image.name:"";if(o.length===0)return void Oe("Can't add FormattedSection with an empty image.");const l=this.getNextImageSectionCharCode();l?(this.text+=String.fromCharCode(l),this.sections.push(Iu.forImage(o)),this.sectionIndex.push(this.sections.length-1)):Oe("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function yd(r,t,o,l,f,y,x,b,E,A,P,D,B,V,j){const Z=Gl.fromFeature(r,f);let Y;D===m.ah.vertical&&Z.verticalizePunctuation();const{processBidirectionalText:se,processStyledBidirectionalText:Ee}=Eo;if(se&&Z.sections.length===1){Y=[];const ze=se(Z.toString(),jp(Z,A,y,t,l,V));for(const qe of ze){const st=new Gl;st.text=qe,st.sections=Z.sections;for(let Ct=0;Ct<qe.length;Ct++)st.sectionIndex.push(0);Y.push(st)}}else if(Ee){Y=[];const ze=Ee(Z.text,Z.sectionIndex,jp(Z,A,y,t,l,V));for(const qe of ze){const st=new Gl;st.text=qe[0],st.sectionIndex=qe[1],st.sections=Z.sections,Y.push(st)}}else Y=function(ze,qe){const st=[],Ct=ze.text;let lt=0;for(const ot of qe)st.push(ze.substring(lt,ot)),lt=ot;return lt<Ct.length&&st.push(ze.substring(lt,Ct.length)),st}(Z,jp(Z,A,y,t,l,V));const fe=[],xe={positionedLines:fe,text:Z.toString(),top:P[1],bottom:P[1],left:P[0],right:P[0],writingMode:D,iconsInText:!1,verticalizable:!1};return function(ze,qe,st,Ct,lt,ot,bt,gt,ft,Fe,Et,vt){let zt=0,xi=Su,yi=0,_r=0;const Gn=gt==="right"?1:gt==="left"?0:.5;let Dr=0;for(const Ji of lt){Ji.trim();const vr=Ji.getMaxScale(),$r=(vr-1)*dr,Rr={positionedGlyphs:[],lineOffset:0};ze.positionedLines[Dr]=Rr;const sn=Rr.positionedGlyphs;let Or=0;if(!Ji.length()){xi+=ot,++Dr;continue}for(let gn=0;gn<Ji.length();gn++){const si=Ji.getSection(gn),Ei=Ji.getSectionIndex(gn),Mi=Ji.getCharCode(gn);let bn=0,qi=null,Xl=null,Co=null,Ao=dr;const Zn=!(ft===m.ah.horizontal||!Et&&!su(Mi)||Et&&(_d[Mi]||(Xi=Mi,ct.Arabic(Xi)||ct["Arabic Supplement"](Xi)||ct["Arabic Extended-A"](Xi)||ct["Arabic Presentation Forms-A"](Xi)||ct["Arabic Presentation Forms-B"](Xi))));if(si.imageName){const Ln=Ct[si.imageName];if(!Ln)continue;Co=si.imageName,ze.iconsInText=ze.iconsInText||!0,Xl=Ln.paddedRect;const Sr=Ln.displaySize;si.scale=si.scale*dr/vt,qi={width:Sr[0],height:Sr[1],left:mn,top:-w_,advance:Zn?Sr[1]:Sr[0]},bn=$r+(dr-Sr[1]*si.scale),Ao=qi.advance;const rs=Zn?Sr[0]*si.scale-dr*vr:Sr[1]*si.scale-dr*vr;rs>0&&rs>Or&&(Or=rs)}else{const Ln=st[si.fontStack],Sr=Ln&&Ln[Mi];if(Sr&&Sr.rect)Xl=Sr.rect,qi=Sr.metrics;else{const rs=qe[si.fontStack],Mu=rs&&rs[Mi];if(!Mu)continue;qi=Mu.metrics}bn=(vr-si.scale)*dr}Zn?(ze.verticalizable=!0,sn.push({glyph:Mi,imageName:Co,x:zt,y:xi+bn,vertical:Zn,scale:si.scale,fontStack:si.fontStack,sectionIndex:Ei,metrics:qi,rect:Xl}),zt+=Ao*si.scale+Fe):(sn.push({glyph:Mi,imageName:Co,x:zt,y:xi+bn,vertical:Zn,scale:si.scale,fontStack:si.fontStack,sectionIndex:Ei,metrics:qi,rect:Xl}),zt+=qi.advance*si.scale+Fe)}sn.length!==0&&(yi=Math.max(zt-Fe,yi),sE(sn,0,sn.length-1,Gn,Or)),zt=0;const Mn=ot*vr+Or;Rr.lineOffset=Math.max(Or,$r),xi+=Mn,_r=Math.max(Mn,_r),++Dr}var Xi;const rn=xi-Su,{horizontalAlign:nn,verticalAlign:on}=Up(bt);(function(Ji,vr,$r,Rr,sn,Or,Mn,gn,si){const Ei=(vr-$r)*sn;let Mi=0;Mi=Or!==Mn?-gn*Rr-Su:(-Rr*si+.5)*Mn;for(const bn of Ji)for(const qi of bn.positionedGlyphs)qi.x+=Ei,qi.y+=Mi})(ze.positionedLines,Gn,nn,on,yi,_r,ot,rn,lt.length),ze.top+=-on*rn,ze.bottom=ze.top+rn,ze.left+=-nn*yi,ze.right=ze.left+yi}(xe,t,o,l,Y,x,b,E,D,A,B,j),!function(ze){for(const qe of ze)if(qe.positionedGlyphs.length!==0)return!1;return!0}(fe)&&xe}const _d={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},rE={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},nE={40:!0};function I_(r,t,o,l,f,y){if(t.imageName){const x=l[t.imageName];return x?x.displaySize[0]*t.scale*dr/y+f:0}{const x=o[t.fontStack],b=x&&x[r];return b?b.metrics.advance*t.scale+f:0}}function T_(r,t,o,l){const f=Math.pow(r-t,2);return l?r<t?f/2:2*f:f+Math.abs(o)*o}function oE(r,t,o){let l=0;return r===10&&(l-=1e4),o&&(l+=150),r!==40&&r!==65288||(l+=50),t!==41&&t!==65289||(l+=50),l}function C_(r,t,o,l,f,y){let x=null,b=T_(t,o,f,y);for(const E of l){const A=T_(t-E.x,o,f,y)+E.badness;A<=b&&(x=E,b=A)}return{index:r,x:t,priorBreak:x,badness:b}}function A_(r){return r?A_(r.priorBreak).concat(r.index):[]}function jp(r,t,o,l,f,y){if(!r)return[];const x=[],b=function(D,B,V,j,Z,Y){let se=0;for(let Ee=0;Ee<D.length();Ee++){const fe=D.getSection(Ee);se+=I_(D.getCharCode(Ee),fe,j,Z,B,Y)}return se/Math.max(1,Math.ceil(se/V))}(r,t,o,l,f,y),E=r.text.indexOf("​")>=0;let A=0;for(let D=0;D<r.length();D++){const B=r.getSection(D),V=r.getCharCode(D);if(_d[V]||(A+=I_(V,B,l,f,t,y)),D<r.length()-1){const j=!((P=V)<11904||!(ct["Bopomofo Extended"](P)||ct.Bopomofo(P)||ct["CJK Compatibility Forms"](P)||ct["CJK Compatibility Ideographs"](P)||ct["CJK Compatibility"](P)||ct["CJK Radicals Supplement"](P)||ct["CJK Strokes"](P)||ct["CJK Symbols and Punctuation"](P)||ct["CJK Unified Ideographs Extension A"](P)||ct["CJK Unified Ideographs"](P)||ct["Enclosed CJK Letters and Months"](P)||ct["Halfwidth and Fullwidth Forms"](P)||ct.Hiragana(P)||ct["Ideographic Description Characters"](P)||ct["Kangxi Radicals"](P)||ct["Katakana Phonetic Extensions"](P)||ct.Katakana(P)||ct["Vertical Forms"](P)||ct["Yi Radicals"](P)||ct["Yi Syllables"](P)));(rE[V]||j||B.imageName||D!==r.length()-2&&nE[r.getCharCode(D+1)])&&x.push(C_(D+1,A,b,x,oE(V,r.getCharCode(D+1),j&&E),!1))}}var P;return A_(C_(r.length(),A,b,x,0,!0))}function Up(r){let t=.5,o=.5;switch(r){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(r){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:t,verticalAlign:o}}function sE(r,t,o,l,f){if(!l&&!f)return;const y=r[o],x=(r[o].x+y.metrics.advance*y.scale)*l;for(let b=t;b<=o;b++)r[b].x-=x,r[b].y+=f}function aE(r,t,o){const{horizontalAlign:l,verticalAlign:f}=Up(o),y=t[0]-r.displaySize[0]*l,x=t[1]-r.displaySize[1]*f;return{image:r,top:x,bottom:x+r.displaySize[1],left:y,right:y+r.displaySize[0]}}function k_(r){var t,o;let l=r.left,f=r.top,y=r.right-l,x=r.bottom-f;const b=(t=r.image.textFitWidth)!==null&&t!==void 0?t:"stretchOrShrink",E=(o=r.image.textFitHeight)!==null&&o!==void 0?o:"stretchOrShrink",A=(r.image.content[2]-r.image.content[0])/(r.image.content[3]-r.image.content[1]);if(E==="proportional"){if(b==="stretchOnly"&&y/x<A||b==="proportional"){const P=Math.ceil(x*A);l*=P/y,y=P}}else if(b==="proportional"&&E==="stretchOnly"&&A!==0&&y/x>A){const P=Math.ceil(y/A);f*=P/x,x=P}return{x1:l,y1:f,x2:l+y,y2:f+x}}function M_(r,t,o,l,f,y){const x=r.image;let b;if(x.content){const Y=x.content,se=x.pixelRatio||1;b=[Y[0]/se,Y[1]/se,x.displaySize[0]-Y[2]/se,x.displaySize[1]-Y[3]/se]}const E=t.left*y,A=t.right*y;let P,D,B,V;o==="width"||o==="both"?(V=f[0]+E-l[3],D=f[0]+A+l[1]):(V=f[0]+(E+A-x.displaySize[0])/2,D=V+x.displaySize[0]);const j=t.top*y,Z=t.bottom*y;return o==="height"||o==="both"?(P=f[1]+j-l[0],B=f[1]+Z+l[2]):(P=f[1]+(j+Z-x.displaySize[1])/2,B=P+x.displaySize[1]),{image:x,top:P,right:D,bottom:B,left:V,collisionPadding:b}}const Tu=255,To=128,Fs=Tu*To;function L_(r,t){const{expression:o}=t;if(o.kind==="constant")return{kind:"constant",layoutSize:o.evaluate(new wi(r+1))};if(o.kind==="source")return{kind:"source"};{const{zoomStops:l,interpolationType:f}=o;let y=0;for(;y<l.length&&l[y]<=r;)y++;y=Math.max(0,y-1);let x=y;for(;x<l.length&&l[x]<r+1;)x++;x=Math.min(l.length-1,x);const b=l[y],E=l[x];return o.kind==="composite"?{kind:"composite",minZoom:b,maxZoom:E,interpolationType:f}:{kind:"camera",minZoom:b,maxZoom:E,minSize:o.evaluate(new wi(b)),maxSize:o.evaluate(new wi(E)),interpolationType:f}}}function qp(r,t,o){let l="never";const f=r.get(t);return f?l=f:r.get(o)&&(l="always"),l}const lE=Os.VectorTileFeature.types,cE=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function vd(r,t,o,l,f,y,x,b,E,A,P,D,B){const V=b?Math.min(Fs,Math.round(b[0])):0,j=b?Math.min(Fs,Math.round(b[1])):0;r.emplaceBack(t,o,Math.round(32*l),Math.round(32*f),y,x,(V<<1)+(E?1:0),j,16*A,16*P,256*D,256*B)}function Hp(r,t,o){r.emplaceBack(t.x,t.y,o),r.emplaceBack(t.x,t.y,o),r.emplaceBack(t.x,t.y,o),r.emplaceBack(t.x,t.y,o)}function uE(r){for(const t of r.sections)if(au(t.text))return!0;return!1}class Gp{constructor(t){this.layoutVertexArray=new Cn,this.indexArray=new yr,this.programConfigurations=t,this.segments=new hr,this.dynamicLayoutVertexArray=new So,this.opacityVertexArray=new Ps,this.hasVisibleVertices=!1,this.placedSymbolArray=new Ai}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,o,l,f){this.isEmpty()||(l&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,N2.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,$2.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,cE,!0),this.opacityVertexBuffer.itemSize=1),(l||f)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}mt("SymbolBuffers",Gp);class Zp{constructor(t,o,l){this.layoutVertexArray=new t,this.layoutAttributes=o,this.indexArray=new l,this.segments=new hr,this.collisionVertexArray=new Pr}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,j2.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}mt("CollisionBuffers",Zp);class Zl{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(x=>x.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ip([]),this.placementViewportMatrix=Ip([]);const o=this.layers[0]._unevaluatedLayout._values;this.textSizeData=L_(this.zoom,o["text-size"]),this.iconSizeData=L_(this.zoom,o["icon-size"]);const l=this.layers[0].layout,f=l.get("symbol-sort-key"),y=l.get("symbol-z-order");this.canOverlap=qp(l,"text-overlap","text-allow-overlap")!=="never"||qp(l,"icon-overlap","icon-allow-overlap")!=="never"||l.get("text-ignore-placement")||l.get("icon-ignore-placement"),this.sortFeaturesByKey=y!=="viewport-y"&&!f.isConstant(),this.sortFeaturesByY=(y==="viewport-y"||y==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,l.get("symbol-placement")==="point"&&(this.writingModes=l.get("text-writing-mode").map(x=>m.ah[x])),this.stateDependentLayerIds=this.layers.filter(x=>x.isStateDependent()).map(x=>x.id),this.sourceID=t.sourceID}createArrays(){this.text=new Gp(new Pa(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new Gp(new Pa(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new ki,this.lineVertexArray=new en,this.symbolInstances=new In,this.textAnchorOffsets=new kr}calculateGlyphDependencies(t,o,l,f,y){for(let x=0;x<t.length;x++)if(o[t.charCodeAt(x)]=!0,(l||f)&&y){const b=Eu[t.charAt(x)];b&&(o[b.charCodeAt(0)]=!0)}}populate(t,o,l){const f=this.layers[0],y=f.layout,x=y.get("text-font"),b=y.get("text-field"),E=y.get("icon-image"),A=(b.value.kind!=="constant"||b.value.value instanceof un&&!b.value.value.isEmpty()||b.value.value.toString().length>0)&&(x.value.kind!=="constant"||x.value.value.length>0),P=E.value.kind!=="constant"||!!E.value.value||Object.keys(E.parameters).length>0,D=y.get("symbol-sort-key");if(this.features=[],!A&&!P)return;const B=o.iconDependencies,V=o.glyphDependencies,j=o.availableImages,Z=new wi(this.zoom);for(const{feature:Y,id:se,index:Ee,sourceLayerIndex:fe}of t){const xe=f._featureFilter.needGeometry,ze=Da(Y,xe);if(!f._featureFilter.filter(Z,ze,l))continue;let qe,st;if(xe||(ze.geometry=za(Y)),A){const lt=f.getValueAndResolveTokens("text-field",ze,l,j),ot=un.factory(lt),bt=this.hasRTLText=this.hasRTLText||uE(ot);(!bt||Eo.getRTLTextPluginStatus()==="unavailable"||bt&&Eo.isParsed())&&(qe=q2(ot,f,ze))}if(P){const lt=f.getValueAndResolveTokens("icon-image",ze,l,j);st=lt instanceof _n?lt:_n.fromString(lt)}if(!qe&&!st)continue;const Ct=this.sortFeaturesByKey?D.evaluate(ze,{},l):void 0;if(this.features.push({id:se,text:qe,icon:st,index:Ee,sourceLayerIndex:fe,geometry:ze.geometry,properties:Y.properties,type:lE[Y.type],sortKey:Ct}),st&&(B[st.name]=!0),qe){const lt=x.evaluate(ze,{},l).join(","),ot=y.get("text-rotation-alignment")!=="viewport"&&y.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(m.ah.vertical)>=0;for(const bt of qe.sections)if(bt.image)B[bt.image.name]=!0;else{const gt=ou(qe.toString()),ft=bt.fontStack||lt,Fe=V[ft]=V[ft]||{};this.calculateGlyphDependencies(bt.text,Fe,ot,this.allowVerticalPlacement,gt)}}}y.get("symbol-placement")==="line"&&(this.features=function(Y){const se={},Ee={},fe=[];let xe=0;function ze(lt){fe.push(Y[lt]),xe++}function qe(lt,ot,bt){const gt=Ee[lt];return delete Ee[lt],Ee[ot]=gt,fe[gt].geometry[0].pop(),fe[gt].geometry[0]=fe[gt].geometry[0].concat(bt[0]),gt}function st(lt,ot,bt){const gt=se[ot];return delete se[ot],se[lt]=gt,fe[gt].geometry[0].shift(),fe[gt].geometry[0]=bt[0].concat(fe[gt].geometry[0]),gt}function Ct(lt,ot,bt){const gt=bt?ot[0][ot[0].length-1]:ot[0][0];return`${lt}:${gt.x}:${gt.y}`}for(let lt=0;lt<Y.length;lt++){const ot=Y[lt],bt=ot.geometry,gt=ot.text?ot.text.toString():null;if(!gt){ze(lt);continue}const ft=Ct(gt,bt),Fe=Ct(gt,bt,!0);if(ft in Ee&&Fe in se&&Ee[ft]!==se[Fe]){const Et=st(ft,Fe,bt),vt=qe(ft,Fe,fe[Et].geometry);delete se[ft],delete Ee[Fe],Ee[Ct(gt,fe[vt].geometry,!0)]=vt,fe[Et].geometry=null}else ft in Ee?qe(ft,Fe,bt):Fe in se?st(ft,Fe,bt):(ze(lt),se[ft]=xe-1,Ee[Fe]=xe-1)}return fe.filter(lt=>lt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Y,se)=>Y.sortKey-se.sortKey)}update(t,o,l){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,o,this.layers,l),this.icon.programConfigurations.updatePaintArrays(t,o,this.layers,l))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,o){const l=this.lineVertexArray.length;if(t.segment!==void 0){let f=t.dist(o[t.segment+1]),y=t.dist(o[t.segment]);const x={};for(let b=t.segment+1;b<o.length;b++)x[b]={x:o[b].x,y:o[b].y,tileUnitDistanceFromAnchor:f},b<o.length-1&&(f+=o[b+1].dist(o[b]));for(let b=t.segment||0;b>=0;b--)x[b]={x:o[b].x,y:o[b].y,tileUnitDistanceFromAnchor:y},b>0&&(y+=o[b-1].dist(o[b]));for(let b=0;b<o.length;b++){const E=x[b];this.lineVertexArray.emplaceBack(E.x,E.y,E.tileUnitDistanceFromAnchor)}}return{lineStartIndex:l,lineLength:this.lineVertexArray.length-l}}addSymbols(t,o,l,f,y,x,b,E,A,P,D,B){const V=t.indexArray,j=t.layoutVertexArray,Z=t.segments.prepareSegment(4*o.length,j,V,this.canOverlap?x.sortKey:void 0),Y=this.glyphOffsetArray.length,se=Z.vertexLength,Ee=this.allowVerticalPlacement&&b===m.ah.vertical?Math.PI/2:0,fe=x.text&&x.text.sections;for(let xe=0;xe<o.length;xe++){const{tl:ze,tr:qe,bl:st,br:Ct,tex:lt,pixelOffsetTL:ot,pixelOffsetBR:bt,minFontScaleX:gt,minFontScaleY:ft,glyphOffset:Fe,isSDF:Et,sectionIndex:vt}=o[xe],zt=Z.vertexLength,xi=Fe[1];vd(j,E.x,E.y,ze.x,xi+ze.y,lt.x,lt.y,l,Et,ot.x,ot.y,gt,ft),vd(j,E.x,E.y,qe.x,xi+qe.y,lt.x+lt.w,lt.y,l,Et,bt.x,ot.y,gt,ft),vd(j,E.x,E.y,st.x,xi+st.y,lt.x,lt.y+lt.h,l,Et,ot.x,bt.y,gt,ft),vd(j,E.x,E.y,Ct.x,xi+Ct.y,lt.x+lt.w,lt.y+lt.h,l,Et,bt.x,bt.y,gt,ft),Hp(t.dynamicLayoutVertexArray,E,Ee),V.emplaceBack(zt,zt+1,zt+2),V.emplaceBack(zt+1,zt+2,zt+3),Z.vertexLength+=4,Z.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Fe[0]),xe!==o.length-1&&vt===o[xe+1].sectionIndex||t.programConfigurations.populatePaintArrays(j.length,x,x.index,{},B,fe&&fe[vt])}t.placedSymbolArray.emplaceBack(E.x,E.y,Y,this.glyphOffsetArray.length-Y,se,A,P,E.segment,l?l[0]:0,l?l[1]:0,f[0],f[1],b,0,!1,0,D)}_addCollisionDebugVertex(t,o,l,f,y,x){return o.emplaceBack(0,0),t.emplaceBack(l.x,l.y,f,y,Math.round(x.x),Math.round(x.y))}addCollisionDebugVertices(t,o,l,f,y,x,b){const E=y.segments.prepareSegment(4,y.layoutVertexArray,y.indexArray),A=E.vertexLength,P=y.layoutVertexArray,D=y.collisionVertexArray,B=b.anchorX,V=b.anchorY;this._addCollisionDebugVertex(P,D,x,B,V,new C(t,o)),this._addCollisionDebugVertex(P,D,x,B,V,new C(l,o)),this._addCollisionDebugVertex(P,D,x,B,V,new C(l,f)),this._addCollisionDebugVertex(P,D,x,B,V,new C(t,f)),E.vertexLength+=4;const j=y.indexArray;j.emplaceBack(A,A+1),j.emplaceBack(A+1,A+2),j.emplaceBack(A+2,A+3),j.emplaceBack(A+3,A),E.primitiveLength+=4}addDebugCollisionBoxes(t,o,l,f){for(let y=t;y<o;y++){const x=this.collisionBoxArray.get(y);this.addCollisionDebugVertices(x.x1,x.y1,x.x2,x.y2,f?this.textCollisionBox:this.iconCollisionBox,x.anchorPoint,l)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Zp(Lr,p_.members,Ni),this.iconCollisionBox=new Zp(Lr,p_.members,Ni);for(let t=0;t<this.symbolInstances.length;t++){const o=this.symbolInstances.get(t);this.addDebugCollisionBoxes(o.textBoxStartIndex,o.textBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.iconBoxStartIndex,o.iconBoxEndIndex,o,!1),this.addDebugCollisionBoxes(o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex,o,!1)}}_deserializeCollisionBoxesForSymbol(t,o,l,f,y,x,b,E,A){const P={};for(let D=o;D<l;D++){const B=t.get(D);P.textBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},P.textFeatureIndex=B.featureIndex;break}for(let D=f;D<y;D++){const B=t.get(D);P.verticalTextBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},P.verticalTextFeatureIndex=B.featureIndex;break}for(let D=x;D<b;D++){const B=t.get(D);P.iconBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},P.iconFeatureIndex=B.featureIndex;break}for(let D=E;D<A;D++){const B=t.get(D);P.verticalIconBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},P.verticalIconFeatureIndex=B.featureIndex;break}return P}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){const l=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,l.textBoxStartIndex,l.textBoxEndIndex,l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l.iconBoxStartIndex,l.iconBoxEndIndex,l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,o){const l=t.placedSymbolArray.get(o),f=l.vertexStartIndex+4*l.numGlyphs;for(let y=l.vertexStartIndex;y<f;y+=4)t.indexArray.emplaceBack(y,y+1,y+2),t.indexArray.emplaceBack(y+1,y+2,y+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const o=Math.sin(t),l=Math.cos(t),f=[],y=[],x=[];for(let b=0;b<this.symbolInstances.length;++b){x.push(b);const E=this.symbolInstances.get(b);f.push(0|Math.round(o*E.anchorX+l*E.anchorY)),y.push(E.featureIndex)}return x.sort((b,E)=>f[b]-f[E]||y[E]-y[b]),x}addToSortKeyRanges(t,o){const l=this.sortKeyRanges[this.sortKeyRanges.length-1];l&&l.sortKey===o?l.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const o of this.symbolInstanceIndexes){const l=this.symbolInstances.get(o);this.featureSortOrder.push(l.featureIndex),[l.rightJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.leftJustifiedTextSymbolIndex].forEach((f,y,x)=>{f>=0&&x.indexOf(f)===y&&this.addIndicesForPlacedSymbol(this.text,f)}),l.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,l.verticalPlacedTextSymbolIndex),l.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.placedIconSymbolIndex),l.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let P_,z_;mt("SymbolBucket",Zl,{omit:["layers","collisionBoxArray","features","compareText"]}),Zl.MAX_GLYPHS=65535,Zl.addDynamicAttributes=Hp;var Wp={get paint(){return z_=z_||new d({"icon-opacity":new At(le.paint_symbol["icon-opacity"]),"icon-color":new At(le.paint_symbol["icon-color"]),"icon-halo-color":new At(le.paint_symbol["icon-halo-color"]),"icon-halo-width":new At(le.paint_symbol["icon-halo-width"]),"icon-halo-blur":new At(le.paint_symbol["icon-halo-blur"]),"icon-translate":new wt(le.paint_symbol["icon-translate"]),"icon-translate-anchor":new wt(le.paint_symbol["icon-translate-anchor"]),"text-opacity":new At(le.paint_symbol["text-opacity"]),"text-color":new At(le.paint_symbol["text-color"],{runtimeType:pi,getOverride:r=>r.textColor,hasOverride:r=>!!r.textColor}),"text-halo-color":new At(le.paint_symbol["text-halo-color"]),"text-halo-width":new At(le.paint_symbol["text-halo-width"]),"text-halo-blur":new At(le.paint_symbol["text-halo-blur"]),"text-translate":new wt(le.paint_symbol["text-translate"]),"text-translate-anchor":new wt(le.paint_symbol["text-translate-anchor"])})},get layout(){return P_=P_||new d({"symbol-placement":new wt(le.layout_symbol["symbol-placement"]),"symbol-spacing":new wt(le.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new wt(le.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new At(le.layout_symbol["symbol-sort-key"]),"symbol-z-order":new wt(le.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new wt(le.layout_symbol["icon-allow-overlap"]),"icon-overlap":new wt(le.layout_symbol["icon-overlap"]),"icon-ignore-placement":new wt(le.layout_symbol["icon-ignore-placement"]),"icon-optional":new wt(le.layout_symbol["icon-optional"]),"icon-rotation-alignment":new wt(le.layout_symbol["icon-rotation-alignment"]),"icon-size":new At(le.layout_symbol["icon-size"]),"icon-text-fit":new wt(le.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new wt(le.layout_symbol["icon-text-fit-padding"]),"icon-image":new At(le.layout_symbol["icon-image"]),"icon-rotate":new At(le.layout_symbol["icon-rotate"]),"icon-padding":new At(le.layout_symbol["icon-padding"]),"icon-keep-upright":new wt(le.layout_symbol["icon-keep-upright"]),"icon-offset":new At(le.layout_symbol["icon-offset"]),"icon-anchor":new At(le.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new wt(le.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new wt(le.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new wt(le.layout_symbol["text-rotation-alignment"]),"text-field":new At(le.layout_symbol["text-field"]),"text-font":new At(le.layout_symbol["text-font"]),"text-size":new At(le.layout_symbol["text-size"]),"text-max-width":new At(le.layout_symbol["text-max-width"]),"text-line-height":new wt(le.layout_symbol["text-line-height"]),"text-letter-spacing":new At(le.layout_symbol["text-letter-spacing"]),"text-justify":new At(le.layout_symbol["text-justify"]),"text-radial-offset":new At(le.layout_symbol["text-radial-offset"]),"text-variable-anchor":new wt(le.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new At(le.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new At(le.layout_symbol["text-anchor"]),"text-max-angle":new wt(le.layout_symbol["text-max-angle"]),"text-writing-mode":new wt(le.layout_symbol["text-writing-mode"]),"text-rotate":new At(le.layout_symbol["text-rotate"]),"text-padding":new wt(le.layout_symbol["text-padding"]),"text-keep-upright":new wt(le.layout_symbol["text-keep-upright"]),"text-transform":new At(le.layout_symbol["text-transform"]),"text-offset":new At(le.layout_symbol["text-offset"]),"text-allow-overlap":new wt(le.layout_symbol["text-allow-overlap"]),"text-overlap":new wt(le.layout_symbol["text-overlap"]),"text-ignore-placement":new wt(le.layout_symbol["text-ignore-placement"]),"text-optional":new wt(le.layout_symbol["text-optional"])})}};class D_{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:Kr,this.defaultValue=t}evaluate(t){if(t.formattedSection){const o=this.defaultValue.property.overrides;if(o&&o.hasOverride(t.formattedSection))return o.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}mt("FormatSectionOverride",D_,{omit:["defaultValue"]});class xd extends v{constructor(t){super(t,Wp)}recalculate(t,o){if(super.recalculate(t,o),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const l=this.layout.get("text-writing-mode");if(l){const f=[];for(const y of l)f.indexOf(y)<0&&f.push(y);this.layout._values["text-writing-mode"]=f}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,o,l,f){const y=this.layout.get(t).evaluate(o,{},l,f),x=this._unevaluatedLayout._values[t];return x.isDataDriven()||El(x.value)||!y?y:function(b,E){return E.replace(/{([^{}]+)}/g,(A,P)=>b&&P in b?String(b[P]):"")}(o.properties,y)}createBucket(t){return new Zl(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of Wp.paint.overridableProperties){if(!xd.hasPaintOverride(this.layout,t))continue;const o=this.paint.get(t),l=new D_(o),f=new Hc(l,o.property.specification);let y=null;y=o.value.kind==="constant"||o.value.kind==="source"?new Gc("source",f):new Zc("composite",f,o.value.zoomStops),this.paint._values[t]=new Hn(o.property,y,o.parameters)}}_handleOverridablePaintPropertyUpdate(t,o,l){return!(!this.layout||o.isDataDriven()||l.isDataDriven())&&xd.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,o){const l=t.get("text-field"),f=Wp.paint.properties[o];let y=!1;const x=b=>{for(const E of b)if(f.overrides&&f.overrides.hasOverride(E))return void(y=!0)};if(l.value.kind==="constant"&&l.value.value instanceof un)x(l.value.value.sections);else if(l.value.kind==="source"){const b=A=>{y||(A instanceof Uo&&nr(A.value)===ro?x(A.value.sections):A instanceof ul?x(A.sections):A.eachChild(b))},E=l.value;E._styleExpression&&b(E._styleExpression.expression)}return y}}let R_;var hE={get paint(){return R_=R_||new d({"background-color":new wt(le.paint_background["background-color"]),"background-pattern":new i(le.paint_background["background-pattern"]),"background-opacity":new wt(le.paint_background["background-opacity"])})}};class dE extends v{constructor(t){super(t,hE)}}let O_;var fE={get paint(){return O_=O_||new d({"raster-opacity":new wt(le.paint_raster["raster-opacity"]),"raster-hue-rotate":new wt(le.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new wt(le.paint_raster["raster-brightness-min"]),"raster-brightness-max":new wt(le.paint_raster["raster-brightness-max"]),"raster-saturation":new wt(le.paint_raster["raster-saturation"]),"raster-contrast":new wt(le.paint_raster["raster-contrast"]),"raster-resampling":new wt(le.paint_raster["raster-resampling"]),"raster-fade-duration":new wt(le.paint_raster["raster-fade-duration"])})}};class pE extends v{constructor(t){super(t,fE)}}class mE extends v{constructor(t){super(t,{}),this.onAdd=o=>{this.implementation.onAdd&&this.implementation.onAdd(o,o.painter.context.gl)},this.onRemove=o=>{this.implementation.onRemove&&this.implementation.onRemove(o,o.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class gE{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Kp=63710088e-1;class Vs{constructor(t,o){if(isNaN(t)||isNaN(o))throw new Error(`Invalid LngLat object: (${t}, ${o})`);if(this.lng=+t,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Vs(oe(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const o=Math.PI/180,l=this.lat*o,f=t.lat*o,y=Math.sin(l)*Math.sin(f)+Math.cos(l)*Math.cos(f)*Math.cos((t.lng-this.lng)*o);return Kp*Math.acos(Math.min(y,1))}static convert(t){if(t instanceof Vs)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new Vs(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new Vs(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const B_=2*Math.PI*Kp;function F_(r){return B_*Math.cos(r*Math.PI/180)}function V_(r){return(180+r)/360}function N_(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function $_(r,t){return r/F_(t)}function Xp(r){return 360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90}class bd{constructor(t,o,l=0){this.x=+t,this.y=+o,this.z=+l}static fromLngLat(t,o=0){const l=Vs.convert(t);return new bd(V_(l.lng),N_(l.lat),$_(o,l.lat))}toLngLat(){return new Vs(360*this.x-180,Xp(this.y))}toAltitude(){return this.z*F_(Xp(this.y))}meterInMercatorCoordinateUnits(){return 1/B_*(t=Xp(this.y),1/Math.cos(t*Math.PI/180));var t}}function j_(r,t,o){var l=2*Math.PI*6378137/256/Math.pow(2,o);return[r*l-2*Math.PI*6378137/2,t*l-2*Math.PI*6378137/2]}class Jp{constructor(t,o,l){if(t<0||t>25||l<0||l>=Math.pow(2,t)||o<0||o>=Math.pow(2,t))throw new Error(`x=${o}, y=${l}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=o,this.y=l,this.key=Cu(0,t,t,o,l)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,o,l){const f=(x=this.y,b=this.z,E=j_(256*(y=this.x),256*(x=Math.pow(2,b)-x-1),b),A=j_(256*(y+1),256*(x+1),b),E[0]+","+E[1]+","+A[0]+","+A[1]);var y,x,b,E,A;const P=function(D,B,V){let j,Z="";for(let Y=D;Y>0;Y--)j=1<<Y-1,Z+=(B&j?1:0)+(V&j?2:0);return Z}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(l==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,o>1?"@2x":"").replace(/{quadkey}/g,P).replace(/{bbox-epsg-3857}/g,f)}isChildOf(t){const o=this.z-t.z;return o>0&&t.x===this.x>>o&&t.y===this.y>>o}getTilePoint(t){const o=Math.pow(2,this.z);return new C((t.x*o-this.x)*or,(t.y*o-this.y)*or)}toString(){return`${this.z}/${this.x}/${this.y}`}}class U_{constructor(t,o){this.wrap=t,this.canonical=o,this.key=Cu(t,o.z,o.z,o.x,o.y)}}class kn{constructor(t,o,l,f,y){if(t<l)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${l}`);this.overscaledZ=t,this.wrap=o,this.canonical=new Jp(l,+f,+y),this.key=Cu(o,t,l,f,y)}clone(){return new kn(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const o=this.canonical.z-t;return t>this.canonical.z?new kn(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new kn(t,this.wrap,t,this.canonical.x>>o,this.canonical.y>>o)}calculateScaledKey(t,o){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const l=this.canonical.z-t;return t>this.canonical.z?Cu(this.wrap*+o,t,this.canonical.z,this.canonical.x,this.canonical.y):Cu(this.wrap*+o,t,t,this.canonical.x>>l,this.canonical.y>>l)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const o=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>o&&t.canonical.y===this.canonical.y>>o}children(t){if(this.overscaledZ>=t)return[new kn(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const o=this.canonical.z+1,l=2*this.canonical.x,f=2*this.canonical.y;return[new kn(o,this.wrap,o,l,f),new kn(o,this.wrap,o,l+1,f),new kn(o,this.wrap,o,l,f+1),new kn(o,this.wrap,o,l+1,f+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new kn(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new kn(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new U_(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new bd(t.x-this.wrap,t.y))}}function Cu(r,t,o,l,f){(r*=2)<0&&(r=-1*r-1);const y=1<<o;return(y*y*r+y*f+l).toString(36)+o.toString(36)+t.toString(36)}mt("CanonicalTileID",Jp),mt("OverscaledTileID",kn,{omit:["posMatrix"]});class q_{constructor(t,o,l,f=1,y=1,x=1,b=0){if(this.uid=t,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(l&&!["mapbox","terrarium","custom"].includes(l))return void Oe(`"${l}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=o.height;const E=this.dim=o.height-2;switch(this.data=new Uint32Array(o.data.buffer),l){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=f,this.greenFactor=y,this.blueFactor=x,this.baseShift=b;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let A=0;A<E;A++)this.data[this._idx(-1,A)]=this.data[this._idx(0,A)],this.data[this._idx(E,A)]=this.data[this._idx(E-1,A)],this.data[this._idx(A,-1)]=this.data[this._idx(A,0)],this.data[this._idx(A,E)]=this.data[this._idx(A,E-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(E,-1)]=this.data[this._idx(E-1,0)],this.data[this._idx(-1,E)]=this.data[this._idx(0,E-1)],this.data[this._idx(E,E)]=this.data[this._idx(E-1,E-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let A=0;A<E;A++)for(let P=0;P<E;P++){const D=this.get(A,P);D>this.max&&(this.max=D),D<this.min&&(this.min=D)}}get(t,o){const l=new Uint8Array(this.data.buffer),f=4*this._idx(t,o);return this.unpack(l[f],l[f+1],l[f+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,o){if(t<-1||t>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(t+1)}unpack(t,o,l){return t*this.redFactor+o*this.greenFactor+l*this.blueFactor-this.baseShift}getPixels(){return new An({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,o,l){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let f=o*this.dim,y=o*this.dim+this.dim,x=l*this.dim,b=l*this.dim+this.dim;switch(o){case-1:f=y-1;break;case 1:y=f+1}switch(l){case-1:x=b-1;break;case 1:b=x+1}const E=-o*this.dim,A=-l*this.dim;for(let P=x;P<b;P++)for(let D=f;D<y;D++)this.data[this._idx(D,P)]=t.data[this._idx(D+E,P+A)]}}mt("DEMData",q_);class H_{constructor(t){this._stringToNumber={},this._numberToString=[];for(let o=0;o<t.length;o++){const l=t[o];this._stringToNumber[l]=o,this._numberToString[o]=l}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class G_{constructor(t,o,l,f,y){this.type="Feature",this._vectorTileFeature=t,t._z=o,t._x=l,t._y=f,this.properties=t.properties,this.id=y}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const o in this)o!=="_geometry"&&o!=="_vectorTileFeature"&&(t[o]=this[o]);return t}}class Z_{constructor(t,o){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Aa(or,16,0),this.grid3D=new Aa(or,16,0),this.featureIndexArray=new Tn,this.promoteId=o}insert(t,o,l,f,y,x){const b=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(l,f,y);const E=x?this.grid3D:this.grid;for(let A=0;A<o.length;A++){const P=o[A],D=[1/0,1/0,-1/0,-1/0];for(let B=0;B<P.length;B++){const V=P[B];D[0]=Math.min(D[0],V.x),D[1]=Math.min(D[1],V.y),D[2]=Math.max(D[2],V.x),D[3]=Math.max(D[3],V.y)}D[0]<or&&D[1]<or&&D[2]>=0&&D[3]>=0&&E.insert(b,D[0],D[1],D[2],D[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Os.VectorTile(new Vp(this.rawTileData)).layers,this.sourceLayerCoder=new H_(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,o,l,f){this.loadVTLayers();const y=t.params||{},x=or/t.tileSize/t.scale,b=Wc(y.filter),E=t.queryGeometry,A=t.queryPadding*x,P=K_(E),D=this.grid.query(P.minX-A,P.minY-A,P.maxX+A,P.maxY+A),B=K_(t.cameraQueryGeometry),V=this.grid3D.query(B.minX-A,B.minY-A,B.maxX+A,B.maxY+A,(Y,se,Ee,fe)=>function(xe,ze,qe,st,Ct){for(const ot of xe)if(ze<=ot.x&&qe<=ot.y&&st>=ot.x&&Ct>=ot.y)return!0;const lt=[new C(ze,qe),new C(ze,Ct),new C(st,Ct),new C(st,qe)];if(xe.length>2){for(const ot of lt)if(Nl(xe,ot))return!0}for(let ot=0;ot<xe.length-1;ot++)if(Xw(xe[ot],xe[ot+1],lt))return!0;return!1}(t.cameraQueryGeometry,Y-A,se-A,Ee+A,fe+A));for(const Y of V)D.push(Y);D.sort(yE);const j={};let Z;for(let Y=0;Y<D.length;Y++){const se=D[Y];if(se===Z)continue;Z=se;const Ee=this.featureIndexArray.get(se);let fe=null;this.loadMatchingFeature(j,Ee.bucketIndex,Ee.sourceLayerIndex,Ee.featureIndex,b,y.layers,y.availableImages,o,l,f,(xe,ze,qe)=>(fe||(fe=za(xe)),ze.queryIntersectsFeature(E,xe,qe,fe,this.z,t.transform,x,t.pixelPosMatrix)))}return j}loadMatchingFeature(t,o,l,f,y,x,b,E,A,P,D){const B=this.bucketLayerIDs[o];if(x&&!function(Y,se){for(let Ee=0;Ee<Y.length;Ee++)if(se.indexOf(Y[Ee])>=0)return!0;return!1}(x,B))return;const V=this.sourceLayerCoder.decode(l),j=this.vtLayers[V].feature(f);if(y.needGeometry){const Y=Da(j,!0);if(!y.filter(new wi(this.tileID.overscaledZ),Y,this.tileID.canonical))return}else if(!y.filter(new wi(this.tileID.overscaledZ),j))return;const Z=this.getId(j,V);for(let Y=0;Y<B.length;Y++){const se=B[Y];if(x&&x.indexOf(se)<0)continue;const Ee=E[se];if(!Ee)continue;let fe={};Z&&P&&(fe=P.getState(Ee.sourceLayer||"_geojsonTileLayer",Z));const xe=Ae({},A[se]);xe.paint=W_(xe.paint,Ee.paint,j,fe,b),xe.layout=W_(xe.layout,Ee.layout,j,fe,b);const ze=!D||D(j,Ee,fe);if(!ze)continue;const qe=new G_(j,this.z,this.x,this.y,Z);qe.layer=xe;let st=t[se];st===void 0&&(st=t[se]=[]),st.push({featureIndex:f,feature:qe,intersectionZ:ze})}}lookupSymbolFeatures(t,o,l,f,y,x,b,E){const A={};this.loadVTLayers();const P=Wc(y);for(const D of t)this.loadMatchingFeature(A,l,f,D,P,x,b,E,o);return A}hasLayer(t){for(const o of this.bucketLayerIDs)for(const l of o)if(t===l)return!0;return!1}getId(t,o){let l=t.id;return this.promoteId&&(l=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[o]],typeof l=="boolean"&&(l=Number(l))),l}}function W_(r,t,o,l,f){return Le(r,(y,x)=>{const b=t instanceof zl?t.get(x):null;return b&&b.evaluate?b.evaluate(o,l,f):b})}function K_(r){let t=1/0,o=1/0,l=-1/0,f=-1/0;for(const y of r)t=Math.min(t,y.x),o=Math.min(o,y.y),l=Math.max(l,y.x),f=Math.max(f,y.y);return{minX:t,minY:o,maxX:l,maxY:f}}function yE(r,t){return t-r}function X_(r,t,o,l,f){const y=[];for(let x=0;x<r.length;x++){const b=r[x];let E;for(let A=0;A<b.length-1;A++){let P=b[A],D=b[A+1];P.x<t&&D.x<t||(P.x<t?P=new C(t,P.y+(t-P.x)/(D.x-P.x)*(D.y-P.y))._round():D.x<t&&(D=new C(t,P.y+(t-P.x)/(D.x-P.x)*(D.y-P.y))._round()),P.y<o&&D.y<o||(P.y<o?P=new C(P.x+(o-P.y)/(D.y-P.y)*(D.x-P.x),o)._round():D.y<o&&(D=new C(P.x+(o-P.y)/(D.y-P.y)*(D.x-P.x),o)._round()),P.x>=l&&D.x>=l||(P.x>=l?P=new C(l,P.y+(l-P.x)/(D.x-P.x)*(D.y-P.y))._round():D.x>=l&&(D=new C(l,P.y+(l-P.x)/(D.x-P.x)*(D.y-P.y))._round()),P.y>=f&&D.y>=f||(P.y>=f?P=new C(P.x+(f-P.y)/(D.y-P.y)*(D.x-P.x),f)._round():D.y>=f&&(D=new C(P.x+(f-P.y)/(D.y-P.y)*(D.x-P.x),f)._round()),E&&P.equals(E[E.length-1])||(E=[P],y.push(E)),E.push(D)))))}}return y}mt("FeatureIndex",Z_,{omit:["rawTileData","sourceLayerCoder"]});class Ns extends C{constructor(t,o,l,f){super(t,o),this.angle=l,f!==void 0&&(this.segment=f)}clone(){return new Ns(this.x,this.y,this.angle,this.segment)}}function J_(r,t,o,l,f){if(t.segment===void 0||o===0)return!0;let y=t,x=t.segment+1,b=0;for(;b>-o/2;){if(x--,x<0)return!1;b-=r[x].dist(y),y=r[x]}b+=r[x].dist(r[x+1]),x++;const E=[];let A=0;for(;b<o/2;){const P=r[x],D=r[x+1];if(!D)return!1;let B=r[x-1].angleTo(P)-P.angleTo(D);for(B=Math.abs((B+3*Math.PI)%(2*Math.PI)-Math.PI),E.push({distance:b,angleDelta:B}),A+=B;b-E[0].distance>l;)A-=E.shift().angleDelta;if(A>f)return!1;x++,b+=P.dist(D)}return!0}function Y_(r){let t=0;for(let o=0;o<r.length-1;o++)t+=r[o].dist(r[o+1]);return t}function Q_(r,t,o){return r?.6*t*o:0}function e0(r,t){return Math.max(r?r.right-r.left:0,t?t.right-t.left:0)}function _E(r,t,o,l,f,y){const x=Q_(o,f,y),b=e0(o,l)*y;let E=0;const A=Y_(r)/2;for(let P=0;P<r.length-1;P++){const D=r[P],B=r[P+1],V=D.dist(B);if(E+V>A){const j=(A-E)/V,Z=Vr.number(D.x,B.x,j),Y=Vr.number(D.y,B.y,j),se=new Ns(Z,Y,B.angleTo(D),P);return se._round(),!x||J_(r,se,b,x,t)?se:void 0}E+=V}}function vE(r,t,o,l,f,y,x,b,E){const A=Q_(l,y,x),P=e0(l,f),D=P*x,B=r[0].x===0||r[0].x===E||r[0].y===0||r[0].y===E;return t-D<t/4&&(t=D+t/4),t0(r,B?t/2*b%t:(P/2+2*y)*x*b%t,t,A,o,D,B,!1,E)}function t0(r,t,o,l,f,y,x,b,E){const A=y/2,P=Y_(r);let D=0,B=t-o,V=[];for(let j=0;j<r.length-1;j++){const Z=r[j],Y=r[j+1],se=Z.dist(Y),Ee=Y.angleTo(Z);for(;B+o<D+se;){B+=o;const fe=(B-D)/se,xe=Vr.number(Z.x,Y.x,fe),ze=Vr.number(Z.y,Y.y,fe);if(xe>=0&&xe<E&&ze>=0&&ze<E&&B-A>=0&&B+A<=P){const qe=new Ns(xe,ze,Ee,j);qe._round(),l&&!J_(r,qe,y,l,f)||V.push(qe)}}D+=se}return b||V.length||x||(V=t0(r,D/2,o,l,f,y,x,!0,E)),V}mt("Anchor",Ns);const Wl=mn;function i0(r,t,o,l){const f=[],y=r.image,x=y.pixelRatio,b=y.paddedRect.w-2*Wl,E=y.paddedRect.h-2*Wl;let A={x1:r.left,y1:r.top,x2:r.right,y2:r.bottom};const P=y.stretchX||[[0,b]],D=y.stretchY||[[0,E]],B=(Fe,Et)=>Fe+Et[1]-Et[0],V=P.reduce(B,0),j=D.reduce(B,0),Z=b-V,Y=E-j;let se=0,Ee=V,fe=0,xe=j,ze=0,qe=Z,st=0,Ct=Y;if(y.content&&l){const Fe=y.content,Et=Fe[2]-Fe[0],vt=Fe[3]-Fe[1];(y.textFitWidth||y.textFitHeight)&&(A=k_(r)),se=wd(P,0,Fe[0]),fe=wd(D,0,Fe[1]),Ee=wd(P,Fe[0],Fe[2]),xe=wd(D,Fe[1],Fe[3]),ze=Fe[0]-se,st=Fe[1]-fe,qe=Et-Ee,Ct=vt-xe}const lt=A.x1,ot=A.y1,bt=A.x2-lt,gt=A.y2-ot,ft=(Fe,Et,vt,zt)=>{const xi=Ed(Fe.stretch-se,Ee,bt,lt),yi=Sd(Fe.fixed-ze,qe,Fe.stretch,V),_r=Ed(Et.stretch-fe,xe,gt,ot),Gn=Sd(Et.fixed-st,Ct,Et.stretch,j),Dr=Ed(vt.stretch-se,Ee,bt,lt),Xi=Sd(vt.fixed-ze,qe,vt.stretch,V),rn=Ed(zt.stretch-fe,xe,gt,ot),nn=Sd(zt.fixed-st,Ct,zt.stretch,j),on=new C(xi,_r),Ji=new C(Dr,_r),vr=new C(Dr,rn),$r=new C(xi,rn),Rr=new C(yi/x,Gn/x),sn=new C(Xi/x,nn/x),Or=t*Math.PI/180;if(Or){const si=Math.sin(Or),Ei=Math.cos(Or),Mi=[Ei,-si,si,Ei];on._matMult(Mi),Ji._matMult(Mi),$r._matMult(Mi),vr._matMult(Mi)}const Mn=Fe.stretch+Fe.fixed,gn=Et.stretch+Et.fixed;return{tl:on,tr:Ji,bl:$r,br:vr,tex:{x:y.paddedRect.x+Wl+Mn,y:y.paddedRect.y+Wl+gn,w:vt.stretch+vt.fixed-Mn,h:zt.stretch+zt.fixed-gn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Rr,pixelOffsetBR:sn,minFontScaleX:qe/x/bt,minFontScaleY:Ct/x/gt,isSDF:o}};if(l&&(y.stretchX||y.stretchY)){const Fe=r0(P,Z,V),Et=r0(D,Y,j);for(let vt=0;vt<Fe.length-1;vt++){const zt=Fe[vt],xi=Fe[vt+1];for(let yi=0;yi<Et.length-1;yi++)f.push(ft(zt,Et[yi],xi,Et[yi+1]))}}else f.push(ft({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:b+1},{fixed:0,stretch:E+1}));return f}function wd(r,t,o){let l=0;for(const f of r)l+=Math.max(t,Math.min(o,f[1]))-Math.max(t,Math.min(o,f[0]));return l}function r0(r,t,o){const l=[{fixed:-Wl,stretch:0}];for(const[f,y]of r){const x=l[l.length-1];l.push({fixed:f-x.stretch,stretch:x.stretch}),l.push({fixed:f-x.stretch,stretch:x.stretch+(y-f)})}return l.push({fixed:t+Wl,stretch:o}),l}function Ed(r,t,o,l){return r/t*o+l}function Sd(r,t,o,l){return r-t*o/l}class Id{constructor(t,o,l,f,y,x,b,E,A,P){var D;if(this.boxStartIndex=t.length,A){let B=x.top,V=x.bottom;const j=x.collisionPadding;j&&(B-=j[1],V+=j[3]);let Z=V-B;Z>0&&(Z=Math.max(10,Z),this.circleDiameter=Z)}else{const B=!((D=x.image)===null||D===void 0)&&D.content&&(x.image.textFitWidth||x.image.textFitHeight)?k_(x):{x1:x.left,y1:x.top,x2:x.right,y2:x.bottom};B.y1=B.y1*b-E[0],B.y2=B.y2*b+E[2],B.x1=B.x1*b-E[3],B.x2=B.x2*b+E[1];const V=x.collisionPadding;if(V&&(B.x1-=V[0]*b,B.y1-=V[1]*b,B.x2+=V[2]*b,B.y2+=V[3]*b),P){const j=new C(B.x1,B.y1),Z=new C(B.x2,B.y1),Y=new C(B.x1,B.y2),se=new C(B.x2,B.y2),Ee=P*Math.PI/180;j._rotate(Ee),Z._rotate(Ee),Y._rotate(Ee),se._rotate(Ee),B.x1=Math.min(j.x,Z.x,Y.x,se.x),B.x2=Math.max(j.x,Z.x,Y.x,se.x),B.y1=Math.min(j.y,Z.y,Y.y,se.y),B.y2=Math.max(j.y,Z.y,Y.y,se.y)}t.emplaceBack(o.x,o.y,B.x1,B.y1,B.x2,B.y2,l,f,y)}this.boxEndIndex=t.length}}class xE{constructor(t=[],o=bE){if(this.data=t,this.length=this.data.length,this.compare=o,this.length>0)for(let l=(this.length>>1)-1;l>=0;l--)this._down(l)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const t=this.data[0],o=this.data.pop();return this.length--,this.length>0&&(this.data[0]=o,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:o,compare:l}=this,f=o[t];for(;t>0;){const y=t-1>>1,x=o[y];if(l(f,x)>=0)break;o[t]=x,t=y}o[t]=f}_down(t){const{data:o,compare:l}=this,f=this.length>>1,y=o[t];for(;t<f;){let x=1+(t<<1),b=o[x];const E=x+1;if(E<this.length&&l(o[E],b)<0&&(x=E,b=o[E]),l(b,y)>=0)break;o[t]=b,t=x}o[t]=y}}function bE(r,t){return r<t?-1:r>t?1:0}function wE(r,t=1,o=!1){let l=1/0,f=1/0,y=-1/0,x=-1/0;const b=r[0];for(let V=0;V<b.length;V++){const j=b[V];(!V||j.x<l)&&(l=j.x),(!V||j.y<f)&&(f=j.y),(!V||j.x>y)&&(y=j.x),(!V||j.y>x)&&(x=j.y)}const E=Math.min(y-l,x-f);let A=E/2;const P=new xE([],EE);if(E===0)return new C(l,f);for(let V=l;V<y;V+=E)for(let j=f;j<x;j+=E)P.push(new Kl(V+A,j+A,A,r));let D=function(V){let j=0,Z=0,Y=0;const se=V[0];for(let Ee=0,fe=se.length,xe=fe-1;Ee<fe;xe=Ee++){const ze=se[Ee],qe=se[xe],st=ze.x*qe.y-qe.x*ze.y;Z+=(ze.x+qe.x)*st,Y+=(ze.y+qe.y)*st,j+=3*st}return new Kl(Z/j,Y/j,0,V)}(r),B=P.length;for(;P.length;){const V=P.pop();(V.d>D.d||!D.d)&&(D=V,o&&console.log("found best %d after %d probes",Math.round(1e4*V.d)/1e4,B)),V.max-D.d<=t||(A=V.h/2,P.push(new Kl(V.p.x-A,V.p.y-A,A,r)),P.push(new Kl(V.p.x+A,V.p.y-A,A,r)),P.push(new Kl(V.p.x-A,V.p.y+A,A,r)),P.push(new Kl(V.p.x+A,V.p.y+A,A,r)),B+=4)}return o&&(console.log(`num probes: ${B}`),console.log(`best distance: ${D.d}`)),D.p}function EE(r,t){return t.max-r.max}function Kl(r,t,o,l){this.p=new C(r,t),this.h=o,this.d=function(f,y){let x=!1,b=1/0;for(let E=0;E<y.length;E++){const A=y[E];for(let P=0,D=A.length,B=D-1;P<D;B=P++){const V=A[P],j=A[B];V.y>f.y!=j.y>f.y&&f.x<(j.x-V.x)*(f.y-V.y)/(j.y-V.y)+V.x&&(x=!x),b=Math.min(b,Ny(f,V,j))}}return(x?1:-1)*Math.sqrt(b)}(this.p,l),this.max=this.d+this.h*Math.SQRT2}var zr;m.aq=void 0,(zr=m.aq||(m.aq={}))[zr.center=1]="center",zr[zr.left=2]="left",zr[zr.right=3]="right",zr[zr.top=4]="top",zr[zr.bottom=5]="bottom",zr[zr["top-left"]=6]="top-left",zr[zr["top-right"]=7]="top-right",zr[zr["bottom-left"]=8]="bottom-left",zr[zr["bottom-right"]=9]="bottom-right";const $s=7,Yp=Number.POSITIVE_INFINITY;function n0(r,t){return t[1]!==Yp?function(o,l,f){let y=0,x=0;switch(l=Math.abs(l),f=Math.abs(f),o){case"top-right":case"top-left":case"top":x=f-$s;break;case"bottom-right":case"bottom-left":case"bottom":x=-f+$s}switch(o){case"top-right":case"bottom-right":case"right":y=-l;break;case"top-left":case"bottom-left":case"left":y=l}return[y,x]}(r,t[0],t[1]):function(o,l){let f=0,y=0;l<0&&(l=0);const x=l/Math.SQRT2;switch(o){case"top-right":case"top-left":y=x-$s;break;case"bottom-right":case"bottom-left":y=-x+$s;break;case"bottom":y=-l+$s;break;case"top":y=l-$s}switch(o){case"top-right":case"bottom-right":f=-x;break;case"top-left":case"bottom-left":f=x;break;case"left":f=l;break;case"right":f=-l}return[f,y]}(r,t[0])}function o0(r,t,o){var l;const f=r.layout,y=(l=f.get("text-variable-anchor-offset"))===null||l===void 0?void 0:l.evaluate(t,{},o);if(y){const b=y.values,E=[];for(let A=0;A<b.length;A+=2){const P=E[A]=b[A],D=b[A+1].map(B=>B*dr);P.startsWith("top")?D[1]-=$s:P.startsWith("bottom")&&(D[1]+=$s),E[A+1]=D}return new Yr(E)}const x=f.get("text-variable-anchor");if(x){let b;b=r._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[f.get("text-radial-offset").evaluate(t,{},o)*dr,Yp]:f.get("text-offset").evaluate(t,{},o).map(A=>A*dr);const E=[];for(const A of x)E.push(A,n0(A,b));return new Yr(E)}return null}function Qp(r){switch(r){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function SE(r,t,o,l,f,y,x,b,E,A,P){let D=y.textMaxSize.evaluate(t,{});D===void 0&&(D=x);const B=r.layers[0].layout,V=B.get("icon-offset").evaluate(t,{},P),j=a0(o.horizontal),Z=x/24,Y=r.tilePixelRatio*Z,se=r.tilePixelRatio*D/24,Ee=r.tilePixelRatio*b,fe=r.tilePixelRatio*B.get("symbol-spacing"),xe=B.get("text-padding")*r.tilePixelRatio,ze=function(Fe,Et,vt,zt=1){const xi=Fe.get("icon-padding").evaluate(Et,{},vt),yi=xi&&xi.values;return[yi[0]*zt,yi[1]*zt,yi[2]*zt,yi[3]*zt]}(B,t,P,r.tilePixelRatio),qe=B.get("text-max-angle")/180*Math.PI,st=B.get("text-rotation-alignment")!=="viewport"&&B.get("symbol-placement")!=="point",Ct=B.get("icon-rotation-alignment")==="map"&&B.get("symbol-placement")!=="point",lt=B.get("symbol-placement"),ot=fe/2,bt=B.get("icon-text-fit");let gt;l&&bt!=="none"&&(r.allowVerticalPlacement&&o.vertical&&(gt=M_(l,o.vertical,bt,B.get("icon-text-fit-padding"),V,Z)),j&&(l=M_(l,j,bt,B.get("icon-text-fit-padding"),V,Z)));const ft=(Fe,Et)=>{Et.x<0||Et.x>=or||Et.y<0||Et.y>=or||function(vt,zt,xi,yi,_r,Gn,Dr,Xi,rn,nn,on,Ji,vr,$r,Rr,sn,Or,Mn,gn,si,Ei,Mi,bn,qi,Xl){const Co=vt.addToLineVertexArray(zt,xi);let Ao,Zn,Ln,Sr,rs=0,Mu=0,h0=0,d0=0,am=-1,lm=-1;const ns={};let f0=Fl("");if(vt.allowVerticalPlacement&&yi.vertical){const jr=Xi.layout.get("text-rotate").evaluate(Ei,{},qi)+90;Ln=new Id(rn,zt,nn,on,Ji,yi.vertical,vr,$r,Rr,jr),Dr&&(Sr=new Id(rn,zt,nn,on,Ji,Dr,Or,Mn,Rr,jr))}if(_r){const jr=Xi.layout.get("icon-rotate").evaluate(Ei,{}),Pn=Xi.layout.get("icon-text-fit")!=="none",Oa=i0(_r,jr,bn,Pn),ho=Dr?i0(Dr,jr,bn,Pn):void 0;Zn=new Id(rn,zt,nn,on,Ji,_r,Or,Mn,!1,jr),rs=4*Oa.length;const Ba=vt.iconSizeData;let ko=null;Ba.kind==="source"?(ko=[To*Xi.layout.get("icon-size").evaluate(Ei,{})],ko[0]>Fs&&Oe(`${vt.layerIds[0]}: Value for "icon-size" is >= ${Tu}. Reduce your "icon-size".`)):Ba.kind==="composite"&&(ko=[To*Mi.compositeIconSizes[0].evaluate(Ei,{},qi),To*Mi.compositeIconSizes[1].evaluate(Ei,{},qi)],(ko[0]>Fs||ko[1]>Fs)&&Oe(`${vt.layerIds[0]}: Value for "icon-size" is >= ${Tu}. Reduce your "icon-size".`)),vt.addSymbols(vt.icon,Oa,ko,si,gn,Ei,m.ah.none,zt,Co.lineStartIndex,Co.lineLength,-1,qi),am=vt.icon.placedSymbolArray.length-1,ho&&(Mu=4*ho.length,vt.addSymbols(vt.icon,ho,ko,si,gn,Ei,m.ah.vertical,zt,Co.lineStartIndex,Co.lineLength,-1,qi),lm=vt.icon.placedSymbolArray.length-1)}const p0=Object.keys(yi.horizontal);for(const jr of p0){const Pn=yi.horizontal[jr];if(!Ao){f0=Fl(Pn.text);const ho=Xi.layout.get("text-rotate").evaluate(Ei,{},qi);Ao=new Id(rn,zt,nn,on,Ji,Pn,vr,$r,Rr,ho)}const Oa=Pn.positionedLines.length===1;if(h0+=s0(vt,zt,Pn,Gn,Xi,Rr,Ei,sn,Co,yi.vertical?m.ah.horizontal:m.ah.horizontalOnly,Oa?p0:[jr],ns,am,Mi,qi),Oa)break}yi.vertical&&(d0+=s0(vt,zt,yi.vertical,Gn,Xi,Rr,Ei,sn,Co,m.ah.vertical,["vertical"],ns,lm,Mi,qi));const CE=Ao?Ao.boxStartIndex:vt.collisionBoxArray.length,AE=Ao?Ao.boxEndIndex:vt.collisionBoxArray.length,kE=Ln?Ln.boxStartIndex:vt.collisionBoxArray.length,ME=Ln?Ln.boxEndIndex:vt.collisionBoxArray.length,LE=Zn?Zn.boxStartIndex:vt.collisionBoxArray.length,PE=Zn?Zn.boxEndIndex:vt.collisionBoxArray.length,zE=Sr?Sr.boxStartIndex:vt.collisionBoxArray.length,DE=Sr?Sr.boxEndIndex:vt.collisionBoxArray.length;let uo=-1;const Cd=(jr,Pn)=>jr&&jr.circleDiameter?Math.max(jr.circleDiameter,Pn):Pn;uo=Cd(Ao,uo),uo=Cd(Ln,uo),uo=Cd(Zn,uo),uo=Cd(Sr,uo);const m0=uo>-1?1:0;m0&&(uo*=Xl/dr),vt.glyphOffsetArray.length>=Zl.MAX_GLYPHS&&Oe("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Ei.sortKey!==void 0&&vt.addToSortKeyRanges(vt.symbolInstances.length,Ei.sortKey);const RE=o0(Xi,Ei,qi),[OE,BE]=function(jr,Pn){const Oa=jr.length,ho=Pn==null?void 0:Pn.values;if((ho==null?void 0:ho.length)>0)for(let Ba=0;Ba<ho.length;Ba+=2){const ko=ho[Ba+1];jr.emplaceBack(m.aq[ho[Ba]],ko[0],ko[1])}return[Oa,jr.length]}(vt.textAnchorOffsets,RE);vt.symbolInstances.emplaceBack(zt.x,zt.y,ns.right>=0?ns.right:-1,ns.center>=0?ns.center:-1,ns.left>=0?ns.left:-1,ns.vertical||-1,am,lm,f0,CE,AE,kE,ME,LE,PE,zE,DE,nn,h0,d0,rs,Mu,m0,0,vr,uo,OE,BE)}(r,Et,Fe,o,l,f,gt,r.layers[0],r.collisionBoxArray,t.index,t.sourceLayerIndex,r.index,Y,[xe,xe,xe,xe],st,E,Ee,ze,Ct,V,t,y,A,P,x)};if(lt==="line")for(const Fe of X_(t.geometry,0,0,or,or)){const Et=vE(Fe,fe,qe,o.vertical||j,l,24,se,r.overscaling,or);for(const vt of Et)j&&IE(r,j.text,ot,vt)||ft(Fe,vt)}else if(lt==="line-center"){for(const Fe of t.geometry)if(Fe.length>1){const Et=_E(Fe,qe,o.vertical||j,l,24,se);Et&&ft(Fe,Et)}}else if(t.type==="Polygon")for(const Fe of dl(t.geometry,0)){const Et=wE(Fe,16);ft(Fe[0],new Ns(Et.x,Et.y,0))}else if(t.type==="LineString")for(const Fe of t.geometry)ft(Fe,new Ns(Fe[0].x,Fe[0].y,0));else if(t.type==="Point")for(const Fe of t.geometry)for(const Et of Fe)ft([Et],new Ns(Et.x,Et.y,0))}function s0(r,t,o,l,f,y,x,b,E,A,P,D,B,V,j){const Z=function(Ee,fe,xe,ze,qe,st,Ct,lt){const ot=ze.layout.get("text-rotate").evaluate(st,{})*Math.PI/180,bt=[];for(const gt of fe.positionedLines)for(const ft of gt.positionedGlyphs){if(!ft.rect)continue;const Fe=ft.rect||{};let Et=w_+1,vt=!0,zt=1,xi=0;const yi=(qe||lt)&&ft.vertical,_r=ft.metrics.advance*ft.scale/2;if(lt&&fe.verticalizable&&(xi=gt.lineOffset/2-(ft.imageName?-(dr-ft.metrics.width*ft.scale)/2:(ft.scale-1)*dr)),ft.imageName){const si=Ct[ft.imageName];vt=si.sdf,zt=si.pixelRatio,Et=mn/zt}const Gn=qe?[ft.x+_r,ft.y]:[0,0];let Dr=qe?[0,0]:[ft.x+_r+xe[0],ft.y+xe[1]-xi],Xi=[0,0];yi&&(Xi=Dr,Dr=[0,0]);const rn=ft.metrics.isDoubleResolution?2:1,nn=(ft.metrics.left-Et)*ft.scale-_r+Dr[0],on=(-ft.metrics.top-Et)*ft.scale+Dr[1],Ji=nn+Fe.w/rn*ft.scale/zt,vr=on+Fe.h/rn*ft.scale/zt,$r=new C(nn,on),Rr=new C(Ji,on),sn=new C(nn,vr),Or=new C(Ji,vr);if(yi){const si=new C(-_r,_r-Su),Ei=-Math.PI/2,Mi=dr/2-_r,bn=new C(5-Su-Mi,-(ft.imageName?Mi:0)),qi=new C(...Xi);$r._rotateAround(Ei,si)._add(bn)._add(qi),Rr._rotateAround(Ei,si)._add(bn)._add(qi),sn._rotateAround(Ei,si)._add(bn)._add(qi),Or._rotateAround(Ei,si)._add(bn)._add(qi)}if(ot){const si=Math.sin(ot),Ei=Math.cos(ot),Mi=[Ei,-si,si,Ei];$r._matMult(Mi),Rr._matMult(Mi),sn._matMult(Mi),Or._matMult(Mi)}const Mn=new C(0,0),gn=new C(0,0);bt.push({tl:$r,tr:Rr,bl:sn,br:Or,tex:Fe,writingMode:fe.writingMode,glyphOffset:Gn,sectionIndex:ft.sectionIndex,isSDF:vt,pixelOffsetTL:Mn,pixelOffsetBR:gn,minFontScaleX:0,minFontScaleY:0})}return bt}(0,o,b,f,y,x,l,r.allowVerticalPlacement),Y=r.textSizeData;let se=null;Y.kind==="source"?(se=[To*f.layout.get("text-size").evaluate(x,{})],se[0]>Fs&&Oe(`${r.layerIds[0]}: Value for "text-size" is >= ${Tu}. Reduce your "text-size".`)):Y.kind==="composite"&&(se=[To*V.compositeTextSizes[0].evaluate(x,{},j),To*V.compositeTextSizes[1].evaluate(x,{},j)],(se[0]>Fs||se[1]>Fs)&&Oe(`${r.layerIds[0]}: Value for "text-size" is >= ${Tu}. Reduce your "text-size".`)),r.addSymbols(r.text,Z,se,b,y,x,A,t,E.lineStartIndex,E.lineLength,B,j);for(const Ee of P)D[Ee]=r.text.placedSymbolArray.length-1;return 4*Z.length}function a0(r){for(const t in r)return r[t];return null}function IE(r,t,o,l){const f=r.compareText;if(t in f){const y=f[t];for(let x=y.length-1;x>=0;x--)if(l.dist(y[x])<o)return!0}else f[t]=[];return f[t].push(l),!1}const l0=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class em{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[o,l]=new Uint8Array(t,0,2);if(o!==219)throw new Error("Data does not appear to be in a KDBush format.");const f=l>>4;if(f!==1)throw new Error(`Got v${f} data when expected v1.`);const y=l0[15&l];if(!y)throw new Error("Unrecognized array type.");const[x]=new Uint16Array(t,2,1),[b]=new Uint32Array(t,4,1);return new em(b,x,y,t)}constructor(t,o=64,l=Float64Array,f){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+o,2),65535),this.ArrayType=l,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const y=l0.indexOf(this.ArrayType),x=2*t*this.ArrayType.BYTES_PER_ELEMENT,b=t*this.IndexArrayType.BYTES_PER_ELEMENT,E=(8-b%8)%8;if(y<0)throw new Error(`Unexpected typed array class: ${l}.`);f&&f instanceof ArrayBuffer?(this.data=f,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+b+E,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+x+b+E),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+b+E,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+y]),new Uint16Array(this.data,2,1)[0]=o,new Uint32Array(this.data,4,1)[0]=t)}add(t,o){const l=this._pos>>1;return this.ids[l]=l,this.coords[this._pos++]=t,this.coords[this._pos++]=o,l}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return tm(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,o,l,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:y,coords:x,nodeSize:b}=this,E=[0,y.length-1,0],A=[];for(;E.length;){const P=E.pop()||0,D=E.pop()||0,B=E.pop()||0;if(D-B<=b){for(let Y=B;Y<=D;Y++){const se=x[2*Y],Ee=x[2*Y+1];se>=t&&se<=l&&Ee>=o&&Ee<=f&&A.push(y[Y])}continue}const V=B+D>>1,j=x[2*V],Z=x[2*V+1];j>=t&&j<=l&&Z>=o&&Z<=f&&A.push(y[V]),(P===0?t<=j:o<=Z)&&(E.push(B),E.push(V-1),E.push(1-P)),(P===0?l>=j:f>=Z)&&(E.push(V+1),E.push(D),E.push(1-P))}return A}within(t,o,l){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:f,coords:y,nodeSize:x}=this,b=[0,f.length-1,0],E=[],A=l*l;for(;b.length;){const P=b.pop()||0,D=b.pop()||0,B=b.pop()||0;if(D-B<=x){for(let Y=B;Y<=D;Y++)u0(y[2*Y],y[2*Y+1],t,o)<=A&&E.push(f[Y]);continue}const V=B+D>>1,j=y[2*V],Z=y[2*V+1];u0(j,Z,t,o)<=A&&E.push(f[V]),(P===0?t-l<=j:o-l<=Z)&&(b.push(B),b.push(V-1),b.push(1-P)),(P===0?t+l>=j:o+l>=Z)&&(b.push(V+1),b.push(D),b.push(1-P))}return E}}function tm(r,t,o,l,f,y){if(f-l<=o)return;const x=l+f>>1;c0(r,t,x,l,f,y),tm(r,t,o,l,x-1,1-y),tm(r,t,o,x+1,f,1-y)}function c0(r,t,o,l,f,y){for(;f>l;){if(f-l>600){const A=f-l+1,P=o-l+1,D=Math.log(A),B=.5*Math.exp(2*D/3),V=.5*Math.sqrt(D*B*(A-B)/A)*(P-A/2<0?-1:1);c0(r,t,o,Math.max(l,Math.floor(o-P*B/A+V)),Math.min(f,Math.floor(o+(A-P)*B/A+V)),y)}const x=t[2*o+y];let b=l,E=f;for(Au(r,t,l,o),t[2*f+y]>x&&Au(r,t,l,f);b<E;){for(Au(r,t,b,E),b++,E--;t[2*b+y]<x;)b++;for(;t[2*E+y]>x;)E--}t[2*l+y]===x?Au(r,t,l,E):(E++,Au(r,t,E,f)),E<=o&&(l=E+1),o<=E&&(f=E-1)}}function Au(r,t,o,l){im(r,o,l),im(t,2*o,2*l),im(t,2*o+1,2*l+1)}function im(r,t,o){const l=r[t];r[t]=r[o],r[o]=l}function u0(r,t,o,l){const f=r-o,y=t-l;return f*f+y*y}var rm;m.be=void 0,(rm=m.be||(m.be={})).create="create",rm.load="load",rm.fullLoad="fullLoad";let Td=null,ku=[];const nm=1e3/60,om="loadTime",sm="fullLoadTime",TE={mark(r){performance.mark(r)},frame(r){const t=r;Td!=null&&ku.push(t-Td),Td=t},clearMetrics(){Td=null,ku=[],performance.clearMeasures(om),performance.clearMeasures(sm);for(const r in m.be)performance.clearMarks(m.be[r])},getPerformanceMetrics(){performance.measure(om,m.be.create,m.be.load),performance.measure(sm,m.be.create,m.be.fullLoad);const r=performance.getEntriesByName(om)[0].duration,t=performance.getEntriesByName(sm)[0].duration,o=ku.length,l=1/(ku.reduce((y,x)=>y+x,0)/o/1e3),f=ku.filter(y=>y>nm).reduce((y,x)=>y+(x-nm)/nm,0);return{loadTime:r,fullLoadTime:t,fps:l,percentDroppedFrames:f/(o+f)*100,totalFrames:o}}};m.$=hr,m.A=$l,m.B=function(r){if(Ke==null){const t=r.navigator?r.navigator.userAgent:null;Ke=!!r.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return Ke},m.C=class{constructor(r,t){this.target=r,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new gE(()=>this.process()),this.subscription=function(o,l,f,y){return o.addEventListener(l,f,!1),{unsubscribe:()=>{o.removeEventListener(l,f,!1)}}}(this.target,"message",o=>this.receive(o)),this.globalScope=rt(self)?r:window}registerMessageHandler(r,t){this.messageHandlers[r]=t}sendAsync(r,t){return new Promise((o,l)=>{const f=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[f]={resolve:o,reject:l},t&&t.signal.addEventListener("abort",()=>{delete this.resolveRejects[f];const b={id:f,type:"<cancel>",origin:location.origin,targetMapId:r.targetMapId,sourceMapId:this.mapId};this.target.postMessage(b)},{once:!0});const y=[],x=Object.assign(Object.assign({},r),{id:f,sourceMapId:this.mapId,origin:location.origin,data:ka(r.data,y)});this.target.postMessage(x,{transfer:y})})}receive(r){const t=r.data,o=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[o];const l=this.abortControllers[o];return delete this.abortControllers[o],void(l&&l.abort())}if(rt(self)||t.mustQueue)return this.tasks[o]=t,this.taskQueue.push(o),void this.invoker.trigger();this.processTask(o,t)}}process(){if(this.taskQueue.length===0)return;const r=this.taskQueue.shift(),t=this.tasks[r];delete this.tasks[r],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(r,t)}processTask(r,t){return c(this,void 0,void 0,function*(){if(t.type==="<response>"){const f=this.resolveRejects[r];return delete this.resolveRejects[r],f?void(t.error?f.reject(qn(t.error)):f.resolve(qn(t.data))):void 0}if(!this.messageHandlers[t.type])return void this.completeTask(r,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const o=qn(t.data),l=new AbortController;this.abortControllers[r]=l;try{const f=yield this.messageHandlers[t.type](t.sourceMapId,o,l);this.completeTask(r,null,f)}catch(f){this.completeTask(r,f)}})}completeTask(r,t,o){const l=[];delete this.abortControllers[r];const f={id:r,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?ka(t):null,data:ka(o,l)};this.target.postMessage(f,{transfer:l})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},m.D=wt,m.E=Be,m.F=function(){var r=new $l(16);return $l!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r},m.G=fi,m.H=function(r,t,o){var l,f,y,x,b,E,A,P,D,B,V,j,Z=o[0],Y=o[1],se=o[2];return t===r?(r[12]=t[0]*Z+t[4]*Y+t[8]*se+t[12],r[13]=t[1]*Z+t[5]*Y+t[9]*se+t[13],r[14]=t[2]*Z+t[6]*Y+t[10]*se+t[14],r[15]=t[3]*Z+t[7]*Y+t[11]*se+t[15]):(f=t[1],y=t[2],x=t[3],b=t[4],E=t[5],A=t[6],P=t[7],D=t[8],B=t[9],V=t[10],j=t[11],r[0]=l=t[0],r[1]=f,r[2]=y,r[3]=x,r[4]=b,r[5]=E,r[6]=A,r[7]=P,r[8]=D,r[9]=B,r[10]=V,r[11]=j,r[12]=l*Z+b*Y+D*se+t[12],r[13]=f*Z+E*Y+B*se+t[13],r[14]=y*Z+A*Y+V*se+t[14],r[15]=x*Z+P*Y+j*se+t[15]),r},m.I=$p,m.J=function(r,t,o){var l=o[0],f=o[1],y=o[2];return r[0]=t[0]*l,r[1]=t[1]*l,r[2]=t[2]*l,r[3]=t[3]*l,r[4]=t[4]*f,r[5]=t[5]*f,r[6]=t[6]*f,r[7]=t[7]*f,r[8]=t[8]*y,r[9]=t[9]*y,r[10]=t[10]*y,r[11]=t[11]*y,r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r},m.K=qy,m.L=function(r,t){const o={};for(let l=0;l<t.length;l++){const f=t[l];f in r&&(o[f]=r[f])}return o},m.M=Vs,m.N=V_,m.O=N_,m.P=C,m.Q=kn,m.R=An,m.S=Ie,m.T=Ms,m.U=ee,m.V=ti,m.W=or,m.X=z,m.Y=bd,m.Z=class extends G{},m._=c,m.a=Qi,m.a$=function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r},m.a0=Jp,m.a1=$e,m.a2=r=>{const t=window.document.createElement("video");return t.muted=!0,new Promise(o=>{t.onloadstart=()=>{o(t)};for(const l of r){const f=window.document.createElement("source");pr(l)||(t.crossOrigin="Anonymous"),f.src=l,t.appendChild(f)}})},m.a3=function(){return be++},m.a4=Wt,m.a5=Zl,m.a6=Wc,m.a7=Da,m.a8=wi,m.a9=G_,m.aA=function(r){if(r.type==="custom")return new mE(r);switch(r.type){case"background":return new dE(r);case"circle":return new Qw(r);case"fill":return new g2(r);case"fill-extrusion":return new L2(r);case"heatmap":return new t2(r);case"hillshade":return new r2(r);case"line":return new V2(r);case"raster":return new pE(r);case"symbol":return new xd(r)}},m.aB=ke,m.aC=function(r,t){if(!r)return[{command:"setStyle",args:[t]}];let o=[];try{if(!Ze(r.version,t.version))return[{command:"setStyle",args:[t]}];Ze(r.center,t.center)||o.push({command:"setCenter",args:[t.center]}),Ze(r.zoom,t.zoom)||o.push({command:"setZoom",args:[t.zoom]}),Ze(r.bearing,t.bearing)||o.push({command:"setBearing",args:[t.bearing]}),Ze(r.pitch,t.pitch)||o.push({command:"setPitch",args:[t.pitch]}),Ze(r.sprite,t.sprite)||o.push({command:"setSprite",args:[t.sprite]}),Ze(r.glyphs,t.glyphs)||o.push({command:"setGlyphs",args:[t.glyphs]}),Ze(r.transition,t.transition)||o.push({command:"setTransition",args:[t.transition]}),Ze(r.light,t.light)||o.push({command:"setLight",args:[t.light]}),Ze(r.terrain,t.terrain)||o.push({command:"setTerrain",args:[t.terrain]}),Ze(r.sky,t.sky)||o.push({command:"setSky",args:[t.sky]}),Ze(r.projection,t.projection)||o.push({command:"setProjection",args:[t.projection]});const l={},f=[];(function(x,b,E,A){let P;for(P in b=b||{},x=x||{})Object.prototype.hasOwnProperty.call(x,P)&&(Object.prototype.hasOwnProperty.call(b,P)||We(P,E,A));for(P in b)Object.prototype.hasOwnProperty.call(b,P)&&(Object.prototype.hasOwnProperty.call(x,P)?Ze(x[P],b[P])||(x[P].type==="geojson"&&b[P].type==="geojson"&&It(x,b,P)?je(E,{command:"setGeoJSONSourceData",args:[P,b[P].data]}):pt(P,b,E,A)):Qe(P,b,E))})(r.sources,t.sources,f,l);const y=[];r.layers&&r.layers.forEach(x=>{"source"in x&&l[x.source]?o.push({command:"removeLayer",args:[x.id]}):y.push(x)}),o=o.concat(f),function(x,b,E){b=b||[];const A=(x=x||[]).map(Lt),P=b.map(Lt),D=x.reduce(Ht,{}),B=b.reduce(Ht,{}),V=A.slice(),j=Object.create(null);let Z,Y,se,Ee,fe;for(let xe=0,ze=0;xe<A.length;xe++)Z=A[xe],Object.prototype.hasOwnProperty.call(B,Z)?ze++:(je(E,{command:"removeLayer",args:[Z]}),V.splice(V.indexOf(Z,ze),1));for(let xe=0,ze=0;xe<P.length;xe++)Z=P[P.length-1-xe],V[V.length-1-xe]!==Z&&(Object.prototype.hasOwnProperty.call(D,Z)?(je(E,{command:"removeLayer",args:[Z]}),V.splice(V.lastIndexOf(Z,V.length-ze),1)):ze++,Ee=V[V.length-xe],je(E,{command:"addLayer",args:[B[Z],Ee]}),V.splice(V.length-xe,0,Z),j[Z]=!0);for(let xe=0;xe<P.length;xe++)if(Z=P[xe],Y=D[Z],se=B[Z],!j[Z]&&!Ze(Y,se))if(Ze(Y.source,se.source)&&Ze(Y["source-layer"],se["source-layer"])&&Ze(Y.type,se.type)){for(fe in xt(Y.layout,se.layout,E,Z,null,"setLayoutProperty"),xt(Y.paint,se.paint,E,Z,null,"setPaintProperty"),Ze(Y.filter,se.filter)||je(E,{command:"setFilter",args:[Z,se.filter]}),Ze(Y.minzoom,se.minzoom)&&Ze(Y.maxzoom,se.maxzoom)||je(E,{command:"setLayerZoomRange",args:[Z,se.minzoom,se.maxzoom]}),Y)Object.prototype.hasOwnProperty.call(Y,fe)&&fe!=="layout"&&fe!=="paint"&&fe!=="filter"&&fe!=="metadata"&&fe!=="minzoom"&&fe!=="maxzoom"&&(fe.indexOf("paint.")===0?xt(Y[fe],se[fe],E,Z,fe.slice(6),"setPaintProperty"):Ze(Y[fe],se[fe])||je(E,{command:"setLayerProperty",args:[Z,fe,se[fe]]}));for(fe in se)Object.prototype.hasOwnProperty.call(se,fe)&&!Object.prototype.hasOwnProperty.call(Y,fe)&&fe!=="layout"&&fe!=="paint"&&fe!=="filter"&&fe!=="metadata"&&fe!=="minzoom"&&fe!=="maxzoom"&&(fe.indexOf("paint.")===0?xt(Y[fe],se[fe],E,Z,fe.slice(6),"setPaintProperty"):Ze(Y[fe],se[fe])||je(E,{command:"setLayerProperty",args:[Z,fe,se[fe]]}))}else je(E,{command:"removeLayer",args:[Z]}),Ee=V[V.lastIndexOf(Z)+1],je(E,{command:"addLayer",args:[se,Ee]})}(y,t.layers,o)}catch(l){console.warn("Unable to compute style diff:",l),o=[{command:"setStyle",args:[t]}]}return o},m.aD=function(r){const t=[],o=r.id;return o===void 0&&t.push({message:`layers.${o}: missing required property "id"`}),r.render===void 0&&t.push({message:`layers.${o}: missing required method "render"`}),r.renderingMode&&r.renderingMode!=="2d"&&r.renderingMode!=="3d"&&t.push({message:`layers.${o}: property "renderingMode" must be either "2d" or "3d"`}),t},m.aE=function r(t,o){if(Array.isArray(t)){if(!Array.isArray(o)||t.length!==o.length)return!1;for(let l=0;l<t.length;l++)if(!r(t[l],o[l]))return!1;return!0}if(typeof t=="object"&&t!==null&&o!==null){if(typeof o!="object"||Object.keys(t).length!==Object.keys(o).length)return!1;for(const l in t)if(!r(t[l],o[l]))return!1;return!0}return t===o},m.aF=Le,m.aG=me,m.aH=class extends La{constructor(r,t){super(r,t),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))}},m.aI=sd,m.aJ=class extends La{constructor(r,t){super(r,t),this.current=Hw}set(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(let t=1;t<16;t++)if(r[t]!==this.current[t]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}}},m.aK=zy,m.aL=class extends La{constructor(r,t){super(r,t),this.current=[0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))}},m.aM=class extends La{constructor(r,t){super(r,t),this.current=[0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))}},m.aN=Dy,m.aO=function(r,t,o,l,f,y,x){var b=1/(t-o),E=1/(l-f),A=1/(y-x);return r[0]=-2*b,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*E,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*A,r[11]=0,r[12]=(t+o)*b,r[13]=(f+l)*E,r[14]=(x+y)*A,r[15]=1,r},m.aP=di,m.aQ=Yw,m.aR=class extends Ne{},m.aS=U2,m.aT=class extends ut{},m.aU=function(r){return r<=1?1:Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))},m.aV=Ky,m.aW=Qo,m.aX=class extends at{},m.aY=yr,m.aZ=function(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]&&r[3]===t[3]&&r[4]===t[4]&&r[5]===t[5]&&r[6]===t[6]&&r[7]===t[7]&&r[8]===t[8]&&r[9]===t[9]&&r[10]===t[10]&&r[11]===t[11]&&r[12]===t[12]&&r[13]===t[13]&&r[14]===t[14]&&r[15]===t[15]},m.a_=function(r,t){var o=r[0],l=r[1],f=r[2],y=r[3],x=r[4],b=r[5],E=r[6],A=r[7],P=r[8],D=r[9],B=r[10],V=r[11],j=r[12],Z=r[13],Y=r[14],se=r[15],Ee=t[0],fe=t[1],xe=t[2],ze=t[3],qe=t[4],st=t[5],Ct=t[6],lt=t[7],ot=t[8],bt=t[9],gt=t[10],ft=t[11],Fe=t[12],Et=t[13],vt=t[14],zt=t[15];return Math.abs(o-Ee)<=tn*Math.max(1,Math.abs(o),Math.abs(Ee))&&Math.abs(l-fe)<=tn*Math.max(1,Math.abs(l),Math.abs(fe))&&Math.abs(f-xe)<=tn*Math.max(1,Math.abs(f),Math.abs(xe))&&Math.abs(y-ze)<=tn*Math.max(1,Math.abs(y),Math.abs(ze))&&Math.abs(x-qe)<=tn*Math.max(1,Math.abs(x),Math.abs(qe))&&Math.abs(b-st)<=tn*Math.max(1,Math.abs(b),Math.abs(st))&&Math.abs(E-Ct)<=tn*Math.max(1,Math.abs(E),Math.abs(Ct))&&Math.abs(A-lt)<=tn*Math.max(1,Math.abs(A),Math.abs(lt))&&Math.abs(P-ot)<=tn*Math.max(1,Math.abs(P),Math.abs(ot))&&Math.abs(D-bt)<=tn*Math.max(1,Math.abs(D),Math.abs(bt))&&Math.abs(B-gt)<=tn*Math.max(1,Math.abs(B),Math.abs(gt))&&Math.abs(V-ft)<=tn*Math.max(1,Math.abs(V),Math.abs(ft))&&Math.abs(j-Fe)<=tn*Math.max(1,Math.abs(j),Math.abs(Fe))&&Math.abs(Z-Et)<=tn*Math.max(1,Math.abs(Z),Math.abs(Et))&&Math.abs(Y-vt)<=tn*Math.max(1,Math.abs(Y),Math.abs(vt))&&Math.abs(se-zt)<=tn*Math.max(1,Math.abs(se),Math.abs(zt))},m.aa=function(r){const t={};if(r.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(o,l,f,y)=>{const x=f||y;return t[l]=!x||x.toLowerCase(),""}),t["max-age"]){const o=parseInt(t["max-age"],10);isNaN(o)?delete t["max-age"]:t["max-age"]=o}return t},m.ab=function(r,t){const o=[];for(const l in r)l in t||o.push(l);return o},m.ac=ne,m.ad=function(r,t,o){var l=Math.sin(o),f=Math.cos(o),y=t[0],x=t[1],b=t[2],E=t[3],A=t[4],P=t[5],D=t[6],B=t[7];return t!==r&&(r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[0]=y*f+A*l,r[1]=x*f+P*l,r[2]=b*f+D*l,r[3]=E*f+B*l,r[4]=A*f-y*l,r[5]=P*f-x*l,r[6]=D*f-b*l,r[7]=B*f-E*l,r},m.ae=function(r){var t=new $l(16);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t},m.af=ud,m.ag=function(r,t){let o=0,l=0;if(r.kind==="constant")l=r.layoutSize;else if(r.kind!=="source"){const{interpolationType:f,minZoom:y,maxZoom:x}=r,b=f?ne(hn.interpolationFactor(f,t,y,x),0,1):0;r.kind==="camera"?l=Vr.number(r.minSize,r.maxSize,b):o=b}return{uSizeT:o,uSize:l}},m.ai=function(r,{uSize:t,uSizeT:o},{lowerSize:l,upperSize:f}){return r.kind==="source"?l/To:r.kind==="composite"?Vr.number(l/To,f/To,o):t},m.aj=Hp,m.ak=function(r,t,o,l){const f=t.y-r.y,y=t.x-r.x,x=l.y-o.y,b=l.x-o.x,E=x*y-b*f;if(E===0)return null;const A=(b*(r.y-o.y)-x*(r.x-o.x))/E;return new C(r.x+A*y,r.y+A*f)},m.al=X_,m.am=Fy,m.an=Ip,m.ao=function(r){let t=1/0,o=1/0,l=-1/0,f=-1/0;for(const y of r)t=Math.min(t,y.x),o=Math.min(o,y.y),l=Math.max(l,y.x),f=Math.max(f,y.y);return[t,o,l,f]},m.ap=dr,m.ar=qp,m.as=function(r,t){var o=t[0],l=t[1],f=t[2],y=t[3],x=t[4],b=t[5],E=t[6],A=t[7],P=t[8],D=t[9],B=t[10],V=t[11],j=t[12],Z=t[13],Y=t[14],se=t[15],Ee=o*b-l*x,fe=o*E-f*x,xe=o*A-y*x,ze=l*E-f*b,qe=l*A-y*b,st=f*A-y*E,Ct=P*Z-D*j,lt=P*Y-B*j,ot=P*se-V*j,bt=D*Y-B*Z,gt=D*se-V*Z,ft=B*se-V*Y,Fe=Ee*ft-fe*gt+xe*bt+ze*ot-qe*lt+st*Ct;return Fe?(r[0]=(b*ft-E*gt+A*bt)*(Fe=1/Fe),r[1]=(f*gt-l*ft-y*bt)*Fe,r[2]=(Z*st-Y*qe+se*ze)*Fe,r[3]=(B*qe-D*st-V*ze)*Fe,r[4]=(E*ot-x*ft-A*lt)*Fe,r[5]=(o*ft-f*ot+y*lt)*Fe,r[6]=(Y*xe-j*st-se*fe)*Fe,r[7]=(P*st-B*xe+V*fe)*Fe,r[8]=(x*gt-b*ot+A*Ct)*Fe,r[9]=(l*ot-o*gt-y*Ct)*Fe,r[10]=(j*qe-Z*xe+se*Ee)*Fe,r[11]=(D*xe-P*qe-V*Ee)*Fe,r[12]=(b*lt-x*bt-E*Ct)*Fe,r[13]=(o*bt-l*lt+f*Ct)*Fe,r[14]=(Z*fe-j*ze-Y*Ee)*Fe,r[15]=(P*ze-D*fe+B*Ee)*Fe,r):null},m.at=Qp,m.au=Up,m.av=em,m.aw=function(){const r={},t=le.$version;for(const o in le.$root){const l=le.$root[o];if(l.required){let f=null;f=o==="version"?t:l.type==="array"?[]:{},f!=null&&(r[o]=f)}}return r},m.ax=Yh,m.ay=Bi,m.az=function(r){r=r.slice();const t=Object.create(null);for(let o=0;o<r.length;o++)t[r[o].id]=r[o];for(let o=0;o<r.length;o++)"ref"in r[o]&&(r[o]=tt(r[o],t[r[o].ref]));return r},m.b=dt,m.b0=function(r,t,o){return r[0]=t[0]*o[0],r[1]=t[1]*o[1],r[2]=t[2]*o[2],r[3]=t[3]*o[3],r},m.b1=function(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]+r[3]*t[3]},m.b2=oe,m.b3=U_,m.b4=$_,m.b5=function(r,t,o,l,f){var y,x=1/Math.tan(t/2);return r[0]=x/o,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=x,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,f!=null&&f!==1/0?(r[10]=(f+l)*(y=1/(l-f)),r[14]=2*f*l*y):(r[10]=-1,r[14]=-2*l),r},m.b6=function(r,t,o){var l=Math.sin(o),f=Math.cos(o),y=t[4],x=t[5],b=t[6],E=t[7],A=t[8],P=t[9],D=t[10],B=t[11];return t!==r&&(r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[4]=y*f+A*l,r[5]=x*f+P*l,r[6]=b*f+D*l,r[7]=E*f+B*l,r[8]=A*f-y*l,r[9]=P*f-x*l,r[10]=D*f-b*l,r[11]=B*f-E*l,r},m.b7=H,m.b8=ce,m.b9=function(r){return r*Math.PI/180},m.bA=Sl,m.bB=Eo,m.ba=function(r,t){return r[0]=t[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=t[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=t[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},m.bb=class extends ${},m.bc=Kp,m.bd=TE,m.bf=Pi,m.bg=function(r,t){Qi.REGISTERED_PROTOCOLS[r]=t},m.bh=function(r){delete Qi.REGISTERED_PROTOCOLS[r]},m.bi=function(r,t){const o={};for(let f=0;f<r.length;f++){const y=t&&t[r[f].id]||gp(r[f]);t&&(t[r[f].id]=y);let x=o[y];x||(x=o[y]=[]),x.push(r[f])}const l=[];for(const f in o)l.push(o[f]);return l},m.bj=mt,m.bk=H_,m.bl=Z_,m.bm=S_,m.bn=function(r){r.bucket.createArrays(),r.bucket.tilePixelRatio=or/(512*r.bucket.overscaling),r.bucket.compareText={},r.bucket.iconsNeedLinear=!1;const t=r.bucket.layers[0],o=t.layout,l=t._unevaluatedLayout._values,f={layoutIconSize:l["icon-size"].possiblyEvaluate(new wi(r.bucket.zoom+1),r.canonical),layoutTextSize:l["text-size"].possiblyEvaluate(new wi(r.bucket.zoom+1),r.canonical),textMaxSize:l["text-size"].possiblyEvaluate(new wi(18))};if(r.bucket.textSizeData.kind==="composite"){const{minZoom:A,maxZoom:P}=r.bucket.textSizeData;f.compositeTextSizes=[l["text-size"].possiblyEvaluate(new wi(A),r.canonical),l["text-size"].possiblyEvaluate(new wi(P),r.canonical)]}if(r.bucket.iconSizeData.kind==="composite"){const{minZoom:A,maxZoom:P}=r.bucket.iconSizeData;f.compositeIconSizes=[l["icon-size"].possiblyEvaluate(new wi(A),r.canonical),l["icon-size"].possiblyEvaluate(new wi(P),r.canonical)]}const y=o.get("text-line-height")*dr,x=o.get("text-rotation-alignment")!=="viewport"&&o.get("symbol-placement")!=="point",b=o.get("text-keep-upright"),E=o.get("text-size");for(const A of r.bucket.features){const P=o.get("text-font").evaluate(A,{},r.canonical).join(","),D=E.evaluate(A,{},r.canonical),B=f.layoutTextSize.evaluate(A,{},r.canonical),V=f.layoutIconSize.evaluate(A,{},r.canonical),j={horizontal:{},vertical:void 0},Z=A.text;let Y,se=[0,0];if(Z){const xe=Z.toString(),ze=o.get("text-letter-spacing").evaluate(A,{},r.canonical)*dr,qe=_p(xe)?ze:0,st=o.get("text-anchor").evaluate(A,{},r.canonical),Ct=o0(t,A,r.canonical);if(!Ct){const gt=o.get("text-radial-offset").evaluate(A,{},r.canonical);se=gt?n0(st,[gt*dr,Yp]):o.get("text-offset").evaluate(A,{},r.canonical).map(ft=>ft*dr)}let lt=x?"center":o.get("text-justify").evaluate(A,{},r.canonical);const ot=o.get("symbol-placement")==="point"?o.get("text-max-width").evaluate(A,{},r.canonical)*dr:1/0,bt=()=>{r.bucket.allowVerticalPlacement&&ou(xe)&&(j.vertical=yd(Z,r.glyphMap,r.glyphPositions,r.imagePositions,P,ot,y,st,"left",qe,se,m.ah.vertical,!0,B,D))};if(!x&&Ct){const gt=new Set;if(lt==="auto")for(let Fe=0;Fe<Ct.values.length;Fe+=2)gt.add(Qp(Ct.values[Fe]));else gt.add(lt);let ft=!1;for(const Fe of gt)if(!j.horizontal[Fe])if(ft)j.horizontal[Fe]=j.horizontal[0];else{const Et=yd(Z,r.glyphMap,r.glyphPositions,r.imagePositions,P,ot,y,"center",Fe,qe,se,m.ah.horizontal,!1,B,D);Et&&(j.horizontal[Fe]=Et,ft=Et.positionedLines.length===1)}bt()}else{lt==="auto"&&(lt=Qp(st));const gt=yd(Z,r.glyphMap,r.glyphPositions,r.imagePositions,P,ot,y,st,lt,qe,se,m.ah.horizontal,!1,B,D);gt&&(j.horizontal[lt]=gt),bt(),ou(xe)&&x&&b&&(j.vertical=yd(Z,r.glyphMap,r.glyphPositions,r.imagePositions,P,ot,y,st,lt,qe,se,m.ah.vertical,!1,B,D))}}let Ee=!1;if(A.icon&&A.icon.name){const xe=r.imageMap[A.icon.name];xe&&(Y=aE(r.imagePositions[A.icon.name],o.get("icon-offset").evaluate(A,{},r.canonical),o.get("icon-anchor").evaluate(A,{},r.canonical)),Ee=!!xe.sdf,r.bucket.sdfIcons===void 0?r.bucket.sdfIcons=Ee:r.bucket.sdfIcons!==Ee&&Oe("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(xe.pixelRatio!==r.bucket.pixelRatio||o.get("icon-rotate").constantOr(1)!==0)&&(r.bucket.iconsNeedLinear=!0))}const fe=a0(j.horizontal)||j.vertical;r.bucket.iconsInText=!!fe&&fe.iconsInText,(fe||Y)&&SE(r.bucket,A,j,Y,r.imageMap,f,B,V,se,Ee,r.canonical)}r.showCollisionBoxes&&r.bucket.generateCollisionDebugBuffers()},m.bo=Bp,m.bp=Dp,m.bq=Op,m.br=Os,m.bs=Vp,m.bt=class{constructor(r){this._marks={start:[r.url,"start"].join("#"),end:[r.url,"end"].join("#"),measure:r.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let r=performance.getEntriesByName(this._marks.measure);return r.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),r=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),r}},m.bu=function(r,t,o,l,f){return c(this,void 0,void 0,function*(){if(ee())try{return yield ti(r,t,o,l,f)}catch{}return function(y,x,b,E,A){const P=y.width,D=y.height;Ut&&Nt||(Ut=new OffscreenCanvas(P,D),Nt=Ut.getContext("2d",{willReadFrequently:!0})),Ut.width=P,Ut.height=D,Nt.drawImage(y,0,0,P,D);const B=Nt.getImageData(x,b,E,A);return Nt.clearRect(0,0,P,D),B.data}(r,t,o,l,f)})},m.bv=q_,m.bw=I,m.bx=M,m.by=m_,m.bz=function(r){return r.message===jt},m.c=Si,m.d=r=>c(void 0,void 0,void 0,function*(){if(r.byteLength===0)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(r)],{type:"image/png"});try{return createImageBitmap(t)}catch(o){throw new Error(`Could not load image because of ${o.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),m.e=Ae,m.f=r=>new Promise((t,o)=>{const l=new Image;l.onload=()=>{t(l),URL.revokeObjectURL(l.src),l.onload=null,window.requestAnimationFrame(()=>{l.src=nt})},l.onerror=()=>o(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const f=new Blob([new Uint8Array(r)],{type:"image/png"});l.src=r.byteLength?URL.createObjectURL(f):nt}),m.g=Oi,m.h=(r,t)=>Br(Ae(r,{type:"json"}),t),m.i=rt,m.j=ye,m.k=he,m.l=(r,t)=>Br(Ae(r,{type:"arrayBuffer"}),t),m.m=Br,m.n=function(r){return new Vp(r).readFields(eE,[])},m.o=yu,m.p=E_,m.q=d,m.r=yp,m.s=pr,m.t=nu,m.u=ct,m.v=le,m.w=Oe,m.x=Ca,m.y=function([r,t,o]){return t+=90,t*=Math.PI/180,o*=Math.PI/180,{x:r*Math.cos(t)*Math.sin(o),y:r*Math.sin(t)*Math.sin(o),z:r*Math.cos(o)}},m.z=Vr}),h("worker",["./shared"],function(m){class c{constructor(F){this.keyCache={},F&&this.replace(F)}replace(F){this._layerConfigs={},this._layers={},this.update(F,[])}update(F,N){for(const ie of F){this._layerConfigs[ie.id]=ie;const pe=this._layers[ie.id]=m.aA(ie);pe._featureFilter=m.a6(pe.filter),this.keyCache[ie.id]&&delete this.keyCache[ie.id]}for(const ie of N)delete this.keyCache[ie],delete this._layerConfigs[ie],delete this._layers[ie];this.familiesBySource={};const U=m.bi(Object.values(this._layerConfigs),this.keyCache);for(const ie of U){const pe=ie.map(Re=>this._layers[Re.id]),_e=pe[0];if(_e.visibility==="none")continue;const we=_e.source||"";let de=this.familiesBySource[we];de||(de=this.familiesBySource[we]={});const Ce=_e.sourceLayer||"_geojsonTileLayer";let Ue=de[Ce];Ue||(Ue=de[Ce]=[]),Ue.push(pe)}}}class I{constructor(F){const N={},U=[];for(const we in F){const de=F[we],Ce=N[we]={};for(const Ue in de){const Re=de[+Ue];if(!Re||Re.bitmap.width===0||Re.bitmap.height===0)continue;const De={x:0,y:0,w:Re.bitmap.width+2,h:Re.bitmap.height+2};U.push(De),Ce[Ue]={rect:De,metrics:Re.metrics}}}const{w:ie,h:pe}=m.p(U),_e=new m.o({width:ie||1,height:pe||1});for(const we in F){const de=F[we];for(const Ce in de){const Ue=de[+Ce];if(!Ue||Ue.bitmap.width===0||Ue.bitmap.height===0)continue;const Re=N[we][Ce].rect;m.o.copy(Ue.bitmap,_e,{x:0,y:0},{x:Re.x+1,y:Re.y+1},Ue.bitmap)}}this.image=_e,this.positions=N}}m.bj("GlyphAtlas",I);class M{constructor(F){this.tileID=new m.Q(F.tileID.overscaledZ,F.tileID.wrap,F.tileID.canonical.z,F.tileID.canonical.x,F.tileID.canonical.y),this.uid=F.uid,this.zoom=F.zoom,this.pixelRatio=F.pixelRatio,this.tileSize=F.tileSize,this.source=F.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=F.showCollisionBoxes,this.collectResourceTiming=!!F.collectResourceTiming,this.returnDependencies=!!F.returnDependencies,this.promoteId=F.promoteId,this.inFlightDependencies=[]}parse(F,N,U,ie){return m._(this,void 0,void 0,function*(){this.status="parsing",this.data=F,this.collisionBoxArray=new m.a4;const pe=new m.bk(Object.keys(F.layers).sort()),_e=new m.bl(this.tileID,this.promoteId);_e.bucketLayerIDs=[];const we={},de={featureIndex:_e,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:U},Ce=N.familiesBySource[this.source];for(const Zt in Ce){const Fi=F.layers[Zt];if(!Fi)continue;Fi.version===1&&m.w(`Vector tile source "${this.source}" layer "${Zt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const cr=pe.encode(Zt),Xr=[];for(let cn=0;cn<Fi.length;cn++){const ur=Fi.feature(cn),_s=_e.getId(ur,Zt);Xr.push({feature:ur,id:_s,index:cn,sourceLayerIndex:cr})}for(const cn of Ce[Zt]){const ur=cn[0];ur.source!==this.source&&m.w(`layer.source = ${ur.source} does not equal this.source = ${this.source}`),ur.minzoom&&this.zoom<Math.floor(ur.minzoom)||ur.maxzoom&&this.zoom>=ur.maxzoom||ur.visibility!=="none"&&(k(cn,this.zoom,U),(we[ur.id]=ur.createBucket({index:_e.bucketLayerIDs.length,layers:cn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:cr,sourceID:this.source})).populate(Xr,de,this.tileID.canonical),_e.bucketLayerIDs.push(cn.map(_s=>_s.id)))}}const Ue=m.aF(de.glyphDependencies,Zt=>Object.keys(Zt).map(Number));this.inFlightDependencies.forEach(Zt=>Zt==null?void 0:Zt.abort()),this.inFlightDependencies=[];let Re=Promise.resolve({});if(Object.keys(Ue).length){const Zt=new AbortController;this.inFlightDependencies.push(Zt),Re=ie.sendAsync({type:"GG",data:{stacks:Ue,source:this.source,tileID:this.tileID,type:"glyphs"}},Zt)}const De=Object.keys(de.iconDependencies);let Tt=Promise.resolve({});if(De.length){const Zt=new AbortController;this.inFlightDependencies.push(Zt),Tt=ie.sendAsync({type:"GI",data:{icons:De,source:this.source,tileID:this.tileID,type:"icons"}},Zt)}const St=Object.keys(de.patternDependencies);let Jt=Promise.resolve({});if(St.length){const Zt=new AbortController;this.inFlightDependencies.push(Zt),Jt=ie.sendAsync({type:"GI",data:{icons:St,source:this.source,tileID:this.tileID,type:"patterns"}},Zt)}const[Rt,ii,mi]=yield Promise.all([Re,Tt,Jt]),Ti=new I(Rt),rr=new m.bm(ii,mi);for(const Zt in we){const Fi=we[Zt];Fi instanceof m.a5?(k(Fi.layers,this.zoom,U),m.bn({bucket:Fi,glyphMap:Rt,glyphPositions:Ti.positions,imageMap:ii,imagePositions:rr.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Fi.hasPattern&&(Fi instanceof m.bo||Fi instanceof m.bp||Fi instanceof m.bq)&&(k(Fi.layers,this.zoom,U),Fi.addFeatures(de,this.tileID.canonical,rr.patternPositions))}return this.status="done",{buckets:Object.values(we).filter(Zt=>!Zt.isEmpty()),featureIndex:_e,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ti.image,imageAtlas:rr,glyphMap:this.returnDependencies?Rt:null,iconMap:this.returnDependencies?ii:null,glyphPositions:this.returnDependencies?Ti.positions:null}})}}function k(Q,F,N){const U=new m.a8(F);for(const ie of Q)ie.recalculate(U,N)}class C{constructor(F,N,U){this.actor=F,this.layerIndex=N,this.availableImages=U,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(F,N){return m._(this,void 0,void 0,function*(){const U=yield m.l(F.request,N);try{return{vectorTile:new m.br.VectorTile(new m.bs(U.data)),rawData:U.data,cacheControl:U.cacheControl,expires:U.expires}}catch(ie){const pe=new Uint8Array(U.data);let _e=`Unable to parse the tile at ${F.request.url}, `;throw _e+=pe[0]===31&&pe[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${ie.message}`,new Error(_e)}})}loadTile(F){return m._(this,void 0,void 0,function*(){const N=F.uid,U=!!(F&&F.request&&F.request.collectResourceTiming)&&new m.bt(F.request),ie=new M(F);this.loading[N]=ie;const pe=new AbortController;ie.abort=pe;try{const _e=yield this.loadVectorTile(F,pe);if(delete this.loading[N],!_e)return null;const we=_e.rawData,de={};_e.expires&&(de.expires=_e.expires),_e.cacheControl&&(de.cacheControl=_e.cacheControl);const Ce={};if(U){const Re=U.finish();Re&&(Ce.resourceTiming=JSON.parse(JSON.stringify(Re)))}ie.vectorTile=_e.vectorTile;const Ue=ie.parse(_e.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[N]=ie,this.fetching[N]={rawTileData:we,cacheControl:de,resourceTiming:Ce};try{const Re=yield Ue;return m.e({rawTileData:we.slice(0)},Re,de,Ce)}finally{delete this.fetching[N]}}catch(_e){throw delete this.loading[N],ie.status="done",this.loaded[N]=ie,_e}})}reloadTile(F){return m._(this,void 0,void 0,function*(){const N=F.uid;if(!this.loaded||!this.loaded[N])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const U=this.loaded[N];if(U.showCollisionBoxes=F.showCollisionBoxes,U.status==="parsing"){const ie=yield U.parse(U.vectorTile,this.layerIndex,this.availableImages,this.actor);let pe;if(this.fetching[N]){const{rawTileData:_e,cacheControl:we,resourceTiming:de}=this.fetching[N];delete this.fetching[N],pe=m.e({rawTileData:_e.slice(0)},ie,we,de)}else pe=ie;return pe}if(U.status==="done"&&U.vectorTile)return U.parse(U.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(F){return m._(this,void 0,void 0,function*(){const N=this.loading,U=F.uid;N&&N[U]&&N[U].abort&&(N[U].abort.abort(),delete N[U])})}removeTile(F){return m._(this,void 0,void 0,function*(){this.loaded&&this.loaded[F.uid]&&delete this.loaded[F.uid]})}}class L{constructor(){this.loaded={}}loadTile(F){return m._(this,void 0,void 0,function*(){const{uid:N,encoding:U,rawImageData:ie,redFactor:pe,greenFactor:_e,blueFactor:we,baseShift:de}=F,Ce=ie.width+2,Ue=ie.height+2,Re=m.b(ie)?new m.R({width:Ce,height:Ue},yield m.bu(ie,-1,-1,Ce,Ue)):ie,De=new m.bv(N,Re,U,pe,_e,we,de);return this.loaded=this.loaded||{},this.loaded[N]=De,De})}removeTile(F){const N=this.loaded,U=F.uid;N&&N[U]&&delete N[U]}}function q(Q,F){if(Q.length!==0){X(Q[0],F);for(var N=1;N<Q.length;N++)X(Q[N],!F)}}function X(Q,F){for(var N=0,U=0,ie=0,pe=Q.length,_e=pe-1;ie<pe;_e=ie++){var we=(Q[ie][0]-Q[_e][0])*(Q[_e][1]+Q[ie][1]),de=N+we;U+=Math.abs(N)>=Math.abs(we)?N-de+we:we-de+N,N=de}N+U>=0!=!!F&&Q.reverse()}var W=m.bw(function Q(F,N){var U,ie=F&&F.type;if(ie==="FeatureCollection")for(U=0;U<F.features.length;U++)Q(F.features[U],N);else if(ie==="GeometryCollection")for(U=0;U<F.geometries.length;U++)Q(F.geometries[U],N);else if(ie==="Feature")Q(F.geometry,N);else if(ie==="Polygon")q(F.coordinates,N);else if(ie==="MultiPolygon")for(U=0;U<F.coordinates.length;U++)q(F.coordinates[U],N);return F});const ae=m.br.VectorTileFeature.prototype.toGeoJSON;var Ie={exports:{}},ee=m.bx,H=m.br.VectorTileFeature,ce=ne;function ne(Q,F){this.options=F||{},this.features=Q,this.length=Q.length}function oe(Q,F){this.id=typeof Q.id=="number"?Q.id:void 0,this.type=Q.type,this.rawGeometry=Q.type===1?[Q.geometry]:Q.geometry,this.properties=Q.tags,this.extent=F||4096}ne.prototype.feature=function(Q){return new oe(this.features[Q],this.options.extent)},oe.prototype.loadGeometry=function(){var Q=this.rawGeometry;this.geometry=[];for(var F=0;F<Q.length;F++){for(var N=Q[F],U=[],ie=0;ie<N.length;ie++)U.push(new ee(N[ie][0],N[ie][1]));this.geometry.push(U)}return this.geometry},oe.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Q=this.geometry,F=1/0,N=-1/0,U=1/0,ie=-1/0,pe=0;pe<Q.length;pe++)for(var _e=Q[pe],we=0;we<_e.length;we++){var de=_e[we];F=Math.min(F,de.x),N=Math.max(N,de.x),U=Math.min(U,de.y),ie=Math.max(ie,de.y)}return[F,U,N,ie]},oe.prototype.toGeoJSON=H.prototype.toGeoJSON;var Ae=m.by,be=ce;function Le(Q){var F=new Ae;return function(N,U){for(var ie in N.layers)U.writeMessage(3,me,N.layers[ie])}(Q,F),F.finish()}function me(Q,F){var N;F.writeVarintField(15,Q.version||1),F.writeStringField(1,Q.name||""),F.writeVarintField(5,Q.extent||4096);var U={keys:[],values:[],keycache:{},valuecache:{}};for(N=0;N<Q.length;N++)U.feature=Q.feature(N),F.writeMessage(2,ke,U);var ie=U.keys;for(N=0;N<ie.length;N++)F.writeStringField(3,ie[N]);var pe=U.values;for(N=0;N<pe.length;N++)F.writeMessage(4,Ke,pe[N])}function ke(Q,F){var N=Q.feature;N.id!==void 0&&F.writeVarintField(1,N.id),F.writeMessage(2,Me,Q),F.writeVarintField(3,N.type),F.writeMessage(4,rt,N)}function Me(Q,F){var N=Q.feature,U=Q.keys,ie=Q.values,pe=Q.keycache,_e=Q.valuecache;for(var we in N.properties){var de=N.properties[we],Ce=pe[we];if(de!==null){Ce===void 0&&(U.push(we),pe[we]=Ce=U.length-1),F.writeVarint(Ce);var Ue=typeof de;Ue!=="string"&&Ue!=="boolean"&&Ue!=="number"&&(de=JSON.stringify(de));var Re=Ue+":"+de,De=_e[Re];De===void 0&&(ie.push(de),_e[Re]=De=ie.length-1),F.writeVarint(De)}}}function Oe(Q,F){return(F<<3)+(7&Q)}function Ge(Q){return Q<<1^Q>>31}function rt(Q,F){for(var N=Q.loadGeometry(),U=Q.type,ie=0,pe=0,_e=N.length,we=0;we<_e;we++){var de=N[we],Ce=1;U===1&&(Ce=de.length),F.writeVarint(Oe(1,Ce));for(var Ue=U===3?de.length-1:de.length,Re=0;Re<Ue;Re++){Re===1&&U!==1&&F.writeVarint(Oe(2,Ue-1));var De=de[Re].x-ie,Tt=de[Re].y-pe;F.writeVarint(Ge(De)),F.writeVarint(Ge(Tt)),ie+=De,pe+=Tt}U===3&&F.writeVarint(Oe(7,1))}}function Ke(Q,F){var N=typeof Q;N==="string"?F.writeStringField(1,Q):N==="boolean"?F.writeBooleanField(7,Q):N==="number"&&(Q%1!=0?F.writeDoubleField(3,Q):Q<0?F.writeSVarintField(6,Q):F.writeVarintField(5,Q))}Ie.exports=Le,Ie.exports.fromVectorTileJs=Le,Ie.exports.fromGeojsonVt=function(Q,F){F=F||{};var N={};for(var U in Q)N[U]=new be(Q[U].features,F),N[U].name=U,N[U].version=F.version,N[U].extent=F.extent;return Le({layers:N})},Ie.exports.GeoJSONWrapper=be;var dt=m.bw(Ie.exports);const nt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Q=>Q},ti=Math.fround||(Ut=new Float32Array(1),Q=>(Ut[0]=+Q,Ut[0]));var Ut;const Nt=3,jt=5,Si=6;class Qi{constructor(F){this.options=Object.assign(Object.create(nt),F),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(F){const{log:N,minZoom:U,maxZoom:ie}=this.options;N&&console.time("total time");const pe=`prepare ${F.length} points`;N&&console.time(pe),this.points=F;const _e=[];for(let de=0;de<F.length;de++){const Ce=F[de];if(!Ce.geometry)continue;const[Ue,Re]=Ce.geometry.coordinates,De=ti(Pi(Ue)),Tt=ti(Bi(Re));_e.push(De,Tt,1/0,de,-1,1),this.options.reduce&&_e.push(0)}let we=this.trees[ie+1]=this._createTree(_e);N&&console.timeEnd(pe);for(let de=ie;de>=U;de--){const Ce=+Date.now();we=this.trees[de]=this._createTree(this._cluster(we,de)),N&&console.log("z%d: %d clusters in %dms",de,we.numItems,+Date.now()-Ce)}return N&&console.timeEnd("total time"),this}getClusters(F,N){let U=((F[0]+180)%360+360)%360-180;const ie=Math.max(-90,Math.min(90,F[1]));let pe=F[2]===180?180:((F[2]+180)%360+360)%360-180;const _e=Math.max(-90,Math.min(90,F[3]));if(F[2]-F[0]>=360)U=-180,pe=180;else if(U>pe){const Re=this.getClusters([U,ie,180,_e],N),De=this.getClusters([-180,ie,pe,_e],N);return Re.concat(De)}const we=this.trees[this._limitZoom(N)],de=we.range(Pi(U),Bi(_e),Pi(pe),Bi(ie)),Ce=we.data,Ue=[];for(const Re of de){const De=this.stride*Re;Ue.push(Ce[De+jt]>1?Oi(Ce,De,this.clusterProps):this.points[Ce[De+Nt]])}return Ue}getChildren(F){const N=this._getOriginId(F),U=this._getOriginZoom(F),ie="No cluster with the specified id.",pe=this.trees[U];if(!pe)throw new Error(ie);const _e=pe.data;if(N*this.stride>=_e.length)throw new Error(ie);const we=this.options.radius/(this.options.extent*Math.pow(2,U-1)),de=pe.within(_e[N*this.stride],_e[N*this.stride+1],we),Ce=[];for(const Ue of de){const Re=Ue*this.stride;_e[Re+4]===F&&Ce.push(_e[Re+jt]>1?Oi(_e,Re,this.clusterProps):this.points[_e[Re+Nt]])}if(Ce.length===0)throw new Error(ie);return Ce}getLeaves(F,N,U){const ie=[];return this._appendLeaves(ie,F,N=N||10,U=U||0,0),ie}getTile(F,N,U){const ie=this.trees[this._limitZoom(F)],pe=Math.pow(2,F),{extent:_e,radius:we}=this.options,de=we/_e,Ce=(U-de)/pe,Ue=(U+1+de)/pe,Re={features:[]};return this._addTileFeatures(ie.range((N-de)/pe,Ce,(N+1+de)/pe,Ue),ie.data,N,U,pe,Re),N===0&&this._addTileFeatures(ie.range(1-de/pe,Ce,1,Ue),ie.data,pe,U,pe,Re),N===pe-1&&this._addTileFeatures(ie.range(0,Ce,de/pe,Ue),ie.data,-1,U,pe,Re),Re.features.length?Re:null}getClusterExpansionZoom(F){let N=this._getOriginZoom(F)-1;for(;N<=this.options.maxZoom;){const U=this.getChildren(F);if(N++,U.length!==1)break;F=U[0].properties.cluster_id}return N}_appendLeaves(F,N,U,ie,pe){const _e=this.getChildren(N);for(const we of _e){const de=we.properties;if(de&&de.cluster?pe+de.point_count<=ie?pe+=de.point_count:pe=this._appendLeaves(F,de.cluster_id,U,ie,pe):pe<ie?pe++:F.push(we),F.length===U)break}return pe}_createTree(F){const N=new m.av(F.length/this.stride|0,this.options.nodeSize,Float32Array);for(let U=0;U<F.length;U+=this.stride)N.add(F[U],F[U+1]);return N.finish(),N.data=F,N}_addTileFeatures(F,N,U,ie,pe,_e){for(const we of F){const de=we*this.stride,Ce=N[de+jt]>1;let Ue,Re,De;if(Ce)Ue=fi(N,de,this.clusterProps),Re=N[de],De=N[de+1];else{const Jt=this.points[N[de+Nt]];Ue=Jt.properties;const[Rt,ii]=Jt.geometry.coordinates;Re=Pi(Rt),De=Bi(ii)}const Tt={type:1,geometry:[[Math.round(this.options.extent*(Re*pe-U)),Math.round(this.options.extent*(De*pe-ie))]],tags:Ue};let St;St=Ce||this.options.generateId?N[de+Nt]:this.points[N[de+Nt]].id,St!==void 0&&(Tt.id=St),_e.features.push(Tt)}}_limitZoom(F){return Math.max(this.options.minZoom,Math.min(Math.floor(+F),this.options.maxZoom+1))}_cluster(F,N){const{radius:U,extent:ie,reduce:pe,minPoints:_e}=this.options,we=U/(ie*Math.pow(2,N)),de=F.data,Ce=[],Ue=this.stride;for(let Re=0;Re<de.length;Re+=Ue){if(de[Re+2]<=N)continue;de[Re+2]=N;const De=de[Re],Tt=de[Re+1],St=F.within(de[Re],de[Re+1],we),Jt=de[Re+jt];let Rt=Jt;for(const ii of St){const mi=ii*Ue;de[mi+2]>N&&(Rt+=de[mi+jt])}if(Rt>Jt&&Rt>=_e){let ii,mi=De*Jt,Ti=Tt*Jt,rr=-1;const Zt=((Re/Ue|0)<<5)+(N+1)+this.points.length;for(const Fi of St){const cr=Fi*Ue;if(de[cr+2]<=N)continue;de[cr+2]=N;const Xr=de[cr+jt];mi+=de[cr]*Xr,Ti+=de[cr+1]*Xr,de[cr+4]=Zt,pe&&(ii||(ii=this._map(de,Re,!0),rr=this.clusterProps.length,this.clusterProps.push(ii)),pe(ii,this._map(de,cr)))}de[Re+4]=Zt,Ce.push(mi/Rt,Ti/Rt,1/0,Zt,-1,Rt),pe&&Ce.push(rr)}else{for(let ii=0;ii<Ue;ii++)Ce.push(de[Re+ii]);if(Rt>1)for(const ii of St){const mi=ii*Ue;if(!(de[mi+2]<=N)){de[mi+2]=N;for(let Ti=0;Ti<Ue;Ti++)Ce.push(de[mi+Ti])}}}}return Ce}_getOriginId(F){return F-this.points.length>>5}_getOriginZoom(F){return(F-this.points.length)%32}_map(F,N,U){if(F[N+jt]>1){const _e=this.clusterProps[F[N+Si]];return U?Object.assign({},_e):_e}const ie=this.points[F[N+Nt]].properties,pe=this.options.map(ie);return U&&pe===ie?Object.assign({},pe):pe}}function Oi(Q,F,N){return{type:"Feature",id:Q[F+Nt],properties:fi(Q,F,N),geometry:{type:"Point",coordinates:[(U=Q[F],360*(U-.5)),Br(Q[F+1])]}};var U}function fi(Q,F,N){const U=Q[F+jt],ie=U>=1e4?`${Math.round(U/1e3)}k`:U>=1e3?Math.round(U/100)/10+"k":U,pe=Q[F+Si],_e=pe===-1?{}:Object.assign({},N[pe]);return Object.assign(_e,{cluster:!0,cluster_id:Q[F+Nt],point_count:U,point_count_abbreviated:ie})}function Pi(Q){return Q/360+.5}function Bi(Q){const F=Math.sin(Q*Math.PI/180),N=.5-.25*Math.log((1+F)/(1-F))/Math.PI;return N<0?0:N>1?1:N}function Br(Q){const F=(180-360*Q)*Math.PI/180;return 360*Math.atan(Math.exp(F))/Math.PI-90}function pr(Q,F,N,U){for(var ie,pe=U,_e=N-F>>1,we=N-F,de=Q[F],Ce=Q[F+1],Ue=Q[N],Re=Q[N+1],De=F+3;De<N;De+=3){var Tt=Fr(Q[De],Q[De+1],de,Ce,Ue,Re);if(Tt>pe)ie=De,pe=Tt;else if(Tt===pe){var St=Math.abs(De-_e);St<we&&(ie=De,we=St)}}pe>U&&(ie-F>3&&pr(Q,F,ie,U),Q[ie+2]=pe,N-ie>3&&pr(Q,ie,N,U))}function Fr(Q,F,N,U,ie,pe){var _e=ie-N,we=pe-U;if(_e!==0||we!==0){var de=((Q-N)*_e+(F-U)*we)/(_e*_e+we*we);de>1?(N=ie,U=pe):de>0&&(N+=_e*de,U+=we*de)}return(_e=Q-N)*_e+(we=F-U)*we}function lr(Q,F,N,U){var ie={id:Q===void 0?null:Q,type:F,geometry:N,tags:U,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(pe){var _e=pe.geometry,we=pe.type;if(we==="Point"||we==="MultiPoint"||we==="LineString")he(pe,_e);else if(we==="Polygon"||we==="MultiLineString")for(var de=0;de<_e.length;de++)he(pe,_e[de]);else if(we==="MultiPolygon")for(de=0;de<_e.length;de++)for(var Ce=0;Ce<_e[de].length;Ce++)he(pe,_e[de][Ce])}(ie),ie}function he(Q,F){for(var N=0;N<F.length;N+=3)Q.minX=Math.min(Q.minX,F[N]),Q.minY=Math.min(Q.minY,F[N+1]),Q.maxX=Math.max(Q.maxX,F[N]),Q.maxY=Math.max(Q.maxY,F[N+1])}function ye(Q,F,N,U){if(F.geometry){var ie=F.geometry.coordinates,pe=F.geometry.type,_e=Math.pow(N.tolerance/((1<<N.maxZoom)*N.extent),2),we=[],de=F.id;if(N.promoteId?de=F.properties[N.promoteId]:N.generateId&&(de=U||0),pe==="Point")Be(ie,we);else if(pe==="MultiPoint")for(var Ce=0;Ce<ie.length;Ce++)Be(ie[Ce],we);else if(pe==="LineString")le(ie,we,_e,!1);else if(pe==="MultiLineString"){if(N.lineMetrics){for(Ce=0;Ce<ie.length;Ce++)le(ie[Ce],we=[],_e,!1),Q.push(lr(de,"LineString",we,F.properties));return}He(ie,we,_e,!1)}else if(pe==="Polygon")He(ie,we,_e,!0);else{if(pe!=="MultiPolygon"){if(pe==="GeometryCollection"){for(Ce=0;Ce<F.geometry.geometries.length;Ce++)ye(Q,{id:de,geometry:F.geometry.geometries[Ce],properties:F.properties},N,U);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Ce=0;Ce<ie.length;Ce++){var Ue=[];He(ie[Ce],Ue,_e,!0),we.push(Ue)}}Q.push(lr(de,pe,we,F.properties))}}function Be(Q,F){F.push(tt(Q[0])),F.push(Ze(Q[1])),F.push(0)}function le(Q,F,N,U){for(var ie,pe,_e=0,we=0;we<Q.length;we++){var de=tt(Q[we][0]),Ce=Ze(Q[we][1]);F.push(de),F.push(Ce),F.push(0),we>0&&(_e+=U?(ie*Ce-de*pe)/2:Math.sqrt(Math.pow(de-ie,2)+Math.pow(Ce-pe,2))),ie=de,pe=Ce}var Ue=F.length-3;F[2]=1,pr(F,0,Ue,N),F[Ue+2]=1,F.size=Math.abs(_e),F.start=0,F.end=F.size}function He(Q,F,N,U){for(var ie=0;ie<Q.length;ie++){var pe=[];le(Q[ie],pe,N,U),F.push(pe)}}function tt(Q){return Q/360+.5}function Ze(Q){var F=Math.sin(Q*Math.PI/180),N=.5-.25*Math.log((1+F)/(1-F))/Math.PI;return N<0?0:N>1?1:N}function je(Q,F,N,U,ie,pe,_e,we){if(U/=F,pe>=(N/=F)&&_e<U)return Q;if(_e<N||pe>=U)return null;for(var de=[],Ce=0;Ce<Q.length;Ce++){var Ue=Q[Ce],Re=Ue.geometry,De=Ue.type,Tt=ie===0?Ue.minX:Ue.minY,St=ie===0?Ue.maxX:Ue.maxY;if(Tt>=N&&St<U)de.push(Ue);else if(!(St<N||Tt>=U)){var Jt=[];if(De==="Point"||De==="MultiPoint")Qe(Re,Jt,N,U,ie);else if(De==="LineString")We(Re,Jt,N,U,ie,!1,we.lineMetrics);else if(De==="MultiLineString")It(Re,Jt,N,U,ie,!1);else if(De==="Polygon")It(Re,Jt,N,U,ie,!0);else if(De==="MultiPolygon")for(var Rt=0;Rt<Re.length;Rt++){var ii=[];It(Re[Rt],ii,N,U,ie,!0),ii.length&&Jt.push(ii)}if(Jt.length){if(we.lineMetrics&&De==="LineString"){for(Rt=0;Rt<Jt.length;Rt++)de.push(lr(Ue.id,De,Jt[Rt],Ue.tags));continue}De!=="LineString"&&De!=="MultiLineString"||(Jt.length===1?(De="LineString",Jt=Jt[0]):De="MultiLineString"),De!=="Point"&&De!=="MultiPoint"||(De=Jt.length===3?"Point":"MultiPoint"),de.push(lr(Ue.id,De,Jt,Ue.tags))}}}return de.length?de:null}function Qe(Q,F,N,U,ie){for(var pe=0;pe<Q.length;pe+=3){var _e=Q[pe+ie];_e>=N&&_e<=U&&(F.push(Q[pe]),F.push(Q[pe+1]),F.push(Q[pe+2]))}}function We(Q,F,N,U,ie,pe,_e){for(var we,de,Ce=pt(Q),Ue=ie===0?Lt:Ht,Re=Q.start,De=0;De<Q.length-3;De+=3){var Tt=Q[De],St=Q[De+1],Jt=Q[De+2],Rt=Q[De+3],ii=Q[De+4],mi=ie===0?Tt:St,Ti=ie===0?Rt:ii,rr=!1;_e&&(we=Math.sqrt(Math.pow(Tt-Rt,2)+Math.pow(St-ii,2))),mi<N?Ti>N&&(de=Ue(Ce,Tt,St,Rt,ii,N),_e&&(Ce.start=Re+we*de)):mi>U?Ti<U&&(de=Ue(Ce,Tt,St,Rt,ii,U),_e&&(Ce.start=Re+we*de)):xt(Ce,Tt,St,Jt),Ti<N&&mi>=N&&(de=Ue(Ce,Tt,St,Rt,ii,N),rr=!0),Ti>U&&mi<=U&&(de=Ue(Ce,Tt,St,Rt,ii,U),rr=!0),!pe&&rr&&(_e&&(Ce.end=Re+we*de),F.push(Ce),Ce=pt(Q)),_e&&(Re+=we)}var Zt=Q.length-3;Tt=Q[Zt],St=Q[Zt+1],Jt=Q[Zt+2],(mi=ie===0?Tt:St)>=N&&mi<=U&&xt(Ce,Tt,St,Jt),Zt=Ce.length-3,pe&&Zt>=3&&(Ce[Zt]!==Ce[0]||Ce[Zt+1]!==Ce[1])&&xt(Ce,Ce[0],Ce[1],Ce[2]),Ce.length&&F.push(Ce)}function pt(Q){var F=[];return F.size=Q.size,F.start=Q.start,F.end=Q.end,F}function It(Q,F,N,U,ie,pe){for(var _e=0;_e<Q.length;_e++)We(Q[_e],F,N,U,ie,pe,!1)}function xt(Q,F,N,U){Q.push(F),Q.push(N),Q.push(U)}function Lt(Q,F,N,U,ie,pe){var _e=(pe-F)/(U-F);return Q.push(pe),Q.push(N+(ie-N)*_e),Q.push(1),_e}function Ht(Q,F,N,U,ie,pe){var _e=(pe-N)/(ie-N);return Q.push(F+(U-F)*_e),Q.push(pe),Q.push(1),_e}function $e(Q,F){for(var N=[],U=0;U<Q.length;U++){var ie,pe=Q[U],_e=pe.type;if(_e==="Point"||_e==="MultiPoint"||_e==="LineString")ie=Gt(pe.geometry,F);else if(_e==="MultiLineString"||_e==="Polygon"){ie=[];for(var we=0;we<pe.geometry.length;we++)ie.push(Gt(pe.geometry[we],F))}else if(_e==="MultiPolygon")for(ie=[],we=0;we<pe.geometry.length;we++){for(var de=[],Ce=0;Ce<pe.geometry[we].length;Ce++)de.push(Gt(pe.geometry[we][Ce],F));ie.push(de)}N.push(lr(pe.id,_e,ie,pe.tags))}return N}function Gt(Q,F){var N=[];N.size=Q.size,Q.start!==void 0&&(N.start=Q.start,N.end=Q.end);for(var U=0;U<Q.length;U+=3)N.push(Q[U]+F,Q[U+1],Q[U+2]);return N}function ai(Q,F){if(Q.transformed)return Q;var N,U,ie,pe=1<<Q.z,_e=Q.x,we=Q.y;for(N=0;N<Q.features.length;N++){var de=Q.features[N],Ce=de.geometry,Ue=de.type;if(de.geometry=[],Ue===1)for(U=0;U<Ce.length;U+=2)de.geometry.push(mr(Ce[U],Ce[U+1],F,pe,_e,we));else for(U=0;U<Ce.length;U++){var Re=[];for(ie=0;ie<Ce[U].length;ie+=2)Re.push(mr(Ce[U][ie],Ce[U][ie+1],F,pe,_e,we));de.geometry.push(Re)}}return Q.transformed=!0,Q}function mr(Q,F,N,U,ie,pe){return[Math.round(N*(Q*U-ie)),Math.round(N*(F*U-pe))]}function Kr(Q,F,N,U,ie){for(var pe=F===ie.maxZoom?0:ie.tolerance/((1<<F)*ie.extent),_e={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:N,y:U,z:F,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},we=0;we<Q.length;we++){_e.numFeatures++,Ye(_e,Q[we],pe,ie);var de=Q[we].minX,Ce=Q[we].minY,Ue=Q[we].maxX,Re=Q[we].maxY;de<_e.minX&&(_e.minX=de),Ce<_e.minY&&(_e.minY=Ce),Ue>_e.maxX&&(_e.maxX=Ue),Re>_e.maxY&&(_e.maxY=Re)}return _e}function Ye(Q,F,N,U){var ie=F.geometry,pe=F.type,_e=[];if(pe==="Point"||pe==="MultiPoint")for(var we=0;we<ie.length;we+=3)_e.push(ie[we]),_e.push(ie[we+1]),Q.numPoints++,Q.numSimplified++;else if(pe==="LineString")Bt(_e,ie,Q,N,!1,!1);else if(pe==="MultiLineString"||pe==="Polygon")for(we=0;we<ie.length;we++)Bt(_e,ie[we],Q,N,pe==="Polygon",we===0);else if(pe==="MultiPolygon")for(var de=0;de<ie.length;de++){var Ce=ie[de];for(we=0;we<Ce.length;we++)Bt(_e,Ce[we],Q,N,!0,we===0)}if(_e.length){var Ue=F.tags||null;if(pe==="LineString"&&U.lineMetrics){for(var Re in Ue={},F.tags)Ue[Re]=F.tags[Re];Ue.mapbox_clip_start=ie.start/ie.size,Ue.mapbox_clip_end=ie.end/ie.size}var De={geometry:_e,type:pe==="Polygon"||pe==="MultiPolygon"?3:pe==="LineString"||pe==="MultiLineString"?2:1,tags:Ue};F.id!==null&&(De.id=F.id),Q.features.push(De)}}function Bt(Q,F,N,U,ie,pe){var _e=U*U;if(U>0&&F.size<(ie?_e:U))N.numPoints+=F.length/3;else{for(var we=[],de=0;de<F.length;de+=3)(U===0||F[de+2]>_e)&&(N.numSimplified++,we.push(F[de]),we.push(F[de+1])),N.numPoints++;ie&&function(Ce,Ue){for(var Re=0,De=0,Tt=Ce.length,St=Tt-2;De<Tt;St=De,De+=2)Re+=(Ce[De]-Ce[St])*(Ce[De+1]+Ce[St+1]);if(Re>0===Ue)for(De=0,Tt=Ce.length;De<Tt/2;De+=2){var Jt=Ce[De],Rt=Ce[De+1];Ce[De]=Ce[Tt-2-De],Ce[De+1]=Ce[Tt-1-De],Ce[Tt-2-De]=Jt,Ce[Tt-1-De]=Rt}}(we,pe),Q.push(we)}}function Dt(Q,F){var N=(F=this.options=function(ie,pe){for(var _e in pe)ie[_e]=pe[_e];return ie}(Object.create(this.options),F)).debug;if(N&&console.time("preprocess data"),F.maxZoom<0||F.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(F.promoteId&&F.generateId)throw new Error("promoteId and generateId cannot be used together.");var U=function(ie,pe){var _e=[];if(ie.type==="FeatureCollection")for(var we=0;we<ie.features.length;we++)ye(_e,ie.features[we],pe,we);else ye(_e,ie.type==="Feature"?ie:{geometry:ie},pe);return _e}(Q,F);this.tiles={},this.tileCoords=[],N&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",F.indexMaxZoom,F.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),U=function(ie,pe){var _e=pe.buffer/pe.extent,we=ie,de=je(ie,1,-1-_e,_e,0,-1,2,pe),Ce=je(ie,1,1-_e,2+_e,0,-1,2,pe);return(de||Ce)&&(we=je(ie,1,-_e,1+_e,0,-1,2,pe)||[],de&&(we=$e(de,1).concat(we)),Ce&&(we=we.concat($e(Ce,-1)))),we}(U,F),U.length&&this.splitTile(U,0,0,0),N&&(U.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function pi(Q,F,N){return 32*((1<<Q)*N+F)+Q}function Ii(Q,F){return F?Q.properties[F]:Q.id}function Ft(Q,F){if(Q==null)return!0;if(Q.type==="Feature")return Ii(Q,F)!=null;if(Q.type==="FeatureCollection"){const N=new Set;for(const U of Q.features){const ie=Ii(U,F);if(ie==null||N.has(ie))return!1;N.add(ie)}return!0}return!1}function io(Q,F){const N=new Map;if(Q!=null)if(Q.type==="Feature")N.set(Ii(Q,F),Q);else for(const U of Q.features)N.set(Ii(U,F),U);return N}Dt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Dt.prototype.splitTile=function(Q,F,N,U,ie,pe,_e){for(var we=[Q,F,N,U],de=this.options,Ce=de.debug;we.length;){U=we.pop(),N=we.pop(),F=we.pop(),Q=we.pop();var Ue=1<<F,Re=pi(F,N,U),De=this.tiles[Re];if(!De&&(Ce>1&&console.time("creation"),De=this.tiles[Re]=Kr(Q,F,N,U,de),this.tileCoords.push({z:F,x:N,y:U}),Ce)){Ce>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",F,N,U,De.numFeatures,De.numPoints,De.numSimplified),console.timeEnd("creation"));var Tt="z"+F;this.stats[Tt]=(this.stats[Tt]||0)+1,this.total++}if(De.source=Q,ie){if(F===de.maxZoom||F===ie)continue;var St=1<<ie-F;if(N!==Math.floor(pe/St)||U!==Math.floor(_e/St))continue}else if(F===de.indexMaxZoom||De.numPoints<=de.indexMaxPoints)continue;if(De.source=null,Q.length!==0){Ce>1&&console.time("clipping");var Jt,Rt,ii,mi,Ti,rr,Zt=.5*de.buffer/de.extent,Fi=.5-Zt,cr=.5+Zt,Xr=1+Zt;Jt=Rt=ii=mi=null,Ti=je(Q,Ue,N-Zt,N+cr,0,De.minX,De.maxX,de),rr=je(Q,Ue,N+Fi,N+Xr,0,De.minX,De.maxX,de),Q=null,Ti&&(Jt=je(Ti,Ue,U-Zt,U+cr,1,De.minY,De.maxY,de),Rt=je(Ti,Ue,U+Fi,U+Xr,1,De.minY,De.maxY,de),Ti=null),rr&&(ii=je(rr,Ue,U-Zt,U+cr,1,De.minY,De.maxY,de),mi=je(rr,Ue,U+Fi,U+Xr,1,De.minY,De.maxY,de),rr=null),Ce>1&&console.timeEnd("clipping"),we.push(Jt||[],F+1,2*N,2*U),we.push(Rt||[],F+1,2*N,2*U+1),we.push(ii||[],F+1,2*N+1,2*U),we.push(mi||[],F+1,2*N+1,2*U+1)}}},Dt.prototype.getTile=function(Q,F,N){var U=this.options,ie=U.extent,pe=U.debug;if(Q<0||Q>24)return null;var _e=1<<Q,we=pi(Q,F=(F%_e+_e)%_e,N);if(this.tiles[we])return ai(this.tiles[we],ie);pe>1&&console.log("drilling down to z%d-%d-%d",Q,F,N);for(var de,Ce=Q,Ue=F,Re=N;!de&&Ce>0;)Ce--,Ue=Math.floor(Ue/2),Re=Math.floor(Re/2),de=this.tiles[pi(Ce,Ue,Re)];return de&&de.source?(pe>1&&console.log("found parent tile z%d-%d-%d",Ce,Ue,Re),pe>1&&console.time("drilling down"),this.splitTile(de.source,Ce,Ue,Re,Q,F,N),pe>1&&console.timeEnd("drilling down"),this.tiles[we]?ai(this.tiles[we],ie):null):null};class ro extends C{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(F,N){return m._(this,void 0,void 0,function*(){const U=F.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const ie=this._geoJSONIndex.getTile(U.z,U.x,U.y);if(!ie)return null;const pe=new class{constructor(we){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=m.W,this.length=we.length,this._features=we}feature(we){return new class{constructor(de){this._feature=de,this.extent=m.W,this.type=de.type,this.properties=de.tags,"id"in de&&!isNaN(de.id)&&(this.id=parseInt(de.id,10))}loadGeometry(){if(this._feature.type===1){const de=[];for(const Ce of this._feature.geometry)de.push([new m.P(Ce[0],Ce[1])]);return de}{const de=[];for(const Ce of this._feature.geometry){const Ue=[];for(const Re of Ce)Ue.push(new m.P(Re[0],Re[1]));de.push(Ue)}return de}}toGeoJSON(de,Ce,Ue){return ae.call(this,de,Ce,Ue)}}(this._features[we])}}(ie.features);let _e=dt(pe);return _e.byteOffset===0&&_e.byteLength===_e.buffer.byteLength||(_e=new Uint8Array(_e)),{vectorTile:pe,rawData:_e.buffer}})}loadData(F){return m._(this,void 0,void 0,function*(){var N;(N=this._pendingRequest)===null||N===void 0||N.abort();const U=!!(F&&F.request&&F.request.collectResourceTiming)&&new m.bt(F.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(F,this._pendingRequest),this._geoJSONIndex=F.cluster?new Qi(function({superclusterOptions:pe,clusterProperties:_e}){if(!_e||!pe)return pe;const we={},de={},Ce={accumulated:null,zoom:0},Ue={properties:null},Re=Object.keys(_e);for(const De of Re){const[Tt,St]=_e[De],Jt=m.bA(St),Rt=m.bA(typeof Tt=="string"?[Tt,["accumulated"],["get",De]]:Tt);we[De]=Jt.value,de[De]=Rt.value}return pe.map=De=>{Ue.properties=De;const Tt={};for(const St of Re)Tt[St]=we[St].evaluate(Ce,Ue);return Tt},pe.reduce=(De,Tt)=>{Ue.properties=Tt;for(const St of Re)Ce.accumulated=De[St],De[St]=de[St].evaluate(Ce,Ue)},pe}(F)).load((yield this._pendingData).features):new Dt(yield this._pendingData,F.geojsonVtOptions),this.loaded={};const ie={};if(U){const pe=U.finish();pe&&(ie.resourceTiming={},ie.resourceTiming[F.source]=JSON.parse(JSON.stringify(pe)))}return ie}catch(ie){if(delete this._pendingRequest,m.bz(ie))return{abandoned:!0};throw ie}})}getData(){return m._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(F){const N=this.loaded;return N&&N[F.uid]?super.reloadTile(F):this.loadTile(F)}loadAndProcessGeoJSON(F,N){return m._(this,void 0,void 0,function*(){let U=yield this.loadGeoJSON(F,N);if(delete this._pendingRequest,typeof U!="object")throw new Error(`Input data given to '${F.source}' is not a valid GeoJSON object.`);if(W(U,!0),F.filter){const ie=m.bA(F.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ie.result==="error")throw new Error(ie.value.map(_e=>`${_e.key}: ${_e.message}`).join(", "));U={type:"FeatureCollection",features:U.features.filter(_e=>ie.value.evaluate({zoom:0},_e))}}return U})}loadGeoJSON(F,N){return m._(this,void 0,void 0,function*(){const{promoteId:U}=F;if(F.request){const ie=yield m.h(F.request,N);return this._dataUpdateable=Ft(ie.data,U)?io(ie.data,U):void 0,ie.data}if(typeof F.data=="string")try{const ie=JSON.parse(F.data);return this._dataUpdateable=Ft(ie,U)?io(ie,U):void 0,ie}catch{throw new Error(`Input data given to '${F.source}' is not a valid GeoJSON object.`)}if(!F.dataDiff)throw new Error(`Input data given to '${F.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${F.source}`);return function(ie,pe,_e){var we,de,Ce,Ue;if(pe.removeAll&&ie.clear(),pe.remove)for(const Re of pe.remove)ie.delete(Re);if(pe.add)for(const Re of pe.add){const De=Ii(Re,_e);De!=null&&ie.set(De,Re)}if(pe.update)for(const Re of pe.update){let De=ie.get(Re.id);if(De==null)continue;const Tt=!Re.removeAllProperties&&(((we=Re.removeProperties)===null||we===void 0?void 0:we.length)>0||((de=Re.addOrUpdateProperties)===null||de===void 0?void 0:de.length)>0);if((Re.newGeometry||Re.removeAllProperties||Tt)&&(De=Object.assign({},De),ie.set(Re.id,De),Tt&&(De.properties=Object.assign({},De.properties))),Re.newGeometry&&(De.geometry=Re.newGeometry),Re.removeAllProperties)De.properties={};else if(((Ce=Re.removeProperties)===null||Ce===void 0?void 0:Ce.length)>0)for(const St of Re.removeProperties)Object.prototype.hasOwnProperty.call(De.properties,St)&&delete De.properties[St];if(((Ue=Re.addOrUpdateProperties)===null||Ue===void 0?void 0:Ue.length)>0)for(const{key:St,value:Jt}of Re.addOrUpdateProperties)De.properties[St]=Jt}}(this._dataUpdateable,F.dataDiff,U),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(F){return m._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(F){return this._geoJSONIndex.getClusterExpansionZoom(F.clusterId)}getClusterChildren(F){return this._geoJSONIndex.getChildren(F.clusterId)}getClusterLeaves(F){return this._geoJSONIndex.getLeaves(F.clusterId,F.limit,F.offset)}}class gr{constructor(F){this.self=F,this.actor=new m.C(F),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(N,U)=>{if(this.externalWorkerSourceTypes[N])throw new Error(`Worker source with name "${N}" already registered.`);this.externalWorkerSourceTypes[N]=U},this.self.addProtocol=m.bg,this.self.removeProtocol=m.bh,this.self.registerRTLTextPlugin=N=>{if(m.bB.isParsed())throw new Error("RTL text plugin already registered.");m.bB.setMethods(N)},this.actor.registerMessageHandler("LDT",(N,U)=>this._getDEMWorkerSource(N,U.source).loadTile(U)),this.actor.registerMessageHandler("RDT",(N,U)=>m._(this,void 0,void 0,function*(){this._getDEMWorkerSource(N,U.source).removeTile(U)})),this.actor.registerMessageHandler("GCEZ",(N,U)=>m._(this,void 0,void 0,function*(){return this._getWorkerSource(N,U.type,U.source).getClusterExpansionZoom(U)})),this.actor.registerMessageHandler("GCC",(N,U)=>m._(this,void 0,void 0,function*(){return this._getWorkerSource(N,U.type,U.source).getClusterChildren(U)})),this.actor.registerMessageHandler("GCL",(N,U)=>m._(this,void 0,void 0,function*(){return this._getWorkerSource(N,U.type,U.source).getClusterLeaves(U)})),this.actor.registerMessageHandler("LD",(N,U)=>this._getWorkerSource(N,U.type,U.source).loadData(U)),this.actor.registerMessageHandler("GD",(N,U)=>this._getWorkerSource(N,U.type,U.source).getData()),this.actor.registerMessageHandler("LT",(N,U)=>this._getWorkerSource(N,U.type,U.source).loadTile(U)),this.actor.registerMessageHandler("RT",(N,U)=>this._getWorkerSource(N,U.type,U.source).reloadTile(U)),this.actor.registerMessageHandler("AT",(N,U)=>this._getWorkerSource(N,U.type,U.source).abortTile(U)),this.actor.registerMessageHandler("RMT",(N,U)=>this._getWorkerSource(N,U.type,U.source).removeTile(U)),this.actor.registerMessageHandler("RS",(N,U)=>m._(this,void 0,void 0,function*(){if(!this.workerSources[N]||!this.workerSources[N][U.type]||!this.workerSources[N][U.type][U.source])return;const ie=this.workerSources[N][U.type][U.source];delete this.workerSources[N][U.type][U.source],ie.removeSource!==void 0&&ie.removeSource(U)})),this.actor.registerMessageHandler("RM",N=>m._(this,void 0,void 0,function*(){delete this.layerIndexes[N],delete this.availableImages[N],delete this.workerSources[N],delete this.demWorkerSources[N]})),this.actor.registerMessageHandler("SR",(N,U)=>m._(this,void 0,void 0,function*(){this.referrer=U})),this.actor.registerMessageHandler("SRPS",(N,U)=>this._syncRTLPluginState(N,U)),this.actor.registerMessageHandler("IS",(N,U)=>m._(this,void 0,void 0,function*(){this.self.importScripts(U)})),this.actor.registerMessageHandler("SI",(N,U)=>this._setImages(N,U)),this.actor.registerMessageHandler("UL",(N,U)=>m._(this,void 0,void 0,function*(){this._getLayerIndex(N).update(U.layers,U.removedIds)})),this.actor.registerMessageHandler("SL",(N,U)=>m._(this,void 0,void 0,function*(){this._getLayerIndex(N).replace(U)}))}_setImages(F,N){return m._(this,void 0,void 0,function*(){this.availableImages[F]=N;for(const U in this.workerSources[F]){const ie=this.workerSources[F][U];for(const pe in ie)ie[pe].availableImages=N}})}_syncRTLPluginState(F,N){return m._(this,void 0,void 0,function*(){if(m.bB.isParsed())return m.bB.getState();if(N.pluginStatus!=="loading")return m.bB.setState(N),N;const U=N.pluginURL;if(this.self.importScripts(U),m.bB.isParsed()){const ie={pluginStatus:"loaded",pluginURL:U};return m.bB.setState(ie),ie}throw m.bB.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${U}`)})}_getAvailableImages(F){let N=this.availableImages[F];return N||(N=[]),N}_getLayerIndex(F){let N=this.layerIndexes[F];return N||(N=this.layerIndexes[F]=new c),N}_getWorkerSource(F,N,U){if(this.workerSources[F]||(this.workerSources[F]={}),this.workerSources[F][N]||(this.workerSources[F][N]={}),!this.workerSources[F][N][U]){const ie={sendAsync:(pe,_e)=>(pe.targetMapId=F,this.actor.sendAsync(pe,_e))};switch(N){case"vector":this.workerSources[F][N][U]=new C(ie,this._getLayerIndex(F),this._getAvailableImages(F));break;case"geojson":this.workerSources[F][N][U]=new ro(ie,this._getLayerIndex(F),this._getAvailableImages(F));break;default:this.workerSources[F][N][U]=new this.externalWorkerSourceTypes[N](ie,this._getLayerIndex(F),this._getAvailableImages(F))}}return this.workerSources[F][N][U]}_getDEMWorkerSource(F,N){return this.demWorkerSources[F]||(this.demWorkerSources[F]={}),this.demWorkerSources[F][N]||(this.demWorkerSources[F][N]=new L),this.demWorkerSources[F][N]}}return m.i(self)&&(self.worker=new gr(self)),gr}),h("index",["exports","./shared"],function(m,c){var I="4.4.1";let M,k;const C={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:_=>new Promise((i,a)=>{const d=requestAnimationFrame(i);_.signal.addEventListener("abort",()=>{cancelAnimationFrame(d),a(c.c())})}),getImageData(_,i=0){return this.getImageCanvasContext(_).getImageData(-i,-i,_.width+2*i,_.height+2*i)},getImageCanvasContext(_){const i=window.document.createElement("canvas"),a=i.getContext("2d",{willReadFrequently:!0});if(!a)throw new Error("failed to create canvas 2d context");return i.width=_.width,i.height=_.height,a.drawImage(_,0,0,_.width,_.height),a},resolveURL:_=>(M||(M=document.createElement("a")),M.href=_,M.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(k==null&&(k=matchMedia("(prefers-reduced-motion: reduce)")),k.matches)}};class L{static testProp(i){if(!L.docStyle)return i[0];for(let a=0;a<i.length;a++)if(i[a]in L.docStyle)return i[a];return i[0]}static create(i,a,d){const p=window.document.createElement(i);return a!==void 0&&(p.className=a),d&&d.appendChild(p),p}static createNS(i,a){return window.document.createElementNS(i,a)}static disableDrag(){L.docStyle&&L.selectProp&&(L.userSelect=L.docStyle[L.selectProp],L.docStyle[L.selectProp]="none")}static enableDrag(){L.docStyle&&L.selectProp&&(L.docStyle[L.selectProp]=L.userSelect)}static setTransform(i,a){i.style[L.transformProp]=a}static addEventListener(i,a,d,p={}){i.addEventListener(a,d,"passive"in p?p:p.capture)}static removeEventListener(i,a,d,p={}){i.removeEventListener(a,d,"passive"in p?p:p.capture)}static suppressClickInternal(i){i.preventDefault(),i.stopPropagation(),window.removeEventListener("click",L.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",L.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",L.suppressClickInternal,!0)},0)}static getScale(i){const a=i.getBoundingClientRect();return{x:a.width/i.offsetWidth||1,y:a.height/i.offsetHeight||1,boundingClientRect:a}}static getPoint(i,a,d){const p=a.boundingClientRect;return new c.P((d.clientX-p.left)/a.x-i.clientLeft,(d.clientY-p.top)/a.y-i.clientTop)}static mousePos(i,a){const d=L.getScale(i);return L.getPoint(i,d,a)}static touchPos(i,a){const d=[],p=L.getScale(i);for(let v=0;v<a.length;v++)d.push(L.getPoint(i,p,a[v]));return d}static mouseButton(i){return i.button}static remove(i){i.parentNode&&i.parentNode.removeChild(i)}}L.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,L.selectProp=L.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),L.transformProp=L.testProp(["transform","WebkitTransform"]);const q={supported:!1,testSupport:function(_){!ae&&W&&(Ie?ee(_):X=_)}};let X,W,ae=!1,Ie=!1;function ee(_){const i=_.createTexture();_.bindTexture(_.TEXTURE_2D,i);try{if(_.texImage2D(_.TEXTURE_2D,0,_.RGBA,_.RGBA,_.UNSIGNED_BYTE,W),_.isContextLost())return;q.supported=!0}catch{}_.deleteTexture(i),ae=!0}var H;typeof document<"u"&&(W=document.createElement("img"),W.onload=()=>{X&&ee(X),X=null,Ie=!0},W.onerror=()=>{ae=!0,X=null},W.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(_){let i,a,d,p;_.resetRequestQueue=()=>{i=[],a=0,d=0,p={}},_.addThrottleControl=T=>{const z=d++;return p[z]=T,z},_.removeThrottleControl=T=>{delete p[T],w()},_.getImage=(T,z,O=!0)=>new Promise((R,$)=>{q.supported&&(T.headers||(T.headers={}),T.headers.accept="image/webp,*/*"),c.e(T,{type:"image"}),i.push({abortController:z,requestParameters:T,supportImageRefresh:O,state:"queued",onError:G=>{$(G)},onSuccess:G=>{R(G)}}),w()});const v=T=>c._(this,void 0,void 0,function*(){T.state="running";const{requestParameters:z,supportImageRefresh:O,onError:R,onSuccess:$,abortController:G}=T,K=O===!1&&!c.i(self)&&!c.g(z.url)&&(!z.headers||Object.keys(z.headers).reduce((ue,ge)=>ue&&ge==="accept",!0));a++;const re=K?S(z,G):c.m(z,G);try{const ue=yield re;delete T.abortController,T.state="completed",ue.data instanceof HTMLImageElement||c.b(ue.data)?$(ue):ue.data&&$({data:yield(J=ue.data,typeof createImageBitmap=="function"?c.d(J):c.f(J)),cacheControl:ue.cacheControl,expires:ue.expires})}catch(ue){delete T.abortController,R(ue)}finally{a--,w()}var J}),w=()=>{const T=(()=>{for(const z of Object.keys(p))if(p[z]())return!0;return!1})()?c.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:c.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let z=a;z<T&&i.length>0;z++){const O=i.shift();O.abortController.signal.aborted?z--:v(O)}},S=(T,z)=>new Promise((O,R)=>{const $=new Image,G=T.url,K=T.credentials;K&&K==="include"?$.crossOrigin="use-credentials":(K&&K==="same-origin"||!c.s(G))&&($.crossOrigin="anonymous"),z.signal.addEventListener("abort",()=>{$.src="",R(c.c())}),$.fetchPriority="high",$.onload=()=>{$.onerror=$.onload=null,O({data:$})},$.onerror=()=>{$.onerror=$.onload=null,z.signal.aborted||R(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},$.src=G})}(H||(H={})),H.resetRequestQueue();class ce{constructor(i){this._transformRequestFn=i}transformRequest(i,a){return this._transformRequestFn&&this._transformRequestFn(i,a)||{url:i}}setTransformRequest(i){this._transformRequestFn=i}}function ne(_){var i=new c.A(3);return i[0]=_[0],i[1]=_[1],i[2]=_[2],i}var oe,Ae=function(_,i,a){return _[0]=i[0]-a[0],_[1]=i[1]-a[1],_[2]=i[2]-a[2],_};oe=new c.A(3),c.A!=Float32Array&&(oe[0]=0,oe[1]=0,oe[2]=0);var be=function(_){var i=_[0],a=_[1];return i*i+a*a};function Le(_){const i=[];if(typeof _=="string")i.push({id:"default",url:_});else if(_&&_.length>0){const a=[];for(const{id:d,url:p}of _){const v=`${d}${p}`;a.indexOf(v)===-1&&(a.push(v),i.push({id:d,url:p}))}}return i}function me(_,i,a){const d=_.split("?");return d[0]+=`${i}${a}`,d.join("?")}(function(){var _=new c.A(2);c.A!=Float32Array&&(_[0]=0,_[1]=0)})();class ke{constructor(i,a,d,p){this.context=i,this.format=d,this.texture=i.gl.createTexture(),this.update(a,p)}update(i,a,d){const{width:p,height:v}=i,w=!(this.size&&this.size[0]===p&&this.size[1]===v||d),{context:S}=this,{gl:T}=S;if(this.useMipmap=!!(a&&a.useMipmap),T.bindTexture(T.TEXTURE_2D,this.texture),S.pixelStoreUnpackFlipY.set(!1),S.pixelStoreUnpack.set(1),S.pixelStoreUnpackPremultiplyAlpha.set(this.format===T.RGBA&&(!a||a.premultiply!==!1)),w)this.size=[p,v],i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||c.b(i)?T.texImage2D(T.TEXTURE_2D,0,this.format,this.format,T.UNSIGNED_BYTE,i):T.texImage2D(T.TEXTURE_2D,0,this.format,p,v,0,this.format,T.UNSIGNED_BYTE,i.data);else{const{x:z,y:O}=d||{x:0,y:0};i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||c.b(i)?T.texSubImage2D(T.TEXTURE_2D,0,z,O,T.RGBA,T.UNSIGNED_BYTE,i):T.texSubImage2D(T.TEXTURE_2D,0,z,O,p,v,T.RGBA,T.UNSIGNED_BYTE,i.data)}this.useMipmap&&this.isSizePowerOfTwo()&&T.generateMipmap(T.TEXTURE_2D)}bind(i,a,d){const{context:p}=this,{gl:v}=p;v.bindTexture(v.TEXTURE_2D,this.texture),d!==v.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(d=v.LINEAR),i!==this.filter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,i),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,d||i),this.filter=i),a!==this.wrap&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,a),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,a),this.wrap=a)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:i}=this.context;i.deleteTexture(this.texture),this.texture=null}}function Me(_){const{userImage:i}=_;return!!(i&&i.render&&i.render())&&(_.data.replace(new Uint8Array(i.data.buffer)),!0)}class Oe extends c.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(i){if(this.loaded!==i&&(this.loaded=i,i)){for(const{ids:a,promiseResolve:d}of this.requestors)d(this._getImagesForIds(a));this.requestors=[]}}getImage(i){const a=this.images[i];if(a&&!a.data&&a.spriteData){const d=a.spriteData;a.data=new c.R({width:d.width,height:d.height},d.context.getImageData(d.x,d.y,d.width,d.height).data),a.spriteData=null}return a}addImage(i,a){if(this.images[i])throw new Error(`Image id ${i} already exist, use updateImage instead`);this._validate(i,a)&&(this.images[i]=a)}_validate(i,a){let d=!0;const p=a.data||a.spriteData;return this._validateStretch(a.stretchX,p&&p.width)||(this.fire(new c.j(new Error(`Image "${i}" has invalid "stretchX" value`))),d=!1),this._validateStretch(a.stretchY,p&&p.height)||(this.fire(new c.j(new Error(`Image "${i}" has invalid "stretchY" value`))),d=!1),this._validateContent(a.content,a)||(this.fire(new c.j(new Error(`Image "${i}" has invalid "content" value`))),d=!1),d}_validateStretch(i,a){if(!i)return!0;let d=0;for(const p of i){if(p[0]<d||p[1]<p[0]||a<p[1])return!1;d=p[1]}return!0}_validateContent(i,a){if(!i)return!0;if(i.length!==4)return!1;const d=a.spriteData,p=d&&d.width||a.data.width,v=d&&d.height||a.data.height;return!(i[0]<0||p<i[0]||i[1]<0||v<i[1]||i[2]<0||p<i[2]||i[3]<0||v<i[3]||i[2]<i[0]||i[3]<i[1])}updateImage(i,a,d=!0){const p=this.getImage(i);if(d&&(p.data.width!==a.data.width||p.data.height!==a.data.height))throw new Error(`size mismatch between old image (${p.data.width}x${p.data.height}) and new image (${a.data.width}x${a.data.height}).`);a.version=p.version+1,this.images[i]=a,this.updatedImages[i]=!0}removeImage(i){const a=this.images[i];delete this.images[i],delete this.patterns[i],a.userImage&&a.userImage.onRemove&&a.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(i){return new Promise((a,d)=>{let p=!0;if(!this.isLoaded())for(const v of i)this.images[v]||(p=!1);this.isLoaded()||p?a(this._getImagesForIds(i)):this.requestors.push({ids:i,promiseResolve:a})})}_getImagesForIds(i){const a={};for(const d of i){let p=this.getImage(d);p||(this.fire(new c.k("styleimagemissing",{id:d})),p=this.getImage(d)),p?a[d]={data:p.data.clone(),pixelRatio:p.pixelRatio,sdf:p.sdf,version:p.version,stretchX:p.stretchX,stretchY:p.stretchY,content:p.content,textFitWidth:p.textFitWidth,textFitHeight:p.textFitHeight,hasRenderCallback:!!(p.userImage&&p.userImage.render)}:c.w(`Image "${d}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return a}getPixelSize(){const{width:i,height:a}=this.atlasImage;return{width:i,height:a}}getPattern(i){const a=this.patterns[i],d=this.getImage(i);if(!d)return null;if(a&&a.position.version===d.version)return a.position;if(a)a.position.version=d.version;else{const p={w:d.data.width+2,h:d.data.height+2,x:0,y:0},v=new c.I(p,d);this.patterns[i]={bin:p,position:v}}return this._updatePatternAtlas(),this.patterns[i].position}bind(i){const a=i.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new ke(i,this.atlasImage,a.RGBA),this.atlasTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE)}_updatePatternAtlas(){const i=[];for(const v in this.patterns)i.push(this.patterns[v].bin);const{w:a,h:d}=c.p(i),p=this.atlasImage;p.resize({width:a||1,height:d||1});for(const v in this.patterns){const{bin:w}=this.patterns[v],S=w.x+1,T=w.y+1,z=this.getImage(v).data,O=z.width,R=z.height;c.R.copy(z,p,{x:0,y:0},{x:S,y:T},{width:O,height:R}),c.R.copy(z,p,{x:0,y:R-1},{x:S,y:T-1},{width:O,height:1}),c.R.copy(z,p,{x:0,y:0},{x:S,y:T+R},{width:O,height:1}),c.R.copy(z,p,{x:O-1,y:0},{x:S-1,y:T},{width:1,height:R}),c.R.copy(z,p,{x:0,y:0},{x:S+O,y:T},{width:1,height:R})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(i){for(const a of i){if(this.callbackDispatchedThisFrame[a])continue;this.callbackDispatchedThisFrame[a]=!0;const d=this.getImage(a);d||c.w(`Image with ID: "${a}" was not found`),Me(d)&&this.updateImage(a,d)}}}const Ge=1e20;function rt(_,i,a,d,p,v,w,S,T){for(let z=i;z<i+d;z++)Ke(_,a*v+z,v,p,w,S,T);for(let z=a;z<a+p;z++)Ke(_,z*v+i,1,d,w,S,T)}function Ke(_,i,a,d,p,v,w){v[0]=0,w[0]=-Ge,w[1]=Ge,p[0]=_[i];for(let S=1,T=0,z=0;S<d;S++){p[S]=_[i+S*a];const O=S*S;do{const R=v[T];z=(p[S]-p[R]+O-R*R)/(S-R)/2}while(z<=w[T]&&--T>-1);T++,v[T]=S,w[T]=z,w[T+1]=Ge}for(let S=0,T=0;S<d;S++){for(;w[T+1]<S;)T++;const z=v[T],O=S-z;_[i+S*a]=p[z]+O*O}}class dt{constructor(i,a){this.requestManager=i,this.localIdeographFontFamily=a,this.entries={}}setURL(i){this.url=i}getGlyphs(i){return c._(this,void 0,void 0,function*(){const a=[];for(const v in i)for(const w of i[v])a.push(this._getAndCacheGlyphsPromise(v,w));const d=yield Promise.all(a),p={};for(const{stack:v,id:w,glyph:S}of d)p[v]||(p[v]={}),p[v][w]=S&&{id:S.id,bitmap:S.bitmap.clone(),metrics:S.metrics};return p})}_getAndCacheGlyphsPromise(i,a){return c._(this,void 0,void 0,function*(){let d=this.entries[i];d||(d=this.entries[i]={glyphs:{},requests:{},ranges:{}});let p=d.glyphs[a];if(p!==void 0)return{stack:i,id:a,glyph:p};if(p=this._tinySDF(d,i,a),p)return d.glyphs[a]=p,{stack:i,id:a,glyph:p};const v=Math.floor(a/256);if(256*v>65535)throw new Error("glyphs > 65535 not supported");if(d.ranges[v])return{stack:i,id:a,glyph:p};if(!this.url)throw new Error("glyphsUrl is not set");if(!d.requests[v]){const S=dt.loadGlyphRange(i,v,this.url,this.requestManager);d.requests[v]=S}const w=yield d.requests[v];for(const S in w)this._doesCharSupportLocalGlyph(+S)||(d.glyphs[+S]=w[+S]);return d.ranges[v]=!0,{stack:i,id:a,glyph:w[a]||null}})}_doesCharSupportLocalGlyph(i){return!!this.localIdeographFontFamily&&(c.u["CJK Unified Ideographs"](i)||c.u["Hangul Syllables"](i)||c.u.Hiragana(i)||c.u.Katakana(i))}_tinySDF(i,a,d){const p=this.localIdeographFontFamily;if(!p||!this._doesCharSupportLocalGlyph(d))return;let v=i.tinySDF;if(!v){let S="400";/bold/i.test(a)?S="900":/medium/i.test(a)?S="500":/light/i.test(a)&&(S="200"),v=i.tinySDF=new dt.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:p,fontWeight:S})}const w=v.draw(String.fromCharCode(d));return{id:d,bitmap:new c.o({width:w.width||60,height:w.height||60},w.data),metrics:{width:w.glyphWidth/2||24,height:w.glyphHeight/2||24,left:w.glyphLeft/2+.5||0,top:w.glyphTop/2-27.5||-8,advance:w.glyphAdvance/2||24,isDoubleResolution:!0}}}}dt.loadGlyphRange=function(_,i,a,d){return c._(this,void 0,void 0,function*(){const p=256*i,v=p+255,w=d.transformRequest(a.replace("{fontstack}",_).replace("{range}",`${p}-${v}`),"Glyphs"),S=yield c.l(w,new AbortController);if(!S||!S.data)throw new Error(`Could not load glyph range. range: ${i}, ${p}-${v}`);const T={};for(const z of c.n(S.data))T[z.id]=z;return T})},dt.TinySDF=class{constructor({fontSize:_=24,buffer:i=3,radius:a=8,cutoff:d=.25,fontFamily:p="sans-serif",fontWeight:v="normal",fontStyle:w="normal"}={}){this.buffer=i,this.cutoff=d,this.radius=a;const S=this.size=_+4*i,T=this._createCanvas(S),z=this.ctx=T.getContext("2d",{willReadFrequently:!0});z.font=`${w} ${v} ${_}px ${p}`,z.textBaseline="alphabetic",z.textAlign="left",z.fillStyle="black",this.gridOuter=new Float64Array(S*S),this.gridInner=new Float64Array(S*S),this.f=new Float64Array(S),this.z=new Float64Array(S+1),this.v=new Uint16Array(S)}_createCanvas(_){const i=document.createElement("canvas");return i.width=i.height=_,i}draw(_){const{width:i,actualBoundingBoxAscent:a,actualBoundingBoxDescent:d,actualBoundingBoxLeft:p,actualBoundingBoxRight:v}=this.ctx.measureText(_),w=Math.ceil(a),S=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(v-p))),T=Math.min(this.size-this.buffer,w+Math.ceil(d)),z=S+2*this.buffer,O=T+2*this.buffer,R=Math.max(z*O,0),$=new Uint8ClampedArray(R),G={data:$,width:z,height:O,glyphWidth:S,glyphHeight:T,glyphTop:w,glyphLeft:0,glyphAdvance:i};if(S===0||T===0)return G;const{ctx:K,buffer:re,gridInner:J,gridOuter:ue}=this;K.clearRect(re,re,S,T),K.fillText(_,re,re+w);const ge=K.getImageData(re,re,S,T);ue.fill(Ge,0,R),J.fill(0,0,R);for(let te=0;te<T;te++)for(let ve=0;ve<S;ve++){const Se=ge.data[4*(te*S+ve)+3]/255;if(Se===0)continue;const Pe=(te+re)*z+ve+re;if(Se===1)ue[Pe]=0,J[Pe]=Ge;else{const Ne=.5-Se;ue[Pe]=Ne>0?Ne*Ne:0,J[Pe]=Ne<0?Ne*Ne:0}}rt(ue,0,0,z,O,z,this.f,this.v,this.z),rt(J,re,re,S,T,z,this.f,this.v,this.z);for(let te=0;te<R;te++){const ve=Math.sqrt(ue[te])-Math.sqrt(J[te]);$[te]=Math.round(255-255*(ve/this.radius+this.cutoff))}return G}};class nt{constructor(){this.specification=c.v.light.position}possiblyEvaluate(i,a){return c.y(i.expression.evaluate(a))}interpolate(i,a,d){return{x:c.z.number(i.x,a.x,d),y:c.z.number(i.y,a.y,d),z:c.z.number(i.z,a.z,d)}}}let ti;class Ut extends c.E{constructor(i){super(),ti=ti||new c.q({anchor:new c.D(c.v.light.anchor),position:new nt,color:new c.D(c.v.light.color),intensity:new c.D(c.v.light.intensity)}),this._transitionable=new c.T(ti),this.setLight(i),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(i,a={}){if(!this._validate(c.r,i,a))for(const d in i){const p=i[d];d.endsWith("-transition")?this._transitionable.setTransition(d.slice(0,-11),p):this._transitionable.setValue(d,p)}}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,a,d){return(!d||d.validate!==!1)&&c.t(this,i.call(c.x,{value:a,style:{glyphs:!0,sprite:!0},styleSpec:c.v}))}}class Nt{constructor(i,a){this.width=i,this.height=a,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(i,a){const d=i.join(",")+String(a);return this.dashEntry[d]||(this.dashEntry[d]=this.addDash(i,a)),this.dashEntry[d]}getDashRanges(i,a,d){const p=[];let v=i.length%2==1?-i[i.length-1]*d:0,w=i[0]*d,S=!0;p.push({left:v,right:w,isDash:S,zeroLength:i[0]===0});let T=i[0];for(let z=1;z<i.length;z++){S=!S;const O=i[z];v=T*d,T+=O,w=T*d,p.push({left:v,right:w,isDash:S,zeroLength:O===0})}return p}addRoundDash(i,a,d){const p=a/2;for(let v=-d;v<=d;v++){const w=this.width*(this.nextRow+d+v);let S=0,T=i[S];for(let z=0;z<this.width;z++){z/T.right>1&&(T=i[++S]);const O=Math.abs(z-T.left),R=Math.abs(z-T.right),$=Math.min(O,R);let G;const K=v/d*(p+1);if(T.isDash){const re=p-Math.abs(K);G=Math.sqrt($*$+re*re)}else G=p-Math.sqrt($*$+K*K);this.data[w+z]=Math.max(0,Math.min(255,G+128))}}}addRegularDash(i){for(let S=i.length-1;S>=0;--S){const T=i[S],z=i[S+1];T.zeroLength?i.splice(S,1):z&&z.isDash===T.isDash&&(z.left=T.left,i.splice(S,1))}const a=i[0],d=i[i.length-1];a.isDash===d.isDash&&(a.left=d.left-this.width,d.right=a.right+this.width);const p=this.width*this.nextRow;let v=0,w=i[v];for(let S=0;S<this.width;S++){S/w.right>1&&(w=i[++v]);const T=Math.abs(S-w.left),z=Math.abs(S-w.right),O=Math.min(T,z);this.data[p+S]=Math.max(0,Math.min(255,(w.isDash?O:-O)+128))}}addDash(i,a){const d=a?7:0,p=2*d+1;if(this.nextRow+p>this.height)return c.w("LineAtlas out of space"),null;let v=0;for(let S=0;S<i.length;S++)v+=i[S];if(v!==0){const S=this.width/v,T=this.getDashRanges(i,this.width,S);a?this.addRoundDash(T,S,d):this.addRegularDash(T)}const w={y:(this.nextRow+d+.5)/this.height,height:2*d/this.height,width:v};return this.nextRow+=p,this.dirty=!0,w}bind(i){const a=i.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,this.data))}}const jt="maplibre_preloaded_worker_pool";class Si{constructor(){this.active={}}acquire(i){if(!this.workers)for(this.workers=[];this.workers.length<Si.workerCount;)this.workers.push(new Worker(c.a.WORKER_URL));return this.active[i]=!0,this.workers.slice()}release(i){delete this.active[i],this.numActive()===0&&(this.workers.forEach(a=>{a.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[jt]}numActive(){return Object.keys(this.active).length}}const Qi=Math.floor(C.hardwareConcurrency/2);let Oi,fi;function Pi(){return Oi||(Oi=new Si),Oi}Si.workerCount=c.B(globalThis)?Math.max(Math.min(Qi,3),1):1;class Bi{constructor(i,a){this.workerPool=i,this.actors=[],this.currentActor=0,this.id=a;const d=this.workerPool.acquire(a);for(let p=0;p<d.length;p++){const v=new c.C(d[p],a);v.name=`Worker ${p}`,this.actors.push(v)}if(!this.actors.length)throw new Error("No actors found")}broadcast(i,a){const d=[];for(const p of this.actors)d.push(p.sendAsync({type:i,data:a}));return Promise.all(d)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(i=!0){this.actors.forEach(a=>{a.remove()}),this.actors=[],i&&this.workerPool.release(this.id)}registerMessageHandler(i,a){for(const d of this.actors)d.registerMessageHandler(i,a)}}function Br(){return fi||(fi=new Bi(Pi(),c.G),fi.registerMessageHandler("GR",(_,i,a)=>c.m(i,a))),fi}function pr(_,i){const a=c.F();return c.H(a,a,[1,1,0]),c.J(a,a,[.5*_.width,.5*_.height,1]),c.K(a,a,_.calculatePosMatrix(i.toUnwrapped()))}function Fr(_,i,a,d,p,v){const w=function(R,$,G){if(R)for(const K of R){const re=$[K];if(re&&re.source===G&&re.type==="fill-extrusion")return!0}else for(const K in $){const re=$[K];if(re.source===G&&re.type==="fill-extrusion")return!0}return!1}(p&&p.layers,i,_.id),S=v.maxPitchScaleFactor(),T=_.tilesIn(d,S,w);T.sort(lr);const z=[];for(const R of T)z.push({wrappedTileID:R.tileID.wrapped().key,queryResults:R.tile.queryRenderedFeatures(i,a,_._state,R.queryGeometry,R.cameraQueryGeometry,R.scale,p,v,S,pr(_.transform,R.tileID))});const O=function(R){const $={},G={};for(const K of R){const re=K.queryResults,J=K.wrappedTileID,ue=G[J]=G[J]||{};for(const ge in re){const te=re[ge],ve=ue[ge]=ue[ge]||{},Se=$[ge]=$[ge]||[];for(const Pe of te)ve[Pe.featureIndex]||(ve[Pe.featureIndex]=!0,Se.push(Pe))}}return $}(z);for(const R in O)O[R].forEach($=>{const G=$.feature,K=_.getFeatureState(G.layer["source-layer"],G.id);G.source=G.layer.source,G.layer["source-layer"]&&(G.sourceLayer=G.layer["source-layer"]),G.state=K});return O}function lr(_,i){const a=_.tileID,d=i.tileID;return a.overscaledZ-d.overscaledZ||a.canonical.y-d.canonical.y||a.wrap-d.wrap||a.canonical.x-d.canonical.x}function he(_,i,a){return c._(this,void 0,void 0,function*(){let d=_;if(_.url?d=(yield c.h(i.transformRequest(_.url,"Source"),a)).data:yield C.frameAsync(a),!d)return null;const p=c.L(c.e(d,_),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in d&&d.vector_layers&&(p.vectorLayerIds=d.vector_layers.map(v=>v.id)),p})}class ye{constructor(i,a){i&&(a?this.setSouthWest(i).setNorthEast(a):Array.isArray(i)&&(i.length===4?this.setSouthWest([i[0],i[1]]).setNorthEast([i[2],i[3]]):this.setSouthWest(i[0]).setNorthEast(i[1])))}setNorthEast(i){return this._ne=i instanceof c.M?new c.M(i.lng,i.lat):c.M.convert(i),this}setSouthWest(i){return this._sw=i instanceof c.M?new c.M(i.lng,i.lat):c.M.convert(i),this}extend(i){const a=this._sw,d=this._ne;let p,v;if(i instanceof c.M)p=i,v=i;else{if(!(i instanceof ye))return Array.isArray(i)?i.length===4||i.every(Array.isArray)?this.extend(ye.convert(i)):this.extend(c.M.convert(i)):i&&("lng"in i||"lon"in i)&&"lat"in i?this.extend(c.M.convert(i)):this;if(p=i._sw,v=i._ne,!p||!v)return this}return a||d?(a.lng=Math.min(p.lng,a.lng),a.lat=Math.min(p.lat,a.lat),d.lng=Math.max(v.lng,d.lng),d.lat=Math.max(v.lat,d.lat)):(this._sw=new c.M(p.lng,p.lat),this._ne=new c.M(v.lng,v.lat)),this}getCenter(){return new c.M((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new c.M(this.getWest(),this.getNorth())}getSouthEast(){return new c.M(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(i){const{lng:a,lat:d}=c.M.convert(i);let p=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(p=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=d&&d<=this._ne.lat&&p}static convert(i){return i instanceof ye?i:i&&new ye(i)}static fromLngLat(i,a=0){const d=360*a/40075017,p=d/Math.cos(Math.PI/180*i.lat);return new ye(new c.M(i.lng-p,i.lat-d),new c.M(i.lng+p,i.lat+d))}}class Be{constructor(i,a,d){this.bounds=ye.convert(this.validateBounds(i)),this.minzoom=a||0,this.maxzoom=d||24}validateBounds(i){return Array.isArray(i)&&i.length===4?[Math.max(-180,i[0]),Math.max(-90,i[1]),Math.min(180,i[2]),Math.min(90,i[3])]:[-180,-90,180,90]}contains(i){const a=Math.pow(2,i.z),d=Math.floor(c.N(this.bounds.getWest())*a),p=Math.floor(c.O(this.bounds.getNorth())*a),v=Math.ceil(c.N(this.bounds.getEast())*a),w=Math.ceil(c.O(this.bounds.getSouth())*a);return i.x>=d&&i.x<v&&i.y>=p&&i.y<w}}class le extends c.E{constructor(i,a,d,p){if(super(),this.id=i,this.dispatcher=d,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.e(this,c.L(a,["url","scheme","tileSize","promoteId"])),this._options=c.e({type:"vector"},a),this._collectResourceTiming=a.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(p)}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const i=yield he(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),i&&(c.e(this,i),i.bounds&&(this.tileBounds=new Be(i.bounds,this.minzoom,this.maxzoom)),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})))}catch(i){this._tileJSONRequest=null,this.fire(new c.j(i))}})}loaded(){return this._loaded}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}onAdd(i){this.map=i,this.load()}setSourceProperty(i){this._tileJSONRequest&&this._tileJSONRequest.abort(),i(),this.load()}setTiles(i){return this.setSourceProperty(()=>{this._options.tiles=i}),this}setUrl(i){return this.setSourceProperty(()=>{this.url=i,this._options.url=i}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return c.e({},this._options)}loadTile(i){return c._(this,void 0,void 0,function*(){const a=i.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),d={request:this.map._requestManager.transformRequest(a,"Tile"),uid:i.uid,tileID:i.tileID,zoom:i.tileID.overscaledZ,tileSize:this.tileSize*i.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};d.request.collectResourceTiming=this._collectResourceTiming;let p="RT";if(i.actor&&i.state!=="expired"){if(i.state==="loading")return new Promise((v,w)=>{i.reloadPromise={resolve:v,reject:w}})}else i.actor=this.dispatcher.getActor(),p="LT";i.abortController=new AbortController;try{const v=yield i.actor.sendAsync({type:p,data:d},i.abortController);if(delete i.abortController,i.aborted)return;this._afterTileLoadWorkerResponse(i,v)}catch(v){if(delete i.abortController,i.aborted)return;if(v&&v.status!==404)throw v;this._afterTileLoadWorkerResponse(i,null)}})}_afterTileLoadWorkerResponse(i,a){if(a&&a.resourceTiming&&(i.resourceTiming=a.resourceTiming),a&&this.map._refreshExpiredTiles&&i.setExpiryData(a),i.loadVectorData(a,this.map.painter),i.reloadPromise){const d=i.reloadPromise;i.reloadPromise=null,this.loadTile(i).then(d.resolve).catch(d.reject)}}abortTile(i){return c._(this,void 0,void 0,function*(){i.abortController&&(i.abortController.abort(),delete i.abortController),i.actor&&(yield i.actor.sendAsync({type:"AT",data:{uid:i.uid,type:this.type,source:this.id}}))})}unloadTile(i){return c._(this,void 0,void 0,function*(){i.unloadVectorData(),i.actor&&(yield i.actor.sendAsync({type:"RMT",data:{uid:i.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class He extends c.E{constructor(i,a,d,p){super(),this.id=i,this.dispatcher=d,this.setEventedParent(p),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.e({type:"raster"},a),c.e(this,c.L(a,["url","scheme","tileSize"]))}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const i=yield he(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,i&&(c.e(this,i),i.bounds&&(this.tileBounds=new Be(i.bounds,this.minzoom,this.maxzoom)),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})))}catch(i){this._tileJSONRequest=null,this.fire(new c.j(i))}})}loaded(){return this._loaded}onAdd(i){this.map=i,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(i){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),i(),this.load()}setTiles(i){return this.setSourceProperty(()=>{this._options.tiles=i}),this}setUrl(i){return this.setSourceProperty(()=>{this.url=i,this._options.url=i}),this}serialize(){return c.e({},this._options)}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}loadTile(i){return c._(this,void 0,void 0,function*(){const a=i.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);i.abortController=new AbortController;try{const d=yield H.getImage(this.map._requestManager.transformRequest(a,"Tile"),i.abortController,this.map._refreshExpiredTiles);if(delete i.abortController,i.aborted)return void(i.state="unloaded");if(d&&d.data){this.map._refreshExpiredTiles&&d.cacheControl&&d.expires&&i.setExpiryData({cacheControl:d.cacheControl,expires:d.expires});const p=this.map.painter.context,v=p.gl,w=d.data;i.texture=this.map.painter.getTileTexture(w.width),i.texture?i.texture.update(w,{useMipmap:!0}):(i.texture=new ke(p,w,v.RGBA,{useMipmap:!0}),i.texture.bind(v.LINEAR,v.CLAMP_TO_EDGE,v.LINEAR_MIPMAP_NEAREST),p.extTextureFilterAnisotropic&&v.texParameterf(v.TEXTURE_2D,p.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,p.extTextureFilterAnisotropicMax)),i.state="loaded"}}catch(d){if(delete i.abortController,i.aborted)i.state="unloaded";else if(d)throw i.state="errored",d}})}abortTile(i){return c._(this,void 0,void 0,function*(){i.abortController&&(i.abortController.abort(),delete i.abortController)})}unloadTile(i){return c._(this,void 0,void 0,function*(){i.texture&&this.map.painter.saveTileTexture(i.texture)})}hasTransition(){return!1}}class tt extends He{constructor(i,a,d,p){super(i,a,d,p),this.type="raster-dem",this.maxzoom=22,this._options=c.e({type:"raster-dem"},a),this.encoding=a.encoding||"mapbox",this.redFactor=a.redFactor,this.greenFactor=a.greenFactor,this.blueFactor=a.blueFactor,this.baseShift=a.baseShift}loadTile(i){return c._(this,void 0,void 0,function*(){const a=i.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),d=this.map._requestManager.transformRequest(a,"Tile");i.neighboringTiles=this._getNeighboringTiles(i.tileID),i.abortController=new AbortController;try{const p=yield H.getImage(d,i.abortController,this.map._refreshExpiredTiles);if(delete i.abortController,i.aborted)return void(i.state="unloaded");if(p&&p.data){const v=p.data;this.map._refreshExpiredTiles&&p.cacheControl&&p.expires&&i.setExpiryData({cacheControl:p.cacheControl,expires:p.expires});const w=c.b(v)&&c.S()?v:yield this.readImageNow(v),S={type:this.type,uid:i.uid,source:this.id,rawImageData:w,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!i.actor||i.state==="expired"){i.actor=this.dispatcher.getActor();const T=yield i.actor.sendAsync({type:"LDT",data:S});i.dem=T,i.needsHillshadePrepare=!0,i.needsTerrainPrepare=!0,i.state="loaded"}}}catch(p){if(delete i.abortController,i.aborted)i.state="unloaded";else if(p)throw i.state="errored",p}})}readImageNow(i){return c._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&c.U()){const a=i.width+2,d=i.height+2;try{return new c.R({width:a,height:d},yield c.V(i,-1,-1,a,d))}catch{}}return C.getImageData(i,1)})}_getNeighboringTiles(i){const a=i.canonical,d=Math.pow(2,a.z),p=(a.x-1+d)%d,v=a.x===0?i.wrap-1:i.wrap,w=(a.x+1+d)%d,S=a.x+1===d?i.wrap+1:i.wrap,T={};return T[new c.Q(i.overscaledZ,v,a.z,p,a.y).key]={backfilled:!1},T[new c.Q(i.overscaledZ,S,a.z,w,a.y).key]={backfilled:!1},a.y>0&&(T[new c.Q(i.overscaledZ,v,a.z,p,a.y-1).key]={backfilled:!1},T[new c.Q(i.overscaledZ,i.wrap,a.z,a.x,a.y-1).key]={backfilled:!1},T[new c.Q(i.overscaledZ,S,a.z,w,a.y-1).key]={backfilled:!1}),a.y+1<d&&(T[new c.Q(i.overscaledZ,v,a.z,p,a.y+1).key]={backfilled:!1},T[new c.Q(i.overscaledZ,i.wrap,a.z,a.x,a.y+1).key]={backfilled:!1},T[new c.Q(i.overscaledZ,S,a.z,w,a.y+1).key]={backfilled:!1}),T}unloadTile(i){return c._(this,void 0,void 0,function*(){i.demTexture&&this.map.painter.saveTileTexture(i.demTexture),i.fbo&&(i.fbo.destroy(),delete i.fbo),i.dem&&delete i.dem,delete i.neighboringTiles,i.state="unloaded",i.actor&&(yield i.actor.sendAsync({type:"RDT",data:{type:this.type,uid:i.uid,source:this.id}}))})}}class Ze extends c.E{constructor(i,a,d,p){super(),this.id=i,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=d.getActor(),this.setEventedParent(p),this._data=a.data,this._options=c.e({},a),this._collectResourceTiming=a.collectResourceTiming,a.maxzoom!==void 0&&(this.maxzoom=a.maxzoom),a.type&&(this.type=a.type),a.attribution&&(this.attribution=a.attribution),this.promoteId=a.promoteId;const v=c.W/this.tileSize;this.workerOptions=c.e({source:this.id,cluster:a.cluster||!1,geojsonVtOptions:{buffer:(a.buffer!==void 0?a.buffer:128)*v,tolerance:(a.tolerance!==void 0?a.tolerance:.375)*v,extent:c.W,maxZoom:this.maxzoom,lineMetrics:a.lineMetrics||!1,generateId:a.generateId||!1},superclusterOptions:{maxZoom:a.clusterMaxZoom!==void 0?a.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,a.clusterMinPoints||2),extent:c.W,radius:(a.clusterRadius||50)*v,log:!1,generateId:a.generateId||!1},clusterProperties:a.clusterProperties,filter:a.filter},a.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return c._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(i){this.map=i,this.load()}setData(i){return this._data=i,this._updateWorkerData(),this}updateData(i){return this._updateWorkerData(i),this}getData(){return c._(this,void 0,void 0,function*(){const i=c.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:i})})}setClusterOptions(i){return this.workerOptions.cluster=i.cluster,i&&(i.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=i.clusterRadius),i.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=i.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(i){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:i,source:this.id}})}getClusterChildren(i){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:i,source:this.id}})}getClusterLeaves(i,a,d){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:i,limit:a,offset:d}})}_updateWorkerData(i){return c._(this,void 0,void 0,function*(){const a=c.e({type:this.type},this.workerOptions);i?a.dataDiff=i:typeof this._data=="string"?(a.request=this.map._requestManager.transformRequest(C.resolveURL(this._data),"Source"),a.request.collectResourceTiming=this._collectResourceTiming):a.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new c.k("dataloading",{dataType:"source"}));try{const d=yield this.actor.sendAsync({type:"LD",data:a});if(this._pendingLoads--,this._removed||d.abandoned)return void this.fire(new c.k("dataabort",{dataType:"source"}));let p=null;d.resourceTiming&&d.resourceTiming[this.id]&&(p=d.resourceTiming[this.id].slice(0));const v={dataType:"source"};this._collectResourceTiming&&p&&p.length>0&&c.e(v,{resourceTiming:p}),this.fire(new c.k("data",Object.assign(Object.assign({},v),{sourceDataType:"metadata"}))),this.fire(new c.k("data",Object.assign(Object.assign({},v),{sourceDataType:"content"})))}catch(d){if(this._pendingLoads--,this._removed)return void this.fire(new c.k("dataabort",{dataType:"source"}));this.fire(new c.j(d))}})}loaded(){return this._pendingLoads===0}loadTile(i){return c._(this,void 0,void 0,function*(){const a=i.actor?"RT":"LT";i.actor=this.actor;const d={type:this.type,uid:i.uid,tileID:i.tileID,zoom:i.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};i.abortController=new AbortController;const p=yield this.actor.sendAsync({type:a,data:d},i.abortController);delete i.abortController,i.unloadVectorData(),i.aborted||i.loadVectorData(p,this.map.painter,a==="RT")})}abortTile(i){return c._(this,void 0,void 0,function*(){i.abortController&&(i.abortController.abort(),delete i.abortController),i.aborted=!0})}unloadTile(i){return c._(this,void 0,void 0,function*(){i.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:i.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return c.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var je=c.X([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Qe extends c.E{constructor(i,a,d,p){super(),this.id=i,this.dispatcher=d,this.coordinates=a.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(p),this.options=a}load(i){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const a=yield H.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,a&&a.data&&(this.image=a.data,i&&(this.coordinates=i),this._finishLoading())}catch(a){this._request=null,this._loaded=!0,this.fire(new c.j(a))}})}loaded(){return this._loaded}updateImage(i){return i.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=i.url,this.load(i.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(i){this.map=i,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(i){this.coordinates=i;const a=i.map(c.Y.fromLngLat);this.tileID=function(p){let v=1/0,w=1/0,S=-1/0,T=-1/0;for(const $ of p)v=Math.min(v,$.x),w=Math.min(w,$.y),S=Math.max(S,$.x),T=Math.max(T,$.y);const z=Math.max(S-v,T-w),O=Math.max(0,Math.floor(-Math.log(z)/Math.LN2)),R=Math.pow(2,O);return new c.a0(O,Math.floor((v+S)/2*R),Math.floor((w+T)/2*R))}(a),this.minzoom=this.maxzoom=this.tileID.z;const d=a.map(p=>this.tileID.getTilePoint(p)._round());return this._boundsArray=new c.Z,this._boundsArray.emplaceBack(d[0].x,d[0].y,0,0),this._boundsArray.emplaceBack(d[1].x,d[1].y,c.W,0),this._boundsArray.emplaceBack(d[3].x,d[3].y,0,c.W),this._boundsArray.emplaceBack(d[2].x,d[2].y,c.W,c.W),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const i=this.map.painter.context,a=i.gl;this.boundsBuffer||(this.boundsBuffer=i.createVertexBuffer(this._boundsArray,je.members)),this.boundsSegments||(this.boundsSegments=c.$.simpleSegment(0,0,4,2)),this.texture||(this.texture=new ke(i,this.image,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let d=!1;for(const p in this.tiles){const v=this.tiles[p];v.state!=="loaded"&&(v.state="loaded",v.texture=this.texture,d=!0)}d&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(i){return c._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(i.tileID.canonical)?(this.tiles[String(i.tileID.wrap)]=i,i.buckets={}):i.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class We extends Qe{constructor(i,a,d,p){super(i,a,d,p),this.roundZoom=!0,this.type="video",this.options=a}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1;const i=this.options;this.urls=[];for(const a of i.urls)this.urls.push(this.map._requestManager.transformRequest(a,"Source").url);try{const a=yield c.a2(this.urls);if(this._loaded=!0,!a)return;this.video=a,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(a){this.fire(new c.j(a))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(i){if(this.video){const a=this.video.seekable;i<a.start(0)||i>a.end(0)?this.fire(new c.j(new c.a1(`sources.${this.id}`,null,`Playback for this video can be set only between the ${a.start(0)} and ${a.end(0)}-second mark.`))):this.video.currentTime=i}}getVideo(){return this.video}onAdd(i){this.map||(this.map=i,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const i=this.map.painter.context,a=i.gl;this.boundsBuffer||(this.boundsBuffer=i.createVertexBuffer(this._boundsArray,je.members)),this.boundsSegments||(this.boundsSegments=c.$.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,this.video)):(this.texture=new ke(i,this.video,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let d=!1;for(const p in this.tiles){const v=this.tiles[p];v.state!=="loaded"&&(v.state="loaded",v.texture=this.texture,d=!0)}d&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class pt extends Qe{constructor(i,a,d,p){super(i,a,d,p),a.coordinates?Array.isArray(a.coordinates)&&a.coordinates.length===4&&!a.coordinates.some(v=>!Array.isArray(v)||v.length!==2||v.some(w=>typeof w!="number"))||this.fire(new c.j(new c.a1(`sources.${i}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.j(new c.a1(`sources.${i}`,null,'missing required property "coordinates"'))),a.animate&&typeof a.animate!="boolean"&&this.fire(new c.j(new c.a1(`sources.${i}`,null,'optional "animate" property must be a boolean value'))),a.canvas?typeof a.canvas=="string"||a.canvas instanceof HTMLCanvasElement||this.fire(new c.j(new c.a1(`sources.${i}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.j(new c.a1(`sources.${i}`,null,'missing required property "canvas"'))),this.options=a,this.animate=a.animate===void 0||a.animate}load(){return c._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(i){this.map=i,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let i=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,i=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,i=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const a=this.map.painter.context,d=a.gl;this.boundsBuffer||(this.boundsBuffer=a.createVertexBuffer(this._boundsArray,je.members)),this.boundsSegments||(this.boundsSegments=c.$.simpleSegment(0,0,4,2)),this.texture?(i||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new ke(a,this.canvas,d.RGBA,{premultiply:!0});let p=!1;for(const v in this.tiles){const w=this.tiles[v];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture,p=!0)}p&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const i of[this.canvas.width,this.canvas.height])if(isNaN(i)||i<=0)return!0;return!1}}const It={},xt=_=>{switch(_){case"geojson":return Ze;case"image":return Qe;case"raster":return He;case"raster-dem":return tt;case"vector":return le;case"video":return We;case"canvas":return pt}return It[_]},Lt="RTLPluginLoaded";class Ht extends c.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Br()}_syncState(i){return this.status=i,this.dispatcher.broadcast("SRPS",{pluginStatus:i,pluginURL:this.url}).catch(a=>{throw this.status="error",a})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(i){return c._(this,arguments,void 0,function*(a,d=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=C.resolveURL(a),!this.url)throw new Error(`requested url ${a} is invalid`);if(this.status==="unavailable"){if(!d)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return c._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new c.k(Lt))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let $e=null;function Gt(){return $e||($e=new Ht),$e}class ai{constructor(i,a){this.timeAdded=0,this.fadeEndTime=0,this.tileID=i,this.uid=c.a3(),this.uses=0,this.tileSize=a,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(i){const a=i+this.timeAdded;a<this.fadeEndTime||(this.fadeEndTime=a)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(i){this.demTexture&&i.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(i,a,d){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",i){i.featureIndex&&(this.latestFeatureIndex=i.featureIndex,i.rawTileData?(this.latestRawTileData=i.rawTileData,this.latestFeatureIndex.rawTileData=i.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=i.collisionBoxArray,this.buckets=function(p,v){const w={};if(!v)return w;for(const S of p){const T=S.layerIds.map(z=>v.getLayer(z)).filter(Boolean);if(T.length!==0){S.layers=T,S.stateDependentLayerIds&&(S.stateDependentLayers=S.stateDependentLayerIds.map(z=>T.filter(O=>O.id===z)[0]));for(const z of T)w[z.id]=S}}return w}(i.buckets,a.style),this.hasSymbolBuckets=!1;for(const p in this.buckets){const v=this.buckets[p];if(v instanceof c.a5){if(this.hasSymbolBuckets=!0,!d)break;v.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const p in this.buckets){const v=this.buckets[p];if(v instanceof c.a5&&v.hasRTLText){this.hasRTLText=!0,Gt().lazyLoad();break}}this.queryPadding=0;for(const p in this.buckets){const v=this.buckets[p];this.queryPadding=Math.max(this.queryPadding,a.style.getLayer(p).queryRadius(v))}i.imageAtlas&&(this.imageAtlas=i.imageAtlas),i.glyphAtlasImage&&(this.glyphAtlasImage=i.glyphAtlasImage)}else this.collisionBoxArray=new c.a4}unloadVectorData(){for(const i in this.buckets)this.buckets[i].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(i){return this.buckets[i.id]}upload(i){for(const d in this.buckets){const p=this.buckets[d];p.uploadPending()&&p.upload(i)}const a=i.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ke(i,this.imageAtlas.image,a.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ke(i,this.glyphAtlasImage,a.ALPHA),this.glyphAtlasImage=null)}prepare(i){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(i,this.imageAtlasTexture)}queryRenderedFeatures(i,a,d,p,v,w,S,T,z,O){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:p,cameraQueryGeometry:v,scale:w,tileSize:this.tileSize,pixelPosMatrix:O,transform:T,params:S,queryPadding:this.queryPadding*z},i,a,d):{}}querySourceFeatures(i,a){const d=this.latestFeatureIndex;if(!d||!d.rawTileData)return;const p=d.loadVTLayers(),v=a&&a.sourceLayer?a.sourceLayer:"",w=p._geojsonTileLayer||p[v];if(!w)return;const S=c.a6(a&&a.filter),{z:T,x:z,y:O}=this.tileID.canonical,R={z:T,x:z,y:O};for(let $=0;$<w.length;$++){const G=w.feature($);if(S.needGeometry){const J=c.a7(G,!0);if(!S.filter(new c.a8(this.tileID.overscaledZ),J,this.tileID.canonical))continue}else if(!S.filter(new c.a8(this.tileID.overscaledZ),G))continue;const K=d.getId(G,v),re=new c.a9(G,T,z,O,K);re.tile=R,i.push(re)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(i){const a=this.expirationTime;if(i.cacheControl){const d=c.aa(i.cacheControl);d["max-age"]&&(this.expirationTime=Date.now()+1e3*d["max-age"])}else i.expires&&(this.expirationTime=new Date(i.expires).getTime());if(this.expirationTime){const d=Date.now();let p=!1;if(this.expirationTime>d)p=!1;else if(a)if(this.expirationTime<a)p=!0;else{const v=this.expirationTime-a;v?this.expirationTime=d+Math.max(v,3e4):p=!0}else p=!0;p?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(i,a){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(i).length===0)return;const d=this.latestFeatureIndex.loadVTLayers();for(const p in this.buckets){if(!a.style.hasLayer(p))continue;const v=this.buckets[p],w=v.layers[0].sourceLayer||"_geojsonTileLayer",S=d[w],T=i[w];if(!S||!T||Object.keys(T).length===0)continue;v.update(T,S,this.imageAtlas&&this.imageAtlas.patternPositions||{});const z=a&&a.style&&a.style.getLayer(p);z&&(this.queryPadding=Math.max(this.queryPadding,z.queryRadius(v)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<C.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(i){this.symbolFadeHoldUntil=C.now()+i}setDependencies(i,a){const d={};for(const p of a)d[p]=!0;this.dependencies[i]=d}hasDependency(i,a){for(const d of i){const p=this.dependencies[d];if(p){for(const v of a)if(p[v])return!0}}return!1}}class mr{constructor(i,a){this.max=i,this.onRemove=a,this.reset()}reset(){for(const i in this.data)for(const a of this.data[i])a.timeout&&clearTimeout(a.timeout),this.onRemove(a.value);return this.data={},this.order=[],this}add(i,a,d){const p=i.wrapped().key;this.data[p]===void 0&&(this.data[p]=[]);const v={value:a,timeout:void 0};if(d!==void 0&&(v.timeout=setTimeout(()=>{this.remove(i,v)},d)),this.data[p].push(v),this.order.push(p),this.order.length>this.max){const w=this._getAndRemoveByKey(this.order[0]);w&&this.onRemove(w)}return this}has(i){return i.wrapped().key in this.data}getAndRemove(i){return this.has(i)?this._getAndRemoveByKey(i.wrapped().key):null}_getAndRemoveByKey(i){const a=this.data[i].shift();return a.timeout&&clearTimeout(a.timeout),this.data[i].length===0&&delete this.data[i],this.order.splice(this.order.indexOf(i),1),a.value}getByKey(i){const a=this.data[i];return a?a[0].value:null}get(i){return this.has(i)?this.data[i.wrapped().key][0].value:null}remove(i,a){if(!this.has(i))return this;const d=i.wrapped().key,p=a===void 0?0:this.data[d].indexOf(a),v=this.data[d][p];return this.data[d].splice(p,1),v.timeout&&clearTimeout(v.timeout),this.data[d].length===0&&delete this.data[d],this.onRemove(v.value),this.order.splice(this.order.indexOf(d),1),this}setMaxSize(i){for(this.max=i;this.order.length>this.max;){const a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this}filter(i){const a=[];for(const d in this.data)for(const p of this.data[d])i(p.value)||a.push(p);for(const d of a)this.remove(d.value.tileID,d)}}class Kr{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(i,a,d){const p=String(a);if(this.stateChanges[i]=this.stateChanges[i]||{},this.stateChanges[i][p]=this.stateChanges[i][p]||{},c.e(this.stateChanges[i][p],d),this.deletedStates[i]===null){this.deletedStates[i]={};for(const v in this.state[i])v!==p&&(this.deletedStates[i][v]=null)}else if(this.deletedStates[i]&&this.deletedStates[i][p]===null){this.deletedStates[i][p]={};for(const v in this.state[i][p])d[v]||(this.deletedStates[i][p][v]=null)}else for(const v in d)this.deletedStates[i]&&this.deletedStates[i][p]&&this.deletedStates[i][p][v]===null&&delete this.deletedStates[i][p][v]}removeFeatureState(i,a,d){if(this.deletedStates[i]===null)return;const p=String(a);if(this.deletedStates[i]=this.deletedStates[i]||{},d&&a!==void 0)this.deletedStates[i][p]!==null&&(this.deletedStates[i][p]=this.deletedStates[i][p]||{},this.deletedStates[i][p][d]=null);else if(a!==void 0)if(this.stateChanges[i]&&this.stateChanges[i][p])for(d in this.deletedStates[i][p]={},this.stateChanges[i][p])this.deletedStates[i][p][d]=null;else this.deletedStates[i][p]=null;else this.deletedStates[i]=null}getState(i,a){const d=String(a),p=c.e({},(this.state[i]||{})[d],(this.stateChanges[i]||{})[d]);if(this.deletedStates[i]===null)return{};if(this.deletedStates[i]){const v=this.deletedStates[i][a];if(v===null)return{};for(const w in v)delete p[w]}return p}initializeTileState(i,a){i.setFeatureState(this.state,a)}coalesceChanges(i,a){const d={};for(const p in this.stateChanges){this.state[p]=this.state[p]||{};const v={};for(const w in this.stateChanges[p])this.state[p][w]||(this.state[p][w]={}),c.e(this.state[p][w],this.stateChanges[p][w]),v[w]=this.state[p][w];d[p]=v}for(const p in this.deletedStates){this.state[p]=this.state[p]||{};const v={};if(this.deletedStates[p]===null)for(const w in this.state[p])v[w]={},this.state[p][w]={};else for(const w in this.deletedStates[p]){if(this.deletedStates[p][w]===null)this.state[p][w]={};else for(const S of Object.keys(this.deletedStates[p][w]))delete this.state[p][w][S];v[w]=this.state[p][w]}d[p]=d[p]||{},c.e(d[p],v)}if(this.stateChanges={},this.deletedStates={},Object.keys(d).length!==0)for(const p in i)i[p].setFeatureState(d,a)}}class Ye extends c.E{constructor(i,a,d){super(),this.id=i,this.dispatcher=d,this.on("data",p=>this._dataHandler(p)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((p,v,w,S)=>{const T=new(xt(v.type))(p,v,w,S);if(T.id!==p)throw new Error(`Expected Source id to be ${p} instead of ${T.id}`);return T})(i,a,d,this),this._tiles={},this._cache=new mr(0,p=>this._unloadTile(p)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Kr,this._didEmitContent=!1,this._updated=!1}onAdd(i){this.map=i,this._maxTileCacheSize=i?i._maxTileCacheSize:null,this._maxTileCacheZoomLevels=i?i._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(i)}onRemove(i){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(i)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const i in this._tiles){const a=this._tiles[i];if(a.state!=="loaded"&&a.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const i=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,i&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(i,a,d){return c._(this,void 0,void 0,function*(){try{yield this._source.loadTile(i),this._tileLoaded(i,a,d)}catch(p){i.state="errored",p.status!==404?this._source.fire(new c.j(p,{tile:i})):this.update(this.transform,this.terrain)}})}_unloadTile(i){this._source.unloadTile&&this._source.unloadTile(i)}_abortTile(i){this._source.abortTile&&this._source.abortTile(i),this._source.fire(new c.k("dataabort",{tile:i,coord:i.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(i){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const a in this._tiles){const d=this._tiles[a];d.upload(i),d.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(i=>i.tileID).sort(Bt).map(i=>i.key)}getRenderableIds(i){const a=[];for(const d in this._tiles)this._isIdRenderable(d,i)&&a.push(this._tiles[d]);return i?a.sort((d,p)=>{const v=d.tileID,w=p.tileID,S=new c.P(v.canonical.x,v.canonical.y)._rotate(this.transform.angle),T=new c.P(w.canonical.x,w.canonical.y)._rotate(this.transform.angle);return v.overscaledZ-w.overscaledZ||T.y-S.y||T.x-S.x}).map(d=>d.tileID.key):a.map(d=>d.tileID).sort(Bt).map(d=>d.key)}hasRenderableParent(i){const a=this.findLoadedParent(i,0);return!!a&&this._isIdRenderable(a.tileID.key)}_isIdRenderable(i,a){return this._tiles[i]&&this._tiles[i].hasData()&&!this._coveredTiles[i]&&(a||!this._tiles[i].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const i in this._tiles)this._tiles[i].state!=="errored"&&this._reloadTile(i,"reloading")}}_reloadTile(i,a){return c._(this,void 0,void 0,function*(){const d=this._tiles[i];d&&(d.state!=="loading"&&(d.state=a),yield this._loadTile(d,i,a))})}_tileLoaded(i,a,d){i.timeAdded=C.now(),d==="expired"&&(i.refreshedUponExpiration=!0),this._setTileReloadTimer(a,i),this.getSource().type==="raster-dem"&&i.dem&&this._backfillDEM(i),this._state.initializeTileState(i,this.map?this.map.painter:null),i.aborted||this._source.fire(new c.k("data",{dataType:"source",tile:i,coord:i.tileID}))}_backfillDEM(i){const a=this.getRenderableIds();for(let p=0;p<a.length;p++){const v=a[p];if(i.neighboringTiles&&i.neighboringTiles[v]){const w=this.getTileByID(v);d(i,w),d(w,i)}}function d(p,v){p.needsHillshadePrepare=!0,p.needsTerrainPrepare=!0;let w=v.tileID.canonical.x-p.tileID.canonical.x;const S=v.tileID.canonical.y-p.tileID.canonical.y,T=Math.pow(2,p.tileID.canonical.z),z=v.tileID.key;w===0&&S===0||Math.abs(S)>1||(Math.abs(w)>1&&(Math.abs(w+T)===1?w+=T:Math.abs(w-T)===1&&(w-=T)),v.dem&&p.dem&&(p.dem.backfillBorder(v.dem,w,S),p.neighboringTiles&&p.neighboringTiles[z]&&(p.neighboringTiles[z].backfilled=!0)))}}getTile(i){return this.getTileByID(i.key)}getTileByID(i){return this._tiles[i]}_retainLoadedChildren(i,a,d,p){for(const v in this._tiles){let w=this._tiles[v];if(p[v]||!w.hasData()||w.tileID.overscaledZ<=a||w.tileID.overscaledZ>d)continue;let S=w.tileID;for(;w&&w.tileID.overscaledZ>a+1;){const z=w.tileID.scaledTo(w.tileID.overscaledZ-1);w=this._tiles[z.key],w&&w.hasData()&&(S=z)}let T=S;for(;T.overscaledZ>a;)if(T=T.scaledTo(T.overscaledZ-1),i[T.key]){p[S.key]=S;break}}}findLoadedParent(i,a){if(i.key in this._loadedParentTiles){const d=this._loadedParentTiles[i.key];return d&&d.tileID.overscaledZ>=a?d:null}for(let d=i.overscaledZ-1;d>=a;d--){const p=i.scaledTo(d),v=this._getLoadedTile(p);if(v)return v}}findLoadedSibling(i){return this._getLoadedTile(i)}_getLoadedTile(i){const a=this._tiles[i.key];return a&&a.hasData()?a:this._cache.getByKey(i.wrapped().key)}updateCacheSize(i){const a=Math.ceil(i.width/this._source.tileSize)+1,d=Math.ceil(i.height/this._source.tileSize)+1,p=Math.floor(a*d*(this._maxTileCacheZoomLevels===null?c.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),v=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,p):p;this._cache.setMaxSize(v)}handleWrapJump(i){const a=Math.round((i-(this._prevLng===void 0?i:this._prevLng))/360);if(this._prevLng=i,a){const d={};for(const p in this._tiles){const v=this._tiles[p];v.tileID=v.tileID.unwrapTo(v.tileID.wrap+a),d[v.tileID.key]=v}this._tiles=d;for(const p in this._timers)clearTimeout(this._timers[p]),delete this._timers[p];for(const p in this._tiles)this._setTileReloadTimer(p,this._tiles[p])}}_updateCoveredAndRetainedTiles(i,a,d,p,v,w){const S={},T={},z=Object.keys(i),O=C.now();for(const R of z){const $=i[R],G=this._tiles[R];if(!G||G.fadeEndTime!==0&&G.fadeEndTime<=O)continue;const K=this.findLoadedParent($,a),re=this.findLoadedSibling($),J=K||re||null;J&&(this._addTile(J.tileID),S[J.tileID.key]=J.tileID),T[R]=$}this._retainLoadedChildren(T,p,d,i);for(const R in S)i[R]||(this._coveredTiles[R]=!0,i[R]=S[R]);if(w){const R={},$={};for(const G of v)this._tiles[G.key].hasData()?R[G.key]=G:$[G.key]=G;for(const G in $){const K=$[G].children(this._source.maxzoom);this._tiles[K[0].key]&&this._tiles[K[1].key]&&this._tiles[K[2].key]&&this._tiles[K[3].key]&&(R[K[0].key]=i[K[0].key]=K[0],R[K[1].key]=i[K[1].key]=K[1],R[K[2].key]=i[K[2].key]=K[2],R[K[3].key]=i[K[3].key]=K[3],delete $[G])}for(const G in $){const K=$[G],re=this.findLoadedParent(K,this._source.minzoom),J=this.findLoadedSibling(K),ue=re||J||null;if(ue){R[ue.tileID.key]=i[ue.tileID.key]=ue.tileID;for(const ge in R)R[ge].isChildOf(ue.tileID)&&delete R[ge]}}for(const G in this._tiles)R[G]||(this._coveredTiles[G]=!0)}}update(i,a){if(!this._sourceLoaded||this._paused)return;let d;this.transform=i,this.terrain=a,this.updateCacheSize(i),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?d=i.getVisibleUnwrappedCoordinates(this._source.tileID).map(O=>new c.Q(O.canonical.z,O.wrap,O.canonical.z,O.canonical.x,O.canonical.y)):(d=i.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:a}),this._source.hasTile&&(d=d.filter(O=>this._source.hasTile(O)))):d=[];const p=i.coveringZoomLevel(this._source),v=Math.max(p-Ye.maxOverzooming,this._source.minzoom),w=Math.max(p+Ye.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const O={};for(const R of d)if(R.canonical.z>this._source.minzoom){const $=R.scaledTo(R.canonical.z-1);O[$.key]=$;const G=R.scaledTo(Math.max(this._source.minzoom,Math.min(R.canonical.z,5)));O[G.key]=G}d=d.concat(Object.values(O))}const S=d.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,S&&this.fire(new c.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const T=this._updateRetainedTiles(d,p);Dt(this._source.type)&&this._updateCoveredAndRetainedTiles(T,v,w,p,d,a);for(const O in T)this._tiles[O].clearFadeHold();const z=c.ab(this._tiles,T);for(const O of z){const R=this._tiles[O];R.hasSymbolBuckets&&!R.holdingForFade()?R.setHoldDuration(this.map._fadeDuration):R.hasSymbolBuckets&&!R.symbolFadeFinished()||this._removeTile(O)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const i in this._tiles)this._tiles[i].holdingForFade()&&this._removeTile(i)}_updateRetainedTiles(i,a){var d;const p={},v={},w=Math.max(a-Ye.maxOverzooming,this._source.minzoom),S=Math.max(a+Ye.maxUnderzooming,this._source.minzoom),T={};for(const z of i){const O=this._addTile(z);p[z.key]=z,O.hasData()||a<this._source.maxzoom&&(T[z.key]=z)}this._retainLoadedChildren(T,a,S,p);for(const z of i){let O=this._tiles[z.key];if(O.hasData())continue;if(a+1>this._source.maxzoom){const $=z.children(this._source.maxzoom)[0],G=this.getTile($);if(G&&G.hasData()){p[$.key]=$;continue}}else{const $=z.children(this._source.maxzoom);if(p[$[0].key]&&p[$[1].key]&&p[$[2].key]&&p[$[3].key])continue}let R=O.wasRequested();for(let $=z.overscaledZ-1;$>=w;--$){const G=z.scaledTo($);if(v[G.key])break;if(v[G.key]=!0,O=this.getTile(G),!O&&R&&(O=this._addTile(G)),O){const K=O.hasData();if((K||!(!((d=this.map)===null||d===void 0)&&d.cancelPendingTileRequestsWhileZooming)||R)&&(p[G.key]=G),R=O.wasRequested(),K)break}}}return p}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const i in this._tiles){const a=[];let d,p=this._tiles[i].tileID;for(;p.overscaledZ>0;){if(p.key in this._loadedParentTiles){d=this._loadedParentTiles[p.key];break}a.push(p.key);const v=p.scaledTo(p.overscaledZ-1);if(d=this._getLoadedTile(v),d)break;p=v}for(const v of a)this._loadedParentTiles[v]=d}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const i in this._tiles){const a=this._tiles[i].tileID,d=this._getLoadedTile(a);this._loadedSiblingTiles[a.key]=d}}_addTile(i){let a=this._tiles[i.key];if(a)return a;a=this._cache.getAndRemove(i),a&&(this._setTileReloadTimer(i.key,a),a.tileID=i,this._state.initializeTileState(a,this.map?this.map.painter:null),this._cacheTimers[i.key]&&(clearTimeout(this._cacheTimers[i.key]),delete this._cacheTimers[i.key],this._setTileReloadTimer(i.key,a)));const d=a;return a||(a=new ai(i,this._source.tileSize*i.overscaleFactor()),this._loadTile(a,i.key,a.state)),a.uses++,this._tiles[i.key]=a,d||this._source.fire(new c.k("dataloading",{tile:a,coord:a.tileID,dataType:"source"})),a}_setTileReloadTimer(i,a){i in this._timers&&(clearTimeout(this._timers[i]),delete this._timers[i]);const d=a.getExpiryTimeout();d&&(this._timers[i]=setTimeout(()=>{this._reloadTile(i,"expired"),delete this._timers[i]},d))}_removeTile(i){const a=this._tiles[i];a&&(a.uses--,delete this._tiles[i],this._timers[i]&&(clearTimeout(this._timers[i]),delete this._timers[i]),a.uses>0||(a.hasData()&&a.state!=="reloading"?this._cache.add(a.tileID,a,a.getExpiryTimeout()):(a.aborted=!0,this._abortTile(a),this._unloadTile(a))))}_dataHandler(i){const a=i.sourceDataType;i.dataType==="source"&&a==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&i.dataType==="source"&&a==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const i in this._tiles)this._removeTile(i);this._cache.reset()}tilesIn(i,a,d){const p=[],v=this.transform;if(!v)return p;const w=d?v.getCameraQueryGeometry(i):i,S=i.map(K=>v.pointCoordinate(K,this.terrain)),T=w.map(K=>v.pointCoordinate(K,this.terrain)),z=this.getIds();let O=1/0,R=1/0,$=-1/0,G=-1/0;for(const K of T)O=Math.min(O,K.x),R=Math.min(R,K.y),$=Math.max($,K.x),G=Math.max(G,K.y);for(let K=0;K<z.length;K++){const re=this._tiles[z[K]];if(re.holdingForFade())continue;const J=re.tileID,ue=Math.pow(2,v.zoom-re.tileID.overscaledZ),ge=a*re.queryPadding*c.W/re.tileSize/ue,te=[J.getTilePoint(new c.Y(O,R)),J.getTilePoint(new c.Y($,G))];if(te[0].x-ge<c.W&&te[0].y-ge<c.W&&te[1].x+ge>=0&&te[1].y+ge>=0){const ve=S.map(Pe=>J.getTilePoint(Pe)),Se=T.map(Pe=>J.getTilePoint(Pe));p.push({tile:re,tileID:J,queryGeometry:ve,cameraQueryGeometry:Se,scale:ue})}}return p}getVisibleCoordinates(i){const a=this.getRenderableIds(i).map(d=>this._tiles[d].tileID);for(const d of a)d.posMatrix=this.transform.calculatePosMatrix(d.toUnwrapped());return a}hasTransition(){if(this._source.hasTransition())return!0;if(Dt(this._source.type)){const i=C.now();for(const a in this._tiles)if(this._tiles[a].fadeEndTime>=i)return!0}return!1}setFeatureState(i,a,d){this._state.updateState(i=i||"_geojsonTileLayer",a,d)}removeFeatureState(i,a,d){this._state.removeFeatureState(i=i||"_geojsonTileLayer",a,d)}getFeatureState(i,a){return this._state.getState(i=i||"_geojsonTileLayer",a)}setDependencies(i,a,d){const p=this._tiles[i];p&&p.setDependencies(a,d)}reloadTilesForDependencies(i,a){for(const d in this._tiles)this._tiles[d].hasDependency(i,a)&&this._reloadTile(d,"reloading");this._cache.filter(d=>!d.hasDependency(i,a))}}function Bt(_,i){const a=Math.abs(2*_.wrap)-+(_.wrap<0),d=Math.abs(2*i.wrap)-+(i.wrap<0);return _.overscaledZ-i.overscaledZ||d-a||i.canonical.y-_.canonical.y||i.canonical.x-_.canonical.x}function Dt(_){return _==="raster"||_==="image"||_==="video"}Ye.maxOverzooming=10,Ye.maxUnderzooming=3;class pi{constructor(i,a){this.reset(i,a)}reset(i,a){this.points=i||[],this._distances=[0];for(let d=1;d<this.points.length;d++)this._distances[d]=this._distances[d-1]+this.points[d].dist(this.points[d-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(i){if(this.points.length===1)return this.points[0];i=c.ac(i,0,1);let a=1,d=this._distances[a];const p=i*this.paddedLength+this.padding;for(;d<p&&a<this._distances.length;)d=this._distances[++a];const v=a-1,w=this._distances[v],S=d-w,T=S>0?(p-w)/S:0;return this.points[v].mult(1-T).add(this.points[a].mult(T))}}function Ii(_,i){let a=!0;return _==="always"||_!=="never"&&i!=="never"||(a=!1),a}class Ft{constructor(i,a,d){const p=this.boxCells=[],v=this.circleCells=[];this.xCellCount=Math.ceil(i/d),this.yCellCount=Math.ceil(a/d);for(let w=0;w<this.xCellCount*this.yCellCount;w++)p.push([]),v.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=i,this.height=a,this.xScale=this.xCellCount/i,this.yScale=this.yCellCount/a,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(i,a,d,p,v){this._forEachCell(a,d,p,v,this._insertBoxCell,this.boxUid++),this.boxKeys.push(i),this.bboxes.push(a),this.bboxes.push(d),this.bboxes.push(p),this.bboxes.push(v)}insertCircle(i,a,d,p){this._forEachCell(a-p,d-p,a+p,d+p,this._insertCircleCell,this.circleUid++),this.circleKeys.push(i),this.circles.push(a),this.circles.push(d),this.circles.push(p)}_insertBoxCell(i,a,d,p,v,w){this.boxCells[v].push(w)}_insertCircleCell(i,a,d,p,v,w){this.circleCells[v].push(w)}_query(i,a,d,p,v,w,S){if(d<0||i>this.width||p<0||a>this.height)return[];const T=[];if(i<=0&&a<=0&&this.width<=d&&this.height<=p){if(v)return[{key:null,x1:i,y1:a,x2:d,y2:p}];for(let z=0;z<this.boxKeys.length;z++)T.push({key:this.boxKeys[z],x1:this.bboxes[4*z],y1:this.bboxes[4*z+1],x2:this.bboxes[4*z+2],y2:this.bboxes[4*z+3]});for(let z=0;z<this.circleKeys.length;z++){const O=this.circles[3*z],R=this.circles[3*z+1],$=this.circles[3*z+2];T.push({key:this.circleKeys[z],x1:O-$,y1:R-$,x2:O+$,y2:R+$})}}else this._forEachCell(i,a,d,p,this._queryCell,T,{hitTest:v,overlapMode:w,seenUids:{box:{},circle:{}}},S);return T}query(i,a,d,p){return this._query(i,a,d,p,!1,null)}hitTest(i,a,d,p,v,w){return this._query(i,a,d,p,!0,v,w).length>0}hitTestCircle(i,a,d,p,v){const w=i-d,S=i+d,T=a-d,z=a+d;if(S<0||w>this.width||z<0||T>this.height)return!1;const O=[];return this._forEachCell(w,T,S,z,this._queryCellCircle,O,{hitTest:!0,overlapMode:p,circle:{x:i,y:a,radius:d},seenUids:{box:{},circle:{}}},v),O.length>0}_queryCell(i,a,d,p,v,w,S,T){const{seenUids:z,hitTest:O,overlapMode:R}=S,$=this.boxCells[v];if($!==null){const K=this.bboxes;for(const re of $)if(!z.box[re]){z.box[re]=!0;const J=4*re,ue=this.boxKeys[re];if(i<=K[J+2]&&a<=K[J+3]&&d>=K[J+0]&&p>=K[J+1]&&(!T||T(ue))&&(!O||!Ii(R,ue.overlapMode))&&(w.push({key:ue,x1:K[J],y1:K[J+1],x2:K[J+2],y2:K[J+3]}),O))return!0}}const G=this.circleCells[v];if(G!==null){const K=this.circles;for(const re of G)if(!z.circle[re]){z.circle[re]=!0;const J=3*re,ue=this.circleKeys[re];if(this._circleAndRectCollide(K[J],K[J+1],K[J+2],i,a,d,p)&&(!T||T(ue))&&(!O||!Ii(R,ue.overlapMode))){const ge=K[J],te=K[J+1],ve=K[J+2];if(w.push({key:ue,x1:ge-ve,y1:te-ve,x2:ge+ve,y2:te+ve}),O)return!0}}}return!1}_queryCellCircle(i,a,d,p,v,w,S,T){const{circle:z,seenUids:O,overlapMode:R}=S,$=this.boxCells[v];if($!==null){const K=this.bboxes;for(const re of $)if(!O.box[re]){O.box[re]=!0;const J=4*re,ue=this.boxKeys[re];if(this._circleAndRectCollide(z.x,z.y,z.radius,K[J+0],K[J+1],K[J+2],K[J+3])&&(!T||T(ue))&&!Ii(R,ue.overlapMode))return w.push(!0),!0}}const G=this.circleCells[v];if(G!==null){const K=this.circles;for(const re of G)if(!O.circle[re]){O.circle[re]=!0;const J=3*re,ue=this.circleKeys[re];if(this._circlesCollide(K[J],K[J+1],K[J+2],z.x,z.y,z.radius)&&(!T||T(ue))&&!Ii(R,ue.overlapMode))return w.push(!0),!0}}}_forEachCell(i,a,d,p,v,w,S,T){const z=this._convertToXCellCoord(i),O=this._convertToYCellCoord(a),R=this._convertToXCellCoord(d),$=this._convertToYCellCoord(p);for(let G=z;G<=R;G++)for(let K=O;K<=$;K++)if(v.call(this,i,a,d,p,this.xCellCount*K+G,w,S,T))return}_convertToXCellCoord(i){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(i*this.xScale)))}_convertToYCellCoord(i){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(i*this.yScale)))}_circlesCollide(i,a,d,p,v,w){const S=p-i,T=v-a,z=d+w;return z*z>S*S+T*T}_circleAndRectCollide(i,a,d,p,v,w,S){const T=(w-p)/2,z=Math.abs(i-(p+T));if(z>T+d)return!1;const O=(S-v)/2,R=Math.abs(a-(v+O));if(R>O+d)return!1;if(z<=T||R<=O)return!0;const $=z-T,G=R-O;return $*$+G*G<=d*d}}function io(_,i,a,d,p){const v=c.F();return i?(c.J(v,v,[1/p,1/p,1]),a||c.ad(v,v,d.angle)):c.K(v,d.labelPlaneMatrix,_),v}function ro(_,i,a,d,p){if(i){const v=c.ae(_);return c.J(v,v,[p,p,1]),a||c.ad(v,v,-d.angle),v}return d.glCoordMatrix}function gr(_,i,a){let d;a?(d=[_.x,_.y,a(_.x,_.y),1],c.af(d,d,i)):(d=[_.x,_.y,0,1],function(v,w,S){const T=w[0],z=w[1];v[0]=S[0]*T+S[4]*z+S[12],v[1]=S[1]*T+S[5]*z+S[13],v[3]=S[3]*T+S[7]*z+S[15]}(d,d,i));const p=d[3];return{point:new c.P(d[0]/p,d[1]/p),signedDistanceFromCamera:p,isOccluded:!1}}function Q(_,i){return .5+_/i*.5}function F(_,i){return _.x>=-i[0]&&_.x<=i[0]&&_.y>=-i[1]&&_.y<=i[1]}function N(_,i,a,d,p,v,w,S,T,z,O,R,$,G,K){const re=d?_.textSizeData:_.iconSizeData,J=c.ag(re,a.transform.zoom),ue=[256/a.width*2+1,256/a.height*2+1],ge=d?_.text.dynamicLayoutVertexArray:_.icon.dynamicLayoutVertexArray;ge.clear();const te=_.lineVertexArray,ve=d?_.text.placedSymbolArray:_.icon.placedSymbolArray,Se=a.transform.width/a.transform.height;let Pe=!1;for(let Ne=0;Ne<ve.length;Ne++){const Xe=ve.get(Ne);if(Xe.hidden||Xe.writingMode===c.ah.vertical&&!Pe){Tt(Xe.numGlyphs,ge);continue}Pe=!1;const ut=gr(new c.P(Xe.anchorX,Xe.anchorY),i,K);if(!F(ut.point,ue)){Tt(Xe.numGlyphs,ge);continue}const ht=Q(a.transform.cameraToCenterDistance,ut.signedDistanceFromCamera),Je=c.ai(re,J,Xe),et=w?Je/ht:Je*ht,yt={getElevation:K,labelPlaneMatrix:p,lineVertexArray:te,pitchWithMap:w,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:z,tileAnchorPoint:new c.P(Xe.anchorX,Xe.anchorY),unwrappedTileID:O,width:R,height:$,translation:G},Ot=pe(yt,Xe,et,!1,S,i,v,_.glyphOffsetArray,ge,Se,T);Pe=Ot.useVertical,(Ot.notEnoughRoom||Pe||Ot.needsFlipping&&pe(yt,Xe,et,!0,S,i,v,_.glyphOffsetArray,ge,Se,T).notEnoughRoom)&&Tt(Xe.numGlyphs,ge)}d?_.text.dynamicLayoutVertexBuffer.updateData(ge):_.icon.dynamicLayoutVertexBuffer.updateData(ge)}function U(_,i,a,d,p,v,w,S){const T=v.glyphStartIndex+v.numGlyphs,z=v.lineStartIndex,O=v.lineStartIndex+v.lineLength,R=i.getoffsetX(v.glyphStartIndex),$=i.getoffsetX(T-1),G=Re(_*R,a,d,p,v.segment,z,O,S,w);if(!G)return null;const K=Re(_*$,a,d,p,v.segment,z,O,S,w);return K?S.projectionCache.anyProjectionOccluded?null:{first:G,last:K}:null}function ie(_,i,a,d){return _===c.ah.horizontal&&Math.abs(a.y-i.y)>Math.abs(a.x-i.x)*d?{useVertical:!0}:(_===c.ah.vertical?i.y<a.y:i.x>a.x)?{needsFlipping:!0}:null}function pe(_,i,a,d,p,v,w,S,T,z,O){const R=a/24,$=i.lineOffsetX*R,G=i.lineOffsetY*R;let K;if(i.numGlyphs>1){const re=i.glyphStartIndex+i.numGlyphs,J=i.lineStartIndex,ue=i.lineStartIndex+i.lineLength,ge=U(R,S,$,G,d,i,O,_);if(!ge)return{notEnoughRoom:!0};const te=gr(ge.first.point,w,_.getElevation).point,ve=gr(ge.last.point,w,_.getElevation).point;if(p&&!d){const Se=ie(i.writingMode,te,ve,z);if(Se)return Se}K=[ge.first];for(let Se=i.glyphStartIndex+1;Se<re-1;Se++)K.push(Re(R*S.getoffsetX(Se),$,G,d,i.segment,J,ue,_,O));K.push(ge.last)}else{if(p&&!d){const J=gr(_.tileAnchorPoint,v,_.getElevation).point,ue=i.lineStartIndex+i.segment+1,ge=new c.P(_.lineVertexArray.getx(ue),_.lineVertexArray.gety(ue)),te=gr(ge,v,_.getElevation),ve=te.signedDistanceFromCamera>0?te.point:function(Pe,Ne,Xe,ut,ht,Je){return _e(Pe,Ne,Xe,1,ht,Je)}(_.tileAnchorPoint,ge,J,0,v,_),Se=ie(i.writingMode,J,ve,z);if(Se)return Se}const re=Re(R*S.getoffsetX(i.glyphStartIndex),$,G,d,i.segment,i.lineStartIndex,i.lineStartIndex+i.lineLength,_,O);if(!re||_.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};K=[re]}for(const re of K)c.aj(T,re.point,re.angle);return{}}function _e(_,i,a,d,p,v){const w=_.add(_.sub(i)._unit()),S=p!==void 0?gr(w,p,v.getElevation).point:de(w.x,w.y,v).point,T=a.sub(S);return a.add(T._mult(d/T.mag()))}function we(_,i,a){const d=i.projectionCache;if(d.projections[_])return d.projections[_];const p=new c.P(i.lineVertexArray.getx(_),i.lineVertexArray.gety(_)),v=de(p.x,p.y,i);if(v.signedDistanceFromCamera>0)return d.projections[_]=v.point,d.anyProjectionOccluded=d.anyProjectionOccluded||v.isOccluded,v.point;const w=_-a.direction;return function(S,T,z,O,R){return _e(S,T,z,O,void 0,R)}(a.distanceFromAnchor===0?i.tileAnchorPoint:new c.P(i.lineVertexArray.getx(w),i.lineVertexArray.gety(w)),p,a.previousVertex,a.absOffsetX-a.distanceFromAnchor+1,i)}function de(_,i,a){const d=_+a.translation[0],p=i+a.translation[1];let v;return!a.pitchWithMap&&a.projection.useSpecialProjectionForSymbols?(v=a.projection.projectTileCoordinates(d,p,a.unwrappedTileID,a.getElevation),v.point.x=(.5*v.point.x+.5)*a.width,v.point.y=(.5*-v.point.y+.5)*a.height):(v=gr(new c.P(d,p),a.labelPlaneMatrix,a.getElevation),v.isOccluded=!1),v}function Ce(_,i,a){return _._unit()._perp()._mult(i*a)}function Ue(_,i,a,d,p,v,w,S,T){if(S.projectionCache.offsets[_])return S.projectionCache.offsets[_];const z=a.add(i);if(_+T.direction<d||_+T.direction>=p)return S.projectionCache.offsets[_]=z,z;const O=we(_+T.direction,S,T),R=Ce(O.sub(a),w,T.direction),$=a.add(R),G=O.add(R);return S.projectionCache.offsets[_]=c.ak(v,z,$,G)||z,S.projectionCache.offsets[_]}function Re(_,i,a,d,p,v,w,S,T){const z=d?_-i:_+i;let O=z>0?1:-1,R=0;d&&(O*=-1,R=Math.PI),O<0&&(R+=Math.PI);let $,G=O>0?v+p:v+p+1;S.projectionCache.cachedAnchorPoint?$=S.projectionCache.cachedAnchorPoint:($=de(S.tileAnchorPoint.x,S.tileAnchorPoint.y,S).point,S.projectionCache.cachedAnchorPoint=$);let K,re,J=$,ue=$,ge=0,te=0;const ve=Math.abs(z),Se=[];let Pe;for(;ge+te<=ve;){if(G+=O,G<v||G>=w)return null;ge+=te,ue=J,re=K;const ut={absOffsetX:ve,direction:O,distanceFromAnchor:ge,previousVertex:ue};if(J=we(G,S,ut),a===0)Se.push(ue),Pe=J.sub(ue);else{let ht;const Je=J.sub(ue);ht=Je.mag()===0?Ce(we(G+O,S,ut).sub(J),a,O):Ce(Je,a,O),re||(re=ue.add(ht)),K=Ue(G,ht,J,v,w,re,a,S,ut),Se.push(re),Pe=K.sub(re)}te=Pe.mag()}const Ne=Pe._mult((ve-ge)/te)._add(re||ue),Xe=R+Math.atan2(J.y-ue.y,J.x-ue.x);return Se.push(Ne),{point:Ne,angle:T?Xe:0,path:Se}}const De=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Tt(_,i){for(let a=0;a<_;a++){const d=i.length;i.resize(d+4),i.float32.set(De,3*d)}}const St=100;class Jt{constructor(i,a,d=new Ft(i.width+200,i.height+200,25),p=new Ft(i.width+200,i.height+200,25)){this.transform=i,this.mapProjection=a,this.grid=d,this.ignoredGrid=p,this.pitchFactor=Math.cos(i._pitch)*i.cameraToCenterDistance,this.screenRightBoundary=i.width+St,this.screenBottomBoundary=i.height+St,this.gridRightBoundary=i.width+200,this.gridBottomBoundary=i.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(i,a,d,p,v,w,S,T,z,O,R){const $=i.anchorPointX+T[0],G=i.anchorPointY+T[1],K=this.projectAndGetPerspectiveRatio(p,$,G,v,O),re=this._projectCollisionBox(i,d,p,v,w,S,T,K,O,R),[J,ue,ge,te]=re.box;return this.mapProjection.useSpecialProjectionForSymbols&&(w?re.allPointsOccluded:this.mapProjection.isOccluded($,G,v))||K.perspectiveRatio<this.perspectiveRatioCutoff||!this.isInsideGrid(J,ue,ge,te)||a!=="always"&&this.grid.hitTest(J,ue,ge,te,a,z)?{box:[J,ue,ge,te],placeable:!1,offscreen:!1}:{box:[J,ue,ge,te],placeable:!0,offscreen:this.isOffscreen(J,ue,ge,te)}}placeCollisionCircles(i,a,d,p,v,w,S,T,z,O,R,$,G,K,re,J){const ue=[],ge=new c.P(a.anchorX,a.anchorY),te=this.getPerspectiveRatio(w,ge.x,ge.y,S,J),ve=(R?v/te:v*te)/c.ap,Se={getElevation:J,labelPlaneMatrix:T,lineVertexArray:d,pitchWithMap:R,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:this.mapProjection,tileAnchorPoint:ge,unwrappedTileID:S,width:this.transform.width,height:this.transform.height,translation:re},Pe=U(ve,p,a.lineOffsetX*ve,a.lineOffsetY*ve,!1,a,!1,Se);let Ne=!1,Xe=!1,ut=!0;if(Pe){const ht=.5*G*te+K,Je=new c.P(-100,-100),et=new c.P(this.screenRightBoundary,this.screenBottomBoundary),yt=new pi,Ot=Pe.first,it=Pe.last;let at=[];for(let Wt=Ot.path.length-1;Wt>=1;Wt--)at.push(Ot.path[Wt]);for(let Wt=1;Wt<it.path.length;Wt++)at.push(it.path[Wt]);const Pt=2.5*ht;if(z){const Wt=this.projectPathToScreenSpace(at,Se,z);at=Wt.some(Yt=>Yt.signedDistanceFromCamera<=0)?[]:Wt.map(Yt=>Yt.point)}let Ci=[];if(at.length>0){const Wt=at[0].clone(),Yt=at[0].clone();for(let Ai=1;Ai<at.length;Ai++)Wt.x=Math.min(Wt.x,at[Ai].x),Wt.y=Math.min(Wt.y,at[Ai].y),Yt.x=Math.max(Yt.x,at[Ai].x),Yt.y=Math.max(Yt.y,at[Ai].y);Ci=Wt.x>=Je.x&&Yt.x<=et.x&&Wt.y>=Je.y&&Yt.y<=et.y?[at]:Yt.x<Je.x||Wt.x>et.x||Yt.y<Je.y||Wt.y>et.y?[]:c.al([at],Je.x,Je.y,et.x,et.y)}for(const Wt of Ci){yt.reset(Wt,.25*ht);let Yt=0;Yt=yt.length<=.5*ht?1:Math.ceil(yt.paddedLength/Pt)+1;for(let Ai=0;Ai<Yt;Ai++){const Ar=Ai/Math.max(Yt-1,1),In=yt.lerp(Ar),ki=In.x+St,en=In.y+St;ue.push(ki,en,ht,0);const Nr=ki-ht,kr=en-ht,Mr=ki+ht,Tn=en+ht;if(ut=ut&&this.isOffscreen(Nr,kr,Mr,Tn),Xe=Xe||this.isInsideGrid(Nr,kr,Mr,Tn),i!=="always"&&this.grid.hitTestCircle(ki,en,ht,i,$)&&(Ne=!0,!O))return{circles:[],offscreen:!1,collisionDetected:Ne}}}}return{circles:!O&&Ne||!Xe||te<this.perspectiveRatioCutoff?[]:ue,offscreen:ut,collisionDetected:Ne}}projectPathToScreenSpace(i,a,d){return i.map(p=>gr(p,d,a.getElevation))}queryRenderedSymbols(i){if(i.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const a=[];let d=1/0,p=1/0,v=-1/0,w=-1/0;for(const O of i){const R=new c.P(O.x+St,O.y+St);d=Math.min(d,R.x),p=Math.min(p,R.y),v=Math.max(v,R.x),w=Math.max(w,R.y),a.push(R)}const S=this.grid.query(d,p,v,w).concat(this.ignoredGrid.query(d,p,v,w)),T={},z={};for(const O of S){const R=O.key;if(T[R.bucketInstanceId]===void 0&&(T[R.bucketInstanceId]={}),T[R.bucketInstanceId][R.featureIndex])continue;const $=[new c.P(O.x1,O.y1),new c.P(O.x2,O.y1),new c.P(O.x2,O.y2),new c.P(O.x1,O.y2)];c.am(a,$)&&(T[R.bucketInstanceId][R.featureIndex]=!0,z[R.bucketInstanceId]===void 0&&(z[R.bucketInstanceId]=[]),z[R.bucketInstanceId].push(R.featureIndex))}return z}insertCollisionBox(i,a,d,p,v,w){(d?this.ignoredGrid:this.grid).insert({bucketInstanceId:p,featureIndex:v,collisionGroupID:w,overlapMode:a},i[0],i[1],i[2],i[3])}insertCollisionCircles(i,a,d,p,v,w){const S=d?this.ignoredGrid:this.grid,T={bucketInstanceId:p,featureIndex:v,collisionGroupID:w,overlapMode:a};for(let z=0;z<i.length;z+=4)S.insertCircle(T,i[z],i[z+1],i[z+2])}projectAndGetPerspectiveRatio(i,a,d,p,v){const w=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(a,d,p,v):gr(new c.P(a,d),i,v);return{point:new c.P((w.point.x+1)/2*this.transform.width+St,(1-w.point.y)/2*this.transform.height+St),perspectiveRatio:.5+this.transform.cameraToCenterDistance/w.signedDistanceFromCamera*.5,isOccluded:w.isOccluded,signedDistanceFromCamera:w.signedDistanceFromCamera}}getPerspectiveRatio(i,a,d,p,v){const w=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(a,d,p,v):gr(new c.P(a,d),i,v);return .5+this.transform.cameraToCenterDistance/w.signedDistanceFromCamera*.5}isOffscreen(i,a,d,p){return d<St||i>=this.screenRightBoundary||p<St||a>this.screenBottomBoundary}isInsideGrid(i,a,d,p){return d>=0&&i<this.gridRightBoundary&&p>=0&&a<this.gridBottomBoundary}getViewportMatrix(){const i=c.an([]);return c.H(i,i,[-100,-100,0]),i}_projectCollisionBox(i,a,d,p,v,w,S,T,z,O){const R=a*T.perspectiveRatio;let $=new c.P(1,0),G=new c.P(0,1);const K=new c.P(i.anchorPointX+S[0],i.anchorPointY+S[1]);if(w&&!v){const ht=this.projectAndGetPerspectiveRatio(d,K.x+1,K.y,p,z).point.sub(T.point).unit(),Je=Math.atan(ht.y/ht.x)+(ht.x<0?Math.PI:0),et=Math.sin(Je),yt=Math.cos(Je);$=new c.P(yt,et),G=new c.P(-et,yt)}else if(!w&&v){const ht=-this.transform.angle,Je=Math.sin(ht),et=Math.cos(ht);$=new c.P(et,Je),G=new c.P(-Je,et)}let re=T.point,J=R;if(v){re=K;const ht=this.transform.zoom-Math.floor(this.transform.zoom);J=Math.pow(2,-ht),J*=this.mapProjection.getPitchedTextCorrection(this.transform,K,p),O||(J*=c.ac(.5+T.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))}O&&(re=re.add($.mult(O.x*J)).add(G.mult(O.y*J)));const ue=i.x1*J,ge=i.x2*J,te=(ue+ge)/2,ve=i.y1*J,Se=i.y2*J,Pe=(ve+Se)/2,Ne=[{offsetX:ue,offsetY:ve},{offsetX:te,offsetY:ve},{offsetX:ge,offsetY:ve},{offsetX:ge,offsetY:Pe},{offsetX:ge,offsetY:Se},{offsetX:te,offsetY:Se},{offsetX:ue,offsetY:Se},{offsetX:ue,offsetY:Pe}];let Xe=[];for(const{offsetX:ht,offsetY:Je}of Ne)Xe.push(new c.P(re.x+$.x*ht+G.x*Je,re.y+$.y*ht+G.y*Je));let ut=!1;if(v){const ht=Xe.map(Je=>this.projectAndGetPerspectiveRatio(d,Je.x,Je.y,p,z));ut=ht.some(Je=>!Je.isOccluded),Xe=ht.map(Je=>Je.point)}else ut=!0;return{box:c.ao(Xe),allPointsOccluded:!ut}}}function Rt(_,i,a){return i*(c.W/(_.tileSize*Math.pow(2,a-_.tileID.overscaledZ)))}class ii{constructor(i,a,d,p){this.opacity=i?Math.max(0,Math.min(1,i.opacity+(i.placed?a:-a))):p&&d?1:0,this.placed=d}isHidden(){return this.opacity===0&&!this.placed}}class mi{constructor(i,a,d,p,v){this.text=new ii(i?i.text:null,a,d,v),this.icon=new ii(i?i.icon:null,a,p,v)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ti{constructor(i,a,d){this.text=i,this.icon=a,this.skipFade=d}}class rr{constructor(){this.invProjMatrix=c.F(),this.viewportMatrix=c.F(),this.circles=[]}}class Zt{constructor(i,a,d,p,v){this.bucketInstanceId=i,this.featureIndex=a,this.sourceLayerIndex=d,this.bucketIndex=p,this.tileID=v}}class Fi{constructor(i){this.crossSourceCollisions=i,this.maxGroupID=0,this.collisionGroups={}}get(i){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[i]){const a=++this.maxGroupID;this.collisionGroups[i]={ID:a,predicate:d=>d.collisionGroupID===a}}return this.collisionGroups[i]}}function cr(_,i,a,d,p){const{horizontalAlign:v,verticalAlign:w}=c.au(_);return new c.P(-(v-.5)*i+d[0]*p,-(w-.5)*a+d[1]*p)}class Xr{constructor(i,a,d,p,v,w){this.transform=i.clone(),this.terrain=d,this.collisionIndex=new Jt(this.transform,a),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=p,this.retainedQueryData={},this.collisionGroups=new Fi(v),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=w,w&&(w.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(i){const a=this.terrain;return a?(d,p)=>a.getElevation(i,d,p):null}getBucketParts(i,a,d,p){const v=d.getBucket(a),w=d.latestFeatureIndex;if(!v||!w||a.id!==v.layerIds[0])return;const S=d.collisionBoxArray,T=v.layers[0].layout,z=v.layers[0].paint,O=Math.pow(2,this.transform.zoom-d.tileID.overscaledZ),R=d.tileSize/c.W,$=d.tileID.toUnwrapped(),G=this.transform.calculatePosMatrix($),K=T.get("text-pitch-alignment")==="map",re=T.get("text-rotation-alignment")==="map",J=Rt(d,1,this.transform.zoom),ue=this.collisionIndex.mapProjection.translatePosition(this.transform,d,z.get("text-translate"),z.get("text-translate-anchor")),ge=this.collisionIndex.mapProjection.translatePosition(this.transform,d,z.get("icon-translate"),z.get("icon-translate-anchor")),te=io(G,K,re,this.transform,J);let ve=null;if(K){const Pe=ro(G,K,re,this.transform,J);ve=c.K([],this.transform.labelPlaneMatrix,Pe)}this.retainedQueryData[v.bucketInstanceId]=new Zt(v.bucketInstanceId,w,v.sourceLayerIndex,v.index,d.tileID);const Se={bucket:v,layout:T,translationText:ue,translationIcon:ge,posMatrix:G,unwrappedTileID:$,textLabelPlaneMatrix:te,labelToScreenMatrix:ve,scale:O,textPixelRatio:R,holdingForFade:d.holdingForFade(),collisionBoxArray:S,partiallyEvaluatedTextSize:c.ag(v.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(v.sourceID)};if(p)for(const Pe of v.sortKeyRanges){const{sortKey:Ne,symbolInstanceStart:Xe,symbolInstanceEnd:ut}=Pe;i.push({sortKey:Ne,symbolInstanceStart:Xe,symbolInstanceEnd:ut,parameters:Se})}else i.push({symbolInstanceStart:0,symbolInstanceEnd:v.symbolInstances.length,parameters:Se})}attemptAnchorPlacement(i,a,d,p,v,w,S,T,z,O,R,$,G,K,re,J,ue,ge,te){const ve=c.aq[i.textAnchor],Se=[i.textOffset0,i.textOffset1],Pe=cr(ve,d,p,Se,v),Ne=this.collisionIndex.placeCollisionBox(a,$,T,z,O,S,w,J,R.predicate,te,Pe);if((!ge||this.collisionIndex.placeCollisionBox(ge,$,T,z,O,S,w,ue,R.predicate,te,Pe).placeable)&&Ne.placeable){let Xe;if(this.prevPlacement&&this.prevPlacement.variableOffsets[G.crossTileID]&&this.prevPlacement.placements[G.crossTileID]&&this.prevPlacement.placements[G.crossTileID].text&&(Xe=this.prevPlacement.variableOffsets[G.crossTileID].anchor),G.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[G.crossTileID]={textOffset:Se,width:d,height:p,anchor:ve,textBoxScale:v,prevAnchor:Xe},this.markUsedJustification(K,ve,G,re),K.allowVerticalPlacement&&(this.markUsedOrientation(K,re,G),this.placedOrientations[G.crossTileID]=re),{shift:Pe,placedGlyphBoxes:Ne}}}placeLayerBucketPart(i,a,d){const{bucket:p,layout:v,translationText:w,translationIcon:S,posMatrix:T,unwrappedTileID:z,textLabelPlaneMatrix:O,labelToScreenMatrix:R,textPixelRatio:$,holdingForFade:G,collisionBoxArray:K,partiallyEvaluatedTextSize:re,collisionGroup:J}=i.parameters,ue=v.get("text-optional"),ge=v.get("icon-optional"),te=c.ar(v,"text-overlap","text-allow-overlap"),ve=te==="always",Se=c.ar(v,"icon-overlap","icon-allow-overlap"),Pe=Se==="always",Ne=v.get("text-rotation-alignment")==="map",Xe=v.get("text-pitch-alignment")==="map",ut=v.get("icon-text-fit")!=="none",ht=v.get("symbol-z-order")==="viewport-y",Je=ve&&(Pe||!p.hasIconData()||ge),et=Pe&&(ve||!p.hasTextData()||ue);!p.collisionArrays&&K&&p.deserializeCollisionBoxes(K);const yt=this._getTerrainElevationFunc(this.retainedQueryData[p.bucketInstanceId].tileID),Ot=(it,at,Pt)=>{var Ci,Wt;if(a[it.crossTileID])return;if(G)return void(this.placements[it.crossTileID]=new Ti(!1,!1,!1));let Yt=!1,Ai=!1,Ar=!0,In=null,ki={box:null,placeable:!1,offscreen:null},en={box:null,placeable:!1,offscreen:null},Nr=null,kr=null,Mr=null,Tn=0,Qo=0,Dl=0;at.textFeatureIndex?Tn=at.textFeatureIndex:it.useRuntimeCollisionCircles&&(Tn=it.featureIndex),at.verticalTextFeatureIndex&&(Qo=at.verticalTextFeatureIndex);const Ls=at.textBox;if(Ls){const Er=Lr=>{let Pr=c.ah.horizontal;if(p.allowVerticalPlacement&&!Lr&&this.prevPlacement){const yr=this.prevPlacement.placedOrientations[it.crossTileID];yr&&(this.placedOrientations[it.crossTileID]=yr,Pr=yr,this.markUsedOrientation(p,Pr,it))}return Pr},Cn=(Lr,Pr)=>{if(p.allowVerticalPlacement&&it.numVerticalGlyphVertices>0&&at.verticalTextBox){for(const yr of p.writingModes)if(yr===c.ah.vertical?(ki=Pr(),en=ki):ki=Lr(),ki&&ki.placeable)break}else ki=Lr()},So=it.textAnchorOffsetStartIndex,Ps=it.textAnchorOffsetEndIndex;if(Ps===So){const Lr=(Pr,yr)=>{const Ni=this.collisionIndex.placeCollisionBox(Pr,te,$,T,z,Xe,Ne,w,J.predicate,yt);return Ni&&Ni.placeable&&(this.markUsedOrientation(p,yr,it),this.placedOrientations[it.crossTileID]=yr),Ni};Cn(()=>Lr(Ls,c.ah.horizontal),()=>{const Pr=at.verticalTextBox;return p.allowVerticalPlacement&&it.numVerticalGlyphVertices>0&&Pr?Lr(Pr,c.ah.vertical):{box:null,offscreen:null}}),Er(ki&&ki.placeable)}else{let Lr=c.aq[(Wt=(Ci=this.prevPlacement)===null||Ci===void 0?void 0:Ci.variableOffsets[it.crossTileID])===null||Wt===void 0?void 0:Wt.anchor];const Pr=(Ni,zs,uu)=>{const hr=Ni.x2-Ni.x1,rd=Ni.y2-Ni.y1,Ol=it.textBoxScale,Bl=ut&&Se==="never"?zs:null;let Io=null,nd=te==="never"?1:2,hu="never";Lr&&nd++;for(let du=0;du<nd;du++){for(let fu=So;fu<Ps;fu++){const Fl=p.textAnchorOffsets.get(fu);if(Lr&&Fl.textAnchor!==Lr)continue;const Ds=this.attemptAnchorPlacement(Fl,Ni,hr,rd,Ol,Ne,Xe,$,T,z,J,hu,it,p,uu,w,S,Bl,yt);if(Ds&&(Io=Ds.placedGlyphBoxes,Io&&Io.placeable))return Yt=!0,In=Ds.shift,Io}Lr?Lr=null:hu=te}return d&&!Io&&(Io={box:this.collisionIndex.placeCollisionBox(Ls,"always",$,T,z,Xe,Ne,w,J.predicate,yt,new c.P(0,0)).box,offscreen:!1,placeable:!1}),Io};Cn(()=>Pr(Ls,at.iconBox,c.ah.horizontal),()=>{const Ni=at.verticalTextBox;return p.allowVerticalPlacement&&(!ki||!ki.placeable)&&it.numVerticalGlyphVertices>0&&Ni?Pr(Ni,at.verticalIconBox,c.ah.vertical):{box:null,occluded:!0,offscreen:null}}),ki&&(Yt=ki.placeable,Ar=ki.offscreen);const yr=Er(ki&&ki.placeable);if(!Yt&&this.prevPlacement){const Ni=this.prevPlacement.variableOffsets[it.crossTileID];Ni&&(this.variableOffsets[it.crossTileID]=Ni,this.markUsedJustification(p,Ni.anchor,it,yr))}}}if(Nr=ki,Yt=Nr&&Nr.placeable,Ar=Nr&&Nr.offscreen,it.useRuntimeCollisionCircles){const Er=p.text.placedSymbolArray.get(it.centerJustifiedTextSymbolIndex),Cn=c.ai(p.textSizeData,re,Er),So=v.get("text-padding");kr=this.collisionIndex.placeCollisionCircles(te,Er,p.lineVertexArray,p.glyphOffsetArray,Cn,T,z,O,R,d,Xe,J.predicate,it.collisionCircleDiameter,So,w,yt),kr.circles.length&&kr.collisionDetected&&!d&&c.w("Collisions detected, but collision boxes are not shown"),Yt=ve||kr.circles.length>0&&!kr.collisionDetected,Ar=Ar&&kr.offscreen}if(at.iconFeatureIndex&&(Dl=at.iconFeatureIndex),at.iconBox){const Er=Cn=>this.collisionIndex.placeCollisionBox(Cn,Se,$,T,z,Xe,Ne,S,J.predicate,yt,ut&&In?In:void 0);en&&en.placeable&&at.verticalIconBox?(Mr=Er(at.verticalIconBox),Ai=Mr.placeable):(Mr=Er(at.iconBox),Ai=Mr.placeable),Ar=Ar&&Mr.offscreen}const es=ue||it.numHorizontalGlyphVertices===0&&it.numVerticalGlyphVertices===0,Rl=ge||it.numIconVertices===0;es||Rl?Rl?es||(Ai=Ai&&Yt):Yt=Ai&&Yt:Ai=Yt=Ai&&Yt;const cu=Ai&&Mr.placeable;if(Yt&&Nr.placeable&&this.collisionIndex.insertCollisionBox(Nr.box,te,v.get("text-ignore-placement"),p.bucketInstanceId,en&&en.placeable&&Qo?Qo:Tn,J.ID),cu&&this.collisionIndex.insertCollisionBox(Mr.box,Se,v.get("icon-ignore-placement"),p.bucketInstanceId,Dl,J.ID),kr&&Yt&&this.collisionIndex.insertCollisionCircles(kr.circles,te,v.get("text-ignore-placement"),p.bucketInstanceId,Tn,J.ID),d&&this.storeCollisionData(p.bucketInstanceId,Pt,at,Nr,Mr,kr),it.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(p.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[it.crossTileID]=new Ti(Yt||Je,Ai||et,Ar||p.justReloaded),a[it.crossTileID]=!0};if(ht){if(i.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const it=p.getSortedSymbolIndexes(this.transform.angle);for(let at=it.length-1;at>=0;--at){const Pt=it[at];Ot(p.symbolInstances.get(Pt),p.collisionArrays[Pt],Pt)}}else for(let it=i.symbolInstanceStart;it<i.symbolInstanceEnd;it++)Ot(p.symbolInstances.get(it),p.collisionArrays[it],it);if(d&&p.bucketInstanceId in this.collisionCircleArrays){const it=this.collisionCircleArrays[p.bucketInstanceId];c.as(it.invProjMatrix,T),it.viewportMatrix=this.collisionIndex.getViewportMatrix()}p.justReloaded=!1}storeCollisionData(i,a,d,p,v,w){if(d.textBox||d.iconBox){let S,T;this.collisionBoxArrays.has(i)?S=this.collisionBoxArrays.get(i):(S=new Map,this.collisionBoxArrays.set(i,S)),S.has(a)?T=S.get(a):(T={text:null,icon:null},S.set(a,T)),d.textBox&&(T.text=p.box),d.iconBox&&(T.icon=v.box)}if(w){let S=this.collisionCircleArrays[i];S===void 0&&(S=this.collisionCircleArrays[i]=new rr);for(let T=0;T<w.circles.length;T+=4)S.circles.push(w.circles[T+0]),S.circles.push(w.circles[T+1]),S.circles.push(w.circles[T+2]),S.circles.push(w.collisionDetected?1:0)}}markUsedJustification(i,a,d,p){let v;v=p===c.ah.vertical?d.verticalPlacedTextSymbolIndex:{left:d.leftJustifiedTextSymbolIndex,center:d.centerJustifiedTextSymbolIndex,right:d.rightJustifiedTextSymbolIndex}[c.at(a)];const w=[d.leftJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.rightJustifiedTextSymbolIndex,d.verticalPlacedTextSymbolIndex];for(const S of w)S>=0&&(i.text.placedSymbolArray.get(S).crossTileID=v>=0&&S!==v?0:d.crossTileID)}markUsedOrientation(i,a,d){const p=a===c.ah.horizontal||a===c.ah.horizontalOnly?a:0,v=a===c.ah.vertical?a:0,w=[d.leftJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.rightJustifiedTextSymbolIndex];for(const S of w)i.text.placedSymbolArray.get(S).placedOrientation=p;d.verticalPlacedTextSymbolIndex&&(i.text.placedSymbolArray.get(d.verticalPlacedTextSymbolIndex).placedOrientation=v)}commit(i){this.commitTime=i,this.zoomAtLastRecencyCheck=this.transform.zoom;const a=this.prevPlacement;let d=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;const p=a?a.symbolFadeChange(i):1,v=a?a.opacities:{},w=a?a.variableOffsets:{},S=a?a.placedOrientations:{};for(const T in this.placements){const z=this.placements[T],O=v[T];O?(this.opacities[T]=new mi(O,p,z.text,z.icon),d=d||z.text!==O.text.placed||z.icon!==O.icon.placed):(this.opacities[T]=new mi(null,p,z.text,z.icon,z.skipFade),d=d||z.text||z.icon)}for(const T in v){const z=v[T];if(!this.opacities[T]){const O=new mi(z,p,!1,!1);O.isHidden()||(this.opacities[T]=O,d=d||z.text.placed||z.icon.placed)}}for(const T in w)this.variableOffsets[T]||!this.opacities[T]||this.opacities[T].isHidden()||(this.variableOffsets[T]=w[T]);for(const T in S)this.placedOrientations[T]||!this.opacities[T]||this.opacities[T].isHidden()||(this.placedOrientations[T]=S[T]);if(a&&a.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");d?this.lastPlacementChangeTime=i:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:i)}updateLayerOpacities(i,a){const d={};for(const p of a){const v=p.getBucket(i);v&&p.latestFeatureIndex&&i.id===v.layerIds[0]&&this.updateBucketOpacities(v,p.tileID,d,p.collisionBoxArray)}}updateBucketOpacities(i,a,d,p){i.hasTextData()&&(i.text.opacityVertexArray.clear(),i.text.hasVisibleVertices=!1),i.hasIconData()&&(i.icon.opacityVertexArray.clear(),i.icon.hasVisibleVertices=!1),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexArray.clear(),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexArray.clear();const v=i.layers[0],w=v.layout,S=new mi(null,0,!1,!1,!0),T=w.get("text-allow-overlap"),z=w.get("icon-allow-overlap"),O=v._unevaluatedLayout.hasValue("text-variable-anchor")||v._unevaluatedLayout.hasValue("text-variable-anchor-offset"),R=w.get("text-rotation-alignment")==="map",$=w.get("text-pitch-alignment")==="map",G=w.get("icon-text-fit")!=="none",K=new mi(null,0,T&&(z||!i.hasIconData()||w.get("icon-optional")),z&&(T||!i.hasTextData()||w.get("text-optional")),!0);!i.collisionArrays&&p&&(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData())&&i.deserializeCollisionBoxes(p);const re=(ue,ge,te)=>{for(let ve=0;ve<ge/4;ve++)ue.opacityVertexArray.emplaceBack(te);ue.hasVisibleVertices=ue.hasVisibleVertices||te!==ha},J=this.collisionBoxArrays.get(i.bucketInstanceId);for(let ue=0;ue<i.symbolInstances.length;ue++){const ge=i.symbolInstances.get(ue),{numHorizontalGlyphVertices:te,numVerticalGlyphVertices:ve,crossTileID:Se}=ge;let Pe=this.opacities[Se];d[Se]?Pe=S:Pe||(Pe=K,this.opacities[Se]=Pe),d[Se]=!0;const Ne=ge.numIconVertices>0,Xe=this.placedOrientations[ge.crossTileID],ut=Xe===c.ah.vertical,ht=Xe===c.ah.horizontal||Xe===c.ah.horizontalOnly;if(te>0||ve>0){const et=Jr(Pe.text);re(i.text,te,ut?ha:et),re(i.text,ve,ht?ha:et);const yt=Pe.text.isHidden();[ge.rightJustifiedTextSymbolIndex,ge.centerJustifiedTextSymbolIndex,ge.leftJustifiedTextSymbolIndex].forEach(at=>{at>=0&&(i.text.placedSymbolArray.get(at).hidden=yt||ut?1:0)}),ge.verticalPlacedTextSymbolIndex>=0&&(i.text.placedSymbolArray.get(ge.verticalPlacedTextSymbolIndex).hidden=yt||ht?1:0);const Ot=this.variableOffsets[ge.crossTileID];Ot&&this.markUsedJustification(i,Ot.anchor,ge,Xe);const it=this.placedOrientations[ge.crossTileID];it&&(this.markUsedJustification(i,"left",ge,it),this.markUsedOrientation(i,it,ge))}if(Ne){const et=Jr(Pe.icon),yt=!(G&&ge.verticalPlacedIconSymbolIndex&&ut);ge.placedIconSymbolIndex>=0&&(re(i.icon,ge.numIconVertices,yt?et:ha),i.icon.placedSymbolArray.get(ge.placedIconSymbolIndex).hidden=Pe.icon.isHidden()),ge.verticalPlacedIconSymbolIndex>=0&&(re(i.icon,ge.numVerticalIconVertices,yt?ha:et),i.icon.placedSymbolArray.get(ge.verticalPlacedIconSymbolIndex).hidden=Pe.icon.isHidden())}const Je=J&&J.has(ue)?J.get(ue):{text:null,icon:null};if(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData()){const et=i.collisionArrays[ue];if(et){let yt=new c.P(0,0);if(et.textBox||et.verticalTextBox){let Ot=!0;if(O){const it=this.variableOffsets[Se];it?(yt=cr(it.anchor,it.width,it.height,it.textOffset,it.textBoxScale),R&&yt._rotate($?this.transform.angle:-this.transform.angle)):Ot=!1}if(et.textBox||et.verticalTextBox){let it;et.textBox&&(it=ut),et.verticalTextBox&&(it=ht),cn(i.textCollisionBox.collisionVertexArray,Pe.text.placed,!Ot||it,Je.text,yt.x,yt.y)}}if(et.iconBox||et.verticalIconBox){const Ot=!!(!ht&&et.verticalIconBox);let it;et.iconBox&&(it=Ot),et.verticalIconBox&&(it=!Ot),cn(i.iconCollisionBox.collisionVertexArray,Pe.icon.placed,it,Je.icon,G?yt.x:0,G?yt.y:0)}}}}if(i.sortFeatures(this.transform.angle),this.retainedQueryData[i.bucketInstanceId]&&(this.retainedQueryData[i.bucketInstanceId].featureSortOrder=i.featureSortOrder),i.hasTextData()&&i.text.opacityVertexBuffer&&i.text.opacityVertexBuffer.updateData(i.text.opacityVertexArray),i.hasIconData()&&i.icon.opacityVertexBuffer&&i.icon.opacityVertexBuffer.updateData(i.icon.opacityVertexArray),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexBuffer&&i.iconCollisionBox.collisionVertexBuffer.updateData(i.iconCollisionBox.collisionVertexArray),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexBuffer&&i.textCollisionBox.collisionVertexBuffer.updateData(i.textCollisionBox.collisionVertexArray),i.text.opacityVertexArray.length!==i.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${i.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${i.text.layoutVertexArray.length}) / 4`);if(i.icon.opacityVertexArray.length!==i.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${i.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${i.icon.layoutVertexArray.length}) / 4`);if(i.bucketInstanceId in this.collisionCircleArrays){const ue=this.collisionCircleArrays[i.bucketInstanceId];i.placementInvProjMatrix=ue.invProjMatrix,i.placementViewportMatrix=ue.viewportMatrix,i.collisionCircleArray=ue.circles,delete this.collisionCircleArrays[i.bucketInstanceId]}}symbolFadeChange(i){return this.fadeDuration===0?1:(i-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(i){return Math.max(0,(this.transform.zoom-i)/1.5)}hasTransitions(i){return this.stale||i-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(i,a){const d=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*d>i}setStale(){this.stale=!0}}function cn(_,i,a,d,p,v){d&&d.length!==0||(d=[0,0,0,0]);const w=d[0]-St,S=d[1]-St,T=d[2]-St,z=d[3]-St;_.emplaceBack(i?1:0,a?1:0,p||0,v||0,w,S),_.emplaceBack(i?1:0,a?1:0,p||0,v||0,T,S),_.emplaceBack(i?1:0,a?1:0,p||0,v||0,T,z),_.emplaceBack(i?1:0,a?1:0,p||0,v||0,w,z)}const ur=Math.pow(2,25),_s=Math.pow(2,24),Yf=Math.pow(2,17),di=Math.pow(2,16),wc=Math.pow(2,9),Ec=Math.pow(2,8),un=Math.pow(2,1);function Jr(_){if(_.opacity===0&&!_.placed)return 0;if(_.opacity===1&&_.placed)return 4294967295;const i=_.placed?1:0,a=Math.floor(127*_.opacity);return a*ur+i*_s+a*Yf+i*di+a*wc+i*Ec+a*un+i}const ha=0;function Yr(){return{isOccluded:(_,i,a)=>!1,getPitchedTextCorrection:(_,i,a)=>1,get useSpecialProjectionForSymbols(){return!1},projectTileCoordinates(_,i,a,d){throw new Error("Not implemented.")},translatePosition:(_,i,a,d)=>function(p,v,w,S,T=!1){if(!w[0]&&!w[1])return[0,0];const z=T?S==="map"?p.angle:0:S==="viewport"?-p.angle:0;if(z){const O=Math.sin(z),R=Math.cos(z);w=[w[0]*R-w[1]*O,w[0]*O+w[1]*R]}return[T?w[0]:Rt(v,w[0],p.zoom),T?w[1]:Rt(v,w[1],p.zoom)]}(_,i,a,d),getCircleRadiusCorrection:_=>1}}class _n{constructor(i){this._sortAcrossTiles=i.layout.get("symbol-z-order")!=="viewport-y"&&!i.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(i,a,d,p,v){const w=this._bucketParts;for(;this._currentTileIndex<i.length;)if(a.getBucketParts(w,p,i[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,v())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,w.sort((S,T)=>S.sortKey-T.sortKey));this._currentPartIndex<w.length;)if(a.placeLayerBucketPart(w[this._currentPartIndex],this._seenCrossTileIDs,d),this._currentPartIndex++,v())return!0;return!1}}class xh{constructor(i,a,d,p,v,w,S,T){this.placement=new Xr(i,Yr(),a,w,S,T),this._currentPlacementIndex=d.length-1,this._forceFullPlacement=p,this._showCollisionBoxes=v,this._done=!1}isDone(){return this._done}continuePlacement(i,a,d){const p=C.now(),v=()=>!this._forceFullPlacement&&C.now()-p>2;for(;this._currentPlacementIndex>=0;){const w=a[i[this._currentPlacementIndex]],S=this.placement.collisionIndex.transform.zoom;if(w.type==="symbol"&&(!w.minzoom||w.minzoom<=S)&&(!w.maxzoom||w.maxzoom>S)){if(this._inProgressLayer||(this._inProgressLayer=new _n(w)),this._inProgressLayer.continuePlacement(d[w.source],this.placement,this._showCollisionBoxes,w,v))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(i){return this.placement.commit(i),this.placement}}const no=512/c.W/2;class nr{constructor(i,a,d){this.tileID=i,this.bucketInstanceId=d,this._symbolsByKey={};const p=new Map;for(let v=0;v<a.length;v++){const w=a.get(v),S=w.key,T=p.get(S);T?T.push(w):p.set(S,[w])}for(const[v,w]of p){const S={positions:w.map(T=>({x:Math.floor(T.anchorX*no),y:Math.floor(T.anchorY*no)})),crossTileIDs:w.map(T=>T.crossTileID)};if(S.positions.length>128){const T=new c.av(S.positions.length,16,Uint16Array);for(const{x:z,y:O}of S.positions)T.add(z,O);T.finish(),delete S.positions,S.index=T}this._symbolsByKey[v]=S}}getScaledCoordinates(i,a){const{x:d,y:p,z:v}=this.tileID.canonical,{x:w,y:S,z:T}=a.canonical,z=no/Math.pow(2,T-v),O=(S*c.W+i.anchorY)*z,R=p*c.W*no;return{x:Math.floor((w*c.W+i.anchorX)*z-d*c.W*no),y:Math.floor(O-R)}}findMatches(i,a,d){const p=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z);for(let v=0;v<i.length;v++){const w=i.get(v);if(w.crossTileID)continue;const S=this._symbolsByKey[w.key];if(!S)continue;const T=this.getScaledCoordinates(w,a);if(S.index){const z=S.index.range(T.x-p,T.y-p,T.x+p,T.y+p).sort();for(const O of z){const R=S.crossTileIDs[O];if(!d[R]){d[R]=!0,w.crossTileID=R;break}}}else if(S.positions)for(let z=0;z<S.positions.length;z++){const O=S.positions[z],R=S.crossTileIDs[z];if(Math.abs(O.x-T.x)<=p&&Math.abs(O.y-T.y)<=p&&!d[R]){d[R]=!0,w.crossTileID=R;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:i})=>i)}}class da{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Uo{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(i){const a=Math.round((i-this.lng)/360);if(a!==0)for(const d in this.indexes){const p=this.indexes[d],v={};for(const w in p){const S=p[w];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+a),v[S.tileID.key]=S}this.indexes[d]=v}this.lng=i}addBucket(i,a,d){if(this.indexes[i.overscaledZ]&&this.indexes[i.overscaledZ][i.key]){if(this.indexes[i.overscaledZ][i.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(i.overscaledZ,this.indexes[i.overscaledZ][i.key])}for(let v=0;v<a.symbolInstances.length;v++)a.symbolInstances.get(v).crossTileID=0;this.usedCrossTileIDs[i.overscaledZ]||(this.usedCrossTileIDs[i.overscaledZ]={});const p=this.usedCrossTileIDs[i.overscaledZ];for(const v in this.indexes){const w=this.indexes[v];if(Number(v)>i.overscaledZ)for(const S in w){const T=w[S];T.tileID.isChildOf(i)&&T.findMatches(a.symbolInstances,i,p)}else{const S=w[i.scaledTo(Number(v)).key];S&&S.findMatches(a.symbolInstances,i,p)}}for(let v=0;v<a.symbolInstances.length;v++){const w=a.symbolInstances.get(v);w.crossTileID||(w.crossTileID=d.generate(),p[w.crossTileID]=!0)}return this.indexes[i.overscaledZ]===void 0&&(this.indexes[i.overscaledZ]={}),this.indexes[i.overscaledZ][i.key]=new nr(i,a.symbolInstances,a.bucketInstanceId),!0}removeBucketCrossTileIDs(i,a){for(const d of a.getCrossTileIDsLists())for(const p of d)delete this.usedCrossTileIDs[i][p]}removeStaleBuckets(i){let a=!1;for(const d in this.indexes){const p=this.indexes[d];for(const v in p)i[p[v].bucketInstanceId]||(this.removeBucketCrossTileIDs(d,p[v]),delete p[v],a=!0)}return a}}class Wi{constructor(){this.layerIndexes={},this.crossTileIDs=new da,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(i,a,d){let p=this.layerIndexes[i.id];p===void 0&&(p=this.layerIndexes[i.id]=new Uo);let v=!1;const w={};p.handleWrapJump(d);for(const S of a){const T=S.getBucket(i);T&&i.id===T.layerIds[0]&&(T.bucketInstanceId||(T.bucketInstanceId=++this.maxBucketInstanceId),p.addBucket(S.tileID,T,this.crossTileIDs)&&(v=!0),w[T.bucketInstanceId]=!0)}return p.removeStaleBuckets(w)&&(v=!0),v}pruneUnusedLayers(i){const a={};i.forEach(d=>{a[d]=!0});for(const d in this.layerIndexes)a[d]||delete this.layerIndexes[d]}}const qo=(_,i)=>c.t(_,i&&i.filter(a=>a.identifier!=="source.canvas")),Sn=c.aw();class il extends c.E{constructor(i,a={}){super(),this._rtlPluginLoaded=()=>{for(const d in this.sourceCaches){const p=this.sourceCaches[d].getSource().type;p!=="vector"&&p!=="geojson"||this.sourceCaches[d].reload()}},this.map=i,this.dispatcher=new Bi(Pi(),i._getMapId()),this.dispatcher.registerMessageHandler("GG",(d,p)=>this.getGlyphs(d,p)),this.dispatcher.registerMessageHandler("GI",(d,p)=>this.getImages(d,p)),this.imageManager=new Oe,this.imageManager.setEventedParent(this),this.glyphManager=new dt(i._requestManager,a.localIdeographFontFamily),this.lineAtlas=new Nt(256,512),this.crossTileSymbolIndex=new Wi,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new c.ax,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",c.ay()),Gt().on(Lt,this._rtlPluginLoaded),this.on("data",d=>{if(d.dataType!=="source"||d.sourceDataType!=="metadata")return;const p=this.sourceCaches[d.sourceId];if(!p)return;const v=p.getSource();if(v&&v.vectorLayerIds)for(const w in this._layers){const S=this._layers[w];S.source===v.id&&this._validateLayer(S)}})}loadURL(i,a={},d){this.fire(new c.k("dataloading",{dataType:"style"})),a.validate=typeof a.validate!="boolean"||a.validate;const p=this.map._requestManager.transformRequest(i,"Style");this._loadStyleRequest=new AbortController,c.h(p,this._loadStyleRequest).then(v=>{this._loadStyleRequest=null,this._load(v.data,a,d)}).catch(v=>{this._loadStyleRequest=null,v&&this.fire(new c.j(v))})}loadJSON(i,a={},d){this.fire(new c.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,C.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,a.validate=a.validate!==!1,this._load(i,a,d)}).catch(()=>{})}loadEmpty(){this.fire(new c.k("dataloading",{dataType:"style"})),this._load(Sn,{validate:!1})}_load(i,a,d){var p;const v=a.transformStyle?a.transformStyle(d,i):i;if(!a.validate||!qo(this,c.x(v))){this._loaded=!0,this.stylesheet=v;for(const w in v.sources)this.addSource(w,v.sources[w],{validate:!1});v.sprite?this._loadSprite(v.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(v.glyphs),this._createLayers(),this.light=new Ut(this.stylesheet.light),this.map.setTerrain((p=this.stylesheet.terrain)!==null&&p!==void 0?p:null),this.fire(new c.k("data",{dataType:"style"})),this.fire(new c.k("style.load"))}}_createLayers(){const i=c.az(this.stylesheet.layers);this.dispatcher.broadcast("SL",i),this._order=i.map(a=>a.id),this._layers={},this._serializedLayers=null;for(const a of i){const d=c.aA(a);d.setEventedParent(this,{layer:{id:a.id}}),this._layers[a.id]=d}}_loadSprite(i,a=!1,d=void 0){let p;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(v,w,S,T){return c._(this,void 0,void 0,function*(){const z=Le(v),O=S>1?"@2x":"",R={},$={};for(const{id:G,url:K}of z){const re=w.transformRequest(me(K,O,".json"),"SpriteJSON");R[G]=c.h(re,T);const J=w.transformRequest(me(K,O,".png"),"SpriteImage");$[G]=H.getImage(J,T)}return yield Promise.all([...Object.values(R),...Object.values($)]),function(G,K){return c._(this,void 0,void 0,function*(){const re={};for(const J in G){re[J]={};const ue=C.getImageCanvasContext((yield K[J]).data),ge=(yield G[J]).data;for(const te in ge){const{width:ve,height:Se,x:Pe,y:Ne,sdf:Xe,pixelRatio:ut,stretchX:ht,stretchY:Je,content:et,textFitWidth:yt,textFitHeight:Ot}=ge[te];re[J][te]={data:null,pixelRatio:ut,sdf:Xe,stretchX:ht,stretchY:Je,content:et,textFitWidth:yt,textFitHeight:Ot,spriteData:{width:ve,height:Se,x:Pe,y:Ne,context:ue}}}}return re})}(R,$)})}(i,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(v=>{if(this._spriteRequest=null,v)for(const w in v){this._spritesImagesIds[w]=[];const S=this._spritesImagesIds[w]?this._spritesImagesIds[w].filter(T=>!(T in v)):[];for(const T of S)this.imageManager.removeImage(T),this._changedImages[T]=!0;for(const T in v[w]){const z=w==="default"?T:`${w}:${T}`;this._spritesImagesIds[w].push(z),z in this.imageManager.images?this.imageManager.updateImage(z,v[w][T],!1):this.imageManager.addImage(z,v[w][T]),a&&(this._changedImages[z]=!0)}}}).catch(v=>{this._spriteRequest=null,p=v,this.fire(new c.j(p))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),a&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"})),d&&d(p)})}_unloadSprite(){for(const i of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(i),this._changedImages[i]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}_validateLayer(i){const a=this.sourceCaches[i.source];if(!a)return;const d=i.sourceLayer;if(!d)return;const p=a.getSource();(p.type==="geojson"||p.vectorLayerIds&&p.vectorLayerIds.indexOf(d)===-1)&&this.fire(new c.j(new Error(`Source layer "${d}" does not exist on source "${p.id}" as specified by style layer "${i.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const i in this.sourceCaches)if(!this.sourceCaches[i].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(i){const a=this._serializedAllLayers();if(!i||i.length===0)return Object.values(a);const d=[];for(const p of i)a[p]&&d.push(a[p]);return d}_serializedAllLayers(){let i=this._serializedLayers;if(i)return i;i=this._serializedLayers={};const a=Object.keys(this._layers);for(const d of a){const p=this._layers[d];p.type!=="custom"&&(i[d]=p.serialize())}return i}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const i in this.sourceCaches)if(this.sourceCaches[i].hasTransition())return!0;for(const i in this._layers)if(this._layers[i].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(i){if(!this._loaded)return;const a=this._changed;if(a){const p=Object.keys(this._updatedLayers),v=Object.keys(this._removedLayers);(p.length||v.length)&&this._updateWorkerLayers(p,v);for(const w in this._updatedSources){const S=this._updatedSources[w];if(S==="reload")this._reloadSource(w);else{if(S!=="clear")throw new Error(`Invalid action ${S}`);this._clearSource(w)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const w in this._updatedPaintProps)this._layers[w].updateTransitions(i);this.light.updateTransitions(i),this._resetUpdates()}const d={};for(const p in this.sourceCaches){const v=this.sourceCaches[p];d[p]=v.used,v.used=!1}for(const p of this._order){const v=this._layers[p];v.recalculate(i,this._availableImages),!v.isHidden(i.zoom)&&v.source&&(this.sourceCaches[v.source].used=!0)}for(const p in d){const v=this.sourceCaches[p];!!d[p]!=!!v.used&&v.fire(new c.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:p}))}this.light.recalculate(i),this.z=i.zoom,a&&this.fire(new c.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const i=Object.keys(this._changedImages);if(i.length){for(const a in this.sourceCaches)this.sourceCaches[a].reloadTilesForDependencies(["icons","patterns"],i);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const i in this.sourceCaches)this.sourceCaches[i].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(i,a){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(i),removedIds:a})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(i,a={}){var d;this._checkLoaded();const p=this.serialize();if(i=a.transformStyle?a.transformStyle(p,i):i,((d=a.validate)===null||d===void 0||d)&&qo(this,c.x(i)))return!1;(i=c.aB(i)).layers=c.az(i.layers);const v=c.aC(p,i),w=this._getOperationsToPerform(v);if(w.unimplemented.length>0)throw new Error(`Unimplemented: ${w.unimplemented.join(", ")}.`);if(w.operations.length===0)return!1;for(const S of w.operations)S();return this.stylesheet=i,this._serializedLayers=null,!0}_getOperationsToPerform(i){const a=[],d=[];for(const p of i)switch(p.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":a.push(()=>this.addLayer.apply(this,p.args));break;case"removeLayer":a.push(()=>this.removeLayer.apply(this,p.args));break;case"setPaintProperty":a.push(()=>this.setPaintProperty.apply(this,p.args));break;case"setLayoutProperty":a.push(()=>this.setLayoutProperty.apply(this,p.args));break;case"setFilter":a.push(()=>this.setFilter.apply(this,p.args));break;case"addSource":a.push(()=>this.addSource.apply(this,p.args));break;case"removeSource":a.push(()=>this.removeSource.apply(this,p.args));break;case"setLayerZoomRange":a.push(()=>this.setLayerZoomRange.apply(this,p.args));break;case"setLight":a.push(()=>this.setLight.apply(this,p.args));break;case"setGeoJSONSourceData":a.push(()=>this.setGeoJSONSourceData.apply(this,p.args));break;case"setGlyphs":a.push(()=>this.setGlyphs.apply(this,p.args));break;case"setSprite":a.push(()=>this.setSprite.apply(this,p.args));break;case"setTerrain":a.push(()=>this.map.setTerrain.apply(this,p.args));break;case"setTransition":a.push(()=>{});break;default:d.push(p.command)}return{operations:a,unimplemented:d}}addImage(i,a){if(this.getImage(i))return this.fire(new c.j(new Error(`An image named "${i}" already exists.`)));this.imageManager.addImage(i,a),this._afterImageUpdated(i)}updateImage(i,a){this.imageManager.updateImage(i,a)}getImage(i){return this.imageManager.getImage(i)}removeImage(i){if(!this.getImage(i))return this.fire(new c.j(new Error(`An image named "${i}" does not exist.`)));this.imageManager.removeImage(i),this._afterImageUpdated(i)}_afterImageUpdated(i){this._availableImages=this.imageManager.listImages(),this._changedImages[i]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(i,a,d={}){if(this._checkLoaded(),this.sourceCaches[i]!==void 0)throw new Error(`Source "${i}" already exists.`);if(!a.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(a).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(a.type)>=0&&this._validate(c.x.source,`sources.${i}`,a,null,d))return;this.map&&this.map._collectResourceTiming&&(a.collectResourceTiming=!0);const p=this.sourceCaches[i]=new Ye(i,a,this.dispatcher);p.style=this,p.setEventedParent(this,()=>({isSourceLoaded:p.loaded(),source:p.serialize(),sourceId:i})),p.onAdd(this.map),this._changed=!0}removeSource(i){if(this._checkLoaded(),this.sourceCaches[i]===void 0)throw new Error("There is no source with this ID");for(const d in this._layers)if(this._layers[d].source===i)return this.fire(new c.j(new Error(`Source "${i}" cannot be removed while layer "${d}" is using it.`)));const a=this.sourceCaches[i];delete this.sourceCaches[i],delete this._updatedSources[i],a.fire(new c.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:i})),a.setEventedParent(null),a.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(i,a){if(this._checkLoaded(),this.sourceCaches[i]===void 0)throw new Error(`There is no source with this ID=${i}`);const d=this.sourceCaches[i].getSource();if(d.type!=="geojson")throw new Error(`geojsonSource.type is ${d.type}, which is !== 'geojson`);d.setData(a),this._changed=!0}getSource(i){return this.sourceCaches[i]&&this.sourceCaches[i].getSource()}addLayer(i,a,d={}){this._checkLoaded();const p=i.id;if(this.getLayer(p))return void this.fire(new c.j(new Error(`Layer "${p}" already exists on this map.`)));let v;if(i.type==="custom"){if(qo(this,c.aD(i)))return;v=c.aA(i)}else{if("source"in i&&typeof i.source=="object"&&(this.addSource(p,i.source),i=c.aB(i),i=c.e(i,{source:p})),this._validate(c.x.layer,`layers.${p}`,i,{arrayIndex:-1},d))return;v=c.aA(i),this._validateLayer(v),v.setEventedParent(this,{layer:{id:p}})}const w=a?this._order.indexOf(a):this._order.length;if(a&&w===-1)this.fire(new c.j(new Error(`Cannot add layer "${p}" before non-existing layer "${a}".`)));else{if(this._order.splice(w,0,p),this._layerOrderChanged=!0,this._layers[p]=v,this._removedLayers[p]&&v.source&&v.type!=="custom"){const S=this._removedLayers[p];delete this._removedLayers[p],S.type!==v.type?this._updatedSources[v.source]="clear":(this._updatedSources[v.source]="reload",this.sourceCaches[v.source].pause())}this._updateLayer(v),v.onAdd&&v.onAdd(this.map)}}moveLayer(i,a){if(this._checkLoaded(),this._changed=!0,!this._layers[i])return void this.fire(new c.j(new Error(`The layer '${i}' does not exist in the map's style and cannot be moved.`)));if(i===a)return;const d=this._order.indexOf(i);this._order.splice(d,1);const p=a?this._order.indexOf(a):this._order.length;a&&p===-1?this.fire(new c.j(new Error(`Cannot move layer "${i}" before non-existing layer "${a}".`))):(this._order.splice(p,0,i),this._layerOrderChanged=!0)}removeLayer(i){this._checkLoaded();const a=this._layers[i];if(!a)return void this.fire(new c.j(new Error(`Cannot remove non-existing layer "${i}".`)));a.setEventedParent(null);const d=this._order.indexOf(i);this._order.splice(d,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[i]=a,delete this._layers[i],this._serializedLayers&&delete this._serializedLayers[i],delete this._updatedLayers[i],delete this._updatedPaintProps[i],a.onRemove&&a.onRemove(this.map)}getLayer(i){return this._layers[i]}getLayersOrder(){return[...this._order]}hasLayer(i){return i in this._layers}setLayerZoomRange(i,a,d){this._checkLoaded();const p=this.getLayer(i);p?p.minzoom===a&&p.maxzoom===d||(a!=null&&(p.minzoom=a),d!=null&&(p.maxzoom=d),this._updateLayer(p)):this.fire(new c.j(new Error(`Cannot set the zoom range of non-existing layer "${i}".`)))}setFilter(i,a,d={}){this._checkLoaded();const p=this.getLayer(i);if(p){if(!c.aE(p.filter,a))return a==null?(p.filter=void 0,void this._updateLayer(p)):void(this._validate(c.x.filter,`layers.${p.id}.filter`,a,null,d)||(p.filter=c.aB(a),this._updateLayer(p)))}else this.fire(new c.j(new Error(`Cannot filter non-existing layer "${i}".`)))}getFilter(i){return c.aB(this.getLayer(i).filter)}setLayoutProperty(i,a,d,p={}){this._checkLoaded();const v=this.getLayer(i);v?c.aE(v.getLayoutProperty(a),d)||(v.setLayoutProperty(a,d,p),this._updateLayer(v)):this.fire(new c.j(new Error(`Cannot style non-existing layer "${i}".`)))}getLayoutProperty(i,a){const d=this.getLayer(i);if(d)return d.getLayoutProperty(a);this.fire(new c.j(new Error(`Cannot get style of non-existing layer "${i}".`)))}setPaintProperty(i,a,d,p={}){this._checkLoaded();const v=this.getLayer(i);v?c.aE(v.getPaintProperty(a),d)||(v.setPaintProperty(a,d,p)&&this._updateLayer(v),this._changed=!0,this._updatedPaintProps[i]=!0,this._serializedLayers=null):this.fire(new c.j(new Error(`Cannot style non-existing layer "${i}".`)))}getPaintProperty(i,a){return this.getLayer(i).getPaintProperty(a)}setFeatureState(i,a){this._checkLoaded();const d=i.source,p=i.sourceLayer,v=this.sourceCaches[d];if(v===void 0)return void this.fire(new c.j(new Error(`The source '${d}' does not exist in the map's style.`)));const w=v.getSource().type;w==="geojson"&&p?this.fire(new c.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):w!=="vector"||p?(i.id===void 0&&this.fire(new c.j(new Error("The feature id parameter must be provided."))),v.setFeatureState(p,i.id,a)):this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(i,a){this._checkLoaded();const d=i.source,p=this.sourceCaches[d];if(p===void 0)return void this.fire(new c.j(new Error(`The source '${d}' does not exist in the map's style.`)));const v=p.getSource().type,w=v==="vector"?i.sourceLayer:void 0;v!=="vector"||w?a&&typeof i.id!="string"&&typeof i.id!="number"?this.fire(new c.j(new Error("A feature id is required to remove its specific state property."))):p.removeFeatureState(w,i.id,a):this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(i){this._checkLoaded();const a=i.source,d=i.sourceLayer,p=this.sourceCaches[a];if(p!==void 0)return p.getSource().type!=="vector"||d?(i.id===void 0&&this.fire(new c.j(new Error("The feature id parameter must be provided."))),p.getFeatureState(d,i.id)):void this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new c.j(new Error(`The source '${a}' does not exist in the map's style.`)))}getTransition(){return c.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const i=c.aF(this.sourceCaches,v=>v.serialize()),a=this._serializeByIds(this._order),d=this.map.getTerrain()||void 0,p=this.stylesheet;return c.aG({version:p.version,name:p.name,metadata:p.metadata,light:p.light,center:p.center,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch,sprite:p.sprite,glyphs:p.glyphs,transition:p.transition,sources:i,layers:a,terrain:d},v=>v!==void 0)}_updateLayer(i){this._updatedLayers[i.id]=!0,i.source&&!this._updatedSources[i.source]&&this.sourceCaches[i.source].getSource().type!=="raster"&&(this._updatedSources[i.source]="reload",this.sourceCaches[i.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(i){const a=w=>this._layers[w].type==="fill-extrusion",d={},p=[];for(let w=this._order.length-1;w>=0;w--){const S=this._order[w];if(a(S)){d[S]=w;for(const T of i){const z=T[S];if(z)for(const O of z)p.push(O)}}}p.sort((w,S)=>S.intersectionZ-w.intersectionZ);const v=[];for(let w=this._order.length-1;w>=0;w--){const S=this._order[w];if(a(S))for(let T=p.length-1;T>=0;T--){const z=p[T].feature;if(d[z.layer.id]<w)break;v.push(z),p.pop()}else for(const T of i){const z=T[S];if(z)for(const O of z)v.push(O.feature)}}return v}queryRenderedFeatures(i,a,d){a&&a.filter&&this._validate(c.x.filter,"queryRenderedFeatures.filter",a.filter,null,a);const p={};if(a&&a.layers){if(!Array.isArray(a.layers))return this.fire(new c.j(new Error("parameters.layers must be an Array."))),[];for(const S of a.layers){const T=this._layers[S];if(!T)return this.fire(new c.j(new Error(`The layer '${S}' does not exist in the map's style and cannot be queried for features.`))),[];p[T.source]=!0}}const v=[];a.availableImages=this._availableImages;const w=this._serializedAllLayers();for(const S in this.sourceCaches)a.layers&&!p[S]||v.push(Fr(this.sourceCaches[S],this._layers,w,i,a,d));return this.placement&&v.push(function(S,T,z,O,R,$,G){const K={},re=$.queryRenderedSymbols(O),J=[];for(const ue of Object.keys(re).map(Number))J.push(G[ue]);J.sort(lr);for(const ue of J){const ge=ue.featureIndex.lookupSymbolFeatures(re[ue.bucketInstanceId],T,ue.bucketIndex,ue.sourceLayerIndex,R.filter,R.layers,R.availableImages,S);for(const te in ge){const ve=K[te]=K[te]||[],Se=ge[te];Se.sort((Pe,Ne)=>{const Xe=ue.featureSortOrder;if(Xe){const ut=Xe.indexOf(Pe.featureIndex);return Xe.indexOf(Ne.featureIndex)-ut}return Ne.featureIndex-Pe.featureIndex});for(const Pe of Se)ve.push(Pe)}}for(const ue in K)K[ue].forEach(ge=>{const te=ge.feature,ve=z[S[ue].source].getFeatureState(te.layer["source-layer"],te.id);te.source=te.layer.source,te.layer["source-layer"]&&(te.sourceLayer=te.layer["source-layer"]),te.state=ve});return K}(this._layers,w,this.sourceCaches,i,a,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(v)}querySourceFeatures(i,a){a&&a.filter&&this._validate(c.x.filter,"querySourceFeatures.filter",a.filter,null,a);const d=this.sourceCaches[i];return d?function(p,v){const w=p.getRenderableIds().map(z=>p.getTileByID(z)),S=[],T={};for(let z=0;z<w.length;z++){const O=w[z],R=O.tileID.canonical.key;T[R]||(T[R]=!0,O.querySourceFeatures(S,v))}return S}(d,a):[]}getLight(){return this.light.getLight()}setLight(i,a={}){this._checkLoaded();const d=this.light.getLight();let p=!1;for(const w in i)if(!c.aE(i[w],d[w])){p=!0;break}if(!p)return;const v={now:C.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(i,a),this.light.updateTransitions(v)}_validate(i,a,d,p,v={}){return(!v||v.validate!==!1)&&qo(this,i.call(c.x,c.e({key:a,style:this.serialize(),value:d,styleSpec:c.v},p)))}_remove(i=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Gt().off(Lt,this._rtlPluginLoaded);for(const a in this._layers)this._layers[a].setEventedParent(null);for(const a in this.sourceCaches){const d=this.sourceCaches[a];d.setEventedParent(null),d.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),i&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(i)}_clearSource(i){this.sourceCaches[i].clearTiles()}_reloadSource(i){this.sourceCaches[i].resume(),this.sourceCaches[i].reload()}_updateSources(i){for(const a in this.sourceCaches)this.sourceCaches[a].update(i,this.map.terrain)}_generateCollisionBoxes(){for(const i in this.sourceCaches)this._reloadSource(i)}_updatePlacement(i,a,d,p,v=!1){let w=!1,S=!1;const T={};for(const z of this._order){const O=this._layers[z];if(O.type!=="symbol")continue;if(!T[O.source]){const $=this.sourceCaches[O.source];T[O.source]=$.getRenderableIds(!0).map(G=>$.getTileByID(G)).sort((G,K)=>K.tileID.overscaledZ-G.tileID.overscaledZ||(G.tileID.isLessThan(K.tileID)?-1:1))}const R=this.crossTileSymbolIndex.addLayer(O,T[O.source],i.center.lng);w=w||R}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((v=v||this._layerOrderChanged||d===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(C.now(),i.zoom))&&(this.pauseablePlacement=new xh(i,this.map.terrain,this._order,v,a,d,p,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,T),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(C.now()),S=!0),w&&this.pauseablePlacement.placement.setStale()),S||w)for(const z of this._order){const O=this._layers[z];O.type==="symbol"&&this.placement.updateLayerOpacities(O,T[O.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(C.now())}_releaseSymbolFadeTiles(){for(const i in this.sourceCaches)this.sourceCaches[i].releaseSymbolFadeTiles()}getImages(i,a){return c._(this,void 0,void 0,function*(){const d=yield this.imageManager.getImages(a.icons);this._updateTilesForChangedImages();const p=this.sourceCaches[a.source];return p&&p.setDependencies(a.tileID.key,a.type,a.icons),d})}getGlyphs(i,a){return c._(this,void 0,void 0,function*(){const d=yield this.glyphManager.getGlyphs(a.stacks),p=this.sourceCaches[a.source];return p&&p.setDependencies(a.tileID.key,a.type,[""]),d})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(i,a={}){this._checkLoaded(),i&&this._validate(c.x.glyphs,"glyphs",i,null,a)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=i,this.glyphManager.entries={},this.glyphManager.setURL(i))}addSprite(i,a,d={},p){this._checkLoaded();const v=[{id:i,url:a}],w=[...Le(this.stylesheet.sprite),...v];this._validate(c.x.sprite,"sprite",w,null,d)||(this.stylesheet.sprite=w,this._loadSprite(v,!0,p))}removeSprite(i){this._checkLoaded();const a=Le(this.stylesheet.sprite);if(a.find(d=>d.id===i)){if(this._spritesImagesIds[i])for(const d of this._spritesImagesIds[i])this.imageManager.removeImage(d),this._changedImages[d]=!0;a.splice(a.findIndex(d=>d.id===i),1),this.stylesheet.sprite=a.length>0?a:void 0,delete this._spritesImagesIds[i],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}else this.fire(new c.j(new Error(`Sprite "${i}" doesn't exists on this map.`)))}getSprite(){return Le(this.stylesheet.sprite)}setSprite(i,a={},d){this._checkLoaded(),i&&this._validate(c.x.sprite,"sprite",i,null,a)||(this.stylesheet.sprite=i,i?this._loadSprite(i,!0,d):(this._unloadSprite(),d&&d(null)))}}var Un=c.X([{name:"a_pos",type:"Int16",components:2}]),Sc="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const vs={prelude:ci(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:ci(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:ci(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:ci(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:ci("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:ci(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:ci(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:ci("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_anchor_pos;attribute vec2 a_placed;attribute vec2 a_box_real;uniform mat4 u_matrix;uniform vec2 u_pixel_extrude_scale;varying float v_placed;varying float v_notUsed;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:ci("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:ci("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:ci(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:ci(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:ci(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:ci(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:ci(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:ci(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:ci(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:ci(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:ci(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:ci(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:ci(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:ci(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:ci(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:ci(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_tex;varying float v_fade_opacity;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:ci(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_data0;varying vec3 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:ci(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec4 v_data0;varying vec4 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:ci("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",Sc),terrainDepth:ci("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",Sc),terrainCoords:ci("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",Sc)};function ci(_,i){const a=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,d=i.match(/attribute ([\w]+) ([\w]+)/g),p=_.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),v=i.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=v?v.concat(p):p,S={};return{fragmentSource:_=_.replace(a,(T,z,O,R,$)=>(S[$]=!0,z==="define"?`
#ifndef HAS_UNIFORM_u_${$}
varying ${O} ${R} ${$};
#else
uniform ${O} ${R} u_${$};
#endif
`:`
#ifdef HAS_UNIFORM_u_${$}
    ${O} ${R} ${$} = u_${$};
#endif
`)),vertexSource:i=i.replace(a,(T,z,O,R,$)=>{const G=R==="float"?"vec2":"vec4",K=$.match(/color/)?"color":G;return S[$]?z==="define"?`
#ifndef HAS_UNIFORM_u_${$}
uniform lowp float u_${$}_t;
attribute ${O} ${G} a_${$};
varying ${O} ${R} ${$};
#else
uniform ${O} ${R} u_${$};
#endif
`:K==="vec4"?`
#ifndef HAS_UNIFORM_u_${$}
    ${$} = a_${$};
#else
    ${O} ${R} ${$} = u_${$};
#endif
`:`
#ifndef HAS_UNIFORM_u_${$}
    ${$} = unpack_mix_${K}(a_${$}, u_${$}_t);
#else
    ${O} ${R} ${$} = u_${$};
#endif
`:z==="define"?`
#ifndef HAS_UNIFORM_u_${$}
uniform lowp float u_${$}_t;
attribute ${O} ${G} a_${$};
#else
uniform ${O} ${R} u_${$};
#endif
`:K==="vec4"?`
#ifndef HAS_UNIFORM_u_${$}
    ${O} ${R} ${$} = a_${$};
#else
    ${O} ${R} ${$} = u_${$};
#endif
`:`
#ifndef HAS_UNIFORM_u_${$}
    ${O} ${R} ${$} = unpack_mix_${K}(a_${$}, u_${$}_t);
#else
    ${O} ${R} ${$} = u_${$};
#endif
`}),staticAttributes:d,staticUniforms:w}}class rl{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(i,a,d,p,v,w,S,T,z){this.context=i;let O=this.boundPaintVertexBuffers.length!==p.length;for(let R=0;!O&&R<p.length;R++)this.boundPaintVertexBuffers[R]!==p[R]&&(O=!0);!this.vao||this.boundProgram!==a||this.boundLayoutVertexBuffer!==d||O||this.boundIndexBuffer!==v||this.boundVertexOffset!==w||this.boundDynamicVertexBuffer!==S||this.boundDynamicVertexBuffer2!==T||this.boundDynamicVertexBuffer3!==z?this.freshBind(a,d,p,v,w,S,T,z):(i.bindVertexArray.set(this.vao),S&&S.bind(),v&&v.dynamicDraw&&v.bind(),T&&T.bind(),z&&z.bind())}freshBind(i,a,d,p,v,w,S,T){const z=i.numAttributes,O=this.context,R=O.gl;this.vao&&this.destroy(),this.vao=O.createVertexArray(),O.bindVertexArray.set(this.vao),this.boundProgram=i,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=d,this.boundIndexBuffer=p,this.boundVertexOffset=v,this.boundDynamicVertexBuffer=w,this.boundDynamicVertexBuffer2=S,this.boundDynamicVertexBuffer3=T,a.enableAttributes(R,i);for(const $ of d)$.enableAttributes(R,i);w&&w.enableAttributes(R,i),S&&S.enableAttributes(R,i),T&&T.enableAttributes(R,i),a.bind(),a.setVertexAttribPointers(R,i,v);for(const $ of d)$.bind(),$.setVertexAttribPointers(R,i,v);w&&(w.bind(),w.setVertexAttribPointers(R,i,v)),p&&p.bind(),S&&(S.bind(),S.setVertexAttribPointers(R,i,v)),T&&(T.bind(),T.setVertexAttribPointers(R,i,v)),O.currentNumAttributes=z}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function xs(_){const i=[];for(let a=0;a<_.length;a++){if(_[a]===null)continue;const d=_[a].split(" ");i.push(d.pop())}return i}class Ic{constructor(i,a,d,p,v,w){const S=i.gl;this.program=S.createProgram();const T=xs(a.staticAttributes),z=d?d.getBinderAttributes():[],O=T.concat(z),R=vs.prelude.staticUniforms?xs(vs.prelude.staticUniforms):[],$=a.staticUniforms?xs(a.staticUniforms):[],G=d?d.getBinderUniforms():[],K=R.concat($).concat(G),re=[];for(const Pe of K)re.indexOf(Pe)<0&&re.push(Pe);const J=d?d.defines():[];v&&J.push("#define OVERDRAW_INSPECTOR;"),w&&J.push("#define TERRAIN3D;");const ue=J.concat(vs.prelude.fragmentSource,a.fragmentSource).join(`
`),ge=J.concat(vs.prelude.vertexSource,a.vertexSource).join(`
`),te=S.createShader(S.FRAGMENT_SHADER);if(S.isContextLost())return void(this.failedToCreate=!0);if(S.shaderSource(te,ue),S.compileShader(te),!S.getShaderParameter(te,S.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${S.getShaderInfoLog(te)}`);S.attachShader(this.program,te);const ve=S.createShader(S.VERTEX_SHADER);if(S.isContextLost())return void(this.failedToCreate=!0);if(S.shaderSource(ve,ge),S.compileShader(ve),!S.getShaderParameter(ve,S.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${S.getShaderInfoLog(ve)}`);S.attachShader(this.program,ve),this.attributes={};const Se={};this.numAttributes=O.length;for(let Pe=0;Pe<this.numAttributes;Pe++)O[Pe]&&(S.bindAttribLocation(this.program,Pe,O[Pe]),this.attributes[O[Pe]]=Pe);if(S.linkProgram(this.program),!S.getProgramParameter(this.program,S.LINK_STATUS))throw new Error(`Program failed to link: ${S.getProgramInfoLog(this.program)}`);S.deleteShader(ve),S.deleteShader(te);for(let Pe=0;Pe<re.length;Pe++){const Ne=re[Pe];if(Ne&&!Se[Ne]){const Xe=S.getUniformLocation(this.program,Ne);Xe&&(Se[Ne]=Xe)}}this.fixedUniforms=p(i,Se),this.terrainUniforms=((Pe,Ne)=>({u_depth:new c.aH(Pe,Ne.u_depth),u_terrain:new c.aH(Pe,Ne.u_terrain),u_terrain_dim:new c.aI(Pe,Ne.u_terrain_dim),u_terrain_matrix:new c.aJ(Pe,Ne.u_terrain_matrix),u_terrain_unpack:new c.aK(Pe,Ne.u_terrain_unpack),u_terrain_exaggeration:new c.aI(Pe,Ne.u_terrain_exaggeration)}))(i,Se),this.binderUniforms=d?d.getUniforms(i,Se):[]}draw(i,a,d,p,v,w,S,T,z,O,R,$,G,K,re,J,ue,ge){const te=i.gl;if(this.failedToCreate)return;if(i.program.set(this.program),i.setDepthMode(d),i.setStencilMode(p),i.setColorMode(v),i.setCullFace(w),T){i.activeTexture.set(te.TEXTURE2),te.bindTexture(te.TEXTURE_2D,T.depthTexture),i.activeTexture.set(te.TEXTURE3),te.bindTexture(te.TEXTURE_2D,T.texture);for(const Se in this.terrainUniforms)this.terrainUniforms[Se].set(T[Se])}for(const Se in this.fixedUniforms)this.fixedUniforms[Se].set(S[Se]);re&&re.setUniforms(i,this.binderUniforms,G,{zoom:K});let ve=0;switch(a){case te.LINES:ve=2;break;case te.TRIANGLES:ve=3;break;case te.LINE_STRIP:ve=1}for(const Se of $.get()){const Pe=Se.vaos||(Se.vaos={});(Pe[z]||(Pe[z]=new rl)).bind(i,this,O,re?re.getPaintVertexBuffers():[],R,Se.vertexOffset,J,ue,ge),te.drawElements(a,Se.primitiveLength*ve,te.UNSIGNED_SHORT,Se.primitiveOffset*ve*2)}}}function nl(_,i,a){const d=1/Rt(a,1,i.transform.tileZoom),p=Math.pow(2,a.tileID.overscaledZ),v=a.tileSize*Math.pow(2,i.transform.tileZoom)/p,w=v*(a.tileID.canonical.x+a.tileID.wrap*p),S=v*a.tileID.canonical.y;return{u_image:0,u_texsize:a.imageAtlasTexture.size,u_scale:[d,_.fromScale,_.toScale],u_fade:_.t,u_pixel_coord_upper:[w>>16,S>>16],u_pixel_coord_lower:[65535&w,65535&S]}}const fa=(_,i,a,d)=>{const p=i.style.light,v=p.properties.get("position"),w=[v.x,v.y,v.z],S=function(){var z=new c.A(9);return c.A!=Float32Array&&(z[1]=0,z[2]=0,z[3]=0,z[5]=0,z[6]=0,z[7]=0),z[0]=1,z[4]=1,z[8]=1,z}();p.properties.get("anchor")==="viewport"&&function(z,O){var R=Math.sin(O),$=Math.cos(O);z[0]=$,z[1]=R,z[2]=0,z[3]=-R,z[4]=$,z[5]=0,z[6]=0,z[7]=0,z[8]=1}(S,-i.transform.angle),function(z,O,R){var $=O[0],G=O[1],K=O[2];z[0]=$*R[0]+G*R[3]+K*R[6],z[1]=$*R[1]+G*R[4]+K*R[7],z[2]=$*R[2]+G*R[5]+K*R[8]}(w,w,S);const T=p.properties.get("color");return{u_matrix:_,u_lightpos:w,u_lightintensity:p.properties.get("intensity"),u_lightcolor:[T.r,T.g,T.b],u_vertical_gradient:+a,u_opacity:d}},Tc=(_,i,a,d,p,v,w)=>c.e(fa(_,i,a,d),nl(v,i,w),{u_height_factor:-Math.pow(2,p.overscaledZ)/w.tileSize/8}),ol=_=>({u_matrix:_}),pa=(_,i,a,d)=>c.e(ol(_),nl(a,i,d)),sl=(_,i)=>({u_matrix:_,u_world:i}),ma=(_,i,a,d,p)=>c.e(pa(_,i,a,d),{u_world:p}),Qf=(_,i,a,d)=>{const p=_.transform;let v,w;if(d.paint.get("circle-pitch-alignment")==="map"){const S=Rt(a,1,p.zoom);v=!0,w=[S,S]}else v=!1,w=p.pixelsToGLUnits;return{u_camera_to_center_distance:p.cameraToCenterDistance,u_scale_with_map:+(d.paint.get("circle-pitch-scale")==="map"),u_matrix:_.translatePosMatrix(i.posMatrix,a,d.paint.get("circle-translate"),d.paint.get("circle-translate-anchor")),u_pitch_with_map:+v,u_device_pixel_ratio:_.pixelRatio,u_extrude_scale:w}},ep=(_,i,a)=>({u_matrix:_,u_inv_matrix:i,u_camera_to_center_distance:a.cameraToCenterDistance,u_viewport_size:[a.width,a.height]}),Cc=(_,i,a=1)=>({u_matrix:_,u_color:i,u_overlay:0,u_overlay_scale:a}),bh=_=>({u_matrix:_}),Ho=(_,i,a,d)=>({u_matrix:_,u_extrude_scale:Rt(i,1,a),u_intensity:d});function al(_,i){const a=Math.pow(2,i.canonical.z),d=i.canonical.y;return[new c.Y(0,d/a).toLngLat().lat,new c.Y(0,(d+1)/a).toLngLat().lat]}const Vr=(_,i,a,d)=>{const p=_.transform;return{u_matrix:Mc(_,i,a,d),u_ratio:1/Rt(i,1,p.zoom),u_device_pixel_ratio:_.pixelRatio,u_units_to_pixels:[1/p.pixelsToGLUnits[0],1/p.pixelsToGLUnits[1]]}},hn=(_,i,a,d,p)=>c.e(Vr(_,i,a,p),{u_image:0,u_image_height:d}),Ac=(_,i,a,d,p)=>{const v=_.transform,w=kc(i,v);return{u_matrix:Mc(_,i,a,p),u_texsize:i.imageAtlasTexture.size,u_ratio:1/Rt(i,1,v.zoom),u_device_pixel_ratio:_.pixelRatio,u_image:0,u_scale:[w,d.fromScale,d.toScale],u_fade:d.t,u_units_to_pixels:[1/v.pixelsToGLUnits[0],1/v.pixelsToGLUnits[1]]}},ll=(_,i,a,d,p,v)=>{const w=_.lineAtlas,S=kc(i,_.transform),T=a.layout.get("line-cap")==="round",z=w.getDash(d.from,T),O=w.getDash(d.to,T),R=z.width*p.fromScale,$=O.width*p.toScale;return c.e(Vr(_,i,a,v),{u_patternscale_a:[S/R,-z.height/2],u_patternscale_b:[S/$,-O.height/2],u_sdfgamma:w.width/(256*Math.min(R,$)*_.pixelRatio)/2,u_image:0,u_tex_y_a:z.y,u_tex_y_b:O.y,u_mix:p.t})};function kc(_,i){return 1/Rt(_,1,i.tileZoom)}function Mc(_,i,a,d){return _.translatePosMatrix(d?d.posMatrix:i.tileID.posMatrix,i,a.paint.get("line-translate"),a.paint.get("line-translate-anchor"))}const bs=(_,i,a,d,p)=>{return{u_matrix:_,u_tl_parent:i,u_scale_parent:a,u_buffer_scale:1,u_fade_t:d.mix,u_opacity:d.opacity*p.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:p.paint.get("raster-brightness-min"),u_brightness_high:p.paint.get("raster-brightness-max"),u_saturation_factor:(w=p.paint.get("raster-saturation"),w>0?1-1/(1.001-w):-w),u_contrast_factor:(v=p.paint.get("raster-contrast"),v>0?1/(1-v):1+v),u_spin_weights:tp(p.paint.get("raster-hue-rotate"))};var v,w};function tp(_){_*=Math.PI/180;const i=Math.sin(_),a=Math.cos(_);return[(2*a+1)/3,(-Math.sqrt(3)*i-a+1)/3,(Math.sqrt(3)*i-a+1)/3]}const wh=(_,i,a,d,p,v,w,S,T,z,O,R,$,G)=>{const K=w.transform;return{u_is_size_zoom_constant:+(_==="constant"||_==="source"),u_is_size_feature_constant:+(_==="constant"||_==="camera"),u_size_t:i?i.uSizeT:0,u_size:i?i.uSize:0,u_camera_to_center_distance:K.cameraToCenterDistance,u_pitch:K.pitch/360*2*Math.PI,u_rotate_symbol:+a,u_aspect_ratio:K.width/K.height,u_fade_change:w.options.fadeDuration?w.symbolFadeChange:1,u_matrix:S,u_label_plane_matrix:T,u_coord_matrix:z,u_is_text:+R,u_pitch_with_map:+d,u_is_along_line:p,u_is_variable_anchor:v,u_texsize:$,u_texture:0,u_translation:O,u_pitched_scale:G}},Eh=(_,i,a,d,p,v,w,S,T,z,O,R,$,G,K)=>{const re=w.transform;return c.e(wh(_,i,a,d,p,v,w,S,T,z,O,R,$,K),{u_gamma_scale:d?Math.cos(re._pitch)*re.cameraToCenterDistance:1,u_device_pixel_ratio:w.pixelRatio,u_is_halo:+G})},ip=(_,i,a,d,p,v,w,S,T,z,O,R,$,G)=>c.e(Eh(_,i,a,d,p,v,w,S,T,z,O,!0,R,!0,G),{u_texsize_icon:$,u_texture_icon:1}),rp=(_,i,a)=>({u_matrix:_,u_opacity:i,u_color:a}),np=(_,i,a,d,p,v)=>c.e(function(w,S,T,z){const O=T.imageManager.getPattern(w.from.toString()),R=T.imageManager.getPattern(w.to.toString()),{width:$,height:G}=T.imageManager.getPixelSize(),K=Math.pow(2,z.tileID.overscaledZ),re=z.tileSize*Math.pow(2,T.transform.tileZoom)/K,J=re*(z.tileID.canonical.x+z.tileID.wrap*K),ue=re*z.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:O.tl,u_pattern_br_a:O.br,u_pattern_tl_b:R.tl,u_pattern_br_b:R.br,u_texsize:[$,G],u_mix:S.t,u_pattern_size_a:O.displaySize,u_pattern_size_b:R.displaySize,u_scale_a:S.fromScale,u_scale_b:S.toScale,u_tile_units_to_pixels:1/Rt(z,1,T.transform.tileZoom),u_pixel_coord_upper:[J>>16,ue>>16],u_pixel_coord_lower:[65535&J,65535&ue]}}(d,v,a,p),{u_matrix:_,u_opacity:i}),cl={fillExtrusion:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix),u_lightpos:new c.aL(_,i.u_lightpos),u_lightintensity:new c.aI(_,i.u_lightintensity),u_lightcolor:new c.aL(_,i.u_lightcolor),u_vertical_gradient:new c.aI(_,i.u_vertical_gradient),u_opacity:new c.aI(_,i.u_opacity)}),fillExtrusionPattern:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix),u_lightpos:new c.aL(_,i.u_lightpos),u_lightintensity:new c.aI(_,i.u_lightintensity),u_lightcolor:new c.aL(_,i.u_lightcolor),u_vertical_gradient:new c.aI(_,i.u_vertical_gradient),u_height_factor:new c.aI(_,i.u_height_factor),u_image:new c.aH(_,i.u_image),u_texsize:new c.aM(_,i.u_texsize),u_pixel_coord_upper:new c.aM(_,i.u_pixel_coord_upper),u_pixel_coord_lower:new c.aM(_,i.u_pixel_coord_lower),u_scale:new c.aL(_,i.u_scale),u_fade:new c.aI(_,i.u_fade),u_opacity:new c.aI(_,i.u_opacity)}),fill:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix)}),fillPattern:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix),u_image:new c.aH(_,i.u_image),u_texsize:new c.aM(_,i.u_texsize),u_pixel_coord_upper:new c.aM(_,i.u_pixel_coord_upper),u_pixel_coord_lower:new c.aM(_,i.u_pixel_coord_lower),u_scale:new c.aL(_,i.u_scale),u_fade:new c.aI(_,i.u_fade)}),fillOutline:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix),u_world:new c.aM(_,i.u_world)}),fillOutlinePattern:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix),u_world:new c.aM(_,i.u_world),u_image:new c.aH(_,i.u_image),u_texsize:new c.aM(_,i.u_texsize),u_pixel_coord_upper:new c.aM(_,i.u_pixel_coord_upper),u_pixel_coord_lower:new c.aM(_,i.u_pixel_coord_lower),u_scale:new c.aL(_,i.u_scale),u_fade:new c.aI(_,i.u_fade)}),circle:(_,i)=>({u_camera_to_center_distance:new c.aI(_,i.u_camera_to_center_distance),u_scale_with_map:new c.aH(_,i.u_scale_with_map),u_pitch_with_map:new c.aH(_,i.u_pitch_with_map),u_extrude_scale:new c.aM(_,i.u_extrude_scale),u_device_pixel_ratio:new c.aI(_,i.u_device_pixel_ratio),u_matrix:new c.aJ(_,i.u_matrix)}),collisionBox:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix),u_pixel_extrude_scale:new c.aM(_,i.u_pixel_extrude_scale)}),collisionCircle:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix),u_inv_matrix:new c.aJ(_,i.u_inv_matrix),u_camera_to_center_distance:new c.aI(_,i.u_camera_to_center_distance),u_viewport_size:new c.aM(_,i.u_viewport_size)}),debug:(_,i)=>({u_color:new c.aN(_,i.u_color),u_matrix:new c.aJ(_,i.u_matrix),u_overlay:new c.aH(_,i.u_overlay),u_overlay_scale:new c.aI(_,i.u_overlay_scale)}),clippingMask:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix)}),heatmap:(_,i)=>({u_extrude_scale:new c.aI(_,i.u_extrude_scale),u_intensity:new c.aI(_,i.u_intensity),u_matrix:new c.aJ(_,i.u_matrix)}),heatmapTexture:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix),u_world:new c.aM(_,i.u_world),u_image:new c.aH(_,i.u_image),u_color_ramp:new c.aH(_,i.u_color_ramp),u_opacity:new c.aI(_,i.u_opacity)}),hillshade:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix),u_image:new c.aH(_,i.u_image),u_latrange:new c.aM(_,i.u_latrange),u_light:new c.aM(_,i.u_light),u_shadow:new c.aN(_,i.u_shadow),u_highlight:new c.aN(_,i.u_highlight),u_accent:new c.aN(_,i.u_accent)}),hillshadePrepare:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix),u_image:new c.aH(_,i.u_image),u_dimension:new c.aM(_,i.u_dimension),u_zoom:new c.aI(_,i.u_zoom),u_unpack:new c.aK(_,i.u_unpack)}),line:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix),u_ratio:new c.aI(_,i.u_ratio),u_device_pixel_ratio:new c.aI(_,i.u_device_pixel_ratio),u_units_to_pixels:new c.aM(_,i.u_units_to_pixels)}),lineGradient:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix),u_ratio:new c.aI(_,i.u_ratio),u_device_pixel_ratio:new c.aI(_,i.u_device_pixel_ratio),u_units_to_pixels:new c.aM(_,i.u_units_to_pixels),u_image:new c.aH(_,i.u_image),u_image_height:new c.aI(_,i.u_image_height)}),linePattern:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix),u_texsize:new c.aM(_,i.u_texsize),u_ratio:new c.aI(_,i.u_ratio),u_device_pixel_ratio:new c.aI(_,i.u_device_pixel_ratio),u_image:new c.aH(_,i.u_image),u_units_to_pixels:new c.aM(_,i.u_units_to_pixels),u_scale:new c.aL(_,i.u_scale),u_fade:new c.aI(_,i.u_fade)}),lineSDF:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix),u_ratio:new c.aI(_,i.u_ratio),u_device_pixel_ratio:new c.aI(_,i.u_device_pixel_ratio),u_units_to_pixels:new c.aM(_,i.u_units_to_pixels),u_patternscale_a:new c.aM(_,i.u_patternscale_a),u_patternscale_b:new c.aM(_,i.u_patternscale_b),u_sdfgamma:new c.aI(_,i.u_sdfgamma),u_image:new c.aH(_,i.u_image),u_tex_y_a:new c.aI(_,i.u_tex_y_a),u_tex_y_b:new c.aI(_,i.u_tex_y_b),u_mix:new c.aI(_,i.u_mix)}),raster:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix),u_tl_parent:new c.aM(_,i.u_tl_parent),u_scale_parent:new c.aI(_,i.u_scale_parent),u_buffer_scale:new c.aI(_,i.u_buffer_scale),u_fade_t:new c.aI(_,i.u_fade_t),u_opacity:new c.aI(_,i.u_opacity),u_image0:new c.aH(_,i.u_image0),u_image1:new c.aH(_,i.u_image1),u_brightness_low:new c.aI(_,i.u_brightness_low),u_brightness_high:new c.aI(_,i.u_brightness_high),u_saturation_factor:new c.aI(_,i.u_saturation_factor),u_contrast_factor:new c.aI(_,i.u_contrast_factor),u_spin_weights:new c.aL(_,i.u_spin_weights)}),symbolIcon:(_,i)=>({u_is_size_zoom_constant:new c.aH(_,i.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aH(_,i.u_is_size_feature_constant),u_size_t:new c.aI(_,i.u_size_t),u_size:new c.aI(_,i.u_size),u_camera_to_center_distance:new c.aI(_,i.u_camera_to_center_distance),u_pitch:new c.aI(_,i.u_pitch),u_rotate_symbol:new c.aH(_,i.u_rotate_symbol),u_aspect_ratio:new c.aI(_,i.u_aspect_ratio),u_fade_change:new c.aI(_,i.u_fade_change),u_matrix:new c.aJ(_,i.u_matrix),u_label_plane_matrix:new c.aJ(_,i.u_label_plane_matrix),u_coord_matrix:new c.aJ(_,i.u_coord_matrix),u_is_text:new c.aH(_,i.u_is_text),u_pitch_with_map:new c.aH(_,i.u_pitch_with_map),u_is_along_line:new c.aH(_,i.u_is_along_line),u_is_variable_anchor:new c.aH(_,i.u_is_variable_anchor),u_texsize:new c.aM(_,i.u_texsize),u_texture:new c.aH(_,i.u_texture),u_translation:new c.aM(_,i.u_translation),u_pitched_scale:new c.aI(_,i.u_pitched_scale)}),symbolSDF:(_,i)=>({u_is_size_zoom_constant:new c.aH(_,i.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aH(_,i.u_is_size_feature_constant),u_size_t:new c.aI(_,i.u_size_t),u_size:new c.aI(_,i.u_size),u_camera_to_center_distance:new c.aI(_,i.u_camera_to_center_distance),u_pitch:new c.aI(_,i.u_pitch),u_rotate_symbol:new c.aH(_,i.u_rotate_symbol),u_aspect_ratio:new c.aI(_,i.u_aspect_ratio),u_fade_change:new c.aI(_,i.u_fade_change),u_matrix:new c.aJ(_,i.u_matrix),u_label_plane_matrix:new c.aJ(_,i.u_label_plane_matrix),u_coord_matrix:new c.aJ(_,i.u_coord_matrix),u_is_text:new c.aH(_,i.u_is_text),u_pitch_with_map:new c.aH(_,i.u_pitch_with_map),u_is_along_line:new c.aH(_,i.u_is_along_line),u_is_variable_anchor:new c.aH(_,i.u_is_variable_anchor),u_texsize:new c.aM(_,i.u_texsize),u_texture:new c.aH(_,i.u_texture),u_gamma_scale:new c.aI(_,i.u_gamma_scale),u_device_pixel_ratio:new c.aI(_,i.u_device_pixel_ratio),u_is_halo:new c.aH(_,i.u_is_halo),u_translation:new c.aM(_,i.u_translation),u_pitched_scale:new c.aI(_,i.u_pitched_scale)}),symbolTextAndIcon:(_,i)=>({u_is_size_zoom_constant:new c.aH(_,i.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aH(_,i.u_is_size_feature_constant),u_size_t:new c.aI(_,i.u_size_t),u_size:new c.aI(_,i.u_size),u_camera_to_center_distance:new c.aI(_,i.u_camera_to_center_distance),u_pitch:new c.aI(_,i.u_pitch),u_rotate_symbol:new c.aH(_,i.u_rotate_symbol),u_aspect_ratio:new c.aI(_,i.u_aspect_ratio),u_fade_change:new c.aI(_,i.u_fade_change),u_matrix:new c.aJ(_,i.u_matrix),u_label_plane_matrix:new c.aJ(_,i.u_label_plane_matrix),u_coord_matrix:new c.aJ(_,i.u_coord_matrix),u_is_text:new c.aH(_,i.u_is_text),u_pitch_with_map:new c.aH(_,i.u_pitch_with_map),u_is_along_line:new c.aH(_,i.u_is_along_line),u_is_variable_anchor:new c.aH(_,i.u_is_variable_anchor),u_texsize:new c.aM(_,i.u_texsize),u_texsize_icon:new c.aM(_,i.u_texsize_icon),u_texture:new c.aH(_,i.u_texture),u_texture_icon:new c.aH(_,i.u_texture_icon),u_gamma_scale:new c.aI(_,i.u_gamma_scale),u_device_pixel_ratio:new c.aI(_,i.u_device_pixel_ratio),u_is_halo:new c.aH(_,i.u_is_halo),u_translation:new c.aM(_,i.u_translation),u_pitched_scale:new c.aI(_,i.u_pitched_scale)}),background:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix),u_opacity:new c.aI(_,i.u_opacity),u_color:new c.aN(_,i.u_color)}),backgroundPattern:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix),u_opacity:new c.aI(_,i.u_opacity),u_image:new c.aH(_,i.u_image),u_pattern_tl_a:new c.aM(_,i.u_pattern_tl_a),u_pattern_br_a:new c.aM(_,i.u_pattern_br_a),u_pattern_tl_b:new c.aM(_,i.u_pattern_tl_b),u_pattern_br_b:new c.aM(_,i.u_pattern_br_b),u_texsize:new c.aM(_,i.u_texsize),u_mix:new c.aI(_,i.u_mix),u_pattern_size_a:new c.aM(_,i.u_pattern_size_a),u_pattern_size_b:new c.aM(_,i.u_pattern_size_b),u_scale_a:new c.aI(_,i.u_scale_a),u_scale_b:new c.aI(_,i.u_scale_b),u_pixel_coord_upper:new c.aM(_,i.u_pixel_coord_upper),u_pixel_coord_lower:new c.aM(_,i.u_pixel_coord_lower),u_tile_units_to_pixels:new c.aI(_,i.u_tile_units_to_pixels)}),terrain:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix),u_texture:new c.aH(_,i.u_texture),u_ele_delta:new c.aI(_,i.u_ele_delta)}),terrainDepth:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix),u_ele_delta:new c.aI(_,i.u_ele_delta)}),terrainCoords:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix),u_texture:new c.aH(_,i.u_texture),u_terrain_coords_id:new c.aI(_,i.u_terrain_coords_id),u_ele_delta:new c.aI(_,i.u_ele_delta)})};class Lc{constructor(i,a,d){this.context=i;const p=i.gl;this.buffer=p.createBuffer(),this.dynamicDraw=!!d,this.context.unbindVAO(),i.bindElementBuffer.set(this.buffer),p.bufferData(p.ELEMENT_ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?p.DYNAMIC_DRAW:p.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(i){const a=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,i.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const ul={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Pc{constructor(i,a,d,p){this.length=a.length,this.attributes=d,this.itemSize=a.bytesPerElement,this.dynamicDraw=p,this.context=i;const v=i.gl;this.buffer=v.createBuffer(),i.bindVertexBuffer.set(this.buffer),v.bufferData(v.ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(i){if(i.length!==this.length)throw new Error(`Length of new data is ${i.length}, which doesn't match current length of ${this.length}`);const a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,i.arrayBuffer)}enableAttributes(i,a){for(let d=0;d<this.attributes.length;d++){const p=a.attributes[this.attributes[d].name];p!==void 0&&i.enableVertexAttribArray(p)}}setVertexAttribPointers(i,a,d){for(let p=0;p<this.attributes.length;p++){const v=this.attributes[p],w=a.attributes[v.name];w!==void 0&&i.vertexAttribPointer(w,v.components,i[ul[v.type]],!1,this.itemSize,v.offset+this.itemSize*(d||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const ga=new WeakMap;function dn(_){var i;if(ga.has(_))return ga.get(_);{const a=(i=_.getParameter(_.VERSION))===null||i===void 0?void 0:i.startsWith("WebGL 2.0");return ga.set(_,a),a}}class ui{constructor(i){this.gl=i.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(i){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class zc extends ui{getDefault(){return c.aP.transparent}set(i){const a=this.current;(i.r!==a.r||i.g!==a.g||i.b!==a.b||i.a!==a.a||this.dirty)&&(this.gl.clearColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class ya extends ui{getDefault(){return 1}set(i){(i!==this.current||this.dirty)&&(this.gl.clearDepth(i),this.current=i,this.dirty=!1)}}class _a extends ui{getDefault(){return 0}set(i){(i!==this.current||this.dirty)&&(this.gl.clearStencil(i),this.current=i,this.dirty=!1)}}class op extends ui{getDefault(){return[!0,!0,!0,!0]}set(i){const a=this.current;(i[0]!==a[0]||i[1]!==a[1]||i[2]!==a[2]||i[3]!==a[3]||this.dirty)&&(this.gl.colorMask(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class hl extends ui{getDefault(){return!0}set(i){(i!==this.current||this.dirty)&&(this.gl.depthMask(i),this.current=i,this.dirty=!1)}}class sp extends ui{getDefault(){return 255}set(i){(i!==this.current||this.dirty)&&(this.gl.stencilMask(i),this.current=i,this.dirty=!1)}}class ws extends ui{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(i){const a=this.current;(i.func!==a.func||i.ref!==a.ref||i.mask!==a.mask||this.dirty)&&(this.gl.stencilFunc(i.func,i.ref,i.mask),this.current=i,this.dirty=!1)}}class ap extends ui{getDefault(){const i=this.gl;return[i.KEEP,i.KEEP,i.KEEP]}set(i){const a=this.current;(i[0]!==a[0]||i[1]!==a[1]||i[2]!==a[2]||this.dirty)&&(this.gl.stencilOp(i[0],i[1],i[2]),this.current=i,this.dirty=!1)}}class Sh extends ui{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const a=this.gl;i?a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST),this.current=i,this.dirty=!1}}class lp extends ui{getDefault(){return[0,1]}set(i){const a=this.current;(i[0]!==a[0]||i[1]!==a[1]||this.dirty)&&(this.gl.depthRange(i[0],i[1]),this.current=i,this.dirty=!1)}}class Ih extends ui{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const a=this.gl;i?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST),this.current=i,this.dirty=!1}}class Dc extends ui{getDefault(){return this.gl.LESS}set(i){(i!==this.current||this.dirty)&&(this.gl.depthFunc(i),this.current=i,this.dirty=!1)}}class Th extends ui{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const a=this.gl;i?a.enable(a.BLEND):a.disable(a.BLEND),this.current=i,this.dirty=!1}}class Ch extends ui{getDefault(){const i=this.gl;return[i.ONE,i.ZERO]}set(i){const a=this.current;(i[0]!==a[0]||i[1]!==a[1]||this.dirty)&&(this.gl.blendFunc(i[0],i[1]),this.current=i,this.dirty=!1)}}class Ah extends ui{getDefault(){return c.aP.transparent}set(i){const a=this.current;(i.r!==a.r||i.g!==a.g||i.b!==a.b||i.a!==a.a||this.dirty)&&(this.gl.blendColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class kh extends ui{getDefault(){return this.gl.FUNC_ADD}set(i){(i!==this.current||this.dirty)&&(this.gl.blendEquation(i),this.current=i,this.dirty=!1)}}class Go extends ui{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const a=this.gl;i?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE),this.current=i,this.dirty=!1}}class Mh extends ui{getDefault(){return this.gl.BACK}set(i){(i!==this.current||this.dirty)&&(this.gl.cullFace(i),this.current=i,this.dirty=!1)}}class cp extends ui{getDefault(){return this.gl.CCW}set(i){(i!==this.current||this.dirty)&&(this.gl.frontFace(i),this.current=i,this.dirty=!1)}}class up extends ui{getDefault(){return null}set(i){(i!==this.current||this.dirty)&&(this.gl.useProgram(i),this.current=i,this.dirty=!1)}}class Lh extends ui{getDefault(){return this.gl.TEXTURE0}set(i){(i!==this.current||this.dirty)&&(this.gl.activeTexture(i),this.current=i,this.dirty=!1)}}class va extends ui{getDefault(){const i=this.gl;return[0,0,i.drawingBufferWidth,i.drawingBufferHeight]}set(i){const a=this.current;(i[0]!==a[0]||i[1]!==a[1]||i[2]!==a[2]||i[3]!==a[3]||this.dirty)&&(this.gl.viewport(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class hp extends ui{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,i),this.current=i,this.dirty=!1}}class dl extends ui{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const a=this.gl;a.bindRenderbuffer(a.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class dp extends ui{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const a=this.gl;a.bindTexture(a.TEXTURE_2D,i),this.current=i,this.dirty=!1}}class fp extends ui{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const a=this.gl;a.bindBuffer(a.ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class Ph extends ui{getDefault(){return null}set(i){const a=this.gl;a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class zh extends ui{getDefault(){return null}set(i){var a;if(i===this.current&&!this.dirty)return;const d=this.gl;dn(d)?d.bindVertexArray(i):(a=d.getExtension("OES_vertex_array_object"))===null||a===void 0||a.bindVertexArrayOES(i),this.current=i,this.dirty=!1}}class Dh extends ui{getDefault(){return 4}set(i){if(i===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_ALIGNMENT,i),this.current=i,this.dirty=!1}}class Rc extends ui{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i),this.current=i,this.dirty=!1}}class Rh extends ui{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,i),this.current=i,this.dirty=!1}}class Es extends ui{constructor(i,a){super(i),this.context=i,this.parent=a}getDefault(){return null}}class oo extends Es{setDirty(){this.dirty=!0}set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,i,0),this.current=i,this.dirty=!1}}class Oc extends Es{set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class Bc extends Es{set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class Fc{constructor(i,a,d,p,v){this.context=i,this.width=a,this.height=d;const w=i.gl,S=this.framebuffer=w.createFramebuffer();if(this.colorAttachment=new oo(i,S),p)this.depthAttachment=v?new Bc(i,S):new Oc(i,S);else if(v)throw new Error("Stencil cannot be set without depth");if(w.checkFramebufferStatus(w.FRAMEBUFFER)!==w.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const i=this.context.gl,a=this.colorAttachment.get();if(a&&i.deleteTexture(a),this.depthAttachment){const d=this.depthAttachment.get();d&&i.deleteRenderbuffer(d)}i.deleteFramebuffer(this.framebuffer)}}class Ki{constructor(i,a,d){this.blendFunction=i,this.blendColor=a,this.mask=d}}Ki.Replace=[1,0],Ki.disabled=new Ki(Ki.Replace,c.aP.transparent,[!1,!1,!1,!1]),Ki.unblended=new Ki(Ki.Replace,c.aP.transparent,[!0,!0,!0,!0]),Ki.alphaBlended=new Ki([1,771],c.aP.transparent,[!0,!0,!0,!0]);class Vc{constructor(i){var a,d;if(this.gl=i,this.clearColor=new zc(this),this.clearDepth=new ya(this),this.clearStencil=new _a(this),this.colorMask=new op(this),this.depthMask=new hl(this),this.stencilMask=new sp(this),this.stencilFunc=new ws(this),this.stencilOp=new ap(this),this.stencilTest=new Sh(this),this.depthRange=new lp(this),this.depthTest=new Ih(this),this.depthFunc=new Dc(this),this.blend=new Th(this),this.blendFunc=new Ch(this),this.blendColor=new Ah(this),this.blendEquation=new kh(this),this.cullFace=new Go(this),this.cullFaceSide=new Mh(this),this.frontFace=new cp(this),this.program=new up(this),this.activeTexture=new Lh(this),this.viewport=new va(this),this.bindFramebuffer=new hp(this),this.bindRenderbuffer=new dl(this),this.bindTexture=new dp(this),this.bindVertexBuffer=new fp(this),this.bindElementBuffer=new Ph(this),this.bindVertexArray=new zh(this),this.pixelStoreUnpack=new Dh(this),this.pixelStoreUnpackPremultiplyAlpha=new Rc(this),this.pixelStoreUnpackFlipY=new Rh(this),this.extTextureFilterAnisotropic=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=i.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE),dn(i)){this.HALF_FLOAT=i.HALF_FLOAT;const p=i.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(a=i.RGBA16F)!==null&&a!==void 0?a:p==null?void 0:p.RGBA16F_EXT,this.RGB16F=(d=i.RGB16F)!==null&&d!==void 0?d:p==null?void 0:p.RGB16F_EXT,i.getExtension("EXT_color_buffer_float")}else{i.getExtension("EXT_color_buffer_half_float"),i.getExtension("OES_texture_half_float_linear");const p=i.getExtension("OES_texture_half_float");this.HALF_FLOAT=p==null?void 0:p.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(i,a){return new Lc(this,i,a)}createVertexBuffer(i,a,d){return new Pc(this,i,a,d)}createRenderbuffer(i,a,d){const p=this.gl,v=p.createRenderbuffer();return this.bindRenderbuffer.set(v),p.renderbufferStorage(p.RENDERBUFFER,i,a,d),this.bindRenderbuffer.set(null),v}createFramebuffer(i,a,d,p){return new Fc(this,i,a,d,p)}clear({color:i,depth:a,stencil:d}){const p=this.gl;let v=0;i&&(v|=p.COLOR_BUFFER_BIT,this.clearColor.set(i),this.colorMask.set([!0,!0,!0,!0])),a!==void 0&&(v|=p.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(a),this.depthMask.set(!0)),d!==void 0&&(v|=p.STENCIL_BUFFER_BIT,this.clearStencil.set(d),this.stencilMask.set(255)),p.clear(v)}setCullFace(i){i.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(i.mode),this.frontFace.set(i.frontFace))}setDepthMode(i){i.func!==this.gl.ALWAYS||i.mask?(this.depthTest.set(!0),this.depthFunc.set(i.func),this.depthMask.set(i.mask),this.depthRange.set(i.range)):this.depthTest.set(!1)}setStencilMode(i){i.test.func!==this.gl.ALWAYS||i.mask?(this.stencilTest.set(!0),this.stencilMask.set(i.mask),this.stencilOp.set([i.fail,i.depthFail,i.pass]),this.stencilFunc.set({func:i.test.func,ref:i.ref,mask:i.test.mask})):this.stencilTest.set(!1)}setColorMode(i){c.aE(i.blendFunction,Ki.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(i.blendFunction),this.blendColor.set(i.blendColor)),this.colorMask.set(i.mask)}createVertexArray(){var i;return dn(this.gl)?this.gl.createVertexArray():(i=this.gl.getExtension("OES_vertex_array_object"))===null||i===void 0?void 0:i.createVertexArrayOES()}deleteVertexArray(i){var a;return dn(this.gl)?this.gl.deleteVertexArray(i):(a=this.gl.getExtension("OES_vertex_array_object"))===null||a===void 0?void 0:a.deleteVertexArrayOES(i)}unbindVAO(){this.bindVertexArray.set(null)}}class Kt{constructor(i,a,d){this.func=i,this.mask=a,this.range=d}}Kt.ReadOnly=!1,Kt.ReadWrite=!0,Kt.disabled=new Kt(519,Kt.ReadOnly,[0,1]);const xa=7680;class Vi{constructor(i,a,d,p,v,w){this.test=i,this.ref=a,this.mask=d,this.fail=p,this.depthFail=v,this.pass=w}}Vi.disabled=new Vi({func:519,mask:0},0,0,xa,xa,xa);class zi{constructor(i,a,d){this.enable=i,this.mode=a,this.frontFace=d}}let fl;function Oh(_,i,a,d,p){const v=_.context,w=v.gl,S=_.useProgram("collisionBox"),T=[];let z=0,O=0;for(let ue=0;ue<d.length;ue++){const ge=d[ue],te=i.getTile(ge).getBucket(a);if(!te)continue;const ve=p?te.textCollisionBox:te.iconCollisionBox,Se=te.collisionCircleArray;if(Se.length>0){const Pe=c.F();c.aQ(Pe,te.placementInvProjMatrix,_.transform.glCoordMatrix),c.aQ(Pe,Pe,te.placementViewportMatrix),T.push({circleArray:Se,circleOffset:O,transform:ge.posMatrix,invTransform:Pe,coord:ge}),z+=Se.length/4,O=z}ve&&S.draw(v,w.LINES,Kt.disabled,Vi.disabled,_.colorModeForRenderPass(),zi.disabled,{u_matrix:ge.posMatrix,u_pixel_extrude_scale:[1/(R=_.transform).width,1/R.height]},_.style.map.terrain&&_.style.map.terrain.getTerrainData(ge),a.id,ve.layoutVertexBuffer,ve.indexBuffer,ve.segments,null,_.transform.zoom,null,null,ve.collisionVertexBuffer)}var R;if(!p||!T.length)return;const $=_.useProgram("collisionCircle"),G=new c.aR;G.resize(4*z),G._trim();let K=0;for(const ue of T)for(let ge=0;ge<ue.circleArray.length/4;ge++){const te=4*ge,ve=ue.circleArray[te+0],Se=ue.circleArray[te+1],Pe=ue.circleArray[te+2],Ne=ue.circleArray[te+3];G.emplace(K++,ve,Se,Pe,Ne,0),G.emplace(K++,ve,Se,Pe,Ne,1),G.emplace(K++,ve,Se,Pe,Ne,2),G.emplace(K++,ve,Se,Pe,Ne,3)}(!fl||fl.length<2*z)&&(fl=function(ue){const ge=2*ue,te=new c.aT;te.resize(ge),te._trim();for(let ve=0;ve<ge;ve++){const Se=6*ve;te.uint16[Se+0]=4*ve+0,te.uint16[Se+1]=4*ve+1,te.uint16[Se+2]=4*ve+2,te.uint16[Se+3]=4*ve+2,te.uint16[Se+4]=4*ve+3,te.uint16[Se+5]=4*ve+0}return te}(z));const re=v.createIndexBuffer(fl,!0),J=v.createVertexBuffer(G,c.aS.members,!0);for(const ue of T){const ge=ep(ue.transform,ue.invTransform,_.transform);$.draw(v,w.TRIANGLES,Kt.disabled,Vi.disabled,_.colorModeForRenderPass(),zi.disabled,ge,_.style.map.terrain&&_.style.map.terrain.getTerrainData(ue.coord),a.id,J,re,c.$.simpleSegment(0,2*ue.circleOffset,ue.circleArray.length,ue.circleArray.length/2),null,_.transform.zoom,null,null,null)}J.destroy(),re.destroy()}zi.disabled=new zi(!1,1029,2305),zi.backCCW=new zi(!0,1029,2305);const Nc=c.an(new Float32Array(16));function pp(_,i,a,d,p,v){const{horizontalAlign:w,verticalAlign:S}=c.au(_);return new c.P((-(w-.5)*i/p+d[0])*v,(-(S-.5)*a/p+d[1])*v)}function Bh(_,i,a,d,p,v){const w=i.tileAnchorPoint.add(new c.P(i.translation[0],i.translation[1]));if(i.pitchWithMap){let S=d.mult(v);return a||(S=S.rotate(-p)),gr(w.add(S),i.labelPlaneMatrix,i.getElevation).point}if(a){const S=de(i.tileAnchorPoint.x+1,i.tileAnchorPoint.y,i).point.sub(_),T=Math.atan(S.y/S.x)+(S.x<0?Math.PI:0);return _.add(d.rotate(T))}return _.add(d)}function pl(_,i,a,d,p,v,w,S,T,z,O,R,$,G){const K=_.text.placedSymbolArray,re=_.text.dynamicLayoutVertexArray,J=_.icon.dynamicLayoutVertexArray,ue={};re.clear();for(let ge=0;ge<K.length;ge++){const te=K.get(ge),ve=te.hidden||!te.crossTileID||_.allowVerticalPlacement&&!te.placedOrientation?null:d[te.crossTileID];if(ve){const Se=new c.P(te.anchorX,te.anchorY),Pe={getElevation:G,width:p.width,height:p.height,labelPlaneMatrix:v,lineVertexArray:null,pitchWithMap:a,projection:O,projectionCache:null,tileAnchorPoint:Se,translation:R,unwrappedTileID:$},Ne=a?gr(Se,w,G):de(Se.x,Se.y,Pe),Xe=Q(p.cameraToCenterDistance,Ne.signedDistanceFromCamera);let ut=c.ai(_.textSizeData,T,te)*Xe/c.ap;a&&(ut*=_.tilePixelRatio/S);const{width:ht,height:Je,anchor:et,textOffset:yt,textBoxScale:Ot}=ve,it=pp(et,ht,Je,yt,Ot,ut),at=O.getPitchedTextCorrection(p,Se.add(new c.P(R[0],R[1])),$),Pt=Bh(Ne.point,Pe,i,it,p.angle,at),Ci=_.allowVerticalPlacement&&te.placedOrientation===c.ah.vertical?Math.PI/2:0;for(let Wt=0;Wt<te.numGlyphs;Wt++)c.aj(re,Pt,Ci);z&&te.associatedIconIndex>=0&&(ue[te.associatedIconIndex]={shiftedAnchor:Pt,angle:Ci})}else Tt(te.numGlyphs,re)}if(z){J.clear();const ge=_.icon.placedSymbolArray;for(let te=0;te<ge.length;te++){const ve=ge.get(te);if(ve.hidden)Tt(ve.numGlyphs,J);else{const Se=ue[te];if(Se)for(let Pe=0;Pe<ve.numGlyphs;Pe++)c.aj(J,Se.shiftedAnchor,Se.angle);else Tt(ve.numGlyphs,J)}}_.icon.dynamicLayoutVertexBuffer.updateData(J)}_.text.dynamicLayoutVertexBuffer.updateData(re)}function ml(_,i,a){return a.iconsInText&&i?"symbolTextAndIcon":_?"symbolSDF":"symbolIcon"}function ba(_,i,a,d,p,v,w,S,T,z,O,R){const $=_.context,G=$.gl,K=_.transform,re=Yr(),J=S==="map",ue=T==="map",ge=S!=="viewport"&&a.layout.get("symbol-placement")!=="point",te=J&&!ue&&!ge,ve=!ue&&ge,Se=!a.layout.get("symbol-sort-key").isConstant();let Pe=!1;const Ne=_.depthModeForSublayer(0,Kt.ReadOnly),Xe=a._unevaluatedLayout.hasValue("text-variable-anchor")||a._unevaluatedLayout.hasValue("text-variable-anchor-offset"),ut=[],ht=re.getCircleRadiusCorrection(K);for(const Je of d){const et=i.getTile(Je),yt=et.getBucket(a);if(!yt)continue;const Ot=p?yt.text:yt.icon;if(!Ot||!Ot.segments.get().length||!Ot.hasVisibleVertices)continue;const it=Ot.programConfigurations.get(a.id),at=p||yt.sdfIcons,Pt=p?yt.textSizeData:yt.iconSizeData,Ci=ue||K.pitch!==0,Wt=_.useProgram(ml(at,p,yt),it),Yt=c.ag(Pt,K.zoom),Ai=_.style.map.terrain&&_.style.map.terrain.getTerrainData(Je);let Ar,In,ki,en,Nr=[0,0],kr=null;if(p)In=et.glyphAtlasTexture,ki=G.LINEAR,Ar=et.glyphAtlasTexture.size,yt.iconsInText&&(Nr=et.imageAtlasTexture.size,kr=et.imageAtlasTexture,en=Ci||_.options.rotating||_.options.zooming||Pt.kind==="composite"||Pt.kind==="camera"?G.LINEAR:G.NEAREST);else{const Ni=a.layout.get("icon-size").constantOr(0)!==1||yt.iconsNeedLinear;In=et.imageAtlasTexture,ki=at||_.options.rotating||_.options.zooming||Ni||Ci?G.LINEAR:G.NEAREST,Ar=et.imageAtlasTexture.size}const Mr=Rt(et,1,_.transform.zoom),Tn=ve?Je.posMatrix:Nc,Qo=io(Tn,ue,J,_.transform,Mr),Dl=ro(Tn,ue,J,_.transform,Mr),Ls=ro(Je.posMatrix,ue,J,_.transform,Mr),es=re.translatePosition(_.transform,et,v,w),Rl=Xe&&yt.hasTextData(),cu=a.layout.get("icon-text-fit")!=="none"&&Rl&&yt.hasIconData();if(ge){const Ni=_.style.map.terrain?(uu,hr)=>_.style.map.terrain.getElevation(Je,uu,hr):null,zs=a.layout.get("text-rotation-alignment")==="map";N(yt,Je.posMatrix,_,p,Qo,Ls,ue,z,zs,re,Je.toUnwrapped(),K.width,K.height,es,Ni)}const Er=Je.posMatrix,Cn=p&&Xe||cu,So=ge||Cn?Nc:Qo,Ps=Dl,Lr=at&&a.paint.get(p?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Pr;Pr=at?yt.iconsInText?ip(Pt.kind,Yt,te,ue,ge,Cn,_,Er,So,Ps,es,Ar,Nr,ht):Eh(Pt.kind,Yt,te,ue,ge,Cn,_,Er,So,Ps,es,p,Ar,!0,ht):wh(Pt.kind,Yt,te,ue,ge,Cn,_,Er,So,Ps,es,p,Ar,ht);const yr={program:Wt,buffers:Ot,uniformValues:Pr,atlasTexture:In,atlasTextureIcon:kr,atlasInterpolation:ki,atlasInterpolationIcon:en,isSDF:at,hasHalo:Lr};if(Se&&yt.canOverlap){Pe=!0;const Ni=Ot.segments.get();for(const zs of Ni)ut.push({segments:new c.$([zs]),sortKey:zs.sortKey,state:yr,terrainData:Ai})}else ut.push({segments:Ot.segments,sortKey:0,state:yr,terrainData:Ai})}Pe&&ut.sort((Je,et)=>Je.sortKey-et.sortKey);for(const Je of ut){const et=Je.state;if($.activeTexture.set(G.TEXTURE0),et.atlasTexture.bind(et.atlasInterpolation,G.CLAMP_TO_EDGE),et.atlasTextureIcon&&($.activeTexture.set(G.TEXTURE1),et.atlasTextureIcon&&et.atlasTextureIcon.bind(et.atlasInterpolationIcon,G.CLAMP_TO_EDGE)),et.isSDF){const yt=et.uniformValues;et.hasHalo&&(yt.u_is_halo=1,gl(et.buffers,Je.segments,a,_,et.program,Ne,O,R,yt,Je.terrainData)),yt.u_is_halo=0}gl(et.buffers,Je.segments,a,_,et.program,Ne,O,R,et.uniformValues,Je.terrainData)}}function gl(_,i,a,d,p,v,w,S,T,z){const O=d.context;p.draw(O,O.gl.TRIANGLES,v,w,S,zi.disabled,T,z,a.id,_.layoutVertexBuffer,_.indexBuffer,i,a.paint,d.transform.zoom,_.programConfigurations.get(a.id),_.dynamicLayoutVertexBuffer,_.opacityVertexBuffer)}function vo(_,i,a,d,p){if(!a||!d||!d.imageAtlas)return;const v=d.imageAtlas.patternPositions;let w=v[a.to.toString()],S=v[a.from.toString()];if(!w&&S&&(w=S),!S&&w&&(S=w),!w||!S){const T=p.getPaintProperty(i);w=v[T],S=v[T]}w&&S&&_.setConstantPatternPositions(w,S)}function Zo(_,i,a,d,p,v,w){const S=_.context.gl,T="fill-pattern",z=a.paint.get(T),O=z&&z.constantOr(1),R=a.getCrossfadeParameters();let $,G,K,re,J;w?(G=O&&!a.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",$=S.LINES):(G=O?"fillPattern":"fill",$=S.TRIANGLES);const ue=z.constantOr(null);for(const ge of d){const te=i.getTile(ge);if(O&&!te.patternsLoaded())continue;const ve=te.getBucket(a);if(!ve)continue;const Se=ve.programConfigurations.get(a.id),Pe=_.useProgram(G,Se),Ne=_.style.map.terrain&&_.style.map.terrain.getTerrainData(ge);O&&(_.context.activeTexture.set(S.TEXTURE0),te.imageAtlasTexture.bind(S.LINEAR,S.CLAMP_TO_EDGE),Se.updatePaintBuffers(R)),vo(Se,T,ue,te,a);const Xe=Ne?ge:null,ut=_.translatePosMatrix(Xe?Xe.posMatrix:ge.posMatrix,te,a.paint.get("fill-translate"),a.paint.get("fill-translate-anchor"));if(w){re=ve.indexBuffer2,J=ve.segments2;const ht=[S.drawingBufferWidth,S.drawingBufferHeight];K=G==="fillOutlinePattern"&&O?ma(ut,_,R,te,ht):sl(ut,ht)}else re=ve.indexBuffer,J=ve.segments,K=O?pa(ut,_,R,te):ol(ut);Pe.draw(_.context,$,p,_.stencilModeForClipping(ge),v,zi.disabled,K,Ne,a.id,ve.layoutVertexBuffer,re,J,a.paint,_.transform.zoom,Se)}}function Qr(_,i,a,d,p,v,w){const S=_.context,T=S.gl,z="fill-extrusion-pattern",O=a.paint.get(z),R=O.constantOr(1),$=a.getCrossfadeParameters(),G=a.paint.get("fill-extrusion-opacity"),K=O.constantOr(null);for(const re of d){const J=i.getTile(re),ue=J.getBucket(a);if(!ue)continue;const ge=_.style.map.terrain&&_.style.map.terrain.getTerrainData(re),te=ue.programConfigurations.get(a.id),ve=_.useProgram(R?"fillExtrusionPattern":"fillExtrusion",te);R&&(_.context.activeTexture.set(T.TEXTURE0),J.imageAtlasTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE),te.updatePaintBuffers($)),vo(te,z,K,J,a);const Se=_.translatePosMatrix(re.posMatrix,J,a.paint.get("fill-extrusion-translate"),a.paint.get("fill-extrusion-translate-anchor")),Pe=a.paint.get("fill-extrusion-vertical-gradient"),Ne=R?Tc(Se,_,Pe,G,re,$,J):fa(Se,_,Pe,G);ve.draw(S,S.gl.TRIANGLES,p,v,w,zi.backCCW,Ne,ge,a.id,ue.layoutVertexBuffer,ue.indexBuffer,ue.segments,a.paint,_.transform.zoom,te,_.style.map.terrain&&ue.centroidVertexBuffer)}}function Fh(_,i,a,d,p,v,w){const S=_.context,T=S.gl,z=a.fbo;if(!z)return;const O=_.useProgram("hillshade"),R=_.style.map.terrain&&_.style.map.terrain.getTerrainData(i);S.activeTexture.set(T.TEXTURE0),T.bindTexture(T.TEXTURE_2D,z.colorAttachment.get()),O.draw(S,T.TRIANGLES,p,v,w,zi.disabled,(($,G,K,re)=>{const J=K.paint.get("hillshade-shadow-color"),ue=K.paint.get("hillshade-highlight-color"),ge=K.paint.get("hillshade-accent-color");let te=K.paint.get("hillshade-illumination-direction")*(Math.PI/180);K.paint.get("hillshade-illumination-anchor")==="viewport"&&(te-=$.transform.angle);const ve=!$.options.moving;return{u_matrix:re?re.posMatrix:$.transform.calculatePosMatrix(G.tileID.toUnwrapped(),ve),u_image:0,u_latrange:al(0,G.tileID),u_light:[K.paint.get("hillshade-exaggeration"),te],u_shadow:J,u_highlight:ue,u_accent:ge}})(_,a,d,R?i:null),R,d.id,_.rasterBoundsBuffer,_.quadTriangleIndexBuffer,_.rasterBoundsSegments)}function Vh(_,i,a,d,p,v){const w=_.context,S=w.gl,T=i.dem;if(T&&T.data){const z=T.dim,O=T.stride,R=T.getPixels();if(w.activeTexture.set(S.TEXTURE1),w.pixelStoreUnpackPremultiplyAlpha.set(!1),i.demTexture=i.demTexture||_.getTileTexture(O),i.demTexture){const G=i.demTexture;G.update(R,{premultiply:!1}),G.bind(S.NEAREST,S.CLAMP_TO_EDGE)}else i.demTexture=new ke(w,R,S.RGBA,{premultiply:!1}),i.demTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE);w.activeTexture.set(S.TEXTURE0);let $=i.fbo;if(!$){const G=new ke(w,{width:z,height:z,data:null},S.RGBA);G.bind(S.LINEAR,S.CLAMP_TO_EDGE),$=i.fbo=w.createFramebuffer(z,z,!0,!1),$.colorAttachment.set(G.texture)}w.bindFramebuffer.set($.framebuffer),w.viewport.set([0,0,z,z]),_.useProgram("hillshadePrepare").draw(w,S.TRIANGLES,d,p,v,zi.disabled,((G,K)=>{const re=K.stride,J=c.F();return c.aO(J,0,c.W,-c.W,0,0,1),c.H(J,J,[0,-c.W,0]),{u_matrix:J,u_image:1,u_dimension:[re,re],u_zoom:G.overscaledZ,u_unpack:K.getUnpackVector()}})(i.tileID,T),null,a.id,_.rasterBoundsBuffer,_.quadTriangleIndexBuffer,_.rasterBoundsSegments),i.needsHillshadePrepare=!1}}function $c(_,i,a,d,p,v){const w=d.paint.get("raster-fade-duration");if(!v&&w>0){const S=C.now(),T=(S-_.timeAdded)/w,z=i?(S-i.timeAdded)/w:-1,O=a.getSource(),R=p.coveringZoomLevel({tileSize:O.tileSize,roundZoom:O.roundZoom}),$=!i||Math.abs(i.tileID.overscaledZ-R)>Math.abs(_.tileID.overscaledZ-R),G=$&&_.refreshedUponExpiration?1:c.ac($?T:1-z,0,1);return _.refreshedUponExpiration&&T>=1&&(_.refreshedUponExpiration=!1),i?{opacity:1,mix:1-G}:{opacity:G,mix:0}}return{opacity:1,mix:0}}const Wo=new c.aP(1,0,0,1),yl=new c.aP(0,1,0,1),_l=new c.aP(0,0,1,1),wa=new c.aP(1,0,1,1),vl=new c.aP(0,1,1,1);function jc(_,i,a,d){so(_,0,i+a/2,_.transform.width,a,d)}function Ko(_,i,a,d){so(_,i-a/2,0,a,_.transform.height,d)}function so(_,i,a,d,p,v){const w=_.context,S=w.gl;S.enable(S.SCISSOR_TEST),S.scissor(i*_.pixelRatio,a*_.pixelRatio,d*_.pixelRatio,p*_.pixelRatio),w.clear({color:v}),S.disable(S.SCISSOR_TEST)}function Nh(_,i,a){const d=_.context,p=d.gl,v=a.posMatrix,w=_.useProgram("debug"),S=Kt.disabled,T=Vi.disabled,z=_.colorModeForRenderPass(),O="$debug",R=_.style.map.terrain&&_.style.map.terrain.getTerrainData(a);d.activeTexture.set(p.TEXTURE0);const $=i.getTileByID(a.key).latestRawTileData,G=Math.floor(($&&$.byteLength||0)/1024),K=i.getTile(a).tileSize,re=512/Math.min(K,512)*(a.overscaledZ/_.transform.zoom)*.5;let J=a.canonical.toString();a.overscaledZ!==a.canonical.z&&(J+=` => ${a.overscaledZ}`),function(ue,ge){ue.initDebugOverlayCanvas();const te=ue.debugOverlayCanvas,ve=ue.context.gl,Se=ue.debugOverlayCanvas.getContext("2d");Se.clearRect(0,0,te.width,te.height),Se.shadowColor="white",Se.shadowBlur=2,Se.lineWidth=1.5,Se.strokeStyle="white",Se.textBaseline="top",Se.font="bold 36px Open Sans, sans-serif",Se.fillText(ge,5,5),Se.strokeText(ge,5,5),ue.debugOverlayTexture.update(te),ue.debugOverlayTexture.bind(ve.LINEAR,ve.CLAMP_TO_EDGE)}(_,`${J} ${G}kB`),w.draw(d,p.TRIANGLES,S,T,Ki.alphaBlended,zi.disabled,Cc(v,c.aP.transparent,re),null,O,_.debugBuffer,_.quadTriangleIndexBuffer,_.debugSegments),w.draw(d,p.LINE_STRIP,S,T,z,zi.disabled,Cc(v,c.aP.red),R,O,_.debugBuffer,_.tileBorderIndexBuffer,_.debugSegments)}function xl(_,i,a){const d=_.context,p=d.gl,v=_.colorModeForRenderPass(),w=new Kt(p.LEQUAL,Kt.ReadWrite,_.depthRangeFor3D),S=_.useProgram("terrain"),T=i.getTerrainMesh();d.bindFramebuffer.set(null),d.viewport.set([0,0,_.width,_.height]);for(const z of a){const O=_.renderToTexture.getTexture(z),R=i.getTerrainData(z.tileID);d.activeTexture.set(p.TEXTURE0),p.bindTexture(p.TEXTURE_2D,O.texture);const $={u_matrix:_.transform.calculatePosMatrix(z.tileID.toUnwrapped()),u_texture:0,u_ele_delta:i.getMeshFrameDelta(_.transform.zoom)};S.draw(d,p.TRIANGLES,w,Vi.disabled,v,zi.backCCW,$,R,"terrain",T.vertexBuffer,T.indexBuffer,T.segments)}}class oi{constructor(i,a){this.context=new Vc(i),this.transform=a,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:c.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Ye.maxUnderzooming+Ye.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Wi}resize(i,a,d){if(this.width=Math.floor(i*d),this.height=Math.floor(a*d),this.pixelRatio=d,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const p of this.style._order)this.style._layers[p].resize()}setup(){const i=this.context,a=new c.aW;a.emplaceBack(0,0),a.emplaceBack(c.W,0),a.emplaceBack(0,c.W),a.emplaceBack(c.W,c.W),this.tileExtentBuffer=i.createVertexBuffer(a,Un.members),this.tileExtentSegments=c.$.simpleSegment(0,0,4,2);const d=new c.aW;d.emplaceBack(0,0),d.emplaceBack(c.W,0),d.emplaceBack(0,c.W),d.emplaceBack(c.W,c.W),this.debugBuffer=i.createVertexBuffer(d,Un.members),this.debugSegments=c.$.simpleSegment(0,0,4,5);const p=new c.Z;p.emplaceBack(0,0,0,0),p.emplaceBack(c.W,0,c.W,0),p.emplaceBack(0,c.W,0,c.W),p.emplaceBack(c.W,c.W,c.W,c.W),this.rasterBoundsBuffer=i.createVertexBuffer(p,je.members),this.rasterBoundsSegments=c.$.simpleSegment(0,0,4,2);const v=new c.aW;v.emplaceBack(0,0),v.emplaceBack(1,0),v.emplaceBack(0,1),v.emplaceBack(1,1),this.viewportBuffer=i.createVertexBuffer(v,Un.members),this.viewportSegments=c.$.simpleSegment(0,0,4,2);const w=new c.aX;w.emplaceBack(0),w.emplaceBack(1),w.emplaceBack(3),w.emplaceBack(2),w.emplaceBack(0),this.tileBorderIndexBuffer=i.createIndexBuffer(w);const S=new c.aY;S.emplaceBack(0,1,2),S.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=i.createIndexBuffer(S);const T=this.context.gl;this.stencilClearMode=new Vi({func:T.ALWAYS,mask:0},0,255,T.ZERO,T.ZERO,T.ZERO)}clearStencil(){const i=this.context,a=i.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const d=c.F();c.aO(d,0,this.width,this.height,0,0,1),c.J(d,d,[a.drawingBufferWidth,a.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(i,a.TRIANGLES,Kt.disabled,this.stencilClearMode,Ki.disabled,zi.disabled,bh(d),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(i,a){if(this.currentStencilSource===i.source||!i.isTileClipped()||!a||!a.length)return;this.currentStencilSource=i.source;const d=this.context,p=d.gl;this.nextStencilID+a.length>256&&this.clearStencil(),d.setColorMode(Ki.disabled),d.setDepthMode(Kt.disabled);const v=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const w of a){const S=this._tileClippingMaskIDs[w.key]=this.nextStencilID++,T=this.style.map.terrain&&this.style.map.terrain.getTerrainData(w);v.draw(d,p.TRIANGLES,Kt.disabled,new Vi({func:p.ALWAYS,mask:0},S,255,p.KEEP,p.KEEP,p.REPLACE),Ki.disabled,zi.disabled,bh(w.posMatrix),T,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const i=this.nextStencilID++,a=this.context.gl;return new Vi({func:a.NOTEQUAL,mask:255},i,255,a.KEEP,a.KEEP,a.REPLACE)}stencilModeForClipping(i){const a=this.context.gl;return new Vi({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[i.key],0,a.KEEP,a.KEEP,a.REPLACE)}stencilConfigForOverlap(i){const a=this.context.gl,d=i.sort((w,S)=>S.overscaledZ-w.overscaledZ),p=d[d.length-1].overscaledZ,v=d[0].overscaledZ-p+1;if(v>1){this.currentStencilSource=void 0,this.nextStencilID+v>256&&this.clearStencil();const w={};for(let S=0;S<v;S++)w[S+p]=new Vi({func:a.GEQUAL,mask:255},S+this.nextStencilID,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID+=v,[w,d]}return[{[p]:Vi.disabled},d]}colorModeForRenderPass(){const i=this.context.gl;return this._showOverdrawInspector?new Ki([i.CONSTANT_COLOR,i.ONE],new c.aP(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Ki.unblended:Ki.alphaBlended}depthModeForSublayer(i,a,d){if(!this.opaquePassEnabledForLayer())return Kt.disabled;const p=1-((1+this.currentLayer)*this.numSublayers+i)*this.depthEpsilon;return new Kt(d||this.context.gl.LEQUAL,a,[p,p])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(i,a){this.style=i,this.options=a,this.lineAtlas=i.lineAtlas,this.imageManager=i.imageManager,this.glyphManager=i.glyphManager,this.symbolFadeChange=i.placement.symbolFadeChange(C.now()),this.imageManager.beginFrame();const d=this.style._order,p=this.style.sourceCaches,v={},w={},S={};for(const T in p){const z=p[T];z.used&&z.prepare(this.context),v[T]=z.getVisibleCoordinates(),w[T]=v[T].slice().reverse(),S[T]=z.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let T=0;T<d.length;T++)if(this.style._layers[d[T]].is3D()){this.opaquePassCutoff=T;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const T of d){const z=this.style._layers[T];if(!z.hasOffscreenPass()||z.isHidden(this.transform.zoom))continue;const O=w[z.source];(z.type==="custom"||O.length)&&this.renderLayer(this,p[z.source],z,O)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:a.showOverdrawInspector?c.aP.black:c.aP.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=a.showOverdrawInspector,this.depthRangeFor3D=[0,1-(i._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=d.length-1;this.currentLayer>=0;this.currentLayer--){const T=this.style._layers[d[this.currentLayer]],z=p[T.source],O=v[T.source];this._renderTileClippingMasks(T,O),this.renderLayer(this,z,T,O)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<d.length;this.currentLayer++){const T=this.style._layers[d[this.currentLayer]],z=p[T.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(T))continue;const O=(T.type==="symbol"?S:w)[T.source];this._renderTileClippingMasks(T,v[T.source]),this.renderLayer(this,z,T,O)}if(this.options.showTileBoundaries){const T=function(z,O){let R=null;const $=Object.values(z._layers).flatMap(J=>J.source&&!J.isHidden(O)?[z.sourceCaches[J.source]]:[]),G=$.filter(J=>J.getSource().type==="vector"),K=$.filter(J=>J.getSource().type!=="vector"),re=J=>{(!R||R.getSource().maxzoom<J.getSource().maxzoom)&&(R=J)};return G.forEach(J=>re(J)),R||K.forEach(J=>re(J)),R}(this.style,this.transform.zoom);T&&function(z,O,R){for(let $=0;$<R.length;$++)Nh(z,O,R[$])}(this,T,T.getVisibleCoordinates())}this.options.showPadding&&function(T){const z=T.transform.padding;jc(T,T.transform.height-(z.top||0),3,Wo),jc(T,z.bottom||0,3,yl),Ko(T,z.left||0,3,_l),Ko(T,T.transform.width-(z.right||0),3,wa);const O=T.transform.centerPoint;(function(R,$,G,K){so(R,$-1,G-10,2,20,K),so(R,$-10,G-1,20,2,K)})(T,O.x,T.transform.height-O.y,vl)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(i){if(!this.style||!this.style.map||!this.style.map.terrain)return;const a=this.terrainFacilitator.matrix,d=this.transform.modelViewProjectionMatrix;let p=this.terrainFacilitator.dirty;p||(p=i?!c.aZ(a,d):!c.a_(a,d)),p||(p=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),p&&(c.a$(a,d),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(v,w){const S=v.context,T=S.gl,z=Ki.unblended,O=new Kt(T.LEQUAL,Kt.ReadWrite,[0,1]),R=w.getTerrainMesh(),$=w.sourceCache.getRenderableTiles(),G=v.useProgram("terrainDepth");S.bindFramebuffer.set(w.getFramebuffer("depth").framebuffer),S.viewport.set([0,0,v.width/devicePixelRatio,v.height/devicePixelRatio]),S.clear({color:c.aP.transparent,depth:1});for(const K of $){const re=w.getTerrainData(K.tileID),J={u_matrix:v.transform.calculatePosMatrix(K.tileID.toUnwrapped()),u_ele_delta:w.getMeshFrameDelta(v.transform.zoom)};G.draw(S,T.TRIANGLES,O,Vi.disabled,z,zi.backCCW,J,re,"terrain",R.vertexBuffer,R.indexBuffer,R.segments)}S.bindFramebuffer.set(null),S.viewport.set([0,0,v.width,v.height])}(this,this.style.map.terrain),function(v,w){const S=v.context,T=S.gl,z=Ki.unblended,O=new Kt(T.LEQUAL,Kt.ReadWrite,[0,1]),R=w.getTerrainMesh(),$=w.getCoordsTexture(),G=w.sourceCache.getRenderableTiles(),K=v.useProgram("terrainCoords");S.bindFramebuffer.set(w.getFramebuffer("coords").framebuffer),S.viewport.set([0,0,v.width/devicePixelRatio,v.height/devicePixelRatio]),S.clear({color:c.aP.transparent,depth:1}),w.coordsIndex=[];for(const re of G){const J=w.getTerrainData(re.tileID);S.activeTexture.set(T.TEXTURE0),T.bindTexture(T.TEXTURE_2D,$.texture);const ue={u_matrix:v.transform.calculatePosMatrix(re.tileID.toUnwrapped()),u_terrain_coords_id:(255-w.coordsIndex.length)/255,u_texture:0,u_ele_delta:w.getMeshFrameDelta(v.transform.zoom)};K.draw(S,T.TRIANGLES,O,Vi.disabled,z,zi.backCCW,ue,J,"terrain",R.vertexBuffer,R.indexBuffer,R.segments),w.coordsIndex.push(re.tileID.key)}S.bindFramebuffer.set(null),S.viewport.set([0,0,v.width,v.height])}(this,this.style.map.terrain))}renderLayer(i,a,d,p){if(!d.isHidden(this.transform.zoom)&&(d.type==="background"||d.type==="custom"||(p||[]).length))switch(this.id=d.id,d.type){case"symbol":(function(v,w,S,T,z){if(v.renderPass!=="translucent")return;const O=Vi.disabled,R=v.colorModeForRenderPass();(S._unevaluatedLayout.hasValue("text-variable-anchor")||S._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function($,G,K,re,J,ue,ge,te,ve){const Se=G.transform,Pe=Yr(),Ne=J==="map",Xe=ue==="map";for(const ut of $){const ht=re.getTile(ut),Je=ht.getBucket(K);if(!Je||!Je.text||!Je.text.segments.get().length)continue;const et=c.ag(Je.textSizeData,Se.zoom),yt=Rt(ht,1,G.transform.zoom),Ot=io(ut.posMatrix,Xe,Ne,G.transform,yt),it=K.layout.get("icon-text-fit")!=="none"&&Je.hasIconData();if(et){const at=Math.pow(2,Se.zoom-ht.tileID.overscaledZ),Pt=G.style.map.terrain?(Wt,Yt)=>G.style.map.terrain.getElevation(ut,Wt,Yt):null,Ci=Pe.translatePosition(Se,ht,ge,te);pl(Je,Ne,Xe,ve,Se,Ot,ut.posMatrix,at,et,it,Pe,Ci,ut.toUnwrapped(),Pt)}}}(T,v,S,w,S.layout.get("text-rotation-alignment"),S.layout.get("text-pitch-alignment"),S.paint.get("text-translate"),S.paint.get("text-translate-anchor"),z),S.paint.get("icon-opacity").constantOr(1)!==0&&ba(v,w,S,T,!1,S.paint.get("icon-translate"),S.paint.get("icon-translate-anchor"),S.layout.get("icon-rotation-alignment"),S.layout.get("icon-pitch-alignment"),S.layout.get("icon-keep-upright"),O,R),S.paint.get("text-opacity").constantOr(1)!==0&&ba(v,w,S,T,!0,S.paint.get("text-translate"),S.paint.get("text-translate-anchor"),S.layout.get("text-rotation-alignment"),S.layout.get("text-pitch-alignment"),S.layout.get("text-keep-upright"),O,R),w.map.showCollisionBoxes&&(Oh(v,w,S,T,!0),Oh(v,w,S,T,!1))})(i,a,d,p,this.style.placement.variableOffsets);break;case"circle":(function(v,w,S,T){if(v.renderPass!=="translucent")return;const z=S.paint.get("circle-opacity"),O=S.paint.get("circle-stroke-width"),R=S.paint.get("circle-stroke-opacity"),$=!S.layout.get("circle-sort-key").isConstant();if(z.constantOr(1)===0&&(O.constantOr(1)===0||R.constantOr(1)===0))return;const G=v.context,K=G.gl,re=v.depthModeForSublayer(0,Kt.ReadOnly),J=Vi.disabled,ue=v.colorModeForRenderPass(),ge=[];for(let te=0;te<T.length;te++){const ve=T[te],Se=w.getTile(ve),Pe=Se.getBucket(S);if(!Pe)continue;const Ne=Pe.programConfigurations.get(S.id),Xe=v.useProgram("circle",Ne),ut=Pe.layoutVertexBuffer,ht=Pe.indexBuffer,Je=v.style.map.terrain&&v.style.map.terrain.getTerrainData(ve),et={programConfiguration:Ne,program:Xe,layoutVertexBuffer:ut,indexBuffer:ht,uniformValues:Qf(v,ve,Se,S),terrainData:Je};if($){const yt=Pe.segments.get();for(const Ot of yt)ge.push({segments:new c.$([Ot]),sortKey:Ot.sortKey,state:et})}else ge.push({segments:Pe.segments,sortKey:0,state:et})}$&&ge.sort((te,ve)=>te.sortKey-ve.sortKey);for(const te of ge){const{programConfiguration:ve,program:Se,layoutVertexBuffer:Pe,indexBuffer:Ne,uniformValues:Xe,terrainData:ut}=te.state;Se.draw(G,K.TRIANGLES,re,J,ue,zi.disabled,Xe,ut,S.id,Pe,Ne,te.segments,S.paint,v.transform.zoom,ve)}})(i,a,d,p);break;case"heatmap":(function(v,w,S,T){if(S.paint.get("heatmap-opacity")!==0)if(v.renderPass==="offscreen"){const z=v.context,O=z.gl,R=Vi.disabled,$=new Ki([O.ONE,O.ONE],c.aP.transparent,[!0,!0,!0,!0]);(function(G,K,re){const J=G.gl;G.activeTexture.set(J.TEXTURE1),G.viewport.set([0,0,K.width/4,K.height/4]);let ue=re.heatmapFbo;if(ue)J.bindTexture(J.TEXTURE_2D,ue.colorAttachment.get()),G.bindFramebuffer.set(ue.framebuffer);else{const ge=J.createTexture();J.bindTexture(J.TEXTURE_2D,ge),J.texParameteri(J.TEXTURE_2D,J.TEXTURE_WRAP_S,J.CLAMP_TO_EDGE),J.texParameteri(J.TEXTURE_2D,J.TEXTURE_WRAP_T,J.CLAMP_TO_EDGE),J.texParameteri(J.TEXTURE_2D,J.TEXTURE_MIN_FILTER,J.LINEAR),J.texParameteri(J.TEXTURE_2D,J.TEXTURE_MAG_FILTER,J.LINEAR),ue=re.heatmapFbo=G.createFramebuffer(K.width/4,K.height/4,!1,!1),function(te,ve,Se,Pe){var Ne,Xe;const ut=te.gl,ht=(Ne=te.HALF_FLOAT)!==null&&Ne!==void 0?Ne:ut.UNSIGNED_BYTE,Je=(Xe=te.RGBA16F)!==null&&Xe!==void 0?Xe:ut.RGBA;ut.texImage2D(ut.TEXTURE_2D,0,Je,ve.width/4,ve.height/4,0,ut.RGBA,ht,null),Pe.colorAttachment.set(Se)}(G,K,ge,ue)}})(z,v,S),z.clear({color:c.aP.transparent});for(let G=0;G<T.length;G++){const K=T[G];if(w.hasRenderableParent(K))continue;const re=w.getTile(K),J=re.getBucket(S);if(!J)continue;const ue=J.programConfigurations.get(S.id),ge=v.useProgram("heatmap",ue),{zoom:te}=v.transform;ge.draw(z,O.TRIANGLES,Kt.disabled,R,$,zi.disabled,Ho(K.posMatrix,re,te,S.paint.get("heatmap-intensity")),null,S.id,J.layoutVertexBuffer,J.indexBuffer,J.segments,S.paint,v.transform.zoom,ue)}z.viewport.set([0,0,v.width,v.height])}else v.renderPass==="translucent"&&(v.context.setColorMode(v.colorModeForRenderPass()),function(z,O){const R=z.context,$=R.gl,G=O.heatmapFbo;if(!G)return;R.activeTexture.set($.TEXTURE0),$.bindTexture($.TEXTURE_2D,G.colorAttachment.get()),R.activeTexture.set($.TEXTURE1);let K=O.colorRampTexture;K||(K=O.colorRampTexture=new ke(R,O.colorRamp,$.RGBA)),K.bind($.LINEAR,$.CLAMP_TO_EDGE),z.useProgram("heatmapTexture").draw(R,$.TRIANGLES,Kt.disabled,Vi.disabled,z.colorModeForRenderPass(),zi.disabled,((re,J,ue,ge)=>{const te=c.F();c.aO(te,0,re.width,re.height,0,0,1);const ve=re.context.gl;return{u_matrix:te,u_world:[ve.drawingBufferWidth,ve.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:J.paint.get("heatmap-opacity")}})(z,O),null,O.id,z.viewportBuffer,z.quadTriangleIndexBuffer,z.viewportSegments,O.paint,z.transform.zoom)}(v,S))})(i,a,d,p);break;case"line":(function(v,w,S,T){if(v.renderPass!=="translucent")return;const z=S.paint.get("line-opacity"),O=S.paint.get("line-width");if(z.constantOr(1)===0||O.constantOr(1)===0)return;const R=v.depthModeForSublayer(0,Kt.ReadOnly),$=v.colorModeForRenderPass(),G=S.paint.get("line-dasharray"),K=S.paint.get("line-pattern"),re=K.constantOr(1),J=S.paint.get("line-gradient"),ue=S.getCrossfadeParameters(),ge=re?"linePattern":G?"lineSDF":J?"lineGradient":"line",te=v.context,ve=te.gl;let Se=!0;for(const Pe of T){const Ne=w.getTile(Pe);if(re&&!Ne.patternsLoaded())continue;const Xe=Ne.getBucket(S);if(!Xe)continue;const ut=Xe.programConfigurations.get(S.id),ht=v.context.program.get(),Je=v.useProgram(ge,ut),et=Se||Je.program!==ht,yt=v.style.map.terrain&&v.style.map.terrain.getTerrainData(Pe),Ot=K.constantOr(null);if(Ot&&Ne.imageAtlas){const Pt=Ne.imageAtlas,Ci=Pt.patternPositions[Ot.to.toString()],Wt=Pt.patternPositions[Ot.from.toString()];Ci&&Wt&&ut.setConstantPatternPositions(Ci,Wt)}const it=yt?Pe:null,at=re?Ac(v,Ne,S,ue,it):G?ll(v,Ne,S,G,ue,it):J?hn(v,Ne,S,Xe.lineClipsArray.length,it):Vr(v,Ne,S,it);if(re)te.activeTexture.set(ve.TEXTURE0),Ne.imageAtlasTexture.bind(ve.LINEAR,ve.CLAMP_TO_EDGE),ut.updatePaintBuffers(ue);else if(G&&(et||v.lineAtlas.dirty))te.activeTexture.set(ve.TEXTURE0),v.lineAtlas.bind(te);else if(J){const Pt=Xe.gradients[S.id];let Ci=Pt.texture;if(S.gradientVersion!==Pt.version){let Wt=256;if(S.stepInterpolant){const Yt=w.getSource().maxzoom,Ai=Pe.canonical.z===Yt?Math.ceil(1<<v.transform.maxZoom-Pe.canonical.z):1;Wt=c.ac(c.aU(Xe.maxLineLength/c.W*1024*Ai),256,te.maxTextureSize)}Pt.gradient=c.aV({expression:S.gradientExpression(),evaluationKey:"lineProgress",resolution:Wt,image:Pt.gradient||void 0,clips:Xe.lineClipsArray}),Pt.texture?Pt.texture.update(Pt.gradient):Pt.texture=new ke(te,Pt.gradient,ve.RGBA),Pt.version=S.gradientVersion,Ci=Pt.texture}te.activeTexture.set(ve.TEXTURE0),Ci.bind(S.stepInterpolant?ve.NEAREST:ve.LINEAR,ve.CLAMP_TO_EDGE)}Je.draw(te,ve.TRIANGLES,R,v.stencilModeForClipping(Pe),$,zi.disabled,at,yt,S.id,Xe.layoutVertexBuffer,Xe.indexBuffer,Xe.segments,S.paint,v.transform.zoom,ut,Xe.layoutVertexBuffer2),Se=!1}})(i,a,d,p);break;case"fill":(function(v,w,S,T){const z=S.paint.get("fill-color"),O=S.paint.get("fill-opacity");if(O.constantOr(1)===0)return;const R=v.colorModeForRenderPass(),$=S.paint.get("fill-pattern"),G=v.opaquePassEnabledForLayer()&&!$.constantOr(1)&&z.constantOr(c.aP.transparent).a===1&&O.constantOr(0)===1?"opaque":"translucent";if(v.renderPass===G){const K=v.depthModeForSublayer(1,v.renderPass==="opaque"?Kt.ReadWrite:Kt.ReadOnly);Zo(v,w,S,T,K,R,!1)}if(v.renderPass==="translucent"&&S.paint.get("fill-antialias")){const K=v.depthModeForSublayer(S.getPaintProperty("fill-outline-color")?2:0,Kt.ReadOnly);Zo(v,w,S,T,K,R,!0)}})(i,a,d,p);break;case"fill-extrusion":(function(v,w,S,T){const z=S.paint.get("fill-extrusion-opacity");if(z!==0&&v.renderPass==="translucent"){const O=new Kt(v.context.gl.LEQUAL,Kt.ReadWrite,v.depthRangeFor3D);if(z!==1||S.paint.get("fill-extrusion-pattern").constantOr(1))Qr(v,w,S,T,O,Vi.disabled,Ki.disabled),Qr(v,w,S,T,O,v.stencilModeFor3D(),v.colorModeForRenderPass());else{const R=v.colorModeForRenderPass();Qr(v,w,S,T,O,Vi.disabled,R)}}})(i,a,d,p);break;case"hillshade":(function(v,w,S,T){if(v.renderPass!=="offscreen"&&v.renderPass!=="translucent")return;const z=v.context,O=v.depthModeForSublayer(0,Kt.ReadOnly),R=v.colorModeForRenderPass(),[$,G]=v.renderPass==="translucent"?v.stencilConfigForOverlap(T):[{},T];for(const K of G){const re=w.getTile(K);re.needsHillshadePrepare!==void 0&&re.needsHillshadePrepare&&v.renderPass==="offscreen"?Vh(v,re,S,O,Vi.disabled,R):v.renderPass==="translucent"&&Fh(v,K,re,S,O,$[K.overscaledZ],R)}z.viewport.set([0,0,v.width,v.height])})(i,a,d,p);break;case"raster":(function(v,w,S,T){if(v.renderPass!=="translucent"||S.paint.get("raster-opacity")===0||!T.length)return;const z=v.context,O=z.gl,R=w.getSource(),$=v.useProgram("raster"),G=v.colorModeForRenderPass(),[K,re]=R instanceof Qe?[{},T]:v.stencilConfigForOverlap(T),J=re[re.length-1].overscaledZ,ue=!v.options.moving;for(const ge of re){const te=v.depthModeForSublayer(ge.overscaledZ-J,S.paint.get("raster-opacity")===1?Kt.ReadWrite:Kt.ReadOnly,O.LESS),ve=w.getTile(ge);ve.registerFadeDuration(S.paint.get("raster-fade-duration"));const Se=w.findLoadedParent(ge,0),Pe=w.findLoadedSibling(ge),Ne=$c(ve,Se||Pe||null,w,S,v.transform,v.style.map.terrain);let Xe,ut;const ht=S.paint.get("raster-resampling")==="nearest"?O.NEAREST:O.LINEAR;z.activeTexture.set(O.TEXTURE0),ve.texture.bind(ht,O.CLAMP_TO_EDGE,O.LINEAR_MIPMAP_NEAREST),z.activeTexture.set(O.TEXTURE1),Se?(Se.texture.bind(ht,O.CLAMP_TO_EDGE,O.LINEAR_MIPMAP_NEAREST),Xe=Math.pow(2,Se.tileID.overscaledZ-ve.tileID.overscaledZ),ut=[ve.tileID.canonical.x*Xe%1,ve.tileID.canonical.y*Xe%1]):ve.texture.bind(ht,O.CLAMP_TO_EDGE,O.LINEAR_MIPMAP_NEAREST);const Je=v.style.map.terrain&&v.style.map.terrain.getTerrainData(ge),et=Je?ge:null,yt=et?et.posMatrix:v.transform.calculatePosMatrix(ge.toUnwrapped(),ue),Ot=bs(yt,ut||[0,0],Xe||1,Ne,S);R instanceof Qe?$.draw(z,O.TRIANGLES,te,Vi.disabled,G,zi.disabled,Ot,Je,S.id,R.boundsBuffer,v.quadTriangleIndexBuffer,R.boundsSegments):$.draw(z,O.TRIANGLES,te,K[ge.overscaledZ],G,zi.disabled,Ot,Je,S.id,v.rasterBoundsBuffer,v.quadTriangleIndexBuffer,v.rasterBoundsSegments)}})(i,a,d,p);break;case"background":(function(v,w,S,T){const z=S.paint.get("background-color"),O=S.paint.get("background-opacity");if(O===0)return;const R=v.context,$=R.gl,G=v.transform,K=G.tileSize,re=S.paint.get("background-pattern");if(v.isPatternMissing(re))return;const J=!re&&z.a===1&&O===1&&v.opaquePassEnabledForLayer()?"opaque":"translucent";if(v.renderPass!==J)return;const ue=Vi.disabled,ge=v.depthModeForSublayer(0,J==="opaque"?Kt.ReadWrite:Kt.ReadOnly),te=v.colorModeForRenderPass(),ve=v.useProgram(re?"backgroundPattern":"background"),Se=T||G.coveringTiles({tileSize:K,terrain:v.style.map.terrain});re&&(R.activeTexture.set($.TEXTURE0),v.imageManager.bind(v.context));const Pe=S.getCrossfadeParameters();for(const Ne of Se){const Xe=T?Ne.posMatrix:v.transform.calculatePosMatrix(Ne.toUnwrapped()),ut=re?np(Xe,O,v,re,{tileID:Ne,tileSize:K},Pe):rp(Xe,O,z),ht=v.style.map.terrain&&v.style.map.terrain.getTerrainData(Ne);ve.draw(R,$.TRIANGLES,ge,ue,te,zi.disabled,ut,ht,S.id,v.tileExtentBuffer,v.quadTriangleIndexBuffer,v.tileExtentSegments)}})(i,0,d,p);break;case"custom":(function(v,w,S){const T=v.context,z=S.implementation;if(v.renderPass==="offscreen"){const O=z.prerender;O&&(v.setCustomLayerDefaults(),T.setColorMode(v.colorModeForRenderPass()),O.call(z,T.gl,v.transform.customLayerMatrix()),T.setDirty(),v.setBaseState())}else if(v.renderPass==="translucent"){v.setCustomLayerDefaults(),T.setColorMode(v.colorModeForRenderPass()),T.setStencilMode(Vi.disabled);const O=z.renderingMode==="3d"?new Kt(v.context.gl.LEQUAL,Kt.ReadWrite,v.depthRangeFor3D):v.depthModeForSublayer(0,Kt.ReadOnly);T.setDepthMode(O),z.render(T.gl,v.transform.customLayerMatrix()),T.setDirty(),v.setBaseState(),T.bindFramebuffer.set(null)}})(i,0,d)}}translatePosMatrix(i,a,d,p,v){if(!d[0]&&!d[1])return i;const w=v?p==="map"?this.transform.angle:0:p==="viewport"?-this.transform.angle:0;if(w){const z=Math.sin(w),O=Math.cos(w);d=[d[0]*O-d[1]*z,d[0]*z+d[1]*O]}const S=[v?d[0]:Rt(a,d[0],this.transform.zoom),v?d[1]:Rt(a,d[1],this.transform.zoom),0],T=new Float32Array(16);return c.H(T,i,S),T}saveTileTexture(i){const a=this._tileTextures[i.size[0]];a?a.push(i):this._tileTextures[i.size[0]]=[i]}getTileTexture(i){const a=this._tileTextures[i];return a&&a.length>0?a.pop():null}isPatternMissing(i){if(!i)return!1;if(!i.from||!i.to)return!0;const a=this.imageManager.getPattern(i.from.toString()),d=this.imageManager.getPattern(i.to.toString());return!a||!d}useProgram(i,a){this.cache=this.cache||{};const d=i+(a?a.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[d]||(this.cache[d]=new Ic(this.context,vs[i],a,cl[i],this._showOverdrawInspector,this.style.map.terrain)),this.cache[d]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const i=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(i.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new ke(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:i,drawingBufferHeight:a}=this.context.gl;return this.width!==i||this.height!==a}}class Ss{constructor(i,a){this.points=i,this.planes=a}static fromInvProjectionMatrix(i,a,d){const p=Math.pow(2,d),v=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(S=>{const T=1/(S=c.af([],S,i))[3]/a*p;return c.b0(S,S,[T,T,1/S[3],T])}),w=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(S=>{const T=function($,G){var K=G[0],re=G[1],J=G[2],ue=K*K+re*re+J*J;return ue>0&&(ue=1/Math.sqrt(ue)),$[0]=G[0]*ue,$[1]=G[1]*ue,$[2]=G[2]*ue,$}([],function($,G,K){var re=G[0],J=G[1],ue=G[2],ge=K[0],te=K[1],ve=K[2];return $[0]=J*ve-ue*te,$[1]=ue*ge-re*ve,$[2]=re*te-J*ge,$}([],Ae([],v[S[0]],v[S[1]]),Ae([],v[S[2]],v[S[1]]))),z=-((O=T)[0]*(R=v[S[1]])[0]+O[1]*R[1]+O[2]*R[2]);var O,R;return T.concat(z)});return new Ss(v,w)}}class bl{constructor(i,a){this.min=i,this.max=a,this.center=function(d,p,v){return d[0]=.5*p[0],d[1]=.5*p[1],d[2]=.5*p[2],d}([],function(d,p,v){return d[0]=p[0]+v[0],d[1]=p[1]+v[1],d[2]=p[2]+v[2],d}([],this.min,this.max))}quadrant(i){const a=[i%2==0,i<2],d=ne(this.min),p=ne(this.max);for(let v=0;v<a.length;v++)d[v]=a[v]?this.min[v]:this.center[v],p[v]=a[v]?this.center[v]:this.max[v];return p[2]=this.max[2],new bl(d,p)}distanceX(i){return Math.max(Math.min(this.max[0],i[0]),this.min[0])-i[0]}distanceY(i){return Math.max(Math.min(this.max[1],i[1]),this.min[1])-i[1]}intersects(i){const a=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let d=!0;for(let p=0;p<i.planes.length;p++){const v=i.planes[p];let w=0;for(let S=0;S<a.length;S++)c.b1(v,a[S])>=0&&w++;if(w===0)return 0;w!==a.length&&(d=!1)}if(d)return 2;for(let p=0;p<3;p++){let v=Number.MAX_VALUE,w=-Number.MAX_VALUE;for(let S=0;S<i.points.length;S++){const T=i.points[S][p]-this.min[p];v=Math.min(v,T),w=Math.max(w,T)}if(w<0||v>this.max[p]-this.min[p])return 0}return 1}}class Ea{constructor(i=0,a=0,d=0,p=0){if(isNaN(i)||i<0||isNaN(a)||a<0||isNaN(d)||d<0||isNaN(p)||p<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=i,this.bottom=a,this.left=d,this.right=p}interpolate(i,a,d){return a.top!=null&&i.top!=null&&(this.top=c.z.number(i.top,a.top,d)),a.bottom!=null&&i.bottom!=null&&(this.bottom=c.z.number(i.bottom,a.bottom,d)),a.left!=null&&i.left!=null&&(this.left=c.z.number(i.left,a.left,d)),a.right!=null&&i.right!=null&&(this.right=c.z.number(i.right,a.right,d)),this}getCenter(i,a){const d=c.ac((this.left+i-this.right)/2,0,i),p=c.ac((this.top+a-this.bottom)/2,0,a);return new c.P(d,p)}equals(i){return this.top===i.top&&this.bottom===i.bottom&&this.left===i.left&&this.right===i.right}clone(){return new Ea(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Is=85.051129;class Uc{constructor(i,a,d,p,v){this.tileSize=512,this._renderWorldCopies=v===void 0||!!v,this._minZoom=i||0,this._maxZoom=a||22,this._minPitch=d??0,this._maxPitch=p??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new c.M(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Ea,this._posMatrixCache={},this._alignedPosMatrixCache={},this.minElevationForCurrentTile=0}clone(){const i=new Uc(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return i.apply(this),i}apply(i){this.tileSize=i.tileSize,this.latRange=i.latRange,this.width=i.width,this.height=i.height,this._center=i._center,this._elevation=i._elevation,this.minElevationForCurrentTile=i.minElevationForCurrentTile,this.zoom=i.zoom,this.angle=i.angle,this._fov=i._fov,this._pitch=i._pitch,this._unmodified=i._unmodified,this._edgeInsets=i._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(i){this._minZoom!==i&&(this._minZoom=i,this.zoom=Math.max(this.zoom,i))}get maxZoom(){return this._maxZoom}set maxZoom(i){this._maxZoom!==i&&(this._maxZoom=i,this.zoom=Math.min(this.zoom,i))}get minPitch(){return this._minPitch}set minPitch(i){this._minPitch!==i&&(this._minPitch=i,this.pitch=Math.max(this.pitch,i))}get maxPitch(){return this._maxPitch}set maxPitch(i){this._maxPitch!==i&&(this._maxPitch=i,this.pitch=Math.min(this.pitch,i))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(i){i===void 0?i=!0:i===null&&(i=!1),this._renderWorldCopies=i}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new c.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(i){const a=-c.b2(i,-180,180)*Math.PI/180;this.angle!==a&&(this._unmodified=!1,this.angle=a,this._calcMatrices(),this.rotationMatrix=function(){var d=new c.A(4);return c.A!=Float32Array&&(d[1]=0,d[2]=0),d[0]=1,d[3]=1,d}(),function(d,p,v){var w=p[0],S=p[1],T=p[2],z=p[3],O=Math.sin(v),R=Math.cos(v);d[0]=w*R+T*O,d[1]=S*R+z*O,d[2]=w*-O+T*R,d[3]=S*-O+z*R}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(i){const a=c.ac(i,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==a&&(this._unmodified=!1,this._pitch=a,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(i){i=Math.max(.01,Math.min(60,i)),this._fov!==i&&(this._unmodified=!1,this._fov=i/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(i){const a=Math.min(Math.max(i,this.minZoom),this.maxZoom);this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this.tileZoom=Math.max(0,Math.floor(a)),this.scale=this.zoomScale(a),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(i){i.lat===this._center.lat&&i.lng===this._center.lng||(this._unmodified=!1,this._center=i,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(i){i!==this._elevation&&(this._elevation=i,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(i){this._edgeInsets.equals(i)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,i,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(i){return this._edgeInsets.equals(i)}interpolatePadding(i,a,d){this._unmodified=!1,this._edgeInsets.interpolate(i,a,d),this._constrain(),this._calcMatrices()}coveringZoomLevel(i){const a=(i.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/i.tileSize));return Math.max(0,a)}getVisibleUnwrappedCoordinates(i){const a=[new c.b3(0,i)];if(this._renderWorldCopies){const d=this.pointCoordinate(new c.P(0,0)),p=this.pointCoordinate(new c.P(this.width,0)),v=this.pointCoordinate(new c.P(this.width,this.height)),w=this.pointCoordinate(new c.P(0,this.height)),S=Math.floor(Math.min(d.x,p.x,v.x,w.x)),T=Math.floor(Math.max(d.x,p.x,v.x,w.x)),z=1;for(let O=S-z;O<=T+z;O++)O!==0&&a.push(new c.b3(O,i))}return a}coveringTiles(i){var a,d;let p=this.coveringZoomLevel(i);const v=p;if(i.minzoom!==void 0&&p<i.minzoom)return[];i.maxzoom!==void 0&&p>i.maxzoom&&(p=i.maxzoom);const w=this.pointCoordinate(this.getCameraPoint()),S=c.Y.fromLngLat(this.center),T=Math.pow(2,p),z=[T*w.x,T*w.y,0],O=[T*S.x,T*S.y,0],R=Ss.fromInvProjectionMatrix(this.invModelViewProjectionMatrix,this.worldSize,p);let $=i.minzoom||0;!i.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&($=p);const G=i.terrain?2/Math.min(this.tileSize,i.tileSize)*this.tileSize:3,K=te=>({aabb:new bl([te*T,0,0],[(te+1)*T,T,0]),zoom:0,x:0,y:0,wrap:te,fullyVisible:!1}),re=[],J=[],ue=p,ge=i.reparseOverscaled?v:p;if(this._renderWorldCopies)for(let te=1;te<=3;te++)re.push(K(-te)),re.push(K(te));for(re.push(K(0));re.length>0;){const te=re.pop(),ve=te.x,Se=te.y;let Pe=te.fullyVisible;if(!Pe){const Je=te.aabb.intersects(R);if(Je===0)continue;Pe=Je===2}const Ne=i.terrain?z:O,Xe=te.aabb.distanceX(Ne),ut=te.aabb.distanceY(Ne),ht=Math.max(Math.abs(Xe),Math.abs(ut));if(te.zoom===ue||ht>G+(1<<ue-te.zoom)-2&&te.zoom>=$){const Je=ue-te.zoom,et=z[0]-.5-(ve<<Je),yt=z[1]-.5-(Se<<Je);J.push({tileID:new c.Q(te.zoom===ue?ge:te.zoom,te.wrap,te.zoom,ve,Se),distanceSq:be([O[0]-.5-ve,O[1]-.5-Se]),tileDistanceToCamera:Math.sqrt(et*et+yt*yt)})}else for(let Je=0;Je<4;Je++){const et=(ve<<1)+Je%2,yt=(Se<<1)+(Je>>1),Ot=te.zoom+1;let it=te.aabb.quadrant(Je);if(i.terrain){const at=new c.Q(Ot,te.wrap,Ot,et,yt),Pt=i.terrain.getMinMaxElevation(at),Ci=(a=Pt.minElevation)!==null&&a!==void 0?a:this.elevation,Wt=(d=Pt.maxElevation)!==null&&d!==void 0?d:this.elevation;it=new bl([it.min[0],it.min[1],Ci],[it.max[0],it.max[1],Wt])}re.push({aabb:it,zoom:Ot,x:et,y:yt,wrap:te.wrap,fullyVisible:Pe})}}return J.sort((te,ve)=>te.distanceSq-ve.distanceSq).map(te=>te.tileID)}resize(i,a){this.width=i,this.height=a,this.pixelsToGLUnits=[2/i,-2/a],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(i){return Math.pow(2,i)}scaleZoom(i){return Math.log(i)/Math.LN2}project(i){const a=c.ac(i.lat,-85.051129,Is);return new c.P(c.N(i.lng)*this.worldSize,c.O(a)*this.worldSize)}unproject(i){return new c.Y(i.x/this.worldSize,i.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(i){const a=this.elevation,d=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,p=this.pointLocation(this.centerPoint,i),v=i.getElevationForLngLatZoom(p,this.tileZoom);if(!(this.elevation-v))return;const w=d+a-v,S=Math.cos(this._pitch)*this.cameraToCenterDistance/w/c.b4(1,p.lat),T=this.scaleZoom(S/this.tileSize);this._elevation=v,this._center=p,this.zoom=T}setLocationAtPoint(i,a){const d=this.pointCoordinate(a),p=this.pointCoordinate(this.centerPoint),v=this.locationCoordinate(i),w=new c.Y(v.x-(d.x-p.x),v.y-(d.y-p.y));this.center=this.coordinateLocation(w),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(i,a){return a?this.coordinatePoint(this.locationCoordinate(i),a.getElevationForLngLatZoom(i,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(i))}pointLocation(i,a){return this.coordinateLocation(this.pointCoordinate(i,a))}locationCoordinate(i){return c.Y.fromLngLat(i)}coordinateLocation(i){return i&&i.toLngLat()}pointCoordinate(i,a){if(a){const $=a.pointCoordinate(i);if($!=null)return $}const d=[i.x,i.y,0,1],p=[i.x,i.y,1,1];c.af(d,d,this.pixelMatrixInverse),c.af(p,p,this.pixelMatrixInverse);const v=d[3],w=p[3],S=d[1]/v,T=p[1]/w,z=d[2]/v,O=p[2]/w,R=z===O?0:(0-z)/(O-z);return new c.Y(c.z.number(d[0]/v,p[0]/w,R)/this.worldSize,c.z.number(S,T,R)/this.worldSize)}coordinatePoint(i,a=0,d=this.pixelMatrix){const p=[i.x*this.worldSize,i.y*this.worldSize,a,1];return c.af(p,p,d),new c.P(p[0]/p[3],p[1]/p[3])}getBounds(){const i=Math.max(0,this.height/2-this.getHorizon());return new ye().extend(this.pointLocation(new c.P(0,i))).extend(this.pointLocation(new c.P(this.width,i))).extend(this.pointLocation(new c.P(this.width,this.height))).extend(this.pointLocation(new c.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new ye([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(i){i?(this.lngRange=[i.getWest(),i.getEast()],this.latRange=[i.getSouth(),i.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,Is])}calculatePosMatrix(i,a=!1){const d=i.key,p=a?this._alignedPosMatrixCache:this._posMatrixCache;if(p[d])return p[d];const v=i.canonical,w=this.worldSize/this.zoomScale(v.z),S=v.x+Math.pow(2,v.z)*i.wrap,T=c.an(new Float64Array(16));return c.H(T,T,[S*w,v.y*w,0]),c.J(T,T,[w/c.W,w/c.W,1]),c.K(T,a?this.alignedModelViewProjectionMatrix:this.modelViewProjectionMatrix,T),p[d]=new Float32Array(T),p[d]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(i,a){a=c.ac(+a,this.minZoom,this.maxZoom);const d={center:new c.M(i.lng,i.lat),zoom:a};let p=this.lngRange;if(!this._renderWorldCopies&&p===null){const te=179.9999999999;p=[-te,te]}const v=this.tileSize*this.zoomScale(d.zoom);let w=0,S=v,T=0,z=v,O=0,R=0;const{x:$,y:G}=this.size;if(this.latRange){const te=this.latRange;w=c.O(te[1])*v,S=c.O(te[0])*v,S-w<G&&(O=G/(S-w))}p&&(T=c.b2(c.N(p[0])*v,0,v),z=c.b2(c.N(p[1])*v,0,v),z<T&&(z+=v),z-T<$&&(R=$/(z-T)));const{x:K,y:re}=this.project.call({worldSize:v},i);let J,ue;const ge=Math.max(R||0,O||0);if(ge){const te=new c.P(R?(z+T)/2:K,O?(S+w)/2:re);return d.center=this.unproject.call({worldSize:v},te).wrap(),d.zoom+=this.scaleZoom(ge),d}if(this.latRange){const te=G/2;re-te<w&&(ue=w+te),re+te>S&&(ue=S-te)}if(p){const te=(T+z)/2;let ve=K;this._renderWorldCopies&&(ve=c.b2(K,te-v/2,te+v/2));const Se=$/2;ve-Se<T&&(J=T+Se),ve+Se>z&&(J=z-Se)}if(J!==void 0||ue!==void 0){const te=new c.P(J??K,ue??re);d.center=this.unproject.call({worldSize:v},te).wrap()}return d}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const i=this._unmodified,{center:a,zoom:d}=this.getConstrained(this.center,this.zoom);this.center=a,this.zoom=d,this._unmodified=i,this._constraining=!1}_calcMatrices(){if(!this.height)return;const i=this.centerOffset,a=this.point.x,d=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=c.b4(1,this.center.lat)*this.worldSize;let p=c.an(new Float64Array(16));c.J(p,p,[this.width/2,-this.height/2,1]),c.H(p,p,[1,-1,0]),this.labelPlaneMatrix=p,p=c.an(new Float64Array(16)),c.J(p,p,[1,-1,1]),c.H(p,p,[-1,-1,0]),c.J(p,p,[2/this.width,2/this.height,1]),this.glCoordMatrix=p;const v=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),w=Math.min(this.elevation,this.minElevationForCurrentTile),S=v-w*this._pixelPerMeter/Math.cos(this._pitch),T=w<0?S:v,z=Math.PI/2+this._pitch,O=this._fov*(.5+i.y/this.height),R=Math.sin(O)*T/Math.sin(c.ac(Math.PI-z-O,.01,Math.PI-.01)),$=this.getHorizon(),G=2*Math.atan($/this.cameraToCenterDistance)*(.5+i.y/(2*$)),K=Math.sin(G)*T/Math.sin(c.ac(Math.PI-z-G,.01,Math.PI-.01)),re=Math.min(R,K),J=1.01*(Math.cos(Math.PI/2-this._pitch)*re+T),ue=this.height/50;p=new Float64Array(16),c.b5(p,this._fov,this.width/this.height,ue,J),p[8]=2*-i.x/this.width,p[9]=2*i.y/this.height,c.J(p,p,[1,-1,1]),c.H(p,p,[0,0,-this.cameraToCenterDistance]),c.b6(p,p,this._pitch),c.ad(p,p,this.angle),c.H(p,p,[-a,-d,0]),this.mercatorMatrix=c.J([],p,[this.worldSize,this.worldSize,this.worldSize]),c.J(p,p,[1,1,this._pixelPerMeter]),this.pixelMatrix=c.K(new Float64Array(16),this.labelPlaneMatrix,p),c.H(p,p,[0,0,-this.elevation]),this.modelViewProjectionMatrix=p,this.invModelViewProjectionMatrix=c.as([],p),this.pixelMatrix3D=c.K(new Float64Array(16),this.labelPlaneMatrix,p);const ge=this.width%2/2,te=this.height%2/2,ve=Math.cos(this.angle),Se=Math.sin(this.angle),Pe=a-Math.round(a)+ve*ge+Se*te,Ne=d-Math.round(d)+ve*te+Se*ge,Xe=new Float64Array(p);if(c.H(Xe,Xe,[Pe>.5?Pe-1:Pe,Ne>.5?Ne-1:Ne,0]),this.alignedModelViewProjectionMatrix=Xe,p=c.as(new Float64Array(16),this.pixelMatrix),!p)throw new Error("failed to invert matrix");this.pixelMatrixInverse=p,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const i=this.pointCoordinate(new c.P(0,0)),a=[i.x*this.worldSize,i.y*this.worldSize,0,1];return c.af(a,a,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const i=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.P(0,i))}getCameraQueryGeometry(i){const a=this.getCameraPoint();if(i.length===1)return[i[0],a];{let d=a.x,p=a.y,v=a.x,w=a.y;for(const S of i)d=Math.min(d,S.x),p=Math.min(p,S.y),v=Math.max(v,S.x),w=Math.max(w,S.y);return[new c.P(d,p),new c.P(v,p),new c.P(v,w),new c.P(d,w),new c.P(d,p)]}}lngLatToCameraDepth(i,a){const d=this.locationCoordinate(i),p=[d.x*this.worldSize,d.y*this.worldSize,a,1];return c.af(p,p,this.modelViewProjectionMatrix),p[2]/p[3]}}function $h(_,i){let a,d=!1,p=null,v=null;const w=()=>{p=null,d&&(_.apply(v,a),p=setTimeout(w,i),d=!1)};return(...S)=>(d=!0,v=this,a=S,p||w(),p)}class qc{constructor(i){this._getCurrentHash=()=>{const a=window.location.hash.replace("#","");if(this._hashName){let d;return a.split("&").map(p=>p.split("=")).forEach(p=>{p[0]===this._hashName&&(d=p)}),(d&&d[1]||"").split("/")}return a.split("/")},this._onHashChange=()=>{const a=this._getCurrentHash();if(a.length>=3&&!a.some(d=>isNaN(d))){const d=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(a[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+a[2],+a[1]],zoom:+a[0],bearing:d,pitch:+(a[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const a=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,a)}catch{}},this._updateHash=$h(this._updateHashUnthrottled,300),this._hashName=i&&encodeURIComponent(i)}addTo(i){return this._map=i,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(i){const a=this._map.getCenter(),d=Math.round(100*this._map.getZoom())/100,p=Math.ceil((d*Math.LN2+Math.log(512/360/.5))/Math.LN10),v=Math.pow(10,p),w=Math.round(a.lng*v)/v,S=Math.round(a.lat*v)/v,T=this._map.getBearing(),z=this._map.getPitch();let O="";if(O+=i?`/${w}/${S}/${d}`:`${d}/${S}/${w}`,(T||z)&&(O+="/"+Math.round(10*T)/10),z&&(O+=`/${Math.round(z)}`),this._hashName){const R=this._hashName;let $=!1;const G=window.location.hash.slice(1).split("&").map(K=>{const re=K.split("=")[0];return re===R?($=!0,`${re}=${O}`):K}).filter(K=>K);return $||G.push(`${R}=${O}`),`#${G.join("&")}`}return`#${O}`}}const wl={linearity:.3,easing:c.b7(0,0,.3,1)},Hc=c.e({deceleration:2500,maxSpeed:1400},wl),El=c.e({deceleration:20,maxSpeed:1400},wl),Sl=c.e({deceleration:1e3,maxSpeed:360},wl),Gc=c.e({deceleration:1e3,maxSpeed:90},wl);class Zc{constructor(i){this._map=i,this.clear()}clear(){this._inertiaBuffer=[]}record(i){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:C.now(),settings:i})}_drainInertiaBuffer(){const i=this._inertiaBuffer,a=C.now();for(;i.length>0&&a-i[0].time>160;)i.shift()}_onMoveEnd(i){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const a={zoom:0,bearing:0,pitch:0,pan:new c.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:v}of this._inertiaBuffer)a.zoom+=v.zoomDelta||0,a.bearing+=v.bearingDelta||0,a.pitch+=v.pitchDelta||0,v.panDelta&&a.pan._add(v.panDelta),v.around&&(a.around=v.around),v.pinchAround&&(a.pinchAround=v.pinchAround);const d=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,p={};if(a.pan.mag()){const v=Xo(a.pan.mag(),d,c.e({},Hc,i||{}));p.offset=a.pan.mult(v.amount/a.pan.mag()),p.center=this._map.transform.center,Sa(p,v)}if(a.zoom){const v=Xo(a.zoom,d,El);p.zoom=this._map.transform.zoom+v.amount,Sa(p,v)}if(a.bearing){const v=Xo(a.bearing,d,Sl);p.bearing=this._map.transform.bearing+c.ac(v.amount,-179,179),Sa(p,v)}if(a.pitch){const v=Xo(a.pitch,d,Gc);p.pitch=this._map.transform.pitch+v.amount,Sa(p,v)}if(p.zoom||p.bearing){const v=a.pinchAround===void 0?a.around:a.pinchAround;p.around=v?this._map.unproject(v):this._map.getCenter()}return this.clear(),c.e(p,{noMoveStart:!0})}}function Sa(_,i){(!_.duration||_.duration<i.duration)&&(_.duration=i.duration,_.easing=i.easing)}function Xo(_,i,a){const{maxSpeed:d,linearity:p,deceleration:v}=a,w=c.ac(_*p/(i/1e3),-d,d),S=Math.abs(w)/(v*p);return{easing:a.easing,duration:1e3*S,amount:w*(S/2)}}class Cr extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,a,d,p={}){const v=L.mousePos(a.getCanvas(),d),w=a.unproject(v);super(i,c.e({point:v,lngLat:w,originalEvent:d},p)),this._defaultPrevented=!1,this.target=a}}class Jo extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,a,d){const p=i==="touchend"?d.changedTouches:d.touches,v=L.touchPos(a.getCanvasContainer(),p),w=v.map(T=>a.unproject(T)),S=v.reduce((T,z,O,R)=>T.add(z.div(R.length)),new c.P(0,0));super(i,{points:v,point:S,lngLats:w,lngLat:a.unproject(S),originalEvent:d}),this._defaultPrevented=!1}}class jh extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,a,d){super(i,{originalEvent:d}),this._defaultPrevented=!1}}class Wc{constructor(i,a){this._map=i,this._clickTolerance=a.clickTolerance}reset(){delete this._mousedownPos}wheel(i){return this._firePreventable(new jh(i.type,this._map,i))}mousedown(i,a){return this._mousedownPos=a,this._firePreventable(new Cr(i.type,this._map,i))}mouseup(i){this._map.fire(new Cr(i.type,this._map,i))}click(i,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||this._map.fire(new Cr(i.type,this._map,i))}dblclick(i){return this._firePreventable(new Cr(i.type,this._map,i))}mouseover(i){this._map.fire(new Cr(i.type,this._map,i))}mouseout(i){this._map.fire(new Cr(i.type,this._map,i))}touchstart(i){return this._firePreventable(new Jo(i.type,this._map,i))}touchmove(i){this._map.fire(new Jo(i.type,this._map,i))}touchend(i){this._map.fire(new Jo(i.type,this._map,i))}touchcancel(i){this._map.fire(new Jo(i.type,this._map,i))}_firePreventable(i){if(this._map.fire(i),i.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class mp{constructor(i){this._map=i}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(i){this._map.fire(new Cr(i.type,this._map,i))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Cr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(i){this._delayContextMenu?this._contextMenuEvent=i:this._ignoreContextMenu||this._map.fire(new Cr(i.type,this._map,i)),this._map.listens("contextmenu")&&i.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ts{constructor(i){this._map=i}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(i){return this.transform.pointLocation(c.P.convert(i),this._map.terrain)}}class Ia{constructor(i,a){this._map=i,this._tr=new Ts(i),this._el=i.getCanvasContainer(),this._container=i.getContainer(),this._clickTolerance=a.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(i,a){this.isEnabled()&&i.shiftKey&&i.button===0&&(L.disableDrag(),this._startPos=this._lastPos=a,this._active=!0)}mousemoveWindow(i,a){if(!this._active)return;const d=a;if(this._lastPos.equals(d)||!this._box&&d.dist(this._startPos)<this._clickTolerance)return;const p=this._startPos;this._lastPos=d,this._box||(this._box=L.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",i));const v=Math.min(p.x,d.x),w=Math.max(p.x,d.x),S=Math.min(p.y,d.y),T=Math.max(p.y,d.y);L.setTransform(this._box,`translate(${v}px,${S}px)`),this._box.style.width=w-v+"px",this._box.style.height=T-S+"px"}mouseupWindow(i,a){if(!this._active||i.button!==0)return;const d=this._startPos,p=a;if(this.reset(),L.suppressClick(),d.x!==p.x||d.y!==p.y)return this._map.fire(new c.k("boxzoomend",{originalEvent:i})),{cameraAnimation:v=>v.fitScreenCoordinates(d,p,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",i)}keydown(i){this._active&&i.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",i))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(L.remove(this._box),this._box=null),L.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(i,a){return this._map.fire(new c.k(i,{originalEvent:a}))}}function Ta(_,i){if(_.length!==i.length)throw new Error(`The number of touches and points are not equal - touches ${_.length}, points ${i.length}`);const a={};for(let d=0;d<_.length;d++)a[_[d].identifier]=i[d];return a}class Uh{constructor(i){this.reset(),this.numTouches=i.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(i,a,d){(this.centroid||d.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=i.timeStamp),d.length===this.numTouches&&(this.centroid=function(p){const v=new c.P(0,0);for(const w of p)v._add(w);return v.div(p.length)}(a),this.touches=Ta(d,a)))}touchmove(i,a,d){if(this.aborted||!this.centroid)return;const p=Ta(d,a);for(const v in this.touches){const w=p[v];(!w||w.dist(this.touches[v])>30)&&(this.aborted=!0)}}touchend(i,a,d){if((!this.centroid||i.timeStamp-this.startTime>500)&&(this.aborted=!0),d.length===0){const p=!this.aborted&&this.centroid;if(this.reset(),p)return p}}}class Il{constructor(i){this.singleTap=new Uh(i),this.numTaps=i.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(i,a,d){this.singleTap.touchstart(i,a,d)}touchmove(i,a,d){this.singleTap.touchmove(i,a,d)}touchend(i,a,d){const p=this.singleTap.touchend(i,a,d);if(p){const v=i.timeStamp-this.lastTime<500,w=!this.lastTap||this.lastTap.dist(p)<30;if(v&&w||this.reset(),this.count++,this.lastTime=i.timeStamp,this.lastTap=p,this.count===this.numTaps)return this.reset(),p}}}class Tl{constructor(i){this._tr=new Ts(i),this._zoomIn=new Il({numTouches:1,numTaps:2}),this._zoomOut=new Il({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(i,a,d){this._zoomIn.touchstart(i,a,d),this._zoomOut.touchstart(i,a,d)}touchmove(i,a,d){this._zoomIn.touchmove(i,a,d),this._zoomOut.touchmove(i,a,d)}touchend(i,a,d){const p=this._zoomIn.touchend(i,a,d),v=this._zoomOut.touchend(i,a,d),w=this._tr;return p?(this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:w.zoom+1,around:w.unproject(p)},{originalEvent:i})}):v?(this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:w.zoom-1,around:w.unproject(v)},{originalEvent:i})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Yo{constructor(i){this._enabled=!!i.enable,this._moveStateManager=i.moveStateManager,this._clickTolerance=i.clickTolerance||1,this._moveFunction=i.move,this._activateOnStart=!!i.activateOnStart,i.assignEvents(this),this.reset()}reset(i){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(i)}_move(...i){const a=this._moveFunction(...i);if(a.bearingDelta||a.pitchDelta||a.around||a.panDelta)return this._active=!0,a}dragStart(i,a){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(i)&&(this._moveStateManager.startMove(i),this._lastPoint=a.length?a[0]:a,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(i,a){if(!this.isEnabled())return;const d=this._lastPoint;if(!d)return;if(i.preventDefault(),!this._moveStateManager.isValidMoveEvent(i))return void this.reset(i);const p=a.length?a[0]:a;return!this._moved&&p.dist(d)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=p,this._move(d,p))}dragEnd(i){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(i)&&(this._moved&&L.suppressClick(),this.reset(i))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const gp={0:1,2:2};class Cl{constructor(i){this._correctEvent=i.checkCorrectEvent}startMove(i){const a=L.mouseButton(i);this._eventButton=a}endMove(i){delete this._eventButton}isValidStartEvent(i){return this._correctEvent(i)}isValidMoveEvent(i){return!function(a,d){const p=gp[d];return a.buttons===void 0||(a.buttons&p)!==p}(i,this._eventButton)}isValidEndEvent(i){return L.mouseButton(i)===this._eventButton}}class Ui{constructor(){this._firstTouch=void 0}_isOneFingerTouch(i){return i.targetTouches.length===1}_isSameTouchEvent(i){return i.targetTouches[0].identifier===this._firstTouch}startMove(i){this._firstTouch=i.targetTouches[0].identifier}endMove(i){delete this._firstTouch}isValidStartEvent(i){return this._isOneFingerTouch(i)}isValidMoveEvent(i){return this._isOneFingerTouch(i)&&this._isSameTouchEvent(i)}isValidEndEvent(i){return this._isOneFingerTouch(i)&&this._isSameTouchEvent(i)}}const ao=_=>{_.mousedown=_.dragStart,_.mousemoveWindow=_.dragMove,_.mouseup=_.dragEnd,_.contextmenu=i=>{i.preventDefault()}},fn=({enable:_,clickTolerance:i,bearingDegreesPerPixelMoved:a=.8})=>{const d=new Cl({checkCorrectEvent:p=>L.mouseButton(p)===0&&p.ctrlKey||L.mouseButton(p)===2});return new Yo({clickTolerance:i,move:(p,v)=>({bearingDelta:(v.x-p.x)*a}),moveStateManager:d,enable:_,assignEvents:ao})},Al=({enable:_,clickTolerance:i,pitchDegreesPerPixelMoved:a=-.5})=>{const d=new Cl({checkCorrectEvent:p=>L.mouseButton(p)===0&&p.ctrlKey||L.mouseButton(p)===2});return new Yo({clickTolerance:i,move:(p,v)=>({pitchDelta:(v.y-p.y)*a}),moveStateManager:d,enable:_,assignEvents:ao})};class Kc{constructor(i,a){this._clickTolerance=i.clickTolerance||1,this._map=a,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new c.P(0,0)}minTouchs(){return this._map.cooperativeGestures.isEnabled()?2:1}touchstart(i,a,d){return this._calculateTransform(i,a,d)}touchmove(i,a,d){if(this._active&&!(d.length<this.minTouchs()))return i.preventDefault(),this._calculateTransform(i,a,d)}touchend(i,a,d){this._calculateTransform(i,a,d),this._active&&d.length<this.minTouchs()&&this.reset()}touchcancel(){this.reset()}_calculateTransform(i,a,d){d.length>0&&(this._active=!0);const p=Ta(d,a),v=new c.P(0,0),w=new c.P(0,0);let S=0;for(const z in p){const O=p[z],R=this._touches[z];R&&(v._add(O),w._add(O.sub(R)),S++,p[z]=O)}if(this._touches=p,S<this.minTouchs()||!w.mag())return;const T=w.div(S);return this._sum._add(T),this._sum.mag()<this._clickTolerance?void 0:{around:v.div(S),panDelta:T}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class kl{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(i,a,d){this._firstTwoTouches||d.length<2||(this._firstTwoTouches=[d[0].identifier,d[1].identifier],this._start([a[0],a[1]]))}touchmove(i,a,d){if(!this._firstTwoTouches)return;i.preventDefault();const[p,v]=this._firstTwoTouches,w=lo(d,a,p),S=lo(d,a,v);if(!w||!S)return;const T=this._aroundCenter?null:w.add(S).div(2);return this._move([w,S],T,i)}touchend(i,a,d){if(!this._firstTwoTouches)return;const[p,v]=this._firstTwoTouches,w=lo(d,a,p),S=lo(d,a,v);w&&S||(this._active&&L.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(i){this._enabled=!0,this._aroundCenter=!!i&&i.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function lo(_,i,a){for(let d=0;d<_.length;d++)if(_[d].identifier===a)return i[d]}function Cs(_,i){return Math.log(_/i)/Math.LN2}class Ml extends kl{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(i){this._startDistance=this._distance=i[0].dist(i[1])}_move(i,a){const d=this._distance;if(this._distance=i[0].dist(i[1]),this._active||!(Math.abs(Cs(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Cs(this._distance,d),pinchAround:a}}}function Xc(_,i){return 180*_.angleWith(i)/Math.PI}class Jc extends kl{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(i){this._startVector=this._vector=i[0].sub(i[1]),this._minDiameter=i[0].dist(i[1])}_move(i,a,d){const p=this._vector;if(this._vector=i[0].sub(i[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Xc(this._vector,p),pinchAround:a}}_isBelowThreshold(i){this._minDiameter=Math.min(this._minDiameter,i.mag());const a=25/(Math.PI*this._minDiameter)*360,d=Xc(i,this._startVector);return Math.abs(d)<a}}function Ll(_){return Math.abs(_.y)>Math.abs(_.x)}class Yc extends kl{constructor(i){super(),this._currentTouchCount=0,this._map=i}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(i,a,d){super.touchstart(i,a,d),this._currentTouchCount=d.length}_start(i){this._lastPoints=i,Ll(i[0].sub(i[1]))&&(this._valid=!1)}_move(i,a,d){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const p=i[0].sub(this._lastPoints[0]),v=i[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(p,v,d.timeStamp),this._valid?(this._lastPoints=i,this._active=!0,{pitchDelta:(p.y+v.y)/2*-.5}):void 0}gestureBeginsVertically(i,a,d){if(this._valid!==void 0)return this._valid;const p=i.mag()>=2,v=a.mag()>=2;if(!p&&!v)return;if(!p||!v)return this._firstMove===void 0&&(this._firstMove=d),d-this._firstMove<100&&void 0;const w=i.y>0==a.y>0;return Ll(i)&&Ll(a)&&w}}const qh={panStep:100,bearingStep:15,pitchStep:10};class xo{constructor(i){this._tr=new Ts(i);const a=qh;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(i){if(i.altKey||i.ctrlKey||i.metaKey)return;let a=0,d=0,p=0,v=0,w=0;switch(i.keyCode){case 61:case 107:case 171:case 187:a=1;break;case 189:case 109:case 173:a=-1;break;case 37:i.shiftKey?d=-1:(i.preventDefault(),v=-1);break;case 39:i.shiftKey?d=1:(i.preventDefault(),v=1);break;case 38:i.shiftKey?p=1:(i.preventDefault(),w=-1);break;case 40:i.shiftKey?p=-1:(i.preventDefault(),w=1);break;default:return}return this._rotationDisabled&&(d=0,p=0),{cameraAnimation:S=>{const T=this._tr;S.easeTo({duration:300,easeId:"keyboardHandler",easing:Hh,zoom:a?Math.round(T.zoom)+a*(i.shiftKey?2:1):T.zoom,bearing:T.bearing+d*this._bearingStep,pitch:T.pitch+p*this._pitchStep,offset:[-v*this._panStep,-w*this._panStep],center:T.center},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Hh(_){return _*(2-_)}const Qc=4.000244140625;class eu{constructor(i,a){this._onTimeout=d=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(d)},this._map=i,this._tr=new Ts(i),this._triggerRenderFrame=a,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(i){this._defaultZoomRate=i}setWheelZoomRate(i){this._wheelZoomRate=i}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(i){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!i&&i.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(i){if(!this.isEnabled()||this._map.cooperativeGestures.isEnabled()&&!i[this._map.cooperativeGestures._bypassKey])return;let a=i.deltaMode===WheelEvent.DOM_DELTA_LINE?40*i.deltaY:i.deltaY;const d=C.now(),p=d-(this._lastWheelEventTime||0);this._lastWheelEventTime=d,a!==0&&a%Qc==0?this._type="wheel":a!==0&&Math.abs(a)<4?this._type="trackpad":p>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,i)):this._type||(this._type=Math.abs(p*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),i.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=i,this._delta-=a,this._active||this._start(i)),i.preventDefault()}_start(i){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const a=L.mousePos(this._map.getCanvas(),i),d=this._tr;this._around=a.y>d.transform.height/2-d.transform.getHorizon()?c.M.convert(this._aroundCenter?d.center:d.unproject(a)):c.M.convert(d.center),this._aroundPoint=d.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const i=this._tr.transform;if(this._delta!==0){const S=this._type==="wheel"&&Math.abs(this._delta)>Qc?this._wheelZoomRate:this._defaultZoomRate;let T=2/(1+Math.exp(-Math.abs(this._delta*S)));this._delta<0&&T!==0&&(T=1/T);const z=typeof this._targetZoom=="number"?i.zoomScale(this._targetZoom):i.scale;this._targetZoom=Math.min(i.maxZoom,Math.max(i.minZoom,i.scaleZoom(z*T))),this._type==="wheel"&&(this._startZoom=i.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const a=typeof this._targetZoom=="number"?this._targetZoom:i.zoom,d=this._startZoom,p=this._easing;let v,w=!1;if(this._type==="wheel"&&d&&p){const S=Math.min((C.now()-this._lastWheelEventTime)/200,1),T=p(S);v=c.z.number(d,a,T),S<1?this._frameId||(this._frameId=!0):w=!0}else v=a,w=!0;return this._active=!0,w&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!w,zoomDelta:v-i.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(i){let a=c.b8;if(this._prevEase){const d=this._prevEase,p=(C.now()-d.start)/d.duration,v=d.easing(p+.01)-d.easing(p),w=.27/Math.sqrt(v*v+1e-4)*.01,S=Math.sqrt(.0729-w*w);a=c.b7(w,S,.25,1)}return this._prevEase={start:C.now(),duration:i,easing:a},a}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class tu{constructor(i,a){this._clickZoom=i,this._tapZoom=a}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Gh{constructor(i){this._tr=new Ts(i),this.reset()}reset(){this._active=!1}dblclick(i,a){return i.preventDefault(),{cameraAnimation:d=>{d.easeTo({duration:300,zoom:this._tr.zoom+(i.shiftKey?-1:1),around:this._tr.unproject(a)},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Zh{constructor(){this._tap=new Il({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(i,a,d){if(!this._swipePoint)if(this._tapTime){const p=a[0],v=i.timeStamp-this._tapTime<500,w=this._tapPoint.dist(p)<30;v&&w?d.length>0&&(this._swipePoint=p,this._swipeTouch=d[0].identifier):this.reset()}else this._tap.touchstart(i,a,d)}touchmove(i,a,d){if(this._tapTime){if(this._swipePoint){if(d[0].identifier!==this._swipeTouch)return;const p=a[0],v=p.y-this._swipePoint.y;return this._swipePoint=p,i.preventDefault(),this._active=!0,{zoomDelta:v/128}}}else this._tap.touchmove(i,a,d)}touchend(i,a,d){if(this._tapTime)this._swipePoint&&d.length===0&&this.reset();else{const p=this._tap.touchend(i,a,d);p&&(this._tapTime=i.timeStamp,this._tapPoint=p)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class iu{constructor(i,a,d){this._el=i,this._mousePan=a,this._touchPan=d}enable(i){this._inertiaOptions=i||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class As{constructor(i,a,d){this._pitchWithRotate=i.pitchWithRotate,this._mouseRotate=a,this._mousePitch=d}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class ru{constructor(i,a,d,p){this._el=i,this._touchZoom=a,this._touchRotate=d,this._tapDragZoom=p,this._rotationDisabled=!1,this._enabled=!0}enable(i){this._touchZoom.enable(i),this._rotationDisabled||this._touchRotate.enable(i),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class vn{constructor(i,a){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=i,this._options=a,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const i=this._map.getCanvasContainer();i.classList.add("maplibregl-cooperative-gestures"),this._container=L.create("div","maplibregl-cooperative-gesture-screen",i);let a=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(a=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const d=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),p=document.createElement("div");p.className="maplibregl-desktop-message",p.textContent=a,this._container.appendChild(p);const v=document.createElement("div");v.className="maplibregl-mobile-message",v.textContent=d,this._container.appendChild(v),this._container.setAttribute("aria-hidden","true")}_destoryUI(){this._container&&(L.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destoryUI()}isEnabled(){return this._enabled}touchmove(i){this._onCooperativeGesture(i.touches.length===1)}wheel(i){this._map.scrollZoom.isEnabled()&&this._onCooperativeGesture(!i[this._bypassKey])}_onCooperativeGesture(i){this._enabled&&i&&(this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const pn=_=>_.zoom||_.drag||_.pitch||_.rotate;class Wh extends c.k{}function xn(_){return _.panDelta&&_.panDelta.mag()||_.zoomDelta||_.bearingDelta||_.pitchDelta}class Ca{constructor(i,a){this.handleWindowEvent=p=>{this.handleEvent(p,`${p.type}Window`)},this.handleEvent=(p,v)=>{if(p.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const w=p.type==="renderFrame"?void 0:p,S={needsRenderFrame:!1},T={},z={},O=p.touches,R=O?this._getMapTouches(O):void 0,$=R?L.touchPos(this._map.getCanvas(),R):L.mousePos(this._map.getCanvas(),p);for(const{handlerName:re,handler:J,allowed:ue}of this._handlers){if(!J.isEnabled())continue;let ge;this._blockedByActive(z,ue,re)?J.reset():J[v||p.type]&&(ge=J[v||p.type](p,$,R),this.mergeHandlerResult(S,T,ge,re,w),ge&&ge.needsRenderFrame&&this._triggerRenderFrame()),(ge||J.isActive())&&(z[re]=J)}const G={};for(const re in this._previousActiveHandlers)z[re]||(G[re]=w);this._previousActiveHandlers=z,(Object.keys(G).length||xn(S))&&(this._changes.push([S,T,G]),this._triggerRenderFrame()),(Object.keys(z).length||xn(S))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:K}=S;K&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],K(this._map))},this._map=i,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Zc(i),this._bearingSnap=a.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(a);const d=this._el;this._listeners=[[d,"touchstart",{passive:!0}],[d,"touchmove",{passive:!1}],[d,"touchend",void 0],[d,"touchcancel",void 0],[d,"mousedown",void 0],[d,"mousemove",void 0],[d,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[d,"mouseover",void 0],[d,"mouseout",void 0],[d,"dblclick",void 0],[d,"click",void 0],[d,"keydown",{capture:!1}],[d,"keyup",void 0],[d,"wheel",{passive:!1}],[d,"contextmenu",void 0],[window,"blur",void 0]];for(const[p,v,w]of this._listeners)L.addEventListener(p,v,p===document?this.handleWindowEvent:this.handleEvent,w)}destroy(){for(const[i,a,d]of this._listeners)L.removeEventListener(i,a,i===document?this.handleWindowEvent:this.handleEvent,d)}_addDefaultHandlers(i){const a=this._map,d=a.getCanvasContainer();this._add("mapEvent",new Wc(a,i));const p=a.boxZoom=new Ia(a,i);this._add("boxZoom",p),i.interactive&&i.boxZoom&&p.enable();const v=a.cooperativeGestures=new vn(a,i.cooperativeGestures);this._add("cooperativeGestures",v),i.cooperativeGestures&&v.enable();const w=new Tl(a),S=new Gh(a);a.doubleClickZoom=new tu(S,w),this._add("tapZoom",w),this._add("clickZoom",S),i.interactive&&i.doubleClickZoom&&a.doubleClickZoom.enable();const T=new Zh;this._add("tapDragZoom",T);const z=a.touchPitch=new Yc(a);this._add("touchPitch",z),i.interactive&&i.touchPitch&&a.touchPitch.enable(i.touchPitch);const O=fn(i),R=Al(i);a.dragRotate=new As(i,O,R),this._add("mouseRotate",O,["mousePitch"]),this._add("mousePitch",R,["mouseRotate"]),i.interactive&&i.dragRotate&&a.dragRotate.enable();const $=(({enable:ge,clickTolerance:te})=>{const ve=new Cl({checkCorrectEvent:Se=>L.mouseButton(Se)===0&&!Se.ctrlKey});return new Yo({clickTolerance:te,move:(Se,Pe)=>({around:Pe,panDelta:Pe.sub(Se)}),activateOnStart:!0,moveStateManager:ve,enable:ge,assignEvents:ao})})(i),G=new Kc(i,a);a.dragPan=new iu(d,$,G),this._add("mousePan",$),this._add("touchPan",G,["touchZoom","touchRotate"]),i.interactive&&i.dragPan&&a.dragPan.enable(i.dragPan);const K=new Jc,re=new Ml;a.touchZoomRotate=new ru(d,re,K,T),this._add("touchRotate",K,["touchPan","touchZoom"]),this._add("touchZoom",re,["touchPan","touchRotate"]),i.interactive&&i.touchZoomRotate&&a.touchZoomRotate.enable(i.touchZoomRotate);const J=a.scrollZoom=new eu(a,()=>this._triggerRenderFrame());this._add("scrollZoom",J,["mousePan"]),i.interactive&&i.scrollZoom&&a.scrollZoom.enable(i.scrollZoom);const ue=a.keyboard=new xo(a);this._add("keyboard",ue),i.interactive&&i.keyboard&&a.keyboard.enable(),this._add("blockableMapEvent",new mp(a))}_add(i,a,d){this._handlers.push({handlerName:i,handler:a,allowed:d}),this._handlersById[i]=a}stop(i){if(!this._updatingCamera){for(const{handler:a}of this._handlers)a.reset();this._inertia.clear(),this._fireEvents({},{},i),this._changes=[]}}isActive(){for(const{handler:i}of this._handlers)if(i.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!pn(this._eventsInProgress)||this.isZooming()}_blockedByActive(i,a,d){for(const p in i)if(p!==d&&(!a||a.indexOf(p)<0))return!0;return!1}_getMapTouches(i){const a=[];for(const d of i)this._el.contains(d.target)&&a.push(d);return a}mergeHandlerResult(i,a,d,p,v){if(!d)return;c.e(i,d);const w={handlerName:p,originalEvent:d.originalEvent||v};d.zoomDelta!==void 0&&(a.zoom=w),d.panDelta!==void 0&&(a.drag=w),d.pitchDelta!==void 0&&(a.pitch=w),d.bearingDelta!==void 0&&(a.rotate=w)}_applyChanges(){const i={},a={},d={};for(const[p,v,w]of this._changes)p.panDelta&&(i.panDelta=(i.panDelta||new c.P(0,0))._add(p.panDelta)),p.zoomDelta&&(i.zoomDelta=(i.zoomDelta||0)+p.zoomDelta),p.bearingDelta&&(i.bearingDelta=(i.bearingDelta||0)+p.bearingDelta),p.pitchDelta&&(i.pitchDelta=(i.pitchDelta||0)+p.pitchDelta),p.around!==void 0&&(i.around=p.around),p.pinchAround!==void 0&&(i.pinchAround=p.pinchAround),p.noInertia&&(i.noInertia=p.noInertia),c.e(a,v),c.e(d,w);this._updateMapTransform(i,a,d),this._changes=[]}_updateMapTransform(i,a,d){const p=this._map,v=p._getTransformForUpdate(),w=p.terrain;if(!(xn(i)||w&&this._terrainMovement))return this._fireEvents(a,d,!0);let{panDelta:S,zoomDelta:T,bearingDelta:z,pitchDelta:O,around:R,pinchAround:$}=i;$!==void 0&&(R=$),p._stop(!0),R=R||p.transform.centerPoint;const G=v.pointLocation(S?R.sub(S):R);z&&(v.bearing+=z),O&&(v.pitch+=O),T&&(v.zoom+=T),w?this._terrainMovement||!a.drag&&!a.zoom?a.drag&&this._terrainMovement?v.center=v.pointLocation(v.centerPoint.sub(S)):v.setLocationAtPoint(G,R):(this._terrainMovement=!0,this._map._elevationFreeze=!0,v.setLocationAtPoint(G,R)):v.setLocationAtPoint(G,R),p._applyUpdatedTransform(v),this._map._update(),i.noInertia||this._inertia.record(i),this._fireEvents(a,d,!0)}_fireEvents(i,a,d){const p=pn(this._eventsInProgress),v=pn(i),w={};for(const R in i){const{originalEvent:$}=i[R];this._eventsInProgress[R]||(w[`${R}start`]=$),this._eventsInProgress[R]=i[R]}!p&&v&&this._fireEvent("movestart",v.originalEvent);for(const R in w)this._fireEvent(R,w[R]);v&&this._fireEvent("move",v.originalEvent);for(const R in i){const{originalEvent:$}=i[R];this._fireEvent(R,$)}const S={};let T;for(const R in this._eventsInProgress){const{handlerName:$,originalEvent:G}=this._eventsInProgress[R];this._handlersById[$].isActive()||(delete this._eventsInProgress[R],T=a[$]||G,S[`${R}end`]=T)}for(const R in S)this._fireEvent(R,S[R]);const z=pn(this._eventsInProgress),O=(p||v)&&!z;if(O&&this._terrainMovement&&(this._map._elevationFreeze=!1,this._terrainMovement=!1,this._map.transform.recalculateZoom(this._map.terrain)),d&&O){this._updatingCamera=!0;const R=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),$=G=>G!==0&&-this._bearingSnap<G&&G<this._bearingSnap;!R||!R.essential&&C.prefersReducedMotion?(this._map.fire(new c.k("moveend",{originalEvent:T})),$(this._map.getBearing())&&this._map.resetNorth()):($(R.bearing||this._map.getBearing())&&(R.bearing=0),R.freezeElevation=!0,this._map.easeTo(R,{originalEvent:T})),this._updatingCamera=!1}}_fireEvent(i,a){this._map.fire(new c.k(i,a?{originalEvent:a}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(i=>{delete this._frameId,this.handleEvent(new Wh("renderFrame",{timeStamp:i})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class yp extends c.E{constructor(i,a){super(),this._renderFrameCallback=()=>{const d=Math.min((C.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(d)),d<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=i,this._bearingSnap=a.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new c.M(this.transform.center.lng,this.transform.center.lat)}setCenter(i,a){return this.jumpTo({center:i},a)}panBy(i,a,d){return i=c.P.convert(i).mult(-1),this.panTo(this.transform.center,c.e({offset:i},a),d)}panTo(i,a,d){return this.easeTo(c.e({center:i},a),d)}getZoom(){return this.transform.zoom}setZoom(i,a){return this.jumpTo({zoom:i},a),this}zoomTo(i,a,d){return this.easeTo(c.e({zoom:i},a),d)}zoomIn(i,a){return this.zoomTo(this.getZoom()+1,i,a),this}zoomOut(i,a){return this.zoomTo(this.getZoom()-1,i,a),this}getBearing(){return this.transform.bearing}setBearing(i,a){return this.jumpTo({bearing:i},a),this}getPadding(){return this.transform.padding}setPadding(i,a){return this.jumpTo({padding:i},a),this}rotateTo(i,a,d){return this.easeTo(c.e({bearing:i},a),d)}resetNorth(i,a){return this.rotateTo(0,c.e({duration:1e3},i),a),this}resetNorthPitch(i,a){return this.easeTo(c.e({bearing:0,pitch:0,duration:1e3},i),a),this}snapToNorth(i,a){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(i,a):this}getPitch(){return this.transform.pitch}setPitch(i,a){return this.jumpTo({pitch:i},a),this}cameraForBounds(i,a){i=ye.convert(i);const d=a&&a.bearing||0;return this._cameraForBoxAndBearing(i.getNorthWest(),i.getSouthEast(),d,a)}_cameraForBoxAndBearing(i,a,d,p){const v={top:0,bottom:0,right:0,left:0};if(typeof(p=c.e({padding:v,offset:[0,0],maxZoom:this.transform.maxZoom},p)).padding=="number"){const Je=p.padding;p.padding={top:Je,bottom:Je,right:Je,left:Je}}p.padding=c.e(v,p.padding);const w=this.transform,S=w.padding,T=new ye(i,a),z=w.project(T.getNorthWest()),O=w.project(T.getNorthEast()),R=w.project(T.getSouthEast()),$=w.project(T.getSouthWest()),G=c.b9(-d),K=z.rotate(G),re=O.rotate(G),J=R.rotate(G),ue=$.rotate(G),ge=new c.P(Math.max(K.x,re.x,ue.x,J.x),Math.max(K.y,re.y,ue.y,J.y)),te=new c.P(Math.min(K.x,re.x,ue.x,J.x),Math.min(K.y,re.y,ue.y,J.y)),ve=ge.sub(te),Se=(w.width-(S.left+S.right+p.padding.left+p.padding.right))/ve.x,Pe=(w.height-(S.top+S.bottom+p.padding.top+p.padding.bottom))/ve.y;if(Pe<0||Se<0)return void c.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Ne=Math.min(w.scaleZoom(w.scale*Math.min(Se,Pe)),p.maxZoom),Xe=c.P.convert(p.offset),ut=new c.P((p.padding.left-p.padding.right)/2,(p.padding.top-p.padding.bottom)/2).rotate(c.b9(d)),ht=Xe.add(ut).mult(w.scale/w.zoomScale(Ne));return{center:w.unproject(z.add(R).div(2).sub(ht)),zoom:Ne,bearing:d}}fitBounds(i,a,d){return this._fitInternal(this.cameraForBounds(i,a),a,d)}fitScreenCoordinates(i,a,d,p,v){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(c.P.convert(i)),this.transform.pointLocation(c.P.convert(a)),d,p),p,v)}_fitInternal(i,a,d){return i?(delete(a=c.e(i,a)).padding,a.linear?this.easeTo(a,d):this.flyTo(a,d)):this}jumpTo(i,a){this.stop();const d=this._getTransformForUpdate();let p=!1,v=!1,w=!1;return"zoom"in i&&d.zoom!==+i.zoom&&(p=!0,d.zoom=+i.zoom),i.center!==void 0&&(d.center=c.M.convert(i.center)),"bearing"in i&&d.bearing!==+i.bearing&&(v=!0,d.bearing=+i.bearing),"pitch"in i&&d.pitch!==+i.pitch&&(w=!0,d.pitch=+i.pitch),i.padding==null||d.isPaddingEqual(i.padding)||(d.padding=i.padding),this._applyUpdatedTransform(d),this.fire(new c.k("movestart",a)).fire(new c.k("move",a)),p&&this.fire(new c.k("zoomstart",a)).fire(new c.k("zoom",a)).fire(new c.k("zoomend",a)),v&&this.fire(new c.k("rotatestart",a)).fire(new c.k("rotate",a)).fire(new c.k("rotateend",a)),w&&this.fire(new c.k("pitchstart",a)).fire(new c.k("pitch",a)).fire(new c.k("pitchend",a)),this.fire(new c.k("moveend",a))}calculateCameraOptionsFromTo(i,a,d,p=0){const v=c.Y.fromLngLat(i,a),w=c.Y.fromLngLat(d,p),S=w.x-v.x,T=w.y-v.y,z=w.z-v.z,O=Math.hypot(S,T,z);if(O===0)throw new Error("Can't calculate camera options with same From and To");const R=Math.hypot(S,T),$=this.transform.scaleZoom(this.transform.cameraToCenterDistance/O/this.transform.tileSize),G=180*Math.atan2(S,-T)/Math.PI;let K=180*Math.acos(R/O)/Math.PI;return K=z<0?90-K:90+K,{center:w.toLngLat(),zoom:$,pitch:K,bearing:G}}easeTo(i,a){var d;this._stop(!1,i.easeId),((i=c.e({offset:[0,0],duration:500,easing:c.b8},i)).animate===!1||!i.essential&&C.prefersReducedMotion)&&(i.duration=0);const p=this._getTransformForUpdate(),v=this.getZoom(),w=this.getBearing(),S=this.getPitch(),T=this.getPadding(),z="bearing"in i?this._normalizeBearing(i.bearing,w):w,O="pitch"in i?+i.pitch:S,R="padding"in i?i.padding:p.padding,$=c.P.convert(i.offset);let G=p.centerPoint.add($);const K=p.pointLocation(G),{center:re,zoom:J}=p.getConstrained(c.M.convert(i.center||K),(d=i.zoom)!==null&&d!==void 0?d:v);this._normalizeCenter(re);const ue=p.project(K),ge=p.project(re).sub(ue),te=p.zoomScale(J-v);let ve,Se;i.around&&(ve=c.M.convert(i.around),Se=p.locationPoint(ve));const Pe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||J!==v,this._rotating=this._rotating||w!==z,this._pitching=this._pitching||O!==S,this._padding=!p.isPaddingEqual(R),this._easeId=i.easeId,this._prepareEase(a,i.noMoveStart,Pe),this.terrain&&this._prepareElevation(re),this._ease(Ne=>{if(this._zooming&&(p.zoom=c.z.number(v,J,Ne)),this._rotating&&(p.bearing=c.z.number(w,z,Ne)),this._pitching&&(p.pitch=c.z.number(S,O,Ne)),this._padding&&(p.interpolatePadding(T,R,Ne),G=p.centerPoint.add($)),this.terrain&&!i.freezeElevation&&this._updateElevation(Ne),ve)p.setLocationAtPoint(ve,Se);else{const Xe=p.zoomScale(p.zoom-v),ut=J>v?Math.min(2,te):Math.max(.5,te),ht=Math.pow(ut,1-Ne),Je=p.unproject(ue.add(ge.mult(Ne*ht)).mult(Xe));p.setLocationAtPoint(p.renderWorldCopies?Je.wrap():Je,G)}this._applyUpdatedTransform(p),this._fireMoveEvents(a)},Ne=>{this.terrain&&i.freezeElevation&&this._finalizeElevation(),this._afterEase(a,Ne)},i),this}_prepareEase(i,a,d={}){this._moving=!0,a||d.moving||this.fire(new c.k("movestart",i)),this._zooming&&!d.zooming&&this.fire(new c.k("zoomstart",i)),this._rotating&&!d.rotating&&this.fire(new c.k("rotatestart",i)),this._pitching&&!d.pitching&&this.fire(new c.k("pitchstart",i))}_prepareElevation(i){this._elevationCenter=i,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(i,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(i){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const a=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(i<1&&a!==this._elevationTarget){const d=this._elevationTarget-this._elevationStart;this._elevationStart+=i*(d-(a-(d*i+this._elevationStart))/(1-i)),this._elevationTarget=a}this.transform.elevation=c.z.number(this._elevationStart,this._elevationTarget,i)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(i){if(!this.transformCameraUpdate)return;const a=i.clone(),{center:d,zoom:p,pitch:v,bearing:w,elevation:S}=this.transformCameraUpdate(a);d&&(a.center=d),p!==void 0&&(a.zoom=p),v!==void 0&&(a.pitch=v),w!==void 0&&(a.bearing=w),S!==void 0&&(a.elevation=S),this.transform.apply(a)}_fireMoveEvents(i){this.fire(new c.k("move",i)),this._zooming&&this.fire(new c.k("zoom",i)),this._rotating&&this.fire(new c.k("rotate",i)),this._pitching&&this.fire(new c.k("pitch",i))}_afterEase(i,a){if(this._easeId&&a&&this._easeId===a)return;delete this._easeId;const d=this._zooming,p=this._rotating,v=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,d&&this.fire(new c.k("zoomend",i)),p&&this.fire(new c.k("rotateend",i)),v&&this.fire(new c.k("pitchend",i)),this.fire(new c.k("moveend",i))}flyTo(i,a){var d;if(!i.essential&&C.prefersReducedMotion){const at=c.L(i,["center","zoom","bearing","pitch","around"]);return this.jumpTo(at,a)}this.stop(),i=c.e({offset:[0,0],speed:1.2,curve:1.42,easing:c.b8},i);const p=this._getTransformForUpdate(),v=this.getZoom(),w=this.getBearing(),S=this.getPitch(),T=this.getPadding(),z="bearing"in i?this._normalizeBearing(i.bearing,w):w,O="pitch"in i?+i.pitch:S,R="padding"in i?i.padding:p.padding,$=c.P.convert(i.offset);let G=p.centerPoint.add($);const K=p.pointLocation(G),{center:re,zoom:J}=p.getConstrained(c.M.convert(i.center||K),(d=i.zoom)!==null&&d!==void 0?d:v);this._normalizeCenter(re);const ue=p.zoomScale(J-v),ge=p.project(K),te=p.project(re).sub(ge);let ve=i.curve;const Se=Math.max(p.width,p.height),Pe=Se/ue,Ne=te.mag();if("minZoom"in i){const at=c.ac(Math.min(i.minZoom,v,J),p.minZoom,p.maxZoom),Pt=Se/p.zoomScale(at-v);ve=Math.sqrt(Pt/Ne*2)}const Xe=ve*ve;function ut(at){const Pt=(Pe*Pe-Se*Se+(at?-1:1)*Xe*Xe*Ne*Ne)/(2*(at?Pe:Se)*Xe*Ne);return Math.log(Math.sqrt(Pt*Pt+1)-Pt)}function ht(at){return(Math.exp(at)-Math.exp(-at))/2}function Je(at){return(Math.exp(at)+Math.exp(-at))/2}const et=ut(!1);let yt=function(at){return Je(et)/Je(et+ve*at)},Ot=function(at){return Se*((Je(et)*(ht(Pt=et+ve*at)/Je(Pt))-ht(et))/Xe)/Ne;var Pt},it=(ut(!0)-et)/ve;if(Math.abs(Ne)<1e-6||!isFinite(it)){if(Math.abs(Se-Pe)<1e-6)return this.easeTo(i,a);const at=Pe<Se?-1:1;it=Math.abs(Math.log(Pe/Se))/ve,Ot=()=>0,yt=Pt=>Math.exp(at*ve*Pt)}return i.duration="duration"in i?+i.duration:1e3*it/("screenSpeed"in i?+i.screenSpeed/ve:+i.speed),i.maxDuration&&i.duration>i.maxDuration&&(i.duration=0),this._zooming=!0,this._rotating=w!==z,this._pitching=O!==S,this._padding=!p.isPaddingEqual(R),this._prepareEase(a,!1),this.terrain&&this._prepareElevation(re),this._ease(at=>{const Pt=at*it,Ci=1/yt(Pt);p.zoom=at===1?J:v+p.scaleZoom(Ci),this._rotating&&(p.bearing=c.z.number(w,z,at)),this._pitching&&(p.pitch=c.z.number(S,O,at)),this._padding&&(p.interpolatePadding(T,R,at),G=p.centerPoint.add($)),this.terrain&&!i.freezeElevation&&this._updateElevation(at);const Wt=at===1?re:p.unproject(ge.add(te.mult(Ot(Pt))).mult(Ci));p.setLocationAtPoint(p.renderWorldCopies?Wt.wrap():Wt,G),this._applyUpdatedTransform(p),this._fireMoveEvents(a)},()=>{this.terrain&&i.freezeElevation&&this._finalizeElevation(),this._afterEase(a)},i),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(i,a){var d;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const p=this._onEaseEnd;delete this._onEaseEnd,p.call(this,a)}return i||(d=this.handlers)===null||d===void 0||d.stop(!1),this}_ease(i,a,d){d.animate===!1||d.duration===0?(i(1),a()):(this._easeStart=C.now(),this._easeOptions=d,this._onEaseFrame=i,this._onEaseEnd=a,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(i,a){i=c.b2(i,-180,180);const d=Math.abs(i-a);return Math.abs(i-360-a)<d&&(i-=360),Math.abs(i+360-a)<d&&(i+=360),i}_normalizeCenter(i){const a=this.transform;if(!a.renderWorldCopies||a.lngRange)return;const d=i.lng-a.center.lng;i.lng+=d>180?-360:d<-180?360:0}queryTerrainElevation(i){return this.terrain?this.terrain.getElevationForLngLatZoom(c.M.convert(i),this.transform.tileZoom)-this.transform.elevation:null}}const Kh={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Xh{constructor(i=Kh){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=a=>{!a||a.sourceDataType!=="metadata"&&a.sourceDataType!=="visibility"&&a.dataType!=="style"&&a.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=i}getDefaultPosition(){return"bottom-right"}onAdd(i){return this._map=i,this._compact=this.options.compact,this._container=L.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=L.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=L.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){L.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(i,a){const d=this._map._getUIString(`AttributionControl.${a}`);i.title=d,i.setAttribute("aria-label",d)}_updateAttributions(){if(!this._map.style)return;let i=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?i=i.concat(this.options.customAttribution.map(p=>typeof p!="string"?"":p)):typeof this.options.customAttribution=="string"&&i.push(this.options.customAttribution)),this._map.style.stylesheet){const p=this._map.style.stylesheet;this.styleOwner=p.owner,this.styleId=p.id}const a=this._map.style.sourceCaches;for(const p in a){const v=a[p];if(v.used||v.usedForTerrain){const w=v.getSource();w.attribution&&i.indexOf(w.attribution)<0&&i.push(w.attribution)}}i=i.filter(p=>String(p).trim()),i.sort((p,v)=>p.length-v.length),i=i.filter((p,v)=>{for(let w=v+1;w<i.length;w++)if(i[w].indexOf(p)>=0)return!1;return!0});const d=i.join(" | ");d!==this._attribHTML&&(this._attribHTML=d,i.length?(this._innerContainer.innerHTML=d,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class nu{constructor(i={}){this._updateCompact=()=>{const a=this._container.children;if(a.length){const d=a[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&d.classList.add("maplibregl-compact"):d.classList.remove("maplibregl-compact")}},this.options=i}getDefaultPosition(){return"bottom-left"}onAdd(i){this._map=i,this._compact=this.options&&this.options.compact,this._container=L.create("div","maplibregl-ctrl");const a=L.create("a","maplibregl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://maplibre.org/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){L.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Aa{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(i){const a=++this._id;return this._queue.push({callback:i,id:a,cancelled:!1}),a}remove(i){const a=this._currentlyRunning,d=a?this._queue.concat(a):this._queue;for(const p of d)if(p.id===i)return void(p.cancelled=!0)}run(i=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const a=this._currentlyRunning=this._queue;this._queue=[];for(const d of a)if(!d.cancelled&&(d.callback(i),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var bo=c.X([{name:"a_pos3d",type:"Int16",components:3}]);class mt extends c.E{constructor(i){super(),this.sourceCache=i,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,i.usedForTerrain=!0,i.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(i,a){this.sourceCache.update(i,a),this._renderableTilesKeys=[];const d={};for(const p of i.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:a}))d[p.key]=!0,this._renderableTilesKeys.push(p.key),this._tiles[p.key]||(p.posMatrix=new Float64Array(16),c.aO(p.posMatrix,0,c.W,0,c.W,0,1),this._tiles[p.key]=new ai(p,this.tileSize));for(const p in this._tiles)d[p]||delete this._tiles[p]}freeRtt(i){for(const a in this._tiles){const d=this._tiles[a];(!i||d.tileID.equals(i)||d.tileID.isChildOf(i)||i.isChildOf(d.tileID))&&(d.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(i=>this.getTileByID(i))}getTileByID(i){return this._tiles[i]}getTerrainCoords(i){const a={};for(const d of this._renderableTilesKeys){const p=this._tiles[d].tileID;if(p.canonical.equals(i.canonical)){const v=i.clone();v.posMatrix=new Float64Array(16),c.aO(v.posMatrix,0,c.W,0,c.W,0,1),a[d]=v}else if(p.canonical.isChildOf(i.canonical)){const v=i.clone();v.posMatrix=new Float64Array(16);const w=p.canonical.z-i.canonical.z,S=p.canonical.x-(p.canonical.x>>w<<w),T=p.canonical.y-(p.canonical.y>>w<<w),z=c.W>>w;c.aO(v.posMatrix,0,z,0,z,0,1),c.H(v.posMatrix,v.posMatrix,[-S*z,-T*z,0]),a[d]=v}else if(i.canonical.isChildOf(p.canonical)){const v=i.clone();v.posMatrix=new Float64Array(16);const w=i.canonical.z-p.canonical.z,S=i.canonical.x-(i.canonical.x>>w<<w),T=i.canonical.y-(i.canonical.y>>w<<w),z=c.W>>w;c.aO(v.posMatrix,0,c.W,0,c.W,0,1),c.H(v.posMatrix,v.posMatrix,[S*z,T*z,0]),c.J(v.posMatrix,v.posMatrix,[1/2**w,1/2**w,0]),a[d]=v}}return a}getSourceTile(i,a){const d=this.sourceCache._source;let p=i.overscaledZ-this.deltaZoom;if(p>d.maxzoom&&(p=d.maxzoom),p<d.minzoom)return null;this._sourceTileCache[i.key]||(this._sourceTileCache[i.key]=i.scaledTo(p).key);let v=this.sourceCache.getTileByID(this._sourceTileCache[i.key]);if((!v||!v.dem)&&a)for(;p>=d.minzoom&&(!v||!v.dem);)v=this.sourceCache.getTileByID(i.scaledTo(p--).key);return v}tilesAfterTime(i=Date.now()){return Object.values(this._tiles).filter(a=>a.timeAdded>=i)}}class Jh{constructor(i,a,d){this.painter=i,this.sourceCache=new mt(a),this.options=d,this.exaggeration=typeof d.exaggeration=="number"?d.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(i,a,d,p=c.W){var v;if(!(a>=0&&a<p&&d>=0&&d<p))return 0;const w=this.getTerrainData(i),S=(v=w.tile)===null||v===void 0?void 0:v.dem;if(!S)return 0;const T=function(K,re,J){var ue=re[0],ge=re[1];return K[0]=J[0]*ue+J[4]*ge+J[12],K[1]=J[1]*ue+J[5]*ge+J[13],K}([],[a/p*c.W,d/p*c.W],w.u_terrain_matrix),z=[T[0]*S.dim,T[1]*S.dim],O=Math.floor(z[0]),R=Math.floor(z[1]),$=z[0]-O,G=z[1]-R;return S.get(O,R)*(1-$)*(1-G)+S.get(O+1,R)*$*(1-G)+S.get(O,R+1)*(1-$)*G+S.get(O+1,R+1)*$*G}getElevationForLngLatZoom(i,a){const{tileID:d,mercatorX:p,mercatorY:v}=this._getOverscaledTileIDFromLngLatZoom(i,a);return this.getElevation(d,p%c.W,v%c.W,c.W)}getElevation(i,a,d,p=c.W){return this.getDEMElevation(i,a,d,p)*this.exaggeration}getTerrainData(i){if(!this._emptyDemTexture){const p=this.painter.context,v=new c.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new ke(p,v,p.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new ke(p,new c.R({width:1,height:1}),p.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(p.gl.NEAREST,p.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=c.an([])}const a=this.sourceCache.getSourceTile(i,!0);if(a&&a.dem&&(!a.demTexture||a.needsTerrainPrepare)){const p=this.painter.context;a.demTexture=this.painter.getTileTexture(a.dem.stride),a.demTexture?a.demTexture.update(a.dem.getPixels(),{premultiply:!1}):a.demTexture=new ke(p,a.dem.getPixels(),p.gl.RGBA,{premultiply:!1}),a.demTexture.bind(p.gl.NEAREST,p.gl.CLAMP_TO_EDGE),a.needsTerrainPrepare=!1}const d=a&&a+a.tileID.key+i.key;if(d&&!this._demMatrixCache[d]){const p=this.sourceCache.sourceCache._source.maxzoom;let v=i.canonical.z-a.tileID.canonical.z;i.overscaledZ>i.canonical.z&&(i.canonical.z>=p?v=i.canonical.z-p:c.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const w=i.canonical.x-(i.canonical.x>>v<<v),S=i.canonical.y-(i.canonical.y>>v<<v),T=c.ba(new Float64Array(16),[1/(c.W<<v),1/(c.W<<v),0]);c.H(T,T,[w*c.W,S*c.W,0]),this._demMatrixCache[i.key]={matrix:T,coord:i}}return{u_depth:2,u_terrain:3,u_terrain_dim:a&&a.dem&&a.dem.dim||1,u_terrain_matrix:d?this._demMatrixCache[i.key].matrix:this._emptyDemMatrix,u_terrain_unpack:a&&a.dem&&a.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(a&&a.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:a}}getFramebuffer(i){const a=this.painter,d=a.width/devicePixelRatio,p=a.height/devicePixelRatio;return!this._fbo||this._fbo.width===d&&this._fbo.height===p||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new ke(a.context,{width:d,height:p,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new ke(a.context,{width:d,height:p,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=a.context.createFramebuffer(d,p,!0,!1),this._fbo.depthAttachment.set(a.context.createRenderbuffer(a.context.gl.DEPTH_COMPONENT16,d,p))),this._fbo.colorAttachment.set(i==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const i=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const a=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let v=0,w=0;v<this._coordsTextureSize;v++)for(let S=0;S<this._coordsTextureSize;S++,w+=4)a[w+0]=255&S,a[w+1]=255&v,a[w+2]=S>>8<<4|v>>8,a[w+3]=0;const d=new c.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(a.buffer)),p=new ke(i,d,i.gl.RGBA,{premultiply:!1});return p.bind(i.gl.NEAREST,i.gl.CLAMP_TO_EDGE),this._coordsTexture=p,p}pointCoordinate(i){this.painter.maybeDrawDepthAndCoords(!0);const a=new Uint8Array(4),d=this.painter.context,p=d.gl,v=Math.round(i.x*this.painter.pixelRatio/devicePixelRatio),w=Math.round(i.y*this.painter.pixelRatio/devicePixelRatio),S=Math.round(this.painter.height/devicePixelRatio);d.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),p.readPixels(v,S-w-1,1,1,p.RGBA,p.UNSIGNED_BYTE,a),d.bindFramebuffer.set(null);const T=a[0]+(a[2]>>4<<8),z=a[1]+((15&a[2])<<8),O=this.coordsIndex[255-a[3]],R=O&&this.sourceCache.getTileByID(O);if(!R)return null;const $=this._coordsTextureSize,G=(1<<R.tileID.canonical.z)*$;return new c.Y((R.tileID.canonical.x*$+T)/G+R.tileID.wrap,(R.tileID.canonical.y*$+z)/G,this.getElevation(R.tileID,T,z,$))}depthAtPoint(i){const a=new Uint8Array(4),d=this.painter.context,p=d.gl;return d.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),p.readPixels(i.x,this.painter.height/devicePixelRatio-i.y-1,1,1,p.RGBA,p.UNSIGNED_BYTE,a),d.bindFramebuffer.set(null),(a[0]/16777216+a[1]/65536+a[2]/256+a[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const i=this.painter.context,a=new c.bb,d=new c.aY,p=this.meshSize,v=c.W/p,w=p*p;for(let R=0;R<=p;R++)for(let $=0;$<=p;$++)a.emplaceBack($*v,R*v,0);for(let R=0;R<w;R+=p+1)for(let $=0;$<p;$++)d.emplaceBack($+R,p+$+R+1,p+$+R+2),d.emplaceBack($+R,p+$+R+2,$+R+1);const S=a.length,T=S+2*(p+1);for(const R of[0,1])for(let $=0;$<=p;$++)for(const G of[0,1])a.emplaceBack($*v,R*c.W,G);for(let R=0;R<2*p;R+=2)d.emplaceBack(T+R,T+R+1,T+R+3),d.emplaceBack(T+R,T+R+3,T+R+2),d.emplaceBack(S+R,S+R+3,S+R+1),d.emplaceBack(S+R,S+R+2,S+R+3);const z=a.length,O=z+2*(p+1);for(const R of[0,1])for(let $=0;$<=p;$++)for(const G of[0,1])a.emplaceBack(R*c.W,$*v,G);for(let R=0;R<2*p;R+=2)d.emplaceBack(z+R,z+R+1,z+R+3),d.emplaceBack(z+R,z+R+3,z+R+2),d.emplaceBack(O+R,O+R+3,O+R+1),d.emplaceBack(O+R,O+R+2,O+R+3);return this._mesh={indexBuffer:i.createIndexBuffer(d),vertexBuffer:i.createVertexBuffer(a,bo.members),segments:c.$.simpleSegment(0,0,a.length,d.length)},this._mesh}getMeshFrameDelta(i){return 2*Math.PI*c.bc/Math.pow(2,i)/5}getMinTileElevationForLngLatZoom(i,a){var d;const{tileID:p}=this._getOverscaledTileIDFromLngLatZoom(i,a);return(d=this.getMinMaxElevation(p).minElevation)!==null&&d!==void 0?d:0}getMinMaxElevation(i){const a=this.getTerrainData(i).tile,d={minElevation:null,maxElevation:null};return a&&a.dem&&(d.minElevation=a.dem.min*this.exaggeration,d.maxElevation=a.dem.max*this.exaggeration),d}_getOverscaledTileIDFromLngLatZoom(i,a){const d=c.Y.fromLngLat(i.wrap()),p=(1<<a)*c.W,v=d.x*p,w=d.y*p,S=Math.floor(v/c.W),T=Math.floor(w/c.W);return{tileID:new c.Q(a,0,a,S,T),mercatorX:v,mercatorY:w}}}class ka{constructor(i,a,d){this._context=i,this._size=a,this._tileSize=d,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const i of this._objects)i.texture.destroy(),i.fbo.destroy()}_createObject(i){const a=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),d=new ke(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return d.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),a.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),a.colorAttachment.set(d.texture),{id:i,fbo:a,texture:d,stamp:-1,inUse:!1}}getObjectForId(i){return this._objects[i]}useObject(i){i.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(a=>i.id!==a),this._recentlyUsed.push(i.id)}stampObject(i){i.stamp=++this._stamp}getOrCreateFreeObject(){for(const a of this._recentlyUsed)if(!this._objects[a].inUse)return this._objects[a];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const i=this._createObject(this._objects.length);return this._objects.push(i),i}freeObject(i){i.inUse=!1}freeAllObjects(){for(const i of this._objects)this.freeObject(i)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(i=>!i.inUse)===!1}}const qn={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Yh{constructor(i,a){this.painter=i,this.terrain=a,this.pool=new ka(i.context,30,a.sourceCache.tileSize*a.qualityFactor)}destruct(){this.pool.destruct()}getTexture(i){return this.pool.getObjectForId(i.rtt[this._stacks.length-1].id).texture}prepareForRender(i,a){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=i._order.filter(d=>!i._layers[d].isHidden(a)),this._coordsDescendingInv={};for(const d in i.sourceCaches){this._coordsDescendingInv[d]={};const p=i.sourceCaches[d].getVisibleCoordinates();for(const v of p){const w=this.terrain.sourceCache.getTerrainCoords(v);for(const S in w)this._coordsDescendingInv[d][S]||(this._coordsDescendingInv[d][S]=[]),this._coordsDescendingInv[d][S].push(w[S])}}this._coordsDescendingInvStr={};for(const d of i._order){const p=i._layers[d],v=p.source;if(qn[p.type]&&!this._coordsDescendingInvStr[v]){this._coordsDescendingInvStr[v]={};for(const w in this._coordsDescendingInv[v])this._coordsDescendingInvStr[v][w]=this._coordsDescendingInv[v][w].map(S=>S.key).sort().join()}}for(const d of this._renderableTiles)for(const p in this._coordsDescendingInvStr){const v=this._coordsDescendingInvStr[p][d.tileID.key];v&&v!==d.rttCoords[p]&&(d.rtt=[])}}renderLayer(i){if(i.isHidden(this.painter.transform.zoom))return!1;const a=i.type,d=this.painter,p=this._renderableLayerIds[this._renderableLayerIds.length-1]===i.id;if(qn[a]&&(this._prevType&&qn[this._prevType]||this._stacks.push([]),this._prevType=a,this._stacks[this._stacks.length-1].push(i.id),!p))return!0;if(qn[this._prevType]||qn[a]&&p){this._prevType=a;const v=this._stacks.length-1,w=this._stacks[v]||[];for(const S of this._renderableTiles){if(this.pool.isFull()&&(xl(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(S),S.rtt[v]){const z=this.pool.getObjectForId(S.rtt[v].id);if(z.stamp===S.rtt[v].stamp){this.pool.useObject(z);continue}}const T=this.pool.getOrCreateFreeObject();this.pool.useObject(T),this.pool.stampObject(T),S.rtt[v]={id:T.id,stamp:T.stamp},d.context.bindFramebuffer.set(T.fbo.framebuffer),d.context.clear({color:c.aP.transparent,stencil:0}),d.currentStencilSource=void 0;for(let z=0;z<w.length;z++){const O=d.style._layers[w[z]],R=O.source?this._coordsDescendingInv[O.source][S.tileID.key]:[S.tileID];d.context.viewport.set([0,0,T.fbo.width,T.fbo.height]),d._renderTileClippingMasks(O,R),d.renderLayer(d,d.style.sourceCaches[O.source],O,R),O.source&&(S.rttCoords[O.source]=this._coordsDescendingInvStr[O.source][S.tileID.key])}}return xl(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),qn[a]}return!1}}const ct={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},ou=I,_p={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Kh,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,refreshExpiredTiles:!0,scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],zoom:0,bearing:0,pitch:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:c.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0},Qh=_=>{_.touchstart=_.dragStart,_.touchmoveWindow=_.dragMove,_.touchend=_.dragEnd},su={showCompass:!0,showZoom:!0,visualizePitch:!1};class ed{constructor(i,a,d=!1){this.mousedown=w=>{this.startMouse(c.e({},w,{ctrlKey:!0,preventDefault:()=>w.preventDefault()}),L.mousePos(this.element,w)),L.addEventListener(window,"mousemove",this.mousemove),L.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=w=>{this.moveMouse(w,L.mousePos(this.element,w))},this.mouseup=w=>{this.mouseRotate.dragEnd(w),this.mousePitch&&this.mousePitch.dragEnd(w),this.offTemp()},this.touchstart=w=>{w.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=L.touchPos(this.element,w.targetTouches)[0],this.startTouch(w,this._startPos),L.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),L.addEventListener(window,"touchend",this.touchend))},this.touchmove=w=>{w.targetTouches.length!==1?this.reset():(this._lastPos=L.touchPos(this.element,w.targetTouches)[0],this.moveTouch(w,this._lastPos))},this.touchend=w=>{w.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const p=i.dragRotate._mouseRotate.getClickTolerance(),v=i.dragRotate._mousePitch.getClickTolerance();this.element=a,this.mouseRotate=fn({clickTolerance:p,enable:!0}),this.touchRotate=(({enable:w,clickTolerance:S,bearingDegreesPerPixelMoved:T=.8})=>{const z=new Ui;return new Yo({clickTolerance:S,move:(O,R)=>({bearingDelta:(R.x-O.x)*T}),moveStateManager:z,enable:w,assignEvents:Qh})})({clickTolerance:p,enable:!0}),this.map=i,d&&(this.mousePitch=Al({clickTolerance:v,enable:!0}),this.touchPitch=(({enable:w,clickTolerance:S,pitchDegreesPerPixelMoved:T=-.5})=>{const z=new Ui;return new Yo({clickTolerance:S,move:(O,R)=>({pitchDelta:(R.y-O.y)*T}),moveStateManager:z,enable:w,assignEvents:Qh})})({clickTolerance:v,enable:!0})),L.addEventListener(a,"mousedown",this.mousedown),L.addEventListener(a,"touchstart",this.touchstart,{passive:!1}),L.addEventListener(a,"touchcancel",this.reset)}startMouse(i,a){this.mouseRotate.dragStart(i,a),this.mousePitch&&this.mousePitch.dragStart(i,a),L.disableDrag()}startTouch(i,a){this.touchRotate.dragStart(i,a),this.touchPitch&&this.touchPitch.dragStart(i,a),L.disableDrag()}moveMouse(i,a){const d=this.map,{bearingDelta:p}=this.mouseRotate.dragMove(i,a)||{};if(p&&d.setBearing(d.getBearing()+p),this.mousePitch){const{pitchDelta:v}=this.mousePitch.dragMove(i,a)||{};v&&d.setPitch(d.getPitch()+v)}}moveTouch(i,a){const d=this.map,{bearingDelta:p}=this.touchRotate.dragMove(i,a)||{};if(p&&d.setBearing(d.getBearing()+p),this.touchPitch){const{pitchDelta:v}=this.touchPitch.dragMove(i,a)||{};v&&d.setPitch(d.getPitch()+v)}}off(){const i=this.element;L.removeEventListener(i,"mousedown",this.mousedown),L.removeEventListener(i,"touchstart",this.touchstart,{passive:!1}),L.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),L.removeEventListener(window,"touchend",this.touchend),L.removeEventListener(i,"touchcancel",this.reset),this.offTemp()}offTemp(){L.enableDrag(),L.removeEventListener(window,"mousemove",this.mousemove),L.removeEventListener(window,"mouseup",this.mouseup),L.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),L.removeEventListener(window,"touchend",this.touchend)}}let wo;function td(_,i,a){const d=new c.M(_.lng,_.lat);if(_=new c.M(_.lng,_.lat),i){const p=new c.M(_.lng-360,_.lat),v=new c.M(_.lng+360,_.lat),w=a.locationPoint(_).distSqr(i);a.locationPoint(p).distSqr(i)<w?_=p:a.locationPoint(v).distSqr(i)<w&&(_=v)}for(;Math.abs(_.lng-a.center.lng)>180;){const p=a.locationPoint(_);if(p.x>=0&&p.y>=0&&p.x<=a.width&&p.y<=a.height)break;_.lng>a.center.lng?_.lng-=360:_.lng+=360}return _.lng!==d.lng&&a.locationPoint(_).y>a.height/2-a.getHorizon()?_:d}const au={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Eo(_,i,a){const d=_.classList;for(const p in au)d.remove(`maplibregl-${a}-anchor-${p}`);d.add(`maplibregl-${a}-anchor-${i}`)}class wi extends c.E{constructor(i){if(super(),this._onKeyPress=a=>{const d=a.code,p=a.charCode||a.keyCode;d!=="Space"&&d!=="Enter"&&p!==32&&p!==13||this.togglePopup()},this._onMapClick=a=>{const d=a.originalEvent.target,p=this._element;this._popup&&(d===p||p.contains(d))&&this.togglePopup()},this._update=a=>{var d;if(!this._map)return;const p=this._map.loaded()&&!this._map.isMoving();((a==null?void 0:a.type)==="terrain"||(a==null?void 0:a.type)==="render"&&!p)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?td(this._lngLat,this._flatPos,this._map.transform):(d=this._lngLat)===null||d===void 0?void 0:d.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let v="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?v=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(v=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let w="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?w="rotateX(0deg)":this._pitchAlignment==="map"&&(w=`rotateX(${this._map.getPitch()}deg)`),a&&a.type!=="moveend"||(this._pos=this._pos.round()),L.setTransform(this._element,`${au[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${w} ${v}`),C.frameAsync(new AbortController).then(()=>{this._updateOpacity(a&&a.type==="moveend")}).catch(()=>{})},this._onMove=a=>{if(!this._isDragging){const d=this._clickTolerance||this._map._clickTolerance;this._isDragging=a.point.dist(this._pointerdownPos)>=d}this._isDragging&&(this._pos=a.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new c.k("dragstart"))),this.fire(new c.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new c.k("dragend")),this._state="inactive"},this._addDragHandler=a=>{this._element.contains(a.originalEvent.target)&&(a.preventDefault(),this._positionDelta=a.point.sub(this._pos).add(this._offset),this._pointerdownPos=a.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=i&&i.anchor||"center",this._color=i&&i.color||"#3FB1CE",this._scale=i&&i.scale||1,this._draggable=i&&i.draggable||!1,this._clickTolerance=i&&i.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=i&&i.rotation||0,this._rotationAlignment=i&&i.rotationAlignment||"auto",this._pitchAlignment=i&&i.pitchAlignment&&i.pitchAlignment!=="auto"?i.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(i==null?void 0:i.opacity,i==null?void 0:i.opacityWhenCovered),i&&i.element)this._element=i.element,this._offset=c.P.convert(i&&i.offset||[0,0]);else{this._defaultMarker=!0,this._element=L.create("div");const a=L.createNS("http://www.w3.org/2000/svg","svg"),d=41,p=27;a.setAttributeNS(null,"display","block"),a.setAttributeNS(null,"height",`${d}px`),a.setAttributeNS(null,"width",`${p}px`),a.setAttributeNS(null,"viewBox",`0 0 ${p} ${d}`);const v=L.createNS("http://www.w3.org/2000/svg","g");v.setAttributeNS(null,"stroke","none"),v.setAttributeNS(null,"stroke-width","1"),v.setAttributeNS(null,"fill","none"),v.setAttributeNS(null,"fill-rule","evenodd");const w=L.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"fill-rule","nonzero");const S=L.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"transform","translate(3.0, 29.0)"),S.setAttributeNS(null,"fill","#000000");const T=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ue of T){const ge=L.createNS("http://www.w3.org/2000/svg","ellipse");ge.setAttributeNS(null,"opacity","0.04"),ge.setAttributeNS(null,"cx","10.5"),ge.setAttributeNS(null,"cy","5.80029008"),ge.setAttributeNS(null,"rx",ue.rx),ge.setAttributeNS(null,"ry",ue.ry),S.appendChild(ge)}const z=L.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"fill",this._color);const O=L.createNS("http://www.w3.org/2000/svg","path");O.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),z.appendChild(O);const R=L.createNS("http://www.w3.org/2000/svg","g");R.setAttributeNS(null,"opacity","0.25"),R.setAttributeNS(null,"fill","#000000");const $=L.createNS("http://www.w3.org/2000/svg","path");$.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),R.appendChild($);const G=L.createNS("http://www.w3.org/2000/svg","g");G.setAttributeNS(null,"transform","translate(6.0, 7.0)"),G.setAttributeNS(null,"fill","#FFFFFF");const K=L.createNS("http://www.w3.org/2000/svg","g");K.setAttributeNS(null,"transform","translate(8.0, 8.0)");const re=L.createNS("http://www.w3.org/2000/svg","circle");re.setAttributeNS(null,"fill","#000000"),re.setAttributeNS(null,"opacity","0.25"),re.setAttributeNS(null,"cx","5.5"),re.setAttributeNS(null,"cy","5.5"),re.setAttributeNS(null,"r","5.4999962");const J=L.createNS("http://www.w3.org/2000/svg","circle");J.setAttributeNS(null,"fill","#FFFFFF"),J.setAttributeNS(null,"cx","5.5"),J.setAttributeNS(null,"cy","5.5"),J.setAttributeNS(null,"r","5.4999962"),K.appendChild(re),K.appendChild(J),w.appendChild(S),w.appendChild(z),w.appendChild(R),w.appendChild(G),w.appendChild(K),a.appendChild(w),a.setAttributeNS(null,"height",d*this._scale+"px"),a.setAttributeNS(null,"width",p*this._scale+"px"),this._element.appendChild(a),this._offset=c.P.convert(i&&i.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",a=>{a.preventDefault()}),this._element.addEventListener("mousedown",a=>{a.preventDefault()}),Eo(this._element,this._anchor,"marker"),i&&i.className)for(const a of i.className.split(" "))this._element.classList.add(a);this._popup=null}addTo(i){return this.remove(),this._map=i,this._element.setAttribute("aria-label",i._getUIString("Marker.Title")),i.getCanvasContainer().appendChild(this._element),i.on("move",this._update),i.on("moveend",this._update),i.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),L.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(i){return this._lngLat=c.M.convert(i),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(i){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),i){if(!("offset"in i.options)){const p=Math.abs(13.5)/Math.SQRT2;i.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[p,-1*(38.1-13.5+p)],"bottom-right":[-p,-1*(38.1-13.5+p)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=i,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const i=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:i?(i.isOpen()?i.remove():(i.setLngLat(this._lngLat),i.addTo(this._map)),this):this}_updateOpacity(i=!1){var a,d;if(!(!((a=this._map)===null||a===void 0)&&a.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(i)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const p=this._map,v=p.terrain.depthAtPoint(this._pos),w=p.terrain.getElevationForLngLatZoom(this._lngLat,p.transform.tileZoom);if(p.transform.lngLatToCameraDepth(this._lngLat,w)-v<.006)return void(this._element.style.opacity=this._opacity);const S=-this._offset.y/p.transform._pixelPerMeter,T=Math.sin(p.getPitch()*Math.PI/180)*S,z=p.terrain.depthAtPoint(new c.P(this._pos.x,this._pos.y-this._offset.y)),O=p.transform.lngLatToCameraDepth(this._lngLat,w+T)-z>.006;!((d=this._popup)===null||d===void 0)&&d.isOpen()&&O&&this._popup.remove(),this._element.style.opacity=O?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(i){return this._offset=c.P.convert(i),this._update(),this}addClassName(i){this._element.classList.add(i)}removeClassName(i){this._element.classList.remove(i)}toggleClassName(i){return this._element.classList.toggle(i)}setDraggable(i){return this._draggable=!!i,this._map&&(i?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(i){return this._rotation=i||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(i){return this._rotationAlignment=i||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(i){return this._pitchAlignment=i&&i!=="auto"?i:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(i,a){return i===void 0&&a===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),i!==void 0&&(this._opacity=i),a!==void 0&&(this._opacityWhenCovered=a),this._map&&this._updateOpacity(!0),this}}const Pl={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let ks=0,Ms=!1;const id={maxWidth:100,unit:"metric"};function lu(_,i,a){const d=a&&a.maxWidth||100,p=_._container.clientHeight/2,v=_.unproject([0,p]),w=_.unproject([d,p]),S=v.distanceTo(w);if(a&&a.unit==="imperial"){const T=3.2808*S;T>5280?Ma(i,d,T/5280,_._getUIString("ScaleControl.Miles")):Ma(i,d,T,_._getUIString("ScaleControl.Feet"))}else a&&a.unit==="nautical"?Ma(i,d,S/1852,_._getUIString("ScaleControl.NauticalMiles")):S>=1e3?Ma(i,d,S/1e3,_._getUIString("ScaleControl.Kilometers")):Ma(i,d,S,_._getUIString("ScaleControl.Meters"))}function Ma(_,i,a,d){const p=function(v){const w=Math.pow(10,`${Math.floor(v)}`.length-1);let S=v/w;return S=S>=10?10:S>=5?5:S>=3?3:S>=2?2:S>=1?1:function(T){const z=Math.pow(10,Math.ceil(-Math.log(T)/Math.LN10));return Math.round(T*z)/z}(S),w*S}(a);_.style.width=i*(p/a)+"px",_.innerHTML=`${p}&nbsp;${d}`}const Hn={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},zl=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function wt(_){if(_){if(typeof _=="number"){const i=Math.round(Math.abs(_)/Math.SQRT2);return{center:new c.P(0,0),top:new c.P(0,_),"top-left":new c.P(i,i),"top-right":new c.P(-i,i),bottom:new c.P(0,-_),"bottom-left":new c.P(i,-i),"bottom-right":new c.P(-i,-i),left:new c.P(_,0),right:new c.P(-_,0)}}if(_ instanceof c.P||Array.isArray(_)){const i=c.P.convert(_);return{center:i,top:i,"top-left":i,"top-right":i,bottom:i,"bottom-left":i,"bottom-right":i,left:i,right:i}}return{center:c.P.convert(_.center||[0,0]),top:c.P.convert(_.top||[0,0]),"top-left":c.P.convert(_["top-left"]||[0,0]),"top-right":c.P.convert(_["top-right"]||[0,0]),bottom:c.P.convert(_.bottom||[0,0]),"bottom-left":c.P.convert(_["bottom-left"]||[0,0]),"bottom-right":c.P.convert(_["bottom-right"]||[0,0]),left:c.P.convert(_.left||[0,0]),right:c.P.convert(_.right||[0,0])}}return wt(new c.P(0,0))}const At=I;m.AJAXError=c.bf,m.Evented=c.E,m.LngLat=c.M,m.MercatorCoordinate=c.Y,m.Point=c.P,m.addProtocol=c.bg,m.config=c.a,m.removeProtocol=c.bh,m.AttributionControl=Xh,m.BoxZoomHandler=Ia,m.CanvasSource=pt,m.CooperativeGesturesHandler=vn,m.DoubleClickZoomHandler=tu,m.DragPanHandler=iu,m.DragRotateHandler=As,m.EdgeInsets=Ea,m.FullscreenControl=class extends c.E{constructor(_={}){super(),this._onFullscreenChange=()=>{var i;let a=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((i=a==null?void 0:a.shadowRoot)===null||i===void 0)&&i.fullscreenElement;)a=a.shadowRoot.fullscreenElement;a===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,_&&_.container&&(_.container instanceof HTMLElement?this._container=_.container:c.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(_){return this._map=_,this._container||(this._container=this._map.getContainer()),this._controlContainer=L.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){L.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const _=this._fullscreenButton=L.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);L.create("span","maplibregl-ctrl-icon",_).setAttribute("aria-hidden","true"),_.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const _=this._getTitle();this._fullscreenButton.setAttribute("aria-label",_),this._fullscreenButton.title=_}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new c.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new c.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},m.GeoJSONSource=Ze,m.GeolocateControl=class extends c.E{constructor(_){super(),this._onSuccess=i=>{if(this._map){if(this._isOutOfMapMaxBounds(i))return this._setErrorState(),this.fire(new c.k("outofmaxbounds",i)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=i,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(i),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(i),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new c.k("geolocate",i)),this._finish()}},this._updateCamera=i=>{const a=new c.M(i.coords.longitude,i.coords.latitude),d=i.coords.accuracy,p=this._map.getBearing(),v=c.e({bearing:p},this.options.fitBoundsOptions),w=ye.fromLngLat(a,d);this._map.fitBounds(w,v,{geolocateSource:!0})},this._updateMarker=i=>{if(i){const a=new c.M(i.coords.longitude,i.coords.latitude);this._accuracyCircleMarker.setLngLat(a).addTo(this._map),this._userLocationDotMarker.setLngLat(a).addTo(this._map),this._accuracy=i.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=i=>{if(this._map){if(this.options.trackUserLocation)if(i.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(i.code===3&&Ms)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new c.k("error",i)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=i=>{if(this._map){if(this._container.addEventListener("contextmenu",a=>a.preventDefault()),this._geolocateButton=L.create("button","maplibregl-ctrl-geolocate",this._container),L.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",i===!1){c.w("Geolocation support is not available so the GeolocateControl will be disabled.");const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}else{const a=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=L.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new wi({element:this._dotElement}),this._circleElement=L.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new wi({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",a=>{a.geolocateSource||this._watchState!=="ACTIVE_LOCK"||a.originalEvent&&a.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new c.k("trackuserlocationend")),this.fire(new c.k("userlocationlostfocus")))})}},this.options=c.e({},Pl,_)}onAdd(_){return this._map=_,this._container=L.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(){return c._(this,arguments,void 0,function*(i=!1){if(wo!==void 0&&!i)return wo;if(window.navigator.permissions===void 0)return wo=!!window.navigator.geolocation,wo;try{wo=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{wo=!!window.navigator.geolocation}return wo})}().then(i=>this._setupUI(i)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),L.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,ks=0,Ms=!1}_isOutOfMapMaxBounds(_){const i=this._map.getMaxBounds(),a=_.coords;return i&&(a.longitude<i.getWest()||a.longitude>i.getEast()||a.latitude<i.getSouth()||a.latitude>i.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const _=this._map.getBounds(),i=_.getSouthEast(),a=_.getNorthEast(),d=i.distanceTo(a),p=Math.ceil(this._accuracy/(d/this._map._container.clientHeight)*2);this._circleElement.style.width=`${p}px`,this._circleElement.style.height=`${p}px`}trigger(){if(!this._setup)return c.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ks--,Ms=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new c.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.k("trackuserlocationstart")),this.fire(new c.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let _;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),ks++,ks>1?(_={maximumAge:6e5,timeout:0},Ms=!0):(_=this.options.positionOptions,Ms=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,_)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},m.Hash=qc,m.ImageSource=Qe,m.KeyboardHandler=xo,m.LngLatBounds=ye,m.LogoControl=nu,m.Map=class extends yp{constructor(_){c.bd.mark(c.be.create);const i=Object.assign(Object.assign({},_p),_);if(i.minZoom!=null&&i.maxZoom!=null&&i.minZoom>i.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(i.minPitch!=null&&i.maxPitch!=null&&i.minPitch>i.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(i.minPitch!=null&&i.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(i.maxPitch!=null&&i.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Uc(i.minZoom,i.maxZoom,i.minPitch,i.maxPitch,i.renderWorldCopies),{bearingSnap:i.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Aa,this._controls=[],this._mapId=c.a3(),this._contextLost=a=>{a.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new c.k("webglcontextlost",{originalEvent:a}))},this._contextRestored=a=>{this._setupPainter(),this.resize(),this._update(),this.fire(new c.k("webglcontextrestored",{originalEvent:a}))},this._onMapScroll=a=>{if(a.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=i.interactive,this._maxTileCacheSize=i.maxTileCacheSize,this._maxTileCacheZoomLevels=i.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=i.failIfMajorPerformanceCaveat===!0,this._preserveDrawingBuffer=i.preserveDrawingBuffer===!0,this._antialias=i.antialias===!0,this._trackResize=i.trackResize===!0,this._bearingSnap=i.bearingSnap,this._refreshExpiredTiles=i.refreshExpiredTiles===!0,this._fadeDuration=i.fadeDuration,this._crossSourceCollisions=i.crossSourceCollisions===!0,this._collectResourceTiming=i.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},ct),i.locale),this._clickTolerance=i.clickTolerance,this._overridePixelRatio=i.pixelRatio,this._maxCanvasSize=i.maxCanvasSize,this.transformCameraUpdate=i.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=i.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=H.addThrottleControl(()=>this.isMoving()),this._requestManager=new ce(i.transformRequest),typeof i.container=="string"){if(this._container=document.getElementById(i.container),!this._container)throw new Error(`Container '${i.container}' not found.`)}else{if(!(i.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=i.container}if(i.maxBounds&&this.setMaxBounds(i.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)).on("moveend",()=>this._update(!1)).on("zoom",()=>this._update(!0)).on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}).once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let a=!1;const d=$h(p=>{this._trackResize&&!this._removed&&this.resize(p)._update()},50);this._resizeObserver=new ResizeObserver(p=>{a?d(p):a=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Ca(this,i),this._hash=i.hash&&new qc(typeof i.hash=="string"&&i.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:i.center,zoom:i.zoom,bearing:i.bearing,pitch:i.pitch}),i.bounds&&(this.resize(),this.fitBounds(i.bounds,c.e({},i.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=i.localIdeographFontFamily,this._validateStyle=i.validateStyle,i.style&&this.setStyle(i.style,{localIdeographFontFamily:i.localIdeographFontFamily}),i.attributionControl&&this.addControl(new Xh(typeof i.attributionControl=="boolean"?void 0:i.attributionControl)),i.maplibreLogo&&this.addControl(new nu,i.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",a=>{this._update(a.dataType==="style"),this.fire(new c.k(`${a.dataType}data`,a))}),this.on("dataloading",a=>{this.fire(new c.k(`${a.dataType}dataloading`,a))}),this.on("dataabort",a=>{this.fire(new c.k("sourcedataabort",a))})}_getMapId(){return this._mapId}addControl(_,i){if(i===void 0&&(i=_.getDefaultPosition?_.getDefaultPosition():"top-right"),!_||!_.onAdd)return this.fire(new c.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const a=_.onAdd(this);this._controls.push(_);const d=this._controlPositions[i];return i.indexOf("bottom")!==-1?d.insertBefore(a,d.firstChild):d.appendChild(a),this}removeControl(_){if(!_||!_.onRemove)return this.fire(new c.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const i=this._controls.indexOf(_);return i>-1&&this._controls.splice(i,1),_.onRemove(this),this}hasControl(_){return this._controls.indexOf(_)>-1}calculateCameraOptionsFromTo(_,i,a,d){return d==null&&this.terrain&&(d=this.terrain.getElevationForLngLatZoom(a,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(_,i,a,d)}resize(_){var i;const a=this._containerDimensions(),d=a[0],p=a[1],v=this._getClampedPixelRatio(d,p);if(this._resizeCanvas(d,p,v),this.painter.resize(d,p,v),this.painter.overLimit()){const S=this.painter.context.gl;this._maxCanvasSize=[S.drawingBufferWidth,S.drawingBufferHeight];const T=this._getClampedPixelRatio(d,p);this._resizeCanvas(d,p,T),this.painter.resize(d,p,T)}this.transform.resize(d,p),(i=this._requestedCameraState)===null||i===void 0||i.resize(d,p);const w=!this._moving;return w&&(this.stop(),this.fire(new c.k("movestart",_)).fire(new c.k("move",_))),this.fire(new c.k("resize",_)),w&&this.fire(new c.k("moveend",_)),this}_getClampedPixelRatio(_,i){const{0:a,1:d}=this._maxCanvasSize,p=this.getPixelRatio(),v=_*p,w=i*p;return Math.min(v>a?a/v:1,w>d?d/w:1)*p}getPixelRatio(){var _;return(_=this._overridePixelRatio)!==null&&_!==void 0?_:devicePixelRatio}setPixelRatio(_){this._overridePixelRatio=_,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(_){return this.transform.setMaxBounds(ye.convert(_)),this._update()}setMinZoom(_){if((_=_??-2)>=-2&&_<=this.transform.maxZoom)return this.transform.minZoom=_,this._update(),this.getZoom()<_&&this.setZoom(_),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(_){if((_=_??22)>=this.transform.minZoom)return this.transform.maxZoom=_,this._update(),this.getZoom()>_&&this.setZoom(_),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(_){if((_=_??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(_>=0&&_<=this.transform.maxPitch)return this.transform.minPitch=_,this._update(),this.getPitch()<_&&this.setPitch(_),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(_){if((_=_??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(_>=this.transform.minPitch)return this.transform.maxPitch=_,this._update(),this.getPitch()>_&&this.setPitch(_),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(_){return this.transform.renderWorldCopies=_,this._update()}project(_){return this.transform.locationPoint(c.M.convert(_),this.style&&this.terrain)}unproject(_){return this.transform.pointLocation(c.P.convert(_),this.terrain)}isMoving(){var _;return this._moving||((_=this.handlers)===null||_===void 0?void 0:_.isMoving())}isZooming(){var _;return this._zooming||((_=this.handlers)===null||_===void 0?void 0:_.isZooming())}isRotating(){var _;return this._rotating||((_=this.handlers)===null||_===void 0?void 0:_.isRotating())}_createDelegatedListener(_,i,a){if(_==="mouseenter"||_==="mouseover"){let d=!1;return{layer:i,listener:a,delegates:{mousemove:v=>{const w=this.getLayer(i)?this.queryRenderedFeatures(v.point,{layers:[i]}):[];w.length?d||(d=!0,a.call(this,new Cr(_,this,v.originalEvent,{features:w}))):d=!1},mouseout:()=>{d=!1}}}}if(_==="mouseleave"||_==="mouseout"){let d=!1;return{layer:i,listener:a,delegates:{mousemove:w=>{(this.getLayer(i)?this.queryRenderedFeatures(w.point,{layers:[i]}):[]).length?d=!0:d&&(d=!1,a.call(this,new Cr(_,this,w.originalEvent)))},mouseout:w=>{d&&(d=!1,a.call(this,new Cr(_,this,w.originalEvent)))}}}}{const d=p=>{const v=this.getLayer(i)?this.queryRenderedFeatures(p.point,{layers:[i]}):[];v.length&&(p.features=v,a.call(this,p),delete p.features)};return{layer:i,listener:a,delegates:{[_]:d}}}}on(_,i,a){if(a===void 0)return super.on(_,i);const d=this._createDelegatedListener(_,i,a);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[_]=this._delegatedListeners[_]||[],this._delegatedListeners[_].push(d);for(const p in d.delegates)this.on(p,d.delegates[p]);return this}once(_,i,a){if(a===void 0)return super.once(_,i);const d=this._createDelegatedListener(_,i,a);for(const p in d.delegates)this.once(p,d.delegates[p]);return this}off(_,i,a){return a===void 0?super.off(_,i):(this._delegatedListeners&&this._delegatedListeners[_]&&(d=>{const p=this._delegatedListeners[_];for(let v=0;v<p.length;v++){const w=p[v];if(w.layer===i&&w.listener===a){for(const S in w.delegates)this.off(S,w.delegates[S]);return p.splice(v,1),this}}})(),this)}queryRenderedFeatures(_,i){if(!this.style)return[];let a;const d=_ instanceof c.P||Array.isArray(_),p=d?_:[[0,0],[this.transform.width,this.transform.height]];if(i=i||(d?{}:_)||{},p instanceof c.P||typeof p[0]=="number")a=[c.P.convert(p)];else{const v=c.P.convert(p[0]),w=c.P.convert(p[1]);a=[v,new c.P(w.x,v.y),w,new c.P(v.x,w.y),v]}return this.style.queryRenderedFeatures(a,i,this.transform)}querySourceFeatures(_,i){return this.style.querySourceFeatures(_,i)}setStyle(_,i){return(i=c.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},i)).diff!==!1&&i.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&_?(this._diffStyle(_,i),this):(this._localIdeographFontFamily=i.localIdeographFontFamily,this._updateStyle(_,i))}setTransformRequest(_){return this._requestManager.setTransformRequest(_),this}_getUIString(_){const i=this._locale[_];if(i==null)throw new Error(`Missing UI string '${_}'`);return i}_updateStyle(_,i){if(i.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(_,i));const a=this.style&&i.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!_)),_?(this.style=new il(this,i||{}),this.style.setEventedParent(this,{style:this.style}),typeof _=="string"?this.style.loadURL(_,i,a):this.style.loadJSON(_,i,a),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new il(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(_,i){if(typeof _=="string"){const a=this._requestManager.transformRequest(_,"Style");c.h(a,new AbortController).then(d=>{this._updateDiff(d.data,i)}).catch(d=>{d&&this.fire(new c.j(d))})}else typeof _=="object"&&this._updateDiff(_,i)}_updateDiff(_,i){try{this.style.setState(_,i)&&this._update(!0)}catch(a){c.w(`Unable to perform style diff: ${a.message||a.error||a}.  Rebuilding the style from scratch.`),this._updateStyle(_,i)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():c.w("There is no style added to the map.")}addSource(_,i){return this._lazyInitEmptyStyle(),this.style.addSource(_,i),this._update(!0)}isSourceLoaded(_){const i=this.style&&this.style.sourceCaches[_];if(i!==void 0)return i.loaded();this.fire(new c.j(new Error(`There is no source with ID '${_}'`)))}setTerrain(_){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),_){const i=this.style.sourceCaches[_.source];if(!i)throw new Error(`cannot load terrain, because there exists no source with ID: ${_.source}`);this.terrain===null&&i.reload();for(const a in this.style._layers){const d=this.style._layers[a];d.type==="hillshade"&&d.source===_.source&&c.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Jh(this.painter,i,_),this.painter.renderToTexture=new Yh(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=a=>{a.dataType==="style"?this.terrain.sourceCache.freeRtt():a.dataType==="source"&&a.tile&&(a.sourceId!==_.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(a.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new c.k("terrain",{terrain:_})),this}getTerrain(){var _,i;return(i=(_=this.terrain)===null||_===void 0?void 0:_.options)!==null&&i!==void 0?i:null}areTilesLoaded(){const _=this.style&&this.style.sourceCaches;for(const i in _){const a=_[i]._tiles;for(const d in a){const p=a[d];if(p.state!=="loaded"&&p.state!=="errored")return!1}}return!0}removeSource(_){return this.style.removeSource(_),this._update(!0)}getSource(_){return this.style.getSource(_)}addImage(_,i,a={}){const{pixelRatio:d=1,sdf:p=!1,stretchX:v,stretchY:w,content:S,textFitWidth:T,textFitHeight:z}=a;if(this._lazyInitEmptyStyle(),!(i instanceof HTMLImageElement||c.b(i))){if(i.width===void 0||i.height===void 0)return this.fire(new c.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:O,height:R,data:$}=i,G=i;return this.style.addImage(_,{data:new c.R({width:O,height:R},new Uint8Array($)),pixelRatio:d,stretchX:v,stretchY:w,content:S,textFitWidth:T,textFitHeight:z,sdf:p,version:0,userImage:G}),G.onAdd&&G.onAdd(this,_),this}}{const{width:O,height:R,data:$}=C.getImageData(i);this.style.addImage(_,{data:new c.R({width:O,height:R},$),pixelRatio:d,stretchX:v,stretchY:w,content:S,textFitWidth:T,textFitHeight:z,sdf:p,version:0})}}updateImage(_,i){const a=this.style.getImage(_);if(!a)return this.fire(new c.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const d=i instanceof HTMLImageElement||c.b(i)?C.getImageData(i):i,{width:p,height:v,data:w}=d;if(p===void 0||v===void 0)return this.fire(new c.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(p!==a.data.width||v!==a.data.height)return this.fire(new c.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const S=!(i instanceof HTMLImageElement||c.b(i));return a.data.replace(w,S),this.style.updateImage(_,a),this}getImage(_){return this.style.getImage(_)}hasImage(_){return _?!!this.style.getImage(_):(this.fire(new c.j(new Error("Missing required image id"))),!1)}removeImage(_){this.style.removeImage(_)}loadImage(_){return H.getImage(this._requestManager.transformRequest(_,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(_,i){return this._lazyInitEmptyStyle(),this.style.addLayer(_,i),this._update(!0)}moveLayer(_,i){return this.style.moveLayer(_,i),this._update(!0)}removeLayer(_){return this.style.removeLayer(_),this._update(!0)}getLayer(_){return this.style.getLayer(_)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(_,i,a){return this.style.setLayerZoomRange(_,i,a),this._update(!0)}setFilter(_,i,a={}){return this.style.setFilter(_,i,a),this._update(!0)}getFilter(_){return this.style.getFilter(_)}setPaintProperty(_,i,a,d={}){return this.style.setPaintProperty(_,i,a,d),this._update(!0)}getPaintProperty(_,i){return this.style.getPaintProperty(_,i)}setLayoutProperty(_,i,a,d={}){return this.style.setLayoutProperty(_,i,a,d),this._update(!0)}getLayoutProperty(_,i){return this.style.getLayoutProperty(_,i)}setGlyphs(_,i={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(_,i),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(_,i,a={}){return this._lazyInitEmptyStyle(),this.style.addSprite(_,i,a,d=>{d||this._update(!0)}),this}removeSprite(_){return this._lazyInitEmptyStyle(),this.style.removeSprite(_),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(_,i={}){return this._lazyInitEmptyStyle(),this.style.setSprite(_,i,a=>{a||this._update(!0)}),this}setLight(_,i={}){return this._lazyInitEmptyStyle(),this.style.setLight(_,i),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(_,i){return this.style.setFeatureState(_,i),this._update()}removeFeatureState(_,i){return this.style.removeFeatureState(_,i),this._update()}getFeatureState(_){return this.style.getFeatureState(_)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let _=0,i=0;return this._container&&(_=this._container.clientWidth||400,i=this._container.clientHeight||300),[_,i]}_setupContainer(){const _=this._container;_.classList.add("maplibregl-map");const i=this._canvasContainer=L.create("div","maplibregl-canvas-container",_);this._interactive&&i.classList.add("maplibregl-interactive"),this._canvas=L.create("canvas","maplibregl-canvas",i),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const a=this._containerDimensions(),d=this._getClampedPixelRatio(a[0],a[1]);this._resizeCanvas(a[0],a[1],d);const p=this._controlContainer=L.create("div","maplibregl-control-container",_),v=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(w=>{v[w]=L.create("div",`maplibregl-ctrl-${w} `,p)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(_,i,a){this._canvas.width=Math.floor(a*_),this._canvas.height=Math.floor(a*i),this._canvas.style.width=`${_}px`,this._canvas.style.height=`${i}px`}_setupPainter(){const _={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let i=null;this._canvas.addEventListener("webglcontextcreationerror",d=>{i={requestedAttributes:_},d&&(i.statusMessage=d.statusMessage,i.type=d.type)},{once:!0});const a=this._canvas.getContext("webgl2",_)||this._canvas.getContext("webgl",_);if(!a){const d="Failed to initialize WebGL";throw i?(i.message=d,new Error(JSON.stringify(i))):new Error(d)}this.painter=new oi(a,this.transform),q.testSupport(a)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(_){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||_,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(_){return this._update(),this._renderTaskQueue.add(_)}_cancelRenderFrame(_){this._renderTaskQueue.remove(_)}_render(_){const i=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(_),this._removed)return;let a=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const p=this.transform.zoom,v=C.now();this.style.zoomHistory.update(p,v);const w=new c.a8(p,{now:v,fadeDuration:i,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),S=w.crossFadingFactor();S===1&&S===this._crossFadingFactor||(a=!0,this._crossFadingFactor=S),this.style.update(w)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,i,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:i,showPadding:this.showPadding}),this.fire(new c.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,c.bd.mark(c.be.load),this.fire(new c.k("load"))),this.style&&(this.style.hasTransitions()||a)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const d=this._sourcesDirty||this._styleDirty||this._placementDirty;return d||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new c.k("idle")),!this._loaded||this._fullyLoaded||d||(this._fullyLoaded=!0,c.bd.mark(c.be.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var _;this._hash&&this._hash.remove();for(const a of this._controls)a.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),H.removeThrottleControl(this._imageQueueHandle),(_=this._resizeObserver)===null||_===void 0||_.disconnect();const i=this.painter.context.gl.getExtension("WEBGL_lose_context");i!=null&&i.loseContext&&i.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),L.remove(this._canvasContainer),L.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),c.bd.clearMetrics(),this._removed=!0,this.fire(new c.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,C.frameAsync(this._frameRequest).then(_=>{c.bd.frame(_),this._frameRequest=null,this._render(_)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(_){this._showTileBoundaries!==_&&(this._showTileBoundaries=_,this._update())}get showPadding(){return!!this._showPadding}set showPadding(_){this._showPadding!==_&&(this._showPadding=_,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(_){this._showCollisionBoxes!==_&&(this._showCollisionBoxes=_,_?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(_){this._showOverdrawInspector!==_&&(this._showOverdrawInspector=_,this._update())}get repaint(){return!!this._repaint}set repaint(_){this._repaint!==_&&(this._repaint=_,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(_){this._vertices=_,this._update()}get version(){return ou}getCameraTargetElevation(){return this.transform.elevation}},m.MapMouseEvent=Cr,m.MapTouchEvent=Jo,m.MapWheelEvent=jh,m.Marker=wi,m.NavigationControl=class{constructor(_){this._updateZoomButtons=()=>{const i=this._map.getZoom(),a=i===this._map.getMaxZoom(),d=i===this._map.getMinZoom();this._zoomInButton.disabled=a,this._zoomOutButton.disabled=d,this._zoomInButton.setAttribute("aria-disabled",a.toString()),this._zoomOutButton.setAttribute("aria-disabled",d.toString())},this._rotateCompassArrow=()=>{const i=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=i},this._setButtonTitle=(i,a)=>{const d=this._map._getUIString(`NavigationControl.${a}`);i.title=d,i.setAttribute("aria-label",d)},this.options=c.e({},su,_),this._container=L.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",i=>i.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",i=>this._map.zoomIn({},{originalEvent:i})),L.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",i=>this._map.zoomOut({},{originalEvent:i})),L.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",i=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:i}):this._map.resetNorth({},{originalEvent:i})}),this._compassIcon=L.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(_){return this._map=_,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new ed(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){L.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(_,i){const a=L.create("button",_,this._container);return a.type="button",a.addEventListener("click",i),a}},m.Popup=class extends c.E{constructor(_){super(),this.remove=()=>(this._content&&L.remove(this._content),this._container&&(L.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new c.k("close"))),this),this._onMouseUp=i=>{this._update(i.point)},this._onMouseMove=i=>{this._update(i.point)},this._onDrag=i=>{this._update(i.point)},this._update=i=>{var a;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=L.create("div","maplibregl-popup",this._map.getContainer()),this._tip=L.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const S of this.options.className.split(" "))this._container.classList.add(S);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?td(this._lngLat,this._flatPos,this._map.transform):(a=this._lngLat)===null||a===void 0?void 0:a.wrap(),this._trackPointer&&!i)return;const d=this._flatPos=this._pos=this._trackPointer&&i?i:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&i?i:this._map.transform.locationPoint(this._lngLat));let p=this.options.anchor;const v=wt(this.options.offset);if(!p){const S=this._container.offsetWidth,T=this._container.offsetHeight;let z;z=d.y+v.bottom.y<T?["top"]:d.y>this._map.transform.height-T?["bottom"]:[],d.x<S/2?z.push("left"):d.x>this._map.transform.width-S/2&&z.push("right"),p=z.length===0?"bottom":z.join("-")}let w=d.add(v[p]);this.options.subpixelPositioning||(w=w.round()),L.setTransform(this._container,`${au[p]} translate(${w.x}px,${w.y}px)`),Eo(this._container,p,"popup")},this._onClose=()=>{this.remove()},this.options=c.e(Object.create(Hn),_)}addTo(_){return this._map&&this.remove(),this._map=_,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new c.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(_){return this._lngLat=c.M.convert(_),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(_){return this.setDOMContent(document.createTextNode(_))}setHTML(_){const i=document.createDocumentFragment(),a=document.createElement("body");let d;for(a.innerHTML=_;d=a.firstChild,d;)i.appendChild(d);return this.setDOMContent(i)}getMaxWidth(){var _;return(_=this._container)===null||_===void 0?void 0:_.style.maxWidth}setMaxWidth(_){return this.options.maxWidth=_,this._update(),this}setDOMContent(_){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=L.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(_),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(_){return this._container&&this._container.classList.add(_),this}removeClassName(_){return this._container&&this._container.classList.remove(_),this}setOffset(_){return this.options.offset=_,this._update(),this}toggleClassName(_){if(this._container)return this._container.classList.toggle(_)}setSubpixelPositioning(_){this.options.subpixelPositioning=_}_createCloseButton(){this.options.closeButton&&(this._closeButton=L.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const _=this._container.querySelector(zl);_&&_.focus()}},m.RasterDEMTileSource=tt,m.RasterTileSource=He,m.ScaleControl=class{constructor(_){this._onMove=()=>{lu(this._map,this._container,this.options)},this.setUnit=i=>{this.options.unit=i,lu(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},id),_)}getDefaultPosition(){return"bottom-left"}onAdd(_){return this._map=_,this._container=L.create("div","maplibregl-ctrl maplibregl-ctrl-scale",_.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){L.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},m.ScrollZoomHandler=eu,m.Style=il,m.TerrainControl=class{constructor(_){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=_}onAdd(_){return this._map=_,this._container=L.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=L.create("button","maplibregl-ctrl-terrain",this._container),L.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){L.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},m.TwoFingersTouchPitchHandler=Yc,m.TwoFingersTouchRotateHandler=Jc,m.TwoFingersTouchZoomHandler=Ml,m.TwoFingersTouchZoomRotateHandler=ru,m.VectorTileSource=le,m.VideoSource=We,m.addSourceType=(_,i)=>c._(void 0,void 0,void 0,function*(){if(xt(_))throw new Error(`A source type called "${_}" already exists.`);((a,d)=>{It[a]=d})(_,i)}),m.clearPrewarmedResources=function(){const _=Oi;_&&(_.isPreloaded()&&_.numActive()===1?(_.release(jt),Oi=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},m.getMaxParallelImageRequests=function(){return c.a.MAX_PARALLEL_IMAGE_REQUESTS},m.getRTLTextPluginStatus=function(){return Gt().getRTLTextPluginStatus()},m.getVersion=function(){return At},m.getWorkerCount=function(){return Si.workerCount},m.getWorkerUrl=function(){return c.a.WORKER_URL},m.importScriptInWorkers=function(_){return Br().broadcast("IS",_)},m.prewarm=function(){Pi().acquire(jt)},m.setMaxParallelImageRequests=function(_){c.a.MAX_PARALLEL_IMAGE_REQUESTS=_},m.setRTLTextPlugin=function(_,i){return Gt().setRTLTextPlugin(_,i)},m.setWorkerCount=function(_){Si.workerCount=_},m.setWorkerUrl=function(_){c.a.WORKER_URL=_}});var g=s;return g})})(Sw);var Tw=Sw.exports;const $5=N5(Tw),Cw=["3036","3622","3623","3624","3631","3641","3653","3724","3725","3741","3823","3824","3831","3841","3926","3927","3928","3942","4027","4028","4040","4042","4128","4129","4142","4229","4230","4328","4329","4429","4440","4529","4530","4531","4540","4629","4630","4631","4728","4729","4730","4731","4739","4740","4828","4829","4830","4831","4839","4928","4929","4930","4931","4932","4933","4934","4939","5029","5030","5031","5032","5033","5034","5035","5036","5038","5039","5129","5130","5131","5132","5133","5134","5135","5136","5137","5138","5139","5229","5231","5232","5233","5234","5235","5236","5237","5238","5239","5240","5332","5333","5334","5335","5336","5337","5338","5339","5340","5432","5433","5435","5436","5437","5438","5439","5440","5531","5536","5537","5538","5539","5540","5541","5636","5637","5638","5639","5640","5641","5738","5739","5740","5741","5839","5840","5841","5939","5940","5941","5942","6039","6040","6041","6139","6140","6141","6239","6240","6241","6243","6339","6340","6341","6342","6343","6439","6440","6441","6442","6443","6444","6445","6540","6541","6542","6543","6544","6545","6546","6641","6642","6643","6644","6645","6646","6647","6740","6741","6742","6747","6748","6840","6841","6842","6847","6848"],Te={LEVEL_80000:{LEVEL:8e4,DIGIT:4,DISTANCE:{LAT:40/60,LNG:1},SECTION:{X:{MIN:22,MAX:53},Y:{MIN:30,MAX:68},LAT:{MIN:20},LNG:{MIN:122}}},LEVEL_10000:{LEVEL:1e4,DIGIT:6,RANGE:{MIN:0,MAX:7},DISTANCE:{LAT:5/60,LNG:7/60+30/60/60}},LEVEL_5000:{LEVEL:5e3,DIGIT:7,RANGE:{MIN:1,MAX:4},DISTANCE:{LAT:150/60/60,LNG:225/60/60}},LEVEL_2000:{LEVEL:2e3,DIGIT:9,RANGE:{MIN:0,MAX:8},DISTANCE:{LAT:60/60/60,LNG:90/60/60}},LEVEL_1000:{LEVEL:1e3,DIGIT:8,RANGE:{MIN:0,MAX:9},DISTANCE:{LAT:30/60/60,LNG:45/60/60}},LEVEL_500:{LEVEL:500,DIGIT:9,RANGE:{MIN:1,MAX:4},DISTANCE:{LAT:15/60/60,LNG:22.5/60/60}},LEVEL_250:{LEVEL:250,DIGIT:10,RANGE:{MIN:1,MAX:4},DISTANCE:{LAT:7.5/60/60,LNG:11.25/60/60}},LEVEL_125:{LEVEL:125,DIGIT:11,RANGE:{MIN:1,MAX:4},DISTANCE:{LAT:3.75/60/60,LNG:5.625/60/60}}},Yl=Object.values(Te).map(e=>e.LEVEL),j5=[Te.LEVEL_10000.LEVEL,Te.LEVEL_5000.LEVEL,Te.LEVEL_2000.LEVEL];class Fu{constructor(n,s){Fa(this,"lat");Fa(this,"lng");this.lat=n,this.lng=s}}class Aw{constructor(n,s,u,h){Fa(this,"northLat");Fa(this,"eastLng");Fa(this,"southLat");Fa(this,"westLng");this.northLat=n,this.eastLng=s,this.southLat=u,this.westLng=h}getCenter(){const n=(this.northLat+this.southLat)/2,s=(this.eastLng+this.westLng)/2;return new Fu(n,s)}getNorthEast(){return new Fu(this.northLat,this.eastLng)}getNorthWest(){return new Fu(this.northLat,this.westLng)}getSouthWest(){return new Fu(this.southLat,this.westLng)}getSouthEast(){return new Fu(this.southLat,this.eastLng)}contains(n){const s=n.lat,u=n.lng;return this.southLat<=s&&s<=this.northLat&&this.westLng<=u&&u<=this.eastLng}}class Po{static toCode(n,s,u=Te.LEVEL_125.LEVEL){if(Yl.includes(u)===!1)throw new Error(`invalid level. available : ${Yl.join(", ")}`);const h=Math.floor(n*60/40),g=n*60%40,m=Math.floor(g/5),c=g%5,I=Math.floor(c*60/30),M=c*60%30,k=Math.floor(M/15),C=M%15,L=Math.floor(C/7.5),q=C%7.5,X=Math.floor(q/3.75),W=Math.floor(s-100),ae=s-100-W,Ie=Math.floor(ae*60/7.5),ee=ae*60%7.5,H=Math.floor(ee*60/45),ce=ee*60%45,ne=Math.floor(ce/22.5),oe=ce%22.5,Ae=Math.floor(oe/11.25),be=oe%11.25,Le=Math.floor(be/5.625),me=k*2+(ne+1),ke=L*2+(Ae+1),Me=X*2+(Le+1),Oe=`${h}${W}${m}${Ie}${I}${H}${me}${ke}${Me}`;if(nf(Oe)===!1)throw new Error(`lat: ${n} and lng: ${s} are invalid location.`);const Ge=Oe.slice(0,Te.LEVEL_10000.DIGIT);switch(u){case Te.LEVEL_80000.LEVEL:return Oe.slice(0,Te.LEVEL_80000.DIGIT);case Te.LEVEL_10000.LEVEL:return Ge;case Te.LEVEL_5000.LEVEL:return lx(Ge,n,s,u);case Te.LEVEL_2000.LEVEL:return lx(Ge,n,s,u);case Te.LEVEL_1000.LEVEL:return Oe.slice(0,Te.LEVEL_1000.DIGIT);case Te.LEVEL_500.LEVEL:return Oe.slice(0,Te.LEVEL_500.DIGIT);case Te.LEVEL_250.LEVEL:return Oe.slice(0,Te.LEVEL_250.DIGIT);default:return Oe}}static toLatLngBounds(n){const s=cx(n),u=s[0],h=s[2];return new Aw(u[1],u[0],h[1],h[0])}static toGeoJSON(n,s={}){const u=cx(n);return U5(u,s)}static getLevel(n){if(nf(n)===!1)throw new Error(`'${n}' is invalid mesh code.`);const s=n.length;return s===Te.LEVEL_80000.DIGIT?Te.LEVEL_80000.LEVEL:s===Te.LEVEL_10000.DIGIT?Te.LEVEL_10000.LEVEL:s===Te.LEVEL_5000.DIGIT?Te.LEVEL_5000.LEVEL:s===Te.LEVEL_2000.DIGIT&&n[n.length-1]==="5"?Te.LEVEL_2000.LEVEL:s===Te.LEVEL_1000.DIGIT?Te.LEVEL_1000.LEVEL:s===Te.LEVEL_500.DIGIT?Te.LEVEL_500.LEVEL:s===Te.LEVEL_250.DIGIT?Te.LEVEL_250.LEVEL:Te.LEVEL_125.LEVEL}static getCodes(n=null,s=null){if(n===null&&s===null)return Cw;if(n===null)throw new Error("code is required.");if(s===null)throw new Error("level is required.");if(nf(n)===!1)throw new Error(`'${n}' is invalid mesh code.`);if(Yl.includes(s)===!1)throw new Error(`${s} is invalid level. available : ${Yl.join(", ")}`);const u=Po.getLevel(n);if(u<=s)throw new Error("code level is lower than the specified level.");const h=[];if(u>Te.LEVEL_10000.LEVEL){for(let g=Te.LEVEL_10000.RANGE.MIN;g<=Te.LEVEL_10000.RANGE.MAX;g++)for(let m=Te.LEVEL_10000.RANGE.MIN;m<=Te.LEVEL_10000.RANGE.MAX;m++)h.push(`${n}${g}${m}`);if(s===Te.LEVEL_10000.LEVEL)return h}else h.push(n.slice(0,Te.LEVEL_10000.DIGIT));if(j5.includes(s)){if(s===Te.LEVEL_5000.LEVEL){const g=[];return h.forEach(m=>{for(let c=Te.LEVEL_5000.RANGE.MIN;c<=Te.LEVEL_5000.RANGE.MAX;c++)g.push(`${m}${c}`)}),g}else if(s===Te.LEVEL_2000.LEVEL){const g=[];return h.forEach(m=>{let c=[0,2,4,6,8],I=[0,2,4,6,8];if(u===Te.LEVEL_5000.LEVEL){const M=Number(n[6]);M===1?(c=[0,2,4],I=[0,2,4]):M===2?(c=[0,2,4],I=[4,6,8]):M===3?(c=[4,6,8],I=[0,2,4]):M===4&&(c=[4,6,8],I=[4,6,8])}c.forEach(M=>{I.forEach(k=>{g.push(`${m}${M}${k}5`)})})}),g}}else{const g=[];if(u>Te.LEVEL_1000.LEVEL){let M=Te.LEVEL_1000.RANGE.MIN,k=Te.LEVEL_1000.RANGE.MAX,C=Te.LEVEL_1000.RANGE.MIN,L=Te.LEVEL_1000.RANGE.MAX;if(u===Te.LEVEL_5000.LEVEL){const q=Number(n[6]);q===1?(k=(Te.LEVEL_1000.RANGE.MAX+1)/2,L=(Te.LEVEL_1000.RANGE.MAX+1)/2):q===2?(k=(Te.LEVEL_1000.RANGE.MAX+1)/2,C=(Te.LEVEL_1000.RANGE.MAX+1)/2):q===3?(M=(Te.LEVEL_1000.RANGE.MAX+1)/2,L=(Te.LEVEL_1000.RANGE.MAX+1)/2):q===4&&(M=(Te.LEVEL_1000.RANGE.MAX+1)/2,C=(Te.LEVEL_1000.RANGE.MAX+1)/2)}else if(u===Te.LEVEL_2000.LEVEL){const q=Number(n[7]),X=Number(n[6]);M=X,k=X+1,C=q,L=q+1}if(h.forEach(q=>{for(let X=M;X<=k;X++)for(let W=C;W<=L;W++)g.push(`${q}${X}${W}`)}),s===Te.LEVEL_1000.LEVEL)return g}else g.push(n.slice(0,Te.LEVEL_1000.DIGIT));const m=[];if(u>Te.LEVEL_500.LEVEL){if(g.forEach(M=>{for(let k=Te.LEVEL_500.RANGE.MIN;k<=Te.LEVEL_500.RANGE.MAX;k++)m.push(`${M}${k}`)}),s===Te.LEVEL_500.LEVEL)return m}else m.push(n.slice(0,Te.LEVEL_500.DIGIT));const c=[];if(u>Te.LEVEL_250.LEVEL){if(m.forEach(M=>{for(let k=Te.LEVEL_250.RANGE.MIN;k<=Te.LEVEL_250.RANGE.MAX;k++)c.push(`${M}${k}`)}),s===Te.LEVEL_250.LEVEL)return c}else c.push(n.slice(0,Te.LEVEL_250.DIGIT));const I=[];if(u>Te.LEVEL_125.LEVEL&&(c.forEach(M=>{for(let k=Te.LEVEL_125.RANGE.MIN;k<=Te.LEVEL_125.RANGE.MAX;k++)I.push(`${M}${k}`)}),s===Te.LEVEL_125.LEVEL))return I}}static getCodesWithinBounds(n,s=Te.LEVEL_80000.LEVEL){if(Yl.includes(s)===!1)throw new Error(`${s} is invalid level. available : ${Yl.join(", ")}`);const u=n.getNorthEast(),h=n.getSouthWest(),g=u.lat-h.lat,m=u.lng-h.lng,c=q5(s),I=c.LAT,M=c.LNG,k=Math.ceil(g/I)+1,C=Math.ceil(m/M)+1,L=[],q=1e-8;for(let X=0;X<=k;X++)for(let W=0;W<=C;W++){const ae=Math.min(Math.max(h.lat+I*X-I/2,h.lat+q),u.lat-q),Ie=Math.min(Math.max(h.lng+M*W-M/2,h.lng+q),u.lng-q);try{const ee=Po.toCode(ae,Ie,s);L.includes(ee)||L.push(ee)}catch{}}return L}}function nf(e){if(e.length!==Te.LEVEL_80000.DIGIT&&e.length!==Te.LEVEL_10000.DIGIT&&e.length!==Te.LEVEL_5000.DIGIT&&e.length!==Te.LEVEL_2000.DIGIT&&e.length!==Te.LEVEL_1000.DIGIT&&e.length!==Te.LEVEL_500.DIGIT&&e.length!==Te.LEVEL_250.DIGIT&&e.length!==Te.LEVEL_125.DIGIT||!Cw.includes(e.slice(0,Te.LEVEL_80000.DIGIT)))return!1;if(e.length>=Te.LEVEL_10000.DIGIT){const n=Number(e[4]),s=Number(e[5]);if(n<Te.LEVEL_10000.RANGE.MIN||n>Te.LEVEL_10000.RANGE.MAX||s<Te.LEVEL_10000.RANGE.MIN||s>Te.LEVEL_10000.RANGE.MAX)return!1}if(kw(e)){if(e.length===Te.LEVEL_5000.DIGIT){const n=Number(e[6]);if(n<Te.LEVEL_5000.RANGE.MIN||n>Te.LEVEL_5000.RANGE.MAX)return!1}else if(e.length===Te.LEVEL_2000.DIGIT){const n=Number(e[6]),s=Number(e[7]),u=[0,2,4,6,8];if(!u.includes(n)||!u.includes(s))return!1}}else{if(e.length>=Te.LEVEL_1000.DIGIT){const n=Number(e[6]),s=Number(e[7]);if(n<Te.LEVEL_1000.RANGE.MIN||n>Te.LEVEL_1000.RANGE.MAX||s<Te.LEVEL_1000.RANGE.MIN||s>Te.LEVEL_1000.RANGE.MAX)return!1}if(e.length>=Te.LEVEL_500.DIGIT){const n=Number(e[8]);if(n<Te.LEVEL_500.RANGE.MIN||n>Te.LEVEL_500.RANGE.MAX)return!1}if(e.length>=Te.LEVEL_250.DIGIT){const n=Number(e[9]);if(n<Te.LEVEL_250.RANGE.MIN||n>Te.LEVEL_250.RANGE.MAX)return!1}if(e.length>=Te.LEVEL_125.DIGIT){const n=Number(e[10]);if(n<Te.LEVEL_125.RANGE.MIN||n>Te.LEVEL_125.RANGE.MAX)return!1}}return!0}function lx(e,n,s,u){let h=e;const m=Po.toLatLngBounds(e).getSouthWest();if(u===Te.LEVEL_5000.LEVEL){const c=Math.floor((n-m.lat)/Te.LEVEL_5000.DISTANCE.LAT),I=Math.floor((s-m.lng)/Te.LEVEL_5000.DISTANCE.LNG);I===0&&c===0?h+="1":I===1&&c===0?h+="2":I===0&&c===1?h+="3":h+="4"}else if(u===Te.LEVEL_2000.LEVEL){const c=Math.floor((n-m.lat)/Te.LEVEL_2000.DISTANCE.LAT)*2,I=Math.floor((s-m.lng)/Te.LEVEL_2000.DISTANCE.LNG)*2;h+=`${c}${I}5`}return h}function cx(e){if(nf(e)===!1)throw new Error(`'${e}' is invalid mesh code.`);const n=Number(e.slice(2,4)),s=Number(e.slice(0,2));let u=0,h=0,g=0,m=0;if(e.length>=Te.LEVEL_80000.DIGIT&&(u=Te.LEVEL_80000.SECTION.LNG.MIN+(n-Te.LEVEL_80000.SECTION.X.MIN)*Te.LEVEL_80000.DISTANCE.LNG,h=u+Te.LEVEL_80000.DISTANCE.LNG,g=Te.LEVEL_80000.SECTION.LAT.MIN+(s-Te.LEVEL_80000.SECTION.Y.MIN)*Te.LEVEL_80000.DISTANCE.LAT,m=g+Te.LEVEL_80000.DISTANCE.LAT),e.length>=Te.LEVEL_10000.DIGIT){const C=Number(e[5]),L=Number(e[4]);u+=C*Te.LEVEL_10000.DISTANCE.LNG,h=u+Te.LEVEL_10000.DISTANCE.LNG,g+=L*Te.LEVEL_10000.DISTANCE.LAT,m=g+Te.LEVEL_10000.DISTANCE.LAT}if(kw(e)){if(e.length===Te.LEVEL_5000.DIGIT){const C=Number(e[6]),L=C===1||C===3?0:1,q=C===1||C===2?0:1;u+=L*Te.LEVEL_5000.DISTANCE.LNG,h=u+Te.LEVEL_5000.DISTANCE.LNG,g+=q*Te.LEVEL_5000.DISTANCE.LAT,m=g+Te.LEVEL_5000.DISTANCE.LAT}else if(e.length===Te.LEVEL_2000.DIGIT){const C=Number(e[7]),L=Number(e[6]);u+=C/2*Te.LEVEL_2000.DISTANCE.LNG,h=u+Te.LEVEL_2000.DISTANCE.LNG,g+=L/2*Te.LEVEL_2000.DISTANCE.LAT,m=g+Te.LEVEL_2000.DISTANCE.LAT}}else{if(e.length>=Te.LEVEL_1000.DIGIT){const C=Number(e[7]),L=Number(e[6]);u+=C*Te.LEVEL_1000.DISTANCE.LNG,h=u+Te.LEVEL_1000.DISTANCE.LNG,g+=L*Te.LEVEL_1000.DISTANCE.LAT,m=g+Te.LEVEL_1000.DISTANCE.LAT}if(e.length>=Te.LEVEL_500.DIGIT){const C=Number(e[8]),L=C===1||C===3?0:1,q=C===1||C===2?0:1;u+=L*Te.LEVEL_500.DISTANCE.LNG,h=u+Te.LEVEL_500.DISTANCE.LNG,g+=q*Te.LEVEL_500.DISTANCE.LAT,m=g+Te.LEVEL_500.DISTANCE.LAT}if(e.length>=Te.LEVEL_250.DIGIT){const C=Number(e[9]),L=C===1||C===3?0:1,q=C===1||C===2?0:1;u+=L*Te.LEVEL_250.DISTANCE.LNG,h=u+Te.LEVEL_250.DISTANCE.LNG,g+=q*Te.LEVEL_250.DISTANCE.LAT,m=g+Te.LEVEL_250.DISTANCE.LAT}if(e.length>=Te.LEVEL_125.DIGIT){const C=Number(e[10]),L=C===1||C===3?0:1,q=C===1||C===2?0:1;u+=L*Te.LEVEL_125.DISTANCE.LNG,h=u+Te.LEVEL_125.DISTANCE.LNG,g+=q*Te.LEVEL_125.DISTANCE.LAT,m=g+Te.LEVEL_125.DISTANCE.LAT}}return[[h,m],[u,m],[u,g],[h,g]]}function U5(e,n={}){return e.push(e[0]),{type:"Feature",properties:n,geometry:{type:"Polygon",coordinates:[e]}}}function kw(e){return e.length===Te.LEVEL_10000.DIGIT||e.length===Te.LEVEL_5000.DIGIT||e.length===Te.LEVEL_2000.DIGIT&&e[e.length-1]==="5"}function q5(e){switch(e){case Te.LEVEL_10000.LEVEL:return Te.LEVEL_10000.DISTANCE;case Te.LEVEL_5000.LEVEL:return Te.LEVEL_5000.DISTANCE;case Te.LEVEL_2000.LEVEL:return Te.LEVEL_2000.DISTANCE;case Te.LEVEL_1000.LEVEL:return Te.LEVEL_1000.DISTANCE;case Te.LEVEL_500.LEVEL:return Te.LEVEL_500.DISTANCE;case Te.LEVEL_250.LEVEL:return Te.LEVEL_250.DISTANCE;case Te.LEVEL_125.LEVEL:return Te.LEVEL_125.DISTANCE;default:return Te.LEVEL_80000.DISTANCE}}const zn={toCode:Po.toCode,toLatLngBounds:Po.toLatLngBounds,toGeoJSON:Po.toGeoJSON,getLevel:Po.getLevel,getCodes:Po.getCodes,getCodesWithinBounds:Po.getCodesWithinBounds};var lc=Math.pow,ln=(e,n,s)=>new Promise((u,h)=>{var g=I=>{try{c(s.next(I))}catch(M){h(M)}},m=I=>{try{c(s.throw(I))}catch(M){h(M)}},c=I=>I.done?u(I.value):Promise.resolve(I.value).then(g,m);c((s=s.apply(e,n)).next())}),On=Uint8Array,Qu=Uint16Array,H5=Int32Array,Mw=new On([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Lw=new On([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),G5=new On([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Pw=function(e,n){for(var s=new Qu(31),u=0;u<31;++u)s[u]=n+=1<<e[u-1];for(var h=new H5(s[30]),u=1;u<30;++u)for(var g=s[u];g<s[u+1];++g)h[g]=g-s[u]<<5|u;return{b:s,r:h}},zw=Pw(Mw,2),Dw=zw.b,Z5=zw.r;Dw[28]=258,Z5[258]=28;var W5=Pw(Lw,0),K5=W5.b,Rw=new Qu(32768);for(vi=0;vi<32768;++vi)cs=(vi&43690)>>1|(vi&21845)<<1,cs=(cs&52428)>>2|(cs&13107)<<2,cs=(cs&61680)>>4|(cs&3855)<<4,Rw[vi]=((cs&65280)>>8|(cs&255)<<8)>>1;var cs,vi,eh=function(e,n,s){for(var u=e.length,h=0,g=new Qu(n);h<u;++h)e[h]&&++g[e[h]-1];var m=new Qu(n);for(h=1;h<n;++h)m[h]=m[h-1]+g[h-1]<<1;var c;{c=new Qu(1<<n);var I=15-n;for(h=0;h<u;++h)if(e[h])for(var M=h<<4|e[h],k=n-e[h],C=m[e[h]-1]++<<k,L=C|(1<<k)-1;C<=L;++C)c[Rw[C]>>I]=M}return c},vh=new On(288);for(vi=0;vi<144;++vi)vh[vi]=8;var vi;for(vi=144;vi<256;++vi)vh[vi]=9;var vi;for(vi=256;vi<280;++vi)vh[vi]=7;var vi;for(vi=280;vi<288;++vi)vh[vi]=8;var vi,Ow=new On(32);for(vi=0;vi<32;++vi)Ow[vi]=5;var vi,X5=eh(vh,9),J5=eh(Ow,5),Lm=function(e){for(var n=e[0],s=1;s<e.length;++s)e[s]>n&&(n=e[s]);return n},fo=function(e,n,s){var u=n/8|0;return(e[u]|e[u+1]<<8)>>(n&7)&s},Pm=function(e,n){var s=n/8|0;return(e[s]|e[s+1]<<8|e[s+2]<<16)>>(n&7)},Y5=function(e){return(e+7)/8|0},Q5=function(e,n,s){(s==null||s>e.length)&&(s=e.length);var u=new On(s-n);return u.set(e.subarray(n,s)),u},eD=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Rn=function(e,n,s){var u=new Error(n||eD[e]);if(u.code=e,Error.captureStackTrace&&Error.captureStackTrace(u,Rn),!s)throw u;return u},Ly=function(e,n,s,u){var h=e.length,g=0;if(!h||n.f&&!n.l)return s||new On(0);var m=!s||n.i!=2,c=n.i;s||(s=new On(h*3));var I=function(pr){var Fr=s.length;if(pr>Fr){var lr=new On(Math.max(Fr*2,pr));lr.set(s),s=lr}},M=n.f||0,k=n.p||0,C=n.b||0,L=n.l,q=n.d,X=n.m,W=n.n,ae=h*8;do{if(!L){M=fo(e,k,1);var Ie=fo(e,k+1,3);if(k+=3,Ie)if(Ie==1)L=X5,q=J5,X=9,W=5;else if(Ie==2){var ne=fo(e,k,31)+257,oe=fo(e,k+10,15)+4,Ae=ne+fo(e,k+5,31)+1;k+=14;for(var be=new On(Ae),Le=new On(19),me=0;me<oe;++me)Le[G5[me]]=fo(e,k+me*3,7);k+=oe*3;for(var ke=Lm(Le),Me=(1<<ke)-1,Oe=eh(Le,ke),me=0;me<Ae;){var Ge=Oe[fo(e,k,Me)];k+=Ge&15;var ee=Ge>>4;if(ee<16)be[me++]=ee;else{var rt=0,Ke=0;for(ee==16?(Ke=3+fo(e,k,3),k+=2,rt=be[me-1]):ee==17?(Ke=3+fo(e,k,7),k+=3):ee==18&&(Ke=11+fo(e,k,127),k+=7);Ke--;)be[me++]=rt}}var dt=be.subarray(0,ne),nt=be.subarray(ne);X=Lm(dt),W=Lm(nt),L=eh(dt,X),q=eh(nt,W)}else Rn(1);else{var ee=Y5(k)+4,H=e[ee-4]|e[ee-3]<<8,ce=ee+H;if(ce>h){c&&Rn(0);break}m&&I(C+H),s.set(e.subarray(ee,ce),C),n.b=C+=H,n.p=k=ce*8,n.f=M;continue}if(k>ae){c&&Rn(0);break}}m&&I(C+131072);for(var ti=(1<<X)-1,Ut=(1<<W)-1,Nt=k;;Nt=k){var rt=L[Pm(e,k)&ti],jt=rt>>4;if(k+=rt&15,k>ae){c&&Rn(0);break}if(rt||Rn(2),jt<256)s[C++]=jt;else if(jt==256){Nt=k,L=null;break}else{var Si=jt-254;if(jt>264){var me=jt-257,Qi=Mw[me];Si=fo(e,k,(1<<Qi)-1)+Dw[me],k+=Qi}var Oi=q[Pm(e,k)&Ut],fi=Oi>>4;Oi||Rn(3),k+=Oi&15;var nt=K5[fi];if(fi>3){var Qi=Lw[fi];nt+=Pm(e,k)&(1<<Qi)-1,k+=Qi}if(k>ae){c&&Rn(0);break}m&&I(C+131072);var Pi=C+Si;if(C<nt){var Bi=g-nt,Br=Math.min(nt,Pi);for(Bi+C<0&&Rn(3);C<Br;++C)s[C]=u[Bi+C]}for(;C<Pi;C+=4)s[C]=s[C-nt],s[C+1]=s[C+1-nt],s[C+2]=s[C+2-nt],s[C+3]=s[C+3-nt];C=Pi}}n.l=L,n.p=Nt,n.b=C,n.f=M,L&&(M=1,n.m=X,n.d=q,n.n=W)}while(!M);return C==s.length?s:Q5(s,0,C)},tD=new On(0),iD=function(e){(e[0]!=31||e[1]!=139||e[2]!=8)&&Rn(6,"invalid gzip data");var n=e[3],s=10;n&4&&(s+=(e[10]|e[11]<<8)+2);for(var u=(n>>3&1)+(n>>4&1);u>0;u-=!e[s++]);return s+(n&2)},rD=function(e){var n=e.length;return(e[n-4]|e[n-3]<<8|e[n-2]<<16|e[n-1]<<24)>>>0},nD=function(e,n){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&Rn(6,"invalid zlib data"),(e[1]>>5&1)==+!n&&Rn(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function oD(e,n){return Ly(e,{i:2},n,n)}function sD(e,n){var s=iD(e);return s+8>e.length&&Rn(6,"invalid gzip data"),Ly(e.subarray(s,-8),{i:2},new On(rD(e)),n)}function aD(e,n){return Ly(e.subarray(nD(e,n),-4),{i:2},n,n)}function Tg(e,n){return e[0]==31&&e[1]==139&&e[2]==8?sD(e,n):(e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31?oD(e,n):aD(e,n)}var lD=typeof TextDecoder<"u"&&new TextDecoder,cD=0;try{lD.decode(tD,{stream:!0}),cD=1}catch{}var Bw=(e,n)=>e*lc(2,n),Vu=(e,n)=>Math.floor(e/lc(2,n)),Af=(e,n)=>Bw(e.getUint16(n+1,!0),8)+e.getUint8(n),Fw=(e,n)=>Bw(e.getUint32(n+2,!0),16)+e.getUint16(n,!0),uD=(e,n,s,u,h)=>{if(e!==u.getUint8(h))return e-u.getUint8(h);const g=Af(u,h+1);if(n!==g)return n-g;const m=Af(u,h+4);return s!==m?s-m:0},hD=(e,n,s,u)=>{const h=Vw(e,n|128,s,u);return h?{z:n,x:s,y:u,offset:h[0],length:h[1],isDir:!0}:null},ux=(e,n,s,u)=>{const h=Vw(e,n,s,u);return h?{z:n,x:s,y:u,offset:h[0],length:h[1],isDir:!1}:null},Vw=(e,n,s,u)=>{let h=0,g=e.byteLength/17-1;for(;h<=g;){const m=g+h>>1,c=uD(n,s,u,e,m*17);if(c>0)h=m+1;else if(c<0)g=m-1;else return[Fw(e,m*17+7),e.getUint32(m*17+13,!0)]}return null},dD=(e,n)=>e.isDir&&!n.isDir?1:!e.isDir&&n.isDir?-1:e.z!==n.z?e.z-n.z:e.x!==n.x?e.x-n.x:e.y-n.y,Nw=(e,n)=>{const s=e.getUint8(n*17);return{z:s&127,x:Af(e,n*17+1),y:Af(e,n*17+4),offset:Fw(e,n*17+7),length:e.getUint32(n*17+13,!0),isDir:s>>7===1}},hx=e=>{const n=[],s=new DataView(e);for(let u=0;u<s.byteLength/17;u++)n.push(Nw(s,u));return fD(n)},fD=e=>{e.sort(dD);const n=new ArrayBuffer(17*e.length),s=new Uint8Array(n);for(let u=0;u<e.length;u++){const h=e[u];let g=h.z;h.isDir&&(g=g|128),s[u*17]=g,s[u*17+1]=h.x&255,s[u*17+2]=h.x>>8&255,s[u*17+3]=h.x>>16&255,s[u*17+4]=h.y&255,s[u*17+5]=h.y>>8&255,s[u*17+6]=h.y>>16&255,s[u*17+7]=h.offset&255,s[u*17+8]=Vu(h.offset,8)&255,s[u*17+9]=Vu(h.offset,16)&255,s[u*17+10]=Vu(h.offset,24)&255,s[u*17+11]=Vu(h.offset,32)&255,s[u*17+12]=Vu(h.offset,48)&255,s[u*17+13]=h.length&255,s[u*17+14]=h.length>>8&255,s[u*17+15]=h.length>>16&255,s[u*17+16]=h.length>>24&255}return n},pD=(e,n)=>{if(e.byteLength<17)return null;const s=e.byteLength/17,u=Nw(e,s-1);if(u.isDir){const h=u.z,g=n.z-h,m=Math.trunc(n.x/(1<<g)),c=Math.trunc(n.y/(1<<g));return{z:h,x:m,y:c}}return null};function mD(e){return ln(this,null,function*(){const n=yield e.getBytes(0,512e3),s=new DataView(n.data),u=s.getUint32(4,!0),h=s.getUint16(8,!0),g=new TextDecoder("utf-8"),m=JSON.parse(g.decode(new DataView(n.data,10,u)));let c=0;m.compression==="gzip"&&(c=2);let I=0;"minzoom"in m&&(I=+m.minzoom);let M=0;"maxzoom"in m&&(M=+m.maxzoom);let k=0,C=0,L=0,q=-180,X=-85,W=180,ae=85;if(m.bounds){const ee=m.bounds.split(",");q=+ee[0],X=+ee[1],W=+ee[2],ae=+ee[3]}if(m.center){const ee=m.center.split(",");k=+ee[0],C=+ee[1],L=+ee[2]}return{specVersion:s.getUint16(2,!0),rootDirectoryOffset:10+u,rootDirectoryLength:h*17,jsonMetadataOffset:10,jsonMetadataLength:u,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:c,tileType:1,minZoom:I,maxZoom:M,minLon:q,minLat:X,maxLon:W,maxLat:ae,centerZoom:L,centerLon:k,centerLat:C,etag:n.etag}})}function gD(e,n,s,u,h,g,m){return ln(this,null,function*(){let c=yield s.getArrayBuffer(n,e.rootDirectoryOffset,e.rootDirectoryLength,e);e.specVersion===1&&(c=hx(c));const I=ux(new DataView(c),u,h,g);if(I){let C=(yield n.getBytes(I.offset,I.length,m)).data;const L=new DataView(C);return L.getUint8(0)===31&&L.getUint8(1)===139&&(C=Tg(new Uint8Array(C))),{data:C}}const M=pD(new DataView(c),{z:u,x:h,y:g});if(M){const k=hD(new DataView(c),M.z,M.x,M.y);if(k){let C=yield s.getArrayBuffer(n,k.offset,k.length,e);e.specVersion===1&&(C=hx(C));const L=ux(new DataView(C),u,h,g);if(L){let X=(yield n.getBytes(L.offset,L.length,m)).data;const W=new DataView(X);return W.getUint8(0)===31&&W.getUint8(1)===139&&(X=Tg(new Uint8Array(X))),{data:X}}}}})}var $w={getHeader:mD,getZxy:gD},yD=e=>(n,s)=>{if(s instanceof AbortController)return e(n,s);const u=new AbortController;return e(n,u).then(h=>s(void 0,h.data,h.cacheControl||"",h.expires||""),h=>s(h)).catch(h=>s(h)),{cancel:()=>u.abort()}},_D=class{constructor(){this.tilev4=(e,n)=>ln(this,null,function*(){if(e.type==="json"){const C=e.url.substr(10);let L=this.tiles.get(C);L||(L=new dx(C),this.tiles.set(C,L));const q=yield L.getHeader();return{data:{tiles:[`${e.url}/{z}/{x}/{y}`],minzoom:q.minZoom,maxzoom:q.maxZoom,bounds:[q.minLon,q.minLat,q.maxLon,q.maxLat]}}}const s=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),u=e.url.match(s);if(!u)throw new Error("Invalid PMTiles protocol URL");const h=u[1];let g=this.tiles.get(h);g||(g=new dx(h),this.tiles.set(h,g));const m=u[2],c=u[3],I=u[4],M=yield g.getHeader(),k=yield g==null?void 0:g.getZxy(+m,+c,+I,n.signal);return k?{data:new Uint8Array(k.data),cacheControl:k.cacheControl,expires:k.expires}:M.tileType===1?{data:new Uint8Array}:{data:null}}),this.tile=yD(this.tilev4),this.tiles=new Map}add(e){this.tiles.set(e.source.getKey(),e)}get(e){return this.tiles.get(e)}};function Ql(e,n){return(n>>>0)*4294967296+(e>>>0)}function vD(e,n){const s=n.buf;let u=s[n.pos++],h=(u&112)>>4;if(u<128||(u=s[n.pos++],h|=(u&127)<<3,u<128)||(u=s[n.pos++],h|=(u&127)<<10,u<128)||(u=s[n.pos++],h|=(u&127)<<17,u<128)||(u=s[n.pos++],h|=(u&127)<<24,u<128)||(u=s[n.pos++],h|=(u&1)<<31,u<128))return Ql(e,h);throw new Error("Expected varint not more than 10 bytes")}function Nu(e){const n=e.buf;let s=n[e.pos++],u=s&127;return s<128||(s=n[e.pos++],u|=(s&127)<<7,s<128)||(s=n[e.pos++],u|=(s&127)<<14,s<128)||(s=n[e.pos++],u|=(s&127)<<21,s<128)?u:(s=n[e.pos],u|=(s&15)<<28,vD(u,e))}function xD(e,n,s,u){if(u===0){s===1&&(n[0]=e-1-n[0],n[1]=e-1-n[1]);const h=n[0];n[0]=n[1],n[1]=h}}var bD=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function wD(e,n,s){if(e>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(n>lc(2,e)-1||s>lc(2,e)-1)throw Error("tile x/y outside zoom level bounds");const u=bD[e],h=lc(2,e);let g=0,m=0,c=0;const I=[n,s];let M=h/2;for(;M>0;)g=(I[0]&M)>0?1:0,m=(I[1]&M)>0?1:0,c+=M*M*(3*g^m),xD(M,I,g,m),M=M/2;return u+c}function jw(e,n){return ln(this,null,function*(){if(n===1||n===0)return e;if(n===2){if(typeof globalThis.DecompressionStream>"u")return Tg(new Uint8Array(e));const s=new Response(e).body;if(!s)throw Error("Failed to read response stream");const u=s.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(u).arrayBuffer()}throw Error("Compression method not supported")})}var ED=127;function SD(e,n){let s=0,u=e.length-1;for(;s<=u;){const h=u+s>>1,g=n-e[h].tileId;if(g>0)s=h+1;else if(g<0)u=h-1;else return e[h]}return u>=0&&(e[u].runLength===0||n-e[u].tileId<e[u].runLength)?e[u]:null}var ID=class{constructor(e,n=new Headers){this.url=e,this.customHeaders=n,this.mustReload=!1}getKey(){return this.url}setHeaders(e){this.customHeaders=e}getBytes(e,n,s,u){return ln(this,null,function*(){let h,g;s?g=s:(h=new AbortController,g=h.signal);const m=new Headers(this.customHeaders);m.set("range",`bytes=${e}-${e+n-1}`);let c;this.mustReload&&(c="reload");let I=yield fetch(this.url,{signal:g,cache:c,headers:m});if(e===0&&I.status===416){const L=I.headers.get("Content-Range");if(!L||!L.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const q=+L.substr(8);I=yield fetch(this.url,{signal:g,cache:"reload",headers:{range:`bytes=0-${q-1}`}})}let M=I.headers.get("Etag");if(M!=null&&M.startsWith("W/")&&(M=null),I.status===416||u&&M&&M!==u)throw this.mustReload=!0,new Cg(u);if(I.status>=300)throw Error(`Bad response code: ${I.status}`);const k=I.headers.get("Content-Length");if(I.status===200&&(!k||+k>n))throw h&&h.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield I.arrayBuffer(),etag:M||void 0,cacheControl:I.headers.get("Cache-Control")||void 0,expires:I.headers.get("Expires")||void 0}})}};function po(e,n){const s=e.getUint32(n+4,!0),u=e.getUint32(n+0,!0);return s*lc(2,32)+u}function TD(e,n){const s=new DataView(e),u=s.getUint8(7);if(u>3)throw Error(`Archive is spec version ${u} but this library supports up to spec version 3`);return{specVersion:u,rootDirectoryOffset:po(s,8),rootDirectoryLength:po(s,16),jsonMetadataOffset:po(s,24),jsonMetadataLength:po(s,32),leafDirectoryOffset:po(s,40),leafDirectoryLength:po(s,48),tileDataOffset:po(s,56),tileDataLength:po(s,64),numAddressedTiles:po(s,72),numTileEntries:po(s,80),numTileContents:po(s,88),clustered:s.getUint8(96)===1,internalCompression:s.getUint8(97),tileCompression:s.getUint8(98),tileType:s.getUint8(99),minZoom:s.getUint8(100),maxZoom:s.getUint8(101),minLon:s.getInt32(102,!0)/1e7,minLat:s.getInt32(106,!0)/1e7,maxLon:s.getInt32(110,!0)/1e7,maxLat:s.getInt32(114,!0)/1e7,centerZoom:s.getUint8(118),centerLon:s.getInt32(119,!0)/1e7,centerLat:s.getInt32(123,!0)/1e7,etag:n}}function Uw(e){const n={buf:new Uint8Array(e),pos:0},s=Nu(n),u=[];let h=0;for(let g=0;g<s;g++){const m=Nu(n);u.push({tileId:h+m,offset:0,length:0,runLength:1}),h+=m}for(let g=0;g<s;g++)u[g].runLength=Nu(n);for(let g=0;g<s;g++)u[g].length=Nu(n);for(let g=0;g<s;g++){const m=Nu(n);m===0&&g>0?u[g].offset=u[g-1].offset+u[g-1].length:u[g].offset=m-1}return u}function CD(e){const n=new DataView(e);return n.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):n.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var Cg=class extends Error{};function AD(e,n){return ln(this,null,function*(){const s=yield e.getBytes(0,16384);if(new DataView(s.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if(CD(s.data)<3)return[yield $w.getHeader(e)];const h=s.data.slice(0,ED),g=TD(h,s.etag),m=s.data.slice(g.rootDirectoryOffset,g.rootDirectoryOffset+g.rootDirectoryLength),c=`${e.getKey()}|${g.etag||""}|${g.rootDirectoryOffset}|${g.rootDirectoryLength}`,I=Uw(yield n(m,g.internalCompression));return[g,[c,I.length,I]]})}function kD(e,n,s,u,h){return ln(this,null,function*(){const g=yield e.getBytes(s,u,void 0,h.etag),m=yield n(g.data,h.internalCompression),c=Uw(m);if(c.length===0)throw new Error("Empty directory is invalid");return c})}var MD=class{constructor(e=100,n=!0,s=jw){this.cache=new Map,this.invalidations=new Map,this.maxCacheEntries=e,this.counter=1,this.decompress=s}getHeader(e){return ln(this,null,function*(){const n=e.getKey(),s=this.cache.get(n);if(s)return s.lastUsed=this.counter++,yield s.data;const u=new Promise((h,g)=>{AD(e,this.decompress).then(m=>{m[1]&&this.cache.set(m[1][0],{lastUsed:this.counter++,data:Promise.resolve(m[1][2])}),h(m[0]),this.prune()}).catch(m=>{g(m)})});return this.cache.set(n,{lastUsed:this.counter++,data:u}),u})}getDirectory(e,n,s,u){return ln(this,null,function*(){const h=`${e.getKey()}|${u.etag||""}|${n}|${s}`,g=this.cache.get(h);if(g)return g.lastUsed=this.counter++,yield g.data;const m=new Promise((c,I)=>{kD(e,this.decompress,n,s,u).then(M=>{c(M),this.prune()}).catch(M=>{I(M)})});return this.cache.set(h,{lastUsed:this.counter++,data:m}),m})}getArrayBuffer(e,n,s,u){return ln(this,null,function*(){const h=`${e.getKey()}|${u.etag||""}|${n}|${s}`,g=this.cache.get(h);if(g)return g.lastUsed=this.counter++,yield g.data;const m=new Promise((c,I)=>{e.getBytes(n,s,void 0,u.etag).then(M=>{c(M.data),this.cache.has(h),this.prune()}).catch(M=>{I(M)})});return this.cache.set(h,{lastUsed:this.counter++,data:m}),m})}prune(){if(this.cache.size>=this.maxCacheEntries){let e=1/0,n;this.cache.forEach((s,u)=>{s.lastUsed<e&&(e=s.lastUsed,n=u)}),n&&this.cache.delete(n)}}invalidate(e){return ln(this,null,function*(){const n=e.getKey();if(this.invalidations.get(n))return yield this.invalidations.get(n);this.cache.delete(e.getKey());const s=new Promise((u,h)=>{this.getHeader(e).then(g=>{u(),this.invalidations.delete(n)}).catch(g=>{h(g)})});this.invalidations.set(n,s)})}},dx=class{constructor(e,n,s){typeof e=="string"?this.source=new ID(e):this.source=e,s?this.decompress=s:this.decompress=jw,n?this.cache=n:this.cache=new MD}getHeader(){return ln(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(e,n,s,u){return ln(this,null,function*(){const h=wD(e,n,s),g=yield this.cache.getHeader(this.source);if(g.specVersion<3)return $w.getZxy(g,this.source,this.cache,e,n,s,u);if(e<g.minZoom||e>g.maxZoom)return;let m=g.rootDirectoryOffset,c=g.rootDirectoryLength;for(let I=0;I<=3;I++){const M=yield this.cache.getDirectory(this.source,m,c,g),k=SD(M,h);if(k){if(k.runLength>0){const C=yield this.source.getBytes(g.tileDataOffset+k.offset,k.length,u,g.etag);return{data:yield this.decompress(C.data,g.tileCompression),cacheControl:C.cacheControl,expires:C.expires}}m=g.leafDirectoryOffset+k.offset,c=k.length}else return}throw Error("Maximum directory depth exceeded")})}getZxy(e,n,s,u){return ln(this,null,function*(){try{return yield this.getZxyAttempt(e,n,s,u)}catch(h){if(h instanceof Cg)return this.cache.invalidate(this.source),yield this.getZxyAttempt(e,n,s,u);throw h}})}getMetadataAttempt(){return ln(this,null,function*(){const e=yield this.cache.getHeader(this.source),n=yield this.source.getBytes(e.jsonMetadataOffset,e.jsonMetadataLength,void 0,e.etag),s=yield this.decompress(n.data,e.internalCompression),u=new TextDecoder("utf-8");return JSON.parse(u.decode(s))})}getMetadata(){return ln(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(e){if(e instanceof Cg)return this.cache.invalidate(this.source),yield this.getMetadataAttempt();throw e}})}};const fx={LIGHT:"https://tiles.geodig.jp/styles/white.json",DARK:"https://tiles.geodig.jp/styles/black.json"},zm=[{id:8e4,minZoom:4,maxZoom:8,level:"80km",name:"80倍地域メッシュ(第1次地域区画)"},{id:1e4,minZoom:8,maxZoom:11,level:"10km",name:"10倍地域メッシュ(第2次地域区画)"},{id:5e3,minZoom:11,maxZoom:12,level:"5km",name:"5倍地域メッシュ"},{id:2e3,minZoom:12,maxZoom:13,level:"2km",name:"2倍地域メッシュ"},{id:1e3,minZoom:13,maxZoom:14,level:"1km",name:"基準地域メッシュ(第3次地域区画)"},{id:500,minZoom:14,maxZoom:15,level:"500m",name:"2分の1地域メッシュ"},{id:250,minZoom:15,maxZoom:16,level:"250m",name:"4分の1地域メッシュ"},{id:125,minZoom:16,maxZoom:18,level:"125m",name:"8分の1地域メッシュ"}],LD=e=>(Gx("data-v-f2133f8b"),e=e(),Zx(),e),PD={class:"relative"},zD={class:"absolute top-2 left-2 z-10 flex items-center"},DD={class:"absolute top-2 right-2 z-10 flex items-center"},RD={class:"truncate"},OD={class:"truncate"},BD=LD(()=>$i("div",{id:"map"},null,-1)),FD=Ri({__name:"MeshMap",setup(e){const n=ty(),s=Vo(),u=$1(),h=Ew(),g=kt(n.query.code||""),m=kt(zm[0]),c=kt(!1);let I=null;const M=Ve(()=>u.preference==="light"?fx.LIGHT:fx.DARK),k=Ve(()=>{try{return zn.toGeoJSON(g.value),!0}catch{return!1}});Zi(u,()=>{if(!I)return;I.setStyle(M.value);const ee=W(I.getZoom());setTimeout(()=>C(I,ee),1e3)}),Zi(g,ee=>{if(I)try{const H=ee?zn.getLevel(ee):W(I.getZoom());C(I,H),s.push({query:{code:ee}})}catch{}}),Zi(m,ee=>{if(!I)return;c.value=!1;const H=I.getZoom();(H<=ee.minZoom||H>ee.maxZoom)&&I.setZoom(ee.maxZoom)}),Zi(c,ee=>{I&&(ee?(I.setMinZoom(m.value.minZoom),I.setMaxZoom(m.value.maxZoom)):(I.setMinZoom(4),I.setMaxZoom(18)))}),Wr(()=>{let ee=[138.517821,34.380147],H=4,ce=8e4;if(g.value){const Ae=zn.toLatLngBounds(g.value).getCenter();ee=[Ae.lng,Ae.lat],H=ae(g.value),ce=zn.getLevel(g.value)}I=new Tw.Map({container:"map",style:M.value,center:ee,zoom:H,minZoom:4,maxZoom:18});const ne=new _D;$5.addProtocol("pmtiles",ne.tile),I.on("load",()=>{I&&(C(I,ce),I.on("click","polygon-mesh-fill",oe=>{const be=oe.features[0].properties.code,me=zn.toLatLngBounds(be).getCenter(),ke=zn.getLevel(be);g.value=be,I&&(I.jumpTo({center:[me.lng,me.lat],zoom:ae(be)}),C(I,ke))}))}),I.on("moveend",()=>{if(!I)return;const oe=W(I.getZoom());C(I,oe)})});function C(ee,H){const ce=zm.find(ne=>ne.id===H);ce&&(m.value=ce),L(ee),q(ee,H)}async function L(ee,H){const ce=ee.getSource("polygon-selected-mesh");if(!(ce&&(await ce.getData()).properties.code===g.value)&&(ee.getLayer("polygon-selected-mesh")&&ee.removeLayer("polygon-selected-mesh"),ee.getSource("polygon-selected-mesh")&&ee.removeSource("polygon-selected-mesh"),g.value)){ee.addSource("polygon-selected-mesh",{type:"geojson",data:zn.toGeoJSON(g.value,{code:g.value})});const ne=ee.getLayer("polygon-mesh-line")?"polygon-mesh-line":void 0;ee.addLayer({id:"polygon-selected-mesh",type:"fill",source:"polygon-selected-mesh",paint:{"fill-color":"#f87171","fill-opacity":.5}},ne)}}async function q(ee,H){const ce=X(ee,H);if(!ce)return;const ne=ee.getSource("polygon-mesh");if(ne){const Le=(await ne.getData()).features.map(me=>me.properties.code);if(ce.sort().toString()===Le.sort().toString())return}const oe={type:"FeatureCollection",features:ce.map(be=>zn.toGeoJSON(be,{code:be}))},Ae={type:"FeatureCollection",features:ce.map(be=>{const me=zn.toLatLngBounds(be).getCenter();return{type:"Feature",geometry:{type:"Point",coordinates:[me.lng,me.lat]},properties:{code:be}}})};ee.getLayer("polygon-mesh-line")&&ee.removeLayer("polygon-mesh-line"),ee.getLayer("polygon-mesh-fill")&&ee.removeLayer("polygon-mesh-fill"),ee.getLayer("polygon-mesh-symbol")&&ee.removeLayer("polygon-mesh-symbol"),ee.getSource("polygon-mesh")&&ee.removeSource("polygon-mesh"),ee.getSource("center-mesh")&&ee.removeSource("center-mesh"),ee.addSource("polygon-mesh",{type:"geojson",data:oe}),ee.addSource("center-mesh",{type:"geojson",data:Ae}),ee.addLayer({id:"polygon-mesh-line",type:"line",source:"polygon-mesh",paint:{"line-color":"#f87171","line-width":1}}),ee.addLayer({id:"polygon-mesh-fill",type:"fill",source:"polygon-mesh",paint:{"fill-opacity":0}}),ee.addLayer({id:"polygon-mesh-symbol",type:"symbol",source:"center-mesh",layout:{"text-field":["get","code"],"text-font":["Open Sans Semibold","Arial Unicode MS Bold"],"text-size":["interpolate",["linear"],["zoom"],4,8,9,14],"text-anchor":"center","text-justify":"center","text-allow-overlap":!0},paint:{"text-halo-color":"#fff","text-halo-width":1}})}function X(ee,H){if(H){const ce=ee.getBounds().getNorthEast(),ne=ee.getBounds().getSouthWest(),oe=new Aw(ce.lat,ce.lng,ne.lat,ne.lng);return zn.getCodesWithinBounds(oe,H)}return zn.getCodes()}function W(ee){let H;return ee<=9?H=8e4:ee>9&&ee<=11?H=1e4:ee>11&&ee<=12?H=5e3:ee>12&&ee<=13?H=2e3:ee>13&&ee<=14?H=1e3:ee>14&&ee<=15?H=500:ee>15&&ee<=16?H=250:ee>16?H=125:H=8e4,H}function ae(ee){switch(zn.getLevel(ee)){case 8e4:return 9;case 1e4:return 11;case 5e3:return 12;case 2e3:return 13;case 1e3:return 14;case 500:return 15;case 250:return 16;case 125:return 17;default:return 4}}async function Ie(){const ee=zn.toGeoJSON(g.value,{code:g.value});await navigator.clipboard.writeText(JSON.stringify(ee,null,2)),h.add({color:"gray",icon:"i-heroicons-check-circle",title:"クリップボードにコピーしました"})}return(ee,H)=>{const ce=Wf,ne=wP,oe=b1,Ae=F5;return _t(),ri("div",PD,[$i("div",zD,[ei(ne,{modelValue:ni(g),"onUpdate:modelValue":H[1]||(H[1]=be=>fr(g)?g.value=be:null),name:"selectedCode",placeholder:"メッシュコード",icon:"i-heroicons-magnifying-glass-20-solid",autocomplete:"off",size:"md",ui:{icon:{trailing:{pointer:""}}}},{trailing:xr(()=>[XS(ei(ce,{color:"gray",variant:"link",icon:"i-heroicons-x-mark-20-solid",padded:!1,onClick:H[0]||(H[0]=be=>g.value="")},null,512),[[XI,ni(g)!==""]])]),_:1},8,["modelValue"]),ni(k)?(_t(),li(ce,{key:0,icon:"i-heroicons-clipboard-document",color:"white",variant:"solid",size:"md",class:"ml-2",onClick:Ie},{default:xr(()=>[mo(" GeoJSON をコピー ")]),_:1})):Li("",!0)]),$i("div",DD,[ei(Ae,{modelValue:ni(m),"onUpdate:modelValue":H[2]||(H[2]=be=>fr(m)?m.value=be:null),options:ni(zm),class:"w-80",disabled:ni(c)},{label:xr(()=>[ei(oe,{variant:"outline",class:"w-12 justify-center"},{default:xr(()=>[mo(Ur(ni(m).level),1)]),_:1}),$i("span",RD,Ur(ni(m).name),1)]),option:xr(({option:be})=>[ei(oe,{variant:"outline",class:"w-12 justify-center"},{default:xr(()=>[mo(Ur(be.level),1)]),_:2},1024),$i("span",OD,Ur(be.name),1)]),_:1},8,["modelValue","options","disabled"])]),BD])}}}),VD=jn(FD,[["__scopeId","data-v-f2133f8b"]]);function ND(e,n,s){let u=null;const{pause:h,resume:g,timestamp:m}=lk({controls:!0}),c=kt(null),I=Ve(()=>c.value?n-(m.value-c.value):0);function M(...W){u=setTimeout(()=>{u=null,c.value=null,e(...W)},I.value)}function k(){u&&(clearTimeout(u),u=null)}function C(){c.value=Date.now(),M()}function L(){k(),h()}function q(){k(),h()}function X(){M(),g(),c.value=(c.value||0)+(Date.now()-m.value)}return C(),{start:C,stop:L,pause:q,resume:X,remaining:I}}const $u=ys(Di.ui.strategy,Di.ui.notification,qM),$D=Ri({components:{UIcon:$o,UAvatar:Kf,UButton:Wf},inheritAttrs:!1,props:{id:{type:[String,Number],required:!0},title:{type:String,default:null},description:{type:String,default:null},icon:{type:String,default:()=>$u.default.icon},avatar:{type:Object,default:null},closeButton:{type:Object,default:()=>$u.default.closeButton},timeout:{type:Number,default:()=>$u.default.timeout},actions:{type:Array,default:()=>[]},callback:{type:Function,default:null},color:{type:String,default:()=>$u.default.color,validator(e){return["gray",...Di.ui.colors].includes(e)}},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},emits:["close"],setup(e,{emit:n}){const{ui:s,attrs:u}=ra("notification",Qn(e,"ui"),$u);let h=null;const g=kt(e.timeout),m=Ve(()=>{var W,ae;return fs(tr(s.value.wrapper,(W=s.value.background)==null?void 0:W.replaceAll("{color}",e.color),s.value.rounded,s.value.shadow,(ae=s.value.ring)==null?void 0:ae.replaceAll("{color}",e.color)),e.class)}),c=Ve(()=>{var W;return tr(s.value.progress.base,(W=s.value.progress.background)==null?void 0:W.replaceAll("{color}",e.color))}),I=Ve(()=>({width:`${g.value/e.timeout*100||0}%`})),M=Ve(()=>{var W;return tr(s.value.icon.base,(W=s.value.icon.color)==null?void 0:W.replaceAll("{color}",e.color))});function k(){h&&h.pause()}function C(){h&&h.resume()}function L(){h&&h.stop(),e.callback&&e.callback(),n("close")}function q(W){h&&h.stop(),W.click&&W.click(),n("close")}function X(){h&&h.stop(),e.timeout&&(h=ND(()=>{L()},e.timeout),Vn(()=>{g.value=h.remaining.value}))}return Zi(()=>e.timeout,X),Wr(X),sa(()=>{h&&h.stop()}),{ui:s,attrs:u,wrapperClass:m,progressClass:c,progressStyle:I,iconClass:M,onMouseover:k,onMouseleave:C,onClose:L,onAction:q,twMerge:fs}}});function jD(e,n,s,u,h,g){const m=$o,c=Kf,I=Wf;return _t(),li(Nf,br({appear:""},e.ui.transition),{default:xr(()=>[$i("div",br({class:e.wrapperClass,role:"status"},e.attrs,{onMouseover:n[0]||(n[0]=(...M)=>e.onMouseover&&e.onMouseover(...M)),onMouseleave:n[1]||(n[1]=(...M)=>e.onMouseleave&&e.onMouseleave(...M))}),[$i("div",{class:Mt([e.ui.container,e.ui.rounded,e.ui.ring])},[$i("div",{class:Mt(["flex",[e.ui.padding,e.ui.gap,{"items-start":e.description||e.$slots.description,"items-center":!e.description&&!e.$slots.description}]])},[e.icon?(_t(),li(m,{key:0,name:e.icon,class:Mt(e.iconClass)},null,8,["name","class"])):Li("",!0),e.avatar?(_t(),li(c,br({key:1},{size:e.ui.avatar.size,...e.avatar},{class:e.ui.avatar.base}),null,16,["class"])):Li("",!0),$i("div",{class:Mt(e.ui.inner)},[e.title||e.$slots.title?(_t(),ri("p",{key:0,class:Mt(e.ui.title)},[sr(e.$slots,"title",{title:e.title},()=>[mo(Ur(e.title),1)])],2)):Li("",!0),e.description||e.$slots.description?(_t(),ri("div",{key:1,class:Mt(e.twMerge(e.ui.description,!(e.title&&e.$slots.title)&&"mt-0 leading-5"))},[sr(e.$slots,"description",{description:e.description},()=>[mo(Ur(e.description),1)])],2)):Li("",!0),(e.description||e.$slots.description)&&e.actions.length?(_t(),ri("div",{key:2,class:Mt(e.ui.actions)},[(_t(!0),ri(ar,null,oh(e.actions,(M,k)=>(_t(),li(I,br({key:k,ref_for:!0},{...e.ui.default.actionButton||{},...M},{onClick:bm(C=>e.onAction(M),["stop"])}),null,16,["onClick"]))),128))],2)):Li("",!0)],2),e.closeButton||!e.description&&!e.$slots.description&&e.actions.length?(_t(),ri("div",{key:2,class:Mt(e.twMerge(e.ui.actions,"mt-0"))},[!e.description&&!e.$slots.description&&e.actions.length?(_t(!0),ri(ar,{key:0},oh(e.actions,(M,k)=>(_t(),li(I,br({key:k,ref_for:!0},{...e.ui.default.actionButton||{},...M},{onClick:bm(C=>e.onAction(M),["stop"])}),null,16,["onClick"]))),128)):Li("",!0),e.closeButton?(_t(),li(I,br({key:1,"aria-label":"Close"},{...e.ui.default.closeButton||{},...e.closeButton},{onClick:bm(e.onClose,["stop"])}),null,16,["onClick"])):Li("",!0)],2)):Li("",!0)],2),e.timeout?(_t(),ri("div",{key:0,class:Mt(e.progressClass),style:ia(e.progressStyle)},null,6)):Li("",!0)],2)],16)]),_:3},16)}const qw=jn($D,[["render",jD]]),UD=ys(Di.ui.strategy,Di.ui.notifications,HM),qD=Ri({components:{UNotification:qw},inheritAttrs:!1,props:{class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},setup(e){const{ui:n,attrs:s}=ra("notifications",Qn(e,"ui"),UD),u=Ew(),h=mh("notifications",()=>[]),g=Ve(()=>fs(tr(n.value.wrapper,n.value.position,n.value.width),e.class));return{ui:n,attrs:s,toast:u,notifications:h,wrapperClass:g}}});function HD(e,n,s,u,h,g){const m=qw;return _t(),li(LI,{to:"body"},[$i("div",br({class:e.wrapperClass,role:"region"},e.attrs),[e.notifications.length?(_t(),ri("div",{key:0,class:Mt(e.ui.container)},[(_t(!0),ri(ar,null,oh(e.notifications,c=>(_t(),ri("div",{key:c.id},[ei(m,br({ref_for:!0},c,{class:c.click&&"cursor-pointer",onClick:I=>c.click&&c.click(c),onClose:I=>e.toast.remove(c.id)}),JS({_:2},[oh(e.$slots,(I,M)=>({name:M,fn:xr(k=>[sr(e.$slots,M,br({ref_for:!0},k))])}))]),1040,["class","onClick","onClose"])]))),128))],2)):Li("",!0)],16)])}const GD=jn(qD,[["render",HD]]),ZD={};function WD(e,n){const s=_P,u=VD,h=GD;return _t(),ri("div",null,[ei(s),$i("main",null,[ei(u)]),ei(h)])}const KD=jn(ZD,[["render",WD]]),XD={__name:"nuxt-error-page",props:{error:Object},setup(e){const s=e.error;s.stack&&s.stack.split(`
`).splice(1).map(C=>({text:C.replace("webpack:/","").replace(".vue",".js").trim(),internal:C.includes("node_modules")&&!C.includes(".cache")||C.includes("internal")||C.includes("new Promise")})).map(C=>`<span class="stack${C.internal?" internal":""}">${C.text}</span>`).join(`
`);const u=Number(s.statusCode||500),h=u===404,g=s.statusMessage??(h?"Page Not Found":"Internal Server Error"),m=s.message||s.toString(),c=void 0,k=h?cf(()=>Ef(()=>import("./C_cJ6gtL.js"),__vite__mapDeps([2,3]),import.meta.url).then(C=>C.default||C)):cf(()=>Ef(()=>import("./DbCcxgd5.js"),__vite__mapDeps([4,5]),import.meta.url).then(C=>C.default||C));return(C,L)=>(_t(),li(ni(k),Dm(ff({statusCode:ni(u),statusMessage:ni(g),description:ni(m),stack:ni(c)})),null,16))}},JD={key:0},px={__name:"nuxt-root",setup(e){const n=()=>null,s=Yi(),u=s.deferHydration();if(s.isHydrating){const I=s.hooks.hookOnce("app:error",u);Vo().beforeEach(I)}const h=!1;aa(Qb,ty()),s.hooks.callHookWith(I=>I.map(M=>M()),"vue:setup");const g=iy(),m=!1;Yx((I,M,k)=>{if(s.hooks.callHook("vue:error",I,M,k).catch(C=>console.error("[nuxt] Error in `vue:error` hook",C)),qC(I)&&(I.fatal||I.unhandled))return s.runWithContext(()=>jC(I)),!1});const c=!1;return(I,M)=>(_t(),li(FS,{onResolve:ni(u)},{default:xr(()=>[ni(m)?(_t(),ri("div",JD)):ni(g)?(_t(),li(ni(XD),{key:1,error:ni(g)},null,8,["error"])):ni(c)?(_t(),li(ni(n),{key:2,context:ni(c)},null,8,["context"])):ni(h)?(_t(),li(hs(ni(h)),{key:3})):(_t(),li(ni(KD),{key:4}))]),_:1},8,["onResolve"]))}};let mx;{let e;mx=async function(){var m,c;if(e)return e;const u=!!((m=window.__NUXT__)!=null&&m.serverRendered||((c=document.getElementById("__NUXT_DATA__"))==null?void 0:c.dataset.ssr)==="true")?gT(px):mT(px),h=SC({vueApp:u});async function g(I){await h.callHook("app:error",I),h.payload.error=h.payload.error||ry(I)}u.config.errorHandler=g;try{await CC(h,DM)}catch(I){g(I)}try{await h.hooks.callHook("app:created",u),await h.hooks.callHook("app:beforeMount",u),u.mount(wC),await h.hooks.callHook("app:mounted",u),await qr()}catch(I){g(I)}return u.config.errorHandler===g&&(u.config.errorHandler=void 0),u},e=mx().catch(n=>{throw console.error("Error while mounting app:",n),n})}export{jn as _,$i as a,ei as b,ri as c,mo as d,v1 as e,Zx as f,Ri as g,QD as h,qf as i,Ve as j,ia as n,_t as o,Gx as p,rP as r,Ur as t,zA as u,xr as w};
